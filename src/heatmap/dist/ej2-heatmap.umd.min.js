!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-svg-base")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-data","@syncfusion/ej2-svg-base"],t):t(e.ej={},e.ej2Base,e.ej2Data,e.ej2SvgBase)}(this,function(e,t,i,n){"use strict";function a(e,t){return null!==e&&void 0!==e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}function l(e,i){var n=document.getElementById("heatmapmeasuretext");return null===n&&(n=t.createElement("text",{id:"heatmapmeasuretext"}),document.body.appendChild(n)),n.innerHTML=e,n.style.position="absolute",n.style.visibility="hidden",n.style.fontSize=-1!==i.size.indexOf("px")?i.size:i.size+"px",n.style.fontWeight=i.fontWeight,n.style.fontStyle=i.fontStyle,n.style.fontFamily=i.fontFamily,n.style.top="-100",n.style.left="0",n.style.whiteSpace="nowrap",n.style.lineHeight="normal",new j(n.clientWidth,n.clientHeight)}function o(e,t,i,n){return"Near"===n.textAlignment?t:"Center"===n.textAlignment?t+e/2:e+t}function s(e){for(var t=0,i=0,n=e;i<n.length;i++){t+=n[i]}return t}function r(e,t,i,n){return"Near"===n.textAlignment?e.height-i:"Center"===n.textAlignment?e.height/2:t}function h(e,i,n){var a,l,o,s=new t.SvgRenderer("heatmapMeasureRotateText"),r=s.createSvg({id:"heatmapMeasureRotateText_svg",width:100,height:100});return l={"font-size":e.size,"font-style":e.fontStyle,"font-family":e.fontFamily,"font-weight":e.fontWeight,transform:"rotate("+n+", 0, 0)","text-anchor":"middle"},o=s.createText(l,i),r.appendChild(o),document.body.appendChild(r),a=o.getBoundingClientRect(),t.remove(r),new j(a.right-a.left,a.bottom-a.top)}function p(e,t,i){var n=[];switch(t.textOverflow){case"Wrap":n=d(e,i,t);break;case"Trim":n.push(c(i,e,t));break;default:n.push(g(i,e,t))}return n}function d(e,t,i){for(var n,a=e.split(" "),o="",s=[],r=0,h=a.length;r<h;r++)n=a[r],l(o.concat(n),i).width<t?o=o.concat((""===o?"":" ")+n):""!==o?(s.push(c(t,o,i)),o=n):(s.push(c(t,n,i)),n=""),o&&r===h-1&&s.push(c(t,o,i));return s}function c(e,t,i){var n=t,a=l(t,i).width;if(a>e)for(var o=t.length-1;o>=0;--o)if(n=t.substring(0,o)+"...",(a=l(n,i).width)<=e)return n;return n}function g(e,t,i){var n=t,a=l(t,i).width;if(a>e)for(var o=t.length-1;o>=0;--o)if(n=t.substring(0,o),(a=l(n,i).width)<=e)return n;return n}function u(e,i,n,a,o,s,r,h){var p=document.getElementById(o),d=h.initialClipRect,c=l(e,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),g=c.width+5;i=(i=i+g>a?i-g:i)<0?5:i,p?(p.innerHTML=e,p.style.top=(n+15).toString()+"px",p.style.left=(i+15).toString()+"px"):(p=t.createElement("div",{innerHTML:e,id:o,styles:"top:"+(n+15).toString()+"px;left:"+(i+15).toString()+"px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: Segoe UI"}),s.appendChild(p)),e===h.titleSettings.text?p.style.width=i+15+c.width+7>h.availableSize.width?(h.availableSize.width-(i+15)).toString()+"px":"":(p.style.left=i+15+c.width+7>h.availableSize.width?(h.availableSize.width-(c.width+7)).toString()+"px":i.toString()+"px",p.style.top=n+15+c.height+6>h.availableSize.height?(d.height+d.y-(c.height+6)+5).toString()+"px":p.style.top),r&&setTimeout(function(){y(o)},1500)}function y(e){var i=v(e);i&&t.remove(i)}function v(e){return document.getElementById(e)}function f(e,t,i,n){var a=new Date(e);switch(t=Math.ceil(t*n),i){case"Years":a.setFullYear(a.getFullYear()+t);break;case"Months":a.setMonth(a.getMonth()+t);break;case"Days":a.setDate(a.getDate()+t);break;case"Hours":a.setHours(a.getHours()+t);break;case"Minutes":a.setMinutes(a.getMinutes()+t)}return a}function m(e,t,i){for(var n,a,l,o=e.length,s=0;s<o;s++)if(n=e[s],a=n.region,t>=a.x&&t<=a.x+a.width&&i>=a.y&&i<=a.y+a.height){l=n.text;break}return l}function b(e){var t;e="transparent"===e?"white":e,(t=document.getElementById("heatmapmeasuretext")).style.color=e,e=window.getComputedStyle(t).color;var i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(e);return x(new H(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function x(e){return"#"+S(e.R)+S(e.G)+S(e.B)}function S(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function M(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new H(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new H(255,255,255)}var C,w=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),L=function(e,t,i,n){var a,l=arguments.length,o=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(l<3?a(o):l>3?a(t,i,o):a(t,i))||o);return l>3&&o&&Object.defineProperty(t,i,o),o},T=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return w(i,e),L([t.Property("16px")],i.prototype,"size",void 0),L([t.Property("")],i.prototype,"color",void 0),L([t.Property("Segoe UI")],i.prototype,"fontFamily",void 0),L([t.Property("Normal")],i.prototype,"fontWeight",void 0),L([t.Property("Normal")],i.prototype,"fontStyle",void 0),L([t.Property("Center")],i.prototype,"textAlignment",void 0),L([t.Property("Trim")],i.prototype,"textOverflow",void 0),i}(t.ChildProperty),R=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return w(i,e),L([t.Property(10)],i.prototype,"left",void 0),L([t.Property(10)],i.prototype,"right",void 0),L([t.Property(10)],i.prototype,"top",void 0),L([t.Property(10)],i.prototype,"bottom",void 0),i}(t.ChildProperty),P=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return w(i,e),L([t.Property("")],i.prototype,"color",void 0),L([t.Property(1)],i.prototype,"width",void 0),L([t.Property("")],i.prototype,"radius",void 0),i}(t.ChildProperty),O=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return w(i,e),L([t.Property(null)],i.prototype,"size",void 0),L([t.Property(null)],i.prototype,"color",void 0),i}(t.ChildProperty),z=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return w(i,e),L([t.Property("")],i.prototype,"text",void 0),L([t.Complex({},T)],i.prototype,"textStyle",void 0),i}(t.ChildProperty),D=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return w(i,e),L([t.Property(null)],i.prototype,"value",void 0),L([t.Property(null)],i.prototype,"color",void 0),L([t.Property(null)],i.prototype,"label",void 0),i}(t.ChildProperty),A=function(){return function(e,t,i){this.value=e,this.color=t,this.label=i}}(),_=function(){return function(e,t,i){this.mappingName=e,this.bubbleData=t,this.valueType=i}}(),I=function(){return function(e,t,i,n){this.value=e,this.color=t,this.label=i,this.isHidden=n}}(),V=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),G=function(e,t,i,n){var a,l=arguments.length,o=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(l<3?a(o):l>3?a(t,i,o):a(t,i))||o);return l>3&&o&&Object.defineProperty(t,i,o),o},E=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return V(i,e),G([t.Collection([{}],D)],i.prototype,"palette",void 0),G([t.Property("Gradient")],i.prototype,"type",void 0),G([t.Property("")],i.prototype,"emptyPointColor",void 0),i}(t.ChildProperty),H=function(){return function(e,t,i){this.R=e,this.G=t,this.B=i}}(),B=function(){function e(e){this.heatMap=e}return e.prototype.convertToRGB=function(e,t){for(var i=t[0].value,n=0,a=1;a<t.length;a++){var l=Number(t[a].value);if(e<=l){n=l;break}n=l,i=l}var o=0;o=(e-i)/(n-i);var s=this.getEqualColor(t,i),r=this.getEqualColor(t,n);return this.getPercentageColor(o,s,r)},e.prototype.rgbToHex=function(e,t,i){return"#"+this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(i)},e.prototype.componentToHex=function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},e.prototype.getEqualColor=function(e,t){for(var i=0;i<e.length;i++)if(Number(e[i].value)===t){var n=e[i].color;return-1!==n.indexOf("rgb")?n=this.convertToHex(n):-1===n.indexOf("#")&&(n="#FFFFFF"),n}return"#00000"},e.prototype.convertToHex=function(e){var t=e.substr(3),i=(t=t.split("(")[1].split(")")[0]).split(",");return t=this.rgbToHex(parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10))},e.prototype.getPercentageColor=function(e,t,i){var n=i.split("#")[1],a=t.split("#")[1],l=this.getPercentage(e,parseInt(a.substr(0,2),16),parseInt(n.substr(0,2),16)),o=this.getPercentage(e,parseInt(a.substr(2,2),16),parseInt(n.substr(2,2),16)),s=this.getPercentage(e,parseInt(a.substr(4,2),16),parseInt(n.substr(4,2),16));return new H(l,o,s)},e.prototype.getPercentage=function(e,t,i){var n=i-t;return Math.round(t+n*e)},e.prototype.getColorCollection=function(){var e=this.heatMap;e.colorCollection=[],e.legendColorCollection=[];var i,n=e.bubbleSizeWithColor?e.minColorValue:e.dataSourceMinValue,a=e.bubbleSizeWithColor?e.maxColorValue:e.dataSourceMaxValue;e.emptyPointColor=e.paletteSettings.emptyPointColor?e.paletteSettings.emptyPointColor:e.themeStyle.emptyCellColor;var l=this.orderbyOffset(e.paletteSettings.palette&&e.paletteSettings.palette.length>1?e.paletteSettings.palette:e.themeStyle.palette);if(l.isCompact)e.colorCollection=l.offsets,e.legendColorCollection=t.extend([],l.offsets,null,!0);else if(i="Gradient"===e.paletteSettings.type?(a-n)/(l.offsets.length-1):(a-n)/l.offsets.length,l.offsets.length>=2)for(var o=0;o<l.offsets.length;o++)e.colorCollection.push(new A(Math.round(100*(n+o*i))/100,l.offsets[o].color,l.offsets[o].label)),e.legendColorCollection.push(new I(Math.round(100*(n+o*i))/100,l.offsets[o].color,l.offsets[o].label,!1));this.updateLegendColorCollection(n,a)},e.prototype.updateLegendColorCollection=function(e,t){e<this.heatMap.legendColorCollection[0].value&&this.heatMap.legendColorCollection.unshift(new I(e,this.heatMap.legendColorCollection[0].color,this.heatMap.legendColorCollection[0].label,!0)),t>this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].value&&this.heatMap.legendColorCollection.push(new I(t,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].color,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].label,!0))},e.prototype.orderbyOffset=function(e){var i=new le;return i.isCompact=!0,i.offsets=e.sort(function(e,n){return t.isNullOrUndefined(e.value)||t.isNullOrUndefined(n.value)?(i.isCompact=!1,e):e.value-n.value}),i.isCompact||(i.offsets=this.heatMap.paletteSettings.palette&&this.heatMap.paletteSettings.palette.length>1?this.heatMap.paletteSettings.palette:this.heatMap.themeStyle.palette),i},e.prototype.getColorByValue=function(e){var t,i="",n=0;if(""!==e.toString())if("Bubble"!==this.heatMap.cellSettings.tileType||"Size"!==this.heatMap.cellSettings.bubbleType&&"Sector"!==this.heatMap.cellSettings.bubbleType)if("Fixed"===this.heatMap.paletteSettings.type){for(var a=0;a<this.heatMap.colorCollection.length;a++)if(n=this.heatMap.colorCollection[a+1]?this.heatMap.colorCollection[a+1].value:this.heatMap.colorCollection[a].value,e<n||e>=n&&a===this.heatMap.colorCollection.length-1){i=this.heatMap.colorCollection[a].color;break}}else e<this.heatMap.colorCollection[0].value?i=this.heatMap.colorCollection[0].color:e>this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].value?i=this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].color:(t=this.convertToRGB(e,this.heatMap.colorCollection),i=this.rgbToHex(t.R,t.G,t.B));else i=this.heatMap.colorCollection[0].color;else i=this.heatMap.emptyPointColor;return i},e}(),N=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),F=function(){return function(e,t){this["font-size"]=e.size,this["font-style"]=e.fontStyle,this["font-family"]=e.fontFamily,this["font-weight"]=e.fontWeight,this.fill=t||""}}(),j=function(){return function(e,t){this.width=e,this.height=t}}(),Y=function(){return function(e){this.id=e}}(),k=function(e){function t(t,i,n,a,l,o,s){var r=e.call(this,t)||this;return r.opacity=l,r.fill=i,r.stroke=a||"",r["stroke-width"]=parseFloat(n.toString()),r["stroke-dasharray"]=o,r.d=s,r}return N(t,e),t}(Y),X=function(){return function(e,t,i,n,a,l){this.x=e,this.y=t,this.width=i,this.height=n,this.value=a,this.id=l}}(),W=function(e){function t(t,i,n,a,l,o,s,r,h,p){var d=e.call(this,t,i,n.width,o,a,p)||this;return d.y=l.y,d.x=l.x,d.height=l.height>0?l.height:0,d.width=l.width>0?l.width:0,d.rx=s||0,d.ry=r||0,d.transform=h||"",d}return N(t,e),t}(k),U=function(e){function t(t,i,n,a,l,o,s,r){var h=e.call(this,t,i,n.width,l,a)||this;return h.cx=o||0,h.cy=s||0,h.r=r||0,h}return N(t,e),t}(k),J=function(){return function(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n}}(),q=function(e){function t(t,i,n,a){var l=e.call(this,n,a)||this;return l.transform="",l["dominant-baseline"]="auto",l.labelRotation=0,l.baseline="auto",l.id=t,l.x=i.x,l.y=i.y,l["text-anchor"]=i["text-anchor"],l.text=i.text,l.transform=i.transform,l.labelRotation=i.labelRotation,l["dominant-baseline"]=i["dominant-baseline"],l.baseline=i.baseline,l.dy=i.dy,l}return N(t,e),t}(F),Z=function(){return function(e,t,i,n,a,l,o,s){this.transform="",this["dominant-baseline"]="auto",this.labelRotation=0,this.baseline="auto",this.x=e||0,this.y=t||0,this["text-anchor"]=i||"",this.text=n||"",this.transform=l||"",this.labelRotation=a,this["dominant-baseline"]=o||"",this.baseline=o||"",this.dy=s||""}}(),$=function(){return function(e,t,i,n){this.x1=e,this.y1=t,this.x2=i,this.y2=n}}(),K=function(e){function t(t,i,n,a,l,o){var s=e.call(this,t,null,a,n,l,o,null)||this;return s.x1=i.x1,s.y1=i.y1,s.x2=i.x2,s.y2=i.y2,s}return N(t,e),t}(k),Q=function(e){function t(t,i,n,a,l,o,s){var r=e.call(this,t,n,l,s,o,null)||this;return r.d=i.d,r.x=i.x,r.y=i.y,r}return N(t,e),t}(k),ee=function(){return function(e,t,i,n,a,l,o,s,r,h,p,d){this.d=e,this.innerR=t,this.cx=o,this.cy=s,this.x=i,this.y=n,this.x1=a,this.y1=l,this.start=r,this.end=h,this.radius=p,this.counterClockWise=d}}(),te=function(){function e(e){this.heatMap=e}return e.prototype.drawRectangle=function(e,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasRectangle(this.heatMap.canvasRenderer,e,i):t.appendChild(this.heatMap.renderer.drawRectangle(e))},e.prototype.drawCircle=function(e,t){this.heatMap.enableCanvasRendering?this.drawCanvasCircle(this.heatMap.canvasRenderer,e):t.appendChild(this.heatMap.renderer.drawCircle(e))},e.prototype.drawPath=function(e,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasPath(this.heatMap.canvasRenderer,e,t):i.appendChild(this.heatMap.renderer.drawPath(e))},e.prototype.createText=function(e,t,i){this.heatMap.enableCanvasRendering?this.canvasDrawText(e,i):t.appendChild(this.heatMap.renderer.createText(e,i))},e.prototype.createWrapText=function(e,t,i){var n,a,o,s,r={};if(r={id:e.id,x:e.x,y:e.y,fill:e.fill,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":e["text-anchor"],transform:e.transform,"dominant-baseline":e["dominant-baseline"]},o=e.text[0],this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawText(e,o):n=this.heatMap.renderer.createText(r,o),"string"!=typeof e.text&&e.text.length>1)for(var h=1,p=e.text.length;h<p;h++)s=l(e.text[h],t).height,this.heatMap.enableCanvasRendering?(e.id=e.id+h,e.y+=s,this.heatMap.canvasRenderer.drawText(e,e.text[h])):(a=this.heatMap.renderer.createTSpan({x:e.x,id:e.id+h,y:e.y+h*s},e.text[h]),n.appendChild(a));this.heatMap.enableCanvasRendering||i.appendChild(n)},e.prototype.drawLine=function(e,t){this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawLine(e):t.appendChild(this.heatMap.renderer.drawLine(e))},e.prototype.canvasDrawText=function(e,i,n,a){var l=this.heatMap.canvasRenderer.ctx;n||(n=e.x),a||(a=e.y);var o=this.getOptionValue(e,"font-weight");t.isNullOrUndefined(o)||"regular"!==o.toLowerCase()||(o="normal");var s=this.getOptionValue(e,"font-family"),r=-1===e["font-size"].toString().indexOf("px")?e["font-size"]+"px":e["font-size"],h=this.getOptionValue(e,"text-anchor"),p=this.getOptionValue(e,"font-style").toLowerCase()+" "+o+" "+r+" "+s;"middle"===h&&(h="center"),l.save(),l.fillStyle=e.fill,l.font=p,l.textAlign=h,e.baseline&&(l.textBaseline=e.baseline),l.translate(n,a),l.rotate(e.labelRotation*Math.PI/180),l.fillText(i,e.x-n,e.y-a),l.restore()},e.prototype.getOptionValue=function(e,t){return e[t]},e.prototype.setAttributes=function(e,i){e.ctx.lineWidth=i["stroke-width"];var n=i["stroke-dasharray"];if(!t.isNullOrUndefined(n)){var a=n.split(",");e.ctx.setLineDash([parseInt(a[0],10),parseInt(a[1],10)])}e.ctx.strokeStyle=i.stroke},e.prototype.drawCanvasRectangle=function(e,t,i){var n=e.ctx;t.rx;e.ctx.save(),e.ctx.beginPath(),e.ctx.globalAlpha=t.opacity,this.setAttributes(e,t),this.drawCornerRadius(e,t),(t["stroke-width"]&&0!=t["stroke-width"]||i)&&e.ctx.stroke(),e.ctx.restore(),e.ctx=n},e.prototype.drawCornerRadius=function(e,t){var i=t.rx,n=t.x,a=t.y,l=t.width,o=t.height;"none"===t.fill&&(t.fill="transparent"),e.ctx.fillStyle=t.fill,l<2*i&&(i=l/2),o<2*i&&(i=o/2),e.ctx.beginPath(),e.ctx.moveTo(n+l-i,a),e.ctx.arcTo(n+l,a,n+l,a+o,i),e.ctx.arcTo(n+l,a+o,n,a+o,i),e.ctx.arcTo(n,a+o,n,a,i),e.ctx.arcTo(n,a,n+l,a,i),e.ctx.closePath(),e.ctx.fill()},e.prototype.drawCanvasCircle=function(e,t){e.ctx.save(),e.ctx.beginPath(),e.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI),e.ctx.fillStyle=t.fill,e.ctx.globalAlpha=t.opacity,e.ctx.fill(),this.setAttributes(e,t),t["stroke-width"]&&0!==t["stroke-width"]&&e.ctx.stroke(),e.ctx.restore()},e.prototype.drawCanvasPath=function(e,t,i){var n=t.d.split(" ");this.getOptionValue(i,"stroke-width");e.ctx.save(),e.ctx.beginPath(),e.ctx.globalAlpha=t.opacity,e.ctx.fillStyle=t.fill,this.setAttributes(e,t);for(var a=0;a<n.length;a+=3){var l=parseFloat(n[a+1]),o=parseFloat(n[a+2]);switch(n[a]){case"M":e.ctx.moveTo(l,o);break;case"L":e.ctx.lineTo(l,o);break;case"A":case"a":e.ctx.arc(i.x,i.y,i.radius,.0174533*i.start,.0174533*i.end,!1),a="a"===n[a]?a+13:a+5;break;case"Z":e.ctx.closePath()}}e.ctx.fill(),t["stroke-width"]&&0!==t["stroke-width"]&&e.ctx.stroke(),e.ctx.restore()},e}(),ie=function(){return function(e,t,i,n,a){this.id=e,this.x1=t,this.x2=i,this.y1=n,this.y2=a}}(),ne=function(){return function(e,t){this.color=e,this.colorStop=t}}(),ae=function(){return function(e,t){this.region=new J(0,0,0,0),this.text=e,this.region=t}}(),le=function(){return function(){}}(),oe=function(){return function(e,t,i,n,a,l){this.pathX1=e,this.pathY1=t,this.pathX2=i,this.pathY2=n,this.pathX3=a,this.pathY3=l}}(),se=function(){return function(e,t,i,n,a,l){this.x=e,this.y=t,this.width=i,this.height=n,this.label=a,this.id=l}}();!function(e){e.heatMapTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisTitleFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"},e.legendLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"},e.rectLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"}}(C||(C={}));var re=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),he=function(e,t,i,n){var a,l=arguments.length,o=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(l<3?a(o):l>3?a(t,i,o):a(t,i))||o);return l>3&&o&&Object.defineProperty(t,i,o),o},pe=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.rect=new J(void 0,void 0,0,0),t.nearSizes=[],t.farSizes=[],t.maxLabelSize=new j(0,0),t.titleSize=new j(0,0),t.axisLabels=[],t.tooltipLabels=[],t.labelValue=[],t.axisLabelSize=0,t.axisLabelInterval=0,t.dateTimeAxisLabelInterval=[],t.maxLength=0,t.min=0,t.max=0,t.isIntersect=!1,t}return re(n,e),n.prototype.computeSize=function(e,t){this.titleSize=e.getTitleSize(e,10),this.maxLabelSize=e.getMaxLabelSize(e,t)},n.prototype.getTitleSize=function(e,t){var i=new j(0,0);return this.title.text&&((i=l(this.title.text,this.title.textStyle)).height+=t),e.opposedPosition?this.farSizes.push(i.height):this.nearSizes.push(i.height),i},n.prototype.getMaxLabelSize=function(e,i){var n=new j(0,0),a=this.axisLabels;if(e.angle=e.labelRotation,e.isIntersect=!1,"Horizontal"===e.orientation&&("Rotate45"===e.labelIntersectAction||e.labelRotation%180==0&&"Trim"===e.labelIntersectAction))for(var o=i.initialClipRect.width/e.axisLabels.length,s=i.initialClipRect.x+(e.isInversed?i.initialClipRect.width:0),r=void 0,p=0,d=a.length;p<d;p++){var c=l(a[p],e.textStyle),g=s+(e.isInversed?-(o+c.width)/2:(o-c.width)/2),u=(g=g<i.initialClipRect.x?i.initialClipRect.x:g)+c.width;if(t.isNullOrUndefined(r))r=u;else{if(g<r){"Rotate45"===e.labelIntersectAction?e.angle=45:e.isIntersect=!0;break}r=u}s+=e.isInversed?-o:o}for(p=0;p<a.length;p++){var y=e.angle%180==0?l(a[p],e.textStyle):h(e.textStyle,a[p],e.angle);n.width=n.width>y.width?n.width:y.width,n.height=n.height>y.height?n.height:y.height}return e.opposedPosition?this.farSizes.push("Horizontal"===e.orientation?n.height:n.width):this.nearSizes.push("Horizontal"===e.orientation?n.height:n.width),n},n.prototype.calculateNumericAxisLabels=function(e){var i,n,a=0,l=0,o=this.interval?this.interval:1;e.adaptorModule&&e.isCellData&&(i="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.min:e.adaptorModule.adaptiveYMinMax.min,n="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.max:e.adaptorModule.adaptiveYMinMax.max),a=t.isNullOrUndefined(this.minimum)?i||0:this.minimum,l=t.isNullOrUndefined(this.maximum)?n||this.maxLength*this.increment:this.maximum;var s;this.minimum&&this.maximum&&a>l&&(s=a,a=l,l=s),l=t.isNullOrUndefined(this.maximum)?n||l+a:l;var r=this.labelFormat,h=null!==r.match("{value}");this.format=e.intl.getNumberFormat({format:h?"":r});for(var p=a;p<=l;p+=o*this.increment){var d=this.formatValue(h,r,p);this.axisLabels.push(d)}this.min=0,this.axisLabelSize=Math.floor((l-a)/this.increment+1),this.max=this.axisLabelSize-1,this.axisLabelInterval=o;for(p=a;p<=l;p+=this.increment){d=this.formatValue(h,r,p);this.tooltipLabels.push(d),this.labelValue.push(p)}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},n.prototype.calculateCategoryAxisLabels=function(){var e,i=this.labels?this.labels:[],n=t.isNullOrUndefined(this.minimum)?0:this.minimum,a=t.isNullOrUndefined(this.maximum)?this.maxLength:this.maximum,l=this.interval?this.interval:1;if(!t.isNullOrUndefined(this.minimum)&&!t.isNullOrUndefined(this.maximum)&&n>a&&(e=n,n=a,a=e),i&&i.length>0)for(var o=n;o<=a;o+=l){var s=i[o]?i[o].toString():o.toString();this.axisLabels.push(s)}else for(o=n;o<=a;o+=l)this.axisLabels.push(o.toString());for(o=n;o<=a;o++)this.tooltipLabels.push(i[o]?i[o].toString():o.toString()),this.labelValue.push(i[o]?i[o].toString():o.toString());this.min=n,this.max=a,this.axisLabelSize=a-n+1,this.axisLabelInterval=l,this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},n.prototype.calculateDateTimeAxisLabel=function(e){var t,n,a=this.interval?this.interval:1,l={skeleton:"full",type:"dateTime"},o=e.intl.getDateParser(l),s=e.intl.getDateFormat(l),r=null,h=null;e.adaptorModule&&e.isCellData&&(r="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.min:e.adaptorModule.adaptiveYMinMax.min,h="Horizontal"===this.orientation?e.adaptorModule.adaptiveXMinMax.max:e.adaptorModule.adaptiveYMinMax.max);var p=this.minimum?this.minimum:r||null,d=this.maximum?this.maximum:h||null;if(null===p&&null===d){t=0,n=this.maxLength*this.increment;for(var c=t;c<=n;c+=a*this.increment)this.axisLabels.push(c.toString()),this.tooltipLabels.push(c.toString()),this.labelValue.push(c.toString());this.min=0,this.max=this.maxLength,this.axisLabelSize=(n-t)/this.increment+1,this.axisLabelInterval=a}else{null!==p&&null===d?n=f(t=Date.parse(o(s(new Date(i.DataUtil.parse.parseJson({val:p}).val)))),this.maxLength,this.intervalType,this.increment).getTime():null===p&&null!==d?t=f(n=Date.parse(o(s(new Date(i.DataUtil.parse.parseJson({val:d}).val)))),-this.maxLength,this.intervalType,this.increment).getTime():(t=Date.parse(o(s(new Date(i.DataUtil.parse.parseJson({val:p}).val)))),n=Date.parse(o(s(new Date(i.DataUtil.parse.parseJson({val:d}).val))))),this.format=e.intl.getDateFormat({format:this.labelFormat,skeleton:this.getSkeleton()});for(var g=t;g<=n;){var u=this.format(new Date(g));this.axisLabels.push(u),"None"!==this.showLabelOn&&(a=this.calculateLabelInterval(g),this.dateTimeAxisLabelInterval.push(a)),g=f(g,a,this.intervalType,this.increment).getTime()}for(this.min=0,this.axisLabelInterval=a,this.axisLabelSize=this.getTotalLabelLength(t,n),this.max=this.axisLabelSize-1,g=t;g<=n;){u=this.format(new Date(g));this.tooltipLabels.push(u),this.labelValue.push(new Date(g)),g=f(g,1,this.intervalType,this.increment).getTime()}}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},n.prototype.calculateLabelInterval=function(e){var t,i,n=new Date(e).getFullYear(),a=new Date(e).getMonth()+1,l=new Date(e).getDate();if("Years"===this.showLabelOn||"Months"===this.showLabelOn)"Years"===this.showLabelOn&&"Months"===this.intervalType?i=Math.ceil(12/this.increment):(t="Years"===this.showLabelOn?n%4==0?366:365:new Date(n,a,0).getDate(),t+=1-l,i="Days"===this.intervalType?Math.ceil(t/this.increment):"Hours"===this.intervalType?Math.ceil(24*t/this.increment):"Minutes"===this.intervalType?Math.ceil(24*t*60/this.increment):1);else if("Days"===this.showLabelOn)i="Hours"===this.intervalType?Math.ceil(24/this.increment):"Minutes"===this.intervalType?Math.ceil(1440/this.increment):1;else if("Hours"===this.showLabelOn){var o=new Date(e).getMinutes();i="Minutes"===this.intervalType?Math.ceil((60-o)/this.increment):1}else i=1;return i},n.prototype.getSkeleton=function(){return"Years"===this.intervalType?"yMMM":"Months"===this.intervalType?"MMMd":"Days"===this.intervalType?"yMd":"Hours"===this.intervalType?"EHm":(this.intervalType,"Hms")},n.prototype.formatValue=function(e,t,i){return e?t.replace("{value}",this.format(i)):this.format(i)},n.prototype.getTotalLabelLength=function(e,t){var i,n,a=0,l=new Date(e),o=new Date(t);switch(this.intervalType){case"Years":var s=(o.getFullYear()-l.getFullYear())/this.increment+1;a=Math.floor(s);break;case"Months":var r=12*(o.getFullYear()-l.getFullYear());r-=l.getMonth(),a=(r+=o.getMonth())<=0?1:Math.floor(r/this.increment+1);break;case"Days":i=Math.abs(l.getTime()-o.getTime()),n=Math.floor(i/864e5),a=Math.floor(n/this.increment+1);break;case"Hours":i=Math.abs(l.getTime()-o.getTime());var h=Math.floor(i/36e5);a=Math.floor(h/this.increment)+1;break;case"Minutes":i=Math.abs(l.getTime()-o.getTime());var p=Math.floor(i/6e4);a=Math.floor(p/this.increment)+1}return a},he([t.Complex({text:"",textStyle:C.axisTitleFont},z)],n.prototype,"title",void 0),he([t.Property(!1)],n.prototype,"opposedPosition",void 0),he([t.Property(null)],n.prototype,"labels",void 0),he([t.Complex(C.axisLabelFont,T)],n.prototype,"textStyle",void 0),he([t.Property(0)],n.prototype,"labelRotation",void 0),he([t.Property(!1)],n.prototype,"isInversed",void 0),he([t.Property("Category")],n.prototype,"valueType",void 0),he([t.Property(1)],n.prototype,"increment",void 0),he([t.Property("None")],n.prototype,"showLabelOn",void 0),he([t.Property(null)],n.prototype,"minimum",void 0),he([t.Property(null)],n.prototype,"maximum",void 0),he([t.Property(null)],n.prototype,"interval",void 0),he([t.Property("")],n.prototype,"labelFormat",void 0),he([t.Property("Days")],n.prototype,"intervalType",void 0),he([t.Property("Trim")],n.prototype,"labelIntersectAction",void 0),n}(t.ChildProperty),de=function(){function e(e){this.heatMap=e,this.padding=10,this.drawSvgCanvas=new te(e)}return e.prototype.renderAxes=function(){this.initialClipRect=this.heatMap.initialClipRect;var e,t,i=this.heatMap;i.enableCanvasRendering||(e=this.heatMap.renderer.createGroup({id:i.element.id+"AxisCollection"}));for(var n=this.heatMap.axisCollections,a=0,l=n.length;a<l;a++){var o=n[a];"Horizontal"===o.orientation?(i.enableCanvasRendering||(t=this.heatMap.renderer.createGroup({id:i.element.id+"XAxisGroup"})),this.drawXAxisLine(t,o),this.drawXAxisTitle(o,t,o.rect),this.drawXAxisLabels(o,t,o.rect)):(t=i.renderer.createGroup({id:i.element.id+"YAxisGroup"}),this.drawYAxisLine(t,o),this.drawYAxisTitle(o,t,o.rect),this.drawYAxisLabels(o,t,o.rect)),i.enableCanvasRendering||e.appendChild(t)}i.enableCanvasRendering||this.heatMap.svgObject.appendChild(e)},e.prototype.drawXAxisLine=function(e,t){var i=this.initialClipRect.y+(t.opposedPosition?0:this.initialClipRect.height),n=new K(this.heatMap.element.id+"_XAxisLine",new $(this.initialClipRect.x,i,this.initialClipRect.x+this.initialClipRect.width,i),"transparent",0);this.drawSvgCanvas.drawLine(n,e)},e.prototype.drawYAxisLine=function(e,t){var i=this.initialClipRect.x+(t.opposedPosition?this.initialClipRect.width:0),n=new K(this.heatMap.element.id+"_YAxisLine",new $(i,this.initialClipRect.y,i,this.initialClipRect.height+this.initialClipRect.y),"transparent",0);this.drawSvgCanvas.drawLine(n,e)},e.prototype.drawXAxisTitle=function(e,t,i){var n=i.y+(e.opposedPosition?-(e.maxLabelSize.height+this.padding):e.maxLabelSize.height+this.padding);if(e.title.text){var a=this.heatMap,s=e.title,r=l(s.text,s.textStyle),h=this.padding,p="Near"===s.textStyle.textAlignment?"start":"Far"===s.textStyle.textAlignment?"end":"middle";h=e.opposedPosition?-(h+r.height/4):h+3*r.height/4;var d=new q(a.element.id+"_XAxisTitle",new Z(i.x+o(i.width,0,0,s.textStyle),n+h,p,s.text),s.textStyle,s.textStyle.color||a.themeStyle.axisTitle);this.drawSvgCanvas.createText(d,t,s.text)}},e.prototype.drawYAxisTitle=function(e,t,i){if(e.title.text){var n=e.title,a=this.heatMap,o=e.opposedPosition?90:-90,s=(l(n.text,n.textStyle),"Near"===n.textStyle.textAlignment?"start":"Far"===n.textStyle.textAlignment?"end":"middle"),h=10;h=e.opposedPosition?h:-h;var p=i.x+h+(e.opposedPosition?e.maxLabelSize.width:-e.maxLabelSize.width),d=i.y+r(i,0,0,n.textStyle)+(e.opposedPosition?this.padding:-this.padding),c=new q(a.element.id+"_YAxisTitle",new Z(p,d-this.padding,s,n.text,o,"rotate("+o+","+p+","+d+")","auto"),n.textStyle,n.textStyle.color||a.themeStyle.axisTitle);this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(c,n.text,p,d):this.drawSvgCanvas.createText(c,t,n.text)}},e.prototype.calculateVisibleLabels=function(){for(var e,t=this.heatMap.axisCollections,i=0,n=t.length;i<n;i++)(e=t[i]).axisLabels=[],e.tooltipLabels=[],e.dateTimeAxisLabelInterval=[],e.labelValue=[],"Numeric"===e.valueType?e.calculateNumericAxisLabels(this.heatMap):"DateTime"===e.valueType?e.calculateDateTimeAxisLabel(this.heatMap):e.calculateCategoryAxisLabels(),e.tooltipLabels=e.isInversed?e.tooltipLabels.reverse():e.tooltipLabels},e.prototype.measureAxis=function(e){for(var t,i=this.heatMap,n=i.axisCollections,a=n.length-1;a>=0;a--){var l="0px"===(t=n[a]).textStyle.size?0:this.padding;t.nearSizes=[],t.farSizes=[],t.computeSize(t,i),t.opposedPosition?"Horizontal"===t.orientation?(e.y+=s(t.farSizes)+l,e.height-=s(t.farSizes)+l):e.width-=s(t.farSizes)+l:"Horizontal"===t.orientation?e.height-=s(t.nearSizes)+l:(e.x+=s(t.nearSizes)+l,e.width-=s(t.nearSizes)+l)}},e.prototype.calculateAxisSize=function(e){for(var i=this.heatMap.axisCollections,n=0,a=i.length;n<a;n++){var l=i[n];l.rect=t.extend({},e,null,!0),"Horizontal"!==l.orientation||l.opposedPosition||(l.rect.y=e.y+e.height,l.rect.height=0),"Vertical"===l.orientation&&l.opposedPosition&&(l.rect.x=e.x+e.width,l.rect.width=0)}},e.prototype.drawXAxisLabels=function(e,t,i){var n=this.heatMap,a=e.axisLabels,o=i.width/e.axisLabelSize,s=0,r=e.interval?e.interval:1,p=i.width/(e.axisLabelSize/e.axisLabelInterval),d=e.axisLabelInterval;if(p>0)for(;p<parseInt(e.textStyle.size,10);)d+=1,p=i.width/(e.axisLabelSize/d);else d=e.tooltipLabels.length;e.axisLabelInterval<d&&(s=d,a=e.tooltipLabels,r=d);var g,u=10,y=i.x+(e.isInversed?i.width:0),v=e.angle;u=this.padding;var f;n.enableCanvasRendering||(f=this.heatMap.renderer.createGroup({id:n.element.id+"XAxisLabels"}));for(var m=0,b=a.length;m<b;m++){var x=new J(y,i.y,o,i.height),S="Trim"===e.labelIntersectAction&&e.isIntersect?"DateTime"!==e.valueType||"None"===e.showLabelOn?c(o*r,a[m],e.textStyle):c(e.dateTimeAxisLabelInterval[m]*o,a[m],e.textStyle):a[m],M=l(S,e.textStyle),C=void 0;g=e.opposedPosition?-u:u+M.height/4*3;var w=x.x+(e.isInversed?-(x.width/2+M.width/2):x.width/2-M.width/2);"Trim"===e.labelIntersectAction?w=e.isInversed?w>y-o?w:y-o:w>=x.x?w:x.x:v%180==0&&(w=(w=w<i.x?i.x:w)+M.width>i.x+i.width?i.x+i.width-M.width:w);var L=i.y+g;if(v%360!=0){v=v>360?v%360:v;var T=h(e.textStyle,S,v),R=e.maxLabelSize.height-Math.ceil(T.height-M.height);e.opposedPosition;C="rotate("+v+","+(w=x.x+(e.isInversed?-x.width/2:x.width/2))+","+(L+=e.opposedPosition?-T.height/2:(T.height-M.height)/2)+")"}var P=new q(n.element.id+"_XAxis_Label"+m,new Z(w,L,v%360==0?"start":"middle",S,v,C),e.textStyle,e.textStyle.color||n.themeStyle.axisLabel);if(0!==v&&this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(P,S):this.drawSvgCanvas.createText(P,f,S),0===s){var O="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[m]:e.axisLabelInterval;y+=e.isInversed?-O*o:O*o}else y+=e.isInversed?-s*o:s*o;-1!==S.indexOf("...")&&this.heatMap.enableCanvasRendering&&this.heatMap.tooltipCollection.push(new ae(a[m],new J(w,L-M.height,M.width,M.height))),0!==s&&(m+=s-1)}n.enableCanvasRendering||t.appendChild(f)},e.prototype.drawYAxisLabels=function(e,i,n){var a=this.heatMap,l=e.axisLabels,o=n.height/e.axisLabelSize,s=0,r=n.height/(e.axisLabelSize/e.axisLabelInterval),h=e.axisLabelInterval;if(r>0)for(;r<parseInt(e.textStyle.size,10);)h+=1,r=n.height/(e.axisLabelSize/h);else h=e.tooltipLabels.length;e.axisLabelInterval<h&&(s=h,l=e.tooltipLabels);var p=10,d=n.y+(e.isInversed?0:n.height),c=e.opposedPosition?"start":"end";p=e.opposedPosition?p:-p;var g;a.enableCanvasRendering||(g=this.heatMap.renderer.createGroup({id:a.element.id+"YAxisLabels"}));for(var u=0,y=l.length;u<y;u++){var v=new J(n.x,d,n.width,o),f=v.height/2,m=v.x+p,b=v.y+(e.isInversed?f:-f),x=new q(a.element.id+"_YAxis_Label"+u,new Z(m,b,c,l[u],0,"rotate(0,"+m+","+b+")","middle"),e.textStyle,e.textStyle.color||a.themeStyle.axisLabel);if(t.Browser.isIE&&!a.enableCanvasRendering&&(x.dy="1ex"),this.drawSvgCanvas.createText(x,g,l[u]),0===s){var S="DateTime"===e.valueType&&"None"!==e.showLabelOn?e.dateTimeAxisLabelInterval[u]:e.axisLabelInterval;d+=e.isInversed?S*o:-S*o}else d+=e.isInversed?s*o:-s*o,u+=s-1}a.enableCanvasRendering||i.appendChild(g)},e}(),ce=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ge=function(e,t,i,n){var a,l=arguments.length,o=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(l<3?a(o):l>3?a(t,i,o):a(t,i))||o);return l>3&&o&&Object.defineProperty(t,i,o),o},ue=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ce(i,e),ge([t.Property(!0)],i.prototype,"showLabel",void 0),ge([t.Property("")],i.prototype,"format",void 0),ge([t.Property(!0)],i.prototype,"enableCellHighlighting",void 0),ge([t.Complex({},P)],i.prototype,"border",void 0),ge([t.Complex(C.rectLabelFont,T)],i.prototype,"textStyle",void 0),ge([t.Property("Rect")],i.prototype,"tileType",void 0),ge([t.Property("Color")],i.prototype,"bubbleType",void 0),ge([t.Property(!1)],i.prototype,"isInversedBubbleSize",void 0),i}(t.ChildProperty),ye=function(){function e(e){this.heatMap=e,this.drawSvgCanvas=new te(this.heatMap),this.cellColor=new B(this.heatMap)}return e.prototype.renderRectSeries=function(){this.createSeriesGroup();var e=this.heatMap;e.xLength=e.axisCollections[0].axisLabelSize,e.yLength=e.axisCollections[1].axisLabelSize;var i,n,a=Math.round(100*e.initialClipRect.x)/100,l=Math.round(100*e.initialClipRect.y)/100,o=0,s=0,r=e.cellSettings,h=Math.round((e.initialClipRect.width-r.border.width/2)/e.xLength*100)/100,p=Math.round((e.initialClipRect.height-r.border.width/2)/e.yLength*100)/100,d=0,c=(e.themeStyle,[]);i=r.border;var g;this.rectPositionCollection=[],this.color="",this.bubbleColorValue=[],e.yAxis.opposedPosition&&(a=Math.round(100*(e.initialClipRect.x+parseFloat(i.width.toString())/2))/100),n=this.getBubbleRadius(h,p);for(var u=0;u<e.xLength*e.yLength;u++){this.setTextAndColor(o,s);var y=new X(0,0,0,0,0,"");if(g=i.color,("Canvas"===e.renderingMode&&0===parseFloat(i.width.toString())||!g&&"Bubble"===r.tileType&&"Sector"===r.bubbleType)&&(g=this.color),this.heatMap.bubbleSizeWithColor?this.updateRectDetails(y,a,l,h,p,t.extend("",this.bubbleColorValue,null,!0),u):this.updateRectDetails(y,a,l,h,p,this.text,u),"Rect"===r.tileType)this.renderTileCell(y,i,u,this.color,g),this.updateLabelVisibleStatus(h,p);else if("Color"===r.bubbleType)this.renderBubbleCell(y,i,u,this.color,g,n),this.updateLabelVisibleStatus(2*n-12,2*n-6);else if(t.isNullOrUndefined(this.text)||"Size"!==r.bubbleType&&"SizeAndColor"!==r.bubbleType||""===this.text.toString())"Sector"!==r.bubbleType||t.isNullOrUndefined(this.text)||""===this.text.toString()||(this.renderSectorCell(y,i,u.toString(),this.color,g,n,this.text),this.checkLabelXDisplay=!1,this.checkLabelYDisplay=!1);else{var v=this.getRadiusBypercentage(parseFloat(this.text.toString()),e.dataSourceMinValue,e.dataSourceMaxValue,n);this.renderBubbleCell(y,i,u,this.color,g,v),this.updateLabelVisibleStatus(2*v-12,2*v-6)}if(c.push(y),r.showLabel&&this.checkLabelYDisplay&&this.checkLabelXDisplay){var f=this.getFormatedText(this.text,r.format),m=r.textStyle,b=new q(e.element.id+"_HeatMapRectLabels_"+u,new Z(Math.round(100*(a+h/2))/100,Math.round(100*(l+p/2))/100,"middle",f,null,null,"middle"),m,m.color||this.getSaturatedColor(this.color));t.Browser.isIE&&!e.enableCanvasRendering&&(b.dy="Bubble"===this.heatMap.cellSettings.tileType?"0.5ex":"1ex"),this.drawSvgCanvas.createText(b,this.containerTextObject,f)}d===e.xLength-1?(l=Math.round(100*(l+p))/100,d=0,s=0,a=e.yAxis.opposedPosition?Math.round(100*(e.initialClipRect.x+parseFloat(i.width.toString())/2))/100:Math.round(100*e.initialClipRect.x)/100,this.rectPositionCollection.push(c),c=[],o++):(a=Math.round(100*(a+h))/100,d++,s++)}e.enableCanvasRendering||(e.svgObject.appendChild(this.containerRectObject),!r.showLabel||"Bubble"===r.tileType&&"Sector"===r.bubbleType||e.svgObject.appendChild(this.containerTextObject))},e.prototype.setTextAndColor=function(e,i){this.heatMap.cellSettings;this.bubbleColorValue=[];var n=this.heatMap.dataSource,a=this.heatMap.clonedDataSource;if(this.heatMap.bubbleSizeWithColor){this.text=t.isNullOrUndefined(a[e][i][0])||""===a[e][i][0].toString()?"":a[e][i][0],this.color=t.isNullOrUndefined(a[e][i][1])||""===a[e][i][1].toString()?this.heatMap.isColorValueExist?this.heatMap.emptyPointColor:this.cellColor.getColorByValue(this.text):this.cellColor.getColorByValue(a[e][i][1]);var l=new _(n.isJsonData&&"Cell"===n.adaptorType?this.heatMap.dataSource.bubbleDataMapping.size:null,this.text,"Size");this.bubbleColorValue.push(l),this.bubbleColorValue.push({mappingName:n.isJsonData&&"Cell"===n.adaptorType?this.heatMap.dataSource.bubbleDataMapping.color:null,bubbleData:t.isNullOrUndefined(a[e][i][1])||""===a[e][i][1].toString()?"":a[e][i][1],valueType:"Color"})}else this.text=a[e][i],this.color=this.cellColor.getColorByValue(this.text)},e.prototype.createSeriesGroup=function(){this.heatMap.enableCanvasRendering||(this.containerRectObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_RectGroup",x:this.heatMap.initialClipRect.x,y:this.heatMap.initialClipRect.y,transform:"translate( 0, 0)"}),!this.heatMap.cellSettings.showLabel||"Bubble"===this.heatMap.cellSettings.tileType&&"Sector"===this.heatMap.cellSettings.bubbleType||(this.containerTextObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_TextGroup",transform:"translate( 0, 0)"})))},e.prototype.updateRectDetails=function(e,t,i,n,a,l,o){e.x=t,e.y=i,e.width=n,e.height=a,e.value=l,e.id=this.heatMap.element.id+"_HeatMapRect_"+o},e.prototype.renderTileCell=function(e,t,i,n,a){var l=new W(this.heatMap.element.id+"_HeatMapRect_"+i,n,t,1,new J(e.x,e.y,e.width,e.height),a||this.heatMap.themeStyle.cellBorder,t.radius,t.radius);this.drawSvgCanvas.drawRectangle(l,this.containerRectObject,!0)},e.prototype.getBubbleRadius=function(e,t){var i=e/2-2;return t/2<e/2&&(i=t/2-2),i<0?0:i},e.prototype.renderSectorCell=function(e,t,i,n,a,l,o){for(var s,r,h,p,d,c,g,u,y,v,f=Math.round(100*(e.x+e.width/2))/100,m=Math.round(100*(e.y+e.height/2))/100,b=n,x=this.getRadiusBypercentage(o,this.heatMap.dataSourceMinValue,this.heatMap.dataSourceMaxValue,360),S=0;S<2;S++){v=parseFloat(t.width.toString()),0===S?(s=x>=180?1:0,r=-90,h=0===x?270:x-90,p=Math.round(100*(f+l*Math.cos((x-90)*(Math.PI/180))))/100,d=Math.round(100*(m+l*Math.sin((x-90)*(Math.PI/180))))/100,c=Math.round(100*f)/100,g=Math.round(100*(m-l))/100,0===x&&(b=this.heatMap.emptyPointColor)):(s=x>=180?0:1,r=h,h=270,b=this.heatMap.emptyPointColor,i+="_Unfilled",u=p,y=d,p=c,d=g,c=u,g=y,0===x&&(v=1,a=n));var M=new ee("",!1,f,m,c,g,p,d,r,h,l,!0),C=new Q(this.heatMap.element.id+"_HeatMapRect_"+i,M,b,t,v,1,a);if(this.calculateShapes(C,M,x,s),this.drawSvgCanvas.drawPath(C,M,this.containerRectObject),360===x)break}},e.prototype.calculateShapes=function(e,i,n,a){var l;switch(n){case 360:case 0:l=0===n&&i.start===i.end?"M "+e.x+" "+e.y+" L "+i.x+" "+(i.y-i.radius):(l=this.heatMap.enableCanvasRendering?"":"M "+e.x+" "+e.y+" ")+"m "+-i.radius+" 0 a "+i.radius+" "+i.radius+" 0 1 0 "+2*i.radius+" 0 a "+i.radius+" "+i.radius+" 0 1 0 "+-2*i.radius+" 0 ",t.merge(e,{d:l});break;default:l="M "+e.x+" "+e.y+" L "+i.x1+" "+i.y1+" A "+i.radius+" "+i.radius+" 0 "+a+" 1 "+i.cx+" "+i.cy+" Z",t.merge(e,{d:l})}},e.prototype.renderBubbleCell=function(e,t,i,n,a,l){var o=new U(this.heatMap.element.id+"_HeatMapRect_"+i,n,t,1,a||this.heatMap.themeStyle.cellBorder,Math.round(100*(e.x+e.width/2))/100,Math.round(100*(e.y+e.height/2))/100,l);this.drawSvgCanvas.drawCircle(o,this.containerRectObject)},e.prototype.updateLabelVisibleStatus=function(e,t){var i=this.getFormatedText(this.text,this.heatMap.cellSettings.format);this.checkLabelYDisplay=t>parseInt(this.heatMap.cellSettings.textStyle.size,10),this.checkLabelXDisplay=e>i.length*(parseInt(this.heatMap.cellSettings.textStyle.size,10)/2)},e.prototype.getRadiusBypercentage=function(e,t,i,n){var a=(e-t)/(i-t)*100;return n=(this.heatMap.bubbleSizeWithColor||"Bubble"===this.heatMap.cellSettings.tileType&&"Size"===this.heatMap.cellSettings.bubbleType)&&this.heatMap.cellSettings.isInversedBubbleSize?n-n*(a/100):n*(a/100),Math.round(100*n)/100<0?0:Math.round(100*n)/100},e.prototype.getSaturatedColor=function(e){var t=e,i=M(b(t="transparent"===t?window.getComputedStyle(document.body,null).backgroundColor:t));return Math.round((299*i.R+587*i.G+114*i.B)/1e3)>=128?"black":"white"},e.prototype.highlightSvgRect=function(e){if(-1===e.indexOf("Celltooltip"))if(-1!==e.indexOf("_HeatMapRect")){if(-1!==e.indexOf("_HeatMapRectLabels_")){var t=e.indexOf("_HeatMapRectLabels_")+19;e=this.heatMap.element.id+"_HeatMapRect_"+e.slice(t)}var i=document.getElementById(e);if(this.heatMap.tempRectHoverClass!==e){if(this.heatMap.cellSettings.enableCellHighlighting){(n=document.getElementById(this.heatMap.tempRectHoverClass))&&(n.style.opacity="1"),i&&(i.style.opacity="0.65")}this.heatMap.tempRectHoverClass=e}}else if(this.heatMap.cellSettings.enableCellHighlighting){var n;(n=document.getElementById(this.heatMap.tempRectHoverClass))&&(n.style.opacity="1",this.heatMap.tempRectHoverClass="")}},e.prototype.getFormatedText=function(e,t){var i=t,n=null!==i.match("{value}");this.format=this.heatMap.intl.getNumberFormat({format:n?"":i});var a="";return""!==e.toString()&&(a=this.formatValue(n,i,e)),a},e.prototype.getCurrentRect=function(e,t){var i,n=[];n.push(this.heatMap.heatMapSeries.rectPositionCollection[0][0]);var a=Math.ceil((e-n[0].x)/n[0].width)<this.heatMap.axisCollections[0].axisLabelSize?Math.ceil((e-n[0].x)/n[0].width):this.heatMap.axisCollections[0].axisLabelSize,l=Math.floor((t-n[0].y)/n[0].height)<this.heatMap.axisCollections[1].axisLabelSize?Math.floor((t-n[0].y)/n[0].height):this.heatMap.axisCollections[1].axisLabelSize-1;return a=0===a?1:a,i=this.heatMap.heatMapSeries.rectPositionCollection[l][a-1],this.hoverXAxisLabel=this.heatMap.axisCollections[0].tooltipLabels[a-1],this.hoverXAxisValue=this.heatMap.axisCollections[0].labelValue[a-1],this.hoverYAxisLabel=this.heatMap.axisCollections[1].tooltipLabels[this.heatMap.axisCollections[1].tooltipLabels.length-1-l],this.hoverYAxisValue=this.heatMap.axisCollections[1].labelValue[this.heatMap.axisCollections[1].labelValue.length-1-l],i},e.prototype.formatValue=function(e,t,i){return e?t.replace("{value}",this.format(i)):this.format(i)},e}(),ve=function(){function e(e){this.heatMap=e}return e.prototype.processDataSource=function(e){var i=t.extend([],e,null,!0);this.heatMap.clonedDataSource=[],this.completeDataSource=[];var n,a,l,o=this.heatMap.axisCollections,s=o[0].maxLength+1,r=o[0].axisLabelSize+(o[0].min>0?o[0].min:0),h=s>r?s:r,p=(s=o[1].maxLength+1)>(r=o[1].axisLabelSize+(o[1].min>0?o[1].min:0))?s:r,d=0,c=[];this.tempSizeArray=[],this.tempColorArray=[],this.heatMap.minColorValue=null,this.heatMap.maxColorValue=null;for(var g="Category"===o[1].valueType?o[1].min:0;g<p;g++){var u="Category"===o[0].valueType?o[0].min:0;for(this.completeDataSource.push([]);u<h;)u>=o[0].min&&u<=o[0].max&&this.processDataArray(i,u,g,d),u++;l=t.extend([],this.completeDataSource[d],null,!0);var y=this.getMinMaxValue(n,a,l);n=y[0],a=y[1],this.heatMap.xAxis.isInversed&&(this.completeDataSource[d]=this.completeDataSource[d].reverse()),g>=this.heatMap.axisCollections[1].min&&g<=this.heatMap.axisCollections[1].max&&c.push(this.completeDataSource[d]),d++}this.heatMap.yAxis.isInversed||(this.completeDataSource.reverse(),c.reverse()),this.heatMap.clonedDataSource=c,this.heatMap.dataSourceMinValue=t.isNullOrUndefined(n)?0:parseFloat(n.toString()),this.heatMap.dataSourceMaxValue=t.isNullOrUndefined(a)?0:parseFloat(a.toString()),this.heatMap.isColorValueExist=!t.isNullOrUndefined(this.heatMap.minColorValue),this.heatMap.minColorValue=t.isNullOrUndefined(this.heatMap.minColorValue)?this.heatMap.dataSourceMinValue:parseFloat(this.heatMap.minColorValue.toString()),this.heatMap.maxColorValue=t.isNullOrUndefined(this.heatMap.maxColorValue)?this.heatMap.dataSourceMaxValue:parseFloat(this.heatMap.maxColorValue.toString())},e.prototype.processDataArray=function(e,i,n,a){if(this.heatMap.bubbleSizeWithColor)if(e[i]&&!t.isNullOrUndefined(e[i][n])&&"object"==typeof e[i][n]){for(var l=e[i][n],o=0;o<l.length;o++)if(t.isNullOrUndefined(l[o])&&(l[o]=""),0===o)this.tempSizeArray.push(l[o]);else if(1===o){this.tempColorArray.push(l[o]);break}this.completeDataSource[a].push(l)}else!t.isNullOrUndefined(e[i])&&(e[i][n]||0===e[i][n]&&""!==e[i][n].toString())?(this.completeDataSource[a].push([e[i][n]]),this.tempSizeArray.push(e[i][n])):this.completeDataSource[a].push("");else e[i]&&(e[i][n]||0===e[i][n]&&""!==e[i][n].toString())?"object"==typeof e[i][n]?e[i][n].length>0&&!t.isNullOrUndefined(e[i][n][0])?this.completeDataSource[a].push(e[i][n][0]):this.completeDataSource[a].push(""):this.completeDataSource[a].push(e[i][n]):this.completeDataSource[a].push("")},e.prototype.getMinMaxValue=function(e,t,i){var n=[];return this.heatMap.bubbleSizeWithColor?(n.push(this.getMinValue(e,this.tempSizeArray)),n.push(this.getMaxValue(t,this.tempSizeArray)),this.heatMap.minColorValue=this.getMinValue(this.heatMap.minColorValue,this.tempColorArray),this.heatMap.maxColorValue=this.getMaxValue(this.heatMap.maxColorValue,this.tempColorArray)):(n.push(this.getMinValue(e,i)),n.push(this.getMaxValue(t,i))),n},e.prototype.getMinValue=function(e,i){return t.isNullOrUndefined(e)?e=this.performSort(i):this.performSort(i)<e&&(e=this.performSort(i)),t.isNullOrUndefined(e)?e:parseFloat(e.toString())},e.prototype.getMaxValue=function(e,i){return t.isNullOrUndefined(e)&&i.length>0?e=Math.max.apply(Math,i):Math.max.apply(Math,i)>e&&(e=Math.max.apply(Math,i)),t.isNullOrUndefined(e)?e:parseFloat(e.toString())},e.prototype.performSort=function(e){return e.sort(function(e,t){return e-t}).filter(this.checkmin)[0]},e.prototype.checkmin=function(e){return!t.isNullOrUndefined(e)&&""!==e.toString()},e}(),fe=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),me=function(e,t,i,n){var a,l=arguments.length,o=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(l<3?a(o):l>3?a(t,i,o):a(t,i))||o);return l>3&&o&&Object.defineProperty(t,i,o),o},be=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return fe(i,e),me([t.Property("")],i.prototype,"height",void 0),me([t.Property("")],i.prototype,"width",void 0),me([t.Property("Right")],i.prototype,"position",void 0),me([t.Property(!0)],i.prototype,"visible",void 0),me([t.Property("Center")],i.prototype,"alignment",void 0),me([t.Property(!0)],i.prototype,"showLabel",void 0),me([t.Property(!0)],i.prototype,"showGradientPointer",void 0),me([t.Property(!1)],i.prototype,"enableSmartLegend",void 0),me([t.Property("All")],i.prototype,"labelDisplayType",void 0),me([t.Complex(C.legendLabelFont,T)],i.prototype,"textStyle",void 0),i}(t.ChildProperty),xe=function(){function e(e){this.maxLegendLabelSize=new j(0,0),this.gradientScaleSize=10,this.segmentCollections=[],this.textWrapCollections=[],this.labelCollections=[],this.legendSize=10,this.previousOptions=new oe(0,0,0,0,0,0),this.listPerPage=0,this.numberOfPages=1,this.listWidth=0,this.fillRect=new J(0,0,0,0),this.legendRect=new J(0,0,0,0),this.currentPage=1,this.lastList=[],this.navigationCollections=[],this.pagingRect=new J(0,0,0,0),this.listInterval=10,this.legendLabelTooltip=[],this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],this.legendRectPositionCollection=[],this.heatMap=e,this.drawSvgCanvas=new te(e)}return e.prototype.getModuleName=function(){return"Legend"},e.prototype.destroy=function(e){},e.prototype.renderLegendItems=function(){var e=this.heatMap,t={color:"transparent",width:0};this.legend=e.renderer.createGroup({id:e.element.id+"_Heatmap_Legend"});var i=new W(e.element.id+"_LegendBound","none",t,1,this.legendGroup);this.drawSvgCanvas.drawRectangle(i,this.legend);var n=this.legendRectScale,a=new J(n.x,n.y,n.width,n.height);if("Gradient"===e.paletteSettings.type||"Fixed"===e.paletteSettings.type&&!0===e.legendSettings.enableSmartLegend){if("Gradient"===e.paletteSettings.type){var l=void 0;if(e.enableCanvasRendering){var o=void 0,s=e.canvasRenderer.ctx;o=e.horizontalGradient?s.createLinearGradient(n.x,0,n.x+n.width,0):s.createLinearGradient(0,n.y,0,n.y+n.height);for(var r=0;r<e.legendColorCollection.length;r++){var h=(e.legendColorCollection[r].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);h=isNaN(h)?0:h,o.addColorStop(h,e.legendColorCollection[r].color)}s.fillStyle=o,l=o.toString()}else{var p=void 0,d=void 0,c=[];for(r=0;r<e.legendColorCollection.length;r++){var g=(e.legendColorCollection[r].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;g=isNaN(g)?0:g,d=new ne(e.legendColorCollection[r].color,g+"%"),c.push(d)}p=e.horizontalGradient?new ie(e.element.id+"_lineargradient","0%","100%","0%","0%"):new ie(e.element.id+"_lineargradient","0%","0%","0%","100%");var u=e.renderer.drawGradient("linearGradient",p,c);this.legend.appendChild(u),l="url(#"+e.element.id+"_lineargradient)"}var y=new W(e.element.id+"_Gradient_Legend",l,t,1,a);this.drawSvgCanvas.drawRectangle(y,this.legend),this.renderColorAxisGrid(a)}else this.renderSmartLegend();e.enableCanvasRendering||e.svgObject.appendChild(this.legend),e.legendSettings.showLabel&&("Gradient"===e.paletteSettings.type||"Fixed"===e.paletteSettings.type&&"None"!==e.legendSettings.labelDisplayType)&&this.renderLegendLabel(a)}else{this.legendScale=e.renderer.createGroup({id:e.element.id+"Heatmap_GradientScale"});var v=new W(e.element.id+"_Gradient_Scale","none",t,1,this.legendRectScale);this.drawSvgCanvas.drawRectangle(v,this.legendScale),e.enableCanvasRendering||this.legend.appendChild(this.legendScale),this.translategroup=e.renderer.createGroup({id:e.element.id+"_translate"}),this.calculateListPerPage(a),this.numberOfPages>1&&(this.paginggroup=e.renderer.createGroup({id:e.element.id+"_navigation"})),this.renderListLegendMode(a)}},e.prototype.renderSmartLegend=function(){var e,t,i,n,a,o=this.heatMap,s=o.colorCollection,r={color:"transparent",width:0},h=this.legendRectScale,d=h.width/s.length,c=h.height/s.length;this.legendRectPositionCollection=[];for(var g=0;g<s.length;g++){var u=new se(0,0,0,0,"","");o.horizontalGradient?(t=h.x+g*d,i=h.y,n=d,a=h.height,this.segmentCollections.push("Edge"===o.legendSettings.labelDisplayType&&g===s.length-1?t+d:t)):(t=h.x,i=h.y+g*c,n=h.width,a=c,this.segmentCollections.push("Edge"===o.legendSettings.labelDisplayType&&g===s.length-1?i+c:i)),e=new J(t,i,n,a);var y=new W(o.element.id+"_Smart_Legend"+g,s[g].color,r,1,e);this.drawSvgCanvas.drawRectangle(y,this.legend),u.x=t,u.y=i,u.width=n,u.height=a,u.label=this.labelCollections[g],u.id=o.element.id+"_Smart_Legend"+g,this.legendRectPositionCollection.push(u);if(0!==p(this.labelCollections[g],o.legendSettings.textStyle,this.textWrapCollections[g]).length&&o.enableCanvasRendering){var v=l(this.labelCollections[g],o.legendSettings.textStyle);this.legendLabelTooltip.push(new ae(this.labelCollections[g],new J(u.x,u.y,v.width,v.height)))}}},e.prototype.renderLegendLabel=function(e){var i,n,a,o,s=this.heatMap,r=0;this.legendLabelTooltip=[];var h="Gradient"===s.paletteSettings.type?s.legendColorCollection:s.colorCollection;if(s.enableCanvasRendering){var d=s.canvasRenderer.ctx;d.rect(this.legendGroup.x,this.legendGroup.y,this.legendGroup.width,this.legendGroup.height),d.clip()}else a=s.renderer.createGroup({id:s.element.id+"_Heatmap_LegendLabel"});for(var c,g,u=0;u<h.length;u++){var y=(h[u].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;if(s.horizontalGradient?(c=this.segmentCollections[u],g=e.y+e.height+this.labelPadding,i=0===y||"Fixed"===s.paletteSettings.type?"Edge"===s.legendSettings.labelDisplayType&&u===h.length-1?"end":"start":u===h.length-1?"end":"middle",n="hanging"):(c=e.x+e.width+this.labelPadding,g=this.segmentCollections[u],n=0===y||"Fixed"===s.paletteSettings.type?"Edge"===s.legendSettings.labelDisplayType&&u===h.length-1?"baseline":"hanging":u===h.length-1?"baseline":"middle"),r=s.horizontalGradient?this.textWrapCollections[u]:this.width-(this.legendRectScale.width+this.labelPadding+this.legendRectPadding),""!==this.labelCollections[u]){if(0!==(o=p(this.labelCollections[u],s.legendSettings.textStyle,r)).length&&-1!==o[0].indexOf("...")&&s.enableCanvasRendering){var v=l(o[0],s.legendSettings.textStyle);this.legendLabelTooltip.push(new ae(this.labelCollections[u],new J(c,g,v.width,v.height)))}var f=new Z(c,g,i,o,0,"translate(0,0)",n),m=new q(s.element.id+"_Legend_Label"+u,f,s.legendSettings.textStyle,s.legendSettings.textStyle.color||s.themeStyle.legendLabel);o.length>1?this.drawSvgCanvas.createWrapText(m,s.legendSettings.textStyle,a):this.drawSvgCanvas.createText(m,a,o[0]),t.Browser.isIE&&!s.enableCanvasRendering&&("middle"===n?a.lastChild.setAttribute("dy","0.6ex"):"hanging"===n&&a.lastChild.setAttribute("dy","1.5ex"))}}if(!s.enableCanvasRendering){this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0,this.legend.appendChild(a);var b=s.renderer.createClipPath({id:s.element.id+"_clipPath"}),x=s.renderer.drawRectangle(this.legendGroup);b.appendChild(x),s.svgObject.appendChild(b),this.legend.setAttribute("style","clip-path:url(#"+b.id+")")}},e.prototype.renderGradientPointer=function(e,t,i){var n,a,l,o,s,r,h,p,d,c=this.heatMap,g=c.heatMapSeries.getCurrentRect(t,i),u=c.bubbleSizeWithColor?""!==g.value[0].bubbleData.toString()?this.heatMap.isColorValueExist?g.value[1].bubbleData.toString():g.value[0].bubbleData.toString():"":g.value.toString(),y=this.legendRectScale;if(""!==u.toString())if(c.horizontalGradient?(l=y.width/100*((Number(u)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,o=y.x+l,s=y.y+y.height,r=y.x-5+l,h=d=y.y+y.height+8,p=y.x+5+l):(l=y.height/100*((Number(u)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,o=y.x-1,s=y.y+l,r=p=y.x-8,h=y.y-5+l,d=y.y+5+l),n="M "+o+" "+s+" L "+r+" "+h+" L "+p+" "+d+" Z",a=new k(c.element.id+"_Gradient_Pointer","gray",.01,"#A0A0A0",1,"0,0",n),c.enableCanvasRendering){this.removeGradientPointer();c.canvasRenderer.drawPath(a,void 0),this.previousOptions.pathX1=o,this.previousOptions.pathY1=s,this.previousOptions.pathX2=r,this.previousOptions.pathY2=h,this.previousOptions.pathX3=p,this.previousOptions.pathY3=d}else this.gradientPointer=c.renderer.drawPath(a),this.gradientPointer.style.visibility="visible",this.legend.appendChild(this.gradientPointer);else this.removeGradientPointer()},e.prototype.removeGradientPointer=function(){var e=this.heatMap;this.gradientPointer&&!e.enableCanvasRendering?this.gradientPointer.style.visibility="hidden":e.enableCanvasRendering&&(0!==Object.keys(this.previousOptions).length&&(e.horizontalGradient?(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY1,this.fillRect.width=this.previousOptions.pathX3-this.previousOptions.pathX2+2,this.fillRect.height=this.previousOptions.pathY2+1-this.previousOptions.pathY1):(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY2-1,this.fillRect.width=this.previousOptions.pathX1-this.previousOptions.pathX2+1,this.fillRect.height=this.previousOptions.pathY3-this.previousOptions.pathY2+2)),e.canvasRenderer.ctx.fillStyle=e.themeStyle.background,e.canvasRenderer.ctx.fillRect(this.fillRect.x,this.fillRect.y,this.fillRect.width,this.fillRect.height))},e.prototype.calculateLegendBounds=function(e){var t=this.heatMap,i=t.legendSettings,n=t.legendColorCollection;if(this.labelCollections=[],"Bottom"!==i.position&&"Top"!==i.position&&"Right"!==i.position&&"Left"!==i.position&&(i.position="Right"),t.horizontalGradient="Bottom"===i.position||"Top"===i.position,this.legendRectPadding=t.horizontalGradient?16:10,this.labelPadding=i.showLabel?this.heatMap.horizontalGradient?10:6:0,this.legendHeight=i.height,this.legendWidth=i.width,"Fixed"===t.paletteSettings.type)for(var l=t.colorCollection,o=0;o<l.length;o++){var s=l[o].label?l[o].label:l[o].value.toString();t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&o>0&&o<l.length-1?this.labelCollections.push(""):this.labelCollections.push(s)}else for(o=0;o<n.length;o++){s=n[o].isHidden?"":n[o].label?n[o].label:n[o].value.toString();this.labelCollections.push(s)}"Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend?(this.maxLegendLabelSize=this.getMaxLabelSize(),t.horizontalGradient&&""===i.height?this.legendHeight=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.height).toString():!t.horizontalGradient&&""===i.width&&("None"===i.textStyle.textOverflow||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend&&"None"===t.legendSettings.labelDisplayType)&&(this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.width).toString())):this.calculateListLegendBounds(e),this.legendHeight=this.legendHeight?this.legendHeight:t.horizontalGradient?"50":"100%",this.legendWidth=this.legendWidth?this.legendWidth:t.horizontalGradient?"100%":"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?"50":"70",this.height=a(this.legendHeight,e.height),this.width=a(this.legendWidth,e.width),t.horizontalGradient?(this.height="Gradient"===t.paletteSettings.type&&this.height<50?50:this.height,"Top"===i.position&&(e.y+=this.height),e.height-=this.height):(this.width="Gradient"===t.paletteSettings.type&&this.width<50?50:this.width,"Left"===i.position&&(e.x+=this.width),e.width-=this.width)},e.prototype.calculateListLegendBounds=function(e){var t=this.heatMap;this.listWidth=0,this.listHeight=0,this.currentPage=1;if(t.horizontalGradient){for(var i=0;i<t.colorCollection.length;i++){var n=0;if(t.legendSettings.showLabel){n=l(this.labelCollections[i],t.legendSettings.textStyle).width}var o=this.legendSize+this.labelPadding+n+this.listInterval;this.listWidth+=o}this.listWidth+=this.listInterval+10,""===this.legendWidth&&(this.legendWidth=this.listWidth>e.width?e.width.toString():this.listWidth.toString()),""===this.legendHeight&&(this.numberOfRows=Math.ceil(this.listWidth/a(this.legendWidth,e.width)),this.numberOfRows=this.numberOfRows>3?3:this.numberOfRows,this.legendHeight=(this.listWidth>e.width||this.listWidth>a(this.legendWidth,e.width))&&this.numberOfRows>3?((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding+parseInt(t.legendSettings.textStyle.size,10)+10).toString():((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding).toString())}else this.listHeight=(this.legendSize+this.listInterval)*t.colorCollection.length+this.listInterval,""===this.legendHeight&&(this.legendHeight=this.listHeight>e.height?e.height.toString():this.listHeight.toString()),""===this.legendWidth&&"Trim"!==t.legendSettings.textStyle.textOverflow&&(this.maxLegendLabelSize=this.getMaxLabelSize(),this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.labelPadding+this.maxLegendLabelSize.width).toString());a(this.legendHeight,e.height)<50&&(this.legendHeight="50"),a(this.legendWidth,e.width)<70&&(this.legendWidth="70")},e.prototype.getMaxLabelSize=function(){var e=this.heatMap;if(this.maxLegendLabelSize=new j(0,0),!e.legendSettings.showLabel||e.horizontalGradient&&"Fixed"===e.paletteSettings.type&&!e.legendSettings.enableSmartLegend||"Fixed"===e.paletteSettings.type&&"None"===e.legendSettings.labelDisplayType)return this.maxLegendLabelSize;for(var t=this.maxLegendLabelSize,i=0;i<e.colorCollection.length;i++){var n=l(this.labelCollections[i],e.legendSettings.textStyle);t.width=t.width>n.width?t.width:n.width,t.height=t.height>n.height?t.height:n.height}return t},e.prototype.calculateLegendSize=function(e,t){var i,n,o=this.heatMap,s=o.legendSettings,r=s.alignment,h=a(this.legendHeight,e.height),p=a(this.legendWidth,e.width),d=o.axisCollections,c=0;if(o.horizontalGradient){p=p>e.width?e.width:p,h="Gradient"===o.paletteSettings.type?h>50?h:50:this.height,i="Near"===r?e.x:"Far"===r?e.x+e.width-p:e.x+e.width/2-p/2,""!==o.xAxis.title.text&&(c=l(o.xAxis.title.text,o.xAxis.textStyle).height+10);var g=d[0].opposedPosition?0:d[0].maxLabelSize.height+c+10;n="Top"===s.position?o.titleSettings.text?t:o.margin.top:e.y+e.height+g}else{h=h>e.height?e.height:h,p="Gradient"===o.paletteSettings.type?p>50?p:50:p,n="Near"===r?e.y:"Far"===r?e.y+e.height-h:e.y+e.height/2-h/2,""!==o.yAxis.title.text&&(c=l(o.yAxis.title.text,o.yAxis.textStyle).height+10);var u=d[1].opposedPosition?d[1].maxLabelSize.width+c+10:0;i="Right"===s.position?e.x+e.width+u:o.margin.left}this.legendGroup=new J(i,n,p,h),this.calculateGradientScale(this.legendGroup)},e.prototype.measureListLegendBound=function(e){var t=this.heatMap;if(this.numberOfPages=1,t.horizontalGradient)this.listWidth>this.width?(this.numberOfRows=Math.ceil(this.listWidth/this.width),this.listHeight=(this.legendSize+this.listInterval)*this.numberOfRows,this.listPerPage=this.numberOfRows<=3?this.numberOfRows:Math.ceil((this.height-15-parseInt(t.legendSettings.textStyle.size,10)-this.legendRectPadding)/(this.legendSize+this.listInterval)),this.numberOfPages=Math.ceil(this.numberOfRows/this.listPerPage)):this.listPerPage=1;else if(this.listHeight>e.height||this.listHeight>this.height){var i=a(this.legendHeight,e.height);i=i>e.height?e.height:i,this.listPerPage=Math.floor(i/(this.legendSize+this.listInterval)-1),this.numberOfPages=Math.max(1,Math.ceil(t.colorCollection.length/this.listPerPage))}else this.listPerPage=t.colorCollection.length,this.legendHeight=this.listHeight.toString()},e.prototype.renderPagingElements=function(){var e=this.heatMap;if(this.numberOfPages>1){this.navigationCollections=[],this.legend.appendChild(this.paginggroup);var i=this.legendGroup.x+this.legendGroup.width-10,n=this.legendGroup.y+this.legendGroup.height-10,a=this.currentPage+"/"+this.numberOfPages,o=l(a,e.legendSettings.textStyle),s=i-o.width-15,r=new Z(s,n,"start",a,0,"translate(0,0)","middle"),h=new q(e.element.id+"_paging",r,e.legendSettings.textStyle,e.legendSettings.textStyle.color||e.themeStyle.legendLabel);this.drawSvgCanvas.createText(h,this.paginggroup,a),t.Browser.isIE&&!e.enableCanvasRendering&&this.paginggroup.lastChild.setAttribute("dy","0.6ex"),this.pagingRect=new J(s,n-o.height/2,o.width,o.height);var p=new W(e.element.id+"_pagingText","none",{color:"transparent",width:0},1,this.pagingRect);this.drawSvgCanvas.drawRectangle(p,this.paginggroup);var d=new W(e.element.id+"_rightArrow","none",{color:"transparent",width:0},1,new J(i-10,n-5,10,10));this.drawSvgCanvas.drawRectangle(d,this.paginggroup);var c="M "+i+" "+n+" L "+(i-10)+" "+(n-5)+" L "+(i-10)+" "+(n+5)+"Z",g=s-15,u="M "+g+" "+n+" L "+(g+10)+" "+(n-5)+" L "+(g+10)+" "+(n+5)+"Z",y=new W(e.element.id+"_leftArrow","none",{color:"transparent",width:0},1,new J(g,n-5,10,10));this.drawSvgCanvas.drawRectangle(y,this.paginggroup);var v=new k(e.element.id+"_Legend_leftarrow","gray",.01,"#A0A0A0",1,"0,0",u),f=new k(e.element.id+"_Legend_rightarrow","gray",.01,"#A0A0A0",1,"0,0",c);if(this.navigationCollections.push(d),this.navigationCollections.push(y),e.enableCanvasRendering){e.canvasRenderer.drawPath(v,void 0),e.canvasRenderer.drawPath(f,void 0)}else{var m=e.renderer.drawPath(v),b=e.renderer.drawPath(f);this.paginggroup.appendChild(m),this.paginggroup.appendChild(b)}}},e.prototype.calculateGradientScale=function(e){var t,i,n,a,l=this.heatMap;"Fixed"!==l.paletteSettings.type||l.legendSettings.enableSmartLegend||this.measureListLegendBound(l.initialClipRect),l.horizontalGradient?(t=e.x+10,i=e.y+this.legendRectPadding,a="Fixed"!==l.paletteSettings.type||l.legendSettings.enableSmartLegend?e.width-20:e.width-2*this.listInterval,n="Fixed"!==l.paletteSettings.type||l.legendSettings.enableSmartLegend?this.gradientScaleSize:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval):(t=e.x+this.legendRectPadding,i=e.y+10,a="Fixed"!==l.paletteSettings.type||l.legendSettings.enableSmartLegend?this.gradientScaleSize:e.width-10,n="Fixed"!==l.paletteSettings.type||l.legendSettings.enableSmartLegend?e.height-20:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval),this.legendRectScale=new J(t,i,a,n),("Gradient"===l.paletteSettings.type||"Fixed"===l.paletteSettings.type&&l.legendSettings.enableSmartLegend)&&this.calculateColorAxisGrid(this.legendRectScale)},e.prototype.calculateColorAxisGrid=function(e){var t,i,n=this.heatMap,a=this.legendRectScale,l=0;this.segmentCollections=[],this.textWrapCollections=[];var o,s,r="Gradient"===n.paletteSettings.type?n.legendColorCollection:n.colorCollection,h=n.bubbleSizeWithColor?n.minColorValue:n.dataSourceMinValue,d=n.bubbleSizeWithColor?n.maxColorValue:n.dataSourceMaxValue;if(this.legendMinValue=r[0].value>h?h:r[0].value,this.legendMaxValue=r[r.length-1].value<d?d:r[r.length-1].value,"Gradient"===n.paletteSettings.type)for(var c=0;c<r.length;c++){var g=(r[c].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;g=isNaN(g)?0:g,n.horizontalGradient?(t=a.width/100,o=e.x+t*g,this.segmentCollections.push(o)):(t=a.height/100,s=e.y+t*g,this.segmentCollections.push(s))}var u;if(n.horizontalGradient){for(var y=0;y<r.length;y++){if("Gradient"===n.paletteSettings.type){var v=(this.segmentCollections[y]-this.segmentCollections[y-1])/2,f=(this.segmentCollections[y+1]-this.segmentCollections[y])/2;u=y===r.length-1?v:0===y?f:v<f?v:f}else u=this.legendRectScale.width/n.colorCollection.length;this.textWrapCollections.push(u),l=(i=p(this.labelCollections[y],n.legendSettings.textStyle,u)).length>l?i.length:l}"Bottom"===n.legendSettings.position?(n.initialClipRect.height-=this.maxLegendLabelSize.height*(l-1),this.legendGroup.y-=this.maxLegendLabelSize.height*(l-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(l-1)):(n.initialClipRect.y+=this.maxLegendLabelSize.height*(l-1),n.initialClipRect.height-=this.maxLegendLabelSize.height*(l-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(l-1))}},e.prototype.renderColorAxisGrid=function(e){var t,i,n,a,l,o=this.heatMap;o.enableCanvasRendering||(t=this.heatMap.renderer.createGroup({id:o.element.id+"_ColorAxis_Grid"}));for(var s=0;s<o.legendColorCollection.length;s++){o.horizontalGradient?(i=a=this.segmentCollections[s],n=e.y,l=e.y+e.height):(i=e.x,n=l=this.segmentCollections[s],a=e.x+e.width);var r=new $(i,n,a,l),h=new K(this.heatMap.element.id+"_ColorAxis_Grid"+s,r,"#EEEEEE",1);this.drawSvgCanvas.drawLine(h,t),o.enableCanvasRendering||this.legend.appendChild(t)}},e.prototype.renderLegendLabelTooltip=function(e){var t=this.heatMap.mouseX,i=this.heatMap.mouseY;if(-1!==e.target.id.indexOf("_Legend_Label")&&event.target.textContent.indexOf("...")>-1){var n=event.target.id.split(this.heatMap.element.id+"_Legend_Label");if(2===n.length){var a=void 0;a=1===n[1].length||"Trim"===this.heatMap.legendSettings.textStyle.textOverflow?parseInt(n[1],10):parseInt(n[1].substring(0,n[1].length-1),10),u(this.labelCollections[a],t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_LegendLabel_Tooltip",v(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip").style.visibility="visible"}}else{var l=document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip");l&&(l.style.visibility="hidden")}},e.prototype.calculateListPerPage=function(e){var t=this.heatMap;if(t.horizontalGradient){this.lastList=[];var i=e.x,n=e.y,a=0,o=0,s=0,r=0,h=void 0;for(this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],h=0;h<t.colorCollection.length;h++){if(t.legendSettings.showLabel){a=l(this.labelCollections[h],t.legendSettings.textStyle).width}s=i+10+5,r=n+5;var p=t.legendSettings.showLabel?s+a:i+this.legendSize+this.listInterval;0!==h&&p>this.legendGroup.width+this.legendGroup.x-this.listInterval&&(o+=1,s=(i=e.x)+10+5,r=(n=e.y+20*o)+5,o%this.listPerPage==0&&(this.lastList.push(h),r=(n=e.y)+5,o=0)),this.labelXCollections.push(s),this.labelYCollections.push(r),this.legendXCollections.push(i),this.legendYCollections.push(n),i=i+this.legendSize+this.labelPadding+a+this.listInterval}this.lastList.push(h),this.numberOfPages=this.lastList.length}},e.prototype.renderListLegendMode=function(e){var i=this.heatMap,n={color:"transparent",width:0};this.legendLabelTooltip=[];var a,o=new j(0,0),s=0,r=0,h=e.x,d=e.y;this.renderPagingElements();var c,g,u=this.legendGroup.width-(this.legendSize+this.legendRectPadding+this.labelPadding);i.horizontalGradient?(c=1===this.currentPage?0:this.lastList[this.currentPage-2],g=this.lastList[this.currentPage-1]):g=(g=(c=this.currentPage*this.listPerPage-this.listPerPage)+this.listPerPage)<i.colorCollection.length?g:i.colorCollection.length;for(var y=c;y<g;y++){if(i.legendSettings.showLabel){o=l(v=this.labelCollections[y],i.legendSettings.textStyle)}if(i.horizontalGradient&&(h=this.legendXCollections[y],d=this.legendYCollections[y],s=this.labelXCollections[y],r=this.labelYCollections[y]),i.legendSettings.showLabel){s=h+this.legendSize+this.labelPadding,r=d+5;var v;-1!==(v=p(this.labelCollections[y],i.legendSettings.textStyle,u))[0].indexOf("...")&&i.enableCanvasRendering&&this.legendLabelTooltip.push(new ae(this.labelCollections[y],new J(s,r,o.width,o.height)));var f=new Z(s,r,"start",v,0,"translate(0,0)","middle"),m=new q(i.element.id+"_Legend_Label"+y,f,i.legendSettings.textStyle,i.legendSettings.textStyle.color||i.themeStyle.legendLabel);v.length>1?this.drawSvgCanvas.createWrapText(m,i.legendSettings.textStyle,this.translategroup):this.drawSvgCanvas.createText(m,this.translategroup,v[0]),t.Browser.isIE&&!i.enableCanvasRendering&&this.translategroup.lastChild.setAttribute("dy","0.6ex")}a=new J(h,d,10,10);var b=new W(i.element.id+"_legend_list"+y,i.colorCollection[y].color,n,1,a);this.drawSvgCanvas.drawRectangle(b,this.translategroup),i.horizontalGradient?h=h+this.legendSize+this.labelPadding+o.width+this.listInterval:d+=this.legendSize+this.listInterval}if(!i.enableCanvasRendering){this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0;var x=i.renderer.createClipPath({id:i.element.id+"_LegendScale_ClipPath"}),S=i.renderer.drawRectangle(this.legendGroup);x.appendChild(S),this.translategroup.appendChild(x),this.translategroup.setAttribute("style","clip-path:url(#"+x.id+")"),this.legendScale.appendChild(this.translategroup),i.svgObject.appendChild(this.legend)}},e.prototype.translatePage=function(e,t,i){if(i&&t>=1&&t<this.numberOfPages||!i&&t>1&&t<=this.numberOfPages){if(i?(this.currentPage+=1,this.legendRect.y+=this.legendRect.height):(this.currentPage-=1,this.legendRect.y-=this.legendRect.height),e.enableCanvasRendering){var n=e.canvasRenderer.ctx;n.fillRect(this.legendRectScale.x-5,this.legendRectScale.y-5,this.legendRectScale.width+5,this.legendRectScale.height+10),n.fillRect(this.pagingRect.x,this.pagingRect.y,this.pagingRect.width,this.pagingRect.height)}else for(this.paginggroup.removeChild(this.paginggroup.firstChild);this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);this.renderListLegendMode(this.legendRectScale)}},e.prototype.createTooltipDiv=function(e){var i=t.createElement("div",{id:this.heatMap.element.id+"legendLabelTooltipContainer",styles:"position:absolute"});this.heatMap.element.appendChild(i)},e.prototype.renderTooltip=function(e){var t=this.heatMap,i=[e.label],a=null;a=parseInt(t.legendSettings.textStyle.size,10)/2,this.tooltipObject=new n.Tooltip({offset:a,theme:t.theme,content:i,location:{x:e.x+e.width/2,y:e.y+e.height/2},inverted:!t.horizontalGradient,areaBounds:{height:this.legendGroup.height+this.legendGroup.y,width:this.legendGroup.width+this.legendGroup.x,x:"Right"===t.legendSettings.position?0:this.legendGroup.x,y:"Top"===t.legendSettings.position?""===t.titleSettings.text?this.legendGroup.height-this.legendGroup.y:this.legendGroup.y:0}},"#"+this.heatMap.element.id+"legendLabelTooltipContainer"),this.tooltipObject.element.style.visibility="visible"},e.prototype.createTooltip=function(e,t){for(var i,n=0;n<this.heatMap.colorCollection.length;n++){var a=this.legendRectPositionCollection[n];if(e>a.x&&e<a.width+a.x&&t>a.y&&t<a.height+a.y){i=this.legendRectPositionCollection[n];break}}var l=document.getElementById(this.heatMap.element.id+"legendLabelTooltipContainer");l&&"visible"===l.style.visibility&&this.tooltipObject&&!this.heatMap.isTouch&&(this.tooltipObject.fadeOut(),l.style.visibility="hidden"),i&&this.renderTooltip(i)},e}(),Se=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Me=function(e,t,i,n){var a,l=arguments.length,o=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(l<3?a(o):l>3?a(t,i,o):a(t,i))||o);return l>3&&o&&Object.defineProperty(t,i,o),o},Ce=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.enableCanvasRendering=!1,t.horizontalGradient="Bottom"===t.legendSettings.position||"Top"===t.legendSettings.position,t.tooltipCollection=[],t.isCellData=!1,t}return Se(i,e),i.prototype.preRender=function(){this.initPrivateVariable(),this.unWireEvents(),this.wireEvents()},i.prototype.initPrivateVariable=function(){this.renderer=new t.SvgRenderer(this.element.id),this.canvasRenderer=new t.CanvasRenderer(this.element.id),this.heatMapAxis=new de(this),this.heatMapSeries=new ye(this),this.drawSvgCanvas=new te(this),this.twoDimensional=new ve(this),this.cellColor=new B(this),this.tempRectHoverClass="",this.tempTooltipRectId="",this.setCulture()},i.prototype.setCulture=function(){this.intl=new t.Internationalization},i.prototype.render=function(){this.updateBubbleHelperProperty(),this.trigger("load",{heatmap:this}),this.processInitData(),this.setTheme(),this.initAxis(),this.calculateMaxLength(),this.heatMapAxis.calculateVisibleLabels(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.createSvg(),this.cellColor.getColorCollection(),this.calculateBounds(),this.renderElements(),this.element.appendChild(this.svgObject),this.tooltipModule&&this.tooltipModule.showHideTooltip(!1),this.trigger("created",{heatmap:this})},i.prototype.reRenderDatasource=function(){this.dataSourceMinValue=null,this.dataSourceMaxValue=null,this.processInitData(),this.calculateMaxLength(),this.heatMapAxis.calculateVisibleLabels(),this.twoDimensional.processDataSource(this.completeAdaptDataSource),this.cellColor.getColorCollection(),this.calculateBounds()},i.prototype.processInitData=function(){this.adaptorModule?this.adaptorModule.constructDatasource(this.dataSource):this.completeAdaptDataSource=this.dataSource},i.prototype.setRenderMode=function(){"Canvas"===this.renderingMode?this.enableCanvasRendering=!0:"Auto"===this.renderingMode&&this.axisCollections[0].axisLabelSize*this.axisCollections[1].axisLabelSize>=1e4?this.enableCanvasRendering=!0:this.enableCanvasRendering=!1},i.prototype.updateBubbleHelperProperty=function(){"Bubble"!==this.cellSettings.tileType||"Size"!==this.cellSettings.bubbleType&&"Sector"!==this.cellSettings.bubbleType?this.legendModule&&this.legendSettings.visible&&(this.legendVisibilityByCellType=!0):this.legendVisibilityByCellType=!1,"Bubble"===this.cellSettings.tileType&&"SizeAndColor"===this.cellSettings.bubbleType?this.bubbleSizeWithColor=!0:this.bubbleSizeWithColor=!1},i.prototype.renderElements=function(){this.renderSecondaryElement(),this.renderBorder(),this.renderTitle(),this.heatMapAxis.renderAxes(),this.tooltipModule&&this.showTooltip&&(this.tooltipModule.tooltipObject=null,this.tooltipModule.createTooltipDiv(this)),this.heatMapSeries.renderRectSeries(),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&(this.legendModule.renderLegendItems(),"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltipDiv(this))},i.prototype.getModuleName=function(){return"heatmap"},i.prototype.getPersistData=function(){return""},i.prototype.onPropertyChanged=function(e,t){for(var i=!1,n=!1,a=0,l=Object.keys(e);a<l.length;a++){switch(l[a]){case"renderingMode":i=!0;break;case"cellSettings":this.updateBubbleHelperProperty(),this.reRenderDatasource(),n=!0;break;case"showTooltip":n=!0;break;case"dataSource":this.isCellData=!1,this.updateBubbleHelperProperty(),this.reRenderDatasource(),i=!0;break;case"titleSettings":case"width":case"height":case"margin":case"legendSettings":n=!0;break;case"yAxis":case"xAxis":this.reRenderDatasource(),n=!0;break;case"paletteSettings":this.cellColor.getColorCollection(),this.calculateBounds(),i=!0;break;case"theme":this.setTheme(),i=!0}}!n&&i?(this.createSvg(),this.renderElements(),this.element.appendChild(this.svgObject),this.trigger("created",{heatmap:this})):n&&(this.createSvg(),this.refreshBound(),this.element.appendChild(this.svgObject),this.trigger("created",{heatmap:this}))},i.prototype.createSvg=function(){this.removeSvg(),this.setRenderMode(),this.calculateSize(),this.enableCanvasRendering?this.svgObject=this.canvasRenderer.createCanvas({id:this.element.id+"_canvas",width:this.availableSize.width,height:this.availableSize.height}):(this.svgObject=this.renderer.createSvg({id:this.element.id+"_svg",width:this.availableSize.width,height:this.availableSize.height}),"0"===this.cellSettings.border.width.toString()&&"Rect"===this.cellSettings.tileType&&this.svgObject.setAttribute("shape-rendering","crispEdges"))},i.prototype.removeSvg=function(){if(document.getElementById(this.element.id+"_Secondary_Element")&&t.remove(document.getElementById(this.element.id+"_Secondary_Element")),document.getElementById(this.element.id+"Celltooltipcontainer")&&t.remove(document.getElementById(this.element.id+"Celltooltipcontainer")),document.getElementById(this.element.id+"legendLabelTooltipContainer")&&t.remove(document.getElementById(this.element.id+"legendLabelTooltipContainer")),this.svgObject){if(document.getElementById(this.svgObject.id)){for(;this.svgObject.childNodes.length;)this.svgObject.removeChild(this.svgObject.firstChild);t.remove(this.svgObject)}}},i.prototype.renderSecondaryElement=function(){var e=this.createElement("div");e.id=this.element.id+"_Secondary_Element",e.setAttribute("style","position: relative"),this.element.appendChild(e)},i.prototype.requiredModules=function(){var e=[];return this.showTooltip&&e.push({member:"Tooltip",args:[this]}),this.legendSettings&&e.push({member:"Legend",args:[this]}),this.dataSource&&e.push({member:"Adaptor",args:[this]}),e},i.prototype.destroy=function(){this.unWireEvents(),e.prototype.destroy.call(this),this.element.innerHTML="",this.element.classList.remove("e-heatmap")},i.prototype.refresh=function(){e.prototype.refresh.call(this),this.element.classList.add("e-heatmap")},i.prototype.renderBorder=function(){this.border={width:0};var e=new W(this.element.id+"_HeatmapBorder",this.themeStyle.background,this.border,1,new J(0,0,this.availableSize.width-0,this.availableSize.height-0));this.drawSvgCanvas.drawRectangle(e,this.svgObject)},i.prototype.calculateSize=function(){var e=a(this.width,this.element.offsetWidth)||this.element.offsetWidth||600,t=a(this.height,this.element.offsetHeight)||this.element.offsetHeight||450;this.availableSize=new j(e,t)},i.prototype.renderTitle=function(){if(this.titleSettings.text){var e=this.titleSettings.textStyle,t="Near"===e.textAlignment?"start":"Far"===e.textAlignment?"end":"middle";this.elementSize=l(this.titleCollection[0],e);var i=new q(this.element.id+"_HeatmapTitle",new Z(o(this.availableSize.width-this.margin.left-this.margin.right,this.margin.left,this.margin.right,e),this.margin.top+3*this.elementSize.height/4,t,this.titleCollection),e,e.color||this.themeStyle.heatMapTitle);this.titleCollection.length>1?this.drawSvgCanvas.createWrapText(i,e,this.svgObject):(this.drawSvgCanvas.createText(i,this.svgObject,this.titleCollection[0]),-1!==this.titleCollection[0].indexOf("...")&&this.enableCanvasRendering&&this.tooltipCollection.push(new ae(this.titleSettings.text,new J(this.margin.left,this.margin.top,this.elementSize.width,this.elementSize.height))))}},i.prototype.titleTooltip=function(e,t,i,n){e.target.id===this.element.id+"_HeatmapTitle"&&e.target.textContent.indexOf("...")>-1?u(this.titleSettings.text,t,i,this.element.offsetWidth,this.element.id+"_Title_Tooltip",v(this.element.id+"_Secondary_Element"),n,this):y(this.element.id+"_Title_Tooltip")},i.prototype.axisTooltip=function(e,t,i,n){var a=e.target.id;if(-1!==a.indexOf(this.element.id+"_XAxis_Label")&&e.target.textContent.indexOf("...")>-1){var l=parseInt(a.replace(this.element.id+"_XAxis_Label",""),10);u(this.axisCollections[0].axisLabels[l],t,i,this.element.offsetWidth,this.element.id+"_axis_Tooltip",v(this.element.id+"_Secondary_Element"),n,this)}else y(this.element.id+"_axis_Tooltip")},i.prototype.isHeatmapRect=function(e,t){var i=[],n=[];return i.push(this.heatMapSeries.rectPositionCollection[0][0]),n.push(this.heatMapSeries.rectPositionCollection[this.yLength-1][this.xLength-1]),e>=i[0].x&&t>=i[0].y&&e<=n[0].x+n[0].width&&t<=n[0].y+n[0].height},i.prototype.setTheme=function(){this.themeStyle=function(e){var t;switch(e){case"Highcontrast":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#ffffff",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;default:t={heatMapTitle:"#424242",axisTitle:"#424242",axisLabel:"#686868",cellBorder:"#EEEEEE",cellTextColor:"#000000",background:"#FFFFFF",emptyCellColor:"#EEEEEE",legendLabel:"#353535",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]}}return t}(this.theme)},i.prototype.calculateBounds=function(){var e=this.margin,t=0,i=this.legendModule&&"Top"===this.legendSettings.position&&this.legendVisibilityByCellType||"0px"===this.titleSettings.textStyle.size?0:16,n=e.left,a=this.availableSize.width-n-e.right;this.titleSettings.text&&(this.titleCollection=p(this.titleSettings.text,this.titleSettings.textStyle,a),t=l(this.titleSettings.text,this.titleSettings.textStyle).height*this.titleCollection.length+i);var o=e.top+t,s=this.availableSize.height-o-e.bottom;this.initialClipRect=new J(n,o,a,s);var r=this.initialClipRect.y;this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendBounds(this.initialClipRect),this.heatMapAxis.measureAxis(this.initialClipRect),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendSize(this.initialClipRect,r),this.heatMapAxis.calculateAxisSize(this.initialClipRect)},i.prototype.refreshBound=function(){this.updateBubbleHelperProperty(),this.calculateBounds(),this.renderElements()},i.prototype.initAxis=function(){var e,t=[this.xAxis,this.yAxis];this.axisCollections=[];for(var i=0,n=t.length;i<n;i++)(e=t[i]).orientation=0===i?"Horizontal":"Vertical",this.axisCollections.push(e)},i.prototype.wireEvents=function(){var e=t.Browser.isPointer,i=t.Browser.touchStartEvent,n=t.Browser.touchEndEvent,a=t.Browser.touchMoveEvent,l=e?"pointerleave":"mouseleave";t.EventHandler.add(this.element,t.Browser.isDevice?i:"click",this.heatMapMouseClick,this),t.EventHandler.add(this.element,i,this.heatMapMouseMove,this),t.EventHandler.add(this.element,n,this.heatMapMouseLeave,this),t.EventHandler.add(this.element,a,this.heatMapMouseMove,this),t.EventHandler.add(this.element,l,this.heatMapMouseLeave,this),window.addEventListener(t.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize.bind(this)),this.setStyle(this.element)},i.prototype.setStyle=function(e){e.style.touchAction="element",e.style.msTouchAction="element",e.style.msContentZooming="none",e.style.msUserSelect="none",e.style.webkitUserSelect="none",e.style.position="relative",e.style.display="block"},i.prototype.unWireEvents=function(){var e=t.Browser.isPointer,i=t.Browser.touchStartEvent,n=(t.Browser.touchEndEvent,t.Browser.touchMoveEvent),a=e?"pointerleave":"mouseleave";t.EventHandler.remove(this.element,t.Browser.isDevice?i:"click",this.heatMapMouseClick),t.EventHandler.remove(this.element,i,this.heatMapMouseMove),t.EventHandler.remove(this.element,n,this.heatMapMouseLeave),t.EventHandler.remove(this.element,n,this.heatMapMouseMove),t.EventHandler.remove(this.element,a,this.heatMapMouseLeave),window.removeEventListener(t.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize)},i.prototype.heatMapResize=function(e){var t=this;return this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(function(){t.isDestroyed?clearTimeout(t.resizeTimer):(t.createSvg(),t.refreshBound(),t.element.appendChild(t.svgObject))},500),!1},i.prototype.calculateMaxLength=function(){var e=this.completeAdaptDataSource;if(e&&e.length>0){for(var t=e.length-1,i=0,n=0;n<=t;n++){var a=e[n].length;i=i>a?i:a}this.axisCollections[0].maxLength=t,this.axisCollections[1].maxLength=i-1}else this.axisCollections[0].maxLength=0,this.axisCollections[1].maxLength=0},i.prototype.setMouseXY=function(e,t){var i,n=this.element.getBoundingClientRect();i=this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").getBoundingClientRect():document.getElementById(this.element.id+"_svg").getBoundingClientRect(),this.mouseX=e-n.left-Math.max(i.left-n.left,0),this.mouseY=t-n.top-Math.max(i.top-n.top,0)},i.prototype.heatMapMouseClick=function(e){var t,i,n,a=this.element.getBoundingClientRect();"touchstart"===e.type?(this.isTouch=!0,i=(n=e).changedTouches[0].clientY,t=n.changedTouches[0].clientX):(this.isTouch=!1,i=e.clientY,t=e.clientX),t-=a.left,i-=a.top;if(this.isHeatmapRect(t,i)){var l=this.heatMapSeries.getCurrentRect(t,i);this.trigger("cellClick",{heatmap:this,value:l.value,x:l.x,y:l.y,xLabel:this.heatMapSeries.hoverXAxisLabel,yLabel:this.heatMapSeries.hoverYAxisLabel,xValue:this.heatMapSeries.hoverXAxisValue,yValue:this.heatMapSeries.hoverYAxisValue,cellElement:this.enableCanvasRendering?null:document.getElementById(l.id)})}if(this.notify("click",e),"Gradient"!==this.paletteSettings.type&&this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType){var o=this.legendModule.navigationCollections;o.length&&t>o[0].x&&t<o[0].x+o[0].width&&i>o[0].y&&i<o[0].y+o[0].height?this.legendModule.translatePage(this,this.legendModule.currentPage,!0):o.length&&t>o[1].x&&t<o[1].x+o[1].width&&i>o[1].y&&i<o[1].y+o[1].height&&this.legendModule.translatePage(this,this.legendModule.currentPage,!1)}return!1},i.prototype.heatMapMouseMove=function(e){var t,i,n,a,l=this,o=this.element.getBoundingClientRect();if("touchmove"===e.type||"touchstart"===e.type?(this.isTouch=!0,t=(a=e).changedTouches[0].clientX,i=a.changedTouches[0].clientY):(this.isTouch=!1,t=e.clientX,i=e.clientY),t-=o.left,i-=o.top,this.setMouseXY(t,i),e.target&&e.target.id){var s=this.isHeatmapRect(t,i);this.legendModule&&(s?"Gradient"===this.paletteSettings.type&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderGradientPointer(e,t,i):this.legendModule.removeGradientPointer());if(!(!this.showTooltip||!this.tooltipModule)&&this.isHeatmapRect(t,i)){var r=void 0;r=this.heatMapSeries.getCurrentRect(t,i),this.tempTooltipRectId!==r.id&&(this.showTooltip&&((this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(r.id),this.tooltipModule.renderTooltip(r),this.isTouch&&(this.tooltipTimer&&window.clearTimeout(this.tooltipTimer),this.tooltipTimer=setTimeout(function(){l.tooltipModule.tooltipObject.fadeOut(),l.tooltipModule.isFadeout=!0},1500),"touchmove"===e.type&&e.preventDefault())),this.tempTooltipRectId=r.id)}else-1===e.target.id.indexOf("Celltooltip")&&(!this.cellSettings.enableCellHighlighting&&!this.showTooltip||this.enableCanvasRendering||this.heatMapSeries.highlightSvgRect(e.target.id),this.tooltipModule&&this.showTooltip&&this.tooltipModule.showHideTooltip(!1,!0)),this.tempTooltipRectId="";if(this.legendModule&&this.legendSettings.visible&&"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltip(t,i),this.enableCanvasRendering){o=this.element.getBoundingClientRect();var h="Fixed"!==this.paletteSettings.type||!this.legendSettings.enableSmartLegend||"None"!==this.legendSettings.labelDisplayType;(n=m(this.tooltipCollection,t,i)||this.legendModule&&h&&m(this.legendModule.legendLabelTooltip,t,i))?u(n,this.mouseX,this.mouseY,this.element.offsetWidth,this.element.id+"_canvas_Tooltip",v(this.element.id+"_Secondary_Element"),this.isTouch,this):y(this.element.id+"_canvas_Tooltip")}else this.titleSettings.text&&"Trim"===this.titleSettings.textStyle.textOverflow&&this.titleTooltip(e,t,i,this.isTouch),this.axisTooltip(e,t,i,this.isTouch),this.legendModule&&this.legendSettings.visible&&this.legendSettings.showLabel&&this.legendVisibilityByCellType&&this.legendModule.renderLegendLabelTooltip(e)}return!0},i.prototype.heatMapMouseLeave=function(e){var t=this;if(e.target&&e.target.id&&(this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(this.tempTooltipRectId),this.tooltipModule&&this.showTooltip&&"mouseleave"===e.type&&this.tooltipModule.showHideTooltip(!1),this.tempTooltipRectId="",this.legendModule&&this.legendSettings.visible&&this.legendModule.tooltipObject&&this.legendModule.tooltipObject.element){var i=this.legendModule.tooltipObject.element.firstChild;"mouseleave"===e.type?i.setAttribute("opacity","0"):(this.legendTooltipTimer&&window.clearTimeout(this.legendTooltipTimer),this.legendTooltipTimer=setTimeout(function(){i.setAttribute("opacity","0")},1500))}if("Gradient"===this.paletteSettings.type&&this.legendModule&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&("mouseleave"===e.type?this.legendModule.removeGradientPointer():(this.gradientTimer&&window.clearTimeout(this.gradientTimer),this.gradientTimer=setTimeout(function(){t.legendModule.removeGradientPointer()},1500))),this.enableCanvasRendering){var n=document.getElementById(this.element.id+"_hoverRect_canvas");n&&(n.style.visibility="hidden",this.tempRectHoverClass="")}return this.titleSettings.text&&-1!==this.titleCollection[0].indexOf("...")&&(this.enableCanvasRendering?y(this.element.id+"_canvas_Tooltip"):y(this.element.id+"_Title_Tooltip")),!0},Me([t.Property(null)],i.prototype,"width",void 0),Me([t.Property(null)],i.prototype,"height",void 0),Me([t.Property(!0)],i.prototype,"showTooltip",void 0),Me([t.Event()],i.prototype,"tooltipRender",void 0),Me([t.Property("SVG")],i.prototype,"renderingMode",void 0),Me([t.Property(null)],i.prototype,"dataSource",void 0),Me([t.Property("Material")],i.prototype,"theme",void 0),Me([t.Complex({},R)],i.prototype,"margin",void 0),Me([t.Complex({text:"",textStyle:C.heatMapTitleFont},z)],i.prototype,"titleSettings",void 0),Me([t.Complex({},pe)],i.prototype,"xAxis",void 0),Me([t.Complex({},be)],i.prototype,"legendSettings",void 0),Me([t.Complex({},E)],i.prototype,"paletteSettings",void 0),Me([t.Complex({},pe)],i.prototype,"yAxis",void 0),Me([t.Complex({},ue)],i.prototype,"cellSettings",void 0),Me([t.Event()],i.prototype,"created",void 0),Me([t.Event()],i.prototype,"load",void 0),Me([t.Event()],i.prototype,"cellClick",void 0),i=Me([t.NotifyPropertyChanges],i)}(t.Component),we=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),Le=function(e,t,i,n){var a,l=arguments.length,o=l<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(l<3?a(o):l>3?a(t,i,o):a(t,i))||o);return l>3&&o&&Object.defineProperty(t,i,o),o},Te=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return we(i,e),Le([t.Property(null)],i.prototype,"data",void 0),Le([t.Property(!1)],i.prototype,"isJsonData",void 0),Le([t.Property("cell")],i.prototype,"adaptorType",void 0),Le([t.Property("")],i.prototype,"xDataMapping",void 0),Le([t.Property("")],i.prototype,"yDataMapping",void 0),Le([t.Property("")],i.prototype,"valueMapping",void 0),Le([t.Complex({},O)],i.prototype,"bubbleDataMapping",void 0),i}(t.ChildProperty),Re=function(){return function(){}}(),Pe=function(){function e(e){this.reconstructedXAxis=[],this.reconstructedYAxis=[],this.adaptiveXMinMax=new Re,this.adaptiveYMinMax=new Re,this.heatMap=e}return e.prototype.constructDatasource=function(e){if(e&&void 0===e.data)this.heatMap.completeAdaptDataSource=e;else if(!e.isJsonData&&"Table"===e.adaptorType||null===e.data)this.heatMap.completeAdaptDataSource=e.data;else if(e.isJsonData&&"Table"===e.adaptorType)this.heatMap.completeAdaptDataSource=this.processJsonTableData(e);else if(e.isJsonData&&"Cell"===e.adaptorType)this.heatMap.completeAdaptDataSource=this.processJsonCellData(e);else if(!e.isJsonData&&"Cell"===e.adaptorType){var i=this.heatMap.xAxis,n=this.heatMap.yAxis;this.adaptiveXMinMax.min=i.minimum,this.adaptiveXMinMax.max=i.maximum,this.adaptiveYMinMax.min=n.minimum,this.adaptiveYMinMax.max=n.maximum,("Numeric"!==i.valueType&&"DateTime"!==i.valueType||!t.isNullOrUndefined(i.minimum)&&!t.isNullOrUndefined(i.maximum))&&("Numeric"!==n.valueType&&"DateTime"!==n.valueType||!t.isNullOrUndefined(n.minimum)&&!t.isNullOrUndefined(n.maximum))||this.getMinMaxValue(e.data,i,n),this.constructAdaptiveAxis(),this.heatMap.completeAdaptDataSource=this.processCellData(e),this.heatMap.isCellData=!0}},e.prototype.constructAdaptiveAxis=function(){var e=this.heatMap.xAxis,t=this.heatMap.yAxis;"Numeric"===e.valueType&&(this.reconstructedXAxis=this.getNumericAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,e.increment)),"Numeric"===t.valueType&&(this.reconstructedYAxis=this.getNumericAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.increment)),"DateTime"===e.valueType&&(this.reconstructedXAxis=this.getDateAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,e.intervalType,e.increment)),"DateTime"===t.valueType&&(this.reconstructedYAxis=this.getDateAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.intervalType,t.increment))},e.prototype.getNumericAxisCollection=function(e,t,i){for(var n=e,a=[];n<=t;)a.push(n.toString()),n+=i;return a},e.prototype.getDateAxisCollection=function(e,t,n,a){for(var l={skeleton:"full",type:"dateTime"},o=this.heatMap.intl.getDateParser(l),s=this.heatMap.intl.getDateFormat(l),r=e=Date.parse(o(s(new Date(i.DataUtil.parse.parseJson({val:e}).val)))),h=[];r<=t;)h.push(new Date(r).toString()),r=f(r,1,n,a).getTime();return h},e.prototype.getMinMaxValue=function(e,i,n){e.length>0&&(this.adaptiveXMinMax.min=t.isNullOrUndefined(i.minimum)?e[0][0]:i.minimum,this.adaptiveYMinMax.min=t.isNullOrUndefined(n.minimum)?e[0][1]:n.minimum,this.adaptiveXMinMax.max=t.isNullOrUndefined(i.maximum)?e[0][0]:i.maximum,this.adaptiveYMinMax.max=t.isNullOrUndefined(n.maximum)?e[0][1]:n.maximum);for(var a=0;a<e.length;a++)e[a][0]<this.adaptiveXMinMax.min&&t.isNullOrUndefined(i.minimum)&&(this.adaptiveXMinMax.min=e[a][0]),e[a][0]>this.adaptiveXMinMax.max&&t.isNullOrUndefined(i.maximum)&&(this.adaptiveXMinMax.max=e[a][0]),e[a][1]<this.adaptiveYMinMax.min&&t.isNullOrUndefined(n.minimum)&&(this.adaptiveYMinMax.min=e[a][1]),e[a][1]>this.adaptiveYMinMax.max&&t.isNullOrUndefined(n.maximum)&&(this.adaptiveYMinMax.max=e[a][1])},e.prototype.processCellData=function(e){var i=e.data,n=this.reconstructedXAxis,a=this.reconstructedYAxis,l=0,o=0;if(i.length){this.reconstructData=[];for(var s=0;s<i.length;s++)if((l="Category"===this.heatMap.xAxis.valueType?i[s][0]:n.indexOf(i[s][0].toString()))>-1){for(;!this.reconstructData[l];)this.reconstructData.push([]);if(-1!==(o="Category"===this.heatMap.yAxis.valueType?i[s][1]:a.indexOf(i[s][1].toString()))){for(;""!==this.reconstructData[l][o];)this.reconstructData[l].push("");this.reconstructData[l][o]=t.isNullOrUndefined(i[s][2])?"":i[s][2]}}}return this.reconstructData},e.prototype.processJsonCellData=function(e){var i=e.data,n=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],a=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],l=0,o=0;if(i.length){this.reconstructData=[];for(var s=0;s<i.length;s++)if(-1!==(l=this.getSplitDataValue(i[s],e,n,e.xDataMapping.split(".")))){for(;!this.reconstructData[l];)this.reconstructData.push([]);if(-1!==(o=this.getSplitDataValue(i[s],e,a,e.yDataMapping.split(".")))){for(;t.isNullOrUndefined(this.reconstructData[l][o]);)this.reconstructData[l].push("");this.heatMap.bubbleSizeWithColor?this.reconstructData[l][o]=[this.getSplitDataValue(i[s],e,null,e.bubbleDataMapping.size.split(".")),this.getSplitDataValue(i[s],e,null,e.bubbleDataMapping.color.split("."))]:this.reconstructData[l][o]=this.getSplitDataValue(i[s],e,null,e.valueMapping.split("."))}}}return this.reconstructData},e.prototype.getSplitDataValue=function(e,i,n,a){var l=-1;this.tempSplitDataCollection=e;for(var o=0;o<a.length&&(l=t.isNullOrUndefined(n)?null:n.indexOf(this.tempSplitDataCollection[a[o]]),t.isNullOrUndefined(this.tempSplitDataCollection)||(this.tempSplitDataCollection=-1===l||t.isNullOrUndefined(n)?this.tempSplitDataCollection[a[o]]:this.tempSplitDataCollection),!t.isNullOrUndefined(this.tempSplitDataCollection));o++);return l=t.isNullOrUndefined(n)?t.isNullOrUndefined(this.tempSplitDataCollection)||""===this.tempSplitDataCollection.toString()?"":parseFloat(this.tempSplitDataCollection.toString()):l},e.prototype.processJsonTableData=function(e){var i,n=e.data,a=0,l=0,o=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],s=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[];if(n.length){this.reconstructData=[];for(var r=0;r<n.length;r++)if(-1!==(a=this.getSplitDataValue(n[r],e,o,e.xDataMapping.split(".")))){for(;!this.reconstructData[a];)this.reconstructData.push([]);for(var h=0;h<Object.keys(this.tempSplitDataCollection).length;h++)if(i=Object.keys(this.tempSplitDataCollection)[h],-1!==(l=i!==e.xDataMapping?s.indexOf(i):-1)){for(;t.isNullOrUndefined(this.reconstructData[a][l]);)this.reconstructData[a].push("");this.reconstructData[a][l]=t.isNullOrUndefined(this.tempSplitDataCollection[i])?"":this.tempSplitDataCollection[i]}}}return this.reconstructData},e.prototype.destroy=function(e){},e.prototype.getModuleName=function(){return"Adaptor"},e}(),Oe=function(){function e(e){this.isFirst=!0,this.isFadeout=!1,this.heatMap=e}return e.prototype.getModuleName=function(){return"Tooltip"},e.prototype.showHideTooltip=function(e,t){var i=document.getElementById(this.heatMap.element.id+"Celltooltipcontainer");if(e)i.style.visibility="visible";else{if(i&&"hidden"!==i.style.visibility){if(this.tooltipObject&&t)this.tooltipObject.fadeOut();else if(this.tooltipObject&&this.tooltipObject.element){this.tooltipObject.element.firstChild.setAttribute("opacity","0")}i.style.visibility="hidden"}this.isFadeout=!0}},e.prototype.destroy=function(e){},e.prototype.createTooltip=function(e,t,i){var a=null;this.heatMap.cellSettings.showLabel&&this.heatMap.heatMapSeries.checkLabelXDisplay&&this.heatMap.heatMapSeries.checkLabelYDisplay&&(a=parseInt(this.heatMap.cellSettings.textStyle.size,10)/2),this.tooltipObject=new n.Tooltip({enableAnimation:!1,offset:a,location:{x:e,y:t},theme:this.heatMap.theme,content:i,areaBounds:{height:this.heatMap.initialClipRect.height+this.heatMap.initialClipRect.y,width:this.heatMap.initialClipRect.width,x:this.heatMap.initialClipRect.x}},"#"+this.heatMap.element.id+"Celltooltipcontainer")},e.prototype.createTooltipDiv=function(e){var i=t.createElement("div",{id:this.heatMap.element.id+"Celltooltipcontainer",styles:"position:absolute"});this.heatMap.element.appendChild(t.createElement("div",{id:this.heatMap.element.id+"Celltooltipparent",styles:"position:relative"}).appendChild(i))},e.prototype.getTooltipContent=function(e,t){var i,n,a=this.heatMap,l=this.heatMap.dataSource;if(a.bubbleSizeWithColor){var o=a.xAxis.title&&""!==a.xAxis.title.text?a.xAxis.title.text:"X-Axis",s=a.yAxis.title&&""!==a.yAxis.title.text?a.yAxis.title.text:"Y-Axis",r=l.isJsonData&&"Cell"===l.adaptorType?a.dataSource.bubbleDataMapping.size:"Value 1",h=l.isJsonData&&"Cell"===l.adaptorType?a.dataSource.bubbleDataMapping.color:"Value 2";i=t.getFormatedText(e.value[0].bubbleData,this.heatMap.cellSettings.format),n=[o+" : "+t.hoverXAxisLabel+"<br/>"+s+" : "+t.hoverYAxisLabel+"<br/>"+r+" : "+i+"<br/>"+h+" : "+t.getFormatedText(e.value[1].bubbleData,this.heatMap.cellSettings.format)]}else i=e.value,n=[t.hoverXAxisLabel+" | "+t.hoverYAxisLabel+" : "+t.getFormatedText(i,this.heatMap.cellSettings.format)];return n},e.prototype.renderTooltip=function(e){var i=this.heatMap.heatMapSeries,n=[""];if(this.heatMap.bubbleSizeWithColor?!t.isNullOrUndefined(e.value)&&!t.isNullOrUndefined(e.value[0].bubbleData)&&""!==e.value[0].bubbleData.toString():!(t.isNullOrUndefined(e.value)||!t.isNullOrUndefined(e.value)&&""===e.value.toString())){if(t.isNullOrUndefined(this.heatMap.tooltipRender))n=this.getTooltipContent(e,i);else{var a=this.getTooltipContent(e,i),l={heatmap:this.heatMap,cancel:!1,name:"tooltipRender",value:e.value,xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,content:a};if(this.heatMap.trigger("tooltipRender",l),l.cancel)return void(this.tooltipObject&&this.showHideTooltip(!1));n=l.content}this.tooltipObject?this.tooltipObject.content=n:this.createTooltip(e.x+e.width/2,e.y+e.height/2,n),this.showHideTooltip(!0),this.tooltipObject.enableAnimation=!this.isFirst&&!this.isFadeout,this.isFirst=!this.isFirst&&this.isFirst,this.isFadeout=!this.isFadeout&&this.isFadeout,this.tooltipObject.location.x=e.x+e.width/2,this.tooltipObject.location.y=e.y+e.height/2}else this.showHideTooltip(!1,!1)},e}();e.HeatMap=Ce,e.Axis=pe,e.AxisHelper=de,e.Data=Te,e.AdaptiveMinMax=Re,e.Adaptor=Pe,e.TwoDimensional=ve,e.LegendSettings=be,e.Legend=xe,e.Font=T,e.Margin=R,e.Border=P,e.BubbleData=O,e.Title=z,e.PaletteCollection=D,e.ColorCollection=A,e.BubbleTooltipData=_,e.LegendColorCollection=I,e.CellSettings=ue,e.Series=ye,e.PaletteSettings=E,e.RgbColor=H,e.CellColor=B,e.Tooltip=Oe,e.stringToNumber=a,e.measureText=l,e.TextElement=F,e.titlePositionX=o,e.Size=j,e.CustomizeOption=Y,e.PathOption=k,e.CurrentRect=X,e.RectOption=W,e.CircleOption=U,e.Rect=J,e.TextOption=q,e.TextBasic=Z,e.Line=$,e.LineOption=K,e.PathAttributes=Q,e.Path=ee,e.sum=s,e.titlePositionY=r,e.rotateTextSize=h,e.DrawSvgCanvas=te,e.getTitle=p,e.textWrap=d,e.textTrim=c,e.textNone=g,e.Gradient=ie,e.GradientColor=ne,e.showTooltip=u,e.removeElement=y,e.getElement=v,e.increaseDateTimeInterval=f,e.CanvasTooltip=ae,e.getTooltipText=m,e.PaletterColor=le,e.GradientPointer=oe,e.CurrentLegendRect=se,e.colorNameToHex=b,e.convertToHexCode=x,e.componentToHex=S,e.convertHexToColor=M,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-heatmap.umd.min.js.map
