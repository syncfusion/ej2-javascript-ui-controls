!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-popups"),require("@syncfusion/ej2-grids"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-treegrid"),require("@syncfusion/ej2-layouts"),require("@syncfusion/ej2-navigations"),require("@syncfusion/ej2-richtexteditor"),require("@syncfusion/ej2-inputs"),require("@syncfusion/ej2-buttons"),require("@syncfusion/ej2-calendars"),require("@syncfusion/ej2-dropdowns")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-popups","@syncfusion/ej2-grids","@syncfusion/ej2-data","@syncfusion/ej2-treegrid","@syncfusion/ej2-layouts","@syncfusion/ej2-navigations","@syncfusion/ej2-richtexteditor","@syncfusion/ej2-inputs","@syncfusion/ej2-buttons","@syncfusion/ej2-calendars","@syncfusion/ej2-dropdowns"],t):t(e.ej={},e.ej2Base,e.ej2Popups,e.ej2Grids,e.ej2Data,e.ej2Treegrid,e.ej2Layouts,e.ej2Navigations,e.ej2Richtexteditor,e.ej2Inputs,e.ej2Buttons,e.ej2Calendars,e.ej2Dropdowns)}(this,function(e,t,i,r,n,a,o,s,l,d,p,h,c){"use strict";function u(e,t,i){for(var r=e;r&&(i?r.id!==t:!r.classList.contains(t));)r=r.parentElement;return r}function g(e){return t.isNullOrUndefined(e.startDate)&&t.isNullOrUndefined(e.endDate)&&t.isNullOrUndefined(e.duration)?null:!(t.isNullOrUndefined(e.startDate)||t.isNullOrUndefined(e.endDate)||t.isNullOrUndefined(e.duration))}function f(e){for(var t={},i=0,r=Object.keys(e);i<r.length;i++){var n=r[i];t[e[n]]=n}return t}function m(e){if(e instanceof n.DataManager){var t=e.adaptor;return t instanceof n.ODataAdaptor||t instanceof n.WebApiAdaptor||t instanceof n.WebMethodAdaptor||t instanceof n.CacheAdaptor||t instanceof n.UrlAdaptor}return!1}function y(e){for(var i=[],r=0;r<e.length;r++){var n=t.extend({},e[r].taskData,{},!0);i.push(n)}return i}function v(e,t){for(var i,r=0;r<t.length;r++)i=new RegExp("\\{"+r+"\\}","gm"),e=e.replace(i,t[r].toString());return e}function D(e,i,r,n){for(var a=-1,o=0;o<r.length;o++)if(t.getValue(i,r[o])===t.getValue(i,e)&&t.isNullOrUndefined(n)||!t.isNullOrUndefined(n)&&t.getValue(i,r[o])===t.getValue(i,e)&&t.getValue(n,r[o])===t.getValue(n,e)){a=o;break}return a}var T=function(){function e(e){this.parent=e}return e.prototype.isValidateNonWorkDays=function(e){return!t.isNullOrUndefined(e)&&e.isAutoSchedule&&(!this.parent.includeWeekend||this.parent.totalHolidayDates.length>0)||t.isNullOrUndefined(e)&&(!this.parent.includeWeekend||this.parent.totalHolidayDates.length>0)},e.prototype.checkStartDate=function(e,i,r){if(t.isNullOrUndefined(e))return null;var n=new Date(e.getTime()),a=this.getSecondsInDecimal(n);if(r=t.isNullOrUndefined(r)?!t.isNullOrUndefined(i)&&i.isMilestone:r,a<this.parent.defaultStartTime)this.setTime(this.parent.defaultStartTime,n);else if(a!==this.parent.defaultEndTime||i&&r){if(a>this.parent.defaultEndTime)n.setDate(n.getDate()+1),this.setTime(this.parent.defaultStartTime,n);else if(a>this.parent.defaultStartTime&&a<this.parent.defaultEndTime)for(var o=0;o<this.parent.workingTimeRanges.length;o++){var s=this.parent.workingTimeRanges[o];if(a>=s.to&&this.parent.workingTimeRanges[o+1]&&a<this.parent.workingTimeRanges[o+1].from){a!==s.to||i&&r?a!==s.to&&this.setTime(this.parent.workingTimeRanges[o+1].from,n):this.setTime(this.parent.workingTimeRanges[o+1].from,n);break}}}else n.setDate(n.getDate()+1),this.setTime(this.parent.defaultStartTime,n);var l;do{l=new Date(n.getTime());var d=this.parent.totalHolidayDates.length;if(this.isValidateNonWorkDays(i)){if(!this.parent.includeWeekend){var p=new Date(n.getTime());n=this.getNextWorkingDay(n),p.getTime()!==n.getTime()&&this.setTime(this.parent.defaultStartTime,n)}for(var h=0;h<d;h++){var c=this.getDateFromFormat(new Date(this.parent.totalHolidayDates[h])),u=new Date(c.getTime());c.setHours(0,0,0,0),u.setHours(23,59,59,59),n.getTime()>=c.getTime()&&n.getTime()<u.getTime()&&(n.setDate(n.getDate()+1),this.setTime(this.parent.defaultStartTime,n))}}}while(l.getTime()!==n.getTime());return new Date(n.getTime())},e.prototype.checkEndDate=function(e,i){if(t.isNullOrUndefined(e))return null;var r=new Date(e.getTime()),n=this.getSecondsInDecimal(r);if(n>this.parent.defaultEndTime)this.setTime(this.parent.defaultEndTime,r);else if(n<=this.parent.defaultStartTime)r.setDate(r.getDate()-1),this.setTime(this.parent.defaultEndTime,r);else if(n>this.parent.defaultStartTime&&n<this.parent.defaultEndTime)for(var a=0;a<this.parent.workingTimeRanges.length;a++){if(n>this.parent.workingTimeRanges[a].to&&this.parent.workingTimeRanges[a+1]&&n<=this.parent.workingTimeRanges[a+1].from){this.setTime(this.parent.workingTimeRanges[a].to,r);break}}var o;do{o=new Date(r.getTime());var s=this.parent.totalHolidayDates.length;if(this.isValidateNonWorkDays(i)){if(!this.parent.includeWeekend){var l=new Date(r.getTime());r=this.getPreviousWorkingDay(r),l.getTime()!==r.getTime()&&this.setTime(this.parent.defaultEndTime,r)}for(var d=0;d<s;d++){var p=this.getDateFromFormat(new Date(this.parent.totalHolidayDates[d])),h=new Date(p.getTime()),c=new Date(r.getTime());c.setMinutes(r.getMilliseconds()-2),p.setHours(0,0,0,0),h.setHours(23,59,59,59),(r.getTime()>=p.getTime()&&r.getTime()<h.getTime()||c.getTime()>=p.getTime()&&c.getTime()<h.getTime())&&(r.setDate(r.getDate()-1),r.getTime()===p.getTime()&&86400===this.parent.defaultEndTime&&0===this.getSecondsInDecimal(r)||this.setTime(this.parent.defaultEndTime,r))}}}while(o.getTime()!==r.getTime());return new Date(r.getTime())},e.prototype.checkBaselineStartDate=function(e){if(t.isNullOrUndefined(e))return null;var i=new Date(e.getTime()),r=this.getSecondsInDecimal(i);if(r<this.parent.defaultStartTime)this.setTime(this.parent.defaultStartTime,i);else if(r>=this.parent.defaultEndTime)i.setDate(i.getDate()+1),this.setTime(this.parent.defaultStartTime,i);else if(r>this.parent.defaultStartTime&&r<this.parent.defaultEndTime)for(var n=0;n<this.parent.workingTimeRanges.length;n++){if(r>=this.parent.workingTimeRanges[n].to&&this.parent.workingTimeRanges[n+1]&&r<this.parent.workingTimeRanges[n+1].from){this.setTime(this.parent.workingTimeRanges[n+1].from,i);break}}return i},e.prototype.checkBaselineEndDate=function(e){if(t.isNullOrUndefined(e))return null;var i=new Date(e.getTime()),r=this.getSecondsInDecimal(i);if(r>this.parent.defaultEndTime)this.setTime(this.parent.defaultEndTime,i);else if(r<=this.parent.defaultStartTime)i.setDate(i.getDate()-1),this.setTime(this.parent.defaultEndTime,i);else if(r>this.parent.defaultStartTime&&r<this.parent.defaultEndTime)for(var n=0;n<this.parent.workingTimeRanges.length;n++){if(r>this.parent.workingTimeRanges[n].to&&this.parent.workingTimeRanges[n+1]&&r<=this.parent.workingTimeRanges[n+1].from){this.setTime(this.parent.workingTimeRanges[n].to,i);break}}return i},e.prototype.calculateStartDate=function(e){var i=e.ganttProperties,r=null;t.isNullOrUndefined(i.endDate)||t.isNullOrUndefined(i.duration)||(r=this.getStartDate(i.endDate,i.duration,i.durationUnit,i)),this.parent.setRecordValue("startDate",r,i,!0),this.parent.taskFields.startDate&&this.parent.dataOperation.updateMappingData(e,"startDate")},e.prototype.calculateEndDate=function(e){var i=e.ganttProperties,r=null;t.isNullOrUndefined(i.startDate)||(!t.isNullOrUndefined(i.endDate)&&t.isNullOrUndefined(i.duration)&&(1===this.compareDates(i.startDate,i.endDate)&&(this.parent.setRecordValue("startDate",new Date(i.endDate.getTime()),i,!0),this.setTime(this.parent.defaultStartTime,i.startDate)),this.calculateDuration(e)),t.isNullOrUndefined(i.duration)||(r=this.getEndDate(i.startDate,i.duration,i.durationUnit,i,!1)),this.parent.setRecordValue("endDate",r,i,!0)),this.parent.taskFields.endDate&&this.parent.dataOperation.updateMappingData(e,"endDate")},e.prototype.calculateDuration=function(e){var t=e.ganttProperties,i=this.getDuration(t.startDate,t.endDate,t.durationUnit,t.isAutoSchedule,t.isMilestone);this.parent.setRecordValue("duration",i,t,!0),this.parent.taskFields.duration&&(this.parent.dataOperation.updateMappingData(e,"duration"),this.parent.taskFields.durationUnit&&this.parent.dataOperation.updateMappingData(e,"durationUnit"))},e.prototype.getNonworkingTime=function(e,i,r,n){n=!!t.isNullOrUndefined(n)||n;this.getTimeDifference(e,i,n);var a=!this.parent.includeWeekend&&r?this.getWeekendCount(e,i):0,o=this.getNumberOfSeconds(e,i,n),s=r?this.getHolidaysCount(e,i):0,l=(o-86400*a-86400*s)/86400,d=this.getNonWorkingSecondsOnDate(e,i);return l*(86400-this.parent.secondsPerDay)+86400*a+86400*s+d},e.prototype.getDuration=function(e,i,r,n,a,o){if(t.isNullOrUndefined(e)||t.isNullOrUndefined(i))return null;o=!!t.isNullOrUndefined(o)||o;var s=0,l=this.getTimeDifference(e,i,o)/1e3-this.getNonworkingTime(e,i,n,o);return s=a&&this.parent.getFormatedDate(e)===this.parent.getFormatedDate(i)?0:r&&"day"!==r?"minute"===r?l/60:l/3600:l/this.parent.secondsPerDay,parseFloat(s.toString())},e.prototype.getDurationAsSeconds=function(e,t){return t&&"day"!==t?"hour"===t?3600*e:60*e:this.parent.secondsPerDay*e},e.prototype.getEndDate=function(e,t,i,r,n){for(var a=new Date(e.getTime()),o=new Date(e.getTime()),s=this.getDurationAsSeconds(t,i);s>0;)o.setSeconds(o.getSeconds()+s),(s-=s-this.getNonworkingTime(a,o,r.isAutoSchedule,!0))>0&&(o=this.checkStartDate(o,r,n)),a=new Date(o.getTime());return o},e.prototype.getStartDate=function(e,t,i,r){for(var n=new Date(e.getTime()),a=new Date(e.getTime()),o=this.getDurationAsSeconds(t,i);o>0;)a.setSeconds(a.getSeconds()-o),(o-=o-this.getNonworkingTime(a,n,r.isAutoSchedule,!0))>0&&(n=this.checkEndDate(a,r)),n=new Date(a.getTime());return a},e.prototype.getProjectStartDate=function(e,i){if(!t.isNullOrUndefined(this.parent.cloneProjectStartDate)){var r=this.checkStartDate(this.parent.cloneProjectStartDate);return this.parent.cloneProjectStartDate=r,new Date(r.getTime())}if(t.isNullOrUndefined(this.parent.projectStartDate)){if(t.isNullOrUndefined(i))return null;var n=this.parent.flatData,a=void 0;n.length>0?a=n[0].ganttProperties.startDate:(a=new Date).setHours(0,0,0,0);for(var o=1;o<n.length;o++){var s=n[o].ganttProperties.startDate;t.isNullOrUndefined(s)||-1!==this.compareDates(s,a)||(a=s)}this.parent.cloneProjectStartDate=this.checkStartDate(a,e)}else{r=this.getDateFromFormat(this.parent.projectStartDate);this.parent.cloneProjectStartDate=this.checkStartDate(r)}return new Date(this.parent.cloneProjectStartDate.getTime())},e.prototype.getValidStartDate=function(e){var i=null;return t.isNullOrUndefined(e.startDate)?t.isNullOrUndefined(e.endDate)?t.isNullOrUndefined(e.duration)||(i=this.getProjectStartDate(e)):(i=new Date(e.endDate.getTime()),this.setTime(this.parent.defaultStartTime,i)):i=new Date(e.startDate.getTime()),i},e.prototype.getValidEndDate=function(e){var i=null;if(t.isNullOrUndefined(e.endDate))if(t.isNullOrUndefined(e.startDate)){if(!t.isNullOrUndefined(e.duration)){var r=this.getValidStartDate(e);r&&(i=this.getEndDate(r,e.duration,e.durationUnit,e,!1))}}else e.isMilestone?i=this.checkStartDate(e.startDate):(i=new Date(e.startDate.getTime()),this.setTime(this.parent.defaultEndTime,i));else i=new Date(e.endDate.getTime());return i},e.prototype.getSecondsPerDay=function(){var e=this.parent.dayWorkingTime,i=e.length,r=0,n=new Date("10/11/2018");this.parent.nonWorkingHours=[];var a=this.parent.nonWorkingHours;this.parent.workingTimeRanges=[];var o=this.parent.workingTimeRanges;this.parent.nonWorkingTimeRanges=[];for(var s=this.parent.nonWorkingTimeRanges,l=0;l<i;l++){var d=e[l];if(!t.isNullOrUndefined(d.from)&&!t.isNullOrUndefined(d.to)){n.setHours(0,0,0,0);var p=new Date(n.getTime());n.setTime(n.getTime()+36e5*d.from);var h=new Date(n.getTime());p.setTime(p.getTime()+36e5*d.to);var c=new Date(p.getTime()),u=c.getTime()-h.getTime(),g=this.getSecondsInDecimal(h),f=this.getSecondsInDecimal(c);0===f&&(f=86400),r+=u/1e3,0===l&&(this.parent.defaultStartTime=g),l===i-1&&(this.parent.defaultEndTime=f),l>0?(a.push(a[a.length-1]+g-o[l-1].to),o[l-1].to<g&&s.push({from:o[l-1].to,to:g,isWorking:!1,interval:g-o[l-1].to})):(a.push(0),s.push({from:0,to:g,isWorking:!1,interval:g})),o.push({from:g,to:f}),s.push({from:g,to:f,isWorking:!0,interval:f-g})}}return this.parent.defaultEndTime/3600!=24&&s.push({from:this.parent.defaultEndTime,to:86400,isWorking:!1,interval:86400-this.parent.defaultEndTime}),r},e.prototype.getDurationValue=function(e,i){var r=null,n=null;if("string"==typeof e){var a=e.match(/(\d*\.*\d+|.+$)/g);if(a&&a.length<=2){n=parseFloat(a[0].toString().trim());var o=a[1]?a[1].toString().trim().toLowerCase():null;-1!==t.getValue("minute",this.parent.durationUnitEditText).indexOf(o)?r="minute":-1!==t.getValue("hour",this.parent.durationUnitEditText).indexOf(o)?r="hour":-1!==t.getValue("day",this.parent.durationUnitEditText).indexOf(o)&&(r="day")}}else n=e,r=null;return{duration:n,durationUnit:r}},e.prototype.getNextWorkingDay=function(e){var t=e.getDay();return-1!==this.parent.nonWorkingDayIndex.indexOf(t)?(e.setDate(e.getDate()+1),e=this.getNextWorkingDay(e)):e},e.prototype.getWeekendCount=function(e,t){var i=0,r=new Date(e.getTime()),n=new Date(t.getTime());for(r.setHours(0,0,0,0),r.setDate(r.getDate()+1),n.setHours(0,0,0,0);r.getTime()<n.getTime();)-1!==this.parent.nonWorkingDayIndex.indexOf(r.getDay())&&(i+=1),r.setDate(r.getDate()+1);return i},e.prototype.getNumberOfSeconds=function(e,t,i){var r=new Date(e.getTime()),n=new Date(t.getTime()),a=0;return r.setDate(r.getDate()+1),r.setHours(0,0,0,0),n.setHours(0,0,0,0),r.getTime()<n.getTime()&&(a=this.getTimeDifference(r,n,i)/1e3),a%86400!=0&&(a=a-a%86400+86400),a},e.prototype.getHolidaysCount=function(e,t){var i=0,r=this.parent.totalHolidayDates,n=new Date(e.getTime()),a=new Date(t.getTime());if(n.setDate(n.getDate()+1),n.setHours(0,0,0,0),a.setHours(0,0,0,0),n.getTime()<a.getTime())for(var o=0;o<r.length;o++){var s=this.getDateFromFormat(new Date(r[o]));n.getTime()<=s.getTime()&&a.getTime()>=s.getTime()&&(this.parent.includeWeekend||-1!==this.parent.nonWorkingDayIndex.indexOf(s.getDay())?this.parent.includeWeekend&&(i+=1):i+=1)}return i},e.prototype.getHolidayDates=function(){for(var e=this.parent.holidays,i=[],r=0;r<e.length;r++){var n=this.getDateFromFormat(e[r].from),a=this.getDateFromFormat(e[r].to);if(!t.isNullOrUndefined(n)||!t.isNullOrUndefined(a))if(t.isNullOrUndefined(n)||t.isNullOrUndefined(a)){var o=n||a;o.setHours(0,0,0,0),-1===i.indexOf(o.getTime())&&i.push(o.getTime())}else for(;n<=a;)n.setHours(0,0,0,0),-1===i.indexOf(n.getTime())&&i.push(n.getTime()),n.setDate(n.getDate()+1)}return i},e.prototype.isOnHolidayOrWeekEnd=function(e,i){if(!(i=t.isNullOrUndefined(i)?this.parent.includeWeekend:i)&&-1!==this.parent.nonWorkingDayIndex.indexOf(e.getDay()))return!0;for(var r=this.parent.totalHolidayDates,n=0;n<r.length;n++){var a=this.getDateFromFormat(new Date(r[n])),o=new Date(a.getTime());if(a.setHours(0,0,0,0),o.setHours(23,59,59,59),e.getTime()>=a.getTime()&&e.getTime()<o.getTime())return!0}return!1},e.prototype.getNonWorkingSecondsOnDate=function(e,t){for(var i=this.getSecondsInDecimal(e),r=this.getSecondsInDecimal(t),n=-1,a=-1,o=0,s=this.isOnHolidayOrWeekEnd(e,null),l=this.isOnHolidayOrWeekEnd(t,null),d=0;d<this.parent.nonWorkingTimeRanges.length;d++){var p=this.parent.nonWorkingTimeRanges[d];i>=p.from&&i<=p.to&&(n=d),r>=p.from&&r<=p.to&&(a=d)}if(e.getDate()!==t.getDate()||e.getMonth()!==t.getMonth()||e.getFullYear()!==t.getFullYear()){if(s)o+=86400-i;else for(d=n;d<this.parent.nonWorkingTimeRanges.length;d++)this.parent.nonWorkingTimeRanges[d].isWorking||(o+=d===n?this.parent.nonWorkingTimeRanges[d].to-i:this.parent.nonWorkingTimeRanges[d].interval);if(l)o+=r;else for(d=0;d<=a;d++)this.parent.nonWorkingTimeRanges[d].isWorking||(o+=d===a?r-this.parent.nonWorkingTimeRanges[d].from:this.parent.nonWorkingTimeRanges[d].interval)}else if(n!==a)if(l)o+=r-i;else for(d=n;d<=a;d++)this.parent.nonWorkingTimeRanges[d].isWorking||(o+=d===n?this.parent.nonWorkingTimeRanges[d].to-i:d===a?r-this.parent.nonWorkingTimeRanges[d].from:this.parent.nonWorkingTimeRanges[d].interval);else if(l)o+=r-i;else{this.parent.nonWorkingTimeRanges[n].isWorking||(o=r-i)}return o},e.prototype.getPreviousWorkingDay=function(e){var t=e.getDay(),i=0===t?6:t-1;return-1!==this.parent.nonWorkingDayIndex.indexOf(t)||-1!==this.parent.nonWorkingDayIndex.indexOf(i)&&86400===this.parent.defaultEndTime&&0===this.getSecondsInDecimal(e)?(e.setDate(e.getDate()-1),-1!==this.parent.nonWorkingDayIndex.indexOf(e.getDay())&&(e=this.getPreviousWorkingDay(e)),e):e},e.prototype.getNonWorkingDayIndex=function(){var e=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],t=e.length;0===this.parent.workWeek.length&&(this.parent.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"]);for(var i=this.parent.workWeek.slice(),r=i.length,n=0;n<r;n++)i[n]=i[n].toLowerCase();this.parent.nonWorkingDayIndex=[];for(n=0;n<t;n++)-1===i.indexOf(e[n])&&this.parent.nonWorkingDayIndex.push(n)},e.prototype.setTime=function(e,t){var i=e/3600,r=(e-3600*(i=parseInt(i,10)))/60,n=e-3600*i-60*(r=parseInt(r,10));t.setHours(i,r,n)},e.prototype.getTimeDifference=function(e,t,i){var r=new Date(e.getTime()),n=new Date(t.getTime());return i&&this.updateDateWithTimeZone(r,n),n.getTime()-r.getTime()},e.prototype.updateDateWithTimeZone=function(e,t){var i,r,n=e.getTimezoneOffset(),a=t.getTimezoneOffset();if(n!==a){var o=new Date((new Date).getFullYear(),0,1).getTimezoneOffset();if(o!==n?(r=e,i=n):o!==a&&(r=t,i=a),o<0){var s=o-i;r.setTime(r.getTime()+60*s*1e3)}else if(o>0){s=i-o;r.setTime(r.getTime()-60*s*1e3)}}},e.prototype.getSecondsInDecimal=function(e){return 60*e.getHours()*60+60*e.getMinutes()+e.getSeconds()+e.getMilliseconds()/1e3},e.prototype.getDateFromFormat=function(e){if(t.isNullOrUndefined(e))return null;if(e instanceof Date)return new Date(e.getTime());var i=this.parent.globalize.parseDate(e,{format:this.parent.dateFormat,type:"dateTime"});return t.isNullOrUndefined(i)&&!isNaN(new Date(e).getTime())?new Date(e):i},e.prototype.compareDates=function(e,i){return t.isNullOrUndefined(e)||t.isNullOrUndefined(i)?!t.isNullOrUndefined(e)&&t.isNullOrUndefined(i)?1:t.isNullOrUndefined(e)&&!t.isNullOrUndefined(i)?-1:null:e.getTime()>i.getTime()?1:e.getTime()<i.getTime()?-1:0},e.prototype.getDurationString=function(e,i){var r="";if(!t.isNullOrUndefined(e)&&(r+=parseFloat(e.toFixed(2))+" ",!t.isNullOrUndefined(i))){var n=1!==e;"day"===i?r+=n?this.parent.localeObj.getConstant("days"):this.parent.localeObj.getConstant("day"):"hour"===i?r+=n?this.parent.localeObj.getConstant("hours"):this.parent.localeObj.getConstant("hour"):"minute"===i&&(r+=n?this.parent.localeObj.getConstant("minutes"):this.parent.localeObj.getConstant("minute"))}return r},e.prototype.calculateProjectDates=function(e){var i=this,r=this.parent.timelineModule.isZooming&&this.parent.cloneProjectStartDate?this.getDateFromFormat(this.parent.cloneProjectStartDate):this.getDateFromFormat(this.parent.projectStartDate),n=this.parent.timelineModule.isZooming&&this.parent.cloneProjectEndDate?this.getDateFromFormat(this.parent.cloneProjectEndDate):this.getDateFromFormat(this.parent.projectEndDate),a=null,o=null,s=this.parent.flatData,l=[],d=function(e){t.isNullOrUndefined(e)||l.push(e)},p=function(e){e.length>0&&(e.sort(function(e,t){return e.getTime()-t.getTime()}),a=new Date(e[0].getTime()),o=e.length>1?new Date(e[e.length-1].getTime()):null)};if((!r||!n)&&s.length>0||e||this.parent.timelineModule.isZoomToFit){if(s.forEach(function(e,t){l=[];var r=e.ganttProperties,n=i.getValidStartDate(r),s=i.getValidEndDate(r);d(a),d(o),d(n),d(s),i.parent.renderBaseline&&(d(r.baselineStartDate),d(r.baselineEndDate)),r.indicators&&r.indicators.length>0&&r.indicators.forEach(function(e,t){d(i.getDateFromFormat(e.date))}),p(l)}),l=[],d(a),d(o),this.parent.eventMarkers.length>0){this.parent.eventMarkers.forEach(function(e,t){d(i.getDateFromFormat(e.day))})}if(this.parent.totalHolidayDates.length>0){this.parent.totalHolidayDates.forEach(function(e,t){d(new Date(e))})}p(l),a&&o||(a=t.isNullOrUndefined(a)?this.getDateFromFormat(new Date):a,(o=this.getDateFromFormat(new Date(a.getTime()))).setDate(o.getDate()+20))}else r&&n||0!==s.length||(a=this.getDateFromFormat(new Date),o=this.getDateFromFormat(new Date(a.getTime())));e?(t.setValue("minStartDate",a,e),t.setValue("maxEndDate",o,e)):(this.parent.cloneProjectStartDate=a||new Date(r.getTime()),this.parent.cloneProjectEndDate=o||new Date(n.getTime()))},e}(),k=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),S=function(e){function i(t){var i=e.call(this,t)||this;return i.recordIndex=0,i.taskIds=[],i.hierarchyData=[],i.addEventListener(),i}return k(i,e),i.prototype.addEventListener=function(){this.parent.on("beforeDataManipulate",this.checkDataBinding.bind(this))},i.prototype.checkDataBinding=function(e){e&&(this.parent.flatData=[],this.parent.currentViewData=[],this.dataArray=[],this.taskIds=[],this.parent.ids=[],this.recordIndex=0,this.taskIds=[],this.hierarchyData=[],this.parent.predecessorsCollection=[],this.parent.treeGrid.parentData=[]),t.isNullOrUndefined(this.parent.dataSource)?(this.parent.dataSource=[],this.parent.renderGantt(e)):this.parent.dataSource instanceof n.DataManager?this.initDataSource(e):this.parent.dataSource.length>0?(this.dataArray=this.parent.dataSource,this.cloneDataSource(),this.parent.renderGantt(e)):this.parent.renderGantt(e)},i.prototype.initDataSource=function(e){var t=this,i=this.parent.query instanceof n.Query?this.parent.query:new n.Query;i.requiresCount();this.parent.dataSource.executeQuery(i).then(function(i){t.dataArray=i.result,t.cloneDataSource(),t.parent.renderGantt(e)}).catch(function(i){t.parent.renderGantt(e),t.parent.trigger("actionFailure",{error:i})})},i.prototype.constructDataSource=function(e){for(var i=new n.DataManager(e).executeLocal((new n.Query).group(this.parent.taskFields.parentID)),r=[],a=0;a<i.length;a++){var o=i[a];if(!t.isNullOrUndefined(o.key)){var s=this.taskIds.indexOf(o.key.toString());if(s>-1&&!t.isNullOrUndefined(o.key)){e[s][this.parent.taskFields.child]=o.items;continue}}r.push.apply(r,o.items)}this.hierarchyData=this.dataReorder(e,r)},i.prototype.cloneDataSource=function(){var e=this.parent.taskFields.id,i=this.parent.taskFields.parentID;if(t.isNullOrUndefined(e)||t.isNullOrUndefined(i))this.prepareDataSource(this.dataArray);else{for(var r=[],n=0;n<this.dataArray.length;n++){var a=this.dataArray[n];r.push(t.extend({},{},a,!0)),t.isNullOrUndefined(a[e])||this.taskIds.push(a[e].toString())}this.parent.taskFields.child||(this.parent.taskFields.child="Children"),this.constructDataSource(r),this.prepareDataSource(this.hierarchyData)}},i.prototype.prepareDataSource=function(e){this.prepareRecordCollection(e,0),this.parent.taskFields.dependency&&this.parent.predecessorModule.ensurePredecessorCollection()},i.prototype.prepareRecordCollection=function(e,i,r){for(var n=e.length,a=0;a<n;a++){var o=e[a],s=this.createRecord(o,i,r,!0);s.index=this.recordIndex++,this.parent.ids[s.index]=s.ganttProperties.taskId.toString(),this.parent.flatData.push(s);var l=o[this.parent.taskFields.child];!t.isNullOrUndefined(l)&&l.length>0&&this.prepareRecordCollection(l,s.level+1,s)}},i.prototype.addCustomFieldValue=function(e,t){var i=this.parent.ganttColumns,r=i.length;if(r)for(var n=0;n<r;n++)void 0===t[i[n].field]&&this.parent.setRecordValue(i[n].field,e[i[n].field],t)},i.prototype.createRecord=function(e,i,n,a){var o=this.parent.taskFields,s=(e[o.child],e[o.progress]);s=s&&parseFloat(s.toString())?parseFloat(s.toString()):0;var l=e[o.dependency],d=this.getDateFromFormat(e[o.baselineStartDate]),p=this.getDateFromFormat(e[o.baselineEndDate]),h={},c={};this.parent.setRecordValue("ganttProperties",c,h),this.parent.setRecordValue("taskId",e[o.id],c,!0),this.parent.setRecordValue("taskName",e[o.name],c,!0),this.addTaskData(h,e,a),this.addCustomFieldValue(e,h),this.parent.setRecordValue("isAutoSchedule",!0,c,!0),this.parent.setRecordValue("resourceInfo",this.setResourceInfo(e),c,!0),this.parent.setRecordValue("isMilestone",!1,c,!0),this.updateResourceName(h),this.calculateScheduledValues(h,e,a),this.parent.setRecordValue("baselineStartDate",this.checkBaselineStartDate(d),c,!0),p&&0===p.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,p),this.parent.setRecordValue("baselineEndDate",this.checkBaselineEndDate(p),c,!0),this.parent.setRecordValue("progress",s,c,!0),this.parent.setRecordValue("totalProgress",s,c,!0),this.parent.setRecordValue("predecessorsName",l,c,!0),this.parent.setRecordValue("indicators",e[o.indicators],c,!0),this.parent.setRecordValue("notes",e[o.notes],c,!0),this.parent.setRecordValue("cssClass",e[o.cssClass],c,!0),this.parent.setRecordValue("parentItem",this.getCloneParent(n),h);var u=h.parentItem?h.parentItem.uniqueID:null;return this.parent.setRecordValue("parentUniqueID",u,h),this.parent.setRecordValue("level",i,h),this.parent.setRecordValue("uniqueID",r.getUid(this.parent.element.id+"_data_"),h),this.parent.setRecordValue("uniqueID",h.uniqueID,c,!0),this.parent.setRecordValue("childRecords",[],h),this.parent.setRecordValue("baselineEndDate",this.checkBaselineEndDate(p),c,!0),!t.isNullOrUndefined(e[o.child])&&e[o.child].length>0?(this.parent.setRecordValue("hasChildRecords",!0,h),this.parent.setRecordValue("isMilestone",!1,c,!0)):this.parent.setRecordValue("hasChildRecords",!1,h),this.parent.setRecordValue("expanded",!h.hasChildRecords||!this.parent.collapseAllParentTasks,h),this.updateExpandStateMappingValue(h,e),a||(this.parent.setRecordValue("width",this.calculateWidth(c),c,!0),this.parent.setRecordValue("left",this.calculateLeft(c),c,!0),this.parent.setRecordValue("progressWidth",this.getProgressWidth(c.width,s),c,!0),c.baselineEndDate&&c.baselineStartDate&&(this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(c),c,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(c),c,!0))),this.updateTaskData(h),t.isNullOrUndefined(n)||n.childRecords.push(h),l&&this.parent.predecessorsCollection.push(h),h},i.prototype.getCloneParent=function(e){if(t.isNullOrUndefined(e))return null;var i={};return i.uniqueID=e.uniqueID,i.expanded=e.expanded,i.level=e.level,i.index=e.index,i.taskId=e.ganttProperties.taskId,i},i.prototype.reUpdateResources=function(){if(this.parent.flatData.length>0)for(var e=void 0,t=void 0,i=void 0,r=0;r<this.parent.flatData.length;r++)e=this.parent.flatData[r].taskData,t=this.parent.flatData[r].ganttProperties,i=this.parent.flatData[r],this.parent.setRecordValue("resourceInfo",this.setResourceInfo(e),t,!0),this.updateResourceName(i)},i.prototype.addTaskData=function(e,t,i){var r=this.parent.taskFields,a=this.parent.dataSource;if(i)if(r.parentID||a instanceof n.DataManager&&a.dataSource.json&&a.dataSource.offline)if(r.parentID){var o=t[r.id],s=this.taskIds.indexOf(o),l=s>-1?this.dataArray[s]:{};this.parent.setRecordValue("taskData",l,e)}else this.parent.setRecordValue("taskData",t,e);else this.parent.setRecordValue("taskData",t,e);else this.parent.setRecordValue("taskData",t,e)},i.prototype.updateExpandStateMappingValue=function(e,i){var r,n=this.parent.taskFields.expandState,a=i[n];n&&e.hasChildRecords&&(t.isNullOrUndefined(a)?t.isNullOrUndefined(a)&&!this.parent.collapseAllParentTasks?r=!0:t.isNullOrUndefined(a)&&this.parent.collapseAllParentTasks&&(r=!1):r="true"===a.toString(),this.parent.setRecordValue("taskData."+n,r,e),this.parent.setRecordValue("expandStateMapping",r,e),this.parent.setRecordValue("expanded",r,e))},i.prototype.calculateScheduledValues=function(e,i,r){var n=this.parent.taskFields,a=e.ganttProperties,o=i[n.duration];o=t.isNullOrUndefined(o)||""===o?null:o;var s=this.getDateFromFormat(i[n.startDate]),l=this.getDateFromFormat(i[n.endDate]),d=!!n.milestone&&!!i[n.milestone],p=i[n.durationUnit]?i[n.durationUnit]:"";if(this.parent.setRecordValue("durationUnit",this.validateDurationUnitMapping(p),a,!0),l||s||!t.isNullOrUndefined(o)&&""!==o)s?this.calculateDateFromStartDate(s,l,o,e):l?this.calculateDateFromEndDate(l,o,e):t.isNullOrUndefined(o)||""===o||(this.updateDurationValue(o,a),this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("startDate",null,a,!0),this.parent.setRecordValue("endDate",null,a,!0)):(this.parent.setRecordValue("startDate",this.getProjectStartDate(a,r),a,!0),this.calculateEndDate(e)));else{if(this.parent.allowUnscheduledTasks)return;this.parent.setRecordValue("duration",1,a,!0),this.parent.setRecordValue("startDate",this.getProjectStartDate(a,r),a,!0),this.calculateEndDate(e)}0===a.duration&&(this.parent.setRecordValue("isMilestone",!0,a,!0),this.parent.setRecordValue("endDate",a.startDate,a,!0)),!t.isNullOrUndefined(d)&&d&&(this.parent.setRecordValue("duration",0,a,!0),this.parent.setRecordValue("isMilestone",!0,a,!0),this.parent.setRecordValue("endDate",a.startDate,a,!0))},i.prototype.calculateDateFromEndDate=function(e,i,r){var n=r.ganttProperties;0===e.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,e),this.parent.setRecordValue("endDate",this.checkEndDate(e,r.ganttProperties),n,!0),t.isNullOrUndefined(i)||""===i?this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("startDate",null,n,!0),this.parent.setRecordValue("duration",null,n,!0)):(this.parent.setRecordValue("duration",1,n,!0),this.parent.setRecordValue("startDate",this.getStartDate(n.endDate,n.duration,n.durationUnit,n),n,!0)):t.isNullOrUndefined(i)||""===i||(this.updateDurationValue(i,n),this.parent.setRecordValue("startDate",this.getStartDate(n.endDate,n.duration,n.durationUnit,n),n,!0))},i.prototype.calculateDateFromStartDate=function(e,i,r,n){var a=n.ganttProperties;this.parent.setRecordValue("startDate",this.checkStartDate(e,a),a,!0),i||!t.isNullOrUndefined(r)&&""!==r?(t.isNullOrUndefined(r)||i)&&i&&(t.isNullOrUndefined(r)||""===r)?(0===i.getHours()&&86400!==this.parent.defaultEndTime&&this.setTime(this.parent.defaultEndTime,i),this.parent.setRecordValue("endDate",this.checkEndDate(i,n.ganttProperties),a,!0),1===this.compareDates(a.startDate,a.endDate)?(this.parent.setRecordValue("endDate",a.startDate,a,!0),this.parent.setRecordValue("isMilestone",!0,a,!0),this.parent.setRecordValue("duration",0,a,!0)):this.calculateDuration(n)):(this.updateDurationValue(r,a),this.calculateEndDate(n)):this.parent.allowUnscheduledTasks?(this.parent.setRecordValue("endDate",null,a,!0),this.parent.setRecordValue("duration",null,a,!0)):(this.parent.setRecordValue("duration",1,a,!0),this.calculateEndDate(n))},i.prototype.getProgressWidth=function(e,t){return e*t/100},i.prototype.calculateWidth=function(e){var i=e.startDate,r=e.endDate;return t.isNullOrUndefined(i)&&t.isNullOrUndefined(r)&&(i=this.getValidStartDate(e),r=this.getValidEndDate(e)),t.isNullOrUndefined(i)||t.isNullOrUndefined(r)?3:e.isMilestone?0:this.getTaskWidth(i,r)},i.prototype.getTaskbarHeight=function(){var e=this.parent.rowHeight,t=this.parent.taskbarHeight;return t<e?t:e},i.prototype.calculateLeft=function(e){var i=null,r=-300,n=e.isMilestone;return e.startDate?i=new Date(e.startDate.getTime()):e.endDate?(i=new Date(e.endDate.getTime()),n=!0):i=this.getValidStartDate(e),t.isNullOrUndefined(i)||(r=this.getTaskLeft(i,n)),r},i.prototype.calculateBaselineLeft=function(e){var t=this.getDateFromFormat(e.baselineStartDate),i=this.getDateFromFormat(e.baselineEndDate);return t&&i?this.getTaskLeft(t,e.isMilestone):0},i.prototype.calculateBaselineWidth=function(e){var t=this.getDateFromFormat(e.baselineStartDate),i=this.getDateFromFormat(e.baselineEndDate);return t&&i?this.getTaskWidth(t,i):0},i.prototype.getTaskWidth=function(e,t){var i=new Date(e.getTime()),r=new Date(t.getTime());return"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(i)===this.parent.defaultStartTime&&i.setHours(0,0,0,0),this.getSecondsInDecimal(r)===this.parent.defaultEndTime&&r.setHours(24)),this.getTimeDifference(i,r)/864e5*this.parent.perDayWidth},i.prototype.getTaskLeft=function(e,t){var i=new Date(e.getTime());"Day"===("None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier)&&(this.getSecondsInDecimal(i)===this.parent.defaultStartTime?i.setHours(0,0,0,0):t&&this.getSecondsInDecimal(i)===this.parent.defaultEndTime&&i.setHours(24));var r=this.parent.timelineModule.timelineStartDate;return r?(i.getTime()-r.getTime())/864e5*this.parent.perDayWidth:0},i.prototype.updateMappingData=function(e,i){var r=this.parent.columnMapping,n=e.ganttProperties;if(!t.isNullOrUndefined(r[i]))if("predecessorName"===i);else if("resourceInfo"===i){for(var a=n.resourceInfo,o=[],s=[],l=0;l<a.length;l++)o.push(a[l][this.parent.resourceIDMapping]),s.push(a[l][this.parent.resourceNameMapping]);this.parent.setRecordValue("resourceNames",s.join(","),n,!0),this.parent.setRecordValue("taskData."+r[i],o,e),this.parent.setRecordValue(r[i],s.join(","),e)}else"startDate"===i||"endDate"===i?this.setRecordDate(e,n[i],r[i]):"duration"===i?this.setRecordDuration(e,r[i]):(this.parent.setRecordValue("taskData."+r[i],n[i],e),this.parent.setRecordValue(r[i],n[i],e))},i.prototype.setRecordDate=function(e,i,r){t.isNullOrUndefined(i)||(i=new Date(i.getTime())),this.parent.setRecordValue(r,i,e),t.isNullOrUndefined(i)||(i=new Date(i.getTime())),this.parent.setRecordValue("taskData."+r,i,e)},i.prototype.getDurationInDay=function(e,t){return"day"===t?e:"hour"===t?e/(this.parent.secondsPerDay/3600):e/(this.parent.secondsPerDay/60)},i.prototype.setRecordDuration=function(e,i){var r=e.ganttProperties.duration,n=e.ganttProperties.durationUnit;t.isNullOrUndefined(r)?(this.parent.setRecordValue(i,r,e),this.parent.setRecordValue("taskData."+i,r,e)):(this.parent.setRecordValue(i,this.getDurationInDay(r,n),e),this.parent.setRecordValue("taskData."+i,this.getDurationString(r,n),e))},i.prototype.updateTaskData=function(e){var i=this.parent.taskFields,r=e.ganttProperties;if(!t.isNullOrUndefined(e.taskData)){var n=e.taskData;i.id&&(this.parent.setRecordValue("taskData."+i.id,r.taskId,e),this.parent.setRecordValue(i.id,r.taskId,e)),i.name&&(this.parent.setRecordValue("taskData."+i.name,r.taskName,e),this.parent.setRecordValue(i.name,r.taskName,e)),i.startDate&&this.setRecordDate(e,r.startDate,i.startDate),i.endDate&&this.setRecordDate(e,r.endDate,i.endDate),i.duration&&this.setRecordDuration(e,i.duration),i.durationUnit&&(n[i.durationUnit]=r.durationUnit),i.progress&&(this.parent.setRecordValue("taskData."+i.progress,r.progress,e),this.parent.setRecordValue(i.progress,r.progress,e)),i.baselineStartDate&&this.setRecordDate(e,r.baselineStartDate,i.baselineStartDate),i.baselineEndDate&&this.setRecordDate(e,r.baselineEndDate,i.baselineEndDate),i.notes&&(this.parent.setRecordValue("taskData."+i.notes,r.notes,e),this.parent.setRecordValue(i.notes,r.notes,e)),i.cssClass&&(this.parent.setRecordValue("taskData."+i.cssClass,r.cssClass,e),this.parent.setRecordValue(i.cssClass,r.cssClass,e)),i.indicators&&(this.parent.setRecordValue("taskData."+i.indicators,r.indicators,e),this.parent.setRecordValue(i.indicators,r.indicators,e))}},i.prototype.setResourceInfo=function(e){var i;if(t.isNullOrUndefined(e[this.parent.taskFields.resourceInfo]))return i;i=e[this.parent.taskFields.resourceInfo];for(var r=this.parent.resources,n=this.parent.resourceIDMapping,a=[],o=function(e){var o=r.filter(function(t){return i[e]===t[n]}),s=t.extend({},o[0]);a.push(s)},s=0;s<i.length;s++)o(s);return a},i.prototype.updateResourceName=function(e){var t=e.ganttProperties.resourceInfo,i=[];if(t){this.parent.setRecordValue("taskData."+this.parent.taskFields.resourceInfo,[],e);for(var r=0;r<t.length;r++){var n=t[r];if(i.push(n[this.parent.resourceNameMapping]),e.taskData){var a=this.parent.taskFields.resourceInfo;e.taskData[a].push(n[this.parent.resourceIDMapping])}}this.parent.setRecordValue("resourceNames",i.join(","),e.ganttProperties,!0),this.parent.setRecordValue(this.parent.taskFields.resourceInfo,i.join(","),e,!0)}},i.prototype.dataReorder=function(e,t){for(var i=[];e.length>0&&t.length>0;){var r=t.indexOf(e[0]);-1===r?e.shift():(i.push(e.shift()),t.splice(r,1))}return i},i.prototype.validateDurationUnitMapping=function(e){var t=e;return t="minute"===t?"minute":"hour"===t?"hour":"day"===t?"day":this.parent.durationUnit.toLocaleLowerCase()},i.prototype.updateDurationValue=function(e,i){var r=this.getDurationValue(e);this.parent.setRecordValue("duration",t.getValue("duration",r),i,!0),t.isNullOrUndefined(t.getValue("durationUnit",r))||this.parent.setRecordValue("durationUnit",t.getValue("durationUnit",r),i,!0)},i.prototype.reUpdateGanttData=function(){if(this.parent.flatData.length>0){var e=void 0,i=void 0;this.parent.secondsPerDay=this.getSecondsPerDay();for(var r=0;r<this.parent.flatData.length;r++)e=this.parent.flatData[r].taskData,i=this.parent.flatData[r],t.isNullOrUndefined(this.parent.taskFields.duration)||this.setRecordDuration(i,this.parent.taskFields.duration),this.calculateScheduledValues(i,e,!1);this.updateGanttData()}},i.prototype.updateGanttData=function(){for(var e=this.parent.flatData,t=e.length,i=0;i<t;i++){var r=e[i],n=r.ganttProperties;r.hasChildRecords||this.updateWidthLeft(r),this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(n),n,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(n),n,!0);var a=[],o=void 0;r.parentItem&&(a=(o=this.parent.getParentTask(r.parentItem)).childRecords),o&&a.indexOf(r)===a.length-1&&!r.hasChildRecords&&o.ganttProperties.isAutoSchedule&&this.updateParentItems(o)}},i.prototype.reUpdateGanttDataPosition=function(){for(var e=this.parent.flatData,t=e.length,i=0;i<t;i++){var r=e[i],n=r.ganttProperties;this.updateWidthLeft(r),this.parent.setRecordValue("baselineLeft",this.calculateBaselineLeft(n),n,!0),this.parent.setRecordValue("baselineWidth",this.calculateBaselineWidth(n),n,!0),this.parent.dataOperation.updateTaskData(r)}},i.prototype.updateWidthLeft=function(e){var t=e.ganttProperties;this.parent.setRecordValue("width",this.parent.dataOperation.calculateWidth(t),t,!0),this.parent.setRecordValue("left",this.parent.dataOperation.calculateLeft(t),t,!0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(t.width,t.progress),t,!0)},i.prototype.getParentProgress=function(e){var i=0,r={};switch(e.ganttProperties.durationUnit){case"hour":i=e.ganttProperties.duration/(this.parent.secondsPerDay/3600);break;case"minute":i=e.ganttProperties.duration/(this.parent.secondsPerDay/60);break;default:i=e.ganttProperties.duration}return e.hasChildRecords?(t.setValue("totalProgress",e.ganttProperties.totalProgress,r),t.setValue("totalDuration",e.ganttProperties.totalDuration,r)):(t.setValue("totalProgress",e.ganttProperties.progress*i,r),t.setValue("totalDuration",i,r)),r},i.prototype.updateParentItems=function(e){var i=this.parent.getParentTask(e);if(i.childRecords.length>0){for(var r=i.ganttProperties.startDate,n=i.ganttProperties.endDate,a=i.childRecords,o=a.length,s=0,l={},d=null,p=null,h=0,c=0,u=0;u<o;u++){var f=a[u];if(!this.parent.isOnDelete||!f.isDelete){var m=this.getValidStartDate(f.ganttProperties),y=this.getValidEndDate(f.ganttProperties);t.isNullOrUndefined(d)&&(d=this.getDateFromFormat(m)),t.isNullOrUndefined(p)&&(p=this.getDateFromFormat(y)),t.isNullOrUndefined(y)||1!==this.compareDates(y,p)||(p=this.getDateFromFormat(y)),t.isNullOrUndefined(m)||-1!==this.compareDates(m,d)||(d=this.getDateFromFormat(m)),!f.ganttProperties.isMilestone&&g(f.ganttProperties)?(l=this.getParentProgress(f),c+=t.getValue("totalProgress",l),s+=t.getValue("totalDuration",l)):h++}}0!==this.compareDates(r,d)&&this.parent.setRecordValue("startDate",d,i.ganttProperties,!0),0!==this.compareDates(n,p)&&this.parent.setRecordValue("endDate",p,i.ganttProperties,!0);var v=(this.parent.isOnDelete?o-h-1:o-h)>0&&s>0?c/s:0;this.calculateDuration(i);var D=i.ganttProperties;this.parent.setRecordValue("progress",Math.floor(v),D,!0),this.parent.setRecordValue("totalProgress",c,D,!0),this.parent.setRecordValue("totalDuration",s,D,!0),this.updateWidthLeft(i),this.updateTaskData(i)}1===i.childRecords.length&&0===i.ganttProperties.duration&&(this.parent.setRecordValue("isMilestone",!1,i.ganttProperties,!0),this.updateWidthLeft(i),this.updateTaskData(i));var T=this.parent.getParentTask(i.parentItem);T&&T.ganttProperties.isAutoSchedule&&this.updateParentItems(T)},i}(T),b="e-timeline-single-header-outer-div",w="e-left-label-container",M="e-right-label-container",C="e-taskbar-main-container",P="e-task-label",R="e-gantt-child-progressbar-inner-div",E="e-milestone-top",O="e-milestone-bottom",x="e-baseline-bar",I="e-baseline-gantt-milestone",L="e-baseline-milestone-top",V="e-baseline-milestone-bottom",B="e-chart-row-cell",F="e-chart-row",N="e-taskbar-left-resizer",U="e-taskbar-right-resizer",A="e-child-progress-resizer",j="e-gantt-child-taskbar",H="e-gantt-child-progressbar",W="e-gantt-parent-taskbar",G="e-gantt-parent-progressbar",_="e-gantt-unscheduled-task",q="e-left-resize-gripper",z="e-right-resize-gripper",Y="e-progress-resize-gripper",X="e-label",Z="e-gantt-dependency-view-container",K="e-connector-line-container",Q="e-line",$="e-connector-line-right-arrow",J="e-connector-line-left-arrow",ee="e-connector-line-z-index",te="e-connector-line-hover",ie="e-connector-line-hover-z-index",re="e-connector-line-right-arrow-hover",ne="e-connector-line-left-arrow-hover",ae="e-connectorpoint-left",oe="e-connectorpoint-right",se="e-connectorpoint-left-hover",le="e-connectorpoint-right-hover",de="e-right-connectorpoint-outer-div",pe="e-connectorpoint-allow-block",he="e-gantt-tooltip",ce=".e-content",ue="e-active-parent-task",ge="e-active-child-task",fe="e-active-connected-task",me="e-predecessor-touch-mode",ye=function(){function e(e){this.previousScroll={top:0,left:0},this.parent=e,this.element=this.parent.ganttChartModule.scrollElement,this.addEventListeners()}return e.prototype.addEventListeners=function(){this.parent.on("grid-scroll",this.gridScrollHandler,this),t.EventHandler.add(this.element,"scroll",this.onScroll,this)},e.prototype.removeEventListeners=function(){t.EventHandler.remove(this.element,"scroll",this.onScroll),this.parent.off("grid-scroll",this.gridScrollHandler)},e.prototype.gridScrollHandler=function(e){this.element.scrollTop=t.getValue("top",e),this.isFromTreeGrid=!0},e.prototype.onScroll=function(){var e={};this.element.scrollTop!==this.previousScroll.top&&(this.isFromTreeGrid?this.isFromTreeGrid=!1:this.parent.notify("chartScroll",{top:this.element.scrollTop}),e.previousScrollTop=this.previousScroll.top,this.previousScroll.top=this.element.scrollTop,e.scrollTop=this.element.scrollTop,e.scrollDirection="Vertical"),this.element.scrollLeft!==this.previousScroll.left&&(this.parent.ganttChartModule.chartTimelineContainer.scrollLeft=this.element.scrollLeft,e.previousScrollLeft=this.previousScroll.left,this.previousScroll.left=this.element.scrollLeft,e.scrollLeft=this.element.scrollLeft,e.scrollDirection="Horizontal"),e.requestType="scroll",this.parent.trigger("actionComplete",e)},e.prototype.setHeight=function(e){this.element.style.height=t.formatUnit(e)},e.prototype.setWidth=function(e){this.element.style.width=t.formatUnit(e)},e.prototype.setScrollTop=function(e){this.element.scrollTop=e},e.prototype.setScrollLeft=function(e){this.element.scrollLeft=e,this.parent.ganttChartModule.chartTimelineContainer.scrollLeft=this.element.scrollLeft,this.previousScroll.left=this.element.scrollLeft},e.prototype.destroy=function(){this.removeEventListeners()},e}(),ve=function(){function e(e){this.isExpandCollapseFromChart=!1,this.isExpandAll=!1,this.parent=e,this.chartTimelineContainer=null,this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("renderPanels",this.renderChartContainer,this),this.parent.on("recordsUpdated",this.renderChartElements,this),this.parent.on("dataReady",this.renderInitialContents,this),this.parent.on("tree-grid-created",this.renderChartContents,this),this.parent.on("destroy",this.destroy,this)},e.prototype.renderChartContents=function(){this.parent.notify("refreshDayMarkers",{}),this.wireEvents()},e.prototype.renderChartContainer=function(){this.chartElement=t.createElement("div",{id:this.parent.element.id+"GanttChart",className:"e-gantt-chart"}),this.parent.chartPane.appendChild(this.chartElement),this.renderTimelineContainer(),this.renderBodyContainers()},e.prototype.renderInitialContents=function(){this.parent.timelineModule.createTimelineSeries()},e.prototype.renderChartElements=function(){this.parent.chartRowsModule.renderChartRows(),this.parent.connectorLineModule.renderConnectorLines(this.parent.updatedConnectorLineCollection),this.updateWidthAndHeight(),this.parent.notify("selectRowByIndex",{})},e.prototype.renderTimelineContainer=function(){this.chartTimelineContainer=t.createElement("div",{className:"e-timeline-header-container"}),this.chartElement.appendChild(this.chartTimelineContainer)},e.prototype.renderBodyContainers=function(){this.chartBodyContainer=t.createElement("div",{className:"e-chart-root-container"}),this.chartElement.appendChild(this.chartBodyContainer),this.scrollElement=t.createElement("div",{className:"e-chart-scroll-container e-content",styles:"position:relative;"}),this.chartBodyContainer.appendChild(this.scrollElement),this.chartBodyContent=t.createElement("div",{className:"e-chart-rows-container",styles:"position:relative; overflow: hidden;"}),this.scrollElement.appendChild(this.chartBodyContent),this.scrollObject=new ye(this.parent);var e=0;t.isNullOrUndefined(this.parent.toolbarModule)||t.isNullOrUndefined(this.parent.toolbarModule.element)||(e=this.parent.toolbarModule.element.offsetHeight),this.scrollObject.setHeight(this.parent.ganttHeight-this.chartTimelineContainer.offsetHeight-e)},e.prototype.updateWidthAndHeight=function(){this.chartBodyContent.style.height=t.formatUnit(this.parent.contentHeight),this.chartBodyContent.style.width=t.formatUnit(this.parent.timelineModule.totalTimelineWidth),this.parent.notify("updateHeight",{}),this.parent.updateGridLineContainerHeight(),this.updateLastRowBottomWidth()},e.prototype.updateLastRowBottomWidth=function(){if(this.parent.currentViewData.length>0&&"auto"!==this.parent.height){var e=this.parent.getExpandedRecords(this.parent.currentViewData),i=e[e.length-1],r=this.parent.currentViewData.indexOf(i),n=this.parent.getRowByIndex(r),a=this.parent.chartRowsModule.ganttChartTableBody;a.querySelectorAll(".e-chart-row-cell.e-chart-row-border.e-lastrow")&&t.removeClass(a.querySelectorAll(".e-chart-row-cell.e-chart-row-border.e-lastrow"),"e-lastrow"),this.chartBodyContent.clientHeight<this.chartBodyContainer.clientHeight&&n&&(t.addClass(n.querySelectorAll("td"),"e-lastrow"),this.chartBodyContent.style.height=t.formatUnit(this.parent.contentHeight+1))}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("renderPanels",this.renderChartContainer),this.parent.off("recordsUpdated",this.renderChartElements),this.parent.off("dataReady",this.renderInitialContents),this.parent.off("tree-grid-created",this.renderChartContents),this.parent.off("destroy",this.destroy))},e.prototype.ganttChartMouseDown=function(e){3!==e.which&&(this.parent.notify("chartMouseDown",e),this.parent.element.tabIndex=0)},e.prototype.ganttChartMouseClick=function(e){this.parent.autoFocusTasks&&this.scrollToTarget(e),this.parent.notify("chartMouseClick",e)},e.prototype.ganttChartMouseUp=function(e){this.parent.notify("chartMouseUp",e)},e.prototype.scrollToTarget=function(e){var i=t.closest(e.target,"tr");if(i&&this.parent.element.contains(i)&&(this.parent.element.querySelectorAll(".e-chart-rows-container")[0].contains(e.target)||this.parent.element.querySelectorAll(".e-gridcontent")[0].contains(e.target))&&this.parent.currentViewData.length>0){var r=t.getValue("rowIndex",t.closest(e.target,"tr")),n=this.parent.currentViewData[r].ganttProperties.startDate;if(!t.isNullOrUndefined(n)){var a=this.parent.dataOperation.getTaskLeft(n,!1);this.parent.autoFocusTasks&&this.updateScrollLeft(a)}}},e.prototype.updateScrollLeft=function(e){e=e-50>0?e-50:0,e=this.scrollElement.scrollWidth<=e?this.scrollElement.scrollWidth:e,(this.scrollElement.offsetWidth+this.parent.ganttChartModule.scrollElement.scrollLeft<e||this.scrollElement.scrollLeft>e)&&this.scrollObject.setScrollLeft(e)},e.prototype.documentMouseUp=function(e){if(!this.parent.isDestroyed&&3!==e.which){var i=!1;if(this.parent.editSettings.allowTaskbarEditing&&t.getValue("editModule.taskbarEditModule.isMouseDragged",this.parent)&&t.getValue("editModule.taskbarEditModule.taskBarEditAction",this.parent)&&(i=!0),this.parent.notify("chartMouseUp",e),!i){var r=e.target,n=e.target.classList.contains(C)||t.closest(e.target,"."+C);t.closest(r,".e-gantt-parent-taskbar")?this.chartExpandCollapseRequest(e):!n&&this.parent.autoFocusTasks&&this.scrollToTarget(e)}this.parent.editModule&&this.parent.editModule.taskbarEditModule&&this.parent.editModule.taskbarEditModule.removeFalseLine(!0)}},e.prototype.ganttChartLeave=function(e){this.parent.notify("chartMouseLeave",e)},e.prototype.ganttChartMove=function(e){this.parent.notify("chartMouseMove",e),!t.isNullOrUndefined(this.parent.taskFields.dependency)&&this.parent.connectorLineEditModule&&this.parent.connectorLineEditModule.updateConnectorLineEditElement(e)},e.prototype.doubleClickHandler=function(e){this.parent.notify("chartDblClick",e)},e.prototype.getRecordByTarget=function(e){var i;if(t.closest(e.target,"tr")){var r=t.getValue("rowIndex",t.closest(e.target,"tr"));i=this.parent.currentViewData[r]}return i},e.prototype.getChartRows=function(){return document.getElementById(this.parent.element.id+"GanttTaskTableBody").querySelectorAll(".e-chart-row")},e.prototype.chartExpandCollapseRequest=function(e){var i=e.target,r=t.closest(i,".e-gantt-parent-taskbar"),n=this.getRecordByTarget(e),a=t.closest(i,"tr"),o=t.getValue("rowIndex",a),s={data:n,gridRow:this.parent.treeGrid.getRows()[o],chartRow:a,cancel:!1};this.isExpandCollapseFromChart=!0,r.classList.contains("e-row-expand")?this.collapseGanttRow(s):r.classList.contains("e-row-collapse")&&this.expandGanttRow(s)},e.prototype.reRenderConnectorLines=function(){this.parent.connectorLineModule.dependencyViewContainer.innerHTML="";var e=this.parent.getExpandedRecords(this.parent.currentViewData);this.parent.connectorLineIds=[],this.parent.updatedConnectorLineCollection=[],this.parent.predecessorModule.createConnectorLinesCollection(e),this.parent.connectorLineModule.renderConnectorLines(this.parent.updatedConnectorLineCollection)},e.prototype.collapseGanttRow=function(e,i){var r=this;i?this.collapsedGanttRow(e):this.parent.trigger("collapsing",e,function(e){r.isExpandCollapseFromChart&&!t.getValue("cancel",e)&&(t.isBlazor()&&(t.setValue("chartRow",t.getElement(t.getValue("chartRow",e)),e),t.setValue("gridRow",t.getElement(t.getValue("gridRow",e)),e)),r.collapsedGanttRow(e)),r.isExpandCollapseFromChart=!1})},e.prototype.collapsedGanttRow=function(e){var i=t.getValue("data",e);this.isExpandCollapseFromChart?(this.expandCollapseChartRows("collapse",t.getValue("chartRow",e),i,null),this.parent.treeGrid.collapseRow(t.getValue("gridRow",e),i),this.isExpandCollapseFromChart=!1):this.expandCollapseChartRows("collapse",t.getValue("chartRow",e),i,null),this.parent.updateContentHeight(),this.updateWidthAndHeight(),this.reRenderConnectorLines(),t.getValue("chartRow",e).setAttribute("aria-expanded","false"),this.parent.trigger("collapsed",e)},e.prototype.expandGanttRow=function(e,i){var r=this;i?this.expandedGanttRow(e):this.parent.trigger("expanding",e,function(e){t.isBlazor()&&(t.setValue("chartRow",t.getElement(t.getValue("chartRow",e)),e),t.setValue("gridRow",t.getElement(t.getValue("gridRow",e)),e)),r.isExpandCollapseFromChart&&!t.getValue("cancel",e)&&r.expandedGanttRow(e),r.isExpandCollapseFromChart=!1})},e.prototype.expandedGanttRow=function(e){var i=t.getValue("data",e);this.isExpandCollapseFromChart?(this.expandCollapseChartRows("expand",t.getValue("chartRow",e),i,null),this.parent.treeGrid.expandRow(t.getValue("gridRow",e),i),this.isExpandCollapseFromChart=!1):this.expandCollapseChartRows("expand",t.getValue("chartRow",e),i,null),this.parent.updateContentHeight(),this.updateWidthAndHeight(),this.reRenderConnectorLines(),t.getValue("chartRow",e).setAttribute("aria-expanded","true"),this.parent.trigger("expanded",e)},e.prototype.expandCollapseChartRows=function(e,i,r,n){var a;if("expand"===e){a="table-row",n||(r.expanded=!0);for(var o=i.querySelectorAll(".e-row-collapse"),s=0;s<o.length;s++)t.addClass([o[s]],"e-row-expand"),t.removeClass([o[s]],"e-row-collapse")}else if("collapse"===e){a="none",n||(r.expanded=!1);for(o=i.querySelectorAll(".e-row-expand"),s=0;s<o.length;s++)t.addClass([o[s]],"e-row-collapse"),t.removeClass([o[s]],"e-row-expand")}for(var l=r.childRecords,d=this.getChartRows(),p=[],h=0;h<d.length;h++)d[h].classList.contains("gridrowtaskId"+r.ganttProperties.taskId+"level"+(r.level+1))&&p.push(d[h]);for(h=0;h<p.length;h++)p[h].style.display=a,l[h].childRecords&&l[h].childRecords.length&&("collapse"===e||l[h].expanded||this.isExpandAll)&&this.expandCollapseChartRows(e,p[h],l[h],!0)},e.prototype.expandCollapseAll=function(e){"expand"===e?(this.isExpandAll=!0,this.parent.treeGrid.expandAll()):this.parent.treeGrid.collapseAll(),this.isExpandAll=!1;this.parent.element.querySelector(".e-treegrid").focus()},e.prototype.expandAtLevel=function(e){this.parent.treeGrid.expandAtLevel(e)},e.prototype.collapseAtLevel=function(e){this.parent.treeGrid.collapseAtLevel(e)},e.prototype.wireEvents=function(){var e=t.Browser.isPointer,i=t.Browser.touchStartEvent,n=t.Browser.touchEndEvent,a=t.Browser.touchMoveEvent,o=e?"pointerleave":"mouseleave";this.parent.editSettings.allowTaskbarEditing&&(t.EventHandler.add(this.parent.chartPane,i,this.ganttChartMouseDown,this),t.EventHandler.add(this.parent.chartPane,o,this.ganttChartLeave,this),t.EventHandler.add(this.parent.chartPane,a,this.ganttChartMove,this),this.parent.isAdaptive&&(t.EventHandler.add(this.parent.chartPane,r.click,this.ganttChartMouseClick,this),t.EventHandler.add(this.parent.chartPane,n,this.ganttChartMouseUp,this))),this.parent.isAdaptive||t.EventHandler.add(document.body,n,this.documentMouseUp,this),this.parent.editSettings.allowEditing&&t.EventHandler.add(this.parent.chartRowsModule.ganttChartTableBody,"dblclick",this.doubleClickHandler,this)},e.prototype.unWireEvents=function(){var e=t.Browser.isPointer,i=t.Browser.touchStartEvent,n=t.Browser.touchEndEvent,a=t.Browser.touchMoveEvent,o=e?"pointerleave":"mouseleave";this.parent.editSettings.allowTaskbarEditing&&(t.EventHandler.remove(this.parent.chartRowsModule.ganttChartTableBody,i,this.ganttChartMouseDown),t.EventHandler.remove(this.parent.chartPane,o,this.ganttChartLeave),t.EventHandler.remove(this.parent.chartPane,a,this.ganttChartMove),this.parent.isAdaptive&&(t.EventHandler.remove(this.parent.chartPane,r.click,this.ganttChartMouseClick),t.EventHandler.remove(this.parent.chartPane,n,this.ganttChartMouseUp))),this.parent.isAdaptive||t.EventHandler.remove(document.body,n,this.documentMouseUp),this.parent.editSettings.allowEditing&&t.EventHandler.remove(this.parent.chartPane,"dblclick",this.doubleClickHandler)},e.prototype.getRecordByTaskBar=function(e){return this.parent.currentViewData[this.getIndexByTaskBar(e)]},e.prototype.getIndexByTaskBar=function(e){var i=t.closest(e,"tr."+F);return[].slice.call(this.parent.chartRowsModule.ganttChartTableBody.childNodes).indexOf(i)},e.prototype.destroy=function(){this.removeEventListener(),this.unWireEvents(),this.scrollObject.destroy(),this.scrollObject=null},e}(),De=function(){return(De=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)},Te=function(){function e(e){this.isZoomIn=!1,this.isZooming=!1,this.isZoomToFit=!1,this.parent=e,this.initProperties()}return e.prototype.initProperties=function(){this.timelineStartDate=null,this.timelineEndDate=null,this.totalTimelineWidth=0,this.customTimelineSettings=null,this.parent.isTimelineRoundOff=!this.isZoomToFit&&!!t.isNullOrUndefined(this.parent.projectStartDate)},e.prototype.validateTimelineProp=function(){this.roundOffDays(),this.processTimelineProperty(),this.timelineWidthCalculation()},e.prototype.refreshTimeline=function(){this.initProperties(),this.processTimelineUnit(),this.parent.dataOperation.calculateProjectDates(),this.parent.updateProjectDates(this.parent.cloneProjectStartDate,this.parent.cloneProjectEndDate,this.parent.isTimelineRoundOff)},e.prototype.refreshTimelineByTimeSpan=function(){this.validateTimelineProp(),this.parent.ganttChartModule.chartTimelineContainer.innerHTML="",this.createTimelineSeries()},e.prototype.updateChartByNewTimeline=function(){this.parent.chartRowsModule.refreshChartByTimeline(),this.parent.notify("refreshDayMarkers",{})},e.prototype.processZooming=function(e){this.isZoomToFit=!1,t.isNullOrUndefined(this.parent.zoomingProjectStartDate)||(this.parent.cloneProjectStartDate=this.parent.cloneProjectStartDate.getTime()<this.parent.zoomingProjectStartDate.getTime()?this.parent.cloneProjectStartDate:this.parent.zoomingProjectStartDate,this.parent.cloneProjectEndDate=this.parent.cloneProjectEndDate.getTime()>this.parent.zoomingProjectEndDate.getTime()?this.parent.cloneProjectEndDate:this.parent.zoomingProjectEndDate),this.parent.zoomingProjectStartDate=null,this.parent.zoomingProjectEndDate=null;var i,r=this.checkCurrentZoomingLevel();this.isZoomIn=e,this.isZooming=!0,i=e?r+1:r-1,this.parent.toolbarModule&&(e?i===this.parent.zoomingLevels[this.parent.zoomingLevels.length-1].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!0):i===this.parent.zoomingLevels[0].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!0));var n=this.parent.zoomingLevels[i],a={requestType:e?"beforeZoomIn":"beforeZoomOut",timeline:n};this.parent.trigger("actionBegin",a),n=a.timeline,this.changeTimelineSettings(n)},e.prototype.changeTimelineSettings=function(e){var i=this,r=this.isSingleTier?"None"===this.customTimelineSettings.topTier.unit?"topTier":"bottomTier":null;if(Object.keys(this.customTimelineSettings).forEach(function(n){if(n!==r)i.customTimelineSettings[n]="object"!=typeof e[n]||t.isNullOrUndefined(e[n])?e[n]:De({},e[n]);else{var a="topTier"===n?"bottomTier":"topTier";i.customTimelineSettings[a]=De({},e.bottomTier)}}),this.parent.isTimelineRoundOff=!this.isZoomToFit&&!!t.isNullOrUndefined(this.parent.projectStartDate),this.processTimelineUnit(),this.parent.updateProjectDates(this.parent.cloneProjectStartDate,this.parent.cloneProjectEndDate,this.parent.isTimelineRoundOff),this.isZooming||this.isZoomToFit){var n={requestType:this.isZoomIn?"AfterZoomIn":this.isZoomToFit?"afterZoomToProject":"AfterZoomOut"};this.parent.trigger("actionComplete",n)}},e.prototype.processZoomToFit=function(){this.isZoomToFit=!0,this.isZooming=!1,this.parent.zoomingProjectStartDate||(this.parent.zoomingProjectStartDate=this.parent.cloneProjectStartDate,this.parent.zoomingProjectEndDate=this.parent.cloneProjectEndDate),this.parent.dataOperation.calculateProjectDates();var e,t,i,r=(this.parent.cloneProjectEndDate.getTime()-this.parent.cloneProjectStartDate.getTime())/864e5,n=this.parent.ganttChartModule.chartElement.offsetWidth,a=n/r,o=this.parent.zoomingLevels.slice().sort(function(e,t){return e.perDayWidth<t.perDayWidth?1:-1});if(0!==a){for(var s=0;s<o.length;s++){if(t=o[s],s===o.length-1){e=o[s];break}if(i=o[s+1],a>=t.perDayWidth){e=o[s];break}if(a<t.perDayWidth&&a>i.perDayWidth){e=o[s+1];break}}var l=De({},e);this.roundOffDateToZoom(this.parent.cloneProjectStartDate,!0,a,l.bottomTier.unit),this.roundOffDateToZoom(this.parent.cloneProjectEndDate,!1,a,l.bottomTier.unit);var d=this.calculateNumberOfTimelineCells(l);l.timelineUnitSize=Math.abs(n-25)/d,this.changeTimelineSettings(l);var p={requestType:"beforeZoomToProject",timeline:l};this.parent.trigger("actionBegin",p)}},e.prototype.roundOffDateToZoom=function(e,t,i,r){var n=("Month"===r||"Year"===r?60:20)/i*864e5;t?e.setTime(e.getTime()-n):e.setTime(e.getTime()+n),"Hour"===r?e.setMinutes(t?-120:120):"Minutes"===r?e.setSeconds(t?-120:120):e.setHours(t?-48:48,0,0,0)},e.prototype.calculateNumberOfTimelineCells=function(e){var t=Math.abs((this.parent.cloneProjectEndDate.getTime()-this.parent.cloneProjectStartDate.getTime())/864e5),i=e.bottomTier.count,r=e.bottomTier.unit;return"Day"===r?t/i:"Week"===r?t/i/7:"Month"===r?t/i/28:"Year"===r?t/i/336:"Hour"===r?t*(24/i):t*(1440/i)},e.prototype.processTimelineUnit=function(){var e=["Year","Month","Week","Day","Hour","Minutes"];this.customTimelineSettings=this.customTimelineSettings?this.customTimelineSettings:this.extendFunction(this.parent.timelineSettings,["timelineViewMode","timelineUnitSize","weekStartDay","weekendBackground"],{topTier:["unit","format","count","formatter"],bottomTier:["unit","format","count","formatter"]}),-1===e.indexOf(this.customTimelineSettings.topTier.unit)&&-1===e.indexOf(this.customTimelineSettings.bottomTier.unit)?(this.customTimelineSettings.topTier.unit=-1!==e.indexOf(this.customTimelineSettings.timelineViewMode)?this.customTimelineSettings.timelineViewMode:"Week",this.customTimelineSettings.bottomTier.unit=5!==e.indexOf(this.customTimelineSettings.topTier.unit)?e[e.indexOf(this.customTimelineSettings.topTier.unit)+1]:"None"):-1!==e.indexOf(this.customTimelineSettings.topTier.unit)&&-1!==e.indexOf(this.customTimelineSettings.bottomTier.unit)&&e.indexOf(this.customTimelineSettings.topTier.unit)>e.indexOf(this.customTimelineSettings.bottomTier.unit)?this.customTimelineSettings.bottomTier.unit=this.customTimelineSettings.topTier.unit:(this.customTimelineSettings.topTier.unit=-1===e.indexOf(this.customTimelineSettings.topTier.unit)?"None":this.customTimelineSettings.topTier.unit,this.customTimelineSettings.bottomTier.unit=-1===e.indexOf(this.customTimelineSettings.bottomTier.unit)?"None":this.customTimelineSettings.bottomTier.unit),this.topTier=this.customTimelineSettings.topTier.unit,this.bottomTier=this.customTimelineSettings.bottomTier.unit,this.previousIsSingleTier=this.isSingleTier,this.isSingleTier="None"===this.topTier||"None"===this.bottomTier},e.prototype.processTimelineProperty=function(){this.customTimelineSettings.topTier.count="None"===this.topTier?1:this.validateCount(this.customTimelineSettings.topTier.unit,this.customTimelineSettings.topTier.count,"topTier"),this.customTimelineSettings.bottomTier.count="None"===this.customTimelineSettings.bottomTier.unit?1:this.validateCount(this.customTimelineSettings.bottomTier.unit,this.customTimelineSettings.bottomTier.count,"bottomTier"),this.customTimelineSettings.bottomTier.format=this.validateFormat(this.customTimelineSettings.bottomTier.unit,this.customTimelineSettings.bottomTier.format),this.customTimelineSettings.topTier.format=this.validateFormat(this.topTier,this.customTimelineSettings.topTier.format),this.customTimelineSettings.weekStartDay=this.customTimelineSettings.weekStartDay>=0&&this.customTimelineSettings.weekStartDay<=6?this.customTimelineSettings.weekStartDay:0,this.checkCurrentZoomingLevel()},e.prototype.calculateZoomingLevelsPerDayWidth=function(){for(var e=this.parent.zoomingLevels,t=0;t<e.length;t++){var i=this.getPerDayWidth(e[t].timelineUnitSize,e[t].bottomTier.count,e[t].bottomTier.unit);e[t].perDayWidth=i}},e.prototype.checkCurrentZoomingLevel=function(){var e="None"!==this.customTimelineSettings.bottomTier.unit?this.customTimelineSettings.bottomTier.count:this.customTimelineSettings.topTier.count,t="None"!==this.customTimelineSettings.bottomTier.unit?this.customTimelineSettings.bottomTier.unit:this.customTimelineSettings.topTier.unit,i=this.getCurrentZoomingLevel(t,e);return this.parent.toolbarModule&&(i===this.parent.zoomingLevels[this.parent.zoomingLevels.length-1].level?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):i===this.parent.zoomingLevels[0].level&&this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1)),this.parent.currentZoomingLevel=this.parent.zoomingLevels[i],i},e.prototype.getCurrentZoomingLevel=function(e,t){var i,r,n,a,o;this.parent.zoomingLevels.length||(this.parent.zoomingLevels=this.parent.getZoomingLevels());var s=this.parent.zoomingLevels.filter(function(t){return t.bottomTier.unit===e});if(0===s.length){var l=this.getClosestUnit(e,"",!1);s=this.parent.zoomingLevels.filter(function(e){return e.bottomTier.unit===l})}for(var d=s.sort(function(e,t){return e.bottomTier.count<t.bottomTier.count?1:-1}),p=0;p<d.length;p++){if(o=d[p],p===d.length-1){i=d[p].level;break}if(a=d[p+1],t>=o.bottomTier.count){r=d[p],i=(n=d.filter(function(e){return e.bottomTier.count===r.bottomTier.count})).length>1?this.checkCollectionsWidth(n):n[0].level;break}if(t<o.bottomTier.count&&t>a.bottomTier.count){r=d[p+1],i=(n=d.filter(function(e){return e.bottomTier.count===r.bottomTier.count})).length>1?this.checkCollectionsWidth(n):n[0].level;break}}return i},e.prototype.getClosestUnit=function(e,t,i){var r=["Year","Month","Week","Day","Hour","Minutes"],n=r.indexOf(e);0===n&&(i=!0),e=this.isZoomIn||i?r[n+1]:r[n-1];return 0===this.parent.zoomingLevels.filter(function(t){return t.bottomTier.unit===e}).length?("Year"===e&&(i=!0),t=e,this.getClosestUnit(e,t,i)):e},e.prototype.checkCollectionsWidth=function(e){for(var t,i,r,n=e,a=this.customTimelineSettings.timelineUnitSize,o=n.sort(function(e,t){return e.timelineUnitSize<t.timelineUnitSize?1:-1}),s=0;s<o.length;s++){if(r=o[s],s===o.length-1){t=o[s].level;break}if(i=o[s+1],a>=r.timelineUnitSize){t=o[s].level;break}if(a<r.timelineUnitSize&&a>i.timelineUnitSize){t=o[s+1].level;break}}return t},e.prototype.updateTimelineHeaderHeight=function(){if(this.parent.timelineModule.isSingleTier?(t.addClass([this.parent.ganttChartModule.chartTimelineContainer],b),this.parent.treeGrid.element&&(t.addClass(this.parent.treeGrid.element.querySelectorAll(".e-headercell"),b),t.addClass(this.parent.treeGrid.element.querySelectorAll(".e-columnheader"),b))):(t.removeClass([this.parent.ganttChartModule.chartTimelineContainer],b),this.parent.treeGrid.element&&(t.removeClass(this.parent.treeGrid.element.querySelectorAll(".e-headercell"),b),t.removeClass(this.parent.treeGrid.element.querySelectorAll(".e-columnheader"),b))),this.previousIsSingleTier!==this.isSingleTier){var e=0;t.isNullOrUndefined(this.parent.toolbarModule)||t.isNullOrUndefined(this.parent.toolbarModule.element)||(e=this.parent.toolbarModule.element.offsetHeight),this.parent.ganttChartModule.scrollObject.setHeight(this.parent.ganttHeight-this.parent.ganttChartModule.chartTimelineContainer.offsetHeight-e),this.parent.treeGrid.height=this.parent.ganttHeight-e-this.parent.ganttChartModule.chartTimelineContainer.offsetHeight}},e.prototype.createTimelineSeries=function(){var e,i,r,n,a,o=this.isSingleTier?1:2,s="None"===this.topTier?"bottomTier":"topTier";this.updateTimelineHeaderHeight();for(var l=0;l<o;l++)n=t.createElement("table",{className:"e-timeline-header-table-container",styles:"display: block;"}),a=t.createElement("thead",{className:"e-timeline-header-table-body",styles:"display:block; border-collapse:collapse"}),e=t.createElement("tr",{innerHTML:this.createTimelineTemplate(s)}),i=t.createElement("th"),r=t.createElement("div",{styles:"width: 20px"}),i.appendChild(r),e.appendChild(i),a.appendChild(e),n.appendChild(a),this.parent.ganttChartModule.chartTimelineContainer.appendChild(n),s="bottomTier",e=null},e.prototype.validateCount=function(e,i,r){var n,a=!t.isNullOrUndefined(i)&&parseInt(i.toString(),10)>0?parseInt(i.toString(),10):1,o=Math.abs(this.timelineRoundOffEndDate.getTime()-this.timelineStartDate.getTime());switch(e){case"Year":a=a<=(n=Math.round(o/864e5/336))?a:n>0?n:1,"None"!==this.topTier&&"bottomTier"===r&&(a=this.validateBottomTierCount(e,a));break;case"Month":a=a<=(n=Math.round(o/864e5/28))?a:n>0?n:1,"None"!==this.topTier&&"bottomTier"===r&&(a=this.validateBottomTierCount(e,a));break;case"Week":a=a<=(n=Math.round(o/864e5/7))?a:n>0?n:1,"None"!==this.topTier&&"bottomTier"===r&&(a=this.validateBottomTierCount(e,a));break;case"Day":a=a<=(n=Math.round(o/864e5))?a:n>0?n:1,"None"!==this.topTier&&"bottomTier"===r&&(a=this.validateBottomTierCount(e,a));break;case"Hour":a=a<=(n=Math.round(o/36e5))?a:n>0?n:1,"None"!==this.topTier&&"bottomTier"===r&&(a=this.validateBottomTierCount(e,a));break;case"Minutes":a=a<=(n=Math.round(o/6e4))?a:n>0?n:1,"None"!==this.topTier&&"bottomTier"===r&&(a=this.validateBottomTierCount(e,a))}return i!==a&&this.isZooming&&this.parent.toolbarModule&&("bottomTier"===r||this.isSingleTier)&&(this.isZoomIn?this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomin"],!1):this.parent.toolbarModule.enableItems([this.parent.controlId+"_zoomout"],!1)),a},e.prototype.validateBottomTierCount=function(e,t){var i;switch(e){case"Year":i=t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Month":i="Year"===this.topTier?t<=12*this.customTimelineSettings.topTier.count?t:12*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Week":i="Year"===this.topTier?t<=48*this.customTimelineSettings.topTier.count?t:48*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=4*this.customTimelineSettings.topTier.count?t:4*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Day":i="Year"===this.topTier?t<=336*this.customTimelineSettings.topTier.count?t:336*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=28*this.customTimelineSettings.topTier.count?t:28*this.customTimelineSettings.topTier.count:"Week"===this.topTier?t<=7*this.customTimelineSettings.topTier.count?t:7*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Hour":i="Year"===this.topTier?t<=8064*this.customTimelineSettings.topTier.count?t:8064*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=672*this.customTimelineSettings.topTier.count?t:672*this.customTimelineSettings.topTier.count:"Week"===this.topTier?t<=7*this.customTimelineSettings.topTier.count*24?t:7*this.customTimelineSettings.topTier.count*24:"Day"===this.topTier?t<=24*this.customTimelineSettings.topTier.count?t:24*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count;break;case"Minutes":i="Year"===this.topTier?t<=483840*this.customTimelineSettings.topTier.count?t:483840*this.customTimelineSettings.topTier.count:"Month"===this.topTier?t<=40320*this.customTimelineSettings.topTier.count?t:40320*this.customTimelineSettings.topTier.count:"Week"===this.topTier?t<=7*this.customTimelineSettings.topTier.count*24*60?t:7*this.customTimelineSettings.topTier.count*24*60:"Day"===this.topTier?t<=24*this.customTimelineSettings.topTier.count*60?t:24*this.customTimelineSettings.topTier.count*60:"Hour"===this.topTier?t<=60*this.customTimelineSettings.topTier.count?t:60*this.customTimelineSettings.topTier.count:t<=this.customTimelineSettings.topTier.count?t:this.customTimelineSettings.topTier.count}return i},e.prototype.validateFormat=function(e,t){var i;switch(e){case"Week":i=t||"MMM dd, yyyy";break;case"Day":case"None":i=t||"";break;case"Hour":i=t||"H";break;case"Month":i=t||"MMM yyyy";break;case"Year":i=t||"yyyy";break;case"Minutes":i=t||"m"}return i},e.prototype.extendFunction=function(e,t,i){for(var r=this,n={},a=0;a<t.length;a++)n[t[a]]=e[t[a]];return i&&Object.keys(i).forEach(function(t){n[t]=r.extendFunction(e[t],i[t],null)}),n},e.prototype.formatDateHeader=function(e,t){var i,r=new Date(t.getTime());switch(e){case"":i=(i=this.parent.globalize.formatDate(r,{format:"E"})).slice(0,1);break;default:i=this.parent.globalize.formatDate(r,{format:e})}return i},e.prototype.customFormat=function(e,i,r,n,a){return(a="string"==typeof a?t.getValue(a,window):a)(e,i,r,n)},e.prototype.createTimelineTemplate=function(e){var t,i,r=this.parent,n="",a="",o="topTier"===e?r.timelineModule.customTimelineSettings.topTier.unit:r.timelineModule.customTimelineSettings.bottomTier.unit,s="topTier"===e?r.timelineModule.customTimelineSettings.topTier.count:r.timelineModule.customTimelineSettings.bottomTier.count,l=new Date(this.parent.timelineModule.timelineStartDate.toString()),d=new Date(this.timelineRoundOffEndDate.toString()),p=[];do{a=this.getHeaterTemplateString(new Date(l.toString()),o,e,!1,s),p.push(new Date(l.toString())),t=this.getIncrement(l,s,o),i=l.getTime()+t,l.setTime(i),l>=d&&(a=this.getHeaterTemplateString(p[p.length-1],o,e,!0,s)),n+=a,a=""}while(!(l>=d));return n},e.prototype.getTimelineRoundOffEndDate=function(e){var t="None"===this.topTier?this.bottomTier:this.topTier,i=new Date(e.toString());return this.parent.isTimelineRoundOff&&("Hour"===t?i.setMinutes(60):"Minutes"===t?i.setSeconds(60):i.setHours(24,0,0,0)),i},e.prototype.getIncrement=function(e,t,i){var r,n=new Date(e.getTime()),a=new Date(e.getTime());switch(i){case"Year":n=e,r=(a=new Date(e.getFullYear()+(t-1),11,31)).getTime()-n.getTime()+864e5;break;case"Month":n=e,r=(a=new Date(e.getFullYear(),e.getMonth()+t,1)).getTime()-n.getTime();break;case"Week":var o=this.parent.timelineModule.customTimelineSettings.weekStartDay,s=e.getDay()<o?o-e.getDay():6-e.getDay()+o;t=s>0?t-1:0,a.setHours(24,0,0,0),s=e.getDay()<o&&s>0?s-1:s,a.setDate(a.getDate()+(s+7*t)),r=a.getTime()-n.getTime();break;case"Day":a.setHours(24,0,0,0),r=a.getTime()-n.getTime()+864e5*(t-1);break;case"Hour":a.setMinutes(60),a.setSeconds(0),r=a.getTime()-n.getTime()+36e5*(t-1);break;case"Minutes":a.setSeconds(60),r=a.getTime()-n.getTime()+6e4*(t-1)}return r},e.prototype.isWeekendHeaderCell=function(e,t,i){return"Day"===e&&1===this.customTimelineSettings[t].count&&-1!==this.parent.nonWorkingDayIndex.indexOf(i.getDay())},e.prototype.getHeaterTemplateString=function(e,i,r,n,a){var o,s,l,d="",p="",h="topTier"===r?this.parent.timelineModule.customTimelineSettings.topTier.format:this.parent.timelineModule.customTimelineSettings.bottomTier.format,c="topTier"===r?this.parent.timelineModule.customTimelineSettings.topTier.formatter:this.parent.timelineModule.customTimelineSettings.bottomTier.formatter,u=t.isNullOrUndefined(c)?this.parent.globalize.formatDate(e,{format:this.parent.dateFormat}):this.customFormat(e,h,r,i,c);s=o=this.getIncrement(e,a,i)/864e5*this.parent.perDayWidth,o=n?this.calculateWidthBetweenTwoDate(i,e,this.timelineRoundOffEndDate):o,l=this.isWeekendHeaderCell(i,r,e);var g="topTier"===r?" e-gantt-top-cell-text":"";return p+=this.parent.timelineModule.isSingleTier?'<th class="e-timeline-single-header-cell ':'<th class="e-timeline-top-header-cell',p+=l?" e-weekend-header-cell":"",p+='" tabindex="-1" aria-label= "'+this.parent.localeObj.getConstant("timelineCell")+" "+u,p+='" style="width:'+o+"px;",p+=l&&this.customTimelineSettings.weekendBackground?"background-color:"+this.customTimelineSettings.weekendBackground+";":"",p+='"><div class="e-header-cell-label'+g+'" style="width:'+(o-1)+"px;"+(this.parent.timelineSettings.showTooltip?'"title="'+u:""),p+='">'+(t.isNullOrUndefined(c)?this.formatDateHeader(h,e):this.customFormat(e,h,r,i,c))+"</div>",d+=p,d+="</th>",p="",!this.isSingleTier&&"topTier"!==r||n?(this.isSingleTier||"topTier"===r)&&n&&(this.totalTimelineWidth=this.totalTimelineWidth-s+o):this.totalTimelineWidth=this.totalTimelineWidth+o,d},e.prototype.calculateWidthBetweenTwoDate=function(e,t,i){return(i.getTime()-t.getTime())/864e5*this.parent.perDayWidth},e.prototype.timelineWidthCalculation=function(){var e=this.customTimelineSettings.timelineUnitSize,t=this.customTimelineSettings.bottomTier.count,i=this.customTimelineSettings.topTier.count;switch(this.bottomTierCellWidth=e,this.bottomTier){case"None":this.parent.perDayWidth=this.getPerDayWidth(e,i,this.topTier);break;default:this.parent.perDayWidth=this.getPerDayWidth(e,t,this.bottomTier)}this.topTierCellWidth="None"!==this.bottomTier?"Week"===this.topTier?7*this.parent.perDayWidth:"Hour"===this.topTier?this.parent.perDayWidth/24:"Minutes"===this.topTier?this.parent.perDayWidth/1440:this.parent.perDayWidth:e,this.topTierCellWidth=this.isSingleTier?this.topTierCellWidth:this.topTierCellWidth*i},e.prototype.getPerDayWidth=function(e,t,i){var r;switch(i){case"Year":r=e/t/336;break;case"Month":r=e/t/28;break;case"Week":r=e/t/7;break;case"Day":r=e/t;break;case"Hour":r=24/t*e;break;case"Minutes":r=1440/t*e}return r},e.prototype.roundOffDays=function(){var e=this.parent.cloneProjectStartDate,t=this.parent.cloneProjectEndDate,i="None"===this.topTier?this.bottomTier:this.topTier;if(this.parent.isTimelineRoundOff){if("Year"===i)e=new Date(e.getFullYear(),0,1),t=new Date(t.getFullYear(),11,31);else if("Month"===i)e=new Date(e.getFullYear(),e.getMonth(),1),t=new Date(t.getFullYear(),t.getMonth()+1,0);else if("Week"===i){var r=this.parent.timelineModule.customTimelineSettings.weekStartDay,n=e.getDay()<r?e.getDate()-(7-r+e.getDay()):e.getDate()-e.getDay()+r;e.setDate(n);var a=t.getDate()-t.getDay()+6+r;t.setDate(a)}"Hour"===i?e.setMinutes(0):"Minutes"===i?e.setSeconds(0):e.setHours(0,0,0,0)}this.timelineStartDate=e,this.timelineEndDate=t,this.timelineRoundOffEndDate=this.getTimelineRoundOffEndDate(this.timelineEndDate)},e.prototype.updateScheduleDatesByToolBar=function(e,t,i,r){if("Year"===e&&("prevTimeSpan"===t?i=0===i.getMonth()?new Date(i.getFullYear()-1,0,1):new Date(i.getFullYear(),0,1):r=11===r.getMonth()?new Date(r.getFullYear()+1,0,1):new Date(r.getFullYear(),12,1)),"Month"===e&&("prevTimeSpan"===t?i=1===i.getDate()?new Date(i.getFullYear(),i.getMonth()-1,1):new Date(i.getFullYear(),i.getMonth(),1):r=new Date(r.getFullYear(),r.getMonth()+1,1)),"Week"===e){var n=this.parent.timelineModule.customTimelineSettings.weekStartDay,a=void 0;"prevTimeSpan"===t?(a=i.getDay()<n?7-(n-i.getDay()):i.getDay()-n,i.setHours(0,0,0,0),0===a?i.setDate(i.getDate()-7):i.setDate(i.getDate()-a)):(a=r.getDay()<n?n-r.getDay():7-r.getDay()+n,r.setHours(0,0,0,0),0===a?r.setDate(r.getDate()+6):r.setDate(r.getDate()+a))}"Day"===e&&("prevTimeSpan"===t?0===i.getHours()?i.setTime(i.getTime()-864e5):i.setHours(0):0===r.getHours()?r.setTime(r.getTime()+864e5):r.setHours(24)),"Hour"===e&&("prevTimeSpan"===t?0===i.getMinutes()?i.setTime(i.getTime()-36e5):i.setMinutes(0):0===r.getMinutes()?r.setTime(r.getTime()+36e5):r.setMinutes(60)),"Minutes"===e&&("prevTimeSpan"===t?0===i.getSeconds()?i.setTime(i.getTime()-6e4):i.setSeconds(0):0===r.getSeconds()?r.setTime(r.getTime()+6e4):r.setSeconds(60)),this.parent.cloneProjectStartDate=i,this.parent.cloneProjectEndDate=r},e.prototype.updateTimeLineOnEditing=function(e,i){var r,a=e.filter(function(e){return!t.isNullOrUndefined(e.ganttProperties.startDate)}),o=e.filter(function(e){return!t.isNullOrUndefined(e.ganttProperties.endDate)}),s=a.length>0?new Date(n.DataUtil.aggregates.min(a,"ganttProperties.startDate")):null,l=o.length>0?new Date(n.DataUtil.aggregates.max(o,"ganttProperties.endDate")):null,d=new Date(this.parent.dataOperation.checkStartDate(this.timelineStartDate).getTime()),p=new Date(this.parent.dataOperation.checkEndDate(this.timelineEndDate).getTime()),h=t.isNullOrUndefined(s)?null:this.parent.dataOperation.getTaskLeft(s,!1),c=t.isNullOrUndefined(l)?null:this.parent.dataOperation.getTaskLeft(l,!1),u=this.parent.dataOperation.getTaskLeft(d,!1),g=this.parent.dataOperation.getTaskLeft(p,!1);!t.isNullOrUndefined(h)&&(h<=this.bottomTierCellWidth||h<=u)?(r="prevTimeSpan",s=s>this.timelineStartDate?this.timelineStartDate:s):s=this.timelineStartDate,!t.isNullOrUndefined(c)&&(c>=this.totalTimelineWidth-this.bottomTierCellWidth||c>=g)?(r="prevTimeSpan"===r?"both":"nextTimeSpan",l=l<this.timelineEndDate?this.timelineEndDate:l):l=this.timelineEndDate,r&&this.performTimeSpanAction(r,i,s,l)},e.prototype.performTimeSpanAction=function(e,i,r,n,a){a=t.isNullOrUndefined(a)?"None"===this.parent.timelineModule.topTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier:a;var o=new Date(this.parent.cloneProjectStartDate.getTime()),s=new Date(this.parent.cloneProjectEndDate.getTime());"publicMethod"!==i&&"both"===e?(this.updateScheduleDatesByToolBar(a,"prevTimeSpan",r,n),this.updateScheduleDatesByToolBar(a,"nextTimeSpan",new Date(this.parent.cloneProjectStartDate.getTime()),n)):this.updateScheduleDatesByToolBar(a,e,r,n);var l=this.timeSpanActionEvent("actionBegin",e,i);l.cancel?(this.parent.cloneProjectStartDate=o,this.parent.cloneProjectEndDate=s):(this.parent.updateProjectDates(l.projectStartDate,l.ProjectEndDate,l.isTimelineRoundOff,i),"prevTimeSpan"===e&&"publicMethod"===i?this.parent.ganttChartModule.updateScrollLeft(0):"nextTimeSpan"===e&&"publicMethod"===i&&this.parent.ganttChartModule.updateScrollLeft(this.parent.timelineModule.totalTimelineWidth),this.parent.timelineModule.timeSpanActionEvent("actionComplete",e,i))},e.prototype.timeSpanActionEvent=function(e,t,i){var r={};return r.projectStartDate=new Date(this.parent.cloneProjectStartDate.getTime()),r.ProjectEndDate=new Date(this.parent.cloneProjectEndDate.getTime()),r.requestType="publicMethod"===i?t:"beforeAdd"===i?"TimelineRefreshOnAdd":"TaskbarEditing"===i?"TimelineRefreshOnEdit":t,"actionBegin"===e&&(r.isTimelineRoundOff=this.parent.isTimelineRoundOff,r.cancel=!1),this.parent.trigger(e,r),r},e}(),ke=function(){return function(e){this.allowEditing=!0,this.allowReordering=!0,this.allowResizing=!0,this.allowSorting=!0,this.allowFiltering=!0,this.edit={},t.merge(this,e)}}(),Se=function(){function e(e){var t=this;this.previousScroll={top:0,left:0},this.queryCellInfo=function(e){t.parent.trigger("queryCellInfo",e)},this.headerCellInfo=function(e){t.parent.trigger("headerCellInfo",e)},this.rowDataBound=function(e){t.parent.trigger("rowDataBound",e)},this.columnMenuOpen=function(e){t.parent.notify("columnMenuOpen",e),t.parent.trigger("columnMenuOpen",e)},this.columnMenuClick=function(e){t.parent.trigger("columnMenuClick",e)},this.parent=e,this.parent.treeGrid=new a.TreeGrid,this.parent.treeGrid.allowSelection=!1,this.treeGridColumns=[],this.validateGanttColumns(),this.addEventListener()}return e.prototype.addEventListener=function(){this.parent.on("renderPanels",this.createContainer,this),this.parent.on("chartScroll",this.updateScrollTop,this),this.parent.on("destroy",this.destroy,this)},e.prototype.createContainer=function(){this.treeGridElement=t.createElement("div",{id:"treeGrid"+this.parent.element.id,className:"e-gantt-tree-grid"});var e=t.createElement("div",{className:"e-gantt-temp-header"});this.parent.treeGridPane.appendChild(this.treeGridElement),this.treeGridElement.appendChild(e),this.parent.treeGridPane.classList.add("e-temp-content")},e.prototype.renderTreeGrid=function(){this.composeProperties(),this.bindEvents(),this.parent.treeGrid.appendTo(this.treeGridElement),this.wireEvents()},e.prototype.composeProperties=function(){this.parent.treeGrid.showColumnMenu=this.parent.showColumnMenu,this.parent.treeGrid.columnMenuItems=this.parent.columnMenuItems,this.parent.treeGrid.childMapping=this.parent.taskFields.child,this.parent.treeGrid.treeColumnIndex=this.parent.treeColumnIndex,this.parent.treeGrid.columns=this.treeGridColumns,this.parent.treeGrid.dataSource=this.parent.flatData,this.parent.treeGrid.rowHeight=this.parent.rowHeight,this.parent.treeGrid.gridLines=this.parent.gridLines,this.parent.treeGrid.searchSettings=this.parent.searchSettings;this.parent.treeGrid.isJsComponent=!0;var e=0;t.isNullOrUndefined(this.parent.toolbarModule)||t.isNullOrUndefined(this.parent.toolbarModule.element)||(e=this.parent.toolbarModule.element.offsetHeight),this.parent.treeGrid.height=this.parent.ganttHeight-e-46},e.prototype.getContentDiv=function(){return this.treeGridElement.querySelector(".e-content")},e.prototype.getHeaderDiv=function(){return this.treeGridElement.querySelector(".e-headercontent")},e.prototype.getScrollbarWidth=function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar";var t=document.createElement("div");e.appendChild(t),this.parent.element.appendChild(e);var i=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),i},e.prototype.ensureScrollBar=function(){var e=this.getContentDiv(),t=this.getHeaderDiv(),i=this.getScrollbarWidth(),r=/Android|Mac|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);0!==i?e.style.cssText+="width: calc(100% + "+i+"px);":e.classList.add("e-gantt-scroll-padding"),0===i&&r&&(t.style.cssText+="width: calc(100% + 17px);")},e.prototype.bindEvents=function(){this.parent.treeGrid.dataBound=this.dataBound.bind(this),this.parent.treeGrid.collapsing=this.collapsing.bind(this),this.parent.treeGrid.collapsed=this.collapsed.bind(this),this.parent.treeGrid.expanding=this.expanding.bind(this),this.parent.treeGrid.expanded=this.expanded.bind(this),this.parent.treeGrid.actionBegin=this.actionBegin.bind(this),this.parent.treeGrid.actionComplete=this.treeActionComplete.bind(this),this.parent.treeGrid.created=this.created.bind(this),this.parent.treeGrid.actionFailure=this.actionFailure.bind(this),this.parent.treeGrid.queryCellInfo=this.queryCellInfo.bind(this),this.parent.treeGrid.headerCellInfo=this.headerCellInfo.bind(this),this.parent.treeGrid.rowDataBound=this.rowDataBound.bind(this),this.parent.treeGrid.columnMenuOpen=this.columnMenuOpen.bind(this),this.parent.treeGrid.columnMenuClick=this.columnMenuClick.bind(this)},e.prototype.dataBound=function(e){this.ensureScrollBar(),this.parent.treeDataBound(e)},e.prototype.collapsing=function(e){var i=this,r=new n.Deferred;if(!this.parent.ganttChartModule.isExpandCollapseFromChart){var a=this.createExpandCollapseArgs(e);if(t.isBlazor())return this.parent.trigger("collapsing",a,function(e){r.resolve(e),t.setValue("chartRow",t.getElement(t.getValue("chartRow",e)),e),t.setValue("gridRow",t.getElement(t.getValue("gridRow",e)),e),t.getValue("cancel",e)||i.parent.ganttChartModule.collapseGanttRow(e,!0)}),r;this.parent.ganttChartModule.collapseGanttRow(a),t.setValue("cancel",t.getValue("cancel",a),e)}},e.prototype.expanding=function(e){var i=this,r=new n.Deferred;if(!this.parent.ganttChartModule.isExpandCollapseFromChart){var a=this.createExpandCollapseArgs(e);if(t.isBlazor())return this.parent.trigger("expanding",a,function(e){r.resolve(e),t.setValue("chartRow",t.getElement(t.getValue("chartRow",e)),e),t.setValue("gridRow",t.getElement(t.getValue("gridRow",e)),e),t.getValue("cancel",e)||i.parent.ganttChartModule.expandGanttRow(e,!0)}),r;this.parent.ganttChartModule.expandGanttRow(a),t.setValue("cancel",t.getValue("cancel",a),e)}},e.prototype.collapsed=function(e){if(this.updateExpandStatus(e),!this.parent.ganttChartModule.isExpandCollapseFromChart){var t=this.createExpandCollapseArgs(e);this.parent.ganttChartModule.collapsedGanttRow(t)}},e.prototype.expanded=function(e){if(this.updateExpandStatus(e),!this.parent.ganttChartModule.isExpandCollapseFromChart){var t=this.createExpandCollapseArgs(e);this.parent.ganttChartModule.expandedGanttRow(t)}},e.prototype.updateExpandStatus=function(e){if(t.getValue("data",e)&&t.isBlazor()){this.parent.getTaskByUniqueID(t.getValue("data",e).uniqueID).expanded=t.getValue("data",e).expanded}},e.prototype.actionBegin=function(e){this.parent.notify("actionBegin",e),this.parent.trigger("actionBegin",e)},e.prototype.created=function(e){this.updateKeyConfigSettings()},e.prototype.actionFailure=function(e){this.parent.trigger("actionFailure",e)},e.prototype.createExpandCollapseArgs=function(e){var i=t.getValue("data",e);return{data:i,gridRow:t.getValue("row",e),chartRow:t.isBlazor()?this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(this.parent.getTaskByUniqueID(i.uniqueID))]:this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(i)],cancel:!1}},e.prototype.treeActionComplete=function(e){var i=t.extend({},e,!0);if("sorting"===t.getValue("requestType",e))this.parent.notify("updateModel",{}),t.deleteObject(i,"isFrozen");else if("filtering"===t.getValue("requestType",e)){this.parent.notify("updateModel",{});this.parent.element.querySelector(".e-treegrid").focus()}else"save"===t.getValue("type",e)&&this.parent.editModule&&this.parent.editModule.cellEditModule&&(this.parent.editModule.cellEditModule.initiateCellEdit(e,this.currentEditRow),this.currentEditRow={});"filterafteropen"===t.getValue("requestType",e)&&this.parent.notify("actionComplete",e),"searching"===t.getValue("requestType",e)&&this.parent.notify("actionComplete",e),t.isNullOrUndefined(t.getValue("batchChanges",e))||t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),t.isBlazor()&&this.parent.updateDataArgs(i),this.parent.trigger("actionComplete",i)},e.prototype.updateKeyConfigSettings=function(){delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.delete,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.insert,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.upArrow,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.downArrow,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.ctrlHome,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.ctrlEnd,delete this.parent.treeGrid.grid.keyboardModule.keyConfigs.enter,delete this.parent.treeGrid.keyboardModule.keyConfigs.enter,delete this.parent.treeGrid.keyboardModule.keyConfigs.upArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.downArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlShiftUpArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlShiftDownArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlUpArrow,delete this.parent.treeGrid.keyboardModule.keyConfigs.ctrlDownArrow},e.prototype.wireEvents=function(){var e=this.parent.treeGrid.element.querySelector(".e-content");e&&t.EventHandler.add(e,"scroll",this.scrollHandler,this),this.parent.isAdaptive&&t.EventHandler.add(this.parent.treeGridPane,"click",this.treeGridClickHandler,this)},e.prototype.unWireEvents=function(){var e=this.parent.treeGrid.element&&this.parent.treeGrid.element.querySelector(".e-content");e&&t.EventHandler.remove(e,"scroll",this.scrollHandler),this.parent.isAdaptive&&t.EventHandler.remove(this.parent.treeGridPane,"click",this.treeGridClickHandler)},e.prototype.scrollHandler=function(e){var t=this.parent.treeGrid.element.querySelector(".e-content");t.scrollTop!==this.previousScroll.top&&this.parent.notify("grid-scroll",{top:t.scrollTop}),this.previousScroll.top=t.scrollTop},e.prototype.validateGanttColumns=function(){var e=this.parent,i=e.columns.length,r=this.parent.taskFields;this.parent.columnMapping={},this.parent.columnByField={},this.parent.customColumns=[];for(var n=["id","name","startDate","endDate","duration","dependency","progress","baselineStartDate","baselineEndDate","resourceInfo","notes"],a=function(t){var i={};"string"==typeof e.columns[t]?i.field=e.columns[t]:i=e.columns[t];var a=[];if(n.length>0&&(a=n.filter(function(e){return i.field===r[e]})),0===a.length)return o.parent.customColumns.push(i.field),i.headerText=i.headerText?i.headerText:i.field,i.width=i.width?i.width:150,i.editType=i.editType?i.editType:"stringedit",i.type=i.type?i.type:"string",o.bindTreeGridColumnProperties(i,!0),"continue";var s=n.indexOf(a[0]);n.splice(s,1),o.createTreeGridColumn(i,!0),o.parent.columnMapping[a[0]]=i.field},o=this,s=0;s<i;s++)a(s);for(var l=0;l<n.length;l++){var d={};t.isNullOrUndefined(r[n[l]])||(d.field=r[n[l]],this.createTreeGridColumn(d,0===i),this.parent.columnMapping[n[l]]=d.field)}},e.prototype.createTreeGridColumn=function(e,i){var r=this.parent.taskFields;r.id!==e.field&&(e.clipMode=e.clipMode?e.clipMode:"EllipsisWithTooltip"),r.id===e.field?this.composeIDColumn(e):r.name===e.field?(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("name"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"stringedit",e.type=e.type?e.type:"string"):r.startDate===e.field?(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("startDate"),e.editType=e.editType?e.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",e.format=e.format?e.format:{type:"date",format:this.parent.dateFormat},e.width=e.width?e.width:150,e.edit={params:{renderDayCell:this.parent.renderWorkingDayCell.bind(this.parent)}}):r.endDate===e.field?(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("endDate"),e.format=e.format?e.format:{type:"date",format:this.parent.dateFormat},e.editType=e.editType?e.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit",e.width=e.width?e.width:150,e.edit={params:{renderDayCell:this.parent.renderWorkingDayCell.bind(this.parent)}}):r.duration===e.field?(e.width=e.width?e.width:150,e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("duration"),e.valueAccessor=e.valueAccessor?e.valueAccessor:this.durationValueAccessor.bind(this),e.editType=e.editType?e.editType:"stringedit",e.type="string"):r.progress===e.field?this.composeProgressColumn(e):r.dependency===e.field?(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("dependency"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"stringedit",e.type="string",e.allowFiltering=!1!==e.allowFiltering):r.resourceInfo===e.field?this.composeResourceColumn(e):r.notes===e.field?(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("notes"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"stringedit",t.isBlazor()&&!e.template&&this.parent.setProperties({showInlineNotes:!0},!0),this.parent.showInlineNotes?e.disableHtmlEncode=!0:e.template||(e.template='<div class="e-ganttnotes-info"><span class="e-icons e-notes-info"></span></div>')):r.baselineStartDate===e.field?(e.width=e.width?e.width:150,e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("baselineStartDate"),e.format=e.format?e.format:{type:"date",format:this.parent.dateFormat},e.editType=e.editType?e.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit"):r.baselineEndDate===e.field&&(e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("baselineEndDate"),e.width=e.width?e.width:150,e.format=e.format?e.format:{type:"date",format:this.parent.dateFormat},e.editType=e.editType?e.editType:-1!==this.parent.dateFormat.toLowerCase().indexOf("hh")?"datetimepickeredit":"datepickeredit"),this.bindTreeGridColumnProperties(e,i)},e.prototype.composeResourceColumn=function(e){e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("resourceName"),e.width=e.width?e.width:150,e.type="string",e.valueAccessor=e.valueAccessor?e.valueAccessor:this.resourceValueAccessor.bind(this),e.allowFiltering=!1!==e.allowFiltering},e.prototype.getResourceIds=function(e){return t.getValue(this.parent.taskFields.resourceInfo,e.taskData)},e.prototype.composeIDColumn=function(e){e.isPrimaryKey=!!t.isNullOrUndefined(e.isPrimaryKey)||e.isPrimaryKey,e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("id"),e.width=e.width?e.width:100,e.allowEditing=!1,e.editType=e.editType?e.editType:"numericedit"},e.prototype.composeProgressColumn=function(e){e.headerText=e.headerText?e.headerText:this.parent.localeObj.getConstant("progress"),e.width=e.width?e.width:150,e.editType=e.editType?e.editType:"numericedit"},e.prototype.bindTreeGridColumnProperties=function(e,t){for(var i={},r={},n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];i[o]=r[o]=e[o]}this.parent.columnByField[r.field]=r,this.parent.ganttColumns.push(new ke(r)),t&&this.treeGridColumns.push(i)},e.prototype.durationValueAccessor=function(e,i,r){var n=i.ganttProperties;return t.isNullOrUndefined(n)?"":this.parent.dataOperation.getDurationString(n.duration,n.durationUnit)},e.prototype.resourceValueAccessor=function(e,i,r){var n=i.ganttProperties;return t.isNullOrUndefined(n)?"":n.resourceNames},e.prototype.updateScrollTop=function(e){this.treeGridElement.querySelector(".e-content").scrollTop=t.getValue("top",e),this.previousScroll.top=this.treeGridElement.querySelector(".e-content").scrollTop},e.prototype.treeGridClickHandler=function(e){this.parent.notify("treeGridClick",e)},e.prototype.removeEventListener=function(){this.parent.off("renderPanels",this.createContainer),this.parent.off("chartScroll",this.updateScrollTop),this.parent.off("destroy",this.destroy)},e.prototype.destroy=function(){this.removeEventListener(),this.unWireEvents(),this.parent.treeGrid.element&&this.parent.treeGrid.destroy()},e}(),be=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),we=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Me=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return be(i,e),we([t.Property(null)],i.prototype,"from",void 0),we([t.Property(null)],i.prototype,"to",void 0),i}(t.ChildProperty),Ce=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Pe=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Re=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ce(i,e),Pe([t.Property(null)],i.prototype,"type",void 0),Pe([t.Property(null)],i.prototype,"headerText",void 0),Pe([t.Property([])],i.prototype,"fields",void 0),i}(t.ChildProperty),Ee=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Oe=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},xe=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ee(i,e),Oe([t.Property(null)],i.prototype,"type",void 0),Oe([t.Property(null)],i.prototype,"headerText",void 0),Oe([t.Property([])],i.prototype,"fields",void 0),i}(t.ChildProperty),Ie=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Le=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Ve=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ie(i,e),Le([t.Property(!1)],i.prototype,"allowEditing",void 0),Le([t.Property(!1)],i.prototype,"allowAdding",void 0),Le([t.Property(!1)],i.prototype,"allowDeleting",void 0),Le([t.Property("Auto")],i.prototype,"mode",void 0),Le([t.Property("Top")],i.prototype,"newRowPosition",void 0),Le([t.Property(!1)],i.prototype,"showDeleteConfirmDialog",void 0),Le([t.Property(!1)],i.prototype,"allowTaskbarEditing",void 0),i}(t.ChildProperty),Be=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Fe=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Ne=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Be(i,e),Fe([t.Property(null)],i.prototype,"day",void 0),Fe([t.Property(null)],i.prototype,"label",void 0),Fe([t.Property(null)],i.prototype,"cssClass",void 0),i}(t.ChildProperty),Ue=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ae=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},je=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ue(i,e),Ae([t.Collection([],r.Predicate)],i.prototype,"columns",void 0),Ae([t.Property("Menu")],i.prototype,"type",void 0),Ae([t.Property()],i.prototype,"operators",void 0),Ae([t.Property(!1)],i.prototype,"ignoreAccent",void 0),Ae([t.Property("Parent")],i.prototype,"hierarchyMode",void 0),i}(t.ChildProperty),He=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),We=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Ge=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return He(i,e),We([t.Property([])],i.prototype,"fields",void 0),We([t.Property(!1)],i.prototype,"ignoreCase",void 0),We([t.Property("contains")],i.prototype,"operator",void 0),We([t.Property("")],i.prototype,"key",void 0),We([t.Property("Parent")],i.prototype,"hierarchyMode",void 0),i}(t.ChildProperty),_e=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qe=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},ze=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return _e(i,e),qe([t.Property(null)],i.prototype,"from",void 0),qe([t.Property(null)],i.prototype,"to",void 0),qe([t.Property(null)],i.prototype,"label",void 0),qe([t.Property(null)],i.prototype,"cssClass",void 0),i}(t.ChildProperty),Ye=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Xe=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},Ze=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ye(i,e),Xe([t.Property(null)],i.prototype,"rightLabel",void 0),Xe([t.Property(null)],i.prototype,"leftLabel",void 0),Xe([t.Property(null)],i.prototype,"taskLabel",void 0),i}(t.ChildProperty),Ke=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Qe=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},$e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Ke(i,e),Qe([t.Property("Row")],i.prototype,"mode",void 0),Qe([t.Property("Flow")],i.prototype,"cellSelectionMode",void 0),Qe([t.Property("Single")],i.prototype,"type",void 0),Qe([t.Property(!1)],i.prototype,"persistSelection",void 0),i}(t.ChildProperty),Je=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),et=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},tt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Je(i,e),et([t.Property(null)],i.prototype,"position",void 0),et([t.Property(-1)],i.prototype,"columnIndex",void 0),et([t.Property(4)],i.prototype,"separatorSize",void 0),et([t.Property(null)],i.prototype,"minimum",void 0),et([t.Property("Default")],i.prototype,"view",void 0),i}(t.ChildProperty),it=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rt=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},nt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return it(i,e),rt([t.Property(null)],i.prototype,"id",void 0),rt([t.Property(null)],i.prototype,"name",void 0),rt([t.Property(null)],i.prototype,"parentID",void 0),rt([t.Property(null)],i.prototype,"startDate",void 0),rt([t.Property(null)],i.prototype,"endDate",void 0),rt([t.Property(null)],i.prototype,"dependency",void 0),rt([t.Property(null)],i.prototype,"progress",void 0),rt([t.Property(null)],i.prototype,"child",void 0),rt([t.Property(null)],i.prototype,"milestone",void 0),rt([t.Property(null)],i.prototype,"duration",void 0),rt([t.Property(null)],i.prototype,"durationUnit",void 0),rt([t.Property(null)],i.prototype,"cssClass",void 0),rt([t.Property(null)],i.prototype,"baselineStartDate",void 0),rt([t.Property(null)],i.prototype,"baselineEndDate",void 0),rt([t.Property(null)],i.prototype,"resourceInfo",void 0),rt([t.Property(null)],i.prototype,"expandState",void 0),rt([t.Property(null)],i.prototype,"indicators",void 0),rt([t.Property(null)],i.prototype,"notes",void 0),i}(t.ChildProperty),at=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ot=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},st=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return at(i,e),ot([t.Property("")],i.prototype,"format",void 0),ot([t.Property("None")],i.prototype,"unit",void 0),ot([t.Property(1)],i.prototype,"count",void 0),ot([t.Property(null)],i.prototype,"formatter",void 0),i}(t.ChildProperty),lt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return at(i,e),ot([t.Property("Week")],i.prototype,"timelineViewMode",void 0),ot([t.Complex({},st)],i.prototype,"topTier",void 0),ot([t.Complex({},st)],i.prototype,"bottomTier",void 0),ot([t.Property(33)],i.prototype,"timelineUnitSize",void 0),ot([t.Property(0)],i.prototype,"weekStartDay",void 0),ot([t.Property(null)],i.prototype,"weekendBackground",void 0),ot([t.Property(!0)],i.prototype,"showTooltip",void 0),ot([t.Property(!0)],i.prototype,"updateTimescaleView",void 0),i}(t.ChildProperty),dt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pt=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},ht=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return dt(i,e),pt([t.Property(!0)],i.prototype,"showTooltip",void 0),pt([t.Property()],i.prototype,"taskbar",void 0),pt([t.Property()],i.prototype,"baseline",void 0),pt([t.Property()],i.prototype,"connectorLine",void 0),pt([t.Property()],i.prototype,"editing",void 0),i}(t.ChildProperty),ct=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ut=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},gt=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ct(i,e),ut([t.Property()],i.prototype,"field",void 0),ut([t.Property()],i.prototype,"direction",void 0),i}(t.ChildProperty),ft=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return ct(i,e),ut([t.Collection([],gt)],i.prototype,"columns",void 0),ut([t.Property(!0)],i.prototype,"allowUnsort",void 0),i}(t.ChildProperty),mt=function(){function e(e){this.taskBarHeight=0,this.milestoneHeight=0,this.milesStoneRadius=0,this.baselineTop=0,this.baselineHeight=3,this.touchLeftConnectorpoint="",this.touchRightConnectorpoint="",this.parent=e,this.initPublicProp(),this.addEventListener()}return e.prototype.initPublicProp=function(){this.ganttChartTableBody=null},e.prototype.addEventListener=function(){this.parent.on("renderPanels",this.createChartTable,this),this.parent.on("dataReady",this.initiateTemplates,this),this.parent.on("destroy",this.destroy,this)},e.prototype.refreshChartByTimeline=function(){this.taskTable.style.width=t.formatUnit(this.parent.timelineModule.totalTimelineWidth),this.refreshGanttRows()},e.prototype.createChartTable=function(){this.taskTable=t.createElement("table",{className:"e-task-table e-zero-spacing",id:"GanttTaskTable"+this.parent.element.id,styles:"z-index: 2;position: absolute;width:"+this.parent.timelineModule.totalTimelineWidth+"px;",attrs:{cellspacing:"0.25px"}});var e=t.createElement("colgroup"),i=t.createElement("col",{styles:"width:"+this.parent.timelineModule.totalTimelineWidth+"px;"});e.appendChild(i),this.taskTable.appendChild(e),this.ganttChartTableBody=t.createElement("tbody",{id:this.parent.element.id+"GanttTaskTableBody"}),this.taskTable.appendChild(this.ganttChartTableBody),this.parent.ganttChartModule.chartBodyContent.appendChild(this.taskTable)},e.prototype.initiateTemplates=function(){this.taskTable.style.width=t.formatUnit(this.parent.timelineModule.totalTimelineWidth),this.initChartHelperPrivateVariable(),this.initializeChartTemplate()},e.prototype.renderChartRows=function(){this.createTaskbarTemplate(),this.triggerQueryTaskbarInfo(),this.parent.isGanttChartRendered=!0},e.prototype.getIndicatorNode=function(e){var t='<label class="e-label e-indicator-span"  style="line-height:'+this.parent.rowHeight+"px;left:"+this.getIndicatorleft(e.date)+'px;"><i class="'+e.iconClass+'"></i> </label>';return this.createDivElement(t)},e.prototype.getIndicatorleft=function(e){e=this.parent.dateValidationModule.getDateFromFormat(e);return this.parent.dataOperation.getTaskLeft(e,!1)},e.prototype.getChildTaskbarNode=function(e){var i=null,r=this.templateData;if(this.childTaskbarTemplateFunction)i=this.childTaskbarTemplateFunction(t.extend({index:e},r),this.parent,"TaskbarTemplate",this.getTemplateID("TaskbarTemplate"),!1);else{var n="";if(this.taskLabelTemplateFunction){var a=this.taskLabelTemplateFunction(t.extend({index:e},r),this.parent,"TaskLabelTemplate",this.getTemplateID("TaskLabelTemplate"),!1),o=t.createElement("div");o.appendChild(a[0]),n=o.innerHTML}else n="isCustomTemplate"===(n=this.getTaskLabel(this.parent.labelSettings.taskLabel))?this.parent.labelSettings.taskLabel:n;var s=r.ganttProperties.startDate&&r.ganttProperties.endDate&&r.ganttProperties.duration?'<div class="e-gantt-child-taskbar-inner-div '+j+'"style="width:'+r.ganttProperties.width+"px;height:"+this.taskBarHeight+'px;"><div class="'+R+" "+H+'" style="border-style:'+(r.ganttProperties.progressWidth?"solid;":"none;")+"width:"+r.ganttProperties.progressWidth+"px;height:100%;border-top-right-radius:"+this.getBorderRadius(r.ganttProperties)+"px;border-bottom-right-radius:"+this.getBorderRadius(r.ganttProperties)+'px;"><span class="'+P+'" style="line-height:'+(this.taskBarHeight-1)+"px;height:"+this.taskBarHeight+'px;">'+n+"</span></div></div>":!r.ganttProperties.startDate||r.ganttProperties.endDate||r.ganttProperties.duration?!r.ganttProperties.endDate||r.ganttProperties.startDate||r.ganttProperties.duration?!r.ganttProperties.duration||r.ganttProperties.startDate||r.ganttProperties.endDate?"":'<div class="'+R+" "+j+' e-gantt-unscheduled-taskbar"style="left:'+r.ganttProperties.left+"px; width:"+r.ganttProperties.width+"px; height:"+this.taskBarHeight+'px;"></div>':'<div class="'+R+" "+j+' e-gantt-unscheduled-taskbar-right"style="left:'+r.ganttProperties.left+"px; height:"+this.taskBarHeight+'px;"></div>':'<div class="'+R+" "+j+' e-gantt-unscheduled-taskbar-left"style="left:'+r.ganttProperties.left+"px; height:"+this.taskBarHeight+'px;"></div>';i=this.createDivElement(s)}return i},e.prototype.getMilestoneNode=function(e){var i=null,r=this.templateData;if(this.milestoneTemplateFunction)i=this.milestoneTemplateFunction(t.extend({index:e},r),this.parent,"MilestoneTemplate",this.getTemplateID("MilestoneTemplate"),!1);else{var n='<div class="e-gantt-milestone" style="position:absolute;"><div class="'+E+" "+(r.ganttProperties.startDate||r.ganttProperties.endDate?"":"e-unscheduled-milestone-top")+'" style="border-right-width:'+this.milesStoneRadius+"px;border-left-width:"+this.milesStoneRadius+"px;border-bottom-width:"+this.milesStoneRadius+'px;"></div><div class="'+O+" "+(r.ganttProperties.startDate||r.ganttProperties.endDate?"":"e-unscheduled-milestone-bottom")+'" style="top:'+this.milesStoneRadius+"px;border-right-width:"+this.milesStoneRadius+"px; border-left-width:"+this.milesStoneRadius+"px; border-top-width:"+this.milesStoneRadius+'px;"></div></div>';i=this.createDivElement(n)}return i},e.prototype.getTaskBaselineNode=function(){var e=this.templateData,t='<div class="'+x+' " style="margin-top:'+this.baselineTop+"px;left:"+e.ganttProperties.baselineLeft+"px;width:"+e.ganttProperties.baselineWidth+"px;height:"+this.baselineHeight+"px;"+(this.baselineColor?"background-color: "+this.baselineColor+";":"")+'"></div>';return this.createDivElement(t)},e.prototype.getMilestoneBaselineNode=function(){var e='<div class="e-baseline-gantt-milestone-container " style="left:'+(this.templateData.ganttProperties.baselineLeft-this.milesStoneRadius)+"px;margin-top:"+(2-Math.floor(this.parent.rowHeight-this.milestoneMarginTop))+'px"><div class="'+I+'"><div class="'+I+" "+L+'"  style="top:'+-this.milestoneHeight+"px;border-right:"+this.milesStoneRadius+"px solid transparent;border-left:"+this.milesStoneRadius+"px solid transparent;border-top:0pxsolid transparent;border-bottom-width:"+this.milesStoneRadius+"px;border-bottom-style: solid;"+(this.baselineColor?"border-bottom-color: "+this.baselineColor+";":"")+'"></div><div class="'+I+" "+V+'"  style="top:'+(this.milesStoneRadius-this.milestoneHeight)+"px;border-right:"+this.milesStoneRadius+"px solid transparent;border-left:"+this.milesStoneRadius+"px solid transparent;border-bottom:0pxsolid transparent;border-top-width:"+this.milesStoneRadius+"px;border-top-style: solid;"+(this.baselineColor?"border-top-color: "+this.baselineColor+";":"")+'"></div></div></div>';return this.createDivElement(e)},e.prototype.getLeftLabelNode=function(e){var i=this.leftLabelContainer(),r=null;if(this.leftTaskLabelTemplateFunction)r=this.leftTaskLabelTemplateFunction(t.extend({index:e},this.templateData),this.parent,"LeftLabelTemplate",this.getTemplateID("LeftLabelTemplate"),!1);else{var n=this.parent.labelSettings.leftLabel,a=this.getTaskLabel(n);if(a){a="isCustomTemplate"===a?n:a;var o='<div class="e-left-label-inner-div"  style="height:'+this.taskBarHeight+"px;margin-top:"+this.taskBarMarginTop+'px;"><span class="'+X+'">'+a+"</span></div>";r=this.createDivElement(o)}}return r&&r.length>0&&i[0].appendChild([].slice.call(r)[0]),i},e.prototype.getRightLabelNode=function(e){var i=this.rightLabelContainer(),r=null;if(this.rightTaskLabelTemplateFunction)r=this.rightTaskLabelTemplateFunction(t.extend({index:e},this.templateData),this.parent,"RightLabelTemplate",this.getTemplateID("RightLabelTemplate"),!1);else{var n=this.parent.labelSettings.rightLabel,a=this.getTaskLabel(n);if(a){a="isCustomTemplate"===a?n:a;var o='<div class="e-right-label-inner-div"  style="height:'+this.taskBarHeight+"px;margin-top:"+this.taskBarMarginTop+'px;"><span class="'+X+'">'+a+"</span></div>";r=this.createDivElement(o)}}return r&&r.length>0&&i[0].appendChild([].slice.call(r)[0]),i},e.prototype.getParentTaskbarNode=function(e){var i=null,r=this.templateData;if(this.parentTaskbarTemplateFunction)i=this.parentTaskbarTemplateFunction(t.extend({index:e},r),this.parent,"ParentTaskbarTemplate",this.getTemplateID("ParentTaskbarTemplate"),!1);else{var n="";if(this.taskLabelTemplateFunction){var a=this.taskLabelTemplateFunction(t.extend({index:e},r),this.parent,"TaskLabelTemplate",this.getTemplateID("TaskLabelTemplate"),!1),o=t.createElement("div");o.appendChild(a[0]),n=o.innerHTML}else n="isCustomTemplate"===(n=this.getTaskLabel(this.parent.labelSettings.taskLabel))?this.parent.labelSettings.taskLabel:n;var s='<div class="e-gantt-parent-taskbar-inner-div '+this.getExpandClass(r)+" "+W+'" style="width:'+r.ganttProperties.width+"px;height:"+this.taskBarHeight+'px;"><div class="e-gantt-parent-progressbar-inner-div '+this.getExpandClass(r)+" "+G+'" style="border-style:'+(r.ganttProperties.progressWidth?"solid;":"none;")+"width:"+r.ganttProperties.progressWidth+"px;border-top-right-radius:"+this.getBorderRadius(r)+"px;border-bottom-right-radius:"+this.getBorderRadius(r)+'px;height:100%;"><span class="'+P+'" style="line-height:'+(this.taskBarHeight-1)+"px;height:"+this.taskBarHeight+'px;">'+n+"</span></div></div>";i=this.createDivElement(s)}return i},e.prototype.getTableTrNode=function(){var e=t.createElement("table"),i="Horizontal"===this.parent.gridLines||"Both"===this.parent.gridLines?"e-chart-row-border":"";return e.innerHTML='<tr class="'+this.getRowClassName(this.templateData)+" "+F+'"style="display:'+this.getExpandDisplayProp(this.templateData)+";height:"+this.parent.rowHeight+'px;"><td class="'+B+" "+i+'" style="width:'+this.parent.timelineModule.totalTimelineWidth+'px;"></td></tr>',e.childNodes},e.prototype.initializeChartTemplate=function(){t.isNullOrUndefined(this.parent.parentTaskbarTemplate)||(this.parentTaskbarTemplateFunction=this.templateCompiler(this.parent.parentTaskbarTemplate)),!t.isNullOrUndefined(this.parent.labelSettings.leftLabel)&&this.isTemplate(this.parent.labelSettings.leftLabel)&&(this.leftTaskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.leftLabel)),!t.isNullOrUndefined(this.parent.labelSettings.rightLabel)&&this.isTemplate(this.parent.labelSettings.rightLabel)&&(this.rightTaskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.rightLabel)),!t.isNullOrUndefined(this.parent.labelSettings.taskLabel)&&this.isTemplate(this.parent.labelSettings.taskLabel)&&(this.taskLabelTemplateFunction=this.templateCompiler(this.parent.labelSettings.taskLabel)),t.isNullOrUndefined(this.parent.taskbarTemplate)||(this.childTaskbarTemplateFunction=this.templateCompiler(this.parent.taskbarTemplate)),t.isNullOrUndefined(this.parent.milestoneTemplate)||(this.milestoneTemplateFunction=this.templateCompiler(this.parent.milestoneTemplate))},e.prototype.createDivElement=function(e){var i=t.createElement("div");return i.innerHTML=e,i.childNodes},e.prototype.isTemplate=function(e){var t=!1;return"string"!=typeof e?t=!0:(0===e.indexOf("#")||e.indexOf("<")>-1||e.indexOf("$")>-1)&&(t=!0),t},e.prototype.getTemplateID=function(e){return this.parent.element.id+e},e.prototype.updateTaskbarBlazorTemplate=function(e,i){var r=!0,n=!0,a=!0;i&&(i.ganttProperties.isMilestone?n=a=!1:i.hasChildRecords?r=a=!1:i.hasChildRecords||(n=r=!1)),this.parentTaskbarTemplateFunction&&n&&(e?t.updateBlazorTemplate(this.getTemplateID("ParentTaskbarTemplate"),"ParentTaskbarTemplate",this.parent,!1):t.resetBlazorTemplate(this.getTemplateID("ParentTaskbarTemplate"),"ParentTaskbarTemplate")),this.childTaskbarTemplateFunction&&a&&(e?t.updateBlazorTemplate(this.getTemplateID("TaskbarTemplate"),"TaskbarTemplate",this.parent,!1):t.resetBlazorTemplate(this.getTemplateID("TaskbarTemplate"),"TaskbarTemplate")),this.milestoneTemplateFunction&&r&&(e?t.updateBlazorTemplate(this.getTemplateID("MilestoneTemplate"),"MilestoneTemplate",this.parent,!1):t.resetBlazorTemplate(this.getTemplateID("MilestoneTemplate"),"MilestoneTemplate")),this.leftTaskLabelTemplateFunction&&(e?t.updateBlazorTemplate(this.getTemplateID("LeftLabelTemplate"),"LeftLabelTemplate",this.parent.labelSettings,!1):t.resetBlazorTemplate(this.getTemplateID("LeftLabelTemplate"),"LeftLabelTemplate")),this.rightTaskLabelTemplateFunction&&(e?t.updateBlazorTemplate(this.getTemplateID("RightLabelTemplate"),"RightLabelTemplate",this.parent.labelSettings,!1):t.resetBlazorTemplate(this.getTemplateID("RightLabelTemplate"),"RightLabelTemplate")),this.taskLabelTemplateFunction&&(n||a)&&(e?t.updateBlazorTemplate(this.getTemplateID("TaskLabelTemplate"),"TaskLabelTemplate",this.parent.labelSettings,!1):t.resetBlazorTemplate(this.getTemplateID("TaskLabelTemplate"),"TaskLabelTemplate"))},e.prototype.leftLabelContainer=function(){var e='<div class="'+(this.leftTaskLabelTemplateFunction?"e-left-label-container e-left-label-temp-container":w)+' " tabindex="-1" '+this.generateTaskLabelAriaLabel("left")+'  style="height:'+(this.parent.rowHeight-1)+"px;width:"+this.taskNameWidth(this.templateData)+'"></div>';return this.createDivElement(e)},e.prototype.taskbarContainer=function(){var e=this.templateData,t='<div class="'+C+" "+this.parent.getUnscheduledTaskClass(e.ganttProperties)+'" '+(e.ganttProperties.cssClass?e.ganttProperties.cssClass:"")+' tabindex="-1" aria-label = "'+this.generateAriaLabel(e)+'"   style="'+(e.ganttProperties.isMilestone?"width:"+this.milestoneHeight+"px;height:"+this.milestoneHeight+"px;margin-top:"+this.milestoneMarginTop+"px;left:"+(e.ganttProperties.left-this.milestoneHeight/2)+"px;":"width:"+e.ganttProperties.width+"px;margin-top:"+this.taskBarMarginTop+"px;left:"+e.ganttProperties.left+"px;height:"+this.taskBarHeight+"px;")+'"></div>';return this.createDivElement(t)},e.prototype.rightLabelContainer=function(){var e='<div class="'+(this.rightTaskLabelTemplateFunction?"e-right-label-container e-right-label-temp-container":M)+'"  tabindex="-1" '+this.generateTaskLabelAriaLabel("right")+' style="left:'+this.getRightLabelLeft(this.templateData)+"px;height:"+(this.parent.rowHeight-1)+'px;"></div>';return this.createDivElement(e)},e.prototype.childTaskbarLeftResizer=function(){var e=-(this.parent.isAdaptive?12:2),t='<div class="'+N+' e-icon" style="left:'+e+"px;height:"+this.taskBarHeight+'px;"></div>';return this.createDivElement(t)},e.prototype.childTaskbarRightResizer=function(){var e=this.parent.isAdaptive?-2:-10,t='<div class="'+U+' e-icon" style="left:'+(this.templateData.ganttProperties.width+e)+"px;height:"+this.taskBarHeight+'px;"></div>';return this.createDivElement(t)},e.prototype.childTaskbarProgressResizer=function(){var e='<div class="'+A+'" style="left:'+(this.templateData.ganttProperties.progressWidth-6)+"px;margin-top:"+this.taskBarHeight+'px;"><div class="e-progressbar-handler"><div class="e-progressbar-handler-element"></div><div class="e-progressbar-handler-after"></div></div>';return this.createDivElement(e)},e.prototype.getLeftPointNode=function(){var e=this.templateData,t=-((this.parent.isAdaptive?14:2)+this.connectorPointWidth),i=-(this.connectorPointWidth+2),r=Math.floor(this.milesStoneRadius-this.connectorPointWidth/2),n='<div class="e-left-connectorpoint-outer-div" style="'+(e.ganttProperties.isMilestone?"margin-top:"+r+"px;left:"+i+"px;":"margin-top:"+this.connectorPointMargin+"px;left:"+t+"px;")+'"><div class="'+ae+" "+this.parent.getUnscheduledTaskClass(e.ganttProperties)+'" style="width: '+this.connectorPointWidth+"px;height: "+this.connectorPointWidth+'px;">'+this.touchLeftConnectorpoint+"</div></div>";return this.createDivElement(n)},e.prototype.getRightPointNode=function(){var e=this.templateData,t=this.parent.isAdaptive?10:-2,i=Math.floor(this.milesStoneRadius-this.connectorPointWidth/2),r='<div class="'+de+'" style="'+(e.ganttProperties.isMilestone?"left:"+(this.milestoneHeight-2)+"px;margin-top:"+i+"px;":"left:"+(e.ganttProperties.width+t)+"px;margin-top:"+this.connectorPointMargin+"px;")+'"><div class="'+oe+" "+this.parent.getUnscheduledTaskClass(e.ganttProperties)+'" style="width:'+this.connectorPointWidth+"px;height:"+this.connectorPointWidth+'px;">'+this.touchRightConnectorpoint+"</div></div>";return this.createDivElement(r)},e.prototype.getTaskLabel=function(e){var i=this.parent.ganttColumns.length,r=null;if(t.isNullOrUndefined(e)||""===e)r="";else if(e===this.parent.taskFields.resourceInfo)r=this.getResourceName(this.templateData);else{for(var n=0;n<i;n++)if(e===this.parent.ganttColumns[n].field){r=this.getFieldValue(this.templateData[e]).toString();break}if(t.isNullOrUndefined(r))return"isCustomTemplate"}return r},e.prototype.getExpandDisplayProp=function(e){return e=this.templateData,this.parent.getExpandStatus(e)?"table-row":"none"},e.prototype.getRowClassName=function(e){var t="gridrowtaskId",i=(e=this.templateData).parentItem;return i&&(t+=i.taskId.toString()),t+="level",t+=e.level.toString()},e.prototype.getBorderRadius=function(e){var t=(e=this.templateData).ganttProperties.width-e.ganttProperties.progressWidth;return t<=4?4-t:0},e.prototype.taskNameWidth=function(e){var t;return(t=(e=this.templateData).ganttProperties.isMilestone?e.ganttProperties.left-this.parent.getTaskbarHeight()/2:e.ganttProperties.left)<0&&(t=0),t+"px"},e.prototype.getRightLabelLeft=function(e){return(e=this.templateData).ganttProperties.isMilestone?e.ganttProperties.left+this.parent.getTaskbarHeight()/2:e.ganttProperties.left+e.ganttProperties.width},e.prototype.getExpandClass=function(e){return(e=this.templateData).expanded?"e-row-expand":!e.expanded&&e.hasChildRecords?"e-row-collapse":""},e.prototype.getFieldValue=function(e){return t.isNullOrUndefined(e)?"":e},e.prototype.getResourceName=function(e){e=this.templateData;var i=null;if(!t.isNullOrUndefined(e.ganttProperties.resourceInfo)){var r=e.ganttProperties.resourceInfo.length;if(r>0){for(var n=0;n<r;n++)t.isNullOrUndefined(i)?i=e.ganttProperties.resourceInfo[n][this.parent.resourceNameMapping]:i+=" , "+e.ganttProperties.resourceInfo[n][this.parent.resourceNameMapping];return i}return""}return""},e.prototype.initChartHelperPrivateVariable=function(){if(this.baselineColor=t.isNullOrUndefined(this.parent.baselineColor)||""===this.parent.baselineColor?null:this.parent.baselineColor,this.taskBarHeight=t.isNullOrUndefined(this.parent.taskbarHeight)||this.parent.taskbarHeight>=this.parent.rowHeight?Math.floor(.62*this.parent.rowHeight):this.parent.taskbarHeight,this.parent.renderBaseline){var e=void 0;e=this.taskBarHeight+this.baselineHeight<=this.parent.rowHeight?this.taskBarHeight:this.taskBarHeight-(this.baselineHeight+1),this.taskBarHeight=e}this.milestoneHeight=Math.floor(.82*this.taskBarHeight),this.taskBarMarginTop=Math.floor((this.parent.rowHeight-this.taskBarHeight)/2),this.milestoneMarginTop=Math.floor((this.parent.rowHeight-this.milestoneHeight)/2),this.milesStoneRadius=Math.floor(this.milestoneHeight/2),this.baselineTop=-(Math.floor(this.parent.rowHeight-(this.taskBarHeight+this.taskBarMarginTop))-1),this.connectorPointWidth=this.parent.isAdaptive?Math.round(this.taskBarHeight/2):8,this.connectorPointMargin=Math.floor(this.taskBarHeight/2-this.connectorPointWidth/2)},e.prototype.refreshGanttRows=function(){this.parent.currentViewData=this.parent.treeGrid.getCurrentViewRecords().slice(),this.createTaskbarTemplate(),this.triggerQueryTaskbarInfo()},e.prototype.createTaskbarTemplate=function(){this.updateTaskbarBlazorTemplate(!1),this.ganttChartTableBody.innerHTML="";for(var e=0;e<this.parent.currentViewData.length;e++){var t=this.parent.currentViewData[e];this.ganttChartTableBody.appendChild(this.getGanttChartRow(e,t))}this.updateTaskbarBlazorTemplate(!0)},e.prototype.getGanttChartRow=function(e,i){this.templateData=i;var r=null,n=this.getTableTrNode(),a=this.getLeftLabelNode(e),o=this.taskbarContainer();if(!this.templateData.hasChildRecords){var s=this.getLeftPointNode();o[0].appendChild([].slice.call(s)[0])}if(this.templateData.hasChildRecords){var l=this.getParentTaskbarNode(e);l&&l.length>0&&o[0].appendChild([].slice.call(l)[0]),this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(r=this.getTaskBaselineNode())}else if(this.templateData.ganttProperties.isMilestone){var d=this.getMilestoneNode(e);d&&d.length>0&&o[0].appendChild([].slice.call(d)[0]),this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(r=this.getMilestoneBaselineNode())}else{var p=g(this.templateData.ganttProperties),h=null,c=null,u=null;if(!t.isNullOrUndefined(p)){(p||this.templateData.ganttProperties.duration)&&p&&(h=this.childTaskbarProgressResizer(),u=this.childTaskbarLeftResizer(),c=this.childTaskbarRightResizer());var f=this.getChildTaskbarNode(e);u&&o[0].appendChild([].slice.call(u)[0]),f&&f.length>0&&o[0].appendChild([].slice.call(f)[0]),h&&o[0].appendChild([].slice.call(h)[0]),c&&o[0].appendChild([].slice.call(c)[0])}this.parent.renderBaseline&&this.templateData.ganttProperties.baselineStartDate&&this.templateData.ganttProperties.baselineEndDate&&(r=this.getTaskBaselineNode())}if(!this.templateData.hasChildRecords){var m=this.getRightPointNode();o[0].appendChild([].slice.call(m)[0])}var y=this.getRightLabelNode(e);if(n[0].childNodes[0].childNodes[0].appendChild([].slice.call(a)[0]),n[0].childNodes[0].childNodes[0].appendChild([].slice.call(o)[0]),this.templateData.ganttProperties.indicators&&this.templateData.ganttProperties.indicators.length>0)for(var v=void 0,D=void 0,T=this.templateData.ganttProperties.indicators,k=0;k<T.length;k++){if(v=this.getIndicatorNode(T[k]),T[k].name.indexOf("$")>-1||T[k].name.indexOf("#")>-1)D=this.templateCompiler(T[k].name)(t.extend({index:e},this.templateData),this.parent,"indicatorLabelText");else{var S=t.createElement("Text");S.innerHTML=T[k].name,D=S.childNodes}v[0].appendChild([].slice.call(D)[0]),v[0].title=t.isNullOrUndefined(T[k].tooltip)?"":T[k].tooltip,n[0].childNodes[0].childNodes[0].appendChild([].slice.call(v)[0])}return y&&y.length>0&&n[0].childNodes[0].childNodes[0].appendChild([].slice.call(y)[0]),t.isNullOrUndefined(r)||n[0].childNodes[0].childNodes[0].appendChild([].slice.call(r)[0]),n[0].childNodes[0]},e.prototype.triggerQueryTaskbarInfo=function(){for(var e,t,i=this.ganttChartTableBody.querySelectorAll("tr").length,r=0;r<i;r++)(e=this.ganttChartTableBody.querySelectorAll("tr")[r]).querySelector("."+C),t=this.parent.currentViewData[r],this.triggerQueryTaskbarInfoByIndex(e,t)},e.prototype.triggerQueryTaskbarInfoByIndex=function(e,i){var r,n=this;r=e.querySelector("."+C);var a,o,s={data:i,rowElement:e,taskbarElement:e.querySelector("."+C),taskbarType:i.hasChildRecords?"ParentTask":i.ganttProperties.isMilestone?"Milestone":"ChildTask"},l=this.getClassName(s);"Milestone"===s.taskbarType?(s.milestoneColor=r.querySelector(l[0])?getComputedStyle(r.querySelector(l[0])).borderBottomColor:null,s.baselineColor=e.querySelector(l[1])?getComputedStyle(e.querySelector(l[1])).borderBottomColor:null):(s.taskbarBgColor=r.querySelector(l[0])?getComputedStyle(r.querySelector(l[0])).backgroundColor:null,s.taskbarBorderColor=r.querySelector(l[0])?getComputedStyle(r.querySelector(l[0])).borderColor:null,s.progressBarBgColor=r.querySelector(l[1])?getComputedStyle(r.querySelector(l[1])).backgroundColor:null,s.baselineColor=e.querySelector("."+x)?getComputedStyle(e.querySelector("."+x)).backgroundColor:null,s.taskLabelColor=r.querySelector("."+P)?getComputedStyle(r.querySelector("."+P)).color:null),s.rightLabelColor=e.querySelector("."+M)&&e.querySelector("."+M).querySelector("."+X)?getComputedStyle(e.querySelector("."+M).querySelector("."+X)).color:null,s.leftLabelColor=e.querySelector("."+w)&&e.querySelector("."+w).querySelector("."+X)?getComputedStyle(e.querySelector("."+w).querySelector("."+X)).color:null,t.isBlazor()&&(a=s.rowElement,o=s.taskbarElement),this.parent.trigger("queryTaskbarInfo",s,function(e){n.updateQueryTaskbarInfoArgs(e,a,o)})},e.prototype.updateQueryTaskbarInfoArgs=function(e,i,r){var n=t.isBlazor()&&i?i:e.rowElement,a=t.isBlazor()&&r?r:e.taskbarElement,o=this.getClassName(e);"Milestone"===e.taskbarType?(a.querySelector(o[0])&&getComputedStyle(a.querySelector(o[0])).borderBottomColor!==e.milestoneColor&&(a.querySelector(o[0]).style.borderBottomColor=e.milestoneColor,a.querySelector("."+O).style.borderTopColor=e.milestoneColor),n.querySelector(o[1])&&getComputedStyle(n.querySelector(o[1])).borderTopColor!==e.baselineColor&&(n.querySelector(o[1]).style.borderBottomColor=e.baselineColor,n.querySelector("."+V).style.borderTopColor=e.baselineColor)):(a.querySelector(o[0])&&getComputedStyle(a.querySelector(o[0])).backgroundColor!==e.taskbarBgColor&&(a.querySelector(o[0]).style.backgroundColor=e.taskbarBgColor),a.querySelector(o[0])&&getComputedStyle(a.querySelector(o[0])).borderColor!==e.taskbarBorderColor&&(a.querySelector(o[0]).style.borderColor=e.taskbarBorderColor),a.querySelector(o[1])&&getComputedStyle(a.querySelector(o[1])).backgroundColor!==e.progressBarBgColor&&(a.querySelector(o[1]).style.backgroundColor=e.progressBarBgColor),a.querySelector("."+P)&&getComputedStyle(a.querySelector("."+P)).color!==e.taskLabelColor&&(a.querySelector("."+P).style.color=e.taskLabelColor),n.querySelector("."+x)&&getComputedStyle(n.querySelector("."+x)).backgroundColor!==e.baselineColor&&(n.querySelector("."+x).style.backgroundColor=e.baselineColor)),n.querySelector("."+w)&&n.querySelector("."+w).querySelector("."+X)&&getComputedStyle(n.querySelector("."+w).querySelector("."+X)).color!==e.leftLabelColor&&(n.querySelector("."+w).querySelector("."+X).style.color=e.leftLabelColor),n.querySelector("."+M)&&n.querySelector("."+M).querySelector("."+X)&&getComputedStyle(n.querySelector("."+M).querySelector("."+X)).color!==e.rightLabelColor&&(n.querySelector("."+M).querySelector("."+X).style.color=e.rightLabelColor)},e.prototype.getClassName=function(e){var t=[];return t.push("."+("ParentTask"===e.taskbarType?W:"ChildTask"===e.taskbarType?j:E)),t.push("."+("ParentTask"===e.taskbarType?G:"ChildTask"===e.taskbarType?H:L)),t},e.prototype.templateCompiler=function(e){if(!t.isNullOrUndefined(e)&&""!==e)try{return document.querySelectorAll(e).length?t.compile(document.querySelector(e).innerHTML.trim(),this.parent):t.compile(e,this.parent)}catch(i){return t.compile(e,this.parent)}return null},e.prototype.refreshRow=function(e){var t=this.ganttChartTableBody.childNodes[e],i=this.parent.currentViewData[e];if(-1!==e&&i){var r=i;t.replaceChild(this.getGanttChartRow(e,r).childNodes[0],t.childNodes[0]),this.triggerQueryTaskbarInfoByIndex(t,r),this.parent.treeGrid.grid.setRowData(r.ganttProperties.taskId,r);this.parent.treeGrid.grid.getRowObjectFromUID(this.parent.treeGrid.grid.getDataRows()[e].getAttribute("data-uid")).data=r}},e.prototype.refreshRecords=function(e){if(this.parent.isGanttChartRendered){this.updateTaskbarBlazorTemplate(!1);for(var t=0;t<e.length;t++){var i=this.parent.currentViewData.indexOf(e[t]);this.refreshRow(i)}this.updateTaskbarBlazorTemplate(!0)}},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("renderPanels",this.createChartTable),this.parent.off("dataReady",this.initiateTemplates),this.parent.off("destroy",this.destroy))},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.generateAriaLabel=function(e){e=this.templateData;var t="",i=this.parent.localeObj.getConstant("name"),r=this.parent.localeObj.getConstant("startDate"),n=this.parent.localeObj.getConstant("endDate"),a=this.parent.localeObj.getConstant("duration"),o=e.ganttProperties.taskName,s=e.ganttProperties.startDate,l=e.ganttProperties.endDate,d=e.ganttProperties.duration;return e.ganttProperties.isMilestone?t=i+" "+o+" "+r+" "+this.parent.getFormatedDate(s):(o&&(t+=i+" "+o+" "),s&&(t+=r+" "+this.parent.getFormatedDate(s)+" "),l&&(t+=n+" "+this.parent.getFormatedDate(l)+" "),d&&(t+=a+" "+this.parent.getDurationString(d,e.ganttProperties.durationUnit))),t},e.prototype.generateTaskLabelAriaLabel=function(e){var t="";return"left"===e&&this.parent.labelSettings.leftLabel&&!this.leftTaskLabelTemplateFunction?t+='aria-label= "'+this.parent.localeObj.getConstant("leftTaskLabel")+" "+this.getTaskLabel(this.parent.labelSettings.leftLabel)+'"':"right"===e&&this.parent.labelSettings.rightLabel&&!this.rightTaskLabelTemplateFunction&&(t+='aria-label="'+this.parent.localeObj.getConstant("rightTaskLabel")+" "+this.getTaskLabel(this.parent.labelSettings.rightLabel)+'"'),t},e}(),yt=function(){function e(e){this.parent=e,this.dateValidateModule=this.parent.dateValidationModule}return e.prototype.ensurePredecessorCollection=function(){for(var e=this.parent.predecessorsCollection,t=e.length-1;t>=0;t--){var i=e[t],r=i.ganttProperties;this.ensurePredecessorCollectionHelper(i,r)}},e.prototype.ensurePredecessorCollectionHelper=function(e,i){var r=i.predecessorsName;if(!r||"string"!=typeof r&&"number"!=typeof r){if(r&&"object"==typeof r&&r.length){for(var n=[],a=0;a<r.length;a++){var o=r[a],s={};s.from=t.getValue("from",o),s.to=t.getValue("to",o)?t.getValue("to",o):i.taskId,s.type=t.getValue("type",o)?t.getValue("type",o):"FS";var l=t.getValue("offset",o);if(t.isNullOrUndefined(l))s.offset=0,s.offsetUnit=this.parent.durationUnit.toLocaleLowerCase();else if("string"==typeof l){var d=this.getOffsetDurationUnit(t.getValue("offset",o));s.offset=d.duration,s.offsetUnit=d.durationUnit}else s.offset=parseFloat(l.toString()),s.offsetUnit=this.parent.durationUnit.toLocaleLowerCase();this.checkIsParent(s.from.toString())||n.push(s)}this.parent.setRecordValue("predecessor",n,i,!0)}}else this.parent.setRecordValue("predecessor",this.calculatePredecessor(r,e),i,!0);this.parent.setRecordValue("predecessorsName",this.getPredecessorStringValue(e),i,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,i.predecessorsName,e),this.parent.setRecordValue(this.parent.taskFields.dependency,i.predecessorsName,e)},e.prototype.checkIsParent=function(e){var t=!1;return this.parent.getRecordByID(e).hasChildRecords&&(t=!0),t},e.prototype.calculatePredecessor=function(e,t){var i,r,n,a,o=this,s=[];return e.toString().split(",").forEach(function(e){if(r=e.split("+"),n="+",e.indexOf("-")>=0&&(r=e.split("-"),n="-"),(i=r[0].match(/(\d+|[A-z]+)/g))[0]&&-1!==o.parent.ids.indexOf(i[0])){if(i.length>1){var l=i[1].toUpperCase();a="FS"===l||"FF"===l||"SF"===l||"SS"===l?l:"FS"}else a="FS";var d=r.length>1?n+""+r[1]:"0",p=o.getOffsetDurationUnit(d),h={from:i[0],type:a,isDrawn:!1,to:t.ganttProperties.taskId.toString(),offsetUnit:p.durationUnit,offset:p.duration};o.checkIsParent(i[0])||s.push(h)}}),s},e.prototype.getPredecessorStringValue=function(e){var i=e.ganttProperties.predecessor,r=this.parent.durationUnitTexts,n="";if(i)for(var a=i.length,o=0;o<a;o++){var s=i[o],l="";if(s.from!==e.ganttProperties.taskId.toString()){if(l=s.from+s.type,0!==s.offset){l+=s.offset>0?"+"+s.offset+" ":s.offset+" ";var d=1!==s.offset;"day"===s.offsetUnit?l+=d?t.getValue("days",r):t.getValue("day",r):"hour"===s.offsetUnit?l+=d?t.getValue("hours",r):t.getValue("hour",r):l+=d?t.getValue("minutes",r):t.getValue("minute",r)}n=n.length>0?n+","+l:l}}return n},e.prototype.getOffsetDurationUnit=function(e){var i=0,r=this.parent.durationUnit.toLocaleLowerCase(),n=this.parent.durationUnitEditText;if("string"==typeof e){for(var a=e.match(/[^0-9]+|[0-9]+/g),o=0;o<a.length;o++)a[o]=a[o].trim();"-"===a[0]&&a[1]?(a[1]=a[0]+a[1],a.shift()):"+"===a[0]&&a.shift(),"."!==a[1]||isNaN(parseInt(a[2],10))||(a[0]+=a[1]+a[2],a.splice(1,2)),a&&a.length<=2&&(i=parseFloat(a[0]),r=a[1]?a[1].toLowerCase().trim():"",r=-1!==t.getValue("minute",n).indexOf(r)?"minute":-1!==t.getValue("hour",n).indexOf(r)?"hour":-1!==t.getValue("day",n).indexOf(r)?"day":this.parent.durationUnit.toLocaleLowerCase())}else i=e,r=this.parent.durationUnit.toLocaleLowerCase();return isNaN(i)&&(i=0,r=this.parent.durationUnit.toLocaleLowerCase()),{duration:i,durationUnit:r}},e.prototype.updatePredecessors=function(){for(var e,t=this.parent.predecessorsCollection,i=t.length,r=0;r<i;r++)e=t[r],this.updatePredecessorHelper(e,t)},e.prototype.updatePredecessorHelper=function(e,i){var r,n,a;i=t.isNullOrUndefined(i)?[]:i,a=(r=e.ganttProperties.predecessor).length;for(var o=0;o<a;o++){var s=r[o];if(n=this.parent.getRecordByID(s.from),s.from!==e.ganttProperties.taskId.toString()&&n){var l=void 0;n.ganttProperties.predecessor?((l=t.extend([],n.ganttProperties.predecessor,[],!0)).push(s),this.parent.setRecordValue("predecessor",l,n.ganttProperties,!0)):((l=[]).push(s),this.parent.setRecordValue("predecessor",l,n.ganttProperties,!0),i.push(n))}}},e.prototype.updatedRecordsDateByPredecessor=function(){for(var e=this.parent.flatData,t=0;t<e.length;t++)e[t].ganttProperties.predecessor&&e[t].taskData[this.parent.taskFields.dependency]&&this.validatePredecessorDates(e[t])},e.prototype.validatePredecessorDates=function(e){if(e.ganttProperties.predecessor){var t=e.ganttProperties.predecessor,i=void 0,r=void 0,n=null,a=e.ganttProperties.taskId.toString(),o=t.filter(function(e){return e.to===a?e:null});for(i=0;i<o.length;i++){var s=void 0;s=o[i],r=this.parent.getRecordByID(s.from),(n=this.parent.getRecordByID(s.to)).ganttProperties.isAutoSchedule&&this.validateChildGanttRecord(r,n)}}},e.prototype.validateChildGanttRecord=function(e,i){if(this.parent.editedTaskBarItem!==i&&!t.isNullOrUndefined(g(e.ganttProperties))&&!t.isNullOrUndefined(g(i.ganttProperties))&&this.parent.isInPredecessorValidation&&i.ganttProperties.isAutoSchedule){var r=i.ganttProperties,n=r.taskId.toString(),a=r.predecessor.filter(function(e){return e.to===n?e:null}),o=this.getPredecessorDate(i,a);this.parent.setRecordValue("startDate",o,r,!0),this.parent.dataOperation.updateMappingData(i,"startDate"),this.dateValidateModule.calculateEndDate(i),this.parent.setRecordValue("left",this.parent.dataOperation.calculateLeft(r),r,!0),this.parent.setRecordValue("width",this.parent.dataOperation.calculateWidth(r),r,!0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(r.width,r.progress),r,!0),i.parentItem&&this.parent.getParentTask(i.parentItem).ganttProperties.isAutoSchedule&&this.parent.isInPredecessorValidation&&this.parent.dataOperation.updateParentItems(i.parentItem)}},e.prototype.getPredecessorDate=function(e,t){var i,r,n,a,o=t.filter(function(t){return t.to===e.ganttProperties.taskId.toString()?t:null});if(o)for(var s=o.length,l=0;l<s;l++){var d=o[l];n=this.parent.getRecordByID(d.from),a=this.parent.getRecordByID(d.to),r=this.getValidatedStartDate(a.ganttProperties,n.ganttProperties,d),null==i?i=r:1===this.dateValidateModule.compareDates(r,i)&&(i=r)}return i},e.prototype.getValidatedStartDate=function(e,t,i){var r,n,a=i.type,o=i.offset;switch(a){case"FS":r=this.dateValidateModule.getValidEndDate(t),e.isMilestone&&0===o||(r=this.dateValidateModule.checkStartDate(r,e)),0!==o&&(r=this.updateDateByOffset(r,i,e)),n=e.isMilestone?r:this.dateValidateModule.checkStartDate(r,e);break;case"FF":case"SF":r="FF"===a?this.dateValidateModule.getValidEndDate(t):this.dateValidateModule.getValidStartDate(t),0!==o&&(r=this.updateDateByOffset(r,i,e)),e.isMilestone||(r=this.dateValidateModule.checkEndDate(r,e)),n=this.dateValidateModule.getStartDate(r,e.duration,e.durationUnit,e);break;case"SS":r=this.dateValidateModule.getValidStartDate(t),0!==o&&(r=this.updateDateByOffset(r,i,e)),n=e.isMilestone?r:this.dateValidateModule.checkStartDate(r,e)}return n},e.prototype.updateDateByOffset=function(e,t,i){var r,n=t.offset,a=t.offsetUnit;return n<0?r=this.dateValidateModule.getStartDate(this.dateValidateModule.checkEndDate(e,i),-1*n,a,i):(r=this.dateValidateModule.getEndDate(e,n,a,i,!1),i.isMilestone||(r=this.dateValidateModule.checkStartDate(r,i))),r},e.prototype.createConnectorLinesCollection=function(e){var t,i,r=e.length;for(t=0;t<r;t++)(i=e[t].ganttProperties.predecessor)&&this.addPredecessorsCollection(i)},e.prototype.addPredecessorsCollection=function(e){var t,i,r,n,a;if(e)for(t=e.length,i=0;i<t;i++){r=e[i];n=this.parent.getRecordByID(r.from),a=this.parent.getRecordByID(r.to),this.parent.currentViewData&&-1!==this.parent.currentViewData.indexOf(n)&&-1!==this.parent.currentViewData.indexOf(a)&&this.updateConnectorLineObject(n,a,r)}},e.prototype.updateConnectorLineObject=function(e,t,i){var r;if(r=this.parent.connectorLineModule.createConnectorLineObject(e,t,i)){if(this.parent.connectorLineIds.length>0&&-1===this.parent.connectorLineIds.indexOf(r.connectorLineId))this.parent.updatedConnectorLineCollection.push(r),this.parent.connectorLineIds.push(r.connectorLineId);else if(0===this.parent.connectorLineIds.length)this.parent.updatedConnectorLineCollection.push(r),this.parent.connectorLineIds.push(r.connectorLineId);else if(-1!==this.parent.connectorLineIds.indexOf(r.connectorLineId)){var n=this.parent.connectorLineIds.indexOf(r.connectorLineId);this.parent.updatedConnectorLineCollection[n]=r}i.isDrawn=!0}return r},e.prototype.validatePredecessor=function(e,t,i){if(this.parent.isInPredecessorValidation&&e.ganttProperties.predecessor){for(var r=e.ganttProperties.predecessor,n=void 0,a=null,o=void 0,s=e.ganttProperties.taskId.toString(),l=r.filter(function(e){return e.to===s?e:null}),d=r.filter(function(e){return e.from===s?e:null}),p=0;p<l.length;p++)o=l[p],n=this.parent.getRecordByID(o.from),a=this.parent.getRecordByID(o.to),this.parent.isInPredecessorValidation&&a.ganttProperties.isAutoSchedule?this.parent.isValidationEnabled=!0:this.parent.isValidationEnabled=!1,e.ganttProperties.taskId.toString()!==o.to&&e.ganttProperties.taskId.toString()!==o.from||i&&"predecessor"!==i||this.validateChildGanttRecord(n,a);for(p=0;p<d.length;p++)o=d[p],n=this.parent.getRecordByID(o.from),a=this.parent.getRecordByID(o.to),this.parent.isInPredecessorValidation&&a.ganttProperties.isAutoSchedule?this.parent.isValidationEnabled=!0:this.parent.isValidationEnabled=!1,"predecessor"!==i&&this.parent.isValidationEnabled&&this.validateChildGanttRecord(n,a),!1!==n.expanded&&a.expanded,a&&this.validatePredecessor(a,void 0,"successor")}},e.prototype.getValidPredecessor=function(e){var t=[],i=e.ganttProperties.predecessor;return i&&i.length>0&&(t=i.filter(function(t){return t.from!==e.ganttProperties.taskId.toString()})),t},e}(),vt=function(){function e(e){this.parent=e,this.dependencyViewContainer=t.createElement("div",{className:Z}),this.initPublicProp()}return e.prototype.getconnectorLineGap=function(e){return e.milestoneChild?this.parent.chartRowsModule.milestoneMarginTop/2+this.parent.chartRowsModule.milestoneHeight/2:this.parent.chartRowsModule.taskBarMarginTop/2+this.parent.chartRowsModule.taskBarHeight/2},e.prototype.initPublicProp=function(){this.lineColor=this.parent.connectorLineBackground,this.lineStroke=this.parent.connectorLineWidth>4?4:this.parent.connectorLineWidth,this.createConnectorLineTooltipTable()},e.prototype.getTaskbarMidpoint=function(e){return Math.floor(e?this.parent.chartRowsModule.milestoneMarginTop+this.parent.chartRowsModule.milestoneHeight/2:this.parent.chartRowsModule.taskBarMarginTop+this.parent.chartRowsModule.taskBarHeight/2)+1},e.prototype.createConnectorLineObject=function(e,i,r){var n={},a=this.parent.getExpandedRecords(this.parent.currentViewData),o=a.indexOf(e),s=a.indexOf(i),l=e.ganttProperties,d=i.ganttProperties;return-1===o||-1===s?null:(n.parentLeft=l.isMilestone?l.left-this.parent.chartRowsModule.milestoneHeight/2:l.left,n.childLeft=d.isMilestone?d.left-this.parent.chartRowsModule.milestoneHeight/2:d.left,n.parentWidth=0===l.width||l.isMilestone?Math.floor(this.parent.chartRowsModule.milestoneHeight):l.width,n.childWidth=0===d.width||d.isMilestone?Math.floor(this.parent.chartRowsModule.milestoneHeight):d.width,n.parentIndex=o,n.childIndex=s,n.rowHeight=this.parent.rowHeight,n.type=r.type,n.connectorLineId="parent"+l.taskId+"child"+d.taskId,n.milestoneParent=!!l.isMilestone,n.milestoneChild=!!d.isMilestone,t.isNullOrUndefined(g(l))||t.isNullOrUndefined(g(d))?null:n)},e.prototype.renderConnectorLines=function(e){for(var t="",i=0;i<e.length;i++)t+=this.getConnectorLineTemplate(e[i]);this.dependencyViewContainer.innerHTML=t,this.parent.ganttChartModule.chartBodyContent.appendChild(this.dependencyViewContainer)},e.prototype.getParentPosition=function(e){if(e.parentIndex<e.childIndex){if("FF"===e.type)return e.childLeft+e.childWidth>=e.parentLeft+e.parentWidth?"FFType2":"FFType1";if(e.parentLeft<e.childLeft&&e.childLeft>e.parentLeft+e.parentWidth+25){if("FS"===e.type)return"FSType1";if("SF"===e.type)return"SFType1";if("SS"===e.type)return"SSType2";if("FF"===e.type)return"FFType2"}else if(e.parentLeft<e.childLeft&&e.childLeft<e.parentLeft+e.parentWidth||e.parentLeft===e.childLeft||e.parentLeft>e.childLeft){if(e.parentLeft>e.childLeft+e.childWidth+25&&"SF"===e.type)return"SFType2";if(e.parentLeft>e.childLeft){if("SS"===e.type)return"SSType1";if("SF"===e.type)return"SFType1";if("FF"===e.type)return"FFType1"}else if(e.childLeft+e.childWidth>e.parentLeft+e.parentWidth&&"FF"===e.type)return"FFType2";if("FS"===e.type)return"FSType2";if("SS"===e.type)return"SSType2";if("FF"===e.type)return"FFType1";if("SF"===e.type)return"SFType1"}else if(e.parentLeft<e.childLeft){if("FS"===e.type)return"FSType2";if("FF"===e.type)return"FFType2";if("SS"===e.type)return"SSType2";if("SF"===e.type)return"SFType1"}}else if(e.parentIndex>e.childIndex)if(e.parentLeft<e.childLeft&&e.childLeft>e.parentLeft+e.parentWidth){if("FS"===e.type)return 30>=e.childLeft-(e.milestoneParent?e.parentLeft+e.parentWidth+4:e.parentLeft+e.parentWidth)?"FSType3":"FSType4";if(e.parentLeft<e.childLeft||e.childLeft+e.childWidth>e.parentLeft+e.parentWidth){if("SS"===e.type)return"SSType4";if("FF"===e.type)return"FFType4";if("SF"===e.type)return"SFType4"}else if(e.childLeft+e.childWidth>e.parentLeft+e.parentWidth&&"FF"===e.type)return"FFType4"}else if(e.parentLeft<e.childLeft&&e.childLeft<e.parentLeft+e.parentWidth||e.parentLeft===e.childLeft||e.parentLeft>e.childLeft){if(e.childLeft+e.childWidth<=e.parentLeft+e.parentWidth){if("FF"===e.type)return"FFType3";if("SF"===e.type)return e.childLeft+e.childWidth+25<e.parentLeft?"SFType3":"SFType4";if("SS"===e.type)return e.childLeft<=e.parentLeft?"SSType3":"SSType4"}else if(e.childLeft+e.childWidth>e.parentLeft+e.parentWidth){if("FF"===e.type)return"FFType4";if("SF"===e.type)return"SFType4";if("SS"===e.type)return e.childLeft<=e.parentLeft?"SSType3":"SSType4"}if("FS"===e.type)return"FSType3"}else if(e.parentLeft<e.childLeft){if("FS"===e.type)return"FSType3";if("SS"===e.type)return"SSType4";if("FF"===e.type)return"FFType4";if("SF"===e.type)return"SFType4"}return null},e.prototype.getHeightValue=function(e){return e.parentIndex*e.rowHeight>e.childIndex*e.rowHeight?e.parentIndex*e.rowHeight-e.childIndex*e.rowHeight:e.childIndex*e.rowHeight-e.parentIndex*e.rowHeight},e.prototype.getInnerElementWidthSSType2=function(e){return e.parentLeft===e.childLeft?10:e.childLeft-e.parentLeft},e.prototype.getInnerElementLeftSSType2=function(e){return e.parentLeft===e.childLeft?e.parentLeft-20:e.parentLeft-10},e.prototype.getInnerChildWidthSSType2=function(e){return e.parentLeft+e.parentWidth<e.childLeft?10:e.parentLeft===e.childLeft?20:e.parentLeft+e.parentWidth>=e.childLeft?10:e.childLeft-e.parentLeft},e.prototype.getBorderStyles=function(e,i){return"border-"+e+"-width:"+i+"px;"+("border-"+e+"-style:solid;")+(t.isNullOrUndefined(this.lineColor)?"":"border-"+e+"-color:"+this.lineColor+";")},e.prototype.getConnectorLineTemplate=function(e){var i=this.getInnerChildWidthSSType2(e),r=this.getInnerElementWidthSSType2(e),n=this.getInnerElementLeftSSType2(e),a=this.getHeightValue(e),o=!!e.milestoneParent,s=!!e.milestoneChild,l="";if(this.getParentPosition(e)){l='<div id="ConnectorLine'+e.connectorLineId+'" style="background-color:black">';var d='<div class="'+K+'" tabindex="-1" aria-label="'+this.generateAriaLabel(e)+'" style="',p='<div class="e-line" style="'+(t.isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),h='<div class="'+$+'" style="'+(t.isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),c='<div class="'+J+'" style="'+(t.isNullOrUndefined(this.lineColor)?"":"outline-color:"+this.lineColor+";"),u=c+(s?"left:0px;":"")+this.getBorderStyles("right",10)+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',g=this.getBorderStyles("left",10)+"top:"+-6+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',f=this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>'+p+"top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-(this.lineStroke-1))+'position:relative;"></div>',m=c+"left:"+(e.childLeft+e.childWidth-e.parentLeft+10)+"px;"+this.getBorderStyles("right",10),y="top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>';"FSType1"===this.getParentPosition(e)&&(d=d+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FSType1">',d=(d+=p)+"left:"+(o?-1:0)+"px;width:"+(o?e.childLeft-(e.parentLeft+e.parentWidth+10)+this.lineStroke-10+1:e.childLeft-(e.parentLeft+e.parentWidth+10)+this.lineStroke-10)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10)-10)+"px;width:0px;"+this.getBorderStyles("right",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10)-10)+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=h)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10))+"px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FSType2"===this.getParentPosition(e)&&(d=d+"left:"+e.parentLeft+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FSType2">',d=(d+=p)+"left:"+(o?e.parentWidth-1:e.parentWidth)+"px;width:"+(o?11:10)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.parentWidth+10-this.lineStroke)+"px;"+this.getBorderStyles("left",this.lineStroke)+"width:0px;"+this.getBorderStyles("top",a-this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+20))+"px;width:"+(e.parentLeft+e.parentWidth-e.childLeft+30)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+20))+"px;width:0px;"+this.getBorderStyles("top",this.getconnectorLineGap(e)-this.lineStroke)+this.getBorderStyles("left",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+20))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=h)+"left:"+(e.parentWidth-(e.parentLeft+e.parentWidth-e.childLeft+10))+"px;"+this.getBorderStyles("left",10)+"border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+"px;top:"+(-6-this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FSType3"===this.getParentPosition(e)&&(d=d+"left:"+(e.childLeft-20)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(o)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FSType3">',d=(d+=h)+"left:10px;"+this.getBorderStyles("left",10)+"border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+"px;top:"+-6+'px;width:0;height:0;position:relative;"></div>',d=(d+=p)+"width:10px;"+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(6+(5+this.lineStroke)+Math.round(this.lineStroke/2))+'px;"></div>',d=(d+=p)+"width:"+this.lineStroke+"px;"+this.getBorderStyles("top",a-this.getconnectorLineGap(e)-this.lineStroke+1)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',d=(d+=p)+"width:"+(e.parentLeft+e.parentWidth-e.childLeft+30)+"px;"+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',d=(d+=p)+"left:"+(e.parentLeft+e.parentWidth-e.childLeft+(30-this.lineStroke))+"px;width:0px;height:"+(this.getconnectorLineGap(e)-this.lineStroke)+"px;"+this.getBorderStyles("left",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div>',d=(d+=p)+(o?"left:"+(e.parentLeft+e.parentWidth-e.childLeft+(18-this.lineStroke))+"px;width:"+(12+this.lineStroke)+"px;":"left:"+(e.parentLeft+e.parentWidth-e.childLeft+20)+"px;width:10px;")+this.getBorderStyles("top",this.lineStroke)+"position:relative;top:"+-(13+2*(this.lineStroke-1))+'px;"></div></div>'),"FSType4"===this.getParentPosition(e)&&(d=d+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FSType4">',d=(d+=h)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth+10))+"px;"+this.getBorderStyles("left",10)+"top:"+-6+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',d=(d+=p)+"left:"+(e.childLeft-(e.parentLeft+e.parentWidth)-20)+"px;top:"+-(6+(5+this.lineStroke)+Math.round(this.lineStroke/2))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"top:"+-(13+2*(this.lineStroke-1))+"px;left:"+(e.childLeft-(e.parentLeft+e.parentWidth)-20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke+1)+'position:relative;"></div>',d=(d+=p)+(o?"left:-1px;":"")+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(o?e.childLeft-(e.parentLeft+e.parentWidth+20)+1+this.lineStroke:e.childLeft-(e.parentLeft+e.parentWidth+20)+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType4"===this.getParentPosition(e)&&(d=d+"left:"+(e.parentLeft-10)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SSType4">',d=(d+=h)+"left:"+(e.childLeft-e.parentLeft)+"px;"+g,d=(d+=p)+"top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;width:"+(e.childLeft-e.parentLeft)+"px;"+f,d=(d+=p)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType3"===this.getParentPosition(e)&&(d=d+"left:"+(e.childLeft-20)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SSType3">',d=(d+=h)+"left:10px;"+g,d=(d+=p)+"top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;width:10px;"+f,d=(d+=p)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(e.parentLeft-e.childLeft+21)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SSType2"===this.getParentPosition(e)&&(d=d+"left:"+n+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(o)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SSType2">',d=(d+=p)+"width:"+(i+1)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"width:"+r+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=h)+"left:"+r+"px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"SSType1"===this.getParentPosition(e)&&(d=d+"left:"+(e.childLeft-20)+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(o)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SSType1">',d=(d+=p)+"width:"+(e.parentLeft-e.childLeft+21)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"width:10px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=h)+"left:10px;"+this.getBorderStyles("left",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType1"===this.getParentPosition(e)&&(d=d+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(o)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FFType1">',d=(d+=p)+"left:"+(o?e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)-1:e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth))+"px;width:"+(o?21+this.lineStroke:20+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(s?4:10)+"px;width:"+(s?e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+(16+this.lineStroke):e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+(10+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=c)+(s?"left:0px;":"")+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType2"===this.getParentPosition(e)&&(d=d+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(o)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FFType2">',d=(d+=p)+(o?"left:-1px;":"")+"width:"+(o?e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(21+this.lineStroke):e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(20+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+20)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(s?e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+4:e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+10)+"px;width:"+(s?16+this.lineStroke:10+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=c)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth))+"px;"+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),"FFType3"===this.getParentPosition(e)&&(d=d+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FFType3">',d+=u,d=(d+=p)+(s?"left:4px;width:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+16):"left:10px;width:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+10))+"px;top:"+-(6+(5+this.lineStroke)+this.lineStroke/2)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)+20)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke+1)+'position:relative;"></div>',d=(d+=p)+(o?"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth)-1)+"px;width:21":"left:"+(e.parentLeft+e.parentWidth-(e.childLeft+e.childWidth))+"px;width:20")+"px;top:"+-(13+2*(this.lineStroke-1))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"FFType4"===this.getParentPosition(e)&&(d=d+"left:"+(e.parentLeft+e.parentWidth)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="FFType4">',d=(d+=c)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth))+"px;"+this.getBorderStyles("right",10)+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',d=(d+=p)+(s?"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+4)+"px;width:"+(16+this.lineStroke):"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+10)+"px;width:"+(10+this.lineStroke))+"px;"+y,d=(d+=p)+"left:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+20)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke+1)+'position:relative;"></div>',d=(d+=p)+(o?"left:-1px;width:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(21+this.lineStroke)):"width:"+(e.childLeft+e.childWidth-(e.parentLeft+e.parentWidth)+(20+this.lineStroke)))+"px;top:"+-(13+2*(this.lineStroke-1))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType4"===this.getParentPosition(e)&&(d=(d=d+"left:"+(e.parentLeft-10)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SFType4">')+m+"top:"+(-5-this.lineStroke+(this.lineStroke-1))+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div>',d=(d+=p)+"left:"+(s?e.childLeft+e.childWidth-e.parentLeft+(14+this.lineStroke)+"px;width:16":e.childLeft+e.childWidth-e.parentLeft+20+"px;width:"+(10+this.lineStroke))+"px;"+y,d=(d+=p)+"left:"+(e.childLeft+e.childWidth-e.parentLeft+30)+"px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.getconnectorLineGap(e)-(this.lineStroke-1))+'position:relative;"></div>',d=(d+=p)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(e.childLeft+e.childWidth-e.parentLeft+(30+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"top:"+-(13+2*(this.lineStroke-1))+"px;width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType3"===this.getParentPosition(e)&&(d=d+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(e.childIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SFType3">',d+=u,d=(d+=p)+(s?"left:4px;width:"+(16+this.lineStroke):"left:10px;width:"+(10+this.lineStroke))+"px;top:"+-(13+2*(this.lineStroke-1)-1)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:20px;top:"+-(13+2*(this.lineStroke-1))+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-(this.lineStroke-1))+'position:relative;"></div>',d=(d+=p)+"left:20px;top:"+-(13+2*(this.lineStroke-1))+"px;width:"+(e.parentLeft-(e.childLeft+e.childWidth+20)+this.lineStroke)+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div></div>'),"SFType1"===this.getParentPosition(e)&&(d=d+"left:"+(e.parentLeft-10)+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(s)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SFType1">',d=(d+=p)+"width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"width:"+(e.childLeft+e.childWidth-e.parentLeft+(30+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.childLeft+e.childWidth-e.parentLeft+30)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",this.getconnectorLineGap(e)-this.lineStroke)+'position:relative;"></div>',d=(d=(d+=p)+(s?"left:"+(e.childLeft+e.childWidth-e.parentLeft+15)+"px;width:"+(15+this.lineStroke):"left:"+(e.childLeft+e.childWidth-e.parentLeft+20)+"px;width:"+(10+this.lineStroke))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>')+m+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;position:relative;"></div></div>'),"SFType2"===this.getParentPosition(e)&&(d=d+"left:"+(e.childLeft+e.childWidth)+"px;top:"+(e.parentIndex*e.rowHeight+this.getTaskbarMidpoint(o)-(this.lineStroke-1))+"px;width:1px;height:"+a+'px;position:absolute" data-connectortype="SFType2">',d=(d+=p)+"left:"+(e.parentLeft-(e.childLeft+e.childWidth)-10)+"px;width:11px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=p)+"left:"+(e.parentLeft-(e.childLeft+e.childWidth)-10)+"px;width:0px;"+this.getBorderStyles("left",this.lineStroke)+this.getBorderStyles("top",a-this.lineStroke)+'position:relative;"></div>',d=(d+=p)+(s?"left:4px;width:"+(e.parentLeft-(e.childLeft+e.childWidth)-(14-this.lineStroke)):"left:10px;width:"+(e.parentLeft-(e.childLeft+e.childWidth)-(20-this.lineStroke)))+"px;"+this.getBorderStyles("top",this.lineStroke)+'position:relative;"></div>',d=(d+=c)+"left:0px;"+this.getBorderStyles("right",10)+"top:"+(-6-this.lineStroke)+"px;border-bottom-width:"+(5+this.lineStroke)+"px;border-top-width:"+(5+this.lineStroke)+'px;width:0;height:0;position:relative;"></div></div>'),l+=d,l+="</div>"}return l},e.prototype.createConnectorLineTooltipTable=function(){this.tooltipTable=t.createElement("table",{className:".e-tooltiptable",styles:"margin-top:0px",attrs:{cellspacing:"2px",cellpadding:"2px"}});var e=t.createElement("tbody");e.innerHTML="",this.tooltipTable.appendChild(e)},e.prototype.getConnectorLineTooltipInnerTd=function(e,t,i,r){var n='<tr  id="fromPredecessor"><td >'+this.parent.localeObj.getConstant("from")+"</td><td> ";return n=n+e+" </td><td> "+this.parent.localeObj.getConstant(t)+" </td> </tr>",n=n+'<tr id="toPredecessor"><td>'+this.parent.localeObj.getConstant("to")+"</td><td> "+i,n=n+" </td><td> "+this.parent.localeObj.getConstant(r)+" </td></tr></tbody><table>"},e.prototype.generateAriaLabel=function(e){var t=e.type,i=this.parent.getExpandedRecords(this.parent.currentViewData),r=i[e.parentIndex].ganttProperties.taskName,n=i[e.childIndex].ganttProperties.taskName,a=this.parent.localeObj.getConstant("start"),o=this.parent.localeObj.getConstant("finish");return"FS"===t?r+" "+o+" to "+n+" "+a:"FF"===t?r+" "+o+" to "+n+" "+o:"SS"===t?r+" "+a+" to "+n+" "+a:r+" "+a+" to "+n+" "+o},e}(),Dt=function(){function e(e){this.parent=e,this.parent.on("destroy",this.destroy,this)}return e.prototype.renderSplitter=function(){var e=this;t.isNullOrUndefined(this.parent.toolbarModule)||t.isNullOrUndefined(this.parent.toolbarModule.element)||this.parent.toolbarModule.element.offsetHeight;var i=this.calculateSplitterPosition(this.parent.splitterSettings);this.parent.splitterElement=t.createElement("div",{className:"e-gantt-splitter"}),this.parent.treeGridPane=t.createElement("div",{className:"e-gantt-tree-grid-pane"}),this.parent.chartPane=t.createElement("div",{className:"e-gantt-chart-pane"}),this.parent.splitterElement.appendChild(this.parent.treeGridPane),this.parent.splitterElement.appendChild(this.parent.chartPane),this.splitterObject=new o.Splitter({height:null,width:this.parent.ganttWidth.toString(),separatorSize:this.parent.splitterSettings.separatorSize,paneSettings:[{resizable:!0,size:i,min:this.getSpliterPositionInPercentage(this.parent.splitterSettings.minimum)},{resizable:!0}],orientation:"Horizontal",resizeStart:function(i){var r=t.isBlazor()?i.element.querySelectorAll(".e-pane")[0]:i.pane[0],a=t.isBlazor()?i.element.querySelectorAll(".e-pane")[1]:i.pane[1];e.splitterPreviousPositionGrid=r.scrollWidth+1+"px",e.splitterPreviousPositionChart=a.scrollWidth+1+"px";var o=new n.Deferred;return e.parent.trigger("splitterResizeStart",i,function(e){o.resolve(e)}),o},resizing:function(t){e.parent.trigger("splitterResizing",t)},resizeStop:function(t){var i=new n.Deferred;return e.parent.trigger("splitterResized",t,function(t){!0===t.cancel&&(e.splitterObject.paneSettings[0].size=null,e.splitterObject.paneSettings[0].size=e.getSpliterPositionInPercentage(e.splitterPreviousPositionGrid),e.splitterObject.paneSettings[1].size=null,e.splitterObject.paneSettings[1].size=e.getSpliterPositionInPercentage(e.splitterPreviousPositionChart)),i.resolve(t)}),i}}),this.parent.element.appendChild(this.parent.splitterElement),this.splitterObject.appendTo(this.parent.splitterElement)},e.prototype.calculateSplitterPosition=function(e,i){return"Grid"===e.view?"100%":"Chart"===e.view?"0%":t.isNullOrUndefined(e.position)||""===e.position?!t.isNullOrUndefined(e.columnIndex)&&e.columnIndex>=0?i?this.getSpliterPositionInPercentage(this.getTotalColumnWidthByIndex(e.columnIndex).toString()+"px"):this.getSpliterPositionInPercentage(150*e.columnIndex+"px"):this.getSpliterPositionInPercentage("250px"):this.getSpliterPositionInPercentage(e.position)},e.prototype.getSpliterPositionInPercentage=function(e){var i=t.isNullOrUndefined(e)||""===e?null:e;if(!t.isNullOrUndefined(i))if(-1!==e.indexOf("px")){var r=parseInt(e,10);i=r/this.parent.ganttWidth*100<=100?r/this.parent.ganttWidth*100+"%":"25%"}else i=-1===e.indexOf("%")?e+"%":e;return i},e.prototype.getTotalColumnWidthByIndex=function(e){var t=0,i=this.parent.treeGrid.element.querySelectorAll(".e-headercell");e=i.length>e?e:i.length;for(var r=0;r<e;r++)t+=i[r].offsetWidth;return t},e.prototype.updateSplitterPosition=function(){this.splitterObject.separatorSize=this.parent.splitterSettings.separatorSize>=4?this.parent.splitterSettings.separatorSize:4;var e=this.calculateSplitterPosition(this.parent.splitterSettings,!0);this.splitterObject.paneSettings[0].min=this.getSpliterPositionInPercentage(this.parent.splitterSettings.minimum),this.splitterObject.dataBind(),this.splitterObject.paneSettings[0].size=e},e.prototype.triggerCustomResizedEvent=function(){var e=this.splitterObject.element.querySelectorAll(".e-pane")[0],t=this.splitterObject.element.querySelectorAll(".e-pane")[1],i={event:null,element:this.splitterObject.element,pane:[e,t],index:[0,1],separator:this.splitterObject.element.querySelector(".e-split-bar"),paneSize:[e.offsetWidth,t.offsetWidth]};this.parent.trigger("splitterResized",i),!0===i.cancel&&(this.splitterObject.paneSettings[0].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionGrid),this.splitterObject.paneSettings[1].size=this.getSpliterPositionInPercentage(this.splitterPreviousPositionChart))},e.prototype.destroy=function(){this.splitterObject.destroy(),this.parent.off("destroy",this.destroy)},e}(),Tt=function(){function e(e){this.parent=e,this.createTooltip(),this.parent.on("destroy",this.destroy,this)}return e.prototype.createTooltip=function(){this.toolTipObj=new i.Tooltip,this.toolTipObj.target=".e-header-cell-label, .e-gantt-child-taskbar,.e-gantt-parent-taskbar, .e-gantt-milestone, .e-gantt-unscheduled-taskbar.e-event-markers, .e-baseline-bar, .e-event-markers,.e-connector-line-container, .e-indicator-span, .e-notes-info,.e-taskbar-left-resizer, .e-taskbar-right-resizer",this.toolTipObj.position="BottomCenter",this.toolTipObj.openDelay=700,this.toolTipObj.cssClass=he,this.toolTipObj.animation={open:{effect:"None",delay:0},close:{effect:"None",delay:0}},this.toolTipObj.afterOpen=this.updateTooltipPosition.bind(this),this.toolTipObj.showTipPointer=!1,this.toolTipObj.beforeRender=this.tooltipBeforeRender.bind(this),this.toolTipObj.afterClose=this.tooltipCloseHandler.bind(this),this.toolTipObj.isStringTemplate=!0,this.toolTipObj.appendTo(this.parent.element)},e.prototype.tooltipBeforeRender=function(e){var i=this.parent;i.isOnEdit&&(e.cancel=!0);var r,a=u(e.target,B),o={data:{},args:e,cancel:!1,content:""};if(e.target.classList.contains("e-header-cell-label"))i.timelineSettings.showTooltip?o.content=this.toolTipObj.content=i.tooltipModule.getTooltipContent("timeline",r,i,e):e.cancel=!0;else if(i.tooltipSettings.showTooltip){if(a&&(o.data=i.ganttChartModule.getRecordByTaskBar(a),r=o.data),e.target.classList.contains("e-gantt-child-taskbar")||e.target.classList.contains("e-gantt-parent-taskbar")||e.target.classList.contains("e-gantt-milestone")||e.target.classList.contains("e-gantt-unscheduled-taskbar")||e.target.classList.contains("e-taskbar-left-resizer")||e.target.classList.contains("e-taskbar-right-resizer")){var s=void 0;i.tooltipSettings.taskbar&&(s=i.tooltipModule.templateCompiler(i.tooltipSettings.taskbar,i,r,"TooltipTaskbarTemplate")),o.content=this.toolTipObj.content=s?s[0]:i.tooltipModule.getTooltipContent(r.ganttProperties.isMilestone?"milestone":"taskbar",r,i,e)}else if(e.target.classList.contains("e-baseline-bar")){var l=void 0;i.tooltipSettings.baseline&&(l=i.tooltipModule.templateCompiler(i.tooltipSettings.baseline,i,r,"TooltipBaselineTemplate")),o.content=this.toolTipObj.content=l?l[0]:i.tooltipModule.getTooltipContent("baseline",r,i,e)}else if(e.target.classList.contains("e-event-markers"))o.content=this.toolTipObj.content=i.tooltipModule.getTooltipContent("marker",r,i,e);else if(e.target.classList.contains("e-connector-line-container")){var d=void 0;i.tooltipModule.predecessorTooltipData=i.tooltipModule.getPredecessorTooltipData(e),o.data=this.predecessorTooltipData,i.tooltipSettings.connectorLine&&(d=i.tooltipModule.templateCompiler(i.tooltipSettings.connectorLine,i,i.tooltipModule.predecessorTooltipData,"TooltipConnectorLineTemplate")),o.content=this.toolTipObj.content=d?d[0]:i.tooltipModule.getTooltipContent("connectorLine",r,i,e)}else if(e.target.classList.contains("e-indicator-span"))o.content=this.toolTipObj.content=i.tooltipModule.getTooltipContent("indicator",r,i,e),t.isNullOrUndefined(o.content)&&(e.cancel=!0);else if(e.target.classList.contains("e-notes-info")){var p=this.parent.ganttChartModule.getRecordByTarget(e.event);o.content=this.toolTipObj.content=p.ganttProperties.notes,t.isNullOrUndefined(o.content)&&(e.cancel=!0)}}else e.cancel=!0;if(!1===e.cancel){var h=new n.Deferred;return i.trigger("beforeTooltipRender",o,function(t){h.resolve(t),t.cancel&&(e.cancel=!0)}),this.parent.isAdaptive||"mouseover"!==e.event.type||(this.currentTarget=e.target,t.EventHandler.add(this.currentTarget,"mousemove",this.mouseMoveHandler.bind(this))),h}},e.prototype.tooltipCloseHandler=function(e){this.tooltipMouseEvent=null,this.parent.isAdaptive||t.EventHandler.remove(this.currentTarget,"mousemove",this.mouseMoveHandler),this.currentTarget=null},e.prototype.mouseMoveHandler=function(e){this.tooltipMouseEvent=e},e.prototype.updateTooltipPosition=function(e){if(!t.isNullOrUndefined(this.tooltipMouseEvent)&&!e.target.classList.contains("e-notes-info")){var i=this.getPointorPosition(this.tooltipMouseEvent),r=this.parent.getOffsetRect(this.parent.chartPane),n=r.top+this.parent.chartPane.offsetHeight,a=r.left+this.parent.chartPane.offsetWidth,o=i.x,s=i.y,l=!1;a<o+e.element.offsetWidth+20?o=o-e.element.offsetWidth-10:o+=10,n<s+e.element.offsetHeight+20?s=s-e.element.offsetHeight-10:(l=!0,s+=10),window.innerHeight<e.element.offsetHeight+s&&(s=s-e.element.offsetHeight-(l?20:10)),e.element.style.left=o+"px",e.element.style.top=s+"px"}},e.prototype.getPointorPosition=function(e){var i,r;return t.isNullOrUndefined(t.getValue("pageX",e))&&t.isNullOrUndefined(t.getValue("pageY",e))?t.isNullOrUndefined(t.getValue("clientX",e))&&t.isNullOrUndefined(t.getValue("clientY",e))||(i=t.getValue("clientX",e)+document.body.scrollLeft+document.documentElement.scrollLeft,r=t.getValue("clientY",e)+document.body.scrollTop+document.documentElement.scrollTop):(i=t.getValue("pageX",e),r=t.getValue("pageY",e)),{x:i,y:r}},e.prototype.getTooltipContent=function(e,i,r,n){var a,o;switch(i&&(o=i.ganttProperties),e){case"milestone":a='<table class = "e-gantt-tooltiptable"><tbody><tr class = "e-gantt-tooltip-rowcell"><td colspan="3">'+o.taskName+'</td></tr><tr><td class = "e-gantt-tooltip-label"> Date</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(o.startDate,this.parent.dateFormat)+"</tr></tbody></table>";break;case"taskbar":var s=o.startDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("startDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getFormatedDate(o.startDate,this.parent.dateFormat)+"</td></tr>":"",l=o.endDate?'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("endDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(o.endDate,this.parent.dateFormat)+"</td></tr>":"",d=t.isNullOrUndefined(o.duration)?"":'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("duration")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+this.parent.getDurationString(o.duration,o.durationUnit)+"</td></tr>";a='<table class = "e-gantt-tooltiptable"><tbody><tr class = "e-gantt-tooltip-rowcell"><td colspan="3">'+o.taskName+"</td></tr>"+s+l+d+'<tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("progress")+"</td><td>:</td><td>"+o.progress+"</td></tr></tbody></table>";break;case"baseline":a='<table class = "e-gantt-tooltiptable"><tbody><tr class = "e-gantt-tooltip-rowcell"><td colspan="3">'+o.taskName+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("baselineStartDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(o.baselineStartDate,this.parent.dateFormat)+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("baselineEndDate")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+this.parent.getFormatedDate(o.baselineEndDate,this.parent.dateFormat)+"</td></tr></tbody></table>";break;case"marker":var p=r.tooltipModule.getMarkerTooltipData(n),h=p.label?p.label:"";a='<table class = "e-gantt-tooltiptable"><tbody><tr><td>'+this.parent.getFormatedDate(this.parent.dateValidationModule.getDateFromFormat(p.day),this.parent.dateFormat)+"</td></tr><tr><td>"+h+"</td></tr></tbody></table>";break;case"connectorLine":a='<table class = "e-gantt-tooltiptable"><tbody><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("from")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+r.tooltipModule.predecessorTooltipData.fromName+" ("+r.tooltipModule.predecessorTooltipData.fromId+')</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("to")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+r.tooltipModule.predecessorTooltipData.toName+" ("+r.tooltipModule.predecessorTooltipData.toId+')</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("taskLink")+'</td><td>:</td><td class = "e-gantt-tooltip-value"> '+r.tooltipModule.predecessorTooltipData.linkText+'</td></tr><tr><td class = "e-gantt-tooltip-label">'+this.parent.localeObj.getConstant("lag")+'</td><td>:</td><td class = "e-gantt-tooltip-value">'+r.tooltipModule.predecessorTooltipData.offsetString+"</td></tr></tbody></table>";break;case"indicator":n.target.title.length&&(a='<table class = "e-gantt-tooltiptable"><tbody><tr>'+n.target.title+"</tr></tbody></table>");break;case"timeline":a='<table class = "e-gantt-tooltiptable"><tbody><tr>'+n.target.title+"</tr></tbody></table>"}return a},e.prototype.getMarkerTooltipData=function(e){var t=e.target.id.match(/\d+/g);return this.parent.eventMarkers[Number(t)]},e.prototype.getPredecessorTooltipData=function(e){var t=e.target.parentElement.id.match(/\d+/g),i=this.parent.flatData[this.parent.ids.indexOf(t[0])],r=this.parent.flatData[this.parent.ids.indexOf(t[1])],n=i.ganttProperties.predecessor.filter(function(e){return e.to===t[1]});return{fromId:i.ganttProperties.taskId,toId:r.ganttProperties.taskId,fromName:i.ganttProperties.taskName,toName:r.ganttProperties.taskName,linkType:n[0].type,linkText:this.parent.getPredecessorTextValue(n[0].type),offset:n[0].offset,offsetUnit:n[0].offsetUnit,offsetString:this.parent.getDurationString(n[0].offset,n[0].offsetUnit)}},e.prototype.templateCompiler=function(e,i,r,n){var a=i.chartRowsModule.templateCompiler(e),o=i.chartRowsModule.getTemplateID(n);return a(t.extend({index:0},r),i,n,o,!0)},e.prototype.destroy=function(){this.toolTipObj.destroy()},e}(),kt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),St=function(e,t,i,r){var n,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(a<3?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},bt=function(e){function n(t,i){var r=e.call(this,t,i)||this;return r.previousRecords={},r.editedRecords=[],r.isOnEdit=!1,r.isOnDelete=!1,r.isConnectorLineUpdate=!1,r.staticSelectedRowIndex=-1,r.needsID=!0,r.isTreeGridRendered=!1,r.isGanttChartRendered=!1,r}return kt(n,e),n.prototype.getModuleName=function(){return"gantt"},n.prototype.onKeyPress=function(e){var i=this.getExpandedRecords(this.currentViewData);if("home"!==e.action&&"end"!==e.action&&"downArrow"!==e.action&&"upArrow"!==e.action&&"delete"!==e.action&&"rightArrow"!==e.action&&"leftArrow"!==e.action&&"focusTask"!==e.action&&"focusSearch"!==e.action&&"expandAll"!==e.action&&"collapseAll"!==e.action||t.isNullOrUndefined(this.editModule)||t.isNullOrUndefined(this.editModule.cellEditModule)||!0!==this.editModule.cellEditModule.isCellEdit)switch(this.isAdaptive&&("addRowDialog"!==e.action&&"editRowDialog"!==e.action&&"delete"!==e.action&&"addRow"!==e.action||this.selectionModule&&"Multiple"===this.selectionSettings.type&&(this.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),e.action){case"home":if(this.selectionModule&&"Cell"!==this.selectionSettings.mode){if(0===this.selectedRowIndex)return;this.selectionModule.selectRow(0)}break;case"end":if(this.selectionModule&&"Cell"!==this.selectionSettings.mode){var r=i[i.length-1];if(this.selectedRowIndex===this.currentViewData.indexOf(r))return;this.selectionModule.selectRow(this.currentViewData.indexOf(r))}break;case"downArrow":case"upArrow":this.upDownKeyNavigate(e);break;case"expandAll":this.ganttChartModule.expandCollapseAll("expand");break;case"collapseAll":this.ganttChartModule.expandCollapseAll("collapse");break;case"expandRow":case"collapseRow":this.expandCollapseKey(e);break;case"saveRequest":if(!t.isNullOrUndefined(this.editModule)&&!t.isNullOrUndefined(this.editModule.cellEditModule)&&!0===this.editModule.cellEditModule.isCellEdit){this.editModule.cellEditModule.isCellEdit=!1,this.treeGrid.grid.saveCell();this.element.querySelector(".e-treegrid").focus()}break;case"cancelRequest":t.isNullOrUndefined(this.editModule)||t.isNullOrUndefined(this.editModule.cellEditModule)||(this.editModule.cellEditModule.isCellEdit=!1,t.isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems());break;case"addRow":e.preventDefault();this.element.querySelector(".e-gantt-chart").focus(),this.addRecord();break;case"addRowDialog":if(e.preventDefault(),this.editModule&&this.editModule.dialogModule&&this.editSettings.allowAdding){if(this.editModule.dialogModule.dialogObj&&t.getValue("dialogOpen",this.editModule.dialogModule.dialogObj))return;this.editModule.dialogModule.openAddDialog()}break;case"editRowDialog":e.preventDefault();if(this.element.querySelector(".e-treegrid").focus(),this.editModule&&this.editModule.dialogModule&&this.editSettings.allowEditing){if(this.editModule.dialogModule.dialogObj&&t.getValue("dialogOpen",this.editModule.dialogModule.dialogObj))return;this.editModule.dialogModule.openToolbarEditDialog()}break;case"delete":this.selectionModule&&this.editModule&&(!this.editSettings.allowTaskbarEditing||this.editSettings.allowTaskbarEditing&&!this.editModule.taskbarEditModule.touchEdit)&&("Cell"!==this.selectionSettings.mode&&this.selectionModule.selectedRowIndexes.length||"Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length)&&this.editModule.startDeleteAction();break;case"focusTask":e.preventDefault();var n=void 0;if(this.selectionModule)if("Cell"===this.selectionSettings.mode||t.isNullOrUndefined(this.currentViewData[this.selectedRowIndex])){if("Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length>0){var a=this.selectionModule.getSelectedRowCellIndexes();n=this.currentViewData[a[a.length-1].rowIndex].ganttProperties.taskId}}else n=this.currentViewData[this.selectedRowIndex].ganttProperties.taskId;n&&this.scrollToTask(n.toString());break;case"focusSearch":if(this.element.querySelector("#"+this.element.id+"_searchbar")){var o=this.element.querySelector("#"+this.element.id+"_searchbar");o.setAttribute("tabIndex","-1"),o.focus()}break;default:var s={requestType:"keyPressed",action:e.action,keyEvent:e};this.trigger("actionComplete",s)}},n.prototype.expandCollapseKey=function(e){if(this.selectionModule&&-1!==this.selectedRowIndex){var t=void 0;if("Cell"!==this.selectionSettings.mode)t=this.selectedRowIndex;else if("Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length>0){var i=this.selectionModule.getSelectedRowCellIndexes();t=i[i.length-1].rowIndex}"expandRow"===e.action?this.expandByIndex(t):this.collapseByIndex(t)}},n.prototype.upDownKeyNavigate=function(e){e.preventDefault();var t=this.getExpandedRecords(this.currentViewData);if(this.selectionModule)if("Cell"!==this.selectionSettings.mode&&-1!==this.selectedRowIndex){var i=this.currentViewData[this.selectedRowIndex],r=t.indexOf(i),n="downArrow"===e.action?t[r+1]:t[r-1];this.selectionModule.selectRow(this.currentViewData.indexOf(n))}else if("Cell"===this.selectionSettings.mode&&this.selectionModule.getSelectedRowCellIndexes().length>0){var a=this.selectionModule.getSelectedRowCellIndexes(),o=a[a.length-1],s=o.cellIndexes[o.cellIndexes.length-1],l=(i=this.currentViewData[o.rowIndex],r=t.indexOf(i),n="downArrow"===e.action?t[r+1]:t[r-1],{rowIndex:this.currentViewData.indexOf(n),cellIndex:s});this.selectionModule.selectCell(l)}},n.prototype.preRender=function(){this.initProperties()},n.prototype.initProperties=function(){this.globalize=new t.Internationalization(this.locale),this.isAdaptive=t.Browser.isDevice,this.flatData=[],this.currentViewData=[],this.ids=[],this.ganttColumns=[],this.localeObj=new t.L10n(this.getModuleName(),this.getDefaultLocale(),this.locale),this.dataOperation=new S(this),this.nonWorkingHours=[],this.nonWorkingTimeRanges=[],this.workingTimeRanges=[],this.defaultEndTime=null,this.defaultStartTime=null,this.durationUnitTexts={days:"days",hours:"hours",minutes:"minutes",day:"day",hour:"hour",minute:"minute"},this.durationUnitEditText={minute:["m","min","minute","minutes"],hour:["h","hr","hour","hours"],day:["d","dy","day","days"]},this.perDayWidth=null,this.isMileStoneEdited=!1,this.chartVerticalLineContainer=null,this.updatedConnectorLineCollection=[],this.connectorLineIds=[],this.predecessorsCollection=[],this.isInPredecessorValidation=this.enablePredecessorValidation,this.isValidationEnabled=!0,this.isLoad=!0,this.editedTaskBarItem=null,this.validationDialogElement=null,this.currentEditedArgs={},this.dialogValidateMode={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},this.secondsPerDay=this.dataOperation.getSecondsPerDay(),this.nonWorkingDayIndex=[],this.dataOperation.getNonWorkingDayIndex(),this.columnMapping={},this.controlId=this.element.id,this.cloneProjectStartDate=null,this.cloneProjectEndDate=null,this.totalHolidayDates=this.dataOperation.getHolidayDates(),this.ganttChartModule=new ve(this),this.timelineModule=new Te(this),this.chartRowsModule=new mt(this),this.treeGridModule=new Se(this),this.dateValidationModule=new T(this),this.predecessorModule=new yt(this),this.connectorLineModule=new vt(this),this.splitterModule=new Dt(this),this.tooltipModule=new Tt(this),this.keyConfig={home:"home",end:"end",downArrow:"downarrow",upArrow:"uparrow",collapseAll:"ctrl+uparrow",expandAll:"ctrl+downarrow",collapseRow:"ctrl+shift+uparrow",expandRow:"ctrl+shift+downarrow",saveRequest:"13",cancelRequest:"27",addRow:"insert",addRowDialog:"ctrl+insert",editRowDialog:"ctrl+f2",delete:"delete",focusTask:"shift+f5",indentLevel:"shift+leftarrow",outdentLevel:"shift+rightarrow",focusSearch:"ctrl+shift+70"},this.zoomingLevels=this.getZoomingLevels()},n.prototype.validateDimentionValue=function(e){return t.isNullOrUndefined(e)?null:"string"==typeof e&&"auto"!==e&&-1===e.indexOf("%")?-1===e.indexOf("px")?e+"px":e:"number"==typeof e?e+"px":e.toString()},n.prototype.calculateDimensions=function(){var e=this.validateDimentionValue(this.height),i=this.validateDimentionValue(this.width);t.isNullOrUndefined(this.width)||"string"!=typeof this.width||-1===this.width.indexOf("%")||(i=this.width);var r=this.element.style.height,n=this.element.style.width;i&&(this.element.style.width=i),e&&(this.element.style.height=e),e||r||(this.element.style.height="auto"),i||n||(this.element.style.width="auto"),this.ganttHeight=this.element.offsetHeight,this.ganttWidth=this.element.offsetWidth},n.prototype.render=function(){i.createSpinner({target:this.element},this.createElement),this.trigger("load",{}),this.element.classList.add("e-gantt"),this.isAdaptive?this.element.classList.add("e-device"):this.element.classList.remove("e-device"),this.calculateDimensions(),t.isNullOrUndefined(this.toolbarModule)||this.renderToolbar(),this.splitterModule.renderSplitter(),this.notify("renderPanels",null),this.showSpinner(),this.dataOperation.checkDataBinding()},n.prototype.showSpinner=function(){i.showSpinner(this.element)},n.prototype.hideSpinner=function(){i.hideSpinner(this.element)},n.prototype.renderGantt=function(e){this.timelineModule.processTimelineUnit(),this.timelineModule.calculateZoomingLevelsPerDayWidth(),this.taskFields.dependency&&(this.predecessorModule.updatePredecessors(),this.isInPredecessorValidation&&this.predecessorModule.updatedRecordsDateByPredecessor()),this.dataOperation.calculateProjectDates(),this.timelineModule.validateTimelineProp(),e?(this.updateProjectDates(this.cloneProjectStartDate,this.cloneProjectEndDate,this.isTimelineRoundOff),this.dataOperation.updateGanttData(),this.treeGrid.dataSource=this.flatData):(this.dataOperation.updateGanttData(),this.treeGridPane.classList.remove("e-temp-content"),t.remove(this.treeGridPane.querySelector(".e-gantt-temp-header")),this.notify("dataReady",{}),this.enableContextMenu&&this.notify("initiate-contextMenu",{}),this.renderTreeGrid(),this.wireEvents(),this.notify("initPredessorDialog",{})),this.splitterModule.updateSplitterPosition(),"Vertical"!==this.gridLines&&"Both"!==this.gridLines||this.renderChartVerticalLines()},n.prototype.wireEvents=function(){this.allowKeyboard&&(this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfig,eventName:"keydown"}))},n.prototype.keyActionHandler=function(e){this.onKeyPress(e)},n.prototype.renderToolbar=function(){t.isNullOrUndefined(this.toolbarModule)||(this.toolbarModule.renderToolbar(),this.toolbarModule.refreshToolbarItems())},n.prototype.renderTreeGrid=function(){this.treeGridModule.renderTreeGrid()},n.prototype.updateCurrentViewData=function(){if(t.isBlazor()){var e=this.treeGrid.getCurrentViewRecords().slice();this.currentViewData=[];for(var i=0;i<e.length;i++)this.currentViewData.push(this.getTaskByUniqueID(e[i].uniqueID));this.treeGrid.grid.currentViewData=this.currentViewData}else this.currentViewData=this.treeGrid.getCurrentViewRecords().slice()},n.prototype.getRecordFromFlatdata=function(e){for(var t=[],i=0;i<e.length;i++)t.push(this.getTaskByUniqueID(e[i].uniqueID));return t},n.prototype.updateContentHeight=function(){var e=this.getExpandedRecords(this.currentViewData);this.contentHeight=e.length*this.rowHeight},n.prototype.getExpandStatus=function(e){var i=this.getParentTask(e.parentItem);if(t.isNullOrUndefined(i))return!0;if(!1===i.expanded)return!1;if(i.parentItem){return!1!==this.getParentTask(i.parentItem).expanded&&this.getExpandStatus(this.getParentTask(i.parentItem))}return!0},n.prototype.getExpandedRecords=function(e){var t=this;return e.filter(function(e){return!0===t.getExpandStatus(e)})},n.prototype.getZoomingLevels=function(){return[{topTier:{unit:"Year",format:"yyyy",count:50},bottomTier:{unit:"Year",format:"yyyy",count:10},timelineUnitSize:99,level:0,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:20},bottomTier:{unit:"Year",format:"yyyy",count:5},timelineUnitSize:99,level:1,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:5},bottomTier:{unit:"Year",format:"yyyy",count:1},timelineUnitSize:99,level:2,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayHalfValue,count:6},timelineUnitSize:66,level:3,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayHalfValue,count:6},timelineUnitSize:99,level:4,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"MMM, yy",count:1},bottomTier:{unit:"Month",formatter:this.displayQuarterValue,count:3},timelineUnitSize:66,level:5,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:1},bottomTier:{unit:"Month",formatter:this.displayQuarterValue,count:3},timelineUnitSize:99,level:6,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Year",format:"yyyy",count:1},bottomTier:{unit:"Month",format:"MMM yyyy",count:1},timelineUnitSize:99,level:7,timelineViewMode:"Year",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yy",count:1},bottomTier:{unit:"Week",format:"dd",count:1},timelineUnitSize:33,level:8,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yyyy",count:1},bottomTier:{unit:"Week",format:"dd MMM",count:1},timelineUnitSize:66,level:9,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Month",format:"MMM, yyyy",count:1},bottomTier:{unit:"Week",format:"dd MMM",count:1},timelineUnitSize:99,level:10,timelineViewMode:"Month",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:33,level:11,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:66,level:12,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Week",format:"MMM dd, yyyy",count:1},bottomTier:{unit:"Day",format:"d",count:1},timelineUnitSize:99,level:13,timelineViewMode:"Week",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:12},timelineUnitSize:66,level:14,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:12},timelineUnitSize:99,level:15,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:6},timelineUnitSize:66,level:16,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:6},timelineUnitSize:99,level:17,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:2},timelineUnitSize:66,level:18,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:2},timelineUnitSize:99,level:19,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:1},timelineUnitSize:66,level:20,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Day",format:"E dd yyyy",count:1},bottomTier:{unit:"Hour",format:"hh a",count:1},timelineUnitSize:99,level:21,timelineViewMode:"Day",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:30},timelineUnitSize:66,level:22,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:15},timelineUnitSize:66,level:23,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0},{topTier:{unit:"Hour",format:"ddd MMM, h a",count:1},bottomTier:{unit:"Minutes",format:"mm",count:1},timelineUnitSize:66,level:24,timelineViewMode:"Hour",weekStartDay:0,updateTimescaleView:!0,weekendBackground:null,showTooltip:!0}]},n.prototype.displayQuarterValue=function(e){var t=e.getMonth();return t>=0&&t<=2?"Q1":t>=3&&t<=5?"Q2":t>=6&&t<=8?"Q3":"Q4"},n.prototype.displayHalfValue=function(e){var t=e.getMonth();return t>=0&&t<=6?"H1":"H2"},n.prototype.getFormatedDate=function(e,i){return t.isNullOrUndefined(e)?null:(t.isNullOrUndefined(i)&&(i=this.dateFormat),this.globalize.formatDate(e,{format:i}))},n.prototype.getDurationString=function(e,t){return this.dateValidationModule.getDurationString(e,t)},n.prototype.treeDataBound=function(e){if(this.updateCurrentViewData(),this.updateContentHeight(),!this.isTreeGridRendered){this.isTreeGridRendered=!0,this.isLoad=!1;var i=0;t.isNullOrUndefined(this.toolbarModule)||t.isNullOrUndefined(this.toolbarModule.element)||(i=this.toolbarModule.element.offsetHeight),this.timelineModule.isSingleTier?(t.addClass(this.treeGrid.element.querySelectorAll(".e-headercell"),b),t.addClass(this.treeGrid.element.querySelectorAll(".e-columnheader"),b)):(t.removeClass(this.treeGrid.element.querySelectorAll(".e-headercell"),b),t.removeClass(this.treeGrid.element.querySelectorAll(".e-columnheader"),b)),this.treeGrid.height=this.ganttHeight-i-this.treeGrid.grid.getHeaderContent().offsetHeight,this.notify("tree-grid-created",{}),this.createGanttPopUpElement(),this.hideSpinner(),t.setValue("isGanttCreated",!0,e),this.renderComplete()}this.taskFields.dependency&&(this.connectorLineIds=[],this.updatedConnectorLineCollection=[],this.predecessorModule.createConnectorLinesCollection(this.currentViewData)),this.notify("recordsUpdated",{}),this.trigger("dataBound",e)},n.prototype.onPropertyChanged=function(e,i){for(var n=!1,a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];switch(s){case"allowSelection":this.treeGrid.allowSelection=this.allowSelection,this.treeGrid.dataBind();break;case"allowFiltering":this.treeGrid.allowFiltering=this.allowFiltering,this.treeGrid.dataBind();break;case"workWeek":this.dataOperation.getNonWorkingDayIndex(),this.dataOperation.reUpdateGanttData(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows(),this.treeGrid.refreshColumns(),this.timelineModule.refreshTimeline();break;case"toolbar":this.notify("ui-toolbarupdate",{module:"toolbar",properties:e});break;case"showColumnMenu":this.treeGrid.showColumnMenu=this.showColumnMenu,this.treeGrid.dataBind();break;case"columnMenuItems":this.treeGrid.grid.columnMenuItems=r.getActualProperties(this.columnMenuItems);break;case"eventMarkers":case"highlightWeekends":this.notify("ui-update",{module:"day-markers",properties:e});break;case"sortSettings":this.treeGrid.sortSettings=r.getActualProperties(this.sortSettings),this.treeGrid.dataBind();break;case"timelineSettings":this.timelineModule.refreshTimeline();break;case"rowHeight":case"taskbarHeight":this.treeGrid.rowHeight=this.rowHeight,this.treeGrid.dataBind(),this.chartRowsModule.initiateTemplates(),this.timelineModule.updateChartByNewTimeline(),this.taskFields.dependency&&this.ganttChartModule.reRenderConnectorLines();break;case"filterSettings":this.treeGrid.filterSettings=r.getActualProperties(this.filterSettings),this.treeGrid.dataBind();break;case"allowResizing":this.treeGrid.allowResizing=this.allowResizing,this.treeGrid.dataBind();break;case"allowReordering":this.treeGrid.allowReordering=this.allowReordering,this.treeGrid.dataBind();break;case"gridLines":this.treeGrid.gridLines=this.gridLines,this.treeGrid.dataBind(),this.renderChartGridLines();break;case"tooltipSettings":this.tooltipModule.toolTipObj&&this.tooltipModule.toolTipObj.destroy(),this.tooltipModule.createTooltip();break;case"splitterSettings":this.splitterModule.updateSplitterPosition();break;case"selectionSettings":this.treeGrid.selectionSettings=r.getActualProperties(this.selectionSettings),this.treeGrid.dataBind();break;case"searchSettings":this.treeGrid.grid.searchSettings=r.getActualProperties(this.searchSettings),this.treeGrid.grid.dataBind(),this.toolbarModule&&this.toolbarModule.updateSearchTextBox();break;case"labelSettings":case"renderBaseline":case"baselineColor":this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"resourceIDMapping":case"resourceNameMapping":case"resources":this.dataOperation.reUpdateResources(),this.treeGrid.refreshColumns(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"includeWeekend":case"dayWorkingTime":case"allowUnscheduledTasks":case"holidays":"holidays"===s&&(this.totalHolidayDates=this.dataOperation.getHolidayDates(),this.notify("ui-update",{module:"day-markers",properties:e})),this.dataOperation.reUpdateGanttData(),this.treeGrid.refreshColumns(),this.chartRowsModule.initiateTemplates(),this.chartRowsModule.refreshGanttRows();break;case"addDialogFields":case"editDialogFields":this.editModule&&this.editModule.dialogModule&&this.editModule.dialogModule.processDialogFields();break;case"columns":this.treeGridModule.treeGridColumns=[],this.treeGridModule.validateGanttColumns(),this.treeGrid.columns=this.treeGridModule.treeGridColumns,this.chartRowsModule.initiateTemplates(),this.timelineModule.updateChartByNewTimeline();break;case"width":case"height":this.reUpdateDimention();break;case"editSettings":this.treeGrid.editSettings.allowAdding=this.editSettings.allowAdding,this.treeGrid.editSettings.allowDeleting=this.editSettings.allowDeleting,this.treeGrid.editSettings.showDeleteConfirmDialog=this.editSettings.showDeleteConfirmDialog,this.treeGrid.editSettings.allowEditing=this.editSettings.allowEditing,t.isNullOrUndefined(this.editModule)||this.editModule.reUpdateEditModules(),t.isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems();break;case"connectorLineBackground":case"connectorLineWidth":this.taskFields.dependency&&(this.connectorLineModule.initPublicProp(),this.ganttChartModule.reRenderConnectorLines());break;case"treeColumnIndex":this.treeGrid.treeColumnIndex=this.treeColumnIndex;break;case"projectStartDate":case"projectEndDate":this.dataOperation.calculateProjectDates(),this.updateProjectDates(this.cloneProjectStartDate,this.cloneProjectEndDate,this.isTimelineRoundOff);break;case"selectedRowIndex":t.isNullOrUndefined(this.selectionModule)||this.selectionModule.selectRowByIndex();break;case"dataSource":this.closeGanttActions(),this.dataOperation.checkDataBinding(!0);break;case"enableContextMenu":case"contextMenuItems":this.enableContextMenu||"contextMenuItems"===s?this.notify("reRender-contextMenu",{module:"contextMenu",enable:this.contextMenuItems}):this.treeGrid.contextMenuItems=[],this.treeGrid.dataBind();break;case"currencyCode":case"locale":case"enableRtl":n=!0}}n&&this.refresh()},n.prototype.getPersistData=function(){return this.addOnPersist(["allowSelection"])},n.prototype.destroy=function(){this.notify("destroy",{}),t.isNullOrUndefined(this.validationDialogElement)||this.validationDialogElement.isDestroyed||this.validationDialogElement.destroy();for(var i=["ganttChartModule","timelineModule","chartRowsModule","treeGridModule","ganttDataUpdatesModule","dateValidationModule","tooltipModule"],r=0;r<i.length;r++)this[i[r]]&&(this[i[r]]=null);e.prototype.destroy.call(this),this.chartVerticalLineContainer=null,this.element.innerHTML="",t.removeClass([this.element],"e-gantt"),this.element.innerHTML="",this.isTreeGridRendered=!1},n.prototype.getTaskbarHeight=function(){return this.chartRowsModule.taskBarHeight},n.prototype.requiredModules=function(){var e=[];return this.isDestroyed?e:(this.allowSorting&&e.push({member:"sort",args:[this]}),(this.allowFiltering||this.toolbar&&-1!==this.toolbar.indexOf("Search"))&&e.push({member:"filter",args:[this]}),this.allowReordering&&e.push({member:"reorder",args:[this]}),this.allowExcelExport&&e.push({member:"excelExport",args:[this]}),this.allowResizing&&e.push({member:"resize",args:[this]}),this.toolbar&&e.push({member:"toolbar",args:[this]}),(this.editSettings.allowAdding||this.editSettings.allowEditing||this.editSettings.allowDeleting||this.editSettings.allowTaskbarEditing)&&e.push({member:"edit",args:[this]}),this.allowSelection&&e.push({member:"selection",args:[this]}),this.tooltipSettings.showTooltip&&e.push({member:"tooltip",args:[this]}),(this.highlightWeekends||this.holidays&&this.holidays.length>0||this.eventMarkers&&this.eventMarkers.length>0)&&e.push({member:"dayMarkers",args:[this]}),this.enableContextMenu&&e.push({member:"contextMenu",args:[this]}),this.showColumnMenu&&e.push({member:"columnMenu",args:[this]}),e)},n.prototype.sortColumn=function(e,t,i){this.sortModule&&this.allowSorting&&this.sortModule.sortColumn(e,t,i)},n.prototype.clearSorting=function(){this.sortModule.clearSorting()},n.prototype.renderChartGridLines=function(){var e="e-chart-row-border",i=this.chartVerticalLineContainer,r=document.getElementById(this.element.id+"GanttTaskTableBody").querySelectorAll("td");if("Vertical"===this.gridLines){if(t.isNullOrUndefined(i)?this.renderChartVerticalLines():"none"===i.style.display&&(i.style.display="block"),r[0].classList.contains(e))for(var n=0;n<r.length;n++)t.removeClass([r[n]],e)}else if("Horizontal"===this.gridLines){if(t.isNullOrUndefined(i)||(i.style.display="none"),!r[0].classList.contains(e))for(n=0;n<r.length;n++)t.addClass([r[n]],e)}else if("Both"===this.gridLines){if(t.isNullOrUndefined(i)?this.renderChartVerticalLines():"none"===i.style.display&&(i.style.display="block"),!r[0].classList.contains(e))for(n=0;n<r.length;n++)t.addClass([r[n]],e)}else if("None"===this.gridLines&&(t.isNullOrUndefined(i)||"none"===i.style.display||(i.style.display="none"),r[0].classList.contains(e)))for(n=0;n<r.length;n++)t.removeClass([r[n]],e)},n.prototype.updateGridLineContainerHeight=function(){this.chartVerticalLineContainer&&(this.chartVerticalLineContainer.style.height=t.formatUnit(this.contentHeight))},n.prototype.reUpdateDimention=function(){var e=0;this.calculateDimensions(),t.isNullOrUndefined(this.toolbarModule)||t.isNullOrUndefined(this.toolbarModule.element)||(this.toolbarModule.toolbar.refresh(),this.toolbarModule.refreshToolbarItems(),e=this.toolbarModule.element.offsetHeight),this.treeGrid.height=this.ganttHeight-e-this.treeGrid.grid.getHeaderContent().offsetHeight,this.splitterModule.splitterObject.height=(this.ganttHeight-e).toString(),this.splitterModule.splitterObject.width=this.ganttWidth.toString(),this.ganttChartModule.scrollObject.setHeight(this.ganttHeight-this.ganttChartModule.chartTimelineContainer.offsetHeight-e)},n.prototype.renderChartVerticalLines=function(){this.element.contains(this.chartVerticalLineContainer)||(this.chartVerticalLineContainer=t.createElement("div",{id:this.element.id+"line-container",styles:"position:absolute;height:100%;z-index:1"}),this.element.getElementsByClassName("e-chart-rows-container")[0].appendChild(this.chartVerticalLineContainer)),this.chartVerticalLineContainer.innerHTML="";var e=this.element.getElementsByClassName("e-timeline-header-table-container")[1];t.isNullOrUndefined(e)&&(e=this.element.getElementsByClassName("e-timeline-header-table-container")[0]);for(var i,r=e.getElementsByTagName("th"),n=r.length,a=0,o=t.createElement("div"),s=0;s<n;s++){a=0===s?-1:a+parseFloat(i),i=r[s].style.width;var l=t.createElement("div",{className:"e-line-container-cell",styles:"left:"+a+"px"});o.appendChild(l)}this.chartVerticalLineContainer.innerHTML=o.innerHTML},n.prototype.getDefaultLocale=function(){return{emptyRecord:"No records to display",id:"ID",name:"Name",startDate:"Start Date",endDate:"End Date",duration:"Duration",progress:"Progress",dependency:"Dependency",notes:"Notes",baselineStartDate:"Baseline Start Date",baselineEndDate:"Baseline End Date",type:"Type",offset:"Offset",resourceName:"Resources",resourceID:"Resource ID",day:"day",hour:"hour",minute:"minute",days:"days",hours:"hours",minutes:"minutes",generalTab:"General",customTab:"Custom Columns",writeNotes:"Write Notes",addDialogTitle:"New Task",editDialogTitle:"Task Information",add:"Add",edit:"Edit",update:"Update",delete:"Delete",cancel:"Cancel",search:"Search",task:" task",tasks:" tasks",zoomIn:"Zoom in",zoomOut:"Zoom out",zoomToFit:"Zoom to fit",excelExport:"Excel export",csvExport:"CSV export",expandAll:"Expand all",collapseAll:"Collapse all",nextTimeSpan:"Next timespan",prevTimeSpan:"Previous timespan",saveButton:"Save",taskBeforePredecessor_FS:'You moved "{0}" to start before "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_FS:'You moved "{0}" away from "{1}" and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_SS:'You moved "{0}" to start before "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_SS:'You moved "{0}" to start after "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_FF:'You moved "{0}" to finish before "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_FF:'You moved "{0}" to finish after "{1}" finishes and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskBeforePredecessor_SF:'You moved "{0}" away from "{1}" to starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',taskAfterPredecessor_SF:'You moved "{0}" to finish after "{1}" starts and the two tasks are linked.As the result, the links cannot be honored. Select one action below to perform',okText:"Ok",confirmDelete:"Are you sure you want to Delete Record?",from:"From",to:"To",taskLink:"Task Link",lag:"Lag",start:"Start",finish:"Finish",enterValue:"Enter the value",taskInformation:"Task Information",deleteTask:"Delete Task",deleteDependency:"Delete Dependency",convert:"Convert",save:"Save",above:"Above",below:"Below",child:"Child",milestone:"Milestone",toTask:"To Task",toMilestone:"To Milestone",eventMarkers:"Event markers",leftTaskLabel:"Left task label",rightTaskLabel:"Right task label",timelineCell:"Timeline cell",confirmPredecessorDelete:"Are you sure you want to remove dependency link?"}},n.prototype.removeSortColumn=function(e){this.sortModule.removeSortColumn(e)},n.prototype.actionBeginTask=function(e){this.trigger("actionBegin",e)},n.prototype.scrollToDate=function(e){var t=this.dateValidationModule.getDateFromFormat(e),i=this.dataOperation.getTaskLeft(t,!1);this.ganttChartModule.updateScrollLeft(i)},n.prototype.scrollToTask=function(e){if(-1!==this.ids.indexOf(e)){var t=this.flatData[this.ids.indexOf(e)].ganttProperties.left;this.ganttChartModule.updateScrollLeft(t)}},n.prototype.updateChartScrollOffset=function(e,i){t.isNullOrUndefined(e)||(e=this.ganttChartModule.scrollElement.scrollWidth<=e?this.ganttChartModule.scrollElement.scrollWidth:e,this.ganttChartModule.scrollObject.setScrollLeft(e)),t.isNullOrUndefined(i)||(i=this.ganttChartModule.scrollElement.scrollHeight<=i?this.ganttChartModule.scrollElement.scrollHeight:i,this.ganttChartModule.scrollObject.setScrollTop(i))},n.prototype.getParentTask=function(e){if(t.isNullOrUndefined(e))return null;var i=this.flatData.filter(function(t){return e.uniqueID===t.uniqueID});return i.length>0?i[0]:null},n.prototype.filterByColumn=function(e,t,i,r,n,a){this.treeGrid.filterByColumn(e,t,i,r,n,a)},n.prototype.excelExport=function(e,t,i,r){return this.excelExportModule?this.treeGrid.excelExport(e,t,i,r):null},n.prototype.csvExport=function(e,t,i,r){return this.excelExportModule?this.treeGrid.csvExport(e,t,i,r):null},n.prototype.clearFiltering=function(){this.treeGrid.clearFiltering()},n.prototype.removeFilteredColsByField=function(e){this.treeGrid.removeFilteredColsByField(e,!1)},n.prototype.renderWorkingDayCell=function(e){var t=this.includeWeekend?[]:this.nonWorkingDayIndex,i=this.totalHolidayDates;if(t.length>0&&-1!==t.indexOf(e.date.getDay()))e.isDisabled=!0;else if(i.length>0){var r=new Date(e.date.getTime());r.setHours(0,0,0),-1!==i.indexOf(r.getTime())&&(e.isDisabled=!0)}},n.prototype.previousTimeSpan=function(e){this.timelineModule.performTimeSpanAction("prevTimeSpan","publicMethod",new Date(this.timelineModule.timelineStartDate.getTime()),new Date(this.timelineModule.timelineEndDate.getTime()),e)},n.prototype.nextTimeSpan=function(e){this.timelineModule.performTimeSpanAction("nextTimeSpan","publicMethod",new Date(this.timelineModule.timelineStartDate.getTime()),new Date(this.timelineModule.timelineEndDate.getTime()),e)},n.prototype.updateProjectDates=function(e,i,r,n){t.isBlazor()&&(e=this.dataOperation.getDateFromFormat(e),i=this.dataOperation.getDateFromFormat(i)),this.timelineModule.totalTimelineWidth=0,this.cloneProjectStartDate=e,this.cloneProjectEndDate=i,this.isTimelineRoundOff=r,this.timelineModule.refreshTimelineByTimeSpan(),this.dataOperation.reUpdateGanttDataPosition(),this.timelineModule.updateChartByNewTimeline(),this.ganttChartModule.chartBodyContent.style.width=t.formatUnit(this.timelineModule.totalTimelineWidth),this.ganttChartModule.updateLastRowBottomWidth(),"Vertical"!==this.gridLines&&"Both"!==this.gridLines||this.renderChartVerticalLines(),this.taskFields.dependency&&this.ganttChartModule.reRenderConnectorLines(),"beforeAdd"!==n&&this.notify("selectRowByIndex",{})},n.prototype.reorderColumns=function(e,t){this.treeGrid.reorderColumns(e,t)},n.prototype.initiateEditAction=function(e){this.isOnEdit=e,this.previousRecords={},this.editedRecords=[]},n.prototype.setRecordValue=function(e,i,r,n){if(this.isOnEdit||this.isOnDelete){this.makeCloneData(e,r,n);var a=n?r.taskId:r.ganttProperties.taskId,o=this.getRecordByID(a);o&&-1===this.editedRecords.indexOf(o)&&this.editedRecords.push(o)}i=t.isUndefined(i)?null:i,t.setValue(e,i,r)},n.prototype.makeCloneData=function(e,i,r){var n,a,o,s=t.getValue(e,i);if(r&&(e="ganttProperties."+e),t.isNullOrUndefined(this.previousRecords[i.uniqueID])){this.previousRecords[i.uniqueID]={}}n=this.previousRecords[i.uniqueID],a=t.getValue(e,n),t.isUndefined(a)&&(o=s instanceof Date?new Date(s.getTime()):t.isObjectArray(s)?t.extend([],s,[],!0):t.isObject(s)?t.extend({},{},s,!0):s,t.isUndefined(o)?t.setValue(e,null,n):t.setValue(e,o,n))},n.prototype.closeGanttActions=function(){this.editModule&&(this.editModule.cellEditModule&&this.editModule.cellEditModule.isCellEdit?(this.treeGrid.closeEdit(),this.editModule.cellEditModule.isCellEdit=!1,t.isNullOrUndefined(this.toolbarModule)||this.toolbarModule.refreshToolbarItems()):this.editModule.dialogModule&&this.editModule.dialogModule.dialogObj&&this.editModule.dialogModule.dialogObj.visible&&(this.editModule.dialogModule.dialogObj.hide(),this.editModule.dialogModule.dialogClose()))},n.prototype.getTaskByUniqueID=function(e){var t=this.flatData.filter(function(t){return t.uniqueID===e});return t.length>0?t[0]:null},n.prototype.getRecordByID=function(e){return t.isNullOrUndefined(e)?null:this.flatData[this.ids.indexOf(e.toString())]},n.prototype.setSplitterPosition=function(e,t){var i={};i[t]=e;var r=this.splitterModule.calculateSplitterPosition(i,!0),n=this.splitterModule.splitterObject.element.querySelectorAll(".e-pane")[0],a=this.splitterModule.splitterObject.element.querySelectorAll(".e-pane")[1];this.splitterModule.splitterPreviousPositionGrid=n.scrollWidth+1+"px",this.splitterModule.splitterPreviousPositionChart=a.scrollWidth+1+"px",this.splitterModule.splitterObject.paneSettings[0].size=r,this.splitterModule.triggerCustomResizedEvent()},n.prototype.expandByIndex=function(e){var t=this.contructExpandCollapseArgs(null,e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.expandGanttRow(t)},n.prototype.expandByID=function(e){var t=this.contructExpandCollapseArgs(e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.expandGanttRow(t)},n.prototype.collapseByIndex=function(e){var t=this.contructExpandCollapseArgs(null,e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.collapseGanttRow(t)},n.prototype.collapseByID=function(e){var t=this.contructExpandCollapseArgs(e);this.ganttChartModule.isExpandCollapseFromChart=!0,this.ganttChartModule.collapseGanttRow(t)},n.prototype.addRecord=function(e,t,i){this.editModule&&this.editSettings.allowAdding&&this.editModule.addRecord(e,t,i)},n.prototype.updateRecordByID=function(e){this.editModule&&this.editSettings.allowEditing&&this.editModule.updateRecordByID(e)},n.prototype.zoomIn=function(){this.timelineModule.processZooming(!0)},n.prototype.zoomOut=function(){this.timelineModule.processZooming(!1)},n.prototype.fitToProject=function(){this.timelineModule.processZoomToFit(),this.ganttChartModule.updateScrollLeft(0)},n.prototype.updateRecordByIndex=function(e,i){if(this.editModule&&this.editSettings.allowEditing){var r=void 0,n=this.taskFields;r=this.currentViewData.length>0?t.isNullOrUndefined(this.currentViewData[e])?null:this.currentViewData[e]:null,t.isNullOrUndefined(r)||(i[n.id]=r[n.id],this.editModule.updateRecordByID(i))}},n.prototype.addPredecessor=function(e,i){var r=this.getRecordByID(e.toString());this.editModule&&!t.isNullOrUndefined(r)&&this.editSettings.allowTaskbarEditing&&this.connectorLineEditModule.addPredecessor(r,i)},n.prototype.removePredecessor=function(e){var i=this.getRecordByID(e.toString());this.editModule&&!t.isNullOrUndefined(i)&&this.editSettings.allowTaskbarEditing&&this.connectorLineEditModule.removePredecessor(i)},n.prototype.updatePredecessor=function(e,i){var r=this.getRecordByID(e.toString());this.editModule&&!t.isNullOrUndefined(r)&&this.editSettings.allowTaskbarEditing&&this.connectorLineEditModule.updatePredecessor(r,i)},n.prototype.openAddDialog=function(){this.editModule&&this.editModule.dialogModule&&this.editSettings.allowAdding&&this.editModule.dialogModule.openAddDialog()},n.prototype.openEditDialog=function(e){this.editModule&&this.editModule.dialogModule&&this.editSettings.allowEditing&&this.editModule.dialogModule.openEditDialog(e)},n.prototype.contructExpandCollapseArgs=function(e,i){var r,n,a;t.isNullOrUndefined(i)?(n=this.getRecordByID(e.toString()),r=this.getRowByID(e),a=t.getValue("rowIndex",r)):t.isNullOrUndefined(i)||(r=this.getRowByIndex(i),a=t.getValue("rowIndex",r),n=this.currentViewData[a]);return{data:n,gridRow:this.treeGrid.getRows()[a],chartRow:r,cancel:!1}},n.prototype.getRowByIndex=function(e){try{var i=this.element.querySelectorAll(".e-chart-row");return t.isNullOrUndefined(e)?null:i[e]}catch(e){return null}},n.prototype.getRowByID=function(e){var t=this.getRecordByID(e.toString()),i=this.currentViewData.indexOf(t);return-1!==i?this.getRowByIndex(i):null},n.prototype.getUnscheduledTaskClass=function(e){return t.isNullOrUndefined(e.startDate)&&t.isNullOrUndefined(e.endDate)&&t.isNullOrUndefined(e.duration)?" "+_:t.isNullOrUndefined(e.startDate)||t.isNullOrUndefined(e.endDate)||t.isNullOrUndefined(e.duration)?" "+_:""},n.prototype.createGanttPopUpElement=function(){var e=this.createElement("div",{className:"e-ganttpopup",styles:"display:none;"}),i=this.createElement("div",{className:"e-content",attrs:{tabIndex:"-1"}});t.append([i,this.createElement("div",{className:"e-uptail e-tail"})],e),i.appendChild(this.createElement("span")),t.append([i,this.createElement("div",{className:"e-downtail e-tail"})],e),document.getElementById(this.element.id+"GanttChart").appendChild(e)},n.prototype.getPredecessorTextValue=function(e){var t;switch(e){case"SS":t=this.localeObj.getConstant("start")+"-"+this.localeObj.getConstant("start");break;case"FF":t=this.localeObj.getConstant("finish")+"-"+this.localeObj.getConstant("finish");break;case"SF":t=this.localeObj.getConstant("start")+"-"+this.localeObj.getConstant("finish");break;case"FS":t=this.localeObj.getConstant("finish")+"-"+this.localeObj.getConstant("start")}return t},n.prototype.search=function(e){this.filterModule&&(this.searchSettings.key=e,this.dataBind())},n.prototype.getOffsetRect=function(e){var t=e.getBoundingClientRect(),i=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,r=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.clientTop||document.body.clientTop||0,a=document.documentElement.clientLeft||document.body.clientLeft||0,o=t.top+i-n,s=t.left+r-a;return{top:Math.round(o),left:Math.round(s)}},n.prototype.expandAll=function(){this.ganttChartModule.expandCollapseAll("expand")},n.prototype.updateDataSource=function(e,i){if(!t.isNullOrUndefined(i))for(var r=0,n=Object.keys(i);r<n.length;r++){var a=n[r];switch(a){case"projectStartDate":this.setProperties({projectStartDate:i[a]},!0);break;case"projectEndDate":this.setProperties({projectEndDate:i[a]},!0)}}this.dataSource=e},n.prototype.collapseAll=function(){this.ganttChartModule.expandCollapseAll("collapse")},n.prototype.getGridColumns=function(){return this.treeGrid.getColumns()},n.prototype.getColumnByField=function(e,t){var i=t.filter(function(t){return t.field===e});return i.length>0?i[0]:null},n.prototype.getGanttColumns=function(){return this.ganttColumns},n.prototype.showColumn=function(e,t){this.treeGrid.showColumns(e,t)},n.prototype.hideColumn=function(e,t){this.treeGrid.hideColumns(e,t)},n.prototype.setScrollTop=function(e){this.ganttChartModule.scrollObject.setScrollTop(e)},n.prototype.cancelEdit=function(){this.closeGanttActions()},n.prototype.selectCell=function(e,t){this.selectionModule&&this.selectionModule.selectCell(e,t)},n.prototype.selectCells=function(e){this.selectionModule&&this.selectionModule.selectCells(e)},n.prototype.selectRow=function(e,t){this.selectionModule&&this.selectionModule.selectRow(e,t)},n.prototype.selectRows=function(e){this.selectionModule&&this.selectionModule.selectRows(e)},n.prototype.deleteRecord=function(e){this.editModule&&this.editModule.deleteRecord(e)},n.prototype.enableItems=function(e,t){this.toolbarModule&&this.toolbarModule.enableItems(e,t)},n.prototype.clearSelection=function(){this.selectionModule&&this.selectionModule.clearSelection()},n.prototype.updateDataArgs=function(e){if(!Array.isArray(e.data)){var i=[];i.push(e.data),t.setValue("data",i,e)}return e},St([t.Property(!0)],n.prototype,"allowKeyboard",void 0),St([t.Property(!0)],n.prototype,"autoFocusTasks",void 0),St([t.Property(!0)],n.prototype,"allowSelection",void 0),St([t.Property(!1)],n.prototype,"allowSorting",void 0),St([t.Property(!0)],n.prototype,"enablePredecessorValidation",void 0),St([t.Property(!1)],n.prototype,"showColumnMenu",void 0),St([t.Property()],n.prototype,"columnMenuItems",void 0),St([t.Property(!1)],n.prototype,"collapseAllParentTasks",void 0),St([t.Property(!1)],n.prototype,"highlightWeekends",void 0),St([t.Property(0)],n.prototype,"treeColumnIndex",void 0),St([t.Property([])],n.prototype,"dataSource",void 0),St([t.Property("day")],n.prototype,"durationUnit",void 0),St([t.Property(null)],n.prototype,"query",void 0),St([t.Property("MM/dd/yyyy")],n.prototype,"dateFormat",void 0),St([t.Property("auto")],n.prototype,"height",void 0),St([t.Property(!1)],n.prototype,"renderBaseline",void 0),St([t.Property("Horizontal")],n.prototype,"gridLines",void 0),St([t.Complex({},Ze)],n.prototype,"labelSettings",void 0),St([t.Property(null)],n.prototype,"taskbarTemplate",void 0),St([t.Property(null)],n.prototype,"parentTaskbarTemplate",void 0),St([t.Property(null)],n.prototype,"milestoneTemplate",void 0),St([t.Property()],n.prototype,"baselineColor",void 0),St([t.Property("auto")],n.prototype,"width",void 0),St([t.Property()],n.prototype,"toolbar",void 0),St([t.Property(["Monday","Tuesday","Wednesday","Thursday","Friday"])],n.prototype,"workWeek",void 0),St([t.Property(!1)],n.prototype,"includeWeekend",void 0),St([t.Property(!1)],n.prototype,"allowUnscheduledTasks",void 0),St([t.Property(!1)],n.prototype,"showInlineNotes",void 0),St([t.Property(36)],n.prototype,"rowHeight",void 0),St([t.Property(null)],n.prototype,"taskbarHeight",void 0),St([t.Property(null)],n.prototype,"projectStartDate",void 0),St([t.Property(null)],n.prototype,"projectEndDate",void 0),St([t.Property(null)],n.prototype,"resourceIDMapping",void 0),St([t.Property(null)],n.prototype,"resourceNameMapping",void 0),St([t.Property([])],n.prototype,"resources",void 0),St([t.Property(null)],n.prototype,"connectorLineBackground",void 0),St([t.Property(1)],n.prototype,"connectorLineWidth",void 0),St([t.Property([])],n.prototype,"columns",void 0),St([t.Property([])],n.prototype,"addDialogFields",void 0),St([t.Property([])],n.prototype,"editDialogFields",void 0),St([t.Property(-1)],n.prototype,"selectedRowIndex",void 0),St([t.Collection([{from:8,to:12},{from:13,to:17}],Me)],n.prototype,"dayWorkingTime",void 0),St([t.Collection([],ze)],n.prototype,"holidays",void 0),St([t.Collection([],Ne)],n.prototype,"eventMarkers",void 0),St([t.Complex({},nt)],n.prototype,"taskFields",void 0),St([t.Complex({},lt)],n.prototype,"timelineSettings",void 0),St([t.Complex({},ft)],n.prototype,"sortSettings",void 0),St([t.Complex({},Ve)],n.prototype,"editSettings",void 0),St([t.Complex({},ht)],n.prototype,"tooltipSettings",void 0),St([t.Complex({},$e)],n.prototype,"selectionSettings",void 0),St([t.Property(!1)],n.prototype,"allowFiltering",void 0),St([t.Property(!1)],n.prototype,"allowExcelExport",void 0),St([t.Property(!1)],n.prototype,"allowReordering",void 0),St([t.Property(!1)],n.prototype,"allowResizing",void 0),St([t.Property(!1)],n.prototype,"enableContextMenu",void 0),St([t.Property()],n.prototype,"contextMenuItems",void 0),St([t.Complex({},je)],n.prototype,"filterSettings",void 0),St([t.Complex({},Ge)],n.prototype,"searchSettings",void 0),St([t.Complex({},tt)],n.prototype,"splitterSettings",void 0),St([t.Event()],n.prototype,"queryTaskbarInfo",void 0),St([t.Event()],n.prototype,"beforeExcelExport",void 0),St([t.Event()],n.prototype,"excelExportComplete",void 0),St([t.Event()],n.prototype,"excelQueryCellInfo",void 0),St([t.Event()],n.prototype,"excelHeaderQueryCellInfo",void 0),St([t.Event()],n.prototype,"collapsing",void 0),St([t.Event()],n.prototype,"collapsed",void 0),St([t.Event()],n.prototype,"expanding",void 0),St([t.Event()],n.prototype,"expanded",void 0),St([t.Event()],n.prototype,"actionBegin",void 0),St([t.Event()],n.prototype,"actionComplete",void 0),St([t.Event()],n.prototype,"actionFailure",void 0),St([t.Event()],n.prototype,"taskbarEdited",void 0),St([t.Event()],n.prototype,"endEdit",void 0),St([t.Event()],n.prototype,"cellEdit",void 0),St([t.Event()],n.prototype,"load",void 0),St([t.Event()],n.prototype,"created",void 0),St([t.Event()],n.prototype,"destroyed",void 0),St([t.Event()],n.prototype,"taskbarEditing",void 0),St([t.Event()],n.prototype,"dataBound",void 0),St([t.Event()],n.prototype,"resizeStart",void 0),St([t.Event()],n.prototype,"resizing",void 0),St([t.Event()],n.prototype,"resizeStop",void 0),St([t.Event()],n.prototype,"splitterResizeStart",void 0),St([t.Event()],n.prototype,"splitterResizing",void 0),St([t.Event()],n.prototype,"splitterResized",void 0),St([t.Event()],n.prototype,"columnDragStart",void 0),St([t.Event()],n.prototype,"columnDrag",void 0),St([t.Event()],n.prototype,"columnDrop",void 0),St([t.Event()],n.prototype,"beforeTooltipRender",void 0),St([t.Event()],n.prototype,"rowSelecting",void 0),St([t.Event()],n.prototype,"rowSelected",void 0),St([t.Event()],n.prototype,"rowDeselecting",void 0),St([t.Event()],n.prototype,"rowDeselected",void 0),St([t.Event()],n.prototype,"cellSelecting",void 0),St([t.Event()],n.prototype,"cellSelected",void 0),St([t.Event()],n.prototype,"cellDeselecting",void 0),St([t.Event()],n.prototype,"cellDeselected",void 0),St([t.Event()],n.prototype,"queryCellInfo",void 0),St([t.Event()],n.prototype,"headerCellInfo",void 0),St([t.Event()],n.prototype,"rowDataBound",void 0),St([t.Event()],n.prototype,"columnMenuOpen",void 0),St([t.Event()],n.prototype,"toolbarClick",void 0),St([t.Event()],n.prototype,"columnMenuClick",void 0),St([t.Event()],n.prototype,"contextMenuOpen",void 0),St([t.Event()],n.prototype,"contextMenuClick",void 0),n=St([t.NotifyPropertyChanges],n)}(t.Component),wt=function(){function e(e){this.isCellEdit=!1,this.parent=e,this.bindTreeGridProperties()}return e.prototype.bindTreeGridProperties=function(){this.parent.treeGrid.editSettings.allowEditing=this.parent.editSettings.allowEditing,this.parent.treeGrid.editSettings.mode="Cell",this.parent.treeGrid.cellEdit=this.ensureEditCell.bind(this),this.parent.editSettings.allowEditing&&a.TreeGrid.Inject(a.Edit)},e.prototype.ensureEditCell=function(e){var i=this,r=e.rowData,a=e.columnName,o=this.parent.taskFields;if("Dialog"!==this.parent.editSettings.mode){if(!r.hasChildRecords||a!==o.endDate&&a!==o.duration&&a!==o.dependency&&a!==o.progress){var s=new n.Deferred;return this.parent.trigger("cellEdit",e,function(e){t.isBlazor()&&(e.cell=t.getElement(e.cell),e.row=t.getElement(e.row)),s.resolve(e),e.cancel||(i.isCellEdit=!0,t.isNullOrUndefined(i.parent.toolbarModule)||i.parent.toolbarModule.refreshToolbarItems(),e.columnName===i.parent.taskFields.notes&&i.openNotesEditor(e))}),s}e.cancel=!0}else e.cancel=!0},e.prototype.openNotesEditor=function(e){var t=this.parent.taskFields,i=e.rowData;if(e.columnName===t.notes&&!this.parent.showInlineNotes){e.cancel=!0;var r=this.parent.editModule.dialogModule.updatedEditFields.map(function(e){return e.type}).indexOf("Notes");if(-1!==r){this.parent.editModule.dialogModule.openEditDialog(i.ganttProperties.taskId);document.getElementById(this.parent.element.id+"_Tab").ej2_instances[0].selectedItem=r}}},e.prototype.isValueChange=function(e,i){var r=t.getValue("data",e),n=r[i],a=t.getValue("previousData",e);if(t.isNullOrUndefined(n)&&!t.isNullOrUndefined(a)||!t.isNullOrUndefined(n)&&t.isNullOrUndefined(a))return!0;if(!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(a)){if(n instanceof Date)return n.getTime()!==r.taskData[i].getTime();if(i===this.parent.taskFields.resourceInfo)return n!==a;if(n!==r.taskData[i])return!0}return!1},e.prototype.initiateCellEdit=function(e,i){var r=t.getValue("column",e),n=t.getValue("data",e),a={};a.action="CellEditing",a.data=this.parent.getTaskByUniqueID(n.uniqueID);var o=t.getValue("previousData",e),s="stringedit"===r.editType&&"Duration"===r.field?""!==n[r.field]:!t.isNullOrUndefined(n[r.field]),l=this.parent.allowUnscheduledTasks?n[r.field]:s?n[r.field]:o;t.isNullOrUndefined(n)?this.parent.editModule.endEditAction(e):(n[r.field]=o,a.data[r.field]=o,this.parent.initiateEditAction(!0),this.parent.setRecordValue(r.field,l,a.data),r.field===this.parent.taskFields.name?this.taskNameEdited(a):r.field===this.parent.taskFields.startDate?this.startDateEdited(a):r.field===this.parent.taskFields.endDate?this.endDateEdited(a):r.field===this.parent.taskFields.duration?this.durationEdited(a):r.field===this.parent.taskFields.resourceInfo?this.resourceEdited(a,i):r.field===this.parent.taskFields.progress?this.progressEdited(a):r.field===this.parent.taskFields.baselineStartDate||r.field===this.parent.taskFields.baselineEndDate?this.baselineEdited(a):r.field===this.parent.taskFields.dependency?this.dependencyEdited(a,o):r.field===this.parent.taskFields.notes?this.notedEdited(a):(this.parent.setRecordValue("taskData."+r.field,a.data[r.field],a.data),this.parent.editModule.initiateSaveAction(a))),this.isCellEdit=!1,t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.taskNameEdited=function(e){this.parent.setRecordValue("taskData."+this.parent.taskFields.name,e.data[this.parent.taskFields.name],e.data),this.parent.setRecordValue("taskName",e.data[this.parent.taskFields.name],e.data.ganttProperties,!0),this.updateEditedRecord(e)},e.prototype.notedEdited=function(e){this.parent.setRecordValue("taskData."+this.parent.taskFields.notes,e.data[this.parent.taskFields.name],e.data),this.parent.setRecordValue("notes",e.data[this.parent.taskFields.notes],e.data.ganttProperties,!0),this.updateEditedRecord(e)},e.prototype.startDateEdited=function(e){var i=e.data,r=e.data.ganttProperties,n=e.data[this.parent.taskFields.startDate];n=n?new Date(n.getTime()):null,n=this.parent.dateValidationModule.checkStartDate(n),t.isNullOrUndefined(n)?i.hasChildRecords||(this.parent.setRecordValue("startDate",null,r,!0),this.parent.setRecordValue("duration",null,r,!0),this.parent.setRecordValue("isMilestone",!1,r,!0)):r.endDate||!t.isNullOrUndefined(r.duration)?(this.parent.setRecordValue("startDate",new Date(n.getTime()),r,!0),this.parent.dateValidationModule.calculateEndDate(i)):t.isNullOrUndefined(r.endDate)&&t.isNullOrUndefined(r.duration)&&this.parent.setRecordValue("startDate",new Date(n.getTime()),r,!0),this.parent.setRecordValue("isMilestone",0===r.duration,r,!0),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(i,"startDate"),this.parent.dataOperation.updateMappingData(i,"endDate"),this.parent.dataOperation.updateMappingData(i,"duration"),this.updateEditedRecord(e)},e.prototype.endDateEdited=function(e){var i=e.data.ganttProperties,r=e.data[this.parent.taskFields.endDate];r=r?new Date(r.getTime()):null,t.isNullOrUndefined(r)?(this.parent.setRecordValue("endDate",r,i,!0),this.parent.setRecordValue("duration",null,i,!0),this.parent.setRecordValue("isMilestone",!1,i,!0)):(0===r.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,r),r=this.parent.dateValidationModule.checkEndDate(r,i),this.parent.setRecordValue("endDate",r,i,!0),!t.isNullOrUndefined(i.startDate)&&t.isNullOrUndefined(i.duration)?-1===this.parent.dateValidationModule.compareDates(i.endDate,i.startDate)&&(this.parent.setRecordValue("endDate",new Date(i.startDate.getTime()),i,!0),this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,i.endDate)):!t.isNullOrUndefined(i.duration)&&t.isNullOrUndefined(i.startDate)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(i.endDate,i.duration,i.durationUnit,i),i,!0),-1===this.compareDatesFromRecord(i)?this.parent.dateValidationModule.calculateDuration(e.data):this.parent.editModule.revertCellEdit(e),this.parent.setRecordValue("isMilestone",0===i.duration,i,!0),i.isMilestone&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(i.startDate,i),i,!0),this.parent.dataOperation.updateWidthLeft(e.data)),this.parent.dataOperation.updateMappingData(e.data,"startDate"),this.parent.dataOperation.updateMappingData(e.data,"endDate"),this.parent.dataOperation.updateMappingData(e.data,"duration"),this.updateEditedRecord(e)},e.prototype.durationEdited=function(e){var i=e.data.ganttProperties,r=this.parent.dateValidationModule.getDateFromFormat(i.endDate),n=this.parent.dateValidationModule.getDateFromFormat(i.startDate),a=e.data[this.parent.taskFields.duration];this.parent.dataOperation.updateDurationValue(a,i);var o=i.duration;t.isNullOrUndefined(o)?(this.parent.setRecordValue("isMilestone",!1,i,!0),this.parent.setRecordValue("endDate",null,i,!0)):(t.isNullOrUndefined(n)&&!t.isNullOrUndefined(r)&&this.parent.setRecordValue("startDate",this.parent.dateValidationModule.getStartDate(r,o,i.durationUnit,i),i,!0),0!==o&&i.isMilestone&&(this.parent.setRecordValue("isMilestone",!1,i,!0),this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(i.startDate,i),i,!0)),this.parent.setRecordValue("isMilestone",0===i.duration,i,!0),this.parent.dateValidationModule.calculateEndDate(e.data)),this.parent.dataOperation.updateWidthLeft(e.data),this.parent.dataOperation.updateMappingData(e.data,"endDate"),this.parent.dataOperation.updateMappingData(e.data,"startDate"),this.parent.dataOperation.updateMappingData(e.data,"duration"),this.updateEditedRecord(e)},e.prototype.progressEdited=function(e){var t=e.data;this.parent.setRecordValue("progress",t[this.parent.taskFields.progress]>100?100:t[this.parent.taskFields.progress],t.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.progress,t[this.parent.taskFields.progress]>100?100:t[this.parent.taskFields.progress],e.data),e.data.hasChildRecords||this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(t.ganttProperties.width,t.ganttProperties.progress),t.ganttProperties,!0),this.updateEditedRecord(e)},e.prototype.baselineEdited=function(e){var t=e.data.ganttProperties,i=e.data[this.parent.taskFields.baselineStartDate],r=e.data[this.parent.taskFields.baselineEndDate];r&&0===r.getHours()&&86400!==this.parent.defaultEndTime&&this.parent.dateValidationModule.setTime(this.parent.defaultEndTime,r),this.parent.setRecordValue("baselineStartDate",this.parent.dateValidationModule.checkBaselineStartDate(i),t,!0),this.parent.setRecordValue("baselineEndDate",this.parent.dateValidationModule.checkBaselineEndDate(r),t,!0),t.baselineStartDate&&t.baselineEndDate&&(this.parent.setRecordValue("baselineLeft",this.parent.dataOperation.calculateBaselineLeft(t),t,!0),this.parent.setRecordValue("baselineWidth",this.parent.dataOperation.calculateBaselineWidth(t),t,!0)),this.updateEditedRecord(e)},e.prototype.resourceEdited=function(e,t){t[this.parent.taskFields.resourceInfo]&&(e.data.ganttProperties.resourceInfo=this.parent.dataOperation.setResourceInfo(t),this.parent.dataOperation.updateMappingData(e.data,"resourceInfo"),this.updateEditedRecord(e))},e.prototype.dependencyEdited=function(e,t){this.parent.connectorLineEditModule.updatePredecessor(e.data,e.data[this.parent.taskFields.dependency])||this.parent.editModule.revertCellEdit(t)},e.prototype.compareDatesFromRecord=function(e){var t=this.parent.dateValidationModule.getValidStartDate(e),i=this.parent.dateValidationModule.getValidEndDate(e);return this.parent.dateValidationModule.compareDates(t,i)},e.prototype.updateEditedRecord=function(e){this.parent.editModule.initiateUpdateAction(e)},e.prototype.destroy=function(){this.parent.editModule.cellEditModule=void 0},e}(),Mt=function(){function e(e,t){this.parent=e,this.taskbarEdit=t}return e.prototype.createTooltip=function(e,t,r){var n=this;this.toolTipObj=new i.Tooltip({opensOn:e,content:this.getTooltipText(),position:"TopRight",mouseTrail:t,cssClass:he,target:r||null,animation:{open:{effect:"None"},close:{effect:"None"}}}),this.toolTipObj.beforeRender=function(e){var t={data:n.taskbarEdit.taskBarEditRecord,args:e,content:n.toolTipObj.content};n.parent.trigger("beforeTooltipRender",t)},this.toolTipObj.isStringTemplate=!0,this.toolTipObj.appendTo(this.parent.chartPane)},e.prototype.showHideTaskbarEditTooltip=function(e){e?(this.createTooltip("Custom",!1),this.parent.tooltipModule.toolTipObj.close(),this.updateTooltip(),"ConnectorPointLeftDrag"===this.taskbarEdit.connectorSecondAction?this.toolTipObj.open(this.taskbarEdit.connectorSecondElement.querySelector("."+ae)):"ConnectorPointRightDrag"===this.taskbarEdit.connectorSecondAction?this.toolTipObj.open(this.taskbarEdit.connectorSecondElement.querySelector("."+oe)):this.toolTipObj.open(this.taskbarEdit.taskBarEditElement)):t.isNullOrUndefined(this.toolTipObj)||(this.toolTipObj.destroy(),this.toolTipObj=null)},e.prototype.updateTooltip=function(){t.isNullOrUndefined(this.toolTipObj)||("ConnectorPointLeftDrag"===this.taskbarEdit.taskBarEditAction||"ConnectorPointRightDrag"===this.taskbarEdit.taskBarEditAction?(this.toolTipObj.content=this.getTooltipText(),this.toolTipObj.offsetY=-3):(this.toolTipObj.content=this.getTooltipText(),this.toolTipObj.refresh(this.taskbarEdit.taskBarEditElement),"LeftResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-this.taskbarEdit.taskBarEditRecord.ganttProperties.width:"RightResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=0:"ProgressResizing"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-(this.taskbarEdit.taskBarEditRecord.ganttProperties.width-this.taskbarEdit.taskBarEditRecord.ganttProperties.progressWidth):"MilestoneDrag"===this.taskbarEdit.taskBarEditAction?this.toolTipObj.offsetX=-this.parent.chartRowsModule.milestoneHeight/2:this.taskbarEdit.taskBarEditRecord.ganttProperties.width>5&&(this.toolTipObj.offsetX=-(this.taskbarEdit.taskBarEditRecord.ganttProperties.width+this.taskbarEdit.taskBarEditRecord.ganttProperties.left-this.taskbarEdit.tooltipPositionX))))},e.prototype.getTooltipText=function(){var e="",i=this.parent.globalize,r=this.taskbarEdit.taskBarEditRecord.ganttProperties;if(this.parent.tooltipSettings.editing){e=this.parent.tooltipModule.templateCompiler(this.parent.tooltipSettings.editing,this.parent,r,"TooltipEditingTemplate")[0]}else switch(this.taskbarEdit.taskBarEditAction){case"ProgressResizing":e=this.parent.localeObj.getConstant("progress")+" : "+r.progress;break;case"LeftResizing":e=this.parent.localeObj.getConstant("startDate")+" : ",e+=i.formatDate(r.startDate,{format:this.parent.dateFormat}),e+="<br/>"+this.parent.localeObj.getConstant("duration")+" : "+this.parent.getDurationString(r.duration,r.durationUnit);break;case"RightResizing":e=this.parent.localeObj.getConstant("endDate")+" : ",e+=i.formatDate(r.endDate,{format:this.parent.dateFormat}),e+="<br/>"+this.parent.localeObj.getConstant("duration")+" : "+this.parent.getDurationString(r.duration,r.durationUnit);break;case"ChildDrag":case"ParentDrag":case"MilestoneDrag":t.isNullOrUndefined(this.taskbarEdit.taskBarEditRecord.ganttProperties.startDate)||(e=this.parent.localeObj.getConstant("startDate")+" : ",e+=i.formatDate(r.startDate,{format:this.parent.dateFormat})),t.isNullOrUndefined(this.taskbarEdit.taskBarEditRecord.ganttProperties.endDate)||(e+=""===e?"":"<br/>",e+=this.parent.localeObj.getConstant("endDate")+" : "+i.formatDate(r.endDate,{format:this.parent.dateFormat}));break;case"ConnectorPointLeftDrag":case"ConnectorPointRightDrag":e=this.parent.connectorLineModule.tooltipTable,t.isNullOrUndefined(this.toolTipObj)&&(this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"",""))}return e},e}(),Ct=function(){function e(e){this.isMouseDragged=!1,this.editElement=null,this.parent=e,this.initPublicProp(),this.wireEvents(),this.editTooltip=new Mt(this.parent,this)}return e.prototype.wireEvents=function(){this.parent.on("chartMouseDown",this.mouseDownHandler,this),this.parent.on("chartMouseUp",this.mouseUpHandler,this),this.parent.on("chartMouseLeave",this.mouseLeaveHandler,this),this.parent.on("chartMouseMove",this.mouseMoveAction,this),this.parent.on("chartMouseClick",this.mouseClickHandler,this)},e.prototype.initPublicProp=function(){this.taskBarEditElement=null,this.taskBarEditRecord=null,this.taskBarEditAction=null,this.connectorSecondElement=null,this.connectorSecondRecord=null,this.connectorSecondAction=null,this.highlightedSecondElement=null,this.fromPredecessorText=null,this.toPredecessorText=null,this.finalPredecessor=null,this.drawPredecessor=!1,this.roundOffDuration=!0,this.dragMouseLeave=!1,this.isMouseDragged=!1,this.previousItemProperty=["left","progress","duration","startDate","endDate","width","progressWidth"],this.tapPointOnFocus=!1,this.touchEdit=!1},e.prototype.mouseDownHandler=function(e){if(this.parent.editSettings.allowTaskbarEditing)if(this.canDrag=!1,this.parent.isAdaptive&&this.taskBarEditElement){var t=this.getElementByPosition(e),i=u(t,C);!i||i.innerHTML!==this.taskBarEditElement.innerHTML||t.classList.contains(ae)||t.classList.contains(oe)||this.tapPointOnFocus||(this.updateTaskBarEditElement(e),this.canDrag=!0,e.preventDefault())}else this.parent.isAdaptive||this.updateTaskBarEditElement(e)},e.prototype.mouseClickHandler=function(e){var t=this.getElementByPosition(e),i=u(t,C);this.parent.selectionModule&&this.parent.selectionModule.enableSelectMultiTouch?this.tapPointOnFocus&&this.updateTaskBarEditElement(e):this.tapPointOnFocus&&i&&i.innerHTML!==this.taskBarEditElement.innerHTML?(this.connectorSecondRecord=this.parent.ganttChartModule.getRecordByTaskBar(i),this.connectorSecondAction="ConnectorPointLeftDrag",this.connectorSecondElement=i,this.fromPredecessorText="Finish",this.validateConnectorPoint()&&this.taskBarEditingAction(e,!0),this.showHideActivePredecessors(!1),this.initPublicProp()):t.classList.contains(se)||t.classList.contains(le)?(this.canDrag=!1,this.multipleSelectionEnabled(),this.showHideTaskBarEditingElements(t,this.taskBarEditElement),this.tapPointOnFocus=!0,this.taskBarEditAction="ConnectorPointRightDrag",this.connectorSecondRecord=this.taskBarEditRecord,this.taskBarEditingAction(e,!1)):(this.tapPointOnFocus&&(this.showHideActivePredecessors(!1),this.showHideTaskBarEditingElements(i,this.taskBarEditElement)),this.updateTaskBarEditElement(e))},e.prototype.showHideActivePredecessors=function(e){var i=this.taskBarEditRecord.ganttProperties,r=i.predecessor;if(r)for(var n=0;n<r.length;n++){var a=r[n];i.taskId.toString()===a.from?this.applyActiveColor(a.from,a.to,e):i.taskId.toString()===a.to&&this.applyActiveColor(a.from,a.to,e)}var o=this.parent.ganttChartModule.chartBodyContainer;e?(t.addClass([this.taskBarEditElement],[ge]),t.addClass([o],[me])):(t.removeClass([this.taskBarEditElement],[ge]),t.removeClass([o],[me])),this.touchEdit=e,t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.applyActiveColor=function(e,i,r){var n=this.taskBarEditRecord.ganttProperties.taskId.toString()===e?this.parent.getRecordByID(i):this.parent.getRecordByID(e),a=this.parent.ganttChartModule.getChartRows()[this.parent.currentViewData.indexOf(n)];if(!t.isNullOrUndefined(a)){var o=a.querySelector("."+C),s=this.parent.element.querySelector("#ConnectorLineparent"+e+"child"+i);r?(t.addClass([o],[fe]),s&&t.addClass([s],[fe])):(t.removeClass([o],[fe]),s&&t.removeClass([s],[fe]))}},e.prototype.validateConnectorPoint=function(){var e=this.taskBarEditRecord.ganttProperties,t=this.connectorSecondRecord.ganttProperties,i=!0;if(this.connectorSecondRecord.hasChildRecords)i=!1;else if(t.predecessor)for(var r=0;r<t.predecessor.length;r++){var n=t.predecessor[r];if(n.from===e.taskId.toString()&&n.to===t.taskId.toString()){this.parent.connectorLineEditModule.childRecord=this.connectorSecondRecord,this.parent.connectorLineEditModule.predecessorIndex=r,this.parent.connectorLineEditModule.renderPredecessorDeleteConfirmDialog(),i=!1;break}if(n.from===t.taskId.toString()&&n.to===e.taskId.toString()){this.parent.connectorLineEditModule.childRecord=this.taskBarEditRecord,this.parent.connectorLineEditModule.predecessorIndex=r,this.parent.connectorLineEditModule.renderPredecessorDeleteConfirmDialog(),i=!1;break}}return i},e.prototype.mouseLeaveHandler=function(e){this.dragMouseLeave=!0},e.prototype.updateTaskBarEditElement=function(e){var i=u(this.getElementByPosition(e),C);this.parent.editSettings.allowTaskbarEditing&&i?(this.showHideTaskBarEditingElements(i,this.taskBarEditElement),this.editElement=i,this.taskBarEditElement=i,this.taskBarEditRecord=this.parent.ganttChartModule.getRecordByTaskBar(this.taskBarEditElement),e.type!==t.Browser.touchStartEvent&&e.type!==r.click||(this.roundOffDuration=!0,this.taskBarEditAction=this.getTaskBarAction(e),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!t.isNullOrUndefined(this.parent.taskFields.dependency)||(this.taskBarEditAction=null),this.updateMouseDownProperties(e))):this.parent.isAdaptive?(this.taskBarEditElement&&this.showHideTaskBarEditingElements(i,this.taskBarEditElement),this.initPublicProp()):this.showHideTaskBarEditingElements(i,this.taskBarEditElement)},e.prototype.showHideTaskBarEditingElements=function(e,i,r){if(i=i||this.editElement,e){if(e.querySelector("."+N))t.addClass([e.querySelector("."+N)],[q]),t.addClass([e.querySelector("."+U)],[z]),t.addClass([e.querySelector("."+A)],[Y]);else if(this.parent.isAdaptive){(n=this.parent.ganttChartModule.getRecordByTaskBar(e)).hasChildRecords&&t.addClass([e],[ue])}t.addClass(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+K),[ee]),!t.isNullOrUndefined(this.parent.taskFields.dependency)&&e.querySelector("."+ae)&&(t.addClass([e.querySelector("."+ae)],[se]),t.addClass([e.querySelector("."+oe)],[le]))}else r||t.removeClass(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+K),[ee]);if(i&&e!==i){if(i.querySelector("."+N)&&(t.removeClass([i.querySelector("."+N)],[q]),t.removeClass([i.querySelector("."+U)],[z]),i.querySelector("."+A)&&t.removeClass([i.querySelector("."+A)],[Y])),!t.isNullOrUndefined(this.parent.taskFields.dependency)&&i.querySelector("."+ae))t.removeClass([i.querySelector("."+ae)],[se]),t.removeClass([i.querySelector("."+oe)],[le]);else if(this.parent.isAdaptive){var n;(n=this.parent.ganttChartModule.getRecordByTaskBar(i))&&n.hasChildRecords&&t.removeClass([i],[ue])}this.editElement=null}},e.prototype.getTaskBarAction=function(e){var i=this.getElementByPosition(e),r=this.taskBarEditRecord,n="";return i.classList.contains(N)?n="LeftResizing":i.classList.contains(U)?n="RightResizing":i.classList.contains(A)||t.closest(i,"."+A)?n="ProgressResizing":i.classList.contains(ae)?n="ConnectorPointLeftDrag":i.classList.contains(oe)?n="ConnectorPointRightDrag":r&&(n=r.hasChildRecords?"ParentDrag":r.ganttProperties.isMilestone?"MilestoneDrag":"ChildDrag"),n},e.prototype.updateMouseDownProperties=function(e){var t=this.getCoordinate(e);if(t.pageX||t.pageY){var i=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer);this.mouseDownX=t.pageX-i.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseDownX,this.mouseDownY=t.pageY-i.top+this.parent.ganttChartModule.scrollObject.previousScroll.top}"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||(this.fromPredecessorText="ConnectorPointLeftDrag"===this.taskBarEditAction?"Start":"Finish",this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.taskBarEditRecord.ganttProperties.taskName,this.fromPredecessorText,"",""))},e.prototype.isMouseDragCheck=function(){if(!this.isMouseDragged&&this.taskBarEditAction&&(this.mouseDownX!==this.mouseMoveX&&(this.mouseDownX+3<this.mouseMoveX||this.mouseDownX-3>this.mouseMoveX)||this.mouseDownY!==this.mouseMoveY&&(this.mouseDownY+3<this.mouseMoveY||this.mouseDownY-3>this.mouseMoveY))){this.isMouseDragged=!0,this.parent.initiateEditAction(!0);var e=this.taskBarEditRecord.ganttProperties;this.previousItem=this.parent.timelineModule.extendFunction(e,this.previousItemProperty),"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction&&this.editTooltip.showHideTaskbarEditTooltip(!0),this.taskBarEditElement.setAttribute("aria-grabbed","true")}},e.prototype.mouseMoveAction=function(e){if(this.parent.isAdaptive){if(!this.canDrag)return;this.multipleSelectionEnabled()}var t=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),i=this.getCoordinate(e);this.mouseMoveX=i.pageX-t.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.mouseMoveY=i.pageY-t.top+this.parent.ganttChartModule.scrollObject.previousScroll.top,this.dragMouseLeave=!1,this.isMouseDragCheck(),this.isMouseDragged&&this.taskBarEditAction?("ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||this.updateConnectorLineSecondProperties(e),this.taskBarEditingAction(e,!1)):this.parent.isAdaptive||this.taskBarEditAction||this.updateTaskBarEditElement(e)},e.prototype.taskBarEditingAction=function(e,t){var i=this,r={},n=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement);null!==this.taskBarEditRecord&&(r.editingFields=this.taskBarEditRecord.ganttProperties,r.data=this.taskBarEditRecord,r.recordIndex=n,r.taskBarEditAction=this.taskBarEditAction,r.roundOffDuration=this.roundOffDuration,r.cancel=!1,this.parent.trigger("taskbarEditing",r,function(r){r.cancel||null===i.taskBarEditRecord?(i.tapPointOnFocus=!1,i.editTooltip.showHideTaskbarEditTooltip(!1)):(i.roundOffDuration=r.roundOffDuration,i.updateMouseMoveProperties(e),"ProgressResizing"===i.taskBarEditAction?i.performProgressResize(e):"LeftResizing"===i.taskBarEditAction?i.enableLeftResizing(e):"RightResizing"===i.taskBarEditAction?i.enableRightResizing(e):"ParentDrag"===i.taskBarEditAction||"ChildDrag"===i.taskBarEditAction||"MilestoneDrag"===i.taskBarEditAction?i.enableDragging(e):"ConnectorPointLeftDrag"!==i.taskBarEditAction&&"ConnectorPointRightDrag"!==i.taskBarEditAction||(i.triggerDependencyEvent(e),i.parent.isAdaptive||i.drawFalseLine()),i.setItemPosition(),i.updateEditedItem(),i.editTooltip.updateTooltip(),t&&i.taskBarEditedAction(e))}))},e.prototype.updateMouseMoveProperties=function(e){var t=this.parent.getOffsetRect(this.parent.ganttChartModule.chartBodyContainer),i=this.getCoordinate(e);(i.pageX||i.pageY)&&(this.mouseMoveX=i.pageX-t.left+this.parent.ganttChartModule.scrollObject.previousScroll.left,this.tooltipPositionX=this.mouseMoveX,this.mouseMoveY=i.pageY-t.top+this.parent.ganttChartModule.scrollObject.previousScroll.top);var r="ConnectorPointLeftDrag"===this.taskBarEditAction||"ConnectorPointRightDrag"===this.taskBarEditAction;if(this.taskBarEditRecord.ganttProperties.width>3&&("ProgressResizing"!==this.taskBarEditAction||0!==this.taskBarEditRecord.ganttProperties.progress&&100!==this.taskBarEditRecord.ganttProperties.progress)||r){var n=this.mouseMoveX-this.parent.ganttChartModule.scrollObject.previousScroll.left+t.left,a=this.mouseMoveY-this.parent.ganttChartModule.scrollObject.previousScroll.top+t.top;n+20>t.left+this.parent.ganttChartModule.chartBodyContainer.offsetWidth?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("right")):n-20<t.left?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.left,this.startScrollTimer("left")):r&&a+20>t.top+this.parent.ganttChartModule.chartBodyContainer.offsetHeight?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("bottom")):r&&a-20<t.top?(this.timerCount=this.parent.ganttChartModule.scrollObject.previousScroll.top,this.startScrollTimer("top")):this.stopScrollTimer()}else this.stopScrollTimer()},e.prototype.startScrollTimer=function(e){var t=this;this.stopScrollTimer(),this.scrollTimer=window.setInterval(function(){t.timerCount="right"===e||"bottom"===e?t.timerCount+1>=t.parent.timelineModule.totalTimelineWidth?t.parent.timelineModule.totalTimelineWidth:t.timerCount+1:t.timerCount-1<0?0:t.timerCount-1,"bottom"===e||"top"===e?t.parent.ganttChartModule.scrollObject.setScrollTop(t.timerCount):t.parent.ganttChartModule.scrollObject.setScrollLeft(t.timerCount),"ConnectorPointLeftDrag"!==t.taskBarEditAction&&"ConnectorPointRightDrag"!==t.taskBarEditAction||t.drawFalseLine()},0)},e.prototype.stopScrollTimer=function(){window.clearInterval(this.scrollTimer),this.scrollTimer=null},e.prototype.enableDragging=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.mouseDownX>this.mouseMoveX?(i=this.mouseDownX-this.mouseMoveX)>0&&this.parent.setRecordValue("left",this.previousItem.left-i,t,!0):(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("left",this.previousItem.left+i,t,!0));var r=t.left<0?0:t.left+t.width>=this.parent.timelineModule.totalTimelineWidth?this.parent.timelineModule.totalTimelineWidth-t.width:t.left;this.parent.setRecordValue("left",r,t,!0)},e.prototype.performProgressResize=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left&&this.mouseMoveX<t.left+t.width&&t.left>0?(i=this.mouseMoveX-t.left,this.parent.setRecordValue("progressWidth",i,t,!0)):this.mouseMoveX>=t.left+t.width?this.parent.setRecordValue("progressWidth",t.width,t,!0):this.parent.setRecordValue("progressWidth",0,t,!0):this.mouseMoveX>t.left&&this.mouseMoveX<t.left+t.width?(i=this.mouseMoveX-t.left,this.parent.setRecordValue("progressWidth",i,t,!0)):this.mouseMoveX<=t.left?this.parent.setRecordValue("progressWidth",0,t,!0):this.parent.setRecordValue("progressWidth",t.width,t,!0);var r=t.progressWidth>t.width?t.width:t.progressWidth;r=t.progressWidth<0?0:t.progressWidth,this.parent.setRecordValue("progressWidth",r,t,!0);var n=t.width-t.progressWidth;this.progressBorderRadius=n<=4?4-n:0},e.prototype.enableLeftResizing=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.mouseDownX>this.mouseMoveX?this.mouseMoveX<t.left+t.width?(i=this.mouseDownX-this.mouseMoveX,t.left>0&&(this.parent.setRecordValue("left",this.previousItem.left-i,t,!0),this.parent.setRecordValue("width",this.previousItem.width+i,t,!0))):this.mouseMoveX>t.left+t.width&&(i=this.mouseDownX-this.mouseMoveX,this.parent.setRecordValue("left",this.previousItem.left-i,t,!0),this.parent.setRecordValue("width",3,t,!0)):this.mouseMoveX<t.left+t.width?(i=this.mouseMoveX-this.mouseDownX,t.left<t.left+t.width&&this.previousItem.left+i<=this.previousItem.left+this.previousItem.width&&(this.parent.setRecordValue("left",this.previousItem.left+i,t,!0),this.parent.setRecordValue("width",this.previousItem.width-i,t,!0))):(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("left",this.previousItem.left+i,t,!0),this.parent.setRecordValue("width",3,t,!0)),this.updateEditPosition(e,t),this.parent.setRecordValue("left",this.previousItem.left+this.previousItem.width-t.width,t,!0)},e.prototype.updateEditPosition=function(e,t){this.updateIsMilestone(t),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(t.width,t.progress),t,!0)},e.prototype.updateIsMilestone=function(e){e.width<=3?(this.parent.setRecordValue("width",3,e,!0),this.parent.setRecordValue("isMilestone",!0,e,!0)):(this.parent.setRecordValue("width",e.width,e,!0),this.parent.setRecordValue("isMilestone",!1,e,!0))},e.prototype.enableRightResizing=function(e){var t=this.taskBarEditRecord.ganttProperties,i=0;this.mouseDownX>this.mouseMoveX?this.mouseMoveX>t.left&&this.mouseDownX-this.mouseMoveX>3?(i=this.mouseDownX-this.mouseMoveX,this.parent.setRecordValue("width",this.previousItem.width-i,t,!0)):this.mouseMoveX<t.left&&this.parent.setRecordValue("width",3,t,!0):this.mouseMoveX>t.left&&(i=this.mouseMoveX-this.mouseDownX,this.parent.setRecordValue("width",this.previousItem.width+i,t,!0)),this.updateEditPosition(e,t)},e.prototype.updateEditedItem=function(){var e,i,r,n,a=this.taskBarEditRecord.ganttProperties;switch(this.taskBarEditAction){case"ProgressResizing":this.parent.setRecordValue("progress",this.getProgressPercent(a.width,a.progressWidth),a,!0);break;case"LeftResizing":e=this.getRoundOffStartLeft(a,this.roundOffDuration),i=this.getDateByLeft(e),t.isNullOrUndefined(a.endDate)&&(r=this.parent.dateValidationModule.getValidEndDate(a),this.parent.setRecordValue("endDate",r,a,!0)),n=this.parent.dateValidationModule.checkStartDate(i,a,null),this.parent.setRecordValue("startDate",new Date(n.getTime()),a,!0),0===this.parent.dateValidationModule.compareDates(a.startDate,a.endDate)&&t.isNullOrUndefined(a.isMilestone)&&!1===a.isMilestone&&0===a.duration&&this.parent.setRecordValue("duration",1,a,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord);break;case"RightResizing":e=this.getRoundOffEndLeft(a,this.roundOffDuration);var o=this.getDateByLeft(e);t.isNullOrUndefined(a.startDate)&&(n=this.parent.dateValidationModule.getValidStartDate(a),this.parent.setRecordValue("startDate",n,a,!0)),r=this.parent.dateValidationModule.checkEndDate(o,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",new Date(r.getTime()),a,!0),this.parent.dateValidationModule.calculateDuration(this.taskBarEditRecord);break;case"ParentDrag":case"ChildDrag":case"MilestoneDrag":e=this.getRoundOffStartLeft(a,this.roundOffDuration),i=this.getDateByLeft(e),!t.isNullOrUndefined(a.endDate)&&t.isNullOrUndefined(a.startDate)?(r=this.parent.dateValidationModule.checkStartDate(i,a,null),r=this.parent.dateValidationModule.checkEndDate(r,this.taskBarEditRecord.ganttProperties),this.parent.setRecordValue("endDate",r,a,!0)):(this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(i,a,null),a,!0),t.isNullOrUndefined(a.duration)||this.parent.dateValidationModule.calculateEndDate(this.taskBarEditRecord))}},e.prototype.getRoundOffEndLeft=function(e,t){var i="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,r=e.width+e.left,n=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(r),1,"Day")/864e5),a=this.parent.perDayWidth-this.parent.perDayWidth/n,o=a/this.parent.perDayWidth;if(void 0===t&&(t=!1),t){if(t)if("Hour"===i){var s=this.parent.perDayWidth/24;n=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(r),1,"Hour")/36e5),0!==(a=this.parent.perDayWidth/24-this.parent.perDayWidth/24/n)&&(r=r-a+s)}else if("Minutes"===i){var l=this.parent.perDayWidth/1440;n=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(r),1,"Minutes")/6e4),0!==(a=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/n)&&(r=r-a+l)}else 0!==a&&(r=r-a+this.parent.perDayWidth)}else"Hour"!==i&&"Minutes"!==i&&(0===o?r=r:o>.5?r=r-a+this.parent.perDayWidth:o<.5&&(r=r-a+this.parent.perDayWidth/2));return r},e.prototype.getRoundOffStartLeft=function(e,t){var i=e.left,r="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.bottomTier:this.parent.timelineModule.topTier,n=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Day")/864e5),a=this.parent.perDayWidth-this.parent.perDayWidth/n,o=a/this.parent.perDayWidth;return void 0===t&&(t=!1),t?t&&("Hour"===r?(n=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Hour")/36e5),a=this.parent.perDayWidth/24-this.parent.perDayWidth/24/n,i=e.left-a):"Minutes"===r?(n=1/(this.parent.timelineModule.getIncrement(this.getDateByLeft(i),1,"Minutes")/6e4),a=this.parent.perDayWidth/1440-this.parent.perDayWidth/1440/n,i=e.left-a):i=e.left-a):"Hour"!==r&&"Minutes"!==r&&(o<=.5?i=e.left-a:o>.5&&(i=e.left-a+this.parent.perDayWidth/2)),i},e.prototype.getDateByLeft=function(e){var t=new Date(this.parent.timelineModule.timelineStartDate.toString()),i=864e5/this.parent.perDayWidth;t.setTime(t.getTime()+e*i);var r="None"!==this.parent.timelineModule.bottomTier?this.parent.timelineModule.topTier:this.parent.timelineModule.bottomTier;return"Hour"!==r&&"Minutes"!==r&&(this.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&!this.isInDst(t)?t.setTime(t.getTime()+36e5):!this.isInDst(new Date(this.parent.timelineModule.timelineStartDate.toString()))&&this.isInDst(t)&&t.setTime(t.getTime()-36e5)),t},e.prototype.getDefaultTZOffset=function(){var e=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},e.prototype.isInDst=function(e){return e.getTimezoneOffset()<this.getDefaultTZOffset()},e.prototype.setItemPosition=function(){var e=this.taskBarEditRecord.ganttProperties,i="MilestoneDrag"===this.taskBarEditAction?this.parent.chartRowsModule.milestoneHeight:e.width,r=this.parent.isAdaptive?i-2:i-10,n=t.closest(this.taskBarEditElement,"tr."+F).querySelector("."+C),a=t.closest(this.taskBarEditElement,"tr."+F).querySelector("."+w),o=t.closest(this.taskBarEditElement,"tr."+F).querySelector("."+M),s=this.taskBarEditElement.querySelector("."+H),l=this.taskBarEditElement.querySelector("."+j),d=this.taskBarEditElement.querySelector("."+A),p=this.taskBarEditElement.querySelector("."+U),h=this.taskBarEditElement.querySelector("."+W),c=this.taskBarEditElement.querySelector("."+G),u=this.taskBarEditElement.querySelector("."+de);"ConnectorPointRightDrag"!==this.taskBarEditAction&&"ConnectorPointLeftDrag"!==this.taskBarEditAction&&(n.style.width=i+"px",n.style.left=e.left+"px",a.style.width=e.left+"px",o.style.left=e.left+i+"px",u&&(u.style.left=(this.parent.isAdaptive?i+10:i+2)+"px"),"MilestoneDrag"===this.taskBarEditAction?(n.style.left=e.left-i/2+"px",a.style.width=e.left-i/2+"px",o.style.left=e.left+i/2+"px"):"ProgressResizing"===this.taskBarEditAction?(s.style.width=e.progressWidth+"px",s.style.borderBottomRightRadius=this.progressBorderRadius+"px",s.style.borderTopRightRadius=this.progressBorderRadius+"px",l.style.left=e.left+e.progressWidth-10+"px",d.style.left=e.progressWidth-8+"px"):"RightResizing"===this.taskBarEditAction?(l.style.width=i+"px",s.style.width=e.progressWidth+"px",p.style.left=r+"px",d.style.left=e.progressWidth-10+"px"):"ParentDrag"===this.taskBarEditAction?(h.style.width=i+"px",c.style.width=e.progressWidth+"px"):(l.style.width=i+"px",t.isNullOrUndefined(s)||(p.style.left=r+"px",s.style.width=e.progressWidth+"px",d.style.left=e.progressWidth-10+"px")))},e.prototype.mouseUpHandler=function(e){var t=this.isMouseDragged;this.editTooltip.showHideTaskbarEditTooltip(!1),this.taskBarEditAction&&this.isMouseDragged&&(!this.dragMouseLeave&&this.taskBarEditedAction?(this.taskBarEditedAction(e),this.isMouseDragged=!1):this.cancelTaskbarEditActionInMouseLeave()),this.parent.isAdaptive&&!t||this.initPublicProp(),this.stopScrollTimer()},e.prototype.taskBarEditedAction=function(e){var t,i,r={},n=this.mouseDownX,a=this.mouseDownY,o=this.taskBarEditRecord,s=this.parent.ganttChartModule.getIndexByTaskBar(this.taskBarEditElement),l=this.getCoordinate(e);t=this.mouseMoveX,this.mouseMoveY,i=l.pageY-this.parent.ganttChartModule.chartBodyContainer.offsetTop,"ConnectorPointLeftDrag"!==this.taskBarEditAction&&"ConnectorPointRightDrag"!==this.taskBarEditAction||!this.drawPredecessor?(n!==t||Math.abs(a-i)>=(this.parent.rowHeight-this.parent.taskbarHeight)/2)&&null!==o&&(r.editingFields=o.ganttProperties,r.data=o,r.recordIndex=s,r.previousData=this.previousItem,r.taskBarEditAction=this.taskBarEditAction,r.action="TaskbarEditing",r.roundOffDuration=this.roundOffDuration,this.taskbarEditedArgs=r,this.taskbarEdited(r)):this.parent.connectorLineEditModule.updatePredecessor(this.connectorSecondRecord,this.finalPredecessor)},e.prototype.cancelTaskbarEditActionInMouseLeave=function(){this.parent.editModule.reUpdatePreviousRecords(!0)},e.prototype.taskbarEdited=function(e){var i=t.extend({},e),r=i.data,n=r.ganttProperties;"ProgressResizing"===i.taskBarEditAction?i.previousData.progress!==n.progress&&(this.parent.setRecordValue("progress",this.getProgressPercent(n.width,n.progressWidth),n,!0),r.parentItem&&this.parent.editModule.updateParentProgress(r.parentItem)):this.parent.dataOperation.updateWidthLeft(i.data),this.parent.dataOperation.updateTaskData(r),this.parent.editModule.initiateUpdateAction(i)},e.prototype.getProgressPercent=function(e,t){return Math.ceil(t/e*100)},e.prototype.drawFalseLine=function(){var e,i,r=this.mouseDownX,n=this.mouseDownY,a=this.mouseMoveX,o=this.mouseMoveY,s=Math.sqrt((r-a)*(r-a)+(n-o)*(n-o)),l="rotate("+180*Math.atan2(o-n,a-r)/Math.PI+"deg)";"ConnectorPointLeftDrag"===this.taskBarEditAction&&(e=this.taskBarEditElement.offsetLeft-this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left),"ConnectorPointRightDrag"===this.taskBarEditAction&&(e=this.taskBarEditElement.offsetLeft+this.taskBarEditElement.offsetWidth+this.parent.chartRowsModule.connectorPointWidth/2-this.parent.ganttChartModule.scrollObject.previousScroll.left),i=this.taskBarEditElement.offsetTop+this.taskBarEditElement.offsetHeight/2+this.parent.ganttChartModule.chartBodyContainer.offsetTop-this.parent.ganttChartModule.scrollObject.previousScroll.top,this.removeFalseLine(!1),this.falseLine=t.createElement("div",{className:"e-gantt-false-line",id:"ganttfalseline"+this.parent.element.id,styles:"transform-origin: 0% 100%;right: auto;position: absolute;transform:"+l+";border-top-width: 1px;border-top-style: dashed;z-index: 5;width:"+(s-3)+"px;left:"+e+"px;top:"+i+"px;"}),this.parent.ganttChartModule.chartBodyContainer.appendChild(this.falseLine)},e.prototype.removeFalseLine=function(e){this.falseLine&&(t.remove(this.falseLine),this.falseLine=null,e&&t.removeClass(this.parent.ganttChartModule.scrollElement.querySelectorAll("."+K),[ee]))},e.prototype.updateConnectorLineSecondProperties=function(e){var i=this.getElementByPosition(e),r=u(i,C);this.connectorSecondAction=null,u(i,ae)?(this.connectorSecondAction="ConnectorPointLeftDrag",this.toPredecessorText="Start"):u(i,oe)?(this.connectorSecondAction="ConnectorPointRightDrag",this.toPredecessorText="Finish"):(this.connectorSecondAction=null,this.toPredecessorText=null),this.taskBarEditElement!==r&&this.taskBarEditElement!==this.highlightedSecondElement&&this.showHideTaskBarEditingElements(r,this.highlightedSecondElement,!0),t.isNullOrUndefined(this.connectorSecondAction)&&!t.isNullOrUndefined(this.connectorSecondElement)&&(this.editTooltip.showHideTaskbarEditTooltip(!1),t.removeClass([this.connectorSecondElement.querySelector("."+ae)],[pe]),t.removeClass([this.connectorSecondElement.querySelector("."+oe)],[pe])),this.connectorSecondElement=this.connectorSecondAction?r:null,this.highlightedSecondElement=r,this.connectorSecondRecord=t.isNullOrUndefined(this.connectorSecondElement)?null:this.parent.ganttChartModule.getRecordByTaskBar(this.connectorSecondElement)},e.prototype.triggerDependencyEvent=function(e,i){var r,n,a=this.taskBarEditRecord.ganttProperties,o=this.connectorSecondRecord?this.connectorSecondRecord.ganttProperties:null,s=this.getElementByPosition(e),l=s;if("ConnectorPointLeftDrag"===this.taskBarEditAction?r=a.taskId+"S":"ConnectorPointRightDrag"===this.taskBarEditAction&&(r=a.taskId+"F"),this.connectorSecondAction&&("ConnectorPointLeftDrag"===this.connectorSecondAction?(r+="S",n="Start"):"ConnectorPointRightDrag"===this.connectorSecondAction&&(r+="F",n="Finish")),t.isNullOrUndefined(o))this.drawPredecessor=!1;else{o.predecessorsName?this.finalPredecessor=o.predecessorsName+","+r:this.finalPredecessor=r;var d=this.parent.connectorLineEditModule.validatePredecessorRelation(this.connectorSecondRecord,this.finalPredecessor),p={};if(p.fromItem=a,p.toItem=o,p.newPredecessorString=this.finalPredecessor,p.isValidLink=d,p.requestType="ValidateDependency",this.parent.trigger("actionBegin",p),p.isValidLink=!(!d&&p.isValidLink)&&p.isValidLink,p.isValidLink){if(this.editTooltip.toolTipObj||this.parent.isAdaptive||this.editTooltip.showHideTaskbarEditTooltip(!0),this.editTooltip.toolTipObj){this.parent.connectorLineModule.tooltipTable.innerHTML=this.parent.connectorLineModule.getConnectorLineTooltipInnerTd(this.parent.editModule.taskbarEditModule.taskBarEditRecord.ganttProperties.taskName,this.parent.editModule.taskbarEditModule.fromPredecessorText,"","");var h=this.parent.connectorLineModule.tooltipTable.querySelector("#toPredecessor").querySelectorAll("td");h[1].innerText=o.taskName,h[2].innerText=n}this.drawPredecessor=!0}else this.parent.isAdaptive?(s.classList.contains(ae)||s.classList.contains(oe))&&this.showHideActivePredecessors(!0):t.addClass([l],[pe]),this.drawPredecessor=!1}},e.prototype.getCoordinate=function(e){var i={};if(t.Browser.isTouch&&e&&e.type!==r.click){"touchmove"!==(n=e).type&&"touchstart"!==n.type&&"touchend"!==n.type||(i.pageX=n.changedTouches[0].pageX,i.pageY=n.changedTouches[0].pageY)}else if(e){var n=e;i.pageX=n.pageX,i.pageY=n.pageY}return i},e.prototype.getElementByPosition=function(e){if(this.parent.isAdaptive){var t=this.getCoordinate(e);return document.elementFromPoint(t.pageX-window.pageXOffset,t.pageY-window.pageYOffset)}return e.target},e.prototype.multipleSelectionEnabled=function(){this.parent.selectionModule&&"Cell"!==this.parent.selectionSettings.mode&&"Multiple"===this.parent.selectionSettings.type&&this.parent.selectionModule.hidePopUp()},e.prototype.unWireEvents=function(){this.parent.isDestroyed||(this.parent.off("chartMouseDown",this.mouseDownHandler),this.parent.off("chartMouseUp",this.mouseUpHandler),this.parent.off("chartMouseLeave",this.mouseLeaveHandler),this.parent.off("chartMouseMove",this.mouseMoveAction),this.parent.off("chartMouseClick",this.mouseClickHandler))},e.prototype.destroy=function(){this.unWireEvents(),this.stopScrollTimer(),this.parent.editModule.taskbarEditModule=void 0},e}(),Pt=function(){function e(e){this.updatedEditFields=null,this.updatedAddFields=null,this.addedRecord=null,this.dialogEditValidationFlag=!1,this.ganttResources=[],this.parent=e,this.localeObj=this.parent.localeObj,this.beforeOpenArgs={cancel:!1},this.types=this.getPredecessorType(),this.rowData={},this.editedRecord={},this.inputs={booleanedit:p.CheckBox,dropdownedit:c.DropDownList,datepickeredit:h.DatePicker,datetimepickeredit:h.DateTimePicker,maskededit:d.MaskedTextBox,numericedit:d.NumericTextBox,stringedit:d.TextBox},this.processDialogFields(),this.wireEvents()}return e.prototype.wireEvents=function(){this.parent.on("chartDblClick",this.dblClickHandler,this)},e.prototype.dblClickHandler=function(e){var i=this.parent.ganttChartModule.getRecordByTarget(e);t.isNullOrUndefined(i)||this.openEditDialog(i)},e.prototype.processDialogFields=function(){t.isNullOrUndefined(this.parent.editDialogFields)||this.parent.editDialogFields&&0===this.parent.editDialogFields.length?(this.updatedEditFields=this.getDefaultDialogFields(),this.updatedEditFields=this.validateDialogFields(this.updatedEditFields)):this.updatedEditFields=this.validateDialogFields(this.parent.editDialogFields),t.isNullOrUndefined(this.parent.addDialogFields)||this.parent.addDialogFields&&0===this.parent.addDialogFields.length?(this.updatedAddFields=this.getDefaultDialogFields(),this.updatedAddFields=this.validateDialogFields(this.updatedAddFields)):this.updatedAddFields=this.validateDialogFields(this.parent.addDialogFields)},e.prototype.validateDialogFields=function(e){for(var i=[],n=0,a=0;a<e.length;a++){var o=r.getActualProperties(e[a]);"General"!==o.type||!t.isNullOrUndefined(o.fields)&&0!==o.fields.length||(o.fields=this.getGeneralColumnFields()),"Dependency"===o.type&&t.isNullOrUndefined(this.parent.taskFields.dependency)||"Resources"===o.type&&t.isNullOrUndefined(this.parent.taskFields.resourceInfo)||"Notes"===o.type&&t.isNullOrUndefined(this.parent.taskFields.notes)||("Custom"!==o.type||!t.isNullOrUndefined(o.fields)&&0!==o.fields.length||(n+=1,o.fields=this.getCustomColumnFields()),n>1||i.push(o))}return i},e.prototype.getGeneralColumnFields=function(){for(var e=[],t=0,i=Object.keys(this.parent.columnMapping);t<i.length;t++){var r=i[t];"dependency"!==r&&"resourceInfo"!==r&&"notes"!==r&&e.push(this.parent.columnMapping[r])}return e},e.prototype.getCustomColumnFields=function(){for(var e=[],t=0;t<this.parent.customColumns.length;t++)e.push(this.parent.customColumns[t]);return e},e.prototype.getDefaultDialogFields=function(){var e=[],i={};return 0!==Object.keys(this.parent.columnMapping).length&&(i.type="General",this.getGeneralColumnFields(),e.push(i)),t.isNullOrUndefined(t.getValue("dependency",this.parent.columnMapping))||((i={}).type="Dependency",e.push(i)),t.isNullOrUndefined(t.getValue("resourceInfo",this.parent.columnMapping))||((i={}).type="Resources",e.push(i)),t.isNullOrUndefined(t.getValue("notes",this.parent.columnMapping))||((i={}).type="Notes",e.push(i)),this.parent.customColumns.length>0&&((i={}).type="Custom",e.push(i)),e},e.prototype.openAddDialog=function(){this.isEdit=!1,this.editedRecord=this.composeAddRecord(),this.createDialog()},e.prototype.getMinimumStartDate=function(){var e=n.DataUtil.aggregates.min(this.parent.flatData,"ganttProperties.startDate");return e=t.isNullOrUndefined(e)?new Date(this.parent.timelineModule.timelineStartDate.getTime()):new Date(e.getTime()),e=this.parent.dateValidationModule.checkStartDate(e),new Date(e.getTime())},e.prototype.composeAddRecord=function(){var e={};e.ganttProperties={};for(var i=this.parent.ganttColumns,r=this.parent.taskFields,n=this.parent.editModule.getNewTaskId(),a=0;a<i.length;a++){var o=i[a].field;o===r.id?(e[o]=n,e.ganttProperties.taskId=e[o]):i[a].field===r.startDate?(t.isNullOrUndefined(e[r.endDate])?e[o]=this.getMinimumStartDate():e[o]=new Date(e[r.endDate]),e.ganttProperties.startDate=new Date(e[o])):i[a].field===r.endDate?(t.isNullOrUndefined(e[r.startDate])?e[o]=this.getMinimumStartDate():e[o]=new Date(e[r.startDate]),e.ganttProperties.endDate=new Date(e[o])):i[a].field===r.duration?(e[o]=1,e.ganttProperties.duration=e[o],e.ganttProperties.durationUnit=this.parent.durationUnit.toLocaleLowerCase()):i[a].field===r.name?(e[o]="New Task "+n,e.ganttProperties.taskName=e[o]):i[a].field===r.progress?(e[o]=0,e.ganttProperties.progress=e[o]):e[this.parent.ganttColumns[a].field]=""}return e},e.prototype.openToolbarEditDialog=function(){var e=this.parent;if(e.editModule&&e.editSettings.allowEditing){var i=e.selectionModule?"Row"!==e.selectionSettings.mode&&"Both"!==e.selectionSettings.mode||1!==e.selectionModule.selectedRowIndexes.length?"Cell"===e.selectionSettings.mode&&1===e.selectionModule.getSelectedRowCellIndexes().length?e.currentViewData[e.selectionModule.getSelectedRowCellIndexes()[0].rowIndex].ganttProperties.taskId:null:e.currentViewData[e.selectionModule.selectedRowIndexes[0]].ganttProperties.taskId:null;t.isNullOrUndefined(i)||this.openEditDialog(i)}},e.prototype.openEditDialog=function(e){var i=this.parent;"object"!=typeof e||t.isNullOrUndefined(e)?t.isNullOrUndefined(e)?i.selectedRowIndex>-1&&(this.rowData=i.currentViewData[i.selectedRowIndex],this.rowIndex=i.selectedRowIndex):(this.rowIndex=i.ids.indexOf(e.toString()),this.rowIndex>-1&&(this.rowData=i.flatData[this.rowIndex])):(this.rowIndex=this.parent.currentViewData.indexOf(e),this.rowIndex>-1&&(this.rowData=e)),this.isEdit=!0,0!==Object.keys(this.rowData).length&&(this.editedRecord=t.extend({},{},this.rowData,!0),this.createDialog())},e.prototype.createDialog=function(){var e=this,i=this.parent,r={};this.beforeOpenArgs.dialogModel=r,this.beforeOpenArgs.rowData=this.editedRecord,this.beforeOpenArgs.rowIndex=this.rowIndex;var n=this.parent.isAdaptive?"":"600px",a=this.parent.createElement("div",{id:i.element.id+"_dialog",styles:"max-width:"+n});i.element.appendChild(a),r.animationSettings={effect:"None"},r.header=this.localeObj.getConstant(this.isEdit?"editDialogTitle":"addDialogTitle"),r.isModal=!0,r.cssClass="e-gantt-dialog",r.allowDragging=!this.parent.isAdaptive,r.showCloseIcon=!0;var o=this.parent.isAdaptive?{X:"top",Y:"left"}:{X:"center",Y:"center"};r.position=o,r.height=this.parent.isAdaptive?"100%":"auto",r.target=this.parent.element,r.close=this.dialogClose.bind(this),r.closeOnEscape=!0,r.open=function(i){var r=t.getValue("element",i),n=r.querySelector("#"+e.parent.element.id+"GeneralTabContainer");n&&n.scrollHeight>n.offsetHeight&&n.classList.add("e-scroll"),0===e.tabObj.selectedItem&&e.tabObj.select(0),e.parent.isAdaptive&&(r.style.maxHeight="none")},r.locale=this.parent.locale,r.buttons=[{buttonModel:{content:this.localeObj.getConstant("saveButton"),cssClass:"e-primary"},click:this.buttonClick.bind(this)},{buttonModel:{cssClass:"e-flat",content:this.localeObj.getConstant("cancel")},click:this.buttonClick.bind(this)}],this.createTab(r,a)},e.prototype.buttonClick=function(e){var t=e.target;t.style.pointerEvents="none",this.localeObj.getConstant("cancel").toLowerCase()===e.target.innerText.trim().toLowerCase()?this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.hide(),this.dialogClose()):(this.initiateDialogSave(),t.style.pointerEvents="auto")},e.prototype.dialogClose=function(){this.dialog&&this.resetValues()},e.prototype.resetValues=function(){this.isEdit=!1,this.editedRecord={},this.rowData={},this.rowIndex=-1,this.addedRecord=null,this.ganttResources=[],this.dialog&&!this.dialogObj.isDestroyed&&(this.destroyDialogInnerElements(),this.dialogObj.destroy(),t.remove(this.dialog))},e.prototype.destroyDialogInnerElements=function(){for(var e=this.parent,i=this.beforeOpenArgs.tabModel.items,r=0;r<i.length;r++){var n=i[r].content,a=n.id;if(!t.isNullOrUndefined(a)||""!==a)if(a=a.replace(e.element.id,""),"General"===(a=a.replace("TabContainer","")))this.destroyCustomField(n);else if("Dependency"===a){n.ej2_instances[0].destroy()}else if("Notes"===a){n.ej2_instances[0].destroy()}else if("Resources"===a){n.ej2_instances[0].destroy()}else-1!==a.indexOf("Custom")&&this.destroyCustomField(n)}},e.prototype.destroyCustomField=function(e){for(var t=e.childNodes,i=this.parent,r=0;r<t.length;r++){var n=t[r],a=n.querySelector('input[id^="'+i.element.id+'"]');if(a){var o=a.id.replace(i.element.id,""),s=n.querySelector("#"+i.element.id+o).ej2_instances[0];s&&s.destroy()}}},e.prototype.destroy=function(){this.resetValues(),this.parent.isDestroyed||(this.parent.off("chartDblClick",this.dblClickHandler),this.parent.editModule.dialogModule=void 0)},e.prototype.getEditFields=function(){return this.isEdit?this.updatedEditFields:this.updatedAddFields},e.prototype.createTab=function(e,r){var n,a=this,o=this.parent,l={},d=[],p=this.getEditFields(),h=o.taskFields,c=p.length;l.items=d,l.locale=this.parent.locale,this.beforeOpenArgs.tabModel=l;var u=0;if(c>0)for(var g=0;g<c;g++){var f=p[g],m={};if("General"===f.type){if(0===Object.keys(o.columnMapping).length)continue;t.isNullOrUndefined(f.headerText)&&(f.headerText=this.localeObj.getConstant("generalTab")),m.content="General",this.beforeOpenArgs[m.content]=this.getFieldsModel(f.fields)}else if("Dependency"===f.type){if(t.isNullOrUndefined(h.dependency))continue;t.isNullOrUndefined(f.headerText)&&(f.headerText=this.localeObj.getConstant("dependency")),m.content="Dependency",this.beforeOpenArgs[m.content]=this.getPredecessorModel(f.fields)}else if("Resources"===f.type){if(t.isNullOrUndefined(h.resourceInfo))continue;t.isNullOrUndefined(f.headerText)&&(f.headerText=this.localeObj.getConstant("resourceName")),m.content="Resources",this.beforeOpenArgs[m.content]=this.getResourcesModel(f.fields)}else if("Notes"===f.type){if(t.isNullOrUndefined(h.notes))continue;t.isNullOrUndefined(f.headerText)&&(f.headerText=this.localeObj.getConstant("notes")),m.content="Notes",this.beforeOpenArgs[m.content]=this.getNotesModel(f.fields)}else{if(t.isNullOrUndefined(f.fields)||0===f.fields.length)continue;t.isNullOrUndefined(f.headerText)&&(f.headerText=this.localeObj.getConstant("customTab")),m.content="Custom"+u++,this.beforeOpenArgs[m.content]=this.getFieldsModel(f.fields)}m.header={text:f.headerText},d.push(m)}this.beforeOpenArgs.requestType=this.isEdit?"beforeOpenEditDialog":"beforeOpenAddDialog",this.renderTabItems();var y={rowData:this.beforeOpenArgs.rowData,name:this.beforeOpenArgs.name,requestType:this.beforeOpenArgs.requestType,cancel:this.beforeOpenArgs.cancel};this.parent.trigger("actionBegin",t.isBlazor()?y:this.beforeOpenArgs,function(d){if(!d.cancel){l.selected=a.tabSelectedEvent.bind(a),l.height=a.parent.isAdaptive?"100%":"auto",l.overflowMode="Scrollable",a.tabObj=new s.Tab(l),a.tabObj.isStringTemplate=!0,n=a.parent.createElement("div",{id:o.element.id+"_Tab"}),a.tabObj.appendTo(n),e.content=n,a.dialog=r,a.dialogObj=new i.Dialog(e),a.dialogObj.isStringTemplate=!0,a.dialogObj.appendTo(a.dialog);var p={requestType:a.isEdit?"openEditDialog":"openAddDialog",data:a.beforeOpenArgs.rowData,element:a.dialog,cancel:!1};t.isBlazor()&&a.parent.updateDataArgs(p),a.parent.trigger("actionComplete",p,function(e){e.cancel&&a.resetValues()})}})},e.prototype.tabSelectedEvent=function(e){var t=this.parent,i=e.selectedContent.childNodes[0].id;if(this.parent.isAdaptive&&this.responsiveTabContent(i,t),i===t.element.id+"ResourcesTabContainer"){var r=t.element.querySelector("#"+i).ej2_instances[0],n=this.ganttResources;n&&n.length>0&&r.currentViewData.forEach(function(e,i){for(var a=0;a<n.length;a++)e[t.resourceIDMapping]===n[a][t.resourceIDMapping]&&-1===r.selectionModule.selectedRowIndexes.indexOf(i)&&r.selectRow(i)})}else i===t.element.id+"NotesTabContainer"&&t.element.querySelector("#"+i).ej2_instances[0].refresh()},e.prototype.responsiveTabContent=function(e,t){var i=document.getElementById(t.element.id+"_dialog_dialog-content"),r=i.clientHeight;r-=i.querySelector(".e-tab-header").offsetHeight;var n=document.querySelector("#"+e);if(n.classList.contains("e-grid")){r-=n.ej2_instances[0].getHeaderContent().offsetHeight;var a=n.querySelector(".e-toolbar");a&&(r-=a.offsetHeight)}n.parentElement.style.height=r+"px"},e.prototype.getFieldsModel=function(e){for(var i={},r=this.parent.columnByField,n=0;n<e.length;n++)if(e[n]!==this.parent.taskFields.dependency&&e[n]!==this.parent.taskFields.resourceInfo&&e[n]!==this.parent.taskFields.notes&&!t.isNullOrUndefined(r[e[n]])){var a=e[n];this.createInputModel(r[a],i)}return i},e.prototype.createInputModel=function(e,i){var r=this,n=this.parent,a=this.parent.locale,o=this.parent.taskFields,s={placeholder:e.headerText,floatLabelType:"Auto"};switch(e.editType){case"booleanedit":var l={label:e.headerText,locale:a};i[e.field]=l;break;case"stringedit":var d=s;e.field===n.columnMapping.duration&&(d.change=function(t){r.validateScheduleFields(t,e,n)}),i[e.field]=s;break;case"numericedit":var p=s;i[e.field]=p;break;case"datepickeredit":var h=s;h.format=this.parent.dateFormat,h.strictMode=!0,h.firstDayOfWeek=n.timelineModule.customTimelineSettings.weekStartDay,e.field!==n.columnMapping.startDate&&e.field!==n.columnMapping.endDate||(h.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),h.change=function(t){r.validateScheduleFields(t,e,n)}),i[e.field]=h;break;case"datetimepickeredit":var c=s;c.format=this.parent.dateFormat,c.strictMode=!0,c.firstDayOfWeek=n.timelineModule.customTimelineSettings.weekStartDay,e.field!==n.columnMapping[o.startDate]&&e.field!==n.columnMapping[o.endDate]||(c.renderDayCell=this.parent.renderWorkingDayCell.bind(this.parent),c.change=function(t){r.validateScheduleFields(t,e,n)}),i[e.field]=c;break;case"dropdownedit":case"maskededit":i[e.field]=s}return t.isNullOrUndefined(e.edit)||t.extend(i[e.field],e.edit.params),i},e.prototype.validateScheduleFields=function(e,i,r){var n,a=r.editModule.dialogModule.dialog,o=null,s=r.editModule.dialogModule.editedRecord;t.isNullOrUndefined(e.element)?t.isNullOrUndefined(e.container)||(o=(n=e.container).querySelector("input").getAttribute("id"),n=n.querySelector("#"+o)):o=(n=e.element).getAttribute("id");var l=n.value,d=o.replace(r.element.id,"");this.validateScheduleValuesByCurrentField(d,l,this.editedRecord);var p=s.ganttProperties,h=r.taskFields;return t.isNullOrUndefined(h.startDate)||this.updateScheduleFields(a,p,"startDate"),t.isNullOrUndefined(h.endDate)||this.updateScheduleFields(a,p,"endDate"),t.isNullOrUndefined(h.duration)||this.updateScheduleFields(a,p,"duration"),this.dialogEditValidationFlag=!1,!0},e.prototype.updateScheduleFields=function(e,i,r){var n,a=this.parent,o=a.element.id,s=t.getValue(r,a.columnMapping),l=a.columnByField[s];if("stringedit"===l.editType){var d=e.querySelector("#"+o+s).ej2_instances[0];n=this.parent.dataOperation.getDurationString(i.duration,i.durationUnit),d.value!==n&&(d.value=n,d.dataBind())}else if("datepickeredit"===l.editType||"datetimepickeredit"===l.editType){var p=(l.editType,e.querySelector("#"+o+s).ej2_instances[0]);n=i[r],(t.isNullOrUndefined(p.value)&&!t.isNullOrUndefined(n)||t.isNullOrUndefined(n)&&!t.isNullOrUndefined(p.value)||p.value!==n&&!t.isNullOrUndefined(p.value)&&!t.isNullOrUndefined(n)&&p.value.toString()!==n.toString())&&(p.value=n,p.dataBind())}},e.prototype.validateDuration=function(e){var i=e.ganttProperties;if(!this.dialogEditValidationFlag){t.isNullOrUndefined(i.duration)?(this.parent.setRecordValue("endDate",null,i,!0),this.parent.setRecordValue("isMilestone",!1,i,!0)):g(i)||!t.isNullOrUndefined(i.startDate)?(e.ganttProperties.isMilestone&&0!==e.ganttProperties.duration&&this.parent.dateValidationModule.calculateStartDate(e),this.parent.dateValidationModule.calculateEndDate(e)):g(i)||t.isNullOrUndefined(i.endDate)||this.parent.dateValidationModule.calculateStartDate(e);var r=0===i.duration;this.parent.setRecordValue("isMilestone",r,i,!0),this.dialogEditValidationFlag=!0}},e.prototype.validateStartDate=function(e){var i=e.ganttProperties,r=this.parent.taskFields;this.dialogEditValidationFlag||(t.isNullOrUndefined(i.startDate)?(this.parent.setRecordValue("endDate",null,i,!0),this.parent.setRecordValue("isMilestone",!1,i,!0)):g(i)?t.isNullOrUndefined(r.duration)?this.parent.dateValidationModule.calculateDuration(e):(t.isNullOrUndefined(r.endDate),this.parent.dateValidationModule.calculateEndDate(e)):t.isNullOrUndefined(i.endDate)?t.isNullOrUndefined(i.duration)||this.parent.dateValidationModule.calculateEndDate(e):this.parent.dateValidationModule.calculateDuration(e),this.dialogEditValidationFlag=!0)},e.prototype.validateEndDate=function(e){var i=e.ganttProperties,r=this.parent.taskFields;this.dialogEditValidationFlag||(t.isNullOrUndefined(i.endDate)?(this.parent.setRecordValue("duration",null,i,!0),this.parent.setRecordValue("isMilestone",!1,i,!0)):g(i)?t.isNullOrUndefined(r.duration)?this.parent.dateValidationModule.calculateDuration(e):t.isNullOrUndefined(i.startDate)?this.parent.dateValidationModule.calculateStartDate(e):this.parent.dateValidationModule.calculateDuration(e):t.isNullOrUndefined(i.duration)?t.isNullOrUndefined(i.startDate)||this.parent.dateValidationModule.calculateDuration(e):this.parent.dateValidationModule.calculateStartDate(e),this.dialogEditValidationFlag=!0)},e.prototype.validateScheduleValuesByCurrentField=function(e,i,r){var n=this.parent,a=r.ganttProperties,o=n.taskFields;if(o.duration===e&&(t.isNullOrUndefined(i)||""===i?n.allowUnscheduledTasks&&this.parent.setRecordValue("duration",null,a,!0):n.dataOperation.updateDurationValue(i,a),this.validateDuration(r)),o.startDate===e){if(""!==i){var s=this.parent.dateValidationModule.getDateFromFormat(i);s=this.parent.dateValidationModule.checkStartDate(s),this.parent.setRecordValue("startDate",s,a,!0)}else n.allowUnscheduledTasks&&!r.hasChildRecords&&this.parent.setRecordValue("startDate",null,a,!0);this.validateStartDate(r)}if(o.endDate===e){if(""!==i){var l=this.parent.dateValidationModule.getDateFromFormat(i);0===l.getHours()&&86400!==n.defaultEndTime&&this.parent.dateValidationModule.setTime(n.defaultEndTime,l),l=this.parent.dateValidationModule.checkEndDate(l,a),(t.isNullOrUndefined(a.startDate)||l.getTime()>a.startDate.getTime())&&this.parent.setRecordValue("endDate",l,a,!0)}else n.allowUnscheduledTasks&&this.parent.setRecordValue("endDate",null,a,!0);this.validateEndDate(r)}return!0},e.prototype.getPredecessorModel=function(e){(t.isNullOrUndefined(e)||0===e.length)&&(e=["ID","Name","Type","Offset"]);var i={};i.editSettings={allowEditing:!0,allowAdding:!0,allowDeleting:!0,mode:"Normal"},i.locale=this.parent.locale,i.dataSource=[],i.rowHeight=this.parent.isAdaptive?48:null,i.toolbar=[{id:this.parent.element.id+"DependencyTabContainer_add",prefixIcon:"e-add",tooltipText:this.localeObj.getConstant("add"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("add")},{id:this.parent.element.id+"DependencyTabContainer_delete",prefixIcon:"e-delete",tooltipText:this.localeObj.getConstant("delete"),align:"Right",text:this.parent.isAdaptive?"":this.localeObj.getConstant("delete")}];for(var r=[],n=0;n<e.length;n++){var a={};"id"===e[n].toLowerCase()?(a={field:"id",headerText:this.localeObj.getConstant("id"),allowEditing:!1,width:"70px"},r.push(a)):"name"===e[n].toLowerCase()?(a={field:"name",headerText:this.localeObj.getConstant("name"),editType:"stringedit",width:"250px",validationRules:{required:!0}},r.push(a)):"type"===e[n].toLowerCase()?(a={field:"type",headerText:this.localeObj.getConstant("type"),editType:"dropdownedit",dataSource:this.types,foreignKeyField:"id",foreignKeyValue:"text",defaultValue:"FS",validationRules:{required:!0},width:"150px"},r.push(a)):"offset"===e[n].toLowerCase()&&(a={field:"offset",headerText:this.localeObj.getConstant("offset"),editType:"stringedit",defaultValue:"0 days",validationRules:{required:!0},width:"100px"},r.push(a))}return i.columns=r,i.height=this.parent.isAdaptive?"100%":"153px",i},e.prototype.getResourcesModel=function(e){var i=this.parent;(t.isNullOrUndefined(e)||0===e.length)&&(e=[i.resourceIDMapping,i.resourceNameMapping]);for(var r={allowFiltering:!0,locale:this.parent.locale,allowSelection:!0,rowHeight:this.parent.isAdaptive?48:null,filterSettings:{type:"Menu"},selectionSettings:{checkboxOnly:!0,checkboxMode:"ResetOnRowClick",persistSelection:!0,type:"Multiple"}},n=[{type:"checkbox",allowEditing:!1,allowSorting:!1,allowFiltering:!1,width:60}],a=0;a<e.length;a++){var o={};e[a]===i.resourceIDMapping?(o={field:i.resourceIDMapping,headerText:this.localeObj.getConstant("id"),isPrimaryKey:!0,width:"100px"},n.push(o)):e[a]===i.resourceNameMapping&&(o={field:i.resourceNameMapping,headerText:this.localeObj.getConstant("name")},n.push(o))}return r.columns=n,r.height=this.parent.isAdaptive?"100%":"196px",r},e.prototype.getNotesModel=function(e){(t.isNullOrUndefined(e)||0===e.length)&&(e=["Bold","Italic","Underline","StrikeThrough","FontName","FontSize","FontColor","BackgroundColor","LowerCase","UpperCase","|","Alignments","OrderedList","UnorderedList","Outdent","Indent","|","CreateTable","CreateLink","|","ClearFormat","Print","|","Undo","Redo"]);return{placeholder:this.localeObj.getConstant("writeNotes"),toolbarSettings:{items:e},height:this.parent.isAdaptive?"100%":"auto",locale:this.parent.locale}},e.prototype.createDivElement=function(e,i){return t.createElement("div",{className:e,id:i})},e.prototype.createInputElement=function(e,i,r,n){return t.createElement(n||"input",{className:e,attrs:{type:"text",id:i,name:r,title:r}})},e.prototype.renderTabItems=function(){for(var e=this.beforeOpenArgs.tabModel.items,t=0,i=0;i<e.length;i++){var r=e[i];r.content instanceof HTMLElement||("General"===r.content?r.content=this.renderGeneralTab(r.content):"Dependency"===r.content?(this.editedRecord.hasChildRecords&&(r.disabled=!0),r.content=this.renderPredecessorTab(r.content)):"Resources"===r.content?r.content=this.renderResourceTab(r.content):r.content==="Custom"+t?(r.content=this.renderCustomTab(r.content),t++):"Notes"===r.content&&(r.content=this.renderNotesTab(r.content)))}},e.prototype.renderGeneralTab=function(e){for(var t=this.parent,i=this.beforeOpenArgs[e],r=this.createDivElement("e-edit-form-row",t.element.id+""+e+"TabContainer"),n=0,a=Object.keys(i);n<a.length;n++){var o=a[n],s=this.parent.columnByField[o],l=i[o];r.appendChild(this.renderInputElements(l,s))}return r},e.prototype.isCheckIsDisabled=function(e){var t=!1;return this.isEdit&&(e.field===this.parent.taskFields.id&&(t=!0),this.editedRecord.hasChildRecords&&(e.field===this.parent.taskFields.endDate?t=!0:e.field===this.parent.taskFields.duration?t=!0:e.field===this.parent.taskFields.progress?t=!0:e.field===this.parent.taskFields.progress&&(t=!0))),t},e.prototype.renderPredecessorTab=function(e){var i=this,a=this.parent,o=this.beforeOpenArgs[e],s=this.beforeOpenArgs.rowData,l=[];this.taskNameCollection(),this.isEdit&&(l=this.predecessorEditCollection(s),this.updatePredecessorDropDownData(s)),o.dataSource=l;o.columns[1].edit={write:function(e){new c.ComboBox({dataSource:new n.DataManager(i.preTableCollection),popupHeight:"180px",allowCustom:!1,fields:{value:"text"},value:e.rowData.name,change:function(e){var r=t.closest(e.element,"tr").querySelector("#"+i.parent.element.id+"DependencyTabContainerid");t.isNullOrUndefined(e.itemData)||t.isNullOrUndefined(e.item)?r.value="":r.value=e.itemData.id},autofill:!0}).appendTo(e.element)},read:function(e){return e.ej2_instances[0].value}},r.Grid.Inject(r.Edit,r.Page,r.Toolbar,r.ForeignKey);var d=new r.Grid(o),p=this.createDivElement("e-dependent-div",a.element.id+""+e+"TabContainer");return d.appendTo(p),p},e.prototype.updateResourceCollection=function(e,i){if(!t.isNullOrUndefined(e.data)&&Object.keys(e.data).length){var r=this.parent.element.querySelector("#"+i).ej2_instances[0];!t.isNullOrUndefined(r)&&r.selectionModule.getSelectedRecords().length>0?this.ganttResources=t.extend([],r.selectionModule.getSelectedRecords()):this.ganttResources=[]}},e.prototype.renderResourceTab=function(e){var i=this,n=this.parent,a=this.beforeOpenArgs.rowData,o=this.beforeOpenArgs[e],s=n.element.id+""+e+"TabContainer";o.dataSource=n.resources;var l=a.ganttProperties.resourceInfo;if(this.isEdit&&!t.isNullOrUndefined(l))for(var d=0;d<l.length;d++)this.ganttResources.push(l[d]);o.rowSelected=function(e){i.updateResourceCollection(e,s)},o.rowDeselected=function(e){i.updateResourceCollection(e,s)};var p=this.createDivElement("e-resource-div",s);r.Grid.Inject(r.Selection,r.Filter);return new r.Grid(o).appendTo(p),p},e.prototype.renderCustomTab=function(e){return this.renderGeneralTab(e)},e.prototype.renderNotesTab=function(e){var t=this.parent,i=this.beforeOpenArgs[e],r=this.editedRecord.ganttProperties,n=this.createDivElement("",t.element.id+""+e+"TabContainer");l.RichTextEditor.Inject(l.Toolbar,l.Link,l.HtmlEditor,l.QuickToolbar,l.Count),i.value=r.notes;return new l.RichTextEditor(i).appendTo(n),n},e.prototype.renderInputElements=function(e,t){var i=this.parent.element.id,r=this.editedRecord,n=this.createDivElement("e-edit-form-column"),a=this.createInputElement("",i+""+t.field,t.field);if(n.appendChild(a),e.enabled=!this.isCheckIsDisabled(t),t.field===this.parent.taskFields.duration){var o=r.ganttProperties;e.value=this.parent.dataOperation.getDurationString(o.duration,o.durationUnit)}else e.value=r[t.field];return new this.inputs[t.editType](e).appendTo(a),n},e.prototype.taskNameCollection=function(){var e=this.parent.flatData;this.preTaskIds=[],this.preTableCollection=[];for(var t=0;t<e.length;t++){var i=e[t];if(!i.hasChildRecords){var r={id:i.ganttProperties.taskId.toString(),text:i.ganttProperties.taskId.toString()+"-"+i.ganttProperties.taskName,value:i.ganttProperties.taskId.toString()};this.preTaskIds.push(r.id),this.preTableCollection.push(r)}}},e.prototype.predecessorEditCollection=function(e){var i=[],r=e.ganttProperties;if(this.isEdit&&!t.isNullOrUndefined(this.parent.taskFields.dependency)&&!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(r.predecessor))for(var n=r.predecessor,a=this.preTableCollection,o=0;o<n.length;o++){var s=n[o].from.toString(),l={};if(r.taskId.toString()!==s){l.id=s;for(var d=0;d<a.length;d++)if(a[d].value===s){l.name=a[d].text;break}l.type=n[o].type;var p=Math.abs(n[o].offset),h=n[o].offsetUnit;l.offset=this.parent.dataOperation.getDurationString(p,h),i.push(l)}}return i},e.prototype.updatePredecessorDropDownData=function(e){var t=-1,i=e.ganttProperties.taskId.toString();t=this.preTaskIds.indexOf(i),this.preTableCollection.splice(t,1),this.preTaskIds.splice(t,1),this.validSuccessorTasks(e,this.preTaskIds,this.preTableCollection)},e.prototype.validSuccessorTasks=function(e,t,i){var r=this,n=e.ganttProperties;if(n.predecessor&&n.predecessor.length>0){var a=n.predecessor,o=n.taskId.toString();a.forEach(function(e){if(e.from.toString()===o){var n=e.to,a=-1;(a=t.indexOf(n))>-1&&(t.splice(a,1),i.splice(a,1));var s=r.parent.getRecordByID(n);r.validSuccessorTasks(s,t,i)}})}},e.prototype.getPredecessorType=function(){var e=[this.parent.getPredecessorTextValue("SS"),this.parent.getPredecessorTextValue("SF"),this.parent.getPredecessorTextValue("FS"),this.parent.getPredecessorTextValue("FF")];return[{id:"FS",text:e[2],value:e[2]},{id:"FF",text:e[3],value:e[3]},{id:"SS",text:e[0],value:e[0]},{id:"SF",text:e[1],value:e[1]}]},e.prototype.initiateDialogSave=function(){this.isEdit?this.parent.initiateEditAction(!0):this.addedRecord={};for(var e=this.parent,i=this.beforeOpenArgs.tabModel.items,r=0;r<i.length;r++){var n=i[r].content,a=n.id;t.isNullOrUndefined(a)&&""===a||("General"===(a=(a=a.replace(e.element.id,"")).replace("TabContainer",""))?this.updateGeneralTab(n,!1):"Dependency"===a?this.updatePredecessorTab(n):"Notes"===a?this.updateNotesTab(n):"Resources"===a?this.updateResourceTab(n):-1!==a.indexOf("Custom")&&this.updateCustomTab(n))}if(this.isEdit){this.parent.dataOperation.updateWidthLeft(this.rowData);var o={data:this.rowData,action:"DialogEditing"};this.parent.editModule.initiateUpdateAction(o)}else this.parent.editModule.addRecord(this.addedRecord,this.parent.editSettings.newRowPosition);return!0},e.prototype.updateGeneralTab=function(e,t){var i=this.parent,r=e.childNodes,n={};this.isEdit||(n=this.addedRecord);for(var a=0;a<r.length;a++){var o=r[a],s=o.querySelector('input[id^="'+i.element.id+'"]');if(s){var l=s.id.replace(i.element.id,""),d=o.querySelector("#"+i.element.id+l).ej2_instances[0];n[l]=d.value}}this.isEdit&&(this.updateScheduleProperties(this.editedRecord,this.rowData),i.editModule.validateUpdateValues(n,this.rowData,!0))},e.prototype.updateScheduleProperties=function(e,i){this.parent.setRecordValue("startDate",e.ganttProperties.startDate,i.ganttProperties,!0),this.parent.setRecordValue("endDate",e.ganttProperties.endDate,i.ganttProperties,!0),this.parent.setRecordValue("duration",e.ganttProperties.duration,i.ganttProperties,!0),this.parent.setRecordValue("durationUnit",e.ganttProperties.durationUnit,i.ganttProperties,!0),t.isNullOrUndefined(this.parent.taskFields.startDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.startDate),t.isNullOrUndefined(this.parent.taskFields.endDate)||this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.endDate),t.isNullOrUndefined(this.parent.taskFields.duration)||(this.parent.dataOperation.updateMappingData(this.rowData,this.parent.taskFields.duration),this.parent.setRecordValue("durationUnit",e.ganttProperties.durationUnit,this.rowData,!0),0===this.rowData.ganttProperties.duration?this.parent.setRecordValue("isMilestone",!0,this.rowData.ganttProperties,!0):this.parent.setRecordValue("isMilestone",!1,this.rowData.ganttProperties,!0))},e.prototype.updatePredecessorTab=function(e){var t=e.ej2_instances[0];t.isEdit&&t.endEdit();for(var i=t.dataSource,r=[],n=[],a="",o=[],s=0;s<i.length;s++){var l=i[s];if(-1===o.indexOf(l.id)){var d=l.id+l.type;l.offset&&-1!==l.offset.indexOf("-")?d+=l.offset:d+="+"+l.offset,r.push(d),o.push(l.id)}}this.isEdit?(r.length>0?(n=this.parent.predecessorModule.calculatePredecessor(r.join(","),this.rowData),this.parent.setRecordValue("predecessor",n,this.rowData.ganttProperties,!0),a=this.parent.predecessorModule.getPredecessorStringValue(this.rowData)):(n=[],this.parent.setRecordValue("predecessor",n,this.rowData.ganttProperties,!0),a=""),this.parent.setRecordValue("predecessorsName",a,this.rowData.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,a,this.rowData),this.parent.setRecordValue(this.parent.taskFields.dependency,a,this.rowData)):this.addedRecord[this.parent.taskFields.dependency]=r.length>0?r.join(","):""},e.prototype.updateResourceTab=function(e){e.ej2_instances[0];var t=this.ganttResources,i=[];if(this.isEdit)this.parent.setRecordValue("resourceInfo",t,this.rowData.ganttProperties,!0),this.parent.dataOperation.updateMappingData(this.rowData,"resourceInfo");else{for(var r=0;r<t.length;r++)i.push(t[r][this.parent.resourceIDMapping]);this.addedRecord[this.parent.taskFields.resourceInfo]=i}},e.prototype.updateNotesTab=function(e){var t=this.parent,i=e.ej2_instances[0];this.isEdit?(this.parent.setRecordValue("notes",i.getHtml(),this.rowData.ganttProperties,!0),t.dataOperation.updateMappingData(this.rowData,"notes")):this.addedRecord[this.parent.taskFields.notes]=i.getHtml()},e.prototype.updateCustomTab=function(e){this.updateGeneralTab(e,!0)},e}(),Rt=function(){function e(e){this.validationPredecessor=null,this.confirmPredecessorDialog=null,this.predecessorIndex=null,this.childRecord=null,this.parent=e,this.dateValidateModule=this.parent.dateValidationModule,this.parent.on("initPredessorDialog",this.initPredecessorValidationDialog,this)}return e.prototype.updateConnectorLineEditElement=function(e){var i=this.getConnectorLineHoverElement(e.target);t.getValue("editModule.taskbarEditModule.taskBarEditAction",this.parent)||this.highlightConnectorLineElements(i)},e.prototype.getConnectorLineHoverElement=function(e){var t=u(e,Q),i=u(e,$),r=u(e,J);return t||i||r?u(e,K):null},e.prototype.highlightConnectorLineElements=function(e){e?e!==this.connectorLineElement&&(this.removeHighlight(),this.addHighlight(e)):this.removeHighlight()},e.prototype.addHighlight=function(e){this.connectorLineElement=e,t.addClass([e],[ie]),t.addClass(e.querySelectorAll("."+Q),[te]),t.addClass(e.querySelectorAll("."+$),[re]),t.addClass(e.querySelectorAll("."+J),[ne])},e.prototype.removeHighlight=function(){t.isNullOrUndefined(this.connectorLineElement)||(t.removeClass([this.connectorLineElement],[ie]),t.removeClass(this.connectorLineElement.querySelectorAll("."+Q),[te]),t.removeClass(this.connectorLineElement.querySelectorAll("."+$),[re]),t.removeClass(this.connectorLineElement.querySelectorAll("."+J),[ne]),this.connectorLineElement=null)},e.prototype.getEditedConnectorLineString=function(e){for(var i,r,n,a,o,s,l=[],d=[],p="",h=0;h<e.length;h++)if(i=e[h],r=i.ganttProperties.predecessor){for(var c=0;c<r.length;c++){n=r[c];if(this.removeConnectorLineById("parent"+n.from+"child"+n.to),a=this.parent.getRecordByID(n.from),o=this.parent.getRecordByID(n.to),(a&&!0===a.expanded||o&&!0===o.expanded)&&(s=this.parent.predecessorModule.updateConnectorLineObject(a,o,n),!t.isNullOrUndefined(s))){var u=l.indexOf(s.connectorLineId),g=this.parent.connectorLineModule.getConnectorLineTemplate(s);-1!==u?d[u]=g:(l.push(s.connectorLineId),d.push(g))}}p=d.join("")}return p},e.prototype.refreshEditedRecordConnectorLine=function(e){this.removePreviousConnectorLines(this.parent.previousRecords);var t;t=this.getEditedConnectorLineString(e),this.parent.connectorLineModule.dependencyViewContainer.innerHTML=this.parent.connectorLineModule.dependencyViewContainer.innerHTML+t},e.prototype.removePreviousConnectorLines=function(e){for(var i,r=(i=!0===t.isObject(e))?Object.keys(e).length:e.length,n=Object.keys(e),a=0;a<r;a++){var o=void 0,s=void 0;if(i){o=e[n[a]]}else o=e[a];if((s=o.ganttProperties&&o.ganttProperties.predecessor)&&s.length>0)for(var l=0;l<s.length;l++){var d="parent"+s[l].from+"child"+s[l].to;this.removeConnectorLineById(d)}}},e.prototype.removeConnectorLineById=function(e){var i=this.parent.connectorLineModule.dependencyViewContainer.querySelector("#ConnectorLine"+e);t.isNullOrUndefined(i)||t.remove(i)},e.prototype.idFromPredecessor=function(e){for(var i=e.split(","),r=[],n=0;n<i.length;n++){for(var a=[],o=0;o<i[n].length&&(!t.isNullOrUndefined(i[n].charAt(o))&&"NaN"!==parseInt(i[n].charAt(o),10).toString());o++)a.push(i[n].charAt(o));r.push(a.join(""))}return r},e.prototype.predecessorValidation=function(e,i){for(var r,n,a=i.taskId,o=0;o<e.length;o++){r=e[o];var s=[];e.slice(0).splice(o,1);for(var l=function(){var e=[];return-1!==s.indexOf(r)?"break":t.isNullOrUndefined(d.parent.getRecordByID(r))?{value:!1}:(n=d.parent.getRecordByID(r).ganttProperties,!t.isNullOrUndefined(n.predecessor)&&n.predecessor.length>0&&n.predecessor.forEach(function(t){n.taskId.toString()!==t.from&&e.push(t.from.toString())}),a.toString()===n.taskId.toString()||-1!==e.indexOf(a.toString())?{value:!1}:(s.push(r),!t.isNullOrUndefined(n.predecessor)&&n.predecessor.length>0?void(r=n.predecessor[0].from):"break"))},d=this;null!==r;){var p=l();if("object"==typeof p)return p.value;if("break"===p)break}}return!0},e.prototype.validatePredecessorRelation=function(e,i){var r,n,a=e.ganttProperties.taskId;if(!t.isNullOrUndefined(i)&&i.length>0){r=this.idFromPredecessor(i);for(var o=function(i){if(!s.checkParentRelation(e,r))return{value:!1};var o=[],l=!0;if(r.slice(0).forEach(function(e){-1===o.indexOf(e)?o.push(e):l=!1}),!l)return{value:!1};n=r[i];var d=[];r.slice(0).splice(i,1);for(var p=function(){var i,r,o=[];if(-1!==d.indexOf(n))return"break";if(t.isNullOrUndefined(s.parent.getRecordByID(n.toString())))return{value:!1};if(r=s.parent.getRecordByID(n.toString()).ganttProperties,!t.isNullOrUndefined(r.predecessor)&&r.predecessor.length>0&&r.predecessor.forEach(function(e,t){r.taskId.toString()!==e.from&&(o.push(e.from.toString()),i=t)}),a.toString()===r.taskId.toString()||-1!==o.indexOf(a.toString()))return{value:!1};if(d.push(n),t.isNullOrUndefined(r.predecessor)||!(r.predecessor.length>0))return"break";var l=void 0;return o.length>1?l=s.predecessorValidation(o,e.ganttProperties):1===o.length&&(n=r.predecessor[i].from),!1===l?{value:!1}:void 0};null!==n;){var h=p();if("object"==typeof h)return h;if("break"===h)break}},s=this,l=0;l<r.length;l++){var d=o(l);if("object"==typeof d)return d.value}}return!0},e.prototype.addPredecessor=function(e,i){var r=t.isNullOrUndefined(e.ganttProperties.predecessorsName)||""===e.ganttProperties.predecessorsName?i:e.ganttProperties.predecessorsName+","+i;this.updatePredecessorHelper(e,r)},e.prototype.removePredecessor=function(e){this.updatePredecessorHelper(e,null)},e.prototype.updatePredecessor=function(e,t){return this.updatePredecessorHelper(e,t)},e.prototype.updatePredecessorHelper=function(e,i){if(t.isUndefined(i)||this.validatePredecessorRelation(e,i)){this.parent.isOnEdit=!0;var r=[];t.isNullOrUndefined(i)||""===i||(r=this.parent.predecessorModule.calculatePredecessor(i,e)),this.parent.setRecordValue("predecessor",r,e.ganttProperties,!0);var n=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",n,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,n,e),this.parent.setRecordValue(this.parent.taskFields.dependency,n,e);var a={};return a.data=e,this.parent.editModule.initiateUpdateAction(a),!0}return!1},e.prototype.checkParentRelation=function(e,t){var i=e;if(i&&i.parentItem&&-1!==t.indexOf(i.parentItem.taskId.toString()))return!1;for(var r=function(e){var i=n.parent.currentViewData.filter(function(i){return i&&i.ganttProperties.taskId.toString()===t[e].toString()});if(i[0]&&i[0].hasChildRecords)return{value:!1}},n=this,a=0;a<t.length;a++){var o=r(a);if("object"==typeof o)return o.value}return!0},e.prototype.initPredecessorValidationDialog=function(){if(this.parent.taskFields.dependency&&this.parent.isInPredecessorValidation){var e=t.createElement("div",{id:this.parent.element.id+"_dialogValidationRule"});this.parent.element.appendChild(e),this.renderValidationDialog()}},e.prototype.renderValidationDialog=function(){var e=new i.Dialog({header:"Validate Editing",isModal:!0,visible:!1,width:"50%",showCloseIcon:!0,close:this.validationDialogClose.bind(this),content:"",buttons:[{click:this.validationDialogOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.validationDialogCancelButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});document.getElementById(this.parent.element.id+"_dialogValidationRule").innerHTML="",e.isStringTemplate=!0,e.appendTo("#"+this.parent.element.id+"_dialogValidationRule"),this.parent.validationDialogElement=e},e.prototype.validationDialogOkButton=function(){var e=this.parent.currentEditedArgs;e.validateMode.preserveLinkWithEditing=document.getElementById(this.parent.element.id+"_ValidationAddlineOffset").checked,e.validateMode.removeLink=document.getElementById(this.parent.element.id+"_ValidationRemoveline").checked,e.validateMode.respectLink=document.getElementById(this.parent.element.id+"_ValidationCancel").checked,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()},e.prototype.validationDialogCancelButton=function(){this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption(),this.parent.validationDialogElement.hide()},e.prototype.validationDialogClose=function(e){t.getValue("isInteraction",e)&&(this.parent.currentEditedArgs.validateMode.respectLink=!0,this.applyPredecessorOption())},e.prototype.applyPredecessorOption=function(){var e=this.parent.currentEditedArgs,t=e.data;e.validateMode.respectLink?(this.parent.editModule.reUpdatePreviousRecords(),this.parent.chartRowsModule.refreshRecords([e.data])):e.validateMode.removeLink?(this.removePredecessors(t,this.validationPredecessor),this.parent.editModule.updateEditedTask(e.editEventArgs)):e.validateMode.preserveLinkWithEditing&&(this.calculateOffset(t),this.parent.editModule.updateEditedTask(e.editEventArgs))},e.prototype.calculateOffset=function(e){for(var i=t.extend([],e.ganttProperties.predecessor,[],!0),r=this.parent.predecessorModule.getValidPredecessor(e),n=0;n<r.length;n++){var a=r[n],o=this.parent.getRecordByID(a.from),s=void 0;if(g(o.ganttProperties)&&g(e.ganttProperties)){var l=void 0,d=void 0,p=void 0,h=void 0;switch(a.type){case"FS":l=new Date(o.ganttProperties.endDate.getTime()),d=new Date(e.ganttProperties.startDate.getTime());break;case"SS":l=new Date(o.ganttProperties.startDate.getTime()),d=new Date(e.ganttProperties.startDate.getTime());break;case"SF":l=new Date(o.ganttProperties.startDate.getTime()),d=new Date(e.ganttProperties.endDate.getTime());break;case"FF":l=new Date(o.ganttProperties.endDate.getTime()),d=new Date(e.ganttProperties.endDate.getTime())}if(l.getTime()<d.getTime())l=this.dateValidateModule.checkStartDate(l),d=this.dateValidateModule.checkEndDate(d,null),h=!1;else{var c=new Date(l.getTime());l=this.dateValidateModule.checkStartDate(d),d=this.dateValidateModule.checkEndDate(c,null),h=!0}l.getTime()<d.getTime()?(p=this.dateValidateModule.getDuration(l,d,a.offsetUnit,!0,!0),s=h?-1*p:p):s=0}else s=0;i[D(a,"from",i,"to")].offset=s;var u=t.extend([],o.ganttProperties.predecessor,[],!0);u[D(a,"from",u,"to")].offset=s,this.parent.setRecordValue("predecessor",u,o.ganttProperties,!0)}this.parent.setRecordValue("predecessor",i,e.ganttProperties,!0);var f=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,f,e),this.parent.setRecordValue(this.parent.taskFields.dependency,f,e),this.parent.setRecordValue("predecessorsName",f,e.ganttProperties,!0)},e.prototype.removePredecessors=function(e,i){for(var r=t.extend([],[],e.ganttProperties.predecessor,!0),n=i.length,a=0;a<n;a++){var o=this.parent.getRecordByID(i[a].from),s=t.extend([],[],o.ganttProperties.predecessor,!0),l=D(i[a],"from",r,"to");r.splice(l,1);var d=D(i[a],"from",s,"to");s.splice(d,1),this.parent.setRecordValue("predecessor",s,o.ganttProperties,!0)}if(r.length!==e.ganttProperties.predecessor.length){this.parent.setRecordValue("predecessor",r,e.ganttProperties,!0);var p=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",p,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,p,e),this.parent.setRecordValue(this.parent.taskFields.dependency,p,e)}},e.prototype.openValidationDialog=function(e){var t=this.validationDialogTemplate(e);this.parent.validationDialogElement.setProperties({content:t}),this.parent.validationDialogElement.show()},e.prototype.validationDialogTemplate=function(e){var i,r,n=this.parent.element.id,a=t.createElement("div",{className:"e-ValidationContent"}),o=t.getValue("task",e),s=t.getValue("parentTask",e),l=t.getValue("violationType",e),d=o.ganttProperties.taskName,p=this.parent.getFormatedDate(o.ganttProperties.startDate,"MM/dd/yyyy"),h=[d,s.ganttProperties.taskName];"taskBeforePredecessor_FS"===l?r=this.parent.localeObj.getConstant("taskBeforePredecessor_FS"):"taskAfterPredecessor_FS"===l?r=this.parent.localeObj.getConstant("taskAfterPredecessor_FS"):"taskBeforePredecessor_SS"===l?r=this.parent.localeObj.getConstant("taskBeforePredecessor_SS"):"taskAfterPredecessor_SS"===l?r=this.parent.localeObj.getConstant("taskAfterPredecessor_SS"):"taskBeforePredecessor_FF"===l?r=this.parent.localeObj.getConstant("taskBeforePredecessor_FF"):"taskAfterPredecessor_FF"===l?r=this.parent.localeObj.getConstant("taskAfterPredecessor_FF"):"taskBeforePredecessor_SF"===l?r=this.parent.localeObj.getConstant("taskBeforePredecessor_SF"):"taskAfterPredecessor_SF"===l&&(r=this.parent.localeObj.getConstant("taskAfterPredecessor_SF")),i='<div id="'+n+'_ValidationText">'+(r=v(r,h))+"<div>";var c='<table><tr><td><input type="radio" id="'+n+'_ValidationCancel" name="ValidationRule" checked/><label for="'+n+'_ValidationCancel" id= "'+n+'_cancelLink">Cancel, keep the existing link</label></td></tr><tr><td><input type="radio" id="'+n+'_ValidationRemoveline" name="ValidationRule"/><label for="'+n+'_ValidationRemoveline" id="'+n+'_removeLink">Remove the link and move <b>'+d+"</b> to start on <b>"+p+'</b>.</label></td></tr><tr><td><input type="radio" id="'+n+'_ValidationAddlineOffset" name="ValidationRule"/><label for="'+n+'_ValidationAddlineOffset" id="'+n+'_preserveLink">Move the <b>'+d+"</b> to start on <b>"+p+"</b> and keep the link.</label></td></tr></table>";return a.innerHTML=i+c,a},e.prototype.validateTypes=function(e){var i,r=this.parent.predecessorModule.getValidPredecessor(e);this.validationPredecessor=[];for(var n,a,o=this.parent.predecessorModule.getPredecessorDate(e,r),s=e.ganttProperties,l=this.dateValidateModule.getEndDate(o,s.duration,s.durationUnit,s,!1),d=0;d<r.length;d++){i=this.parent.getRecordByID(r[d].from);var p=null;"FS"===r[d].type?s.startDate<o?(this.validationPredecessor.push(r[d]),p="taskBeforePredecessor_FS"):s.startDate>o&&(this.validationPredecessor.push(r[d]),p="taskAfterPredecessor_FS"):"SS"===r[d].type?s.startDate<o?(this.validationPredecessor.push(r[d]),p="taskBeforePredecessor_SS"):s.startDate>o&&(this.validationPredecessor.push(r[d]),p="taskAfterPredecessor_SS"):"FF"===r[d].type?l<i.ganttProperties.endDate?(this.validationPredecessor.push(r[d]),p="taskBeforePredecessor_FF"):l>i.ganttProperties.endDate&&(this.validationPredecessor.push(r[d]),p="taskAfterPredecessor_FF"):"SF"===r[d].type&&(l<i.ganttProperties.startDate?(this.validationPredecessor.push(r[d]),p="taskBeforePredecessor_SF"):l>i.ganttProperties.startDate&&(this.validationPredecessor.push(r[d]),p="taskAfterPredecessor_SF")),!t.isNullOrUndefined(p)&&t.isNullOrUndefined(a)&&(n=i,a=p)}return{parentTask:n,task:e,violationType:a}},e.prototype.addRemovePredecessor=function(e){var i=this.parent.previousRecords[e.uniqueID],r=e.ganttProperties.predecessor.slice();if(i&&i.ganttProperties&&i.ganttProperties.hasOwnProperty("predecessor")){var n=i.ganttProperties.predecessor;if(!t.isNullOrUndefined(n))for(var a=0;a<n.length;a++){if((d=this.parent.getRecordByID(n[a].from))===e)e.ganttProperties.predecessor.push(n[a]);else{var o=t.extend([],[],d.ganttProperties.predecessor,!0),s=D(n[a],"from",o,"to");-1!==s&&(o.splice(s,1),this.parent.setRecordValue("predecessor",o,d.ganttProperties,!0))}}if(!t.isNullOrUndefined(r))for(var l=0;l<r.length;l++){var d=this.parent.getRecordByID(r[l].from);(o=t.extend([],[],d.ganttProperties.predecessor,!0)).push(r[l]),this.parent.setRecordValue("predecessor",o,d.ganttProperties,!0)}}},e.prototype.removePredecessorByIndex=function(e,t){var i=e.ganttProperties.predecessor,r=i.splice(t,1),n=this.parent.getRecordByID(r[0].from).ganttProperties.predecessor,a=D(r[0],"from",n,"to");n.splice(a,1);var o=this.parent.predecessorModule.getPredecessorStringValue(e);i.push(r[0]),this.parent.connectorLineEditModule.updatePredecessor(e,o)},e.prototype.renderPredecessorDeleteConfirmDialog=function(){this.confirmPredecessorDialog=new i.Dialog({width:"320px",isModal:!0,content:this.parent.localeObj.getConstant("confirmPredecessorDelete"),buttons:[{click:this.confirmOkDeleteButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.confirmCloseDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});var e=t.createElement("div",{id:this.parent.element.id+"_deletePredecessorConfirmDialog"});this.parent.element.appendChild(e),this.confirmPredecessorDialog.isStringTemplate=!0,this.confirmPredecessorDialog.appendTo(e)},e.prototype.confirmCloseDialog=function(){this.confirmPredecessorDialog.destroy()},e.prototype.confirmOkDeleteButton=function(){this.removePredecessorByIndex(this.childRecord,this.predecessorIndex),this.confirmPredecessorDialog.destroy()},e}(),Et=function(){return(Et=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++){t=arguments[i];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)},Ot=function(){function e(e){if(this.isFromDeleteMethod=!1,this.targetedRecords=[],this.confirmDialog=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,this.isBreakLoop=!1,this.deletedTaskDetails=[],this.parent=e,this.validatedChildItems=[],this.parent.editSettings.allowEditing&&"Auto"===this.parent.editSettings.mode&&(this.cellEditModule=new wt(this.parent)),this.parent.taskFields.dependency&&(this.parent.connectorLineEditModule=new Rt(this.parent)),(this.parent.editSettings.allowAdding||this.parent.editSettings.allowEditing&&("Dialog"===this.parent.editSettings.mode||"Auto"===this.parent.editSettings.mode))&&(this.dialogModule=new Pt(this.parent),"Dialog"===this.parent.editSettings.mode&&(this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this))),this.parent.editSettings.allowTaskbarEditing&&(this.taskbarEditModule=new Ct(this.parent)),this.parent.editSettings.allowDeleting){var i=t.createElement("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(i),this.renderDeleteConfirmDialog()}this.parent.treeGrid.editSettings.allowAdding=this.parent.editSettings.allowAdding,this.parent.treeGrid.editSettings.allowDeleting=this.parent.editSettings.allowDeleting,this.parent.treeGrid.editSettings.showDeleteConfirmDialog=this.parent.editSettings.showDeleteConfirmDialog,this.updateDefaultColumnEditors()}return e.prototype.getModuleName=function(){return"edit"},e.prototype.updateDefaultColumnEditors=function(){for(var e=[this.parent.taskFields.id,this.parent.taskFields.progress,this.parent.taskFields.resourceInfo],i=0;i<e.length;i++)if(!t.isNullOrUndefined(e[i])&&e[i].length>0){var r=this.parent.getColumnByField(e[i],this.parent.treeGridModule.treeGridColumns);r&&(r.field===this.parent.taskFields.id?this.updateIDColumnEditParams(r):r.field===this.parent.taskFields.progress?this.updateProgessColumnEditParams(r):r.field===this.parent.taskFields.resourceInfo&&this.updateResourceColumnEditor(r))}},e.prototype.updateIDColumnEditParams=function(e){this.updateEditParams(e,{min:0,decimals:0,validateDecimalOnType:!0,format:"n0",showSpinButton:!1})},e.prototype.updateProgessColumnEditParams=function(e){this.updateEditParams(e,{min:0,decimals:0,validateDecimalOnType:!0,max:100,format:"n0"})},e.prototype.updateEditParams=function(e,i){t.isNullOrUndefined(e.edit)?(e.edit={},e.edit.params={}):t.isNullOrUndefined(e.edit.params)&&(e.edit.params={}),t.extend(e.edit.params,i);this.parent.getColumnByField(e.field,this.parent.ganttColumns).edit=e.edit},e.prototype.updateResourceColumnEditor=function(e){if(this.parent.editSettings.allowEditing&&t.isNullOrUndefined(e.edit)&&"Auto"===this.parent.editSettings.mode){e.editType="dropdownedit",e.edit=this.getResourceEditor();var i=this.parent.getColumnByField(e.field,this.parent.ganttColumns);i.editType="dropdownedit",i.edit=e.edit}},e.prototype.getResourceEditor=function(){var e,i=this,r={};return c.MultiSelect.Inject(c.CheckBoxSelection),r.write=function(t){i.parent.treeGridModule.currentEditRow={},(e=new c.MultiSelect({dataSource:new n.DataManager(i.parent.resources),fields:{text:i.parent.resourceNameMapping,value:i.parent.resourceIDMapping},mode:"CheckBox",showDropDownIcon:!0,popupHeight:"350px",delimiterChar:",",value:i.parent.treeGridModule.getResourceIds(t.rowData)})).appendTo(t.element)},r.read=function(e){var r=e.ej2_instances[0].value,n=[];t.isNullOrUndefined(r)&&(r=[]);for(var a=0;a<r.length;a++)for(var o=0;o<i.parent.resources.length;o++)if(i.parent.resources[o][i.parent.resourceIDMapping]===r[a]){n.push(i.parent.resources[o][i.parent.resourceNameMapping]);break}return i.parent.treeGridModule.currentEditRow[i.parent.taskFields.resourceInfo]=r,n.join(",")},r.destroy=function(){e&&e.destroy()},r},e.prototype.reUpdateEditModules=function(){var e=this.parent.editSettings;if(e.allowEditing?(this.parent.editModule.cellEditModule&&"Dialog"===e.mode?(this.cellEditModule.destroy(),this.parent.treeGrid.recordDoubleClick=this.recordDoubleClick.bind(this)):t.isNullOrUndefined(this.parent.editModule.cellEditModule)&&"Auto"===e.mode&&(this.cellEditModule=new wt(this.parent)),this.parent.editModule.dialogModule&&"Auto"===e.mode?this.parent.treeGrid.recordDoubleClick=void 0:t.isNullOrUndefined(this.parent.editModule.dialogModule)&&(this.dialogModule=new Pt(this.parent)),t.isNullOrUndefined(this.parent.editModule.taskbarEditModule)&&(this.taskbarEditModule=new Ct(this.parent))):(this.cellEditModule&&this.cellEditModule.destroy(),this.taskbarEditModule&&this.taskbarEditModule.destroy(),this.dialogModule&&this.dialogModule.destroy()),e.allowDeleting&&e.showDeleteConfirmDialog){if(t.isNullOrUndefined(this.confirmDialog)){var i=t.createElement("div",{id:this.parent.element.id+"_deleteConfirmDialog"});this.parent.element.appendChild(i),this.renderDeleteConfirmDialog()}}else e.allowDeleting&&e.showDeleteConfirmDialog||this.confirmDialog&&!this.confirmDialog.isDestroyed&&this.confirmDialog.destroy()},e.prototype.recordDoubleClick=function(e){var i;if(e.row){var r=t.getValue("rowIndex",e.row);i=this.parent.currentViewData[r]}!t.isNullOrUndefined(i)&&this.parent.editSettings.allowEditing&&this.dialogModule.openEditDialog(i)},e.prototype.destroy=function(){this.cellEditModule&&this.cellEditModule.destroy(),this.taskbarEditModule&&this.taskbarEditModule.destroy(),this.dialogModule&&this.dialogModule.destroy(),this.confirmDialog&&!this.confirmDialog.isDestroyed&&this.confirmDialog.destroy()},e.prototype.updateRecordByID=function(e){var i=this.parent.taskFields;if(!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(e[i.id])){var r=this.parent.getRecordByID(e[i.id]);if(t.isBlazor()){-1===(n=Object.keys(e)).indexOf(i.startDate)||t.isNullOrUndefined(t.getValue(this.parent.taskFields.startDate,e))||t.setValue(this.parent.taskFields.startDate,this.parent.dataOperation.getDateFromFormat(t.getValue(this.parent.taskFields.startDate,e)),e),-1===n.indexOf(i.endDate)||t.isNullOrUndefined(t.getValue(this.parent.taskFields.endDate,e))||t.setValue(this.parent.taskFields.endDate,this.parent.dataOperation.getDateFromFormat(t.getValue(this.parent.taskFields.endDate,e)),e),-1===n.indexOf(i.baselineStartDate)||t.isNullOrUndefined(t.getValue(this.parent.taskFields.baselineStartDate,e))||t.setValue(this.parent.taskFields.baselineStartDate,this.parent.dataOperation.getDateFromFormat(t.getValue(this.parent.taskFields.baselineStartDate,e)),e),-1===n.indexOf(i.baselineEndDate)||t.isNullOrUndefined(t.getValue(this.parent.taskFields.baselineEndDate,e))||t.setValue(this.parent.taskFields.baselineEndDate,this.parent.dataOperation.getDateFromFormat(t.getValue(this.parent.taskFields.baselineEndDate,e)),e)}if(!t.isNullOrUndefined(this.parent.editModule)&&r){this.parent.isOnEdit=!0,this.validateUpdateValues(e,r,!0);var n;if(-1===(n=Object.keys(e)).indexOf(i.startDate)&&-1===n.indexOf(i.endDate)&&-1===n.indexOf(i.duration)||this.parent.dataOperation.calculateScheduledValues(r,r.taskData,!1),this.parent.dataOperation.updateWidthLeft(r),t.isUndefined(e[this.parent.taskFields.dependency])||e[this.parent.taskFields.dependency]===r.ganttProperties.predecessorsName){var a={};a.data=r,this.parent.editModule.initiateUpdateAction(a)}else this.parent.connectorLineEditModule.updatePredecessor(r,e[this.parent.taskFields.dependency])}}},e.prototype.validateUpdateValues=function(e,i,r){for(var n=this.parent,a=n.taskFields,o=f(n.columnMapping),s=[],l=!1,d=0,p=Object.keys(e);d<p.length;d++){var h=p[d];if(!t.isNullOrUndefined(h)&&!t.isNullOrUndefined(e[h]))if(-1!==[a.startDate,a.endDate,a.duration].indexOf(h))r?a.duration===h?(n.dataOperation.updateDurationValue(e[h],i.ganttProperties),i.ganttProperties.duration>0&&i.ganttProperties.isMilestone&&this.parent.setRecordValue("isMilestone",!1,i.ganttProperties,!0),n.dataOperation.updateMappingData(i,o[h])):(n.setRecordValue(o[h],e[h],i.ganttProperties,!0),n.dataOperation.updateMappingData(i,o[h])):(s.push(h),l=!0);else if(a.resourceInfo===h){var c=n.dataOperation.setResourceInfo(e);i.ganttProperties.resourceInfo=c,n.dataOperation.updateMappingData(i,"resourceInfo")}else if(a.dependency===h);else if(-1!==[a.progress,a.notes,a.durationUnit,a.expandState,a.milestone,a.name,a.baselineStartDate,a.baselineEndDate,a.indicators,a.id].indexOf(h)){var u=n.columnByField[h],g=e[h];"datepickeredit"!==u.editType&&"datetimepickeredit"!==u.editType||(g=n.dataOperation.getDateFromFormat(g));var m=o[h];h===a.id?m="taskId":h===a.name&&(m="taskName"),n.setRecordValue(m,g,i.ganttProperties,!0),(h===a.baselineStartDate||h===a.baselineEndDate)&&i.ganttProperties.baselineStartDate&&i.ganttProperties.baselineEndDate&&(n.setRecordValue("baselineLeft",n.dataOperation.calculateBaselineLeft(i.ganttProperties),i.ganttProperties,!0),n.setRecordValue("baselineWidth",n.dataOperation.calculateBaselineWidth(i.ganttProperties),i.ganttProperties,!0)),n.setRecordValue("taskData."+h,g,i),n.setRecordValue(h,g,i)}else if(-1!==n.customColumns.indexOf(h)){u=n.columnByField[h],g=e[h];"datepickeredit"!==u.editType&&"datetimepickeredit"!==u.editType||(g=n.dataOperation.getDateFromFormat(g)),n.setRecordValue("taskData."+h,g,i),n.setRecordValue(h,g,i)}}l&&this.validateScheduleValues(s,i,e)},e.prototype.validateScheduleValues=function(e,t,i){var r=this.parent;e.length>2?r.dataOperation.calculateScheduledValues(t,i,!1):e.length>1?this.validateScheduleByTwoValues(i,e,t):this.dialogModule.validateScheduleValuesByCurrentField(e[0],i[e[0]],t)},e.prototype.validateScheduleByTwoValues=function(e,t,i){var r,n,a,o=this.parent,s=o.taskFields,l=i.ganttProperties,d=o.allowUnscheduledTasks;-1!==t.indexOf(s.startDate)&&(r=e[s.startDate]),-1!==t.indexOf(s.endDate)&&(n=e[s.endDate]),-1!==t.indexOf(s.duration)&&(a=e[s.duration]),r&&n||d&&-1!==t.indexOf(s.startDate)&&-1!==t.indexOf(s.endDate)?(o.setRecordValue("startDate",o.dataOperation.getDateFromFormat(r),l,!0),o.setRecordValue("endDate",o.dataOperation.getDateFromFormat(n),l,!0),o.dataOperation.calculateDuration(i)):n&&a||d&&-1!==t.indexOf(s.endDate)&&-1!==t.indexOf(s.duration)?(o.setRecordValue("endDate",o.dataOperation.getDateFromFormat(n),l,!0),o.dataOperation.updateDurationValue(a,l)):(r&&a||d&&-1!==t.indexOf(s.startDate)&&-1!==t.indexOf(s.duration))&&(o.setRecordValue("startDate",o.dataOperation.getDateFromFormat(r),l,!0),o.dataOperation.updateDurationValue(a,l))},e.prototype.isTaskbarMoved=function(e){var i=!1,r=e.ganttProperties,n=this.parent.previousRecords&&this.parent.previousRecords[e.uniqueID];if(n&&n.ganttProperties){var a=t.getValue("ganttProperties.startDate",n),o=t.getValue("ganttProperties.endDate",n),s=t.getValue("ganttProperties.duration",n),l=t.getValue("ganttProperties.durationUnit",n),d=Object.keys(n.ganttProperties);-1===d.indexOf("startDate")&&-1===d.indexOf("endDate")&&-1===d.indexOf("duration")&&-1===d.indexOf("durationUnit")||(t.isNullOrUndefined(a)&&!t.isNullOrUndefined(r.startDate)||t.isNullOrUndefined(o)&&!t.isNullOrUndefined(r.endDate)||t.isNullOrUndefined(r.startDate)&&!t.isNullOrUndefined(a)||t.isNullOrUndefined(r.endDate)&&!t.isNullOrUndefined(o)||a&&a.getTime()!==r.startDate.getTime()||o&&o.getTime()!==r.endDate.getTime()||!t.isNullOrUndefined(s)&&s!==r.duration||!t.isNullOrUndefined(s)&&s===r.duration&&l!==r.durationUnit)&&(i=!0)}return i},e.prototype.isPredecessorUpdated=function(e){var t=!1,i=this.parent.previousRecords[e.uniqueID];return i&&i.ganttProperties&&i.ganttProperties.hasOwnProperty("predecessor")&&(e.ganttProperties.predecessorsName!==i.ganttProperties.predecessorsName?t=!0:this.parent.setRecordValue("predecessor",i.ganttProperties.predecessor,e.ganttProperties,!0)),t},e.prototype.isCheckPredecessor=function(e){var t=!1;return this.parent.previousRecords[e.uniqueID]&&this.parent.taskFields.dependency&&this.parent.isInPredecessorValidation&&this.parent.predecessorModule.getValidPredecessor(e).length>0&&this.isTaskbarMoved(e)&&(t=!0),t},e.prototype.initiateUpdateAction=function(e){var i=this.isCheckPredecessor(e.data);this.taskbarMoved=this.isTaskbarMoved(e.data),this.predecessorUpdated=this.isPredecessorUpdated(e.data),this.predecessorUpdated&&(this.parent.isConnectorLineUpdate=!0,this.parent.connectorLineEditModule.addRemovePredecessor(e.data));var r={};if(i)if(r=this.parent.connectorLineEditModule.validateTypes(e.data),this.parent.isConnectorLineUpdate=!0,t.isNullOrUndefined(t.getValue("violationType",r)))this.updateEditedTask(e);else{var n=this.validateTaskEvent(e);!1===n.validateMode.preserveLinkWithEditing&&!1===n.validateMode.removeLink&&!1===n.validateMode.respectLink?this.parent.connectorLineEditModule.openValidationDialog(r):this.parent.connectorLineEditModule.applyPredecessorOption()}else this.taskbarMoved&&(this.parent.isConnectorLineUpdate=!0),this.updateEditedTask(e)},e.prototype.validateTaskEvent=function(e){var i={},r={};return this.resetValidateArgs(),this.parent.currentEditedArgs=i,i.cancel=!1,i.data=e.data,i.requestType="validateLinkedTask",i.validateMode=this.parent.dialogValidateMode,i.editEventArgs=e,t.isBlazor()&&(r=Et({},i),this.parent.updateDataArgs(i),this.parent.currentEditedArgs=r),this.parent.actionBeginTask(i),t.isBlazor()?r:i},e.prototype.resetValidateArgs=function(){this.parent.dialogValidateMode.preserveLinkWithEditing=!0,this.parent.dialogValidateMode.removeLink=!1,this.parent.dialogValidateMode.respectLink=!1},e.prototype.updateEditedTask=function(e){var t=e.data;if(t.parentItem&&this.parent.dataOperation.updateParentItems(t.parentItem),this.updateParentChildRecord(t),this.parent.isConnectorLineUpdate){for(var i=0;i<this.validatedChildItems.length;i++){var r=this.validatedChildItems[i];r.ganttProperties.predecessor&&r.ganttProperties.predecessor.length>0&&(this.parent.editedTaskBarItem=r,this.parent.predecessorModule.validatePredecessor(r,[],""))}t.ganttProperties.predecessor&&(this.parent.isMileStoneEdited=t.ganttProperties.isMilestone,this.taskbarMoved&&(this.parent.editedTaskBarItem=t),this.parent.predecessorModule.validatePredecessor(t,[],""))}this.initiateSaveAction(e)},e.prototype.updateParentChildRecord=function(e){var t=e;t.hasChildRecords&&this.taskbarMoved&&this.updateChildItems(t)},e.prototype.calculateDateByRoundOffDuration=function(e,i){var r=e,n=r.ganttProperties,a=new Date(i.getTime());if(!t.isNullOrUndefined(n.endDate)&&t.isNullOrUndefined(n.startDate)){var o=this.parent.dateValidationModule.checkStartDate(a,n,null);this.parent.setRecordValue("endDate",this.parent.dateValidationModule.checkEndDate(o,r.ganttProperties),n,!0)}else this.parent.setRecordValue("startDate",this.parent.dateValidationModule.checkStartDate(a,n),n,!0),t.isNullOrUndefined(n.duration)||this.parent.dateValidationModule.calculateEndDate(r);this.parent.dataOperation.updateWidthLeft(e),this.parent.dataOperation.updateTaskData(r)},e.prototype.updateParentProgress=function(e){var i=0,r=this.parent.getParentTask(e),n=r.childRecords,a=n?n.length:0,o=0,s=0,l=0,d={};if(n){for(var p=0;p<a;p++)n[p].ganttProperties.isMilestone&&!n[p].hasChildRecords||!g(n[p].ganttProperties)?s+=1:(d=this.parent.dataOperation.getParentProgress(n[p]),o+=t.getValue("totalProgress",d),l+=t.getValue("totalDuration",d));i=a-s>0?Math.round(o/l):0,isNaN(i)&&(i=0),this.parent.setRecordValue("progressWidth",this.parent.dataOperation.getProgressWidth(r.ganttProperties.width,i),r.ganttProperties,!0),this.parent.setRecordValue("progress",Math.floor(i),r.ganttProperties,!0),this.parent.setRecordValue("totalProgress",o,r.ganttProperties,!0),this.parent.setRecordValue("totalDuration",l,r.ganttProperties,!0)}this.parent.dataOperation.updateTaskData(r),r.parentItem&&this.updateParentProgress(r.parentItem)},e.prototype.revertCellEdit=function(e){this.parent.editModule.reUpdatePreviousRecords(!1,!0),this.resetEditProperties()},e.prototype.reUpdatePreviousRecords=function(e,t){for(var i=this.parent.previousRecords,r=Object.keys(i),n=0;n<r.length;n++){var a=r[n],o=i[a],s=this.parent.getTaskByUniqueID(a);this.copyTaskData(s.taskData,o.taskData),delete o.taskData,this.copyTaskData(s.ganttProperties,o.ganttProperties),delete o.ganttProperties,this.copyTaskData(s,o);var l=this.parent.currentViewData.indexOf(s);if(e&&this.parent.chartRowsModule.refreshRow(l),t){this.parent.treeGrid.grid.setRowData(s.ganttProperties.taskId,s);this.parent.treeGrid.grid.getRowObjectFromUID(this.parent.treeGrid.grid.getDataRows()[l].getAttribute("data-uid")).data=s}}},e.prototype.copyTaskData=function(e,i){t.isNullOrUndefined(i)||t.extend(e,i)},e.prototype.updateScheduleDatesOnEditing=function(e){},e.prototype.updateChildItems=function(e){var i,r=this.parent.previousRecords[e.uniqueID];i=t.isNullOrUndefined(r)||t.isNullOrUndefined(r)&&!t.isNullOrUndefined(r.ganttProperties)?new Date(e.ganttProperties.startDate.getTime()):new Date(r.ganttProperties.startDate.getTime());var n,a,o,s,l,d=e.ganttProperties.startDate,p=[];if(this.getUpdatableChildRecords(e,p),0!==p.length){i.getTime()>d.getTime()?(n=this.parent.dateValidationModule.checkStartDate(d),a=this.parent.dateValidationModule.checkEndDate(i,e.ganttProperties),s=!1):(n=this.parent.dateValidationModule.checkStartDate(i),a=this.parent.dateValidationModule.checkEndDate(d,e.ganttProperties),s=!0),l=n.getTime()>=a.getTime()?0:this.parent.dateValidationModule.getDuration(n,a,"minute",!0,!1);for(var h=0;h<p.length;h++)if(p[h].ganttProperties.isAutoSchedule)if(l>0){var c=g(p[h].ganttProperties)?p[h].ganttProperties.startDate:p[h].ganttProperties.startDate?p[h].ganttProperties.startDate:p[h].ganttProperties.endDate?p[h].ganttProperties.endDate:new Date(i.toString());o=s?this.parent.dateValidationModule.getEndDate(this.parent.dateValidationModule.checkStartDate(c,p[h].ganttProperties,p[h].ganttProperties.isMilestone),l,"minute",p[h].ganttProperties,!1):this.parent.dateValidationModule.getStartDate(this.parent.dateValidationModule.checkEndDate(c,p[h].ganttProperties),l,"minute",p[h].ganttProperties),this.calculateDateByRoundOffDuration(p[h],o),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(p[h])&&this.validatedChildItems.push(p[h])}else t.isNullOrUndefined(r)&&(o=i,this.calculateDateByRoundOffDuration(p[h],o),this.parent.isOnEdit&&-1===this.validatedChildItems.indexOf(p[h])&&this.validatedChildItems.push(p[h]))}},e.prototype.getUpdatableChildRecords=function(e,t){for(var i=e.childRecords,r=0;r<i.length;r++)i[r].ganttProperties.isAutoSchedule&&(t.push(i[r]),i[r].hasChildRecords&&this.getUpdatableChildRecords(i[r],t))},e.prototype.initiateSaveAction=function(e){var i=this;this.parent.showSpinner();var r={},a=[];r.requestType="beforeSave",r.data=e.data,r.modifiedRecords=this.parent.editedRecords,r.modifiedTaskData=y(this.parent.editedRecords),t.isBlazor()&&(r=this.parent.updateDataArgs(r),a=r.modifiedTaskData),this.parent.trigger("actionBegin",r,function(r){if(r.cancel)i.reUpdatePreviousRecords(),i.parent.chartRowsModule.refreshRecords([e.data]),i.resetEditProperties();else if(m(i.parent.dataSource)){var o=i.parent.dataSource,s={changedRecords:t.isBlazor()?a:r.modifiedTaskData};o.saveChanges(s,i.parent.taskFields.id,null,new n.Query).then(function(t){return i.dmSuccess(t,e)}).catch(function(t){return i.dmFailure(t,e)})}else i.saveSuccess(e)})},e.prototype.dmSuccess=function(e,t){this.saveSuccess(t)},e.prototype.dmFailure=function(e,t){if(this.deletedTaskDetails.length){for(var i=this.deletedTaskDetails,r=0;r<i.length;r++)i[r].isDelete=!1;this.deletedTaskDetails=[]}this.reUpdatePreviousRecords(!0,!0),this.resetEditProperties(),this.parent.trigger("actionFailure",{error:e})},e.prototype.saveSuccess=function(e){var i={};if(this.parent.timelineSettings.updateTimescaleView){var r=this.parent.editedRecords;this.parent.timelineModule.updateTimeLineOnEditing(r,e.action)}this.parent.chartRowsModule.refreshRecords(this.parent.editedRecords),this.parent.isConnectorLineUpdate&&!t.isNullOrUndefined(this.parent.connectorLineEditModule)&&(this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.connectorLineEditModule.refreshEditedRecordConnectorLine(this.parent.editedRecords),this.updateScheduleDatesOnEditing(e)),i.requestType="save",i.data=e.data,i.modifiedRecords=this.parent.editedRecords,i.modifiedTaskData=y(this.parent.editedRecords),t.isNullOrUndefined(e.action)||t.setValue("action",e.action,i),this.endEditAction(e),t.isBlazor()&&this.parent.updateDataArgs(i),this.parent.trigger("actionComplete",i)},e.prototype.resetEditProperties=function(){this.parent.currentEditedArgs={},this.resetValidateArgs(),this.parent.editedTaskBarItem=null,this.parent.isOnEdit=!1,this.validatedChildItems=[],this.parent.isConnectorLineUpdate=!1,this.parent.editedTaskBarItem=null,this.taskbarMoved=!1,this.predecessorUpdated=!1,t.isNullOrUndefined(this.dialogModule)||(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose()),this.parent.hideSpinner(),this.parent.initiateEditAction(!1)},e.prototype.endEditAction=function(e){this.resetEditProperties(),"TaskbarEditing"===e.action?this.parent.trigger("taskbarEdited",e):"CellEditing"===e.action?this.parent.trigger("endEdit",e):"DialogEditing"===e.action&&(this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose())},e.prototype.saveFailed=function(e){this.reUpdatePreviousRecords(),this.parent.hideSpinner()},e.prototype.renderDeleteConfirmDialog=function(){var e=new i.Dialog({width:"320px",isModal:!0,visible:!1,content:this.parent.localeObj.getConstant("confirmDelete"),buttons:[{click:this.confirmDeleteOkButton.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("okText"),isPrimary:!0}},{click:this.closeConfirmDialog.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],target:this.parent.element,animationSettings:{effect:"None"}});e.appendTo("#"+this.parent.element.id+"_deleteConfirmDialog"),this.confirmDialog=e},e.prototype.closeConfirmDialog=function(){this.confirmDialog.hide()},e.prototype.confirmDeleteOkButton=function(){this.deleteSelectedItems(),this.confirmDialog.hide();this.parent.element.querySelector(".e-treegrid").focus()},e.prototype.startDeleteAction=function(){this.parent.editSettings.allowDeleting&&(this.parent.editSettings.showDeleteConfirmDialog?this.confirmDialog.show():this.deleteSelectedItems())},e.prototype.deleteSelectedItems=function(){if(this.isFromDeleteMethod)this.targetedRecords.length&&this.deleteRow(this.targetedRecords),this.isFromDeleteMethod=!1;else{var e=[];"Cell"!==this.parent.selectionSettings.mode?e=this.parent.selectionModule.getSelectedRecords():"Cell"===this.parent.selectionSettings.mode&&(e=this.parent.selectionModule.getCellSelectedRecords()),this.deleteRow(e)}},e.prototype.deleteRecord=function(e){this.isFromDeleteMethod=!0;var i=typeof e;switch(this.targetedRecords=[],i){case"number":case"string":var r=e.toString();t.isNullOrUndefined(r)||-1===this.parent.ids.indexOf(r)||this.targetedRecords.push(this.parent.getRecordByID(r));break;case"object":Array.isArray(e)?this.updateTargetedRecords(e):this.targetedRecords.push(e.valueOf())}this.startDeleteAction()},e.prototype.updateTargetedRecords=function(e){if(e.length){if("object"===typeof e[0])this.targetedRecords=e;else for(var i=0;i<e.length;i++){var r=e[i].toString();t.isNullOrUndefined(r)||-1===this.parent.ids.indexOf(r)||this.targetedRecords.push(this.parent.getRecordByID(r))}}},e.prototype.deleteRow=function(e){this.parent.flatData;var i=e&&e.length?e:this.parent.selectionModule.getSelectedRecords();if(i.length){this.parent.isOnDelete=!0,i.forEach(function(e){e.isDelete=!0});for(var r=0;r<i.length;r++){var n=i[r];if(-1===this.deletedTaskDetails.indexOf(n)){if(n.parentItem){var a=this.parent.getParentTask(n.parentItem).childRecords;(1===a.length?a:a.filter(function(e){return!e.isDelete})).length>0&&this.parent.dataOperation.updateParentItems(n.parentItem)}var o=n.ganttProperties.predecessor;o&&o.length&&this.removePredecessorOnDelete(n),this.deletedTaskDetails.push(n),n.hasChildRecords&&this.deleteChildRecords(n)}}this.parent.selectionModule&&this.parent.allowSelection&&this.parent.selectionModule.clearSelection();var s={};s.deletedRecordCollection=this.deletedTaskDetails,s.updatedRecordCollection=this.parent.editedRecords,s.cancel=!1,s.action="delete",this.initiateDeleteAction(s),this.parent.isOnDelete=!1}t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.removePredecessorOnDelete=function(e){for(var i=e.ganttProperties.predecessor,r=0;r<i.length;r++){var n=i[r];if(n.from.toString()===e.ganttProperties.taskId.toString()){for(var a=this.parent.getRecordByID(n.to.toString()),o=t.extend([],[],a.ganttProperties.predecessor,!0),s=void 0,l=0;l<o.length;l++)if(o[l].to.toString()===a.ganttProperties.taskId.toString()&&o[l].from.toString()===e.ganttProperties.taskId.toString()){s=l;break}o.splice(s,1),this.updatePredecessorValues(a,o)}else if(n.to.toString()===e.ganttProperties.taskId.toString()){var d=this.parent.getRecordByID(n.from.toString()),p=t.extend([],[],d.ganttProperties.predecessor,!0);for(s=void 0,l=0;l<p.length;l++)if(p[l].from.toString()===d.ganttProperties.taskId.toString()&&p[l].to.toString()===e.ganttProperties.taskId.toString()){s=l;break}p.splice(s,1),this.updatePredecessorValues(d,p)}}},e.prototype.updatePredecessorValues=function(e,t){this.parent.setRecordValue("predecessor",t,e.ganttProperties,!0);var i=this.parent.predecessorModule.getPredecessorStringValue(e);this.parent.setRecordValue("predecessorsName",i,e.ganttProperties,!0),this.parent.setRecordValue("taskData."+this.parent.taskFields.dependency,i,e),this.parent.setRecordValue(this.parent.taskFields.dependency,i,e)},e.prototype.deleteChildRecords=function(e){for(var t=e.childRecords,i=0;i<t.length;i++){var r=t[i];if(-1===this.deletedTaskDetails.indexOf(r)){var n=r.ganttProperties.predecessor;n&&n.length&&this.removePredecessorOnDelete(r),this.deletedTaskDetails.push(r),r.hasChildRecords&&this.deleteChildRecords(r)}}},e.prototype.removeFromDataSource=function(e){var t;this.parent.taskFields;t=this.parent.dataSource instanceof n.DataManager?this.parent.dataSource.dataSource.json:this.parent.dataSource,this.removeData(t,e),this.isBreakLoop=!1},e.prototype.removeData=function(e,i){for(var r=0;r<e.length&&!this.isBreakLoop;r++)if(-1!==i.indexOf(t.getValue(this.parent.taskFields.id,e[r]).toString())){if(e[r][this.parent.taskFields.child]){var n=e[r][this.parent.taskFields.child];this.removeData(n,i)}if(i.splice(i.indexOf(t.getValue(this.parent.taskFields.id,e[r]).toString()),1),e.splice(r,1),0===i.length){this.isBreakLoop=!0;break}}else if(e[r][this.parent.taskFields.child]){n=e[r][this.parent.taskFields.child];this.removeData(n,i)}},e.prototype.initiateDeleteAction=function(e){var i=this;this.parent.showSpinner();var r={};r.requestType="beforeDelete",r.data=e.deletedRecordCollection,r.modifiedRecords=e.updatedRecordCollection,r.modifiedTaskData=y(e.updatedRecordCollection);var n={};t.isBlazor()&&(r=this.parent.updateDataArgs(r),n.modifiedTaskData=r.modifiedTaskData,n.data=r.data),this.parent.trigger("actionBegin",r,function(r){if(r.cancel){for(var a=i.deletedTaskDetails,o=0;o<a.length;o++)a[o].isDelete=!1;i.deletedTaskDetails=[],i.reUpdatePreviousRecords(),i.parent.initiateEditAction(!1),i.parent.hideSpinner()}else if(m(i.parent.dataSource)){var s=i.parent.dataSource,l={deletedRecords:t.isBlazor()?y(n.data):y(r.data),changedRecords:t.isBlazor()?n.modifiedTaskData:r.modifiedTaskData};s.saveChanges(l,i.parent.taskFields.id).then(function(t){return i.deleteSuccess(e)}).catch(function(t){return i.dmFailure(t,e)})}else i.deleteSuccess(e)})},e.prototype.deleteSuccess=function(e){for(var i=this.parent.flatData,r=this.parent.currentViewData,n=this.parent.getRecordFromFlatdata(e.deletedRecordCollection),a=[],o=0;o<n.length;o++){var s=n[o],l=r.indexOf(s),d=i.indexOf(s),p=this.parent.treeGrid.parentData.indexOf(s),h=void 0;if(-1!==l&&r.splice(l,1),-1!==d&&i.splice(d,1),a.push(s.ganttProperties.taskId.toString()),-1!==d&&this.parent.ids.splice(d,1),0===s.level&&-1!==p&&this.parent.treeGrid.parentData.splice(p,1),s.parentItem){var c=this.parent.getParentTask(s.parentItem);if(c){var u=c.childRecords;-1!==(h=u.indexOf(s))&&u.splice(h,1),u.length||(c.hasChildRecords=!1)}}this.updateTreeGridUniqueID(s,"delete")}a.length>0&&this.removeFromDataSource(a);var g={};this.parent.updatedConnectorLineCollection=[],this.parent.connectorLineIds=[],this.parent.predecessorModule.createConnectorLinesCollection(this.parent.flatData),this.parent.treeGrid.refresh(),g.requestType="delete",g.data=e.deletedRecordCollection,g.modifiedRecords=e.updatedRecordCollection,g.modifiedTaskData=y(e.updatedRecordCollection),t.setValue("action",e.action,g),t.isBlazor()&&this.parent.updateDataArgs(g),this.parent.trigger("actionComplete",g),this.deletedTaskDetails=[],this.parent.initiateEditAction(!1),this.parent.hideSpinner()},e.prototype.getNewTaskId=function(){var e=n.DataUtil.aggregates.max(this.parent.flatData,this.parent.taskFields.id);return t.isNullOrUndefined(e)?1:parseInt(e.toString(),10)+1},e.prototype.prepareNewlyAddedData=function(e,i){var r,n=this.parent.taskFields,a=this.parent.ids;if(e[n.id]&&(-1!==a.indexOf(e[n.id].toString())?e[n.id]=null:e[n.id]=t.isNullOrUndefined(e[n.id])?null:parseInt(e[n.id],10)),e[n.id]||(r=this.getNewTaskId(),e[n.id]=r),n.name&&!e[n.name]&&(e[n.name]="New Task "+e[n.id]),this.parent.allowUnscheduledTasks||e[n.startDate]||(e[n.startDate]=this.parent.projectStartDate),!this.parent.allowUnscheduledTasks&&n.duration&&t.isNullOrUndefined(e[n.duration])&&(e[n.endDate]||(e[n.duration]="5")),n.progress&&(e[n.progress]=e[n.progress]?e[n.progress]>100?100:e[n.progress]:0),!this.parent.allowUnscheduledTasks&&!e[n.endDate]&&n.endDate&&!e[n.duration]){var o=this.parent.dataOperation.getDateFromFormat(this.parent.projectStartDate);o.setDate(o.getDate()+4),e[n.endDate]=this.parent.getFormatedDate(o,this.parent.dateFormat)}},e.prototype.updateNewlyAddedDataBeforeAjax=function(e,i,r,n){var a;if(a=this.parent.dataOperation.createRecord(e,i),a.index=parseInt(a.ganttProperties.taskId.toString(),10)-1,!t.isNullOrUndefined(n)){this.parent.setRecordValue("parentItem",this.parent.dataOperation.getCloneParent(n),a);var o=a.parentItem?a.parentItem.index:null;this.parent.setRecordValue("parentIndex",o,a);var s=a.parentItem?a.parentItem.uniqueID:null;this.parent.setRecordValue("parentUniqueID",s,a),t.isNullOrUndefined(this.parent.taskFields.id)||t.isNullOrUndefined(this.parent.taskFields.parentID)||!a.parentItem||this.parent.setRecordValue(this.parent.taskFields.parentID,a.parentItem.taskId,a.taskData,!0)}return this.backUpAndPushNewlyAddedRecord(a,r,n),this.parent.isOnEdit=!0,this.parent.taskFields.dependency&&a.ganttProperties.predecessorsName?(this.parent.predecessorModule.ensurePredecessorCollectionHelper(a,a.ganttProperties),this.parent.predecessorModule.updatePredecessorHelper(a),this.parent.predecessorModule.validatePredecessorDates(a)):a.parentItem&&this.parent.getParentTask(a.parentItem).ganttProperties.isAutoSchedule&&this.parent.dataOperation.updateParentItems(a.parentItem),a},e.prototype.getChildCount=function(e,t){var i;if(!e.hasChildRecords)return 0;for(var r=0;r<e.childRecords.length;r++)t++,(i=e.childRecords[r]).hasChildRecords&&(t=this.getChildCount(i,t));return t},e.prototype.getVisibleChildRecordCount=function(e,t,i){var r,n;if(e.hasChildRecords){n=(r=e.childRecords).length;for(var a=0;a<n;a++)-1!==i.indexOf(r[a])&&t++,r[a].hasChildRecords&&(t=this.getVisibleChildRecordCount(r[a],t,i))}else-1!==i.indexOf(e)&&t++;return t},e.prototype.updatePredecessorOnIndentOutdent=function(e){for(var i,r,n=e.ganttProperties.predecessor.length,a=e.ganttProperties,o=a.predecessor,s=0;s<n;s++)if(o[s].to===a.taskId.toString()){i=this.parent.getRecordByID(o[s].from),r=D(o[s],"from",i.ganttProperties.predecessor,"to");var l=void 0;(l=t.extend([],i.ganttProperties.predecessor,[],!0)).splice(r,1),this.parent.setRecordValue("predecessor",l,i.ganttProperties,!0)}else if(o[s].from===a.taskId.toString()){i=this.parent.getRecordByID(o[s].to);this.predecessorToString(i.ganttProperties.predecessor,e);var d=i.ganttProperties.predecessorsName.toString().split(","),p=o[s].from+o[s].type,h=d.indexOf(p);d.splice(h,1),this.parent.setRecordValue("predecessorsName",d.join(","),i.ganttProperties,!0),r=D(o[s],"from",i.ganttProperties.predecessor,"to");var c=void 0;(c=t.extend([],i.ganttProperties.predecessor,[],!0)).splice(r,1),this.parent.setRecordValue("predecessor",c,i.ganttProperties,!0),this.parent.predecessorModule.validatePredecessorDates(i)}this.parent.setRecordValue("predecessor",[],e.ganttProperties,!0),this.parent.setRecordValue("predecessorsName","",e.ganttProperties,!0)},e.prototype.predecessorToString=function(e,t){for(var i=[],r=0,n=e.length;r<n;r++)if(t.ganttProperties.taskId.toString()!==e[r].from){var a=e[r].from+e[r].type;e[r].offset=isNaN(e[r].offset)?0:e[r].offset,0!==e[r].offset&&(e[r].offset<0?a+=e[r].offset.toString()+"d":e[r].offset>0&&(a+="+"+e[r].offset.toString()+"d")),i.push(a)}return i.join(",")},e.prototype.backUpAndPushNewlyAddedRecord=function(e,t,i){var r,n,a,o=this.parent.flatData,s=this.parent.currentViewData,l=this.parent.ids;switch(t){case"Top":o.splice(0,0,e),s.splice(0,0,e),l.splice(0,0,e.ganttProperties.taskId.toString());break;case"Bottom":o.push(e),s.push(e),l.push(e.ganttProperties.taskId.toString());break;case"Above":n=o.indexOf(this.addRowSelectedItem),a=s.indexOf(this.addRowSelectedItem),this.recordCollectionUpdate(void 0,n,a,e,i);break;case"Below":if(r=o.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords){n=r+this.getChildCount(this.addRowSelectedItem,0)+1,a=s.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,s)+1}else n=r+1,a=s.indexOf(this.addRowSelectedItem)+1;this.recordCollectionUpdate(NaN,n,a,e,i);break;case"Child":if(r=o.indexOf(this.addRowSelectedItem),this.addRowSelectedItem.hasChildRecords){n=r+this.getChildCount(this.addRowSelectedItem,0)+1,this.addRowSelectedItem.expanded||this.parent.expandByID(Number(this.addRowSelectedItem.ganttProperties.taskId)),a=s.indexOf(this.addRowSelectedItem)+this.getVisibleChildRecordCount(this.addRowSelectedItem,0,s)+1}else this.addRowSelectedItem.hasChildRecords=!0,this.addRowSelectedItem.childRecords=[],this.addRowSelectedItem.expanded=!0,this.addRowSelectedItem.ganttProperties.isMilestone=!1,n=r+1,a=s.indexOf(this.addRowSelectedItem)+1,this.addRowSelectedItem.ganttProperties.predecessor&&this.updatePredecessorOnIndentOutdent(this.addRowSelectedItem);this.recordCollectionUpdate(NaN,n,a,e,i)}this.newlyAddedRecordBackup=e},e.prototype.recordCollectionUpdate=function(e,i,r,n,a){var o=this.parent.flatData,s=this.parent.currentViewData,l=this.parent.ids;o.splice(i,0,n),s.splice(r,0,n),l.splice(i,0,n.ganttProperties.taskId.toString()),t.isNullOrUndefined(a)||(e=a.childRecords.indexOf(this.addRowSelectedItem),a.childRecords.splice(e,0,n))},e.prototype.constructTaskAddedEventArgs=function(e,t,i){var r={};return r.action=i,r.data=e,r.newTaskData=y([e])[0],r.recordIndex=e.index,r.modifiedRecords=t,r.modifiedTaskData=y(t),r},e.prototype.addSuccess=function(e){this.parent.treeGrid.refresh()},e.prototype.updateRealDataSource=function(e,i){var r,a=this.parent.taskFields;r=this.parent.dataSource instanceof n.DataManager?this.parent.dataSource.dataSource.json:this.parent.dataSource,"Top"===i?r.splice(0,0,e.taskData):"Bottom"===i?r.push(e):t.isNullOrUndefined(a.id)||t.isNullOrUndefined(a.parentID)?this.addDataInRealDataSource(r,e.taskData,i):r.push(e.taskData),this.isBreakLoop=!1},e.prototype.addDataInRealDataSource=function(e,i,r){for(var n=0;n<e.length&&!this.isBreakLoop;n++){if(t.getValue(this.parent.taskFields.id,e[n]).toString()===this.addRowSelectedItem.ganttProperties.taskId.toString()){"Above"===r?e.splice(n,0,i):"Below"===r?e.splice(n+1,0,i):"Child"===r&&(e[n].subtasks&&e[n].subtasks.length>0?e[n].subtasks.push(i):(e[n].subtasks=[],e[n].subtasks.push(i))),this.isBreakLoop=!0;break}if(e[n][this.parent.taskFields.child]){var a=e[n][this.parent.taskFields.child];this.addDataInRealDataSource(a,i,r)}}},e.prototype.addRecord=function(e,i,r){var a=this;if(this.parent.editModule&&this.parent.editSettings.allowAdding){var o=t.isNullOrUndefined(r)||isNaN(parseInt(r.toString(),10))?this.parent.selectionModule?"Row"!==this.parent.selectionSettings.mode&&"Both"!==this.parent.selectionSettings.mode||1!==this.parent.selectionModule.selectedRowIndexes.length?"Cell"===this.parent.selectionSettings.mode&&1===this.parent.selectionModule.getSelectedRowCellIndexes().length?this.parent.selectionModule.getSelectedRowCellIndexes()[0].rowIndex:null:this.parent.selectionModule.selectedRowIndexes[0]:null:r;this.addRowSelectedItem=t.isNullOrUndefined(o)?null:this.parent.currentViewData[o],i=t.isNullOrUndefined(i)?this.parent.editSettings.newRowPosition:i,e=t.isNullOrUndefined(e)?this.parent.editModule.dialogModule.composeAddRecord():e,((t.isNullOrUndefined(o)||o<0||t.isNullOrUndefined(this.addRowSelectedItem))&&("Above"===i||"Below"===i||"Child"===i)||!i||"Above"!==i&&"Below"!==i&&"Child"!==i&&"Top"!==i&&"Bottom"!==i)&&(i="Top");var s,l=0,d={},p=void 0;switch(i){case"Top":case"Bottom":l=0;break;case"Above":case"Below":l=this.addRowSelectedItem.level,p=this.parent.getParentTask(this.addRowSelectedItem.parentItem);break;case"Child":l=this.addRowSelectedItem.level+1,p=this.addRowSelectedItem}this.prepareNewlyAddedData(e,i),s=this.updateNewlyAddedDataBeforeAjax(e,l,i,p),d=this.constructTaskAddedEventArgs(s,this.parent.editedRecords,"beforeAdd"),this.parent.showSpinner();var h={};if(t.isBlazor()){if(!Array.isArray(d.data)){var c=[];c.push(d.data),t.setValue("data",c,d)}h=Et({},d)}this.parent.trigger("actionBegin",d,function(e){if(e.cancel)e=t.isBlazor()?h:e,a.removeAddedRecord(),a.reUpdatePreviousRecords(),a.dialogModule.dialog&&!a.dialogModule.dialogObj.isDestroyed&&a.dialogModule.dialogObj.hide(),a.dialogModule.dialogClose();else if(t.isBlazor()&&(h.data=h.data[0],e=h),m(a.parent.dataSource)){var r=a.parent.dataSource,o={addedRecords:[e.newTaskData],changedRecords:e.modifiedTaskData};r.saveChanges(o,a.parent.taskFields.id,null,new n.Query).then(function(i){a.parent.taskFields.id&&!t.isNullOrUndefined(i.addedRecords[0][a.parent.taskFields.id])&&i.addedRecords[0][a.parent.taskFields.id]!==e.data.ganttProperties.taskId&&(a.parent.setRecordValue("taskId",i.addedRecords[0][a.parent.taskFields.id],e.data.ganttProperties,!0),a.parent.setRecordValue("taskData."+a.parent.taskFields.id,i.addedRecords[0][a.parent.taskFields.id],e.data),a.parent.setRecordValue(a.parent.taskFields.id,i.addedRecords[0][a.parent.taskFields.id],e.data)),0===s.level&&a.parent.treeGrid.parentData.splice(0,0,s),a.updateTreeGridUniqueID(s,"add"),a.refreshNewlyAddedRecord(e,s)}).catch(function(t){a.removeAddedRecord(),a.dmFailure(t,e)})}else a.updateRealDataSource(e.data,i),0===s.level&&a.parent.treeGrid.parentData.splice(0,0,s),a.updateTreeGridUniqueID(s,"add"),a.refreshNewlyAddedRecord(e,s);a.parent.isOnEdit=!1,a.parent.hideSpinner(),a.addRowSelectedItem=null,a.newlyAddedRecordBackup=null,a.isBreakLoop=!1,a.parent.element.tabIndex=0,a.parent.initiateEditAction(!1)})}},e.prototype.updateTreeGridUniqueID=function(e,i){"add"===i?t.setValue("uniqueIDCollection."+e.uniqueID,e,this.parent.treeGrid):"delete"===i&&t.deleteObject(t.getValue("uniqueIDCollection",this.parent.treeGrid),e.uniqueID)},e.prototype.refreshNewlyAddedRecord=function(e,i){if(this.parent.selectionModule&&this.parent.allowSelection&&("Row"===this.parent.selectionSettings.mode||"Both"===this.parent.selectionSettings.mode)&&(this.parent.staticSelectedRowIndex=this.parent.currentViewData.indexOf(e.data)),this.parent.timelineSettings.updateTimescaleView){var r=[];e.modifiedRecords.length>0?(r.push(e.data),r.push.apply(r,e.modifiedRecords)):r=[e.data],this.parent.timelineModule.updateTimeLineOnEditing(r,e.action)}this.addSuccess(e),e=this.constructTaskAddedEventArgs(i,e.modifiedRecords,"add"),t.isBlazor()&&this.parent.updateDataArgs(e),this.parent.trigger("actionComplete",e),this.dialogModule.dialog&&!this.dialogModule.dialogObj.isDestroyed&&this.dialogModule.dialogObj.hide(),this.dialogModule.dialogClose()},e.prototype.removeAddedRecord=function(){var e=this.parent.flatData,i=this.parent.currentViewData,r=this.parent.ids,n=e.indexOf(this.newlyAddedRecordBackup),a=i.indexOf(this.newlyAddedRecordBackup),o=r.indexOf(this.newlyAddedRecordBackup.ganttProperties.taskId.toString());if(t.deleteObject(this.parent.previousRecords,e[n].uniqueID),this.newlyAddedRecordBackup.parentItem){var s=this.parent.getParentTask(this.newlyAddedRecordBackup.parentItem),l=s.childRecords.indexOf(this.newlyAddedRecordBackup);s.childRecords.splice(l,1)}e.splice(n,1),i.splice(a,1),r.splice(o,1)},e}(),xt=function(){function e(e){this.parent=e,a.TreeGrid.Inject(a.Reorder),this.parent.treeGrid.allowReordering=this.parent.allowReordering,this.bindEvents()}return e.prototype.getModuleName=function(){return"reorder"},e.prototype.bindEvents=function(){var e=this;this.parent.treeGrid.columnDragStart=function(t){e.parent.trigger("columnDragStart",t)},this.parent.treeGrid.columnDrag=function(t){e.parent.trigger("columnDrag",t)},this.parent.treeGrid.columnDrop=function(t){e.parent.trigger("columnDrop",t)}},e.prototype.destroy=function(){},e}(),It=function(){function e(e){this.parent=e,a.TreeGrid.Inject(a.Resize),this.parent.treeGrid.allowResizing=this.parent.allowResizing,this.bindEvents()}return e.prototype.getModuleName=function(){return"resize"},e.prototype.bindEvents=function(){var e=this;this.parent.treeGrid.resizeStart=function(t){e.parent.trigger("resizeStart",t)},this.parent.treeGrid.resizing=function(t){e.parent.trigger("resizing",t)},this.parent.treeGrid.resizeStop=function(t){e.parent.trigger("resizeStop",t)}},e.prototype.destroy=function(){},e}(),Lt=function(){function e(e){this.parent=e,a.TreeGrid.Inject(a.Filter),this.parent.treeGrid.allowFiltering=this.parent.allowFiltering,this.updateCustomFilters(),this.parent.treeGrid.filterSettings=r.getActualProperties(this.parent.filterSettings),this.addEventListener()}return e.prototype.getModuleName=function(){return"filter"},e.prototype.updateCustomFilters=function(){for(var e=this.parent.taskFields,t=0;t<this.parent.ganttColumns.length;t++){var i=this.parent.ganttColumns[t];("datepickeredit"!==i.editType&&"datetimepickeredit"!==i.editType||i.field!==e.startDate&&i.field!==e.endDate&&i.field!==e.baselineStartDate&&i.field!==e.baselineEndDate)&&(i.field!==e.duration||"stringedit"!==i.editType)||this.initiateFiltering(this.parent.ganttColumns[t])}},e.prototype.updateModel=function(){this.parent.filterSettings=this.parent.treeGrid.filterSettings},e.prototype.addEventListener=function(){this.parent.on("updateModel",this.updateModel,this),this.parent.on("actionBegin",this.actionBegin,this),this.parent.on("actionComplete",this.actionComplete,this),this.parent.on("columnMenuOpen",this.columnMenuOpen,this)},e.prototype.initiateFiltering=function(e){var t=this.parent.getColumnByField(e.field,this.parent.treeGridModule.treeGridColumns);e.allowFiltering=!1!==e.allowFiltering,e.allowFiltering&&"Menu"===this.parent.filterSettings.type&&!e.filter&&(e.filter={ui:this.getCustomFilterUi(e)}),t&&(t.allowFiltering=e.allowFiltering,t.filter=e.filter)},e.prototype.getCustomFilterUi=function(e){var t=this.parent.taskFields,i={};return"datepickeredit"!==e.editType||e.field!==t.startDate&&e.field!==t.endDate&&e.field!==t.baselineStartDate&&e.field!==t.baselineEndDate?"datetimepickeredit"!==e.editType||e.field!==t.startDate&&e.field!==t.endDate&&e.field!==t.baselineStartDate&&e.field!==t.baselineEndDate?e.field===t.duration&&"stringedit"===e.editType&&(i=this.getDurationFilter()):i=this.getDateTimePickerFilter():i=this.getDatePickerFilter(e.field),i},e.prototype.getDatePickerFilter=function(e){var i,r=this,n=this.parent,a=e===n.taskFields.startDate||e===n.taskFields.baselineStartDate?n.defaultStartTime:n.defaultEndTime;return{create:function(e){var n=t.createElement("input",{className:"flm-input"});e.target.appendChild(n),(i=new h.DatePicker({placeholder:r.parent.localeObj.getConstant("enterValue")})).appendTo(n)},write:function(e){i.value=e.filteredValue},read:function(e){i.value&&i.value.setSeconds(a),e.fltrObj.filterByColumn(e.column.field,e.operator,i.value)}}},e.prototype.getDateTimePickerFilter=function(){var e,i=this;return{create:function(r){var n=t.createElement("input",{className:"flm-input"});r.target.appendChild(n),(e=new h.DateTimePicker({placeholder:i.parent.localeObj.getConstant("enterValue")})).appendTo(n)},write:function(t){e.value=t.filteredValue},read:function(t){t.fltrObj.filterByColumn(t.column.field,t.operator,e.value)}}},e.prototype.getDurationFilter=function(){var e,i=this,r=this.parent,n="";return{create:function(r){var n=t.createElement("input",{className:"e-input"});n.setAttribute("placeholder",i.parent.localeObj.getConstant("enterValue")),r.target.appendChild(n),(e=new d.TextBox).appendTo(n)},write:function(t){e.value=t.filteredValue?n:""},read:function(a){var o=i.parent.dataOperation.getDurationValue(e.value),s=t.getValue("duration",o),l=t.getValue("durationUnit",o);if(s>=0){var d=void 0;"minute"===l?d=60*s/r.secondsPerDay:"hour"===l?d=60*s*60/r.secondsPerDay:(d=s,l="day"),a.fltrObj.filterByColumn(a.column.field,a.operator,d),n=i.parent.dataOperation.getDurationString(s,l)}else a.fltrObj.filterByColumn(a.column.field,a.operator,null),n=null}}},e.prototype.columnMenuOpen=function(e){this.filterMenuElement&&this.parent.element.contains(this.filterMenuElement)&&t.remove(this.filterMenuElement),this.filterMenuElement=null},e.prototype.actionBegin=function(e){},e.prototype.actionComplete=function(e){if(e.requestType===r.filterAfterOpen){this.filterMenuElement=t.getValue("filterModel.dlgObj.element",e),this.updateFilterMenuPosition(this.filterMenuElement,e);var i=this.parent.taskFields.id,n=this.parent.taskFields.dependency,a=this.parent.taskFields.resourceInfo,o=this.parent.treeGrid.grid.filterModule,s=t.getValue("values",o);if(e.columnName===n&&t.isNullOrUndefined(t.getValue(n,s))||e.columnName===a&&t.isNullOrUndefined(t.getValue(a,s))){var l=this.filterMenuElement.querySelector(".e-dropdownlist");(d=t.getValue("ej2_instances[0]",l)).index=2,d.dataBind()}else if(e.columnName===i&&t.isNullOrUndefined(t.getValue(i,s))){l=this.filterMenuElement.querySelector(".e-numerictextbox");var d=t.getValue("ej2_instances[0]",l);!t.isNullOrUndefined(d)&&t.isNullOrUndefined(this.parent.columnByField[e.columnName].format)&&(d.format="n")}}},e.prototype.setPosition=function(e,t){var i=this.parent.element.getBoundingClientRect(),r=e.getBoundingClientRect(),n=r.left-i.left,a=r.top-i.top;i.height<a?a=a-t.offsetHeight+r.height:i.height<a+t.offsetHeight&&(a=i.height-t.offsetHeight),window.innerHeight<t.offsetHeight+a+i.top&&(a=window.innerHeight-t.offsetHeight-i.top),n+=this.parent.enableRtl?-t.offsetWidth:r.width,i.width<=n+t.offsetWidth?n-=r.width+t.offsetWidth:n<0&&(n+=t.offsetWidth+r.width),t.style.top=a+7+"px",t.style.left=n+7+"px"},e.prototype.updateFilterMenuPosition=function(e,i){this.parent.element.appendChild(e);var n;this.parent.showColumnMenu?(n=document.querySelector("#treeGrid"+this.parent.controlId+"_gridcontrol_colmenu_Filter"),this.setPosition(n,t.getValue("filterModel.dlgObj.element",i))):(n=this.parent.treeGrid.grid.getColumnHeaderByField(i.columnName).querySelector(".e-filtermenudiv"),r.getFilterMenuPostion(n,t.getValue("filterModel.dlgObj",i),this.parent.treeGrid.grid))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("updateModel",this.updateModel),this.parent.off("actionBegin",this.actionBegin),this.parent.off("actionComplete",this.actionComplete),this.parent.off("columnMenuOpen",this.columnMenuOpen))},e.prototype.destroy=function(){this.removeEventListener()},e}(),Vt=function(){function e(e){this.parent=e,a.TreeGrid.Inject(a.Sort),this.parent.treeGrid.allowSorting=this.parent.allowSorting,this.parent.treeGrid.sortSettings=r.getActualProperties(this.parent.sortSettings),this.addEventListener()}return e.prototype.getModuleName=function(){return"sort"},e.prototype.addEventListener=function(){this.parent.on("updateModel",this.updateModel,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off("updateModel",this.updateModel)},e.prototype.destroy=function(){this.removeEventListener()},e.prototype.sortColumn=function(e,t,i){this.parent.treeGrid.sortByColumn(e,t,i)},e.prototype.clearSorting=function(){this.parent.treeGrid.clearSorting()},e.prototype.updateModel=function(){this.parent.sortSettings=this.parent.treeGrid.sortSettings},e.prototype.removeSortColumn=function(e){this.parent.treeGrid.grid.removeSortColumn(e)},e}(),Bt=function(){function e(e){this.isSelectionFromChart=!1,this.selectedRowIndexes=[],this.enableSelectMultiTouch=!1,this.openPopup=!1,this.parent=e,this.bindEvents(),this.parent.treeGrid.selectedRowIndex=this.parent.selectedRowIndex,this.parent.treeGrid.allowSelection=this.parent.allowSelection,this.parent.treeGrid.selectionSettings=r.getActualProperties(this.parent.selectionSettings),this.wireEvents()}return e.prototype.getModuleName=function(){return"selection"},e.prototype.wireEvents=function(){this.parent.on("selectRowByIndex",this.selectRowByIndex,this),this.parent.isAdaptive?(this.parent.on("chartMouseClick",this.mouseUpHandler,this),this.parent.on("treeGridClick",this.popUpClickHandler,this)):this.parent.on("chartMouseUp",this.mouseUpHandler,this)},e.prototype.selectRowByIndex=function(){-1===this.parent.selectedRowIndex&&-1===this.parent.staticSelectedRowIndex||(this.selectRow(-1!==this.parent.staticSelectedRowIndex?this.parent.staticSelectedRowIndex:this.parent.selectedRowIndex),this.parent.staticSelectedRowIndex=-1)},e.prototype.bindEvents=function(){this.parent.treeGrid.rowSelecting=this.rowSelecting.bind(this),this.parent.treeGrid.rowSelected=this.rowSelected.bind(this),this.parent.treeGrid.rowDeselecting=this.rowDeselecting.bind(this),this.parent.treeGrid.rowDeselected=this.rowDeselected.bind(this),this.parent.treeGrid.cellSelecting=this.cellSelecting.bind(this),this.parent.treeGrid.cellSelected=this.cellSelected.bind(this),this.parent.treeGrid.cellDeselecting=this.cellDeselecting.bind(this),this.parent.treeGrid.cellDeselected=this.cellDeselected.bind(this)},e.prototype.rowSelecting=function(e){this.parent.isGanttChartRendered?(e.isCtrlPressed=this.isMultiCtrlRequest,e.isShiftPressed=this.isMultiShiftRequest,e.target=this.actualTarget,t.isNullOrUndefined(e.foreignKeyData)||0!==Object.keys(e.foreignKeyData).length||delete e.foreignKeyData,this.parent.trigger("rowSelecting",e)):e.cancel=!0},e.prototype.rowSelected=function(e){var i="Multiple"!==this.parent.selectionSettings.type||t.isNullOrUndefined(e.rowIndexes)?[e.rowIndex]:e.rowIndexes;this.addClass(i),this.selectedRowIndexes=t.extend([],this.getSelectedRowIndexes(),[],!0),this.parent.setProperties({selectedRowIndex:this.parent.treeGrid.selectedRowIndex},!0),this.isMultiShiftRequest&&(this.selectedRowIndexes=i),this.parent.autoFocusTasks&&this.parent.ganttChartModule.updateScrollLeft(t.getValue("data.ganttProperties.left",e)),e.target=this.actualTarget,t.isNullOrUndefined(e.foreignKeyData)||0!==Object.keys(e.foreignKeyData).length||delete e.foreignKeyData,this.prevRowIndex=e.rowIndex,t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),this.parent.trigger("rowSelected",e)},e.prototype.rowDeselecting=function(e){e.target=this.actualTarget,e.isInteracted=this.isInteracted,this.parent.trigger("rowDeselecting",e)},e.prototype.rowDeselected=function(e){var i=e.rowIndexes||e.rowIndex;this.removeClass(i),this.selectedRowIndexes=t.extend([],this.getSelectedRowIndexes(),[],!0),this.parent.setProperties({selectedRowIndex:-1},!0),t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),"Multiple"===this.parent.selectionSettings.type&&this.parent.isAdaptive&&0===this.selectedRowIndexes.length&&this.hidePopUp(),e.target=this.actualTarget,e.isInteracted=this.isInteracted,this.parent.trigger("rowDeselected",e),this.isInteracted=!1},e.prototype.cellSelecting=function(e){var t=new n.Deferred;return this.parent.trigger("cellSelecting",e,function(e){t.resolve(e)}),t},e.prototype.cellSelected=function(e){this.parent.trigger("cellSelected",e),t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.cellDeselecting=function(e){this.parent.trigger("cellDeselecting",e)},e.prototype.cellDeselected=function(e){this.parent.trigger("cellDeselected",e),t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems()},e.prototype.selectCell=function(e,t){this.parent.treeGrid.selectCell(e,t)},e.prototype.selectCells=function(e){this.parent.treeGrid.grid.selectCells(e)},e.prototype.selectRow=function(e,i){var r=this.parent.getRowByIndex(e);-1===e||t.isNullOrUndefined(r)||"Cell"===this.parent.selectionSettings.mode||(this.parent.treeGrid.selectRow(e,i),this.prevRowIndex=e)},e.prototype.selectRows=function(e){!t.isNullOrUndefined(e)&&e.length>0&&this.parent.treeGrid.selectRows(e)},e.prototype.getSelectedRowIndexes=function(){return this.parent.treeGrid.getSelectedRowIndexes()},e.prototype.getSelectedRowCellIndexes=function(){return this.parent.treeGrid.getSelectedRowCellIndexes()},e.prototype.getSelectedRecords=function(){return t.isBlazor()?this.parent.getRecordFromFlatdata(this.parent.treeGrid.getSelectedRecords()):this.parent.treeGrid.getSelectedRecords()},e.prototype.getCellSelectedRecords=function(){for(var e=this.parent.selectionModule.getSelectedRowCellIndexes(),i=[],r=0;r<e.length;r++)i.push(this.parent.currentViewData[e[r].rowIndex]);return t.isBlazor()?this.parent.getRecordFromFlatdata(i):i},e.prototype.getSelectedRows=function(){return this.parent.treeGrid.getSelectedRows()},e.prototype.clearSelection=function(){this.removeClass(this.selectedRowIndexes),this.parent.treeGrid.clearSelection(),this.parent.selectedRowIndex=-1,this.selectedRowIndexes=[],t.isNullOrUndefined(this.parent.toolbarModule)||this.parent.toolbarModule.refreshToolbarItems(),this.isInteracted=!1},e.prototype.highlightSelectedRows=function(e,i){var r=t.closest(e.target,"tbody").children,n=t.closest(e.target,"tr.e-chart-row"),a=[].slice.call(r).indexOf(n);this.isMultiCtrlRequest=e.ctrlKey||this.enableSelectMultiTouch,this.isMultiShiftRequest=e.shiftKey,this.actualTarget=e.target,this.isInteracted=!0,this.isSelectionFromChart=i,i&&("Single"===this.parent.selectionSettings.type||!this.isMultiCtrlRequest&&!this.isMultiShiftRequest?this.selectRow(a,!0):this.isMultiShiftRequest?this.selectRowsByRange(t.isNullOrUndefined(this.prevRowIndex)?a:this.prevRowIndex,a):this.parent.treeGrid.grid.selectionModule.addRowsToSelection([a]))},e.prototype.getselectedrowsIndex=function(e,t){for(var i=[],r=e<t?{i:e,max:t}:{i:t,max:e},n=r.i,a=r.max;n<=a;n++)i.push(n);e>t&&i.reverse(),this.selectedRowIndexes=i},e.prototype.selectRowsByRange=function(e,t){this.isSelectionFromChart=!0,this.getselectedrowsIndex(e,t),this.selectRows(this.selectedRowIndexes)},e.prototype.addClass=function(e){for(var i=document.getElementById(this.parent.element.id+"GanttTaskTableBody").children,r=0;r<e.length;r++)t.isNullOrUndefined(i[e[r]])||(t.addClass([i[e[r]]],"e-active"),i[e[r]].setAttribute("aria-selected","true"))},e.prototype.removeClass=function(e){if(!this.parent.selectionSettings.persistSelection)for(var i=document.getElementById(this.parent.element.id+"GanttTaskTableBody").children,r=t.isBlazor()&&t.isNullOrUndefined(e.length)?[e]:e,n=0;n<r.length;n++)t.removeClass([i[r[n]]],"e-active"),i[r[n]].removeAttribute("aria-selected")},e.prototype.showPopup=function(e){this.isSelectionFromChart?(r.setCssInGridPopUp(this.parent.element.querySelector(".e-ganttpopup"),e,"e-rowselect e-icons e-icon-rowselect"+(this.enableSelectMultiTouch&&(this.getSelectedRecords().length>1||this.getSelectedRowCellIndexes().length>1)?" e-spanclicked":"")),document.getElementsByClassName("e-gridpopup")[0].style.display="none",this.openPopup=!0):0===this.selectedRowIndexes.length&&this.hidePopUp()},e.prototype.hidePopUp=function(){this.openPopup?(document.getElementsByClassName("e-ganttpopup")[0].style.display="none",this.openPopup=!1):document.getElementsByClassName("e-gridpopup")[0].style.display="none"},e.prototype.popUpClickHandler=function(e){var i=e.target,r=this.parent.treeGrid.grid,n=t.closest(i,".e-ganttpopup")?t.closest(i,".e-ganttpopup"):t.closest(i,".e-gridpopup");if(n){var a=n.querySelector(".e-rowselect");t.closest(i,".e-ganttpopup")&&!a.classList.contains("e-spanclicked")?(this.enableSelectMultiTouch=!0,a.classList.add("e-spanclicked")):t.closest(i,".e-gridpopup")&&a.classList.contains("e-spanclicked")?(this.openPopup=!0,this.enableSelectMultiTouch=!0):(this.hidePopUp(),this.enableSelectMultiTouch=!1,t.closest(i,".e-ganttpopup")&&a.classList.remove("e-spanclicked"))}else if("Multiple"===this.parent.selectionSettings.type&&this.parent.isAdaptive){t.closest(i,".e-rowcell")&&0===this.selectedRowIndexes.length&&this.hidePopUp()}r&&t.setValue("enableSelectMultiTouch",this.enableSelectMultiTouch,r.selectionModule)},e.prototype.mouseUpHandler=function(e){var i=!1;if(this.parent.editModule&&this.parent.editSettings.allowTaskbarEditing){var n=this.parent.editModule.taskbarEditModule;(n.isMouseDragged||n.tapPointOnFocus)&&(i=!0)}if(!i&&this.parent.element.contains(e.target)){var a=r.parentsUntil(e.target,"e-chart-row"),o=e.target.classList.contains("e-rowcell")||e.target.classList.contains("e-row")||e.target.classList.contains("e-treegridexpand")||e.target.classList.contains("e-treegridcollapse")||!t.isNullOrUndefined(a);this.popUpClickHandler(e),"Cell"!==this.parent.selectionSettings.mode&&o?(t.closest(e.target,"tr.e-chart-row")?this.highlightSelectedRows(e,!0):this.highlightSelectedRows(e,!1),"Multiple"===this.parent.selectionSettings.type&&this.parent.isAdaptive&&(this.selectedRowIndexes.length>0?this.showPopup(e):this.hidePopUp())):this.isSelectionFromChart=!1}},e.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off("selectRowByIndex",this.selectRowByIndex),this.parent.isAdaptive?(this.parent.off("chartMouseClick",this.mouseUpHandler),this.parent.off("treeGridClick",this.popUpClickHandler)):this.parent.off("chartMouseUp",this.mouseUpHandler))},e}(),Ft=function(){function e(e){this.predefinedItems={},this.items=["Add","Edit","Update","Delete","Cancel","ExpandAll","CollapseAll","Search","PrevTimeSpan","NextTimeSpan","ZoomIn","ZoomOut","ZoomToFit","ExcelExport","CsvExport"],this.parent=e,this.id=this.parent.element.id,this.parent.on("ui-toolbarupdate",this.propertyChanged,this)}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.renderToolbar=function(){if((this.parent.toolbar||[]).length>0){this.element=t.createElement("div",{id:this.parent.controlId+"_Gantt_Toolbar",className:"e-gantt-toolbar"}),this.parent.treeGrid.grid.headerModule?this.parent.element.insertBefore(this.element,this.parent.treeGridPane.offsetParent):this.parent.element.appendChild(this.element);for(var e=0,i=["Add","Edit","Update","Delete","Cancel","ExpandAll","CollapseAll","PrevTimeSpan","NextTimeSpan","ZoomIn","ZoomOut","ZoomToFit","ExcelExport","CsvExport"];e<i.length;e++){var r=i[e],n=r.toLowerCase(),a=r[0].toLowerCase()+r.slice(1);this.predefinedItems[r]={id:this.parent.element.id+"_"+n,prefixIcon:"e-"+n,text:this.parent.isAdaptive?"":this.parent.localeObj.getConstant(a),tooltipText:this.parent.localeObj.getConstant(a)+("add"===a||"edit"===a||"delete"===a?this.parent.localeObj.getConstant("task"):"expandAll"===a||"collapseAll"===a?this.parent.localeObj.getConstant("tasks"):""),align:this.parent.isAdaptive?"Right":"Left"}}var o=this.parent.localeObj.getConstant("search");this.parent.isAdaptive?this.predefinedItems.Search={id:this.id+"_searchbutton",prefixIcon:"e-search-icon",tooltipText:o,align:"Right"}:this.predefinedItems.Search={id:this.id+"_search",template:'<div class="e-input-group e-search" role="search">                <input id="'+this.id+'_searchbar" class="e-input" name="input" type="search"                 placeholder= "'+o+'"/>                <span id="'+this.id+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                 tabindex="-1" title="'+o+'" aria-label= "search"></span>                 </div>',tooltipText:o,align:"Right",cssClass:"e-search-wrapper"},this.createToolbar()}},e.prototype.createToolbar=function(){var e=this.getItems();this.toolbar=new s.Toolbar({items:e,clicked:this.toolbarClickHandler.bind(this),height:this.parent.isAdaptive?48:"auto"}),this.toolbar.isStringTemplate=!0,this.toolbar.appendTo(this.element);var i=this.element.querySelector("#"+this.parent.element.id+"_cancel"),r=this.element.querySelector("#"+this.parent.element.id+"_update");if(i&&t.addClass([i],"e-grid"),r&&t.addClass([r],"e-grid"),this.parent.isAdaptive){this.element.insertBefore(this.getSearchBarElement(),this.element.childNodes[0]),this.searchElement=this.element.querySelector("#"+this.parent.element.id+"_searchbar");new d.TextBox({placeholder:this.parent.localeObj.getConstant("search"),floatLabelType:"Never",showClearButton:!0}).appendTo(this.searchElement)}else this.searchElement=this.element.querySelector("#"+this.parent.element.id+"_searchbar");this.parent.filterModule&&(this.wireEvent(),this.parent.searchSettings&&this.updateSearchTextBox())},e.prototype.getSearchBarElement=function(){var e=this,i=t.createElement("div",{className:"e-adaptive-searchbar",styles:"display: none"}),r=t.createElement("input",{attrs:{type:"text"},id:this.parent.element.id+"_searchbar"}),n=t.createElement("span",{className:"e-backarrowspan e-icons"});return n.onclick=function(){i.style.display="none",e.element.childNodes[1].style.display="block"},i.appendChild(n),i.appendChild(r),i},e.prototype.wireEvent=function(){this.searchElement&&(t.EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),t.EventHandler.add(this.searchElement,"focus",this.focusHandler,this),t.EventHandler.add(this.searchElement,"blur",this.blurHandler,this))},e.prototype.propertyChanged=function(e){t.getValue("module",e)===this.getModuleName()&&this.parent.toolbar&&(this.element&&this.element.parentNode&&t.remove(this.element),this.renderToolbar(),this.refreshToolbarItems())},e.prototype.unWireEvent=function(){this.searchElement&&(t.EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),t.EventHandler.remove(this.searchElement,"focus",this.focusHandler),t.EventHandler.remove(this.searchElement,"blur",this.blurHandler),this.searchElement=null),this.parent.off("ui-toolbarupdate",this.propertyChanged)},e.prototype.keyUpHandler=function(e){13===e.keyCode&&this.parent.searchSettings.key!==this.searchElement.value&&(this.parent.searchSettings.key=this.searchElement.value,this.parent.dataBind())},e.prototype.focusHandler=function(e){e.target.parentElement.classList.add("e-input-focus")},e.prototype.blurHandler=function(e){e.target.parentElement.classList.remove("e-input-focus")},e.prototype.updateSearchTextBox=function(){this.searchElement&&this.searchElement.value!==this.parent.searchSettings.key&&(this.searchElement.value=this.parent.searchSettings.key)},e.prototype.getItems=function(){var e=[],t=this.parent.toolbar,i=-1;if(t.forEach(function(e,t){("string"==typeof e&&"Search"===e||"object"==typeof e&&"Search"===e.text)&&(i=t)}),i>-1){var r=t.splice(i,1);t.push(r[0])}for(var n=0,a=t;n<a.length;n++){var o=a[n];switch(typeof o){case"string":e.push(this.getItemObject(o));break;default:e.push(this.getItem(o))}}return e},e.prototype.getItem=function(e){var i=this.predefinedItems[e.text];return i?t.extend(i,i,e):e},e.prototype.getItemObject=function(e){return this.predefinedItems[e]||{text:e,id:this.id+"_"+e}},e.prototype.toolbarClickHandler=function(e){var i=this,r=this.parent,n=this.id;t.extend(e,{cancel:!1}),r.trigger("toolbarClick",e,function(e){if(!e.cancel)switch(!0===i.parent.isAdaptive&&(e.item.id!==n+"_edit"&&e.item.id!==n+"_add"&&e.item.id!==n+"_delete"&&e.item.id!==n+"_searchbutton"&&e.item.id!==n+"_expandall"&&e.item.id!==n+"_collapseall"||i.parent.selectionModule&&"Multiple"===i.parent.selectionSettings.type&&(i.parent.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),!t.isNullOrUndefined(e.item)&&e.item.id){case n+"_edit":r.editModule&&r.editSettings.allowEditing&&r.editModule.dialogModule.openToolbarEditDialog();break;case n+"_update":r.editModule.cellEditModule.isCellEdit=!1,r.treeGrid.grid.saveCell();break;case n+"_cancel":r.cancelEdit();break;case n+"_add":r.editModule&&r.editSettings.allowAdding&&r.editModule.dialogModule.openAddDialog();break;case n+"_delete":i.parent.selectionModule&&i.parent.editModule&&("Cell"!==i.parent.selectionSettings.mode&&i.parent.selectionModule.selectedRowIndexes.length||"Cell"===i.parent.selectionSettings.mode&&i.parent.selectionModule.getSelectedRowCellIndexes().length)&&i.parent.editModule.startDeleteAction();break;case n+"_search":if(t.getValue("originalEvent.target.id",e)===i.parent.element.id+"_searchbutton"&&i.parent.filterModule){var a=i.element.querySelector("#"+i.parent.element.id+"_searchbar").value;i.parent.searchSettings.key!==a&&(i.parent.searchSettings.key=a,i.parent.dataBind())}break;case n+"_searchbutton":var o=i.element.querySelector(".e-adaptive-searchbar");o.parentElement.childNodes[1].style.display="none",o.style.display="block";break;case n+"_expandall":i.parent.ganttChartModule.expandCollapseAll("expand");break;case n+"_collapseall":i.parent.ganttChartModule.expandCollapseAll("collapse");break;case n+"_prevtimespan":i.parent.previousTimeSpan();break;case n+"_nexttimespan":i.parent.nextTimeSpan();break;case n+"_zoomin":i.zoomIn();break;case n+"_zoomout":i.zoomOut();break;case n+"_zoomtofit":i.zoomToFit()}})},e.prototype.zoomIn=function(){this.parent.timelineModule.processZooming(!0)},e.prototype.zoomToFit=function(){this.parent.timelineModule.processZoomToFit(),this.parent.ganttChartModule.updateScrollLeft(0)},e.prototype.zoomOut=function(){this.parent.timelineModule.processZooming(!1)},e.prototype.refreshToolbarItems=function(){var e=this.parent,i=[],r=[],n=e.editSettings,a=this.id,o=!!e.selectionModule&&(1===e.selectionModule.selectedRowIndexes.length||1===e.selectionModule.getSelectedRowCellIndexes().length),s=this.toolbar?this.toolbar.items:[],l=[a+"_add",a+"_edit",a+"_delete",a+"_update",a+"_cancel"];if(t.isNullOrUndefined(this.parent.editModule))r.push(a+"_delete"),r.push(a+"_add"),r.push(a+"_edit"),r.push(a+"_update"),r.push(a+"_cancel");else{var d=!!e.editModule.taskbarEditModule&&e.editModule.taskbarEditModule.touchEdit,p=e.currentViewData&&e.currentViewData.length;n.allowAdding&&!d?i.push(a+"_add"):r.push(a+"_add"),n.allowEditing&&p&&o&&!d?i.push(a+"_edit"):r.push(a+"_edit");var h=!!e.selectionModule&&(e.selectionModule.selectedRowIndexes.length>0||e.selectionModule.getSelectedRowCellIndexes().length>0);if(n.allowDeleting&&p&&h&&!d?i.push(a+"_delete"):r.push(a+"_delete"),"Auto"===e.editSettings.mode&&!t.isNullOrUndefined(e.editModule.cellEditModule)&&e.editModule.cellEditModule.isCellEdit){(i=[]).push(a+"_update",a+"_cancel"),r=[];for(var c=0;c<s.length;c++)s[c].id!==a+"_update"&&s[c].id!==a+"_cancel"&&-1!==l.indexOf(s[c].id)&&r.push(s[c].id)}else{r.push(a+"_update",a+"_cancel");for(c=0;c<s.length;c++)-1===i.indexOf(s[c].id)&&-1===r.indexOf(s[c].id)&&i.push(s[c].id)}}for(var u=0;u<i.length;u++){var g=void 0;for(c=0;c<s.length;c++)if(s[c].id===i[u]){g=c;break}s.length>0&&this.toolbar.hideItem(g,!1)}for(var f=0;f<r.length;f++){for(g=void 0,c=0;c<s.length;c++)if(s[c].id===r[f]){g=c;break}s.length>0&&this.toolbar.hideItem(g,!0)}},e.prototype.enableItems=function(e,t){for(var i=0,r=e;i<r.length;i++){var n=r[i],a=this.element.querySelector("#"+n);a&&this.toolbar.enableItems(a.parentElement,t)}},e.prototype.destroy=function(){this.parent.isDestroyed||(this.toolbar.destroy(),this.parent.filterModule&&this.unWireEvent(),t.remove(this.element))},e}(),Nt=function(){function e(e){this.parent=e,this.nonworkingContainer=null,this.holidayContainer=null,this.weekendContainer=null}return e.prototype.createNonworkingContainer=function(){this.parent.ganttChartModule.chartBodyContent.contains(this.nonworkingContainer)||(this.nonworkingContainer=t.createElement("div",{className:"e-nonworking-day-container"}),this.parent.ganttChartModule.chartBodyContent.appendChild(this.nonworkingContainer))},e.prototype.renderHolidays=function(){this.parent.holidays&&this.parent.holidays.length>0?(this.createNonworkingContainer(),this.nonworkingContainer.contains(this.holidayContainer)||(this.holidayContainer=t.createElement("div",{className:"e-holiday-container"}),this.nonworkingContainer.appendChild(this.holidayContainer)),this.holidayContainer.innerHTML=this.getHolidaysElement().innerHTML):this.holidayContainer&&(t.remove(this.holidayContainer),this.nonworkingContainer&&0===this.nonworkingContainer.childNodes.length&&t.remove(this.nonworkingContainer))},e.prototype.getHolidaysElement=function(){for(var e,i,r=t.createElement("div"),n=this.parent.contentHeight,a=this.parent.ganttChartModule.scrollElement,o=parseInt(a.style.height,10),s=0;s<this.parent.holidays.length;s++){this.parent.holidays[s].from&&this.parent.holidays[s].to?(e=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[s].from),(i=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[s].to)).setDate(i.getDate()+1),e.setHours(0,0,0,0),i.setHours(0,0,0,0)):this.parent.holidays[s].from?(e=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[s].from)).setHours(0,0,0,0):this.parent.holidays[s].to&&(e=this.parent.dateValidationModule.getDateFromFormat(this.parent.holidays[s].to)).setHours(0,0,0,0);var l=this.parent.holidays[s].from&&this.parent.holidays[s].to?this.parent.dataOperation.getTaskWidth(e,i):this.parent.perDayWidth,d=this.parent.dataOperation.getTaskLeft(e,!1),p=t.createElement("div",{className:"e-holiday",styles:"left:"+d+"px; width:"+l+"px; height:100%;"}),h=o<n?o/2:n/2,c=t.createElement("span",{className:"e-span",innerHTML:this.parent.holidays[s].label?""+this.parent.holidays[s].label:"",styles:"top:"+h+"px;left:"+l/2+"px;"});p.appendChild(c),this.parent.holidays[s].cssClass&&p.classList.add(this.parent.holidays[s].cssClass),r.appendChild(p)}return r},e.prototype.renderWeekends=function(){this.parent.highlightWeekends?(this.createNonworkingContainer(),this.nonworkingContainer.contains(this.weekendContainer)||(this.weekendContainer=t.createElement("div",{className:"e-weekend-container"}),this.nonworkingContainer.appendChild(this.weekendContainer)),this.weekendContainer.innerHTML=this.getWeekendElements().innerHTML):this.weekendContainer&&(t.remove(this.weekendContainer),this.nonworkingContainer&&0===this.nonworkingContainer.childNodes.length&&t.remove(this.nonworkingContainer))},e.prototype.getWeekendElements=function(){var e=t.createElement("div"),i=new Date(this.parent.timelineModule.timelineStartDate.getTime()),r=new Date(this.parent.timelineModule.timelineEndDate.getTime()),n=this.parent.nonWorkingDayIndex,a=!0;do{if(-1!==n.indexOf(i.getDay())){var o=this.parent.dataOperation.getTaskLeft(i,!1),s=this.parent.perDayWidth;if(a){var l=new Date(i.getTime()),d=new Date(l.getTime());d.setDate(d.getDate()+1),d.setHours(0,0,0,0),s=this.parent.dataOperation.getTaskWidth(l,d),a=!1}var p=t.createElement("div",{className:"e-weekend",styles:"left:"+o+"px;width:"+s+"px;height:100%;"});e.appendChild(p)}i.setDate(i.getDate()+1),i.setHours(0,0,0,0)}while(i<r);return e},e.prototype.updateHolidayLabelHeight=function(){for(var e=this.parent.contentHeight,i=this.parent.ganttChartModule.scrollElement,r=parseInt(i.style.height,10),n=r<e?r/2:e/2,a=this.holidayContainer.querySelectorAll(".e-span"),o=0;o<a.length;o++)a[o].style.top=t.formatUnit(n)},e.prototype.updateContainerHeight=function(){this.holidayContainer&&(this.holidayContainer.style.height=t.formatUnit(this.parent.contentHeight),this.updateHolidayLabelHeight()),this.weekendContainer&&(this.weekendContainer.style.height=t.formatUnit(this.parent.contentHeight))},e.prototype.removeContainers=function(){this.holidayContainer&&t.remove(this.holidayContainer),this.weekendContainer&&t.remove(this.weekendContainer),this.nonworkingContainer&&t.remove(this.nonworkingContainer)},e}(),Ut=function(){function e(e){this.parent=e,this.eventMarkersContainer=null}return e.prototype.renderEventMarkers=function(){this.parent.eventMarkers&&this.parent.eventMarkers.length>0?(this.parent.ganttChartModule.chartBodyContent.contains(this.eventMarkersContainer)||(this.eventMarkersContainer=t.createElement("div",{className:"e-event-markers-container"}),this.parent.ganttChartModule.chartBodyContent.appendChild(this.eventMarkersContainer)),this.eventMarkersContainer.innerHTML="",this.getEventMarkersElements(this.eventMarkersContainer)):this.eventMarkersContainer&&t.remove(this.eventMarkersContainer)},e.prototype.removeContainer=function(){this.eventMarkersContainer&&t.remove(this.eventMarkersContainer)},e.prototype.getEventMarkersElements=function(e){for(var i,r,n,a,o=0;o<this.parent.eventMarkers.length;o++)i=this.parent.dataOperation.getTaskLeft(this.parent.dateValidationModule.getDateFromFormat(this.parent.eventMarkers[o].day),!1),r=t.createElement("div",{className:"e-event-markers",styles:"left:"+i+"px;  height:100%;",id:"stripline"+o}),this.parent.eventMarkers[o].label&&(n=t.createElement("div",{className:"e-span-label",innerHTML:""+this.parent.eventMarkers[o].label}),r.appendChild(n),a=t.createElement("div",{className:"e-gantt-right-arrow"}),r.appendChild(a)),this.parent.eventMarkers[o].cssClass&&r.classList.add(this.parent.eventMarkers[o].cssClass),r.setAttribute("tabindex","-1"),t.isNullOrUndefined(this.parent.eventMarkers[o].day)||r.setAttribute("aria-label",this.parent.localeObj.getConstant("eventMarkers")+" "+("string"==typeof this.parent.eventMarkers[o].day?this.parent.eventMarkers[o].day:this.parent.getFormatedDate(this.parent.eventMarkers[o].day))+" "+this.parent.eventMarkers[o].label),e.appendChild(r)},e.prototype.updateContainerHeight=function(){this.eventMarkersContainer&&(this.eventMarkersContainer.style.height=t.formatUnit(this.parent.contentHeight))},e}(),At=function(){function e(e){this.parent=e,this.nonworkingDayRender=new Nt(this.parent),this.eventMarkerRender=new Ut(this.parent),this.wireEvents()}return e.prototype.wireEvents=function(){this.parent.on("refreshDayMarkers",this.refreshMarkers,this),this.parent.on("updateHeight",this.updateHeight,this),this.parent.on("ui-update",this.propertyChanged,this)},e.prototype.propertyChanged=function(e){for(var i=Object.keys(t.getValue("properties",e)),r=0;r<i.length;r++){switch(i[r]){case"eventMarkers":this.eventMarkerRender.renderEventMarkers(),this.updateHeight();break;case"highlightWeekends":this.nonworkingDayRender.renderWeekends(),this.updateHeight();break;case"holidays":this.nonworkingDayRender.renderHolidays(),this.updateHeight()}}},e.prototype.refreshMarkers=function(){this.eventMarkerRender.renderEventMarkers(),this.nonworkingDayRender.renderWeekends(),this.nonworkingDayRender.renderHolidays()},e.prototype.updateHeight=function(){this.nonworkingDayRender.updateContainerHeight(),this.eventMarkerRender.updateContainerHeight()},e.prototype.getModuleName=function(){return"dayMarkers"},e.prototype.destroy=function(){this.parent.isDestroyed||(this.nonworkingDayRender.removeContainers(),this.eventMarkerRender.removeContainer(),this.parent.off("refreshDayMarkers",this.refreshMarkers),this.parent.off("updateHeight",this.updateHeight),this.parent.off("ui-update",this.propertyChanged))},e}(),jt=function(){function e(e){var i=this;this.headerContextMenuClick=function(e){var r=t.closest(e.event.target,".e-row"),n=t.closest(e.event.target,".e-chart-row");t.isNullOrUndefined(r)&&t.isNullOrUndefined(n)&&(e.type="Header",i.parent.trigger("contextMenuClick",e))},this.headerContextMenuOpen=function(e){var r=t.closest(e.event.target,".e-row"),n=t.closest(e.event.target,".e-chart-row");t.isNullOrUndefined(r)&&t.isNullOrUndefined(n)?(e.type="Header",i.parent.trigger("contextMenuOpen",e)):e.cancel=!0},this.parent=e,this.ganttID=e.element.id,a.TreeGrid.Inject(a.ContextMenu),this.parent.treeGrid.contextMenuClick=this.headerContextMenuClick.bind(this),this.parent.treeGrid.contextMenuOpen=this.headerContextMenuOpen.bind(this),this.addEventListener(),this.resetItems()}return e.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on("initiate-contextMenu",this.render,this),this.parent.on("reRender-contextMenu",this.reRenderContextMenu,this),this.parent.on("contextMenuClick",this.contextMenuItemClick,this),this.parent.on("contextMenuOpen",this.contextMenuBeforeOpen,this))},e.prototype.reRenderContextMenu=function(e){e.module===this.getModuleName()&&e.enable&&(this.contextMenu&&(this.contextMenu.destroy(),t.remove(this.element)),this.resetItems(),this.render())},e.prototype.render=function(){this.element=this.parent.createElement("ul",{id:this.ganttID+"_contextmenu",className:"e-grid"}),this.parent.element.appendChild(this.element);var e="#"+this.ganttID;this.contextMenu=new s.ContextMenu({items:this.getMenuItems(),locale:this.parent.locale,target:e,animationSettings:{effect:"None"},select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:"e-gantt"}),this.contextMenu.appendTo(this.element),this.parent.treeGrid.contextMenuItems=this.headerMenuItems},e.prototype.contextMenuItemClick=function(e){var i=this.getKeyFromId(e.item.id),r=t.getValue("parentObj",e.item),n=-1;switch(r&&!t.isNullOrUndefined(r.id)&&"DeleteDependency"===this.getKeyFromId(r.id)&&(n=r.items.indexOf(e.item)),this.parent.isAdaptive&&("TaskInformation"!==i&&"Above"!==i&&"Below"!==i&&"Child"!==i&&"DeleteTask"!==i||this.parent.selectionModule&&"Multiple"===this.parent.selectionSettings.type&&(this.parent.selectionModule.hidePopUp(),document.getElementsByClassName("e-gridpopup")[0].style.display="none")),i){case"TaskInformation":this.parent.openEditDialog(Number(this.rowData.ganttProperties.taskId));break;case"Above":case"Below":case"Child":var a=i,o=t.extend({},{},this.rowData.taskData,!0),s=this.parent.taskFields;if(t.isNullOrUndefined(s.dependency)||(o[s.dependency]=null),!t.isNullOrUndefined(s.child)&&o[s.child]&&delete o[s.child],!t.isNullOrUndefined(s.parentID)&&o[s.parentID]&&(o[s.parentID]=null),this.rowData){var l=this.parent.currentViewData.indexOf(this.rowData);this.parent.addRecord(o,a,l)}break;case"Milestone":case"ToMilestone":this.convertToMilestone(i);break;case"DeleteTask":this.parent.editModule.deleteRecord(this.rowData);break;case"ToTask":if(o=t.extend({},{},this.rowData.taskData,!0),s=this.parent.taskFields,t.isNullOrUndefined(s.duration)){o[s.startDate]=new Date(this.rowData.taskData[s.startDate]);var d=new Date(this.rowData.taskData[s.startDate]);d.setDate(d.getDate()+1),o[s.endDate]=d}else{var p=this.rowData.ganttProperties;o[s.duration]="1 "+p.durationUnit}t.isNullOrUndefined(o[s.milestone])||!0===o[s.milestone]&&(o[s.milestone]=!1),this.parent.updateRecordByID(o);break;case"Cancel":this.parent.cancelEdit();break;case"Save":this.parent.editModule.cellEditModule.isCellEdit=!1,this.parent.treeGrid.grid.saveCell();break;case"Dependency"+n:this.parent.connectorLineEditModule.removePredecessorByIndex(this.rowData,n)}e.type="Content",e.rowData=this.rowData,this.parent.trigger("contextMenuClick",e)},e.prototype.convertToMilestone=function(e){var i=t.extend({},{},this.rowData.taskData,!0),r=this.parent.taskFields;if(t.isNullOrUndefined(r.duration)?(i[r.startDate]=new Date(this.rowData.taskData[r.startDate]),i[r.endDate]=new Date(this.rowData.taskData[r.startDate])):i[r.duration]=0,t.isNullOrUndefined(r.milestone)||!1===i[r.milestone]&&(i[r.milestone]=!0),t.isNullOrUndefined(r.progress)||(i[r.progress]=0),!t.isNullOrUndefined(r.child)&&i[r.child]&&(i[r.child]=[]),!t.isNullOrUndefined(r.parentID)&&i[r.parentID]&&(i[r.parentID]=null),"Milestone"===e){t.isNullOrUndefined(r.dependency)||(i[r.dependency]=null);this.parent.addRecord(i,"Below")}else this.parent.updateRecordByID(i)},e.prototype.contextMenuBeforeOpen=function(e){var i=this;e.gridRow=t.closest(e.event.target,".e-row"),e.chartRow=t.closest(e.event.target,".e-chart-row");var r=t.closest(e.event.target,".e-gantt");if(!t.closest(e.event.target,".e-gridform")&&this.parent.editModule&&this.parent.editModule.cellEditModule&&this.parent.editModule.cellEditModule.isCellEdit&&(this.parent.treeGrid.grid.saveCell(),this.parent.editModule.cellEditModule.isCellEdit=!1),(t.isNullOrUndefined(e.gridRow)&&t.isNullOrUndefined(e.chartRow)||0===this.contentMenuItems.length)&&(t.isNullOrUndefined(e.parentItem)||t.isNullOrUndefined(r)?e.cancel=!0:e.cancel=!1),!e.cancel){var a=-1;e.gridRow?a=parseInt(e.gridRow.getAttribute("aria-rowindex"),0):e.chartRow&&(a=parseInt(t.getValue("rowIndex",e.chartRow),0)),this.parent.selectionModule&&this.parent.allowSelection&&this.parent.selectionModule.selectRow(a),e.parentItem||(this.rowData=this.parent.currentViewData[a]);for(var o=0,s=e.items;o<s.length;o++){var l=s[o],d=e.event.target;l.separator||this.updateItemStatus(l,d)}e.rowData=this.rowData,e.type="Content",e.disableItems=this.disableItems,e.hideItems=this.hideItems;var p=new n.Deferred;return this.parent.trigger("contextMenuOpen",e,function(e){p.resolve(e),t.isBlazor()&&(e.element=t.isNullOrUndefined(e.element)?e.element:t.getElement(e.element),e.gridRow=t.isNullOrUndefined(e.gridRow)?e.gridRow:t.getElement(e.gridRow),e.chartRow=t.isNullOrUndefined(e.chartRow)?e.chartRow:t.getElement(e.chartRow)),i.hideItems=e.hideItems,i.disableItems=e.disableItems,e.parentItem||e.hideItems.length!==e.items.length||(i.revertItemStatus(),e.cancel=!0),i.hideItems.length>0&&i.contextMenu.hideItems(i.hideItems),i.disableItems.length>0&&i.contextMenu.enableItems(i.disableItems,!1)}),p}},e.prototype.updateItemStatus=function(e,i){var r=this.getKeyFromId(e.id);if(t.closest(i,".e-gridform"))"Save"!==r&&"Cancel"!==r&&this.hideItems.push(e.text);else switch(r){case"TaskInformation":this.parent.editSettings.allowEditing&&this.parent.editModule||this.updateItemVisibility(e.text);break;case"Add":this.parent.editSettings.allowAdding&&this.parent.editModule||this.updateItemVisibility(e.text);break;case"Save":case"Cancel":this.hideItems.push(e.text);break;case"Convert":if(this.rowData.hasChildRecords)this.hideItems.push(e.text);else if(this.parent.editSettings.allowEditing&&this.parent.editModule){var n=[];this.rowData.ganttProperties.isMilestone?n.push(this.createItemModel(ce,"ToTask",this.getLocale("toTask"))):n.push(this.createItemModel(ce,"ToMilestone",this.getLocale("toMilestone"))),e.items=n}else this.updateItemVisibility(e.text);break;case"DeleteDependency":var a=this.getPredecessorsItems();this.rowData.hasChildRecords?this.hideItems.push(e.text):this.parent.editSettings.allowDeleting&&0!==a.length&&this.parent.editModule?a.length>0&&(e.items=a):this.updateItemVisibility(e.text);break;case"DeleteTask":this.parent.editSettings.allowDeleting&&this.parent.editModule||this.updateItemVisibility(e.text)}},e.prototype.updateItemVisibility=function(e){!!t.isNullOrUndefined(this.parent.contextMenuItems)?this.hideItems.push(e):this.disableItems.push(e)},e.prototype.contextMenuOpen=function(){this.isOpen=!0},e.prototype.getMenuItems=function(){for(var e=0,i=t.isNullOrUndefined(this.parent.contextMenuItems)?this.getDefaultItems():this.parent.contextMenuItems;e<i.length;e++){var r=i[e];"string"==typeof r&&-1!==this.getDefaultItems().indexOf(r)?this.buildDefaultItems(r):"string"!=typeof r&&(-1!==this.getDefaultItems().indexOf(r.text)?this.buildDefaultItems(r.text,r.iconCss):".e-gridheader"===r.target?this.headerMenuItems.push(r):this.contentMenuItems.push(r))}return this.contentMenuItems},e.prototype.createItemModel=function(e,t,i,r){return{text:i,id:this.generateID(t),target:e,iconCss:r?"e-icons "+r:""}},e.prototype.getLocale=function(e){return this.parent.localeObj.getConstant(e)},e.prototype.buildDefaultItems=function(e,t){var i;switch(e){case"AutoFitAll":case"AutoFit":case"SortAscending":case"SortDescending":this.headerMenuItems.push(e);break;case"TaskInformation":i=this.createItemModel(ce,e,this.getLocale("taskInformation"),this.getIconCSS("e-edit",t));break;case"Save":i=this.createItemModel("e-edit",e,this.getLocale("save"),this.getIconCSS("e-save",t));break;case"Cancel":i=this.createItemModel("e-edit",e,this.getLocale("cancel"),this.getIconCSS("e-cancel",t));break;case"Add":(i=this.createItemModel(ce,e,this.getLocale("add"),this.getIconCSS("e-add",t))).items=[],i.items.push(this.createItemModel(ce,"Above",this.getLocale("above"),this.getIconCSS("e-add-above",t))),i.items.push(this.createItemModel(ce,"Below",this.getLocale("below"),this.getIconCSS("e-add-below",t))),i.items.push(this.createItemModel(ce,"Child",this.getLocale("child"))),i.items.push(this.createItemModel(ce,"Milestone",this.getLocale("milestone")));break;case"DeleteTask":i=this.createItemModel(ce,e,this.getLocale("deleteTask"),this.getIconCSS("e-delete",t));break;case"DeleteDependency":(i=this.createItemModel(ce,e,this.getLocale("deleteDependency"))).items=[],i.items.push({});break;case"Convert":(i=this.createItemModel(ce,e,this.getLocale("convert"))).items=[],i.items.push({})}i&&this.contentMenuItems.push(i)},e.prototype.getIconCSS=function(e,i){return t.isNullOrUndefined(i)?e:i},e.prototype.getPredecessorsItems=function(){this.predecessors=this.parent.predecessorModule.getValidPredecessor(this.rowData);for(var e,t=[],i=0,r=0,n=this.predecessors;r<n.length;r++){var a=n[r],o=this.parent.getRecordByID(a.from).ganttProperties,s=o.taskId+" - "+o.taskName,l="Dependency"+i++;e=this.createItemModel(ce,l,s),t.push(e)}return t},e.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","TaskInformation","DeleteTask","Save","Cancel","SortAscending","SortDescending","Add","DeleteDependency","Convert"]},e.prototype.getModuleName=function(){return"contextMenu"},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off("initiate-contextMenu",this.render),this.parent.off("reRender-contextMenu",this.reRenderContextMenu),this.parent.off("contextMenuClick",this.contextMenuItemClick),this.parent.off("contextMenuOpen",this.contextMenuOpen))},e.prototype.contextMenuOnClose=function(e){e.items.length>0&&e.items[0].parentObj instanceof s.ContextMenu&&this.revertItemStatus()},e.prototype.revertItemStatus=function(){t.isBlazor()&&t.isNullOrUndefined(this.disableItems)&&(this.disableItems=[]),this.contextMenu.showItems(this.hideItems),this.contextMenu.enableItems(this.disableItems),this.hideItems=[],this.disableItems=[],this.isOpen=!1},e.prototype.resetItems=function(){this.hideItems=[],this.disableItems=[],this.headerMenuItems=[],this.contentMenuItems=[]},e.prototype.generateID=function(e){return this.ganttID+"_contextMenu_"+e},e.prototype.getKeyFromId=function(e){var t=this.ganttID+"_contextMenu_";return e.indexOf(t)>-1?e.replace(t,""):"Custom"},e.prototype.destroy=function(){this.contextMenu.destroy(),t.remove(this.element),this.removeEventListener(),this.contextMenu=null,this.element=null},e}(),Ht=function(){function e(e){this.parent=e,a.TreeGrid.Inject(a.ExcelExport),this.parent.treeGrid.allowExcelExport=this.parent.allowExcelExport,this.bindEvents()}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.destroy=function(){},e.prototype.bindEvents=function(){var e=this;this.parent.treeGrid.beforeExcelExport=function(t){e.parent.trigger("beforeExcelExport",t)},this.parent.treeGrid.excelQueryCellInfo=function(t){e.parent.trigger("excelQueryCellInfo",t)},this.parent.treeGrid.excelHeaderQueryCellInfo=function(t){e.parent.trigger("excelHeaderQueryCellInfo",t)},this.parent.treeGrid.excelExportComplete=function(t){e.parent.trigger("excelExportComplete",t)}},e}(),Wt=function(){function e(e){a.TreeGrid.Inject(a.ColumnMenu),this.parent=e}return e.prototype.getColumnMenu=function(){return this.parent.treeGrid.columnMenuModule.getColumnMenu()},e.prototype.destroy=function(){},e.prototype.getModuleName=function(){return"columnMenu"},e}();e.Gantt=bt,e.parentsUntil=u,e.isScheduledTask=g,e.getSwapKey=f,e.isRemoteData=m,e.getTaskData=y,e.formatString=v,e.getIndex=D,e.load="load",e.rowDataBound="rowDataBound",e.queryCellInfo="queryCellInfo",e.toolbarClick="toolbarClick",e.keyPressed="key-pressed",e.Edit=Ot,e.Reorder=xt,e.Resize=It,e.Filter=Lt,e.Sort=Vt,e.Dependency=yt,e.Selection=Bt,e.Toolbar=Ft,e.DayMarkers=At,e.ContextMenu=jt,e.ExcelExport=Ht,e.ColumnMenu=Wt,e.Column=ke,e.DayWorkingTime=Me,e.AddDialogFieldSettings=Re,e.EditDialogFieldSettings=xe,e.EditSettings=Ve,e.EventMarker=Ne,e.FilterSettings=je,e.SearchSettings=Ge,e.Holiday=ze,e.LabelSettings=Ze,e.SelectionSettings=$e,e.SplitterSettings=tt,e.TaskFields=nt,e.TimelineTierSettings=st,e.TimelineSettings=lt,e.TooltipSettings=ht,e.SortDescriptor=gt,e.SortSettings=ft,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-gantt.umd.min.js.map
