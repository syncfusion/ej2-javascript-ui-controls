{"version":3,"file":"ej2-documenteditor.umd.min.js","sources":["../src/document-editor/base/dictionary.js","../src/document-editor/base/unique-format.js","../src/document-editor/base/unique-formats.js","../src/document-editor/document-editor.js","../src/document-editor/implementation/print.js","../src/document-editor/implementation/format/section-format.js","../src/document-editor/implementation/list/level-override.js","../src/document-editor/implementation/list/list.js","../src/document-editor/implementation/format/list-format.js","../src/document-editor/implementation/format/paragraph-format.js","../src/document-editor/implementation/format/character-format.js","../src/document-editor/implementation/editor/editor-helper.js","../src/document-editor/implementation/format/style.js","../src/document-editor/implementation/format/border.js","../src/document-editor/implementation/format/borders.js","../src/document-editor/implementation/format/shading.js","../src/document-editor/implementation/format/table-format.js","../src/document-editor/implementation/format/row-format.js","../src/document-editor/implementation/format/cell-format.js","../src/document-editor/implementation/viewer/page.js","../src/document-editor/implementation/context-menu.js","../src/document-editor/implementation/list/abstract-list.js","../src/document-editor/implementation/list/list-level.js","../src/document-editor/implementation/viewer/layout.js","../src/document-editor/implementation/viewer/render.js","../src/document-editor/implementation/viewer/text-helper.js","../src/document-editor/implementation/viewer/zooming.js","../src/document-editor/implementation/viewer/viewer.js","../src/document-editor/implementation/viewer/sfdt-reader.js","../src/document-editor/implementation/selection/selection-format.js","../src/document-editor/implementation/writer/html-export.js","../src/document-editor/implementation/selection/selection-helper.js","../src/document-editor/implementation/selection/selection.js","../src/document-editor/implementation/search/text-search.js","../src/document-editor/implementation/search/text-search-result.js","../src/document-editor/implementation/search/text-search-results.js","../src/document-editor/implementation/search/search-results.js","../src/document-editor/implementation/search/search.js","../src/document-editor/implementation/search/options-pane.js","../src/document-editor/implementation/editor/table-resizer.js","../src/document-editor/implementation/editor/editor.js","../src/document-editor/implementation/editor-history/history-helper.js","../src/document-editor/implementation/editor-history/base-history-info.js","../src/document-editor/implementation/editor/image-resizer.js","../src/document-editor/implementation/editor-history/history-info.js","../src/document-editor/implementation/editor-history/editor-history.js","../src/document-editor/implementation/writer/word-export.js","../src/document-editor/implementation/writer/text-export.js","../src/document-editor/implementation/writer/sfdt-export.js","../src/document-editor/implementation/dialogs/hyperlink-dialog.js","../src/document-editor/implementation/dialogs/table-dialog.js","../src/document-editor/implementation/dialogs/bookmark-dialog.js","../src/document-editor/implementation/dialogs/table-of-contents-dialog.js","../src/document-editor/implementation/dialogs/page-setup-dialog.js","../src/document-editor/implementation/dialogs/paragraph-dialog.js","../src/document-editor/implementation/dialogs/list-view-model.js","../src/document-editor/implementation/dialogs/list-dialog.js","../src/document-editor/implementation/dialogs/style-dialog.js","../src/document-editor/implementation/dialogs/bullets-and-numbering-dialog.js","../src/document-editor/implementation/dialogs/font-dialog.js","../src/document-editor/implementation/dialogs/table-properties-dialog.js","../src/document-editor/implementation/dialogs/borders-and-shading-dialog.js","../src/document-editor/implementation/dialogs/table-options-dialog.js","../src/document-editor/implementation/dialogs/cell-options-dialog.js","../src/document-editor/implementation/dialogs/styles-dialog.js"],"sourcesContent":["import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Dictionary = /** @class */ (function () {\n    function Dictionary() {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n        this.item = [];\n    }\n    Object.defineProperty(Dictionary.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.keysInternal.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Dictionary.prototype, \"keys\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getItem();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Dictionary.prototype.getItem = function () {\n        this.item = [];\n        for (var i = 0; i < this.keysInternal.length; i++) {\n            this.item.push(this.keysInternal[i]);\n        }\n        return this.item;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.add = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key or value is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        // if (index < 0 || index > this.keysInternal.length - 1) {\n        if (index < 0) {\n            this.keysInternal.push(key);\n            this.valuesInternal.push(value);\n        }\n        return 1;\n        // else {\n        //     throw new RangeError('An item with the same key has already been added.');\n        // }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.get = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            return this.valuesInternal[index];\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.set = function (key, value) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.valuesInternal[index] = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.remove = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            throw new RangeError('No item with the specified key has been added.');\n        }\n        else {\n            this.keysInternal.splice(index, 1);\n            this.valuesInternal.splice(index, 1);\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.containsKey = function (key) {\n        if (isNullOrUndefined(key)) {\n            throw new ReferenceError('Provided key is not valid.');\n        }\n        var index = this.keysInternal.indexOf(key);\n        if (index < 0 || index > this.keysInternal.length - 1) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.clear = function () {\n        this.keysInternal = [];\n        this.valuesInternal = [];\n    };\n    /**\n     * @private\n     */\n    Dictionary.prototype.destroy = function () {\n        this.clear();\n        this.keysInternal = undefined;\n        this.valuesInternal = undefined;\n    };\n    return Dictionary;\n}());\nexport { Dictionary };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from './dictionary';\n/**\n * @private\n */\nvar WUniqueFormat = /** @class */ (function () {\n    function WUniqueFormat(type) {\n        this.referenceCount = 0;\n        this.uniqueFormatType = type;\n        this.propertiesHash = new Dictionary();\n    }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isEqual = function (source, property, modifiedValue) {\n        var isEqual = false;\n        switch (this.uniqueFormatType) {\n            case 1:\n                isEqual = this.isBorderEqual(source, property, modifiedValue);\n                break;\n            case 2:\n                isEqual = this.isCharacterFormatEqual(source, property, modifiedValue);\n                break;\n            case 3:\n                isEqual = this.isParagraphFormatEqual(source, property, modifiedValue);\n                break;\n            case 4:\n                isEqual = this.isCellFormatEqual(source, property, modifiedValue);\n                break;\n            case 5:\n                isEqual = this.isShadingEqual(source, property, modifiedValue);\n                break;\n            case 6:\n                isEqual = this.isRowFormatEqual(source, property, modifiedValue);\n                break;\n            case 7:\n                isEqual = this.isListFormatEqual(source, property, modifiedValue);\n                break;\n            case 8:\n                isEqual = this.isTableFormatEqual(source, property, modifiedValue);\n                break;\n            case 9:\n                isEqual = this.isListLevelEqual(source, property, modifiedValue);\n                break;\n            case 10:\n                isEqual = this.isSectionFormatEqual(source, property, modifiedValue);\n                break;\n            default:\n                break;\n        }\n        return isEqual;\n    };\n    // tslint:disable-next-line:max-line-length\n    WUniqueFormat.prototype.isNotEqual = function (property, source, modifiedProperty, modifiedValue, uniqueFormatType) {\n        var targetValue = undefined;\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        if (this.propertiesHash.containsKey(propertyType)) {\n            targetValue = this.propertiesHash.get(propertyType);\n        }\n        var sourceValue = undefined;\n        if (property === modifiedProperty) {\n            sourceValue = modifiedValue;\n        }\n        else if (source.containsKey(propertyType)) {\n            sourceValue = source.get(propertyType);\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!(targetValue === sourceValue || (!isNullOrUndefined(targetValue) && !isNullOrUndefined(sourceValue) && targetValue === sourceValue))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.getPropertyType = function (uniqueFormatType, property) {\n        var type = 0;\n        switch (uniqueFormatType) {\n            case 1:\n                type = this.getBorderPropertyType(property);\n                break;\n            case 2:\n                type = this.getCharacterFormatPropertyType(property);\n                break;\n            case 3:\n                type = this.getParaFormatPropertyType(property);\n                break;\n            case 4:\n                type = this.getCellFormatPropertyType(property);\n                break;\n            case 5:\n                type = this.getShadingPropertyType(property);\n                break;\n            case 6:\n                type = this.getRowFormatType(property);\n                break;\n            case 7:\n                type = this.getListFormatType(property);\n                break;\n            case 8:\n                type = this.getTableFormatType(property);\n                break;\n            case 9:\n                type = this.getListLevelType(property);\n                break;\n            case 10:\n                type = this.getSectionFormatType(property);\n                break;\n            default:\n                break;\n        }\n        return type;\n    };\n    WUniqueFormat.getRowFormatType = function (property) {\n        if (property === 'allowBreakAcrossPages') {\n            return 1;\n        }\n        if (property === 'isHeader') {\n            return 2;\n        }\n        if (property === 'height') {\n            return 3;\n        }\n        if (property === 'heightType') {\n            return 4;\n        }\n        if (property === 'gridBefore') {\n            return 5;\n        }\n        if (property === 'gridBeforeWidth') {\n            return 6;\n        }\n        if (property === 'gridBeforeWidthType') {\n            return 7;\n        }\n        if (property === 'gridAfter') {\n            return 8;\n        }\n        if (property === 'gridAfterWidth') {\n            return 9;\n        }\n        if (property === 'gridAfterWidthType') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListFormatType = function (property) {\n        if (property === 'listId') {\n            return 1;\n        }\n        if (property === 'listLevelNumber') {\n            return 2;\n        }\n        return 0;\n    };\n    WUniqueFormat.getTableFormatType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'cellSpacing') {\n            return 5;\n        }\n        if (property === 'leftIndent') {\n            return 6;\n        }\n        if (property === 'tableAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidth') {\n            return 8;\n        }\n        if (property === 'preferredWidthType') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getListLevelType = function (property) {\n        if (property === 'listLevelPattern') {\n            return 1;\n        }\n        if (property === 'startAt') {\n            return 2;\n        }\n        if (property === 'followCharacter') {\n            return 3;\n        }\n        if (property === 'numberFormat') {\n            return 4;\n        }\n        if (property === 'restartLevel') {\n            return 5;\n        }\n        return 0;\n    };\n    WUniqueFormat.getShadingPropertyType = function (property) {\n        if (property === 'backgroundColor') {\n            return 1;\n        }\n        if (property === 'foregroundColor') {\n            return 2;\n        }\n        if (property === 'textureStyle') {\n            return 3;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCellFormatPropertyType = function (property) {\n        if (property === 'leftMargin') {\n            return 1;\n        }\n        if (property === 'rightMargin') {\n            return 2;\n        }\n        if (property === 'topMargin') {\n            return 3;\n        }\n        if (property === 'bottomMargin') {\n            return 4;\n        }\n        if (property === 'columnSpan') {\n            return 5;\n        }\n        if (property === 'rowSpan') {\n            return 6;\n        }\n        if (property === 'verticalAlignment') {\n            return 7;\n        }\n        if (property === 'preferredWidthType') {\n            return 8;\n        }\n        if (property === 'preferredWidth') {\n            return 9;\n        }\n        if (property === 'cellWidth') {\n            return 10;\n        }\n        return 0;\n    };\n    WUniqueFormat.getBorderPropertyType = function (property) {\n        if (property === 'color') {\n            return 1;\n        }\n        if (property === 'lineStyle') {\n            return 2;\n        }\n        if (property === 'lineWidth') {\n            return 3;\n        }\n        if (property === 'shadow') {\n            return 4;\n        }\n        if (property === 'space') {\n            return 5;\n        }\n        if (property === 'hasNoneStyle') {\n            return 6;\n        }\n        return 0;\n    };\n    WUniqueFormat.getCharacterFormatPropertyType = function (property) {\n        if (property === 'fontColor') {\n            return 1;\n        }\n        if (property === 'fontFamily') {\n            return 2;\n        }\n        if (property === 'fontSize') {\n            return 3;\n        }\n        if (property === 'bold') {\n            return 4;\n        }\n        if (property === 'italic') {\n            return 5;\n        }\n        if (property === 'underline') {\n            return 6;\n        }\n        if (property === 'strikethrough') {\n            return 7;\n        }\n        if (property === 'baselineAlignment') {\n            return 8;\n        }\n        if (property === 'highlightColor') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getParaFormatPropertyType = function (property) {\n        if (property === 'leftIndent') {\n            return 1;\n        }\n        if (property === 'rightIndent') {\n            return 2;\n        }\n        if (property === 'firstLineIndent') {\n            return 3;\n        }\n        if (property === 'textAlignment') {\n            return 4;\n        }\n        if (property === 'beforeSpacing') {\n            return 5;\n        }\n        if (property === 'afterSpacing') {\n            return 6;\n        }\n        if (property === 'lineSpacing') {\n            return 7;\n        }\n        if (property === 'lineSpacingType') {\n            return 8;\n        }\n        if (property === 'outlineLevel') {\n            return 9;\n        }\n        return 0;\n    };\n    WUniqueFormat.getSectionFormatType = function (property) {\n        if (property === 'headerDistance') {\n            return 1;\n        }\n        if (property === 'footerDistance') {\n            return 2;\n        }\n        if (property === 'differentFirstPage') {\n            return 3;\n        }\n        if (property === 'differentOddAndEvenPages') {\n            return 4;\n        }\n        if (property === 'pageWidth') {\n            return 5;\n        }\n        if (property === 'pageHeight') {\n            return 6;\n        }\n        if (property === 'leftMargin') {\n            return 7;\n        }\n        if (property === 'topMargin') {\n            return 8;\n        }\n        if (property === 'rightMargin') {\n            return 9;\n        }\n        if (property === 'bottomMargin') {\n            return 10;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isBorderEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('color', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('lineWidth', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('shadow', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('space', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        if (this.isNotEqual('hasNoneStyle', source, modifiedProperty, modifiedValue, 1)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCharacterFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('fontColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontFamily', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('fontSize', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('bold', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('italic', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('underline', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('strikethrough', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('baselineAlignment', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        if (this.isNotEqual('highlightColor', source, modifiedProperty, modifiedValue, 2)) {\n            return false;\n        }\n        return true;\n    };\n    WUniqueFormat.prototype.isParagraphFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('rightIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('firstLineIndent', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('textAlignment', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('beforeSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('afterSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacing', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('lineSpacingType', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        if (this.isNotEqual('outlineLevel', source, modifiedProperty, modifiedValue, 3)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isCellFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('columnSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('rowSpan', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('verticalAlignment', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        if (this.isNotEqual('cellWidth', source, modifiedProperty, modifiedValue, 4)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isShadingEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('backgroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('foregroundColor', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        if (this.isNotEqual('textureStyle', source, modifiedProperty, modifiedValue, 5)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isRowFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('allowBreakAcrossPages', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('isHeader', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('height', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('heightType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBefore', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridBeforeWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfter', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidth', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        if (this.isNotEqual('gridAfterWidthType', source, modifiedProperty, modifiedValue, 6)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listId', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        if (this.isNotEqual('listLevelNumber', source, modifiedProperty, modifiedValue, 7)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isTableFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('cellSpacing', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('leftIndent', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('tableAlignment', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidth', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        if (this.isNotEqual('preferredWidthType', source, modifiedProperty, modifiedValue, 8)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isListLevelEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('listLevelPattern', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('startAt', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('followCharacter', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('numberFormat', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        if (this.isNotEqual('restartLevel', source, modifiedProperty, modifiedValue, 9)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.isSectionFormatEqual = function (source, modifiedProperty, modifiedValue) {\n        if (this.isNotEqual('headerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('footerDistance', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentFirstPage', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('differentOddAndEvenPages', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageWidth', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('pageHeight', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('leftMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('topMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('rightMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        if (this.isNotEqual('bottomMargin', source, modifiedProperty, modifiedValue, 10)) {\n            return false;\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneItems = function (format, property, value, uniqueFormatType) {\n        var propertyType = WUniqueFormat.getPropertyType(uniqueFormatType, property);\n        var keys = format.propertiesHash.getItem();\n        for (var i = 0; i < keys.length; i++) {\n            if (keys[i] === propertyType) {\n                this.propertiesHash.add(propertyType, value);\n            }\n            else {\n                this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n            }\n        }\n        if (!format.propertiesHash.containsKey(propertyType)) {\n            this.propertiesHash.add(propertyType, value);\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.mergeProperties = function (format) {\n        var hash = format.cloneProperties();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            if (!hash.containsKey(keys[i])) {\n                hash.add(keys[i], this.propertiesHash.get(keys[i]));\n            }\n        }\n        return hash;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.cloneProperties = function () {\n        var hash = new Dictionary();\n        var keys = this.propertiesHash.keys;\n        for (var i = 0; i < keys.length; i++) {\n            hash.add(keys[i], this.propertiesHash.get(keys[i]));\n        }\n        return hash;\n    };\n    // public cloneItemsInternal(format: WUniqueFormat): void {\n    //     let keys: number[] = format.propertiesHash.getItem();\n    //     for (let i: number = 0; i < keys.length; i++) {\n    //         this.propertiesHash.add(keys[i], format.propertiesHash.get(keys[i]));\n    //     }\n    //     this.referenceCount = format.referenceCount;\n    // }\n    /**\n     * @private\n     */\n    WUniqueFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.propertiesHash)) {\n            this.propertiesHash.destroy();\n        }\n        this.propertiesHash = undefined;\n        this.referenceCount = undefined;\n        this.uniqueFormatType = undefined;\n    };\n    return WUniqueFormat;\n}());\nexport { WUniqueFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from './unique-format';\n/**\n * @private\n */\nvar WUniqueFormats = /** @class */ (function () {\n    function WUniqueFormats() {\n        this.items = [];\n    }\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.addUniqueFormat = function (format, type) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(format, undefined, undefined)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(type);\n            matchedFormat.propertiesHash = format;\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.updateUniqueFormat = function (uniqueFormat, property, value) {\n        var matchedFormat = undefined;\n        for (var i = 0; i < this.items.length; i++) {\n            if (this.items[i].isEqual(uniqueFormat.propertiesHash, property, value)) {\n                matchedFormat = this.items[i];\n                break;\n            }\n        }\n        if (isNullOrUndefined(matchedFormat)) {\n            matchedFormat = new WUniqueFormat(uniqueFormat.uniqueFormatType);\n            matchedFormat.cloneItems(uniqueFormat, property, value, uniqueFormat.uniqueFormatType);\n            matchedFormat.referenceCount = 1;\n            this.items.push(matchedFormat);\n        }\n        else {\n            matchedFormat.referenceCount++;\n        }\n        this.remove(uniqueFormat);\n        uniqueFormat = undefined;\n        return matchedFormat;\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.remove = function (uniqueFormat) {\n        uniqueFormat.referenceCount--;\n        if (uniqueFormat.referenceCount <= 0) {\n            this.items.splice(this.items.indexOf(uniqueFormat), 1);\n            uniqueFormat.destroy();\n            uniqueFormat = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.clear = function () {\n        if (isNullOrUndefined(this.items)) {\n            for (var i = 0; i < this.items.length; i++) {\n                this.items[i].destroy();\n            }\n        }\n        this.items = [];\n    };\n    /**\n     * @private\n     */\n    WUniqueFormats.prototype.destroy = function () {\n        this.clear();\n        this.items = undefined;\n    };\n    return WUniqueFormats;\n}());\nexport { WUniqueFormats };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, Property, NotifyPropertyChanges, Event } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined, L10n, setCulture, Browser } from '@syncfusion/ej2-base';\nimport { Save } from '@syncfusion/ej2-file-utils';\nimport { LayoutViewer, PageLayoutViewer, BulletsAndNumberingDialog } from './index';\nimport { Print } from './index';\nimport { BodyWidget, ParagraphWidget } from './index';\nimport { WSectionFormat, WParagraphFormat, WCharacterFormat } from './index';\nimport { SfdtReader } from './index';\nimport { Selection } from './index';\nimport { Editor, EditorHistory } from './index';\nimport { WStyles } from './index';\nimport { Search } from './index';\nimport { OptionsPane } from './index';\nimport { WordExport } from './index';\nimport { TextExport } from './index';\nimport { ContextMenu } from './index';\nimport { ImageResizer } from './index';\nimport { SfdtExport } from './index';\nimport { HyperlinkDialog, TableDialog, BookmarkDialog, StylesDialog, TableOfContentsDialog } from './index';\nimport { PageSetupDialog, ParagraphDialog, ListDialog, StyleDialog, FontDialog } from './index';\nimport { TablePropertiesDialog, BordersAndShadingDialog, CellOptionsDialog, TableOptionsDialog } from './index';\n/**\n * The Document editor component is used to draft, save or print rich text contents as page by page.\n */\nvar DocumentEditor = /** @class */ (function (_super) {\n    __extends(DocumentEditor, _super);\n    /**\n     * Initialize the constructor of DocumentEditor\n     */\n    function DocumentEditor(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        //Internal Variable\n        _this.enableHeaderFooterIn = false;\n        /**\n         * @private\n         */\n        _this.isShiftingEnabled = false;\n        /**\n         * @private\n         */\n        _this.isLayoutEnabled = true;\n        /**\n         * @private\n         */\n        _this.isPastingContent = false;\n        /**\n         * @private\n         */\n        _this.parser = undefined;\n        _this.disableHistoryIn = false;\n        /**\n         * @private\n         */\n        _this.findResultsList = undefined;\n        /**\n         * Gets or sets the name of the document.\n         */\n        _this.documentName = '';\n        /**\n         * @private\n         */\n        _this.tablePropertiesDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.bordersAndShadingDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.cellOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.tableOptionsDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.paragraphDialogModule = undefined;\n        /**\n         * @private\n         */\n        _this.imageResizerModule = undefined;\n        /**\n         * Gets or Sets a value indicating whether holding Ctrl key is required to follow hyperlink on click. The default value is true.\n         */\n        _this.useCtrlClickToFollowHyperlink = true;\n        /**\n         * Gets or sets the page outline color.\n         */\n        _this.pageOutline = '#000000';\n        /**\n         * Gets or sets a value indicating whether to enable cursor in document editor on read only state or not. The default value is false.\n         */\n        _this.enableCursorOnReadOnly = false;\n        /**\n         * Gets or sets a value indicating whether local paste needs to be enabled or not.\n         */\n        _this.enableLocalPaste = false;\n        /**\n         * @private\n         */\n        _this.defaultLocale = {\n            'Table': 'Table',\n            'Row': 'Row',\n            'Cell': 'Cell',\n            'Ok': 'Ok',\n            'Cancel': 'Cancel',\n            'Size': 'Size',\n            'Preferred Width': 'Preferred width',\n            'Points': 'Points',\n            'Percent': 'Percent',\n            'Measure in': 'Measure in',\n            'Alignment': 'Alignment',\n            'Left': 'Left',\n            'Center': 'Center',\n            'Right': 'Right',\n            'Justify': 'Justify',\n            'Indent from left': 'Indent from left',\n            'Borders and Shading': 'Borders and Shading',\n            'Options': 'Options',\n            'Specify height': 'Specify height',\n            'At least': 'At least',\n            'Exactly': 'Exactly',\n            'Row height is': 'Row height is',\n            'Allow row to break across pages': 'Allow row to break across pages',\n            'Repeat as header row at the top of each page': 'Repeat as header row at the top of each page',\n            'Vertical alignment': 'Vertical alignment',\n            'Top': 'Top',\n            'Bottom': 'Bottom',\n            'Default cell margins': 'Default cell margins',\n            'Default cell spacing': 'Default cell spacing',\n            'Allow spacing between cells': 'Allow spacing between cells',\n            'Cell margins': 'Cell margins',\n            'Same as the whole table': 'Same as the whole table',\n            'Borders': 'Borders',\n            'None': 'None',\n            'Single': 'Single',\n            'Dot': 'Dot',\n            'DashSmallGap': 'DashSmallGap',\n            'DashLargeGap': 'DashLargeGap',\n            'DashDot': 'DashDot',\n            'DashDotDot': 'DashDotDot',\n            'Double': 'Double',\n            'Triple': 'Triple',\n            'ThinThickSmallGap': 'ThinThickSmallGap',\n            'ThickThinSmallGap': 'ThickThinSmallGap',\n            'ThinThickThinSmallGap': 'ThinThickThinSmallGap',\n            'ThinThickMediumGap': 'ThinThickMediumGap',\n            'ThickThinMediumGap': 'ThickThinMediumGap',\n            'ThinThickThinMediumGap': 'ThinThickThinMediumGap',\n            'ThinThickLargeGap': 'ThinThickLargeGap',\n            'ThickThinLargeGap': 'ThickThinLargeGap',\n            'ThinThickThinLargeGap': 'ThinThickThinLargeGap',\n            'SingleWavy': 'SingleWavy',\n            'DoubleWavy': 'DoubleWavy',\n            'DashDotStroked': 'DashDotStroked',\n            'Emboss3D': 'Emboss3D',\n            'Engrave3D': 'Engrave3D',\n            'Outset': 'Outset',\n            'Inset': 'Inset',\n            'Thick': 'Thick',\n            'Style': 'Style',\n            'Width': 'Width',\n            'Height': 'Height',\n            'Letter': 'Letter',\n            'Tabloid': 'Tabloid',\n            'Legal': 'Legal',\n            'Statement': 'Statement',\n            'Executive': 'Executive',\n            'A3': 'A3',\n            'A4': 'A4',\n            'A5': 'A5',\n            'B4': 'B4',\n            'B5': 'B5',\n            'Custom Size': 'Custom size',\n            'Different odd and even': 'Different odd and even',\n            'Different first page': 'Different first page',\n            'From edge': 'From edge',\n            'Header': 'Header',\n            'Footer': 'Footer',\n            'Margin': 'Margins',\n            'Paper': 'Paper',\n            'Layout': 'Layout',\n            'Orientation': 'Orientation',\n            'Landscape': 'Landscape',\n            'Portrait': 'Portrait',\n            'Table Of Contents': 'Table Of Contents',\n            'Show page numbers': 'Show page numbers',\n            'Right align page numbers': 'Right align page numbers',\n            'Nothing': 'Nothing',\n            'Tab leader': 'Tab leader',\n            'Show levels': 'Show levels',\n            'Use hyperlinks instead of page numbers': 'Use hyperlinks instead of page numbers',\n            'Build table of contents from': 'Build table of contents from',\n            'Styles': 'Styles',\n            'Available styles': 'Available styles',\n            'TOC level': 'TOC level',\n            'Heading': 'Heading',\n            'List Paragraph': 'List Paragraph',\n            'Normal': 'Normal',\n            'Outline levels': 'Outline levels',\n            'Table entry fields': 'Table entry fields',\n            'Modify': 'Modify',\n            'Color': 'Color',\n            'Setting': 'Setting',\n            'Box': 'Box',\n            'All': 'All',\n            'Custom': 'Custom',\n            'Preview': 'Preview',\n            'Shading': 'Shading',\n            'Fill': 'Fill',\n            'Apply To': 'Apply to',\n            'Table Properties': 'Table Properties',\n            'Cell Options': 'Cell Options',\n            'Table Options': 'Table Options',\n            'Insert Table': 'Insert Table',\n            'Number of columns': 'Number of columns',\n            'Number of rows': 'Number of rows',\n            'Text to display': 'Text to display',\n            'Address': 'Address',\n            'Insert Hyperlink': 'Insert Hyperlink',\n            'Edit Hyperlink': 'Edit Hyperlink',\n            'Insert': 'Insert',\n            'General': 'General',\n            'Indentation': 'Indentation',\n            'Before text': 'Before text',\n            'Special': 'Special',\n            'First line': 'First line',\n            'Hanging': 'Hanging',\n            'After text': 'After text',\n            'By': 'By',\n            'Before': 'Before',\n            'Line Spacing': 'Line spacing',\n            'After': 'After',\n            'At': 'At',\n            'Multiple': 'Multiple',\n            'Spacing': 'Spacing',\n            'Define new Multilevel list': 'Define new Multilevel list',\n            'List level': 'List level',\n            'Choose level to modify': 'Choose level to modify',\n            'Level': 'Level',\n            'Number format': 'Number format',\n            'Number style for this level': 'Number style for this level',\n            'Enter formatting for number': 'Enter formatting for number',\n            'Start at': 'Start at',\n            'Restart list after': 'Restart list after',\n            'Position': 'Position',\n            'Text indent at': 'Text indent at',\n            'Aligned at': 'Aligned at',\n            'Follow number with': 'Follow number with',\n            'Tab character': 'Tab character',\n            'Space': 'Space',\n            'Arabic': 'Arabic',\n            'UpRoman': 'UpRoman',\n            'LowRoman': 'LowRoman',\n            'UpLetter': 'UpLetter',\n            'LowLetter': 'LowLetter',\n            'Number': 'Number',\n            'Leading zero': 'Leading zero',\n            'Bullet': 'Bullet',\n            'Ordinal': 'Ordinal',\n            'Ordinal Text': 'Ordinal Text',\n            'For East': 'For East',\n            'No Restart': 'No Restart',\n            'Font': 'Font',\n            'Font style': 'Font style',\n            'Underline style': 'Underline style',\n            'Font color': 'Font color',\n            'Effects': 'Effects',\n            'Strikethrough': 'Strikethrough',\n            'Superscript': 'Superscript',\n            'Subscript': 'Subscript',\n            'Double strikethrough': 'Double strikethrough',\n            'Regular': 'Regular',\n            'Bold': 'Bold',\n            'Italic': 'Italic',\n            'Cut': 'Cut',\n            'Copy': 'Copy',\n            'Paste': 'Paste',\n            'Hyperlink': 'Hyperlink',\n            'Open Hyperlink': 'Open Hyperlink',\n            'Copy Hyperlink': 'Copy Hyperlink',\n            'Remove Hyperlink': 'Remove Hyperlink',\n            'Paragraph': 'Paragraph',\n            'Merge Cells': 'Merge Cells',\n            'Insert Above': 'Insert Above',\n            'Insert Below': 'Insert Below',\n            'Insert Left': 'Insert Left',\n            'Insert Right': 'Insert Right',\n            'Delete': 'Delete',\n            'Delete Table': 'Delete Table',\n            'Delete Row': 'Delete Row',\n            'Delete Column': 'Delete Column',\n            'File Name': 'File Name',\n            'Format Type': 'Format Type',\n            'Save': 'Save',\n            'Navigation': 'Navigation',\n            'Results': 'Results',\n            'Replace': 'Replace',\n            'Replace All': 'Replace All',\n            'We replaced all': 'We replaced all',\n            'Find': 'Find',\n            'No matches': 'No matches',\n            'All Done': 'All Done',\n            'Result': 'Result',\n            'of': 'of',\n            'instances': 'instances',\n            'with': 'with',\n            'Click to follow link': 'Click to follow link',\n            'Continue Numbering': 'Continue Numbering',\n            'Bookmark name': 'Bookmark name',\n            'Close': 'Close',\n            'Restart At': 'Restart At',\n            'Properties': 'Properties',\n            'Name': 'Name',\n            'Style type': 'Style type',\n            'Style based on': 'Style based on',\n            'Style for following paragraph': 'Style for following paragraph',\n            'Formatting': 'Formatting',\n            'Numbering and Bullets': 'Numbering and Bullets',\n            'Numbering': 'Numbering',\n            'Update Field': 'Update Field',\n            'Edit Field': 'Edit Field',\n            'Bookmark': 'Bookmark',\n            'Page Setup': 'Page Setup',\n            'No bookmarks found': 'No bookmarks found',\n            'Number format tooltip information': 'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>'\n                + 'For example, \"Chapter %1.\" will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>â€¦'\n                + '</br>Chapter N. Item</br>'\n                + '</br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]'\n                + '</br>For example, \"%1.%2.\" will display numbering like</br>1.1. Item</br>1.2. Item</br>â€¦</br>1.N. Item',\n            'Format': 'Format',\n            'Create New Style': 'Create New Style',\n            'Modify Style': 'Modify Style',\n            'New': 'New',\n            'Bullets': 'Bullets',\n            'Use bookmarks': 'Use bookmarks',\n            'Table of Contents': 'Table of Contents'\n        };\n        _this.viewer = new PageLayoutViewer(_this);\n        _this.parser = new SfdtReader(_this.viewer);\n        return _this;\n    }\n    DocumentEditor_1 = DocumentEditor;\n    Object.defineProperty(DocumentEditor.prototype, \"enableHeaderAndFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.enableHeaderFooterIn;\n        },\n        set: function (value) {\n            this.enableHeaderFooterIn = value;\n            this.viewer.updateScrollBars();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"pageCount\", {\n        /**\n         * Gets the total number of pages.\n         */\n        get: function () {\n            if (!this.isDocumentLoaded || isNullOrUndefined(this.viewer)) {\n                return 1;\n            }\n            return this.viewer.pages.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"selection\", {\n        /**\n         *  Gets the selection object of the document editor.\n         * @returns Selection\n         * @default undefined\n         */\n        get: function () {\n            return this.selectionModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editor\", {\n        /**\n         *  Gets the editor object of the document editor.\n         * @returns Editor\n         * @default undefined\n         */\n        get: function () {\n            return this.editorModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"editorHistory\", {\n        /**\n         * Gets the editor history object of the document editor.\n         * @returns EditorHistory\n         */\n        get: function () {\n            return this.editorHistoryModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"search\", {\n        /**\n         * Gets the search object of the document editor.\n         * @returns { Search }\n         */\n        get: function () {\n            return this.searchModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"contextMenu\", {\n        /**\n         * Gets the context menu object of the document editor.\n         * @returns ContextMenu\n         */\n        get: function () {\n            return this.contextMenuModule;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"containerId\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.element.id;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isDocumentLoaded\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isDocumentLoadedIn;\n        },\n        set: function (value) {\n            this.isDocumentLoadedIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableHistoryMode\", {\n        /**\n         * Determines whether history needs to be enabled or not.\n         * @default - false\n         * @private\n         */\n        get: function () {\n            return this.enableEditorHistory && !isNullOrUndefined(this.editorHistoryModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentStart\", {\n        /**\n         * Gets the start text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentStart();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"documentEnd\", {\n        /**\n         * Gets the end text position in the document.\n         * @default undefined\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.selectionModule)) {\n                return this.selection.getDocumentEnd();\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"isReadOnlyMode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isReadOnly || isNullOrUndefined(this.editorModule) || isNullOrUndefined(this.selectionModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(DocumentEditor.prototype, \"enableImageResizerMode\", {\n        /**\n         * Specifies to enable image resizer option\n         * default - false\n         * @private\n         */\n        get: function () {\n            return this.enableImageResizer && !isNullOrUndefined(this.imageResizerModule);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    DocumentEditor.prototype.preRender = function () {\n        this.findResultsList = [];\n        //pre render section\n    };\n    DocumentEditor.prototype.render = function () {\n        this.viewer.initializeComponents();\n        this.openBlank();\n        if (!isNullOrUndefined(this.element)) {\n            var container = this.element;\n            container.style.minHeight = '200px';\n            container.style.minWidth = '200px';\n        }\n    };\n    /**\n     * Get component name\n     * @private\n     */\n    DocumentEditor.prototype.getModuleName = function () {\n        return 'DocumentEditor';\n    };\n    /**\n     * Called internally if any of the property value changed.\n     * @private\n     */\n    DocumentEditor.prototype.onPropertyChanged = function (model, oldProp) {\n        for (var _i = 0, _a = Object.keys(model); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'zoomFactor':\n                    if (this.viewer) {\n                        this.viewer.zoomFactor = model.zoomFactor;\n                    }\n                    break;\n                case 'locale':\n                    this.localizeDialogs();\n                    break;\n                case 'isReadOnly':\n                    if (!isNullOrUndefined(this.optionsPaneModule) && this.optionsPaneModule.isOptionsPaneShow) {\n                        this.optionsPaneModule.showHideOptionsPane(false);\n                    }\n                    break;\n            }\n        }\n    };\n    DocumentEditor.prototype.localizeDialogs = function () {\n        if (this.locale !== '') {\n            var l10n = new L10n('documenteditor', this.defaultLocale);\n            l10n.setLocale(this.locale);\n            setCulture(this.locale);\n            if (this.optionsPaneModule) {\n                this.optionsPaneModule.initOptionsPane(l10n);\n            }\n            if (this.paragraphDialogModule) {\n                this.paragraphDialogModule.initParagraphDialog(l10n);\n            }\n            if (this.pageSetupDialogModule) {\n                this.pageSetupDialogModule.initPageSetupDialog(l10n);\n            }\n            if (this.fontDialogModule) {\n                this.fontDialogModule.initFontDialog(l10n);\n            }\n            if (this.hyperlinkDialogModule) {\n                this.hyperlinkDialogModule.initHyperlinkDialog(l10n);\n            }\n            if (this.contextMenuModule) {\n                this.contextMenuModule.initContextMenu(l10n);\n            }\n            if (this.listDialogModule) {\n                this.listDialogModule.initListDialog(l10n);\n            }\n            if (this.tablePropertiesDialogModule) {\n                this.tablePropertiesDialogModule.initTablePropertyDialog(l10n);\n            }\n            if (this.bordersAndShadingDialogModule) {\n                this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(l10n);\n            }\n            if (this.cellOptionsDialogModule) {\n                this.cellOptionsDialogModule.initCellMarginsDialog(l10n);\n            }\n            if (this.tableOptionsDialogModule) {\n                this.tableOptionsDialogModule.initTableOptionsDialog(l10n);\n            }\n            if (this.tableDialogModule) {\n                this.tableDialogModule.initTableDialog(l10n);\n            }\n            if (this.styleDialogModule) {\n                this.styleDialogModule.initStyleDialog(l10n);\n            }\n            if (this.tableOfContentsDialogModule) {\n                this.tableOfContentsDialogModule.initTableOfContentDialog(l10n);\n            }\n        }\n    };\n    /**\n     * Get the properties to be maintained in the persisted state.\n     * @private\n     */\n    DocumentEditor.prototype.getPersistData = function () {\n        return 'documenteditor';\n    };\n    DocumentEditor.prototype.clearPreservedCollectionsInViewer = function () {\n        if (this.viewer instanceof LayoutViewer) {\n            this.viewer.clearDocumentItems();\n        }\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.getDocumentEditorElement = function () {\n        return this.element;\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireContentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('contentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireDocumentChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('documentChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireSelectionChange = function () {\n        if (!this.viewer.isCompositionStart && Browser.isDevice && this.editorModule) {\n            this.editorModule.predictText();\n        }\n        var eventArgs = { source: this };\n        this.trigger('selectionChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireZoomFactorChange = function () {\n        var eventArgs = { source: this };\n        this.trigger('zoomFactorChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    DocumentEditor.prototype.fireViewChange = function () {\n        if (this.viewer && this.viewer.pages.length > 0) {\n            if (this.viewer.visiblePages.length > 0) {\n                var pages = this.viewer.visiblePages;\n                var eventArgs = {\n                    startPage: pages[0].index + 1,\n                    endPage: pages[pages.length - 1].index + 1,\n                    source: this\n                };\n                this.trigger('viewChange', eventArgs);\n            }\n        }\n    };\n    /**\n     * Shows the Paragraph dialog\n     * @private\n     */\n    DocumentEditor.prototype.showParagraphDialog = function (paragraphFormat) {\n        if (this.paragraphDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.paragraphDialogModule.show(paragraphFormat);\n        }\n    };\n    /**\n     * Shows the margin dialog\n     * @private\n     */\n    DocumentEditor.prototype.showPageSetupDialog = function () {\n        if (this.pageSetupDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.pageSetupDialogModule.show();\n        }\n    };\n    /**\n     * Shows the font dialog\n     * @private\n     */\n    DocumentEditor.prototype.showFontDialog = function (characterFormat) {\n        if (this.fontDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.fontDialogModule.showFontDialog(characterFormat);\n        }\n    };\n    /**\n     * Shows the cell option dialog\n     * @private\n     */\n    DocumentEditor.prototype.showCellOptionsDialog = function () {\n        if (this.cellOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.cellOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table options dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showTableOptionsDialog = function () {\n        if (this.tableOptionsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOptionsDialogModule.show();\n        }\n    };\n    /**\n     * Shows insert table dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableDialog = function () {\n        if (this.tableDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableDialogModule.show();\n        }\n    };\n    /**\n     * Shows the table of content dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTableOfContentsDialog = function () {\n        if (this.tableOfContentsDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tableOfContentsDialogModule.show();\n        }\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Shows the style dialog\n     * @private\n     */\n    DocumentEditor.prototype.showStyleDialog = function () {\n        if (this.styleDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.styleDialogModule.show();\n        }\n    };\n    /**\n     * Shows the hyperlink dialog\n     * @private\n     */\n    DocumentEditor.prototype.showHyperlinkDialog = function () {\n        if (this.hyperlinkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.hyperlinkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the bookmark dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showBookmarkDialog = function () {\n        if (this.bookmarkDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bookmarkDialogModule.show();\n        }\n    };\n    /**\n     * Shows the styles dialog.\n     * @private\n     */\n    DocumentEditor.prototype.showStylesDialog = function () {\n        if (this.stylesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.stylesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the List dialog\n     * @private\n     */\n    DocumentEditor.prototype.showListDialog = function () {\n        if (this.listDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.listDialogModule.showListDialog();\n        }\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    DocumentEditor.prototype.showTablePropertiesDialog = function () {\n        if (this.tablePropertiesDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.tablePropertiesDialogModule.show();\n        }\n    };\n    /**\n     * Shows the borders and shading dialog\n     * @private\n     */\n    DocumentEditor.prototype.showBordersAndShadingDialog = function () {\n        if (this.bordersAndShadingDialogModule && !this.isReadOnlyMode && this.viewer) {\n            this.bordersAndShadingDialogModule.show();\n        }\n    };\n    //tslint:disable: max-func-body-length\n    DocumentEditor.prototype.requiredModules = function () {\n        var modules = [];\n        if (this.enablePrint) {\n            modules.push({\n                member: 'Print', args: []\n            });\n        }\n        if (this.enableSfdtExport || this.enableWordExport || this.enableTextExport || this.enableSelection || this.enableEditor) {\n            modules.push({\n                member: 'SfdtExport', args: [this.viewer]\n            });\n        }\n        if (this.enableWordExport) {\n            modules.push({\n                member: 'WordExport', args: []\n            });\n        }\n        if (this.enableTextExport) {\n            modules.push({\n                member: 'TextExport', args: []\n            });\n        }\n        if (this.enableSelection || this.enableSearch || this.enableEditor) {\n            modules.push({\n                member: 'Selection', args: [this]\n            });\n            if (this.enableContextMenu) {\n                modules.push({\n                    member: 'ContextMenu', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableSearch) {\n            modules.push({\n                member: 'Search', args: [this]\n            });\n            if (this.enableOptionsPane) {\n                modules.push({\n                    member: 'OptionsPane', args: [this.viewer]\n                });\n            }\n        }\n        if (this.enableEditor) {\n            modules.push({\n                member: 'Editor', args: [this.viewer]\n            });\n            if (this.enableImageResizer) {\n                modules.push({\n                    member: 'ImageResizer', args: [this, this.viewer]\n                });\n            }\n            if (this.enableEditorHistory) {\n                modules.push({\n                    member: 'EditorHistory', args: [this]\n                });\n            }\n            if (this.enableHyperlinkDialog) {\n                modules.push({\n                    member: 'HyperlinkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableDialog) {\n                modules.push({\n                    member: 'TableDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBookmarkDialog) {\n                modules.push({\n                    member: 'BookmarkDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOfContentsDialog) {\n                modules.push({\n                    member: 'TableOfContentsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enablePageSetupDialog) {\n                modules.push({\n                    member: 'PageSetupDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableStyleDialog) {\n                modules.push({\n                    member: 'StylesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'StyleDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'BulletsAndNumberingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableListDialog) {\n                modules.push({\n                    member: 'ListDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableParagraphDialog) {\n                modules.push({\n                    member: 'ParagraphDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableFontDialog) {\n                modules.push({\n                    member: 'FontDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTablePropertiesDialog) {\n                modules.push({\n                    member: 'TablePropertiesDialog', args: [this.viewer]\n                });\n                modules.push({\n                    member: 'CellOptionsDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableBordersAndShadingDialog) {\n                modules.push({\n                    member: 'BordersAndShadingDialog', args: [this.viewer]\n                });\n            }\n            if (this.enableTableOptionsDialog) {\n                modules.push({\n                    member: 'TableOptionsDialog', args: [this.viewer]\n                });\n            }\n        }\n        return modules;\n    };\n    // Public Implementation Starts\n    /**\n     * Opens the given Sfdt text.\n     * @param {string} sfdtText.\n     */\n    DocumentEditor.prototype.open = function (sfdtText) {\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.lists = [];\n            this.viewer.abstractLists = [];\n            this.viewer.styles = new WStyles();\n            if (!isNullOrUndefined(sfdtText) && this.viewer) {\n                this.viewer.onDocumentChanged(this.parser.convertJsonToDocument(sfdtText));\n                if (this.editorModule) {\n                    this.editorModule.intializeDefaultStyles();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls view to start of the given page number if exists.\n     * @param  {number} pageNumber.\n     * @returns void\n     */\n    DocumentEditor.prototype.scrollToPage = function (pageNumber) {\n        if (isNullOrUndefined(this.viewer) || pageNumber < 1 || pageNumber > this.viewer.pages.length) {\n            return false;\n        }\n        this.viewer.scrollToPage(pageNumber - 1);\n        return true;\n    };\n    /**\n     * Enables all the modules.\n     * @returns void\n     */\n    DocumentEditor.prototype.enableAllModules = function () {\n        this.enablePrint = this.enableSfdtExport = this.enableWordExport = this.enableTextExport\n            = this.enableSelection = this.enableContextMenu = this.enableSearch = this.enableOptionsPane\n                = this.enableEditor = this.enableImageResizer = this.enableEditorHistory\n                    = this.enableHyperlinkDialog = this.enableTableDialog = this.enableBookmarkDialog\n                        = this.enableTableOfContentsDialog = this.enablePageSetupDialog = this.enableStyleDialog\n                            = this.enableListDialog = this.enableParagraphDialog = this.enableFontDialog\n                                = this.enableTablePropertiesDialog = this.enableBordersAndShadingDialog\n                                    = this.enableTableOptionsDialog = true;\n        // tslint:disable-next-line:max-line-length\n        DocumentEditor_1.Inject(Print, SfdtExport, WordExport, TextExport, Selection, Search, Editor, ImageResizer, EditorHistory, ContextMenu, OptionsPane, HyperlinkDialog, TableDialog, BookmarkDialog, TableOfContentsDialog, PageSetupDialog, StyleDialog, ListDialog, ParagraphDialog, BulletsAndNumberingDialog, FontDialog, TablePropertiesDialog, BordersAndShadingDialog, TableOptionsDialog, CellOptionsDialog, StylesDialog);\n    };\n    /**\n     * Resizes the component and its sub elements based on given size or container size.\n     * @param width\n     * @param height\n     */\n    DocumentEditor.prototype.resize = function (width, height) {\n        if (this.element) {\n            if (!isNullOrUndefined(width) && width > 200) {\n                this.element.style.width = width + 'px';\n            }\n            if (!isNullOrUndefined(height) && height > 200) {\n                this.element.style.height = height + 'px';\n            }\n            if (this.viewer) {\n                this.viewer.updateViewerSize();\n            }\n        }\n    };\n    /**\n     * Shifts the focus to the document.\n     */\n    DocumentEditor.prototype.focusIn = function () {\n        if (this.viewer) {\n            this.viewer.updateFocus();\n        }\n    };\n    /**\n     * Fits the page based on given fit type.\n     * @param  {PageFitType} pageFitType? - Default value of â€˜pageFitTypeâ€™ parameter is 'None'\n     * @returns void\n     */\n    DocumentEditor.prototype.fitPage = function (pageFitType) {\n        if (isNullOrUndefined(pageFitType)) {\n            pageFitType = 'None';\n        }\n        if (this.viewer) {\n            this.viewer.pageFitType = pageFitType;\n        }\n    };\n    /**\n     * Prints the document.\n     * @param  {Window} printWindow? - Default value of 'printWindow' parameter is undefined.\n     */\n    DocumentEditor.prototype.print = function (printWindow) {\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (this.printModule) {\n            this.printModule.print(this.viewer, printWindow);\n        }\n        else {\n            throw new Error('Invalid operation. Print is not enabled.');\n        }\n    };\n    /**\n     * Serialize the data to JSON string.\n     */\n    DocumentEditor.prototype.serialize = function () {\n        var json = '';\n        if (this.enableSfdtExport && this.sfdtExportModule instanceof SfdtExport) {\n            json = this.sfdtExportModule.serialize();\n        }\n        else {\n            throw new Error('Invalid operation. Sfdt export is not enabled.');\n        }\n        return json;\n    };\n    /**\n     * Saves the document.\n     * @param {string} fileName\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.save = function (fileName, formatType) {\n        fileName = fileName || 'Untitled';\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation.');\n        }\n        if (formatType === 'Docx' && this.wordExportModule) {\n            if (this.wordExportModule) {\n                this.wordExportModule.save(this.viewer, fileName);\n            }\n        }\n        else if (formatType === 'Txt' && this.textExportModule) {\n            this.textExportModule.save(this.viewer, fileName);\n        }\n        else if (formatType === 'Sfdt' && this.enableSfdtExport && this.sfdtExportModule) {\n            var jsonString = this.serialize();\n            var blob = new Blob([jsonString], {\n                type: 'application/json'\n            });\n            Save.save(fileName + '.sfdt', blob);\n        }\n        else {\n            throw new Error('Invalid operation. Specified export is not enabled.');\n        }\n    };\n    /**\n     * Saves the document as blob.\n     * @param {FormatType} formatType\n     */\n    DocumentEditor.prototype.saveAsBlob = function (formatType) {\n        var _this = this;\n        if (isNullOrUndefined(this.viewer)) {\n            throw new Error('Invalid operation');\n        }\n        return new Promise(function (resolve, reject) {\n            if (formatType === 'Docx' && _this.wordExportModule) {\n                resolve(_this.wordExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Txt' && _this.textExportModule) {\n                resolve(_this.textExportModule.saveAsBlob(_this.viewer));\n            }\n            else if (formatType === 'Sfdt' && _this.enableSfdtExport && _this.sfdtExportModule) {\n                resolve(_this.sfdtExportModule.saveAsBlob(_this.viewer));\n            }\n        });\n    };\n    /**\n     * Opens a blank document.\n     */\n    DocumentEditor.prototype.openBlank = function () {\n        var section = new BodyWidget();\n        section.index = 0;\n        section.sectionFormat = new WSectionFormat(section);\n        var paragraph = new ParagraphWidget();\n        paragraph.index = 0;\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        section.childWidgets.push(paragraph);\n        paragraph.containerWidget = section;\n        var sections = [];\n        sections.push(section);\n        // tslint:disable-next-line:max-line-length\n        var hfs = this.parser.parseHeaderFooter({ header: {}, footer: {}, evenHeader: {}, evenFooter: {}, firstPageHeader: {}, firstPageFooter: {} }, undefined);\n        if (this.viewer) {\n            this.clearPreservedCollectionsInViewer();\n            this.viewer.headersFooters.push(hfs);\n            this.viewer.onDocumentChanged(sections);\n            if (this.editorModule) {\n                this.editorModule.intializeDefaultStyles();\n                var style = this.viewer.styles.findByName('Normal');\n                paragraph.paragraphFormat.baseStyle = style;\n                paragraph.paragraphFormat.listFormat.baseStyle = style;\n            }\n        }\n    };\n    /**\n     * Gets the style names based on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyleNames = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyleNames(styleType);\n        }\n        return [];\n    };\n    /**\n     * Gets the style objects on given style type.\n     * @param styleType\n     */\n    DocumentEditor.prototype.getStyles = function (styleType) {\n        if (this.viewer) {\n            return this.viewer.styles.getStyles(styleType);\n        }\n        return [];\n    };\n    /**\n     * Shows the dialog.\n     * @param {DialogType} dialogType\n     * @returns void\n     */\n    DocumentEditor.prototype.showDialog = function (dialogType) {\n        switch (dialogType) {\n            case 'Hyperlink':\n                this.showHyperlinkDialog();\n                break;\n            case 'Table':\n                this.showTableDialog();\n                break;\n            case 'Bookmark':\n                this.showBookmarkDialog();\n                break;\n            case 'TableOfContents':\n                this.showTableOfContentsDialog();\n                break;\n            case 'PageSetup':\n                this.showPageSetupDialog();\n                break;\n            case 'List':\n                this.showListDialog();\n                break;\n            case 'Styles':\n                this.showStylesDialog();\n                break;\n            case 'Style':\n                this.showStyleDialog();\n                break;\n            case 'Paragraph':\n                this.showParagraphDialog();\n                break;\n            case 'Font':\n                this.showFontDialog();\n                break;\n            case 'TableProperties':\n                this.showTablePropertiesDialog();\n                break;\n            case 'BordersAndShading':\n                this.showBordersAndShadingDialog();\n                break;\n            case 'TableOptions':\n                this.showTableOptionsDialog();\n                break;\n        }\n    };\n    /**\n     * Shows the options pane.\n     */\n    DocumentEditor.prototype.showOptionsPane = function () {\n        if (!isNullOrUndefined(this.optionsPaneModule) && !isNullOrUndefined(this.viewer)) {\n            this.optionsPaneModule.showHideOptionsPane(true);\n        }\n    };\n    /**\n     * Destroys all managed resources used by this object.\n     */\n    DocumentEditor.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        this.destroyDependentModules();\n        if (!isNullOrUndefined(this.viewer)) {\n            this.viewer.destroy();\n        }\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.element)) {\n            this.element.classList.remove('e-documenteditor');\n            this.element.innerHTML = '';\n        }\n        this.element = undefined;\n        this.findResultsList = [];\n        this.findResultsList = undefined;\n    };\n    DocumentEditor.prototype.destroyDependentModules = function () {\n        if (this.printModule) {\n            this.printModule.destroy();\n            this.printModule = undefined;\n        }\n        if (this.sfdtExportModule) {\n            this.sfdtExportModule.destroy();\n            this.sfdtExportModule = undefined;\n        }\n        if (this.optionsPaneModule) {\n            this.optionsPaneModule.destroy();\n            this.optionsPaneModule = undefined;\n        }\n        if (!isNullOrUndefined(this.hyperlinkDialogModule)) {\n            this.hyperlinkDialogModule.destroy();\n            this.hyperlinkDialogModule = undefined;\n        }\n        if (this.searchModule) {\n            this.searchModule.destroy();\n            this.searchModule = undefined;\n        }\n        if (this.contextMenuModule) {\n            this.contextMenuModule.destroy();\n            this.contextMenuModule = undefined;\n        }\n        if (this.editorModule) {\n            this.editorModule.destroy();\n            this.editorModule = undefined;\n        }\n        if (this.selectionModule) {\n            this.selectionModule.destroy();\n            this.selectionModule = undefined;\n        }\n        if (this.editorHistoryModule) {\n            this.editorHistoryModule.destroy();\n            this.editorHistoryModule = undefined;\n        }\n        if (!isNullOrUndefined(this.paragraphDialogModule)) {\n            this.paragraphDialogModule.destroy();\n            this.paragraphDialogModule = undefined;\n        }\n        if (this.pageSetupDialogModule) {\n            this.pageSetupDialogModule.destroy();\n            this.pageSetupDialogModule = undefined;\n        }\n        if (this.fontDialogModule) {\n            this.fontDialogModule.destroy();\n            this.fontDialogModule = undefined;\n        }\n        if (this.listDialogModule) {\n            this.listDialogModule.destroy();\n            this.listDialogModule = undefined;\n        }\n        if (this.imageResizerModule) {\n            this.imageResizerModule.destroy();\n            this.imageResizerModule = undefined;\n        }\n        if (this.tablePropertiesDialogModule) {\n            this.tablePropertiesDialogModule.destroy();\n            this.tablePropertiesDialogModule = undefined;\n        }\n        if (this.bordersAndShadingDialogModule) {\n            this.bordersAndShadingDialogModule.destroy();\n            this.bordersAndShadingDialogModule = undefined;\n        }\n        if (this.cellOptionsDialogModule) {\n            this.cellOptionsDialogModule.destroy();\n            this.cellOptionsDialogModule = undefined;\n        }\n        if (this.tableOptionsDialogModule) {\n            this.tableOptionsDialogModule.destroy();\n            this.tableOptionsDialogModule = undefined;\n        }\n        if (this.tableDialogModule) {\n            this.tableDialogModule.destroy();\n            this.tableDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule = undefined;\n        }\n        if (this.bookmarkDialogModule) {\n            this.bookmarkDialogModule.destroy();\n            this.bookmarkDialogModule = undefined;\n        }\n        if (this.styleDialogModule) {\n            this.styleDialogModule.destroy();\n            this.styleDialogModule = undefined;\n        }\n        if (this.textExportModule) {\n            this.textExportModule.destroy();\n            this.textExportModule = undefined;\n        }\n        if (this.wordExportModule) {\n            this.wordExportModule.destroy();\n            this.wordExportModule = undefined;\n        }\n        if (this.tableOfContentsDialogModule) {\n            this.tableOfContentsDialogModule.destroy();\n            this.tableOfContentsDialogModule = undefined;\n        }\n    };\n    var DocumentEditor_1;\n    __decorate([\n        Property(1)\n    ], DocumentEditor.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(true)\n    ], DocumentEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePrint\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSelection\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditor\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableEditorHistory\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSfdtExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableWordExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTextExport\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableOptionsPane\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableContextMenu\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableHyperlinkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBookmarkDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOfContentsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableSearch\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableParagraphDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableListDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTablePropertiesDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableBordersAndShadingDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enablePageSetupDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableStyleDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableFontDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableOptionsDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableTableDialog\", void 0);\n    __decorate([\n        Property(false)\n    ], DocumentEditor.prototype, \"enableImageResizer\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"documentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"viewChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"zoomFactorChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"selectionChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"requestNavigate\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"contentChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"keyDown\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"searchResultsChange\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], DocumentEditor.prototype, \"destroyed\", void 0);\n    DocumentEditor = DocumentEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], DocumentEditor);\n    return DocumentEditor;\n}(Component));\nexport { DocumentEditor };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Print class\n */\nvar Print = /** @class */ (function () {\n    function Print() {\n    }\n    /**\n     * Gets module name.\n     */\n    Print.prototype.getModuleName = function () {\n        return 'Print';\n    };\n    /**\n     * Prints the current viewer\n     * @param viewer\n     * @param printWindow\n     * @private\n     */\n    Print.prototype.print = function (viewer, printWindow) {\n        this.printWindow(viewer, navigator.userAgent, printWindow);\n    };\n    /**\n     * Opens print window and displays current page to print.\n     * @private\n     */\n    Print.prototype.printWindow = function (viewer, browserUserAgent, printWindow) {\n        var height = this.getPageHeight(viewer.pages);\n        var width = this.getPageWidth(viewer.pages);\n        var printElement = document.createElement('div');\n        printElement.style.width = '100%';\n        printElement.style.height = '100%';\n        printElement.style.overflow = 'scroll';\n        // Rendering canvas to print\n        this.generatePrintContent(viewer, printElement);\n        if (isNullOrUndefined(printWindow)) {\n            printWindow = window.open('', 'print', 'height=452,width=1024,tabbar=no');\n        }\n        if ((browserUserAgent.indexOf('Chrome') !== -1) || (browserUserAgent.indexOf('Firefox')) !== -1) {\n            // Chrome and Firefox\n            printWindow.document.write('<!DOCTYPE html>');\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:' + width.toString() + 'px ' + height.toString() + 'px; }@media print{ body { margin: 0cm; }</style></head> <body><center>');\n        }\n        else {\n            // Internet Explorer and Edge\n            // tslint:disable-next-line:max-line-length\n            printWindow.document.write('<html><head><style>@page{margin:0;size:' + width.toString() + 'px ' + height.toString() + 'px;}</style></head><body><center>');\n        }\n        // tslint:disable-next-line:max-line-length\n        printWindow.document.write(printElement.innerHTML + '</center><script> (function() { window.ready = true; })(); </script></body></html>');\n        printElement = undefined;\n        printWindow.document.close();\n        printWindow.focus();\n        var interval = setInterval(function () {\n            if (printWindow.ready) {\n                printWindow.print();\n                printWindow.close();\n                clearInterval(interval);\n            }\n        }, 500);\n    };\n    /**\n     * Generates print content.\n     * @private\n     */\n    Print.prototype.generatePrintContent = function (viewer, element) {\n        // Rendering canvas to print\n        var htmlString = '';\n        for (var i = 0; i < viewer.pages.length; i++) {\n            var page = viewer.pages[i];\n            var pageHeight = page.boundingRectangle.height;\n            var pageWidth = page.boundingRectangle.width;\n            viewer.render.isPrinting = true;\n            viewer.render.renderWidgets(page, 0, 0, 0, 0);\n            var canvasURL = viewer.render.pageCanvas.toDataURL();\n            viewer.render.isPrinting = false;\n            // tslint:disable-next-line:max-line-length\n            htmlString += '<div><img src=' + canvasURL + ' style=\"margin:0px;display:block;width: ' + pageWidth.toString() + 'px; height:' + pageHeight.toString() + 'px; \"/></div><br/>';\n        }\n        element.innerHTML = htmlString;\n    };\n    /**\n     * Gets page width.\n     * @param pages\n     * @private\n     */\n    Print.prototype.getPageWidth = function (pages) {\n        var width = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (width < pages[i].boundingRectangle.width) {\n                width = pages[i].boundingRectangle.width;\n            }\n        }\n        return width;\n    };\n    /**\n     *  Gets page height.\n     * @private\n     */\n    Print.prototype.getPageHeight = function (pages) {\n        var height = 0;\n        for (var i = 0; i < pages.length; i++) {\n            if (height < pages[i].boundingRectangle.height) {\n                height = pages[i].boundingRectangle.height;\n            }\n        }\n        return height;\n    };\n    /**\n     * @private\n     */\n    Print.prototype.destroy = function () {\n        return;\n    };\n    return Print;\n}());\nexport { Print };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\n/**\n * @private\n */\nvar WSectionFormat = /** @class */ (function () {\n    function WSectionFormat(node) {\n        this.uniqueSectionFormat = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WSectionFormat.prototype, \"headerDistance\", {\n        get: function () {\n            return this.getPropertyValue('headerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('headerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"footerDistance\", {\n        get: function () {\n            return this.getPropertyValue('footerDistance');\n        },\n        set: function (value) {\n            this.setPropertyValue('footerDistance', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentFirstPage\", {\n        get: function () {\n            return this.getPropertyValue('differentFirstPage');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentFirstPage', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        get: function () {\n            return this.getPropertyValue('differentOddAndEvenPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('differentOddAndEvenPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageHeight\", {\n        get: function () {\n            return this.getPropertyValue('pageHeight');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageHeight', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"pageWidth\", {\n        get: function () {\n            return this.getPropertyValue('pageWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('pageWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WSectionFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WSectionFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = undefined;\n    };\n    WSectionFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueSectionFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            return this.uniqueSectionFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WSectionFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'headerDistance':\n                value = 36;\n                break;\n            case 'footerDistance':\n                value = 36;\n                break;\n            case 'differentFirstPage':\n                value = false;\n                break;\n            case 'differentOddAndEvenPages':\n                value = false;\n                break;\n            case 'pageWidth':\n                value = 612;\n                break;\n            case 'pageHeight':\n                value = 792;\n                break;\n            case 'leftMargin':\n                value = 72;\n                break;\n            case 'topMargin':\n                value = 72;\n                break;\n            case 'rightMargin':\n                value = 72;\n                break;\n            case 'bottomMargin':\n                value = 72;\n                break;\n        }\n        return value;\n    };\n    WSectionFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueSectionFormat) && this.uniqueSectionFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueSectionFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WSectionFormat.getPropertyDefaultValue(property);\n    };\n    WSectionFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WSectionFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueSectionFormat)) {\n            this.initializeUniqueSectionFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueSectionFormat.uniqueFormatType, property);\n            if (this.uniqueSectionFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueSectionFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat, property, value);\n        }\n    };\n    WSectionFormat.prototype.initializeUniqueSectionFormat = function (property, propValue) {\n        var uniqueSectionFormatTemp = new Dictionary();\n        this.addUniqueSectionFormat('headerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('footerDistance', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentFirstPage', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('differentOddAndEvenPages', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageWidth', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('pageHeight', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('leftMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('topMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('rightMargin', property, propValue, uniqueSectionFormatTemp);\n        this.addUniqueSectionFormat('bottomMargin', property, propValue, uniqueSectionFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(uniqueSectionFormatTemp, WSectionFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WSectionFormat.prototype.addUniqueSectionFormat = function (property, modifiedProperty, propValue, uniqueSectionFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WSectionFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueSectionFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueSectionFormatTemp.add(propertyType, WSectionFormat.getPropertyDefaultValue(property));\n        }\n    };\n    WSectionFormat.prototype.copyFormat = function (format, history) {\n        if (history && (history.isUndoing || history.isRedoing)) {\n            this.uniqueSectionFormat = format.uniqueSectionFormat;\n        }\n        else {\n            if (!isNullOrUndefined(format)) {\n                if (!isNullOrUndefined(format.uniqueSectionFormat) && format.uniqueSectionFormat.propertiesHash) {\n                    this.updateUniqueSectionFormat(format);\n                }\n            }\n        }\n    };\n    WSectionFormat.prototype.updateUniqueSectionFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueSectionFormat) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n            if (this.uniqueSectionFormat.referenceCount === 0) {\n                WSectionFormat.uniqueSectionFormats.remove(this.uniqueSectionFormat);\n                this.uniqueSectionFormat = undefined;\n            }\n        }\n        this.uniqueSectionFormat = new WUniqueFormat(WSectionFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueSectionFormat.mergeProperties(format.uniqueSectionFormat);\n        }\n        this.uniqueSectionFormat = WSectionFormat.uniqueSectionFormats.addUniqueFormat(hash, WSectionFormat.uniqueFormatType);\n    };\n    WSectionFormat.prototype.cloneFormat = function () {\n        var format = new WSectionFormat();\n        format.uniqueSectionFormat = this.uniqueSectionFormat;\n        return format;\n    };\n    WSectionFormat.clear = function () {\n        this.uniqueSectionFormats.clear();\n    };\n    WSectionFormat.uniqueSectionFormats = new WUniqueFormats();\n    WSectionFormat.uniqueFormatType = 10;\n    return WSectionFormat;\n}());\nexport { WSectionFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WLevelOverride = /** @class */ (function () {\n    function WLevelOverride() {\n    }\n    WLevelOverride.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.overrideListLevel)) {\n            this.overrideListLevel.destroy();\n        }\n        this.levelNumber = undefined;\n        this.startAt = undefined;\n        this.overrideListLevel = undefined;\n    };\n    return WLevelOverride;\n}());\nexport { WLevelOverride };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WLevelOverride } from './level-override';\n/**\n * @private\n */\nvar WList = /** @class */ (function () {\n    function WList() {\n        this.listId = -1;\n        this.sourceListId = -1;\n        this.abstractListId = -1;\n        this.abstractList = undefined;\n        this.levelOverrides = [];\n    }\n    WList.prototype.getListLevel = function (levelNumber) {\n        var listLevel = undefined;\n        var levelOverride = this.getLevelOverride(levelNumber);\n        if (!isNullOrUndefined(levelOverride) && !isNullOrUndefined(levelOverride.overrideListLevel)) {\n            listLevel = levelOverride.overrideListLevel;\n        }\n        else {\n            listLevel = this.abstractList.levels[levelNumber];\n        }\n        return listLevel;\n    };\n    WList.prototype.getLevelOverride = function (levelNumber) {\n        for (var i = 0; i < this.levelOverrides.length; i++) {\n            if (this.levelOverrides[i] instanceof WLevelOverride) {\n                var levelOverride = this.levelOverrides[i];\n                if (levelOverride.levelNumber === levelNumber) {\n                    return levelOverride;\n                }\n            }\n        }\n        return undefined;\n    };\n    WList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levelOverrides)) {\n            this.levelOverrides = [];\n        }\n        this.abstractListId = undefined;\n        this.listId = undefined;\n        this.sourceListId = undefined;\n        this.levelOverrides = undefined;\n    };\n    WList.prototype.mergeList = function (list) {\n        if (!isNullOrUndefined(this.abstractListId) && this.abstractListId !== -1) {\n            this.abstractListId = list.abstractListId;\n        }\n        if (!isNullOrUndefined(this.listId) && this.listId !== -1) {\n            this.listId = list.listId;\n        }\n        if (!isNullOrUndefined(this.sourceListId) && this.sourceListId !== -1) {\n            this.sourceListId = list.sourceListId;\n        }\n        if (!isNullOrUndefined(this.levelOverrides) && this.levelOverrides.length !== 0) {\n            this.levelOverrides = list.levelOverrides;\n        }\n    };\n    return WList;\n}());\nexport { WList };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { WList } from '../list/list';\n/**\n * @private\n */\nvar WListFormat = /** @class */ (function () {\n    function WListFormat(node) {\n        this.uniqueListFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.list = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WListFormat.prototype, \"listId\", {\n        get: function () {\n            return this.getPropertyValue('listId');\n        },\n        set: function (listId) {\n            this.setPropertyValue('listId', listId);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevelNumber\", {\n        get: function () {\n            return this.getPropertyValue('listLevelNumber');\n        },\n        set: function (value) {\n            this.setPropertyValue('listLevelNumber', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListFormat.prototype, \"listLevel\", {\n        get: function () {\n            var list = undefined;\n            if (!isNullOrUndefined(this.list)) {\n                list = this.list;\n            }\n            else {\n                /* tslint:disable-next-line:no-any */\n                var baseListStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseListStyle)) {\n                    if (baseListStyle.paragraphFormat.listFormat.list) {\n                        list = baseListStyle.paragraphFormat.listFormat.list;\n                        break;\n                    }\n                    else {\n                        baseListStyle = baseListStyle.basedOn;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(list)) {\n                return list.getListLevel(this.listLevelNumber);\n            }\n            else {\n                return undefined;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            if (this.baseStyle instanceof WParagraphStyle) {\n                /* tslint:disable-next-line:no-any */\n                var baseStyle = this.baseStyle;\n                while (!isNullOrUndefined(baseStyle)) {\n                    if (baseStyle.paragraphFormat.listFormat.hasValue(property)) {\n                        break;\n                    }\n                    else {\n                        baseStyle = baseStyle.basedOn;\n                    }\n                }\n                if (!isNullOrUndefined(baseStyle)) {\n                    var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n                    return baseStyle.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(propertyType);\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueListFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WListFormat.getPropertyDefaultValue(property);\n    };\n    WListFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListFormat)) {\n            this.initializeUniqueListFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            if (this.uniqueListFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueListFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueListFormat = WListFormat.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat, property, value);\n        }\n    };\n    WListFormat.prototype.initializeUniqueListFormat = function (property, propValue) {\n        var uniqueListFormatTemp = new Dictionary();\n        this.addUniqueListFormat('listId', property, propValue, uniqueListFormatTemp);\n        this.addUniqueListFormat('listLevelNumber', property, propValue, uniqueListFormatTemp);\n        this.uniqueListFormat = WListFormat.uniqueListFormats.addUniqueFormat(uniqueListFormatTemp, WListFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListFormat.prototype.addUniqueListFormat = function (property, modifiedProperty, propValue, uniqueListFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueListFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WListFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listId':\n                value = -1;\n                break;\n            case 'listLevelNumber':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueListFormat)) {\n                this.listId = format.listId;\n                this.listLevelNumber = format.listLevelNumber;\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.list)) {\n                this.list = format.list;\n            }\n        }\n    };\n    WListFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueListFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListFormat.uniqueFormatType, property);\n            return this.uniqueListFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WListFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueListFormat) && this.uniqueListFormat.referenceCount === 0) {\n            WListFormat.uniqueListFormats.remove(this.uniqueListFormat);\n        }\n        this.uniqueListFormat = undefined;\n        this.list = undefined;\n    };\n    WListFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WListFormat.clear = function () {\n        this.uniqueListFormats.clear();\n    };\n    WListFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WListFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('listId'))) {\n            this.listId = format.getValue('listId');\n        }\n        if (isNullOrUndefined(this.getValue('listLevelNumber'))) {\n            this.listLevelNumber = format.getValue('listLevelNumber');\n        }\n        if (!isNullOrUndefined(format.list)) {\n            if (isNullOrUndefined(this.list)) {\n                this.list = new WList();\n            }\n            this.list.mergeList(format.list);\n        }\n    };\n    WListFormat.uniqueListFormats = new WUniqueFormats();\n    WListFormat.uniqueFormatType = 7;\n    return WListFormat;\n}());\nexport { WListFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WListFormat } from './list-format';\nimport { WParagraphStyle } from './style';\n/**\n * @private\n */\nvar WTabStop = /** @class */ (function () {\n    function WTabStop() {\n    }\n    Object.defineProperty(WTabStop.prototype, \"position\", {\n        get: function () {\n            return this.positionIn;\n        },\n        set: function (value) {\n            this.positionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"deletePosition\", {\n        get: function () {\n            return this.deletePositionIn;\n        },\n        set: function (value) {\n            this.deletePositionIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabJustification\", {\n        get: function () {\n            return this.justification;\n        },\n        set: function (value) {\n            this.justification = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTabStop.prototype, \"tabLeader\", {\n        get: function () {\n            return this.leader;\n        },\n        set: function (value) {\n            this.leader = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTabStop.prototype.destroy = function () {\n        this.position = undefined;\n        this.deletePosition = undefined;\n        this.tabJustification = undefined;\n        this.leader = undefined;\n    };\n    return WTabStop;\n}());\nexport { WTabStop };\n/**\n * @private\n */\nvar WParagraphFormat = /** @class */ (function () {\n    function WParagraphFormat(node) {\n        this.uniqueParagraphFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseStyle = undefined;\n        this.tabs = undefined;\n        this.ownerBase = node;\n        this.listFormat = new WListFormat(this);\n        this.tabs = [];\n    }\n    WParagraphFormat.prototype.getUpdatedTabs = function () {\n        var inTabs = [];\n        if (!isNullOrUndefined(this.baseStyle)) {\n            /* tslint:disable-next-line:no-any */\n            var baseStyle = this.baseStyle;\n            var tabStops = new Dictionary();\n            while (!isNullOrUndefined(baseStyle)) {\n                for (var _i = 0, _a = baseStyle.paragraphFormat.tabs; _i < _a.length; _i++) {\n                    var tab = _a[_i];\n                    if (!tabStops.containsKey(tab.position)) {\n                        tabStops.add(tab.position, tab);\n                    }\n                }\n                baseStyle = baseStyle.basedOn;\n            }\n            for (var _b = 0, _c = tabStops.keys; _b < _c.length; _b++) {\n                var key = _c[_b];\n                if (!this.hasTabStop(key)) {\n                    inTabs.push(tabStops.get(key));\n                }\n            }\n            inTabs = inTabs.concat(this.tabs.filter(function (a) { return (a.position !== 0 && a.deletePosition === 0); }));\n            inTabs = inTabs.sort(function (a, b) { return a.position - b.position; });\n        }\n        return inTabs;\n    };\n    WParagraphFormat.prototype.hasTabStop = function (position) {\n        for (var i = 0; i < this.tabs.length; i++) {\n            if (this.tabs[i].deletePosition === position) {\n                return true;\n            }\n        }\n        return false;\n    };\n    Object.defineProperty(WParagraphFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"rightIndent\", {\n        get: function () {\n            return this.getPropertyValue('rightIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"firstLineIndent\", {\n        get: function () {\n            return this.getPropertyValue('firstLineIndent');\n        },\n        set: function (value) {\n            this.setPropertyValue('firstLineIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"beforeSpacing\", {\n        get: function () {\n            return this.getPropertyValue('beforeSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('beforeSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"afterSpacing\", {\n        get: function () {\n            return this.getPropertyValue('afterSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('afterSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacing\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacing');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"lineSpacingType\", {\n        get: function () {\n            return this.getPropertyValue('lineSpacingType');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineSpacingType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"textAlignment\", {\n        get: function () {\n            return this.getPropertyValue('textAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('textAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WParagraphFormat.prototype, \"outlineLevel\", {\n        get: function () {\n            return this.getPropertyValue('outlineLevel');\n        },\n        set: function (value) {\n            this.setPropertyValue('outlineLevel', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WParagraphFormat.prototype.getListFormatParagraphFormat = function (property) {\n        if (this.listFormat.listId > -1 && this.listFormat.listLevelNumber > -1) {\n            var level = this.listFormat.listLevel;\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(level) && !isNullOrUndefined(level.paragraphFormat.uniqueParagraphFormat) && level.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return level.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    WParagraphFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var ifListFormat = this.getListFormatParagraphFormat(property);\n            if (!isNullOrUndefined(ifListFormat)) {\n                return ifListFormat;\n            }\n            else {\n                if (this.baseStyle instanceof WParagraphStyle) {\n                    /* tslint:disable-next-line:no-any */\n                    var baseStyle = this.baseStyle;\n                    while (!isNullOrUndefined(baseStyle)) {\n                        if (baseStyle.paragraphFormat.hasValue(property)) {\n                            break;\n                        }\n                        else {\n                            baseStyle = baseStyle.basedOn;\n                        }\n                    }\n                    if (!isNullOrUndefined(baseStyle)) {\n                        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n                        return baseStyle.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n                    }\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueParagraphFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WParagraphFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        var docParagraphFormat = this.documentParagraphFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docParagraphFormat) && !isNullOrUndefined(docParagraphFormat.uniqueParagraphFormat) && docParagraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(propertyType)) {\n            return docParagraphFormat.uniqueParagraphFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WParagraphFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WParagraphFormat.prototype.documentParagraphFormat = function () {\n        var docParagraphFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                docParagraphFormat = this.ownerBase.bodyWidget.page.viewer.paragraphFormat;\n            }\n        }\n        return docParagraphFormat;\n    };\n    WParagraphFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WParagraphFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueParagraphFormat)) {\n            this.initializeUniqueParagraphFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            if (this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueParagraphFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat, property, value);\n        }\n    };\n    WParagraphFormat.prototype.initializeUniqueParagraphFormat = function (property, propValue) {\n        var uniqueParaFormatTemp = new Dictionary();\n        this.addUniqueParaFormat('leftIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('rightIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('firstLineIndent', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('textAlignment', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('beforeSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('afterSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacing', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('lineSpacingType', property, propValue, uniqueParaFormatTemp);\n        this.addUniqueParaFormat('outlineLevel', property, propValue, uniqueParaFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(uniqueParaFormatTemp, WParagraphFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WParagraphFormat.prototype.addUniqueParaFormat = function (property, modifiedProperty, propValue, uniqueParaFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WParagraphFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueParaFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WParagraphFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'rightIndent':\n                value = 0;\n                break;\n            case 'firstLineIndent':\n                value = 0;\n                break;\n            case 'textAlignment':\n                value = 'Left';\n                break;\n            case 'beforeSpacing':\n                value = 0;\n                break;\n            case 'afterSpacing':\n                value = 0;\n                break;\n            case 'lineSpacing':\n                value = 1;\n                break;\n            case 'lineSpacingType':\n                value = 'Multiple';\n                break;\n            case 'styleName':\n                value = 'Normal';\n                break;\n            case 'outlineLevel':\n                value = 'BodyText';\n                break;\n        }\n        return value;\n    };\n    WParagraphFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.clearFormat();\n        }\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && this.uniqueParagraphFormat.referenceCount === 0) {\n            WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = undefined;\n        this.baseStyle = undefined;\n    };\n    WParagraphFormat.prototype.destroy = function () {\n        this.clearFormat();\n        if (!isNullOrUndefined(this.listFormat)) {\n            this.listFormat.destroy();\n        }\n        this.listFormat = undefined;\n        if (this.tabs !== undefined) {\n            for (var i = 0; i < this.tabs.length; i++) {\n                this.tabs[i].destroy();\n            }\n            this.tabs = undefined;\n        }\n    };\n    WParagraphFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueParagraphFormat)) {\n                this.updateUniqueParagraphFormat(format);\n            }\n            if (!isNullOrUndefined(format.listFormat)) {\n                this.listFormat.copyFormat(format.listFormat);\n            }\n            if (!isNullOrUndefined(format.baseStyle)) {\n                this.baseStyle = format.baseStyle;\n            }\n            if (!isNullOrUndefined(format.tabs)) {\n                for (var i = 0; i < format.tabs.length; i++) {\n                    this.tabs[i] = format.tabs[i];\n                }\n            }\n        }\n    };\n    WParagraphFormat.prototype.updateUniqueParagraphFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueParagraphFormat) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n            if (this.uniqueParagraphFormat.referenceCount === 0) {\n                WParagraphFormat.uniqueParagraphFormats.remove(this.uniqueParagraphFormat);\n                this.uniqueParagraphFormat = undefined;\n            }\n        }\n        this.uniqueParagraphFormat = new WUniqueFormat(WParagraphFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueParagraphFormat.mergeProperties(format.uniqueParagraphFormat);\n        }\n        this.uniqueParagraphFormat = WParagraphFormat.uniqueParagraphFormats.addUniqueFormat(hash, WParagraphFormat.uniqueFormatType);\n    };\n    WParagraphFormat.prototype.cloneFormat = function () {\n        var format = new WParagraphFormat(undefined);\n        format.uniqueParagraphFormat = this.uniqueParagraphFormat;\n        format.baseStyle = this.baseStyle;\n        if (isNullOrUndefined(this.listFormat)) {\n            format.listFormat = undefined;\n        }\n        else {\n            format.listFormat = new WListFormat();\n            format.listFormat.listId = this.listFormat.listId;\n            format.listFormat.listLevelNumber = this.listFormat.listLevelNumber;\n        }\n        return format;\n    };\n    WParagraphFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueParagraphFormat) && !isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType, property);\n            return this.uniqueParagraphFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WParagraphFormat.clear = function () {\n        this.uniqueParagraphFormats.clear();\n    };\n    WParagraphFormat.prototype.ApplyStyle = function (baseStyle) {\n        this.baseStyle = baseStyle;\n        this.listFormat.ApplyStyle(this.baseStyle);\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WParagraphFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('leftIndent'))) {\n            this.leftIndent = format.getValue('leftIndent');\n        }\n        if (isNullOrUndefined(this.getValue('rightIndent'))) {\n            this.rightIndent = format.getValue('rightIndent');\n        }\n        if (isNullOrUndefined(this.getValue('firstLineIndent'))) {\n            this.firstLineIndent = format.getValue('firstLineIndent');\n        }\n        if (isNullOrUndefined(this.getValue('beforeSpacing'))) {\n            this.beforeSpacing = format.getValue('beforeSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('afterSpacing'))) {\n            this.afterSpacing = format.getValue('afterSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacing'))) {\n            this.lineSpacing = format.getValue('lineSpacing');\n        }\n        if (isNullOrUndefined(this.getValue('lineSpacingType'))) {\n            this.lineSpacingType = format.getValue('lineSpacingType');\n        }\n        if (isNullOrUndefined(this.getValue('textAlignment'))) {\n            this.textAlignment = format.getValue('textAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('outlineLevel'))) {\n            this.outlineLevel = format.getValue('outlineLevel');\n        }\n        if (isNullOrUndefined(this.listFormat)) {\n            this.listFormat.mergeFormat(format.listFormat);\n        }\n    };\n    WParagraphFormat.uniqueParagraphFormats = new WUniqueFormats();\n    WParagraphFormat.uniqueFormatType = 3;\n    return WParagraphFormat;\n}());\nexport { WParagraphFormat };\n","import { ParagraphWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WParagraphStyle } from './style';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WCharacterFormat = /** @class */ (function () {\n    function WCharacterFormat(node) {\n        this.uniqueCharacterFormat = undefined;\n        this.ownerBase = undefined;\n        this.baseCharStyle = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WCharacterFormat.prototype, \"bold\", {\n        get: function () {\n            return this.getPropertyValue('bold');\n        },\n        set: function (value) {\n            this.setPropertyValue('bold', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"italic\", {\n        get: function () {\n            return this.getPropertyValue('italic');\n        },\n        set: function (value) {\n            this.setPropertyValue('italic', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontSize\", {\n        get: function () {\n            return this.getPropertyValue('fontSize');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontSize', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontFamily\", {\n        get: function () {\n            return this.getPropertyValue('fontFamily');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontFamily', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"underline\", {\n        get: function () {\n            return this.getPropertyValue('underline');\n        },\n        set: function (value) {\n            this.setPropertyValue('underline', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"strikethrough\", {\n        get: function () {\n            return this.getPropertyValue('strikethrough');\n        },\n        set: function (value) {\n            this.setPropertyValue('strikethrough', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"baselineAlignment\", {\n        get: function () {\n            return this.getPropertyValue('baselineAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('baselineAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"highlightColor\", {\n        get: function () {\n            return this.getPropertyValue('highlightColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('highlightColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCharacterFormat.prototype, \"fontColor\", {\n        get: function () {\n            return this.getPropertyValue('fontColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('fontColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCharacterFormat.prototype.getPropertyValue = function (property) {\n        if (!this.hasValue(property)) {\n            var charStyleValue = this.checkCharacterStyle(property);\n            if (!isNullOrUndefined(charStyleValue)) {\n                return charStyleValue;\n            }\n            else {\n                var baseStyleValue = this.checkBaseStyle(property);\n                if (!isNullOrUndefined(baseStyleValue)) {\n                    return baseStyleValue;\n                }\n            }\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCharacterFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return this.getDefaultValue(property);\n    };\n    WCharacterFormat.prototype.getDefaultValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        var docCharacterFormat = this.documentCharacterFormat();\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(docCharacterFormat) && !isNullOrUndefined(docCharacterFormat.uniqueCharacterFormat) && docCharacterFormat.uniqueCharacterFormat.propertiesHash.containsKey(propertyType)) {\n            return docCharacterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        else {\n            return WCharacterFormat.getPropertyDefaultValue(property);\n        }\n    };\n    WCharacterFormat.prototype.documentCharacterFormat = function () {\n        var docCharacterFormat;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                docCharacterFormat = this.ownerBase.paragraph.bodyWidget.page.viewer.characterFormat;\n            }\n            else {\n                if (!isNullOrUndefined(this.ownerBase.bodyWidget)) {\n                    docCharacterFormat = this.ownerBase.bodyWidget.page.viewer.characterFormat;\n                }\n            }\n        }\n        return docCharacterFormat;\n    };\n    WCharacterFormat.prototype.checkBaseStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle;\n        if (!isNullOrUndefined(this.ownerBase)) {\n            if (!isNullOrUndefined(this.ownerBase.paragraph)) {\n                baseStyle = this.ownerBase.paragraph.paragraphFormat.baseStyle;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ((this.ownerBase instanceof ParagraphWidget) && !isNullOrUndefined(this.ownerBase.paragraphFormat)) {\n                    baseStyle = this.ownerBase.paragraphFormat.baseStyle;\n                }\n                else {\n                    if (!isNullOrUndefined(this.ownerBase instanceof WParagraphStyle)) {\n                        baseStyle = this.ownerBase.basedOn;\n                    }\n                }\n            }\n        }\n        while (!isNullOrUndefined(baseStyle)) {\n            if (baseStyle.characterFormat.hasValue(property)) {\n                break;\n            }\n            else {\n                baseStyle = baseStyle.basedOn;\n            }\n        }\n        if (!isNullOrUndefined(baseStyle)) {\n            var propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n            return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(propertyType);\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.checkCharacterStyle = function (property) {\n        /* tslint:disable-next-line:no-any */\n        var baseStyle = this.baseCharStyle;\n        if (!isNullOrUndefined(baseStyle)) {\n            while (!isNullOrUndefined(baseStyle) && baseStyle.name !== 'Default Paragraph Font') {\n                var hasKey = baseStyle.characterFormat.hasValue(property);\n                if (hasKey) {\n                    var returnPropertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n                    return baseStyle.characterFormat.uniqueCharacterFormat.propertiesHash.get(returnPropertyType);\n                }\n                else {\n                    baseStyle = baseStyle.basedOn;\n                }\n            }\n        }\n        return undefined;\n    };\n    WCharacterFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCharacterFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCharacterFormat)) {\n            this.initializeUniqueCharacterFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            if (this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueCharacterFormat.propertiesHash.get(propertyType) === value) { //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat, property, value);\n        }\n    };\n    WCharacterFormat.prototype.initializeUniqueCharacterFormat = function (property, propValue) {\n        var uniqueCharFormatTemp = new Dictionary();\n        this.addUniqueCharacterFormat('fontColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontFamily', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('fontSize', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('bold', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('italic', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('underline', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('strikethrough', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('baselineAlignment', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('highlightColor', property, propValue, uniqueCharFormatTemp);\n        this.addUniqueCharacterFormat('styleName', property, propValue, uniqueCharFormatTemp);\n        // tslint:disable-next-line:max-line-length\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(uniqueCharFormatTemp, WCharacterFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCharacterFormat.prototype.addUniqueCharacterFormat = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCharacterFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCharacterFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'bold':\n                value = false;\n                break;\n            case 'italic':\n                value = false;\n                break;\n            case 'fontSize':\n                value = 11;\n                break;\n            case 'underline':\n                value = 'None';\n                break;\n            case 'strikethrough':\n                value = 'None';\n                break;\n            case 'baselineAlignment':\n                value = 'Normal';\n                break;\n            case 'highlightColor':\n                value = 'NoColor';\n                break;\n            case 'fontColor':\n                value = '#000000';\n                break;\n            case 'fontFamily':\n                value = 'Calibri';\n                break;\n            case 'styleName':\n                value = 'Default Paragraph Font';\n                break;\n        }\n        return value;\n    };\n    WCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.fontFamily === format.fontFamily\n            && this.bold === format.bold\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.underline === format.underline\n            && this.fontColor === format.fontColor\n            && this.strikethrough === format.strikethrough\n            && this.highlightColor === format.highlightColor);\n    };\n    WCharacterFormat.prototype.isSameFormat = function (format) {\n        return this.baseCharStyle === format.baseCharStyle &&\n            this.uniqueCharacterFormat === format.uniqueCharacterFormat;\n    };\n    WCharacterFormat.prototype.cloneFormat = function () {\n        var format = new WCharacterFormat(undefined);\n        format.uniqueCharacterFormat = this.uniqueCharacterFormat;\n        format.baseCharStyle = this.baseCharStyle;\n        return format;\n    };\n    WCharacterFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && !isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType, property);\n            return this.uniqueCharacterFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCharacterFormat.prototype.clearFormat = function () {\n        if (!isNullOrUndefined(this.uniqueCharacterFormat) && this.uniqueCharacterFormat.referenceCount === 0) {\n            WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = undefined;\n        this.baseCharStyle = undefined;\n    };\n    WCharacterFormat.prototype.destroy = function () {\n        this.clearFormat();\n    };\n    WCharacterFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCharacterFormat) && format.uniqueCharacterFormat.propertiesHash) {\n                this.updateUniqueCharacterFormat(format);\n            }\n            if (!isNullOrUndefined(format.baseCharStyle)) {\n                this.baseCharStyle = format.baseCharStyle;\n            }\n        }\n    };\n    WCharacterFormat.prototype.updateUniqueCharacterFormat = function (format) {\n        var hash = undefined;\n        if (this.uniqueCharacterFormat) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n            if (this.uniqueCharacterFormat.referenceCount === 0) {\n                WCharacterFormat.uniqueCharacterFormats.remove(this.uniqueCharacterFormat);\n                this.uniqueCharacterFormat = undefined;\n            }\n        }\n        this.uniqueCharacterFormat = new WUniqueFormat(WCharacterFormat.uniqueFormatType);\n        if (isNullOrUndefined(hash)) {\n            hash = this.uniqueCharacterFormat.mergeProperties(format.uniqueCharacterFormat);\n        }\n        this.uniqueCharacterFormat = WCharacterFormat.uniqueCharacterFormats.addUniqueFormat(hash, WCharacterFormat.uniqueFormatType);\n    };\n    WCharacterFormat.clear = function () {\n        this.uniqueCharacterFormats.clear();\n    };\n    WCharacterFormat.prototype.ApplyStyle = function (baseCharStyle) {\n        this.baseCharStyle = baseCharStyle;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.getValue = function (property) {\n        return this.hasValue(property) ? this.getPropertyValue(property) : undefined;\n    };\n    /**\n     * For internal use\n     * @private\n     */\n    WCharacterFormat.prototype.mergeFormat = function (format) {\n        if (isNullOrUndefined(this.getValue('bold'))) {\n            this.bold = format.getValue('bold');\n        }\n        if (isNullOrUndefined(this.getValue('italic'))) {\n            this.italic = format.getValue('italic');\n        }\n        if (isNullOrUndefined(this.getValue('fontSize'))) {\n            this.fontSize = format.getValue('fontSize');\n        }\n        if (isNullOrUndefined(this.getValue('fontFamily'))) {\n            this.fontFamily = format.getValue('fontFamily');\n        }\n        if (isNullOrUndefined(this.getValue('underline'))) {\n            this.underline = format.getValue('underline');\n        }\n        if (isNullOrUndefined(this.getValue('strikethrough'))) {\n            this.strikethrough = format.getValue('strikethrough');\n        }\n        if (isNullOrUndefined(this.getValue('baselineAlignment'))) {\n            this.baselineAlignment = format.getValue('baselineAlignment');\n        }\n        if (isNullOrUndefined(this.getValue('highlightColor'))) {\n            this.highlightColor = format.getValue('highlightColor');\n        }\n        if (isNullOrUndefined(this.getValue('fontColor'))) {\n            this.fontColor = format.getValue('fontColor');\n        }\n    };\n    WCharacterFormat.uniqueCharacterFormats = new WUniqueFormats();\n    WCharacterFormat.uniqueFormatType = 2;\n    return WCharacterFormat;\n}());\nexport { WCharacterFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar HelperMethods = /** @class */ (function () {\n    function HelperMethods() {\n    }\n    /**\n     * Inserts text at specified index in string.\n     * @param {string} spanText\n     * @param {number} index\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.insert = function (spanText, index, text) {\n        if (index >= 0) {\n            return [spanText.slice(0, index) + text + spanText.slice(index)].join('');\n        }\n        else {\n            return text + this;\n        }\n    };\n    /**\n     * Removes text from specified index in string.\n     * @param {string} text\n     * @param {number} index\n     * @param {number} length\n     * @private\n     */\n    HelperMethods.remove = function (text, index, length) {\n        if (index === 0) {\n            return text.substring(index + 1, text.length);\n        }\n        else {\n            return text.substring(0, index) + text.substring(index + 1, text.length);\n        }\n    };\n    /**\n     * Returns the index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    /* tslint:disable:no-any */\n    HelperMethods.indexOfAny = function (text, wordSplitCharacter) {\n        var index = undefined;\n        for (var j = 0; j < wordSplitCharacter.length; j++) {\n            var temp = text.indexOf(wordSplitCharacter[j]);\n            if (temp !== -1 && isNullOrUndefined(index)) {\n                index = temp;\n            }\n            else if (temp !== -1 && temp < index) {\n                index = temp;\n            }\n        }\n        return isNullOrUndefined(index) ? -1 : index;\n    };\n    /**\n     * Returns the last index of word split character in a string.\n     * @param {string} text\n     * @param {string[]} wordSplitCharacter\n     * @private\n     */\n    HelperMethods.lastIndexOfAny = function (text, wordSplitCharacter) {\n        for (var i = text.length - 1; i >= 0; i--) {\n            for (var j = 0; j <= wordSplitCharacter.length - 1; j++) {\n                if (text[i] === wordSplitCharacter[j]) {\n                    return i;\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * Adds css styles to document header.\n     * @param {string} css\n     * @private\n     */\n    HelperMethods.addCssStyle = function (css) {\n        var style = document.createElement('style');\n        if (style.style.cssText) {\n            style.style.cssText = css;\n        }\n        else {\n            style.appendChild(document.createTextNode(css));\n        }\n        document.getElementsByTagName('head')[0].appendChild(style);\n    };\n    /**\n     * Gets highlight color code.\n     * @param {HighlightColor} highlightColor\n     * @private\n     */\n    HelperMethods.getHighlightColorCode = function (highlightColor) {\n        var color = '#ffffff';\n        switch (highlightColor) {\n            case 'Yellow':\n                color = '#ffff00';\n                break;\n            case 'BrightGreen':\n                color = '#00ff00';\n                break;\n            case 'Turquoise':\n                color = '#00ffff';\n                break;\n            case 'Pink':\n                color = '#ff00ff';\n                break;\n            case 'Blue':\n                color = '#0000ff';\n                break;\n            case 'Red':\n                color = '#ff0000';\n                break;\n            case 'DarkBlue':\n                color = '#000080';\n                break;\n            case 'Teal':\n                color = '#008080';\n                break;\n            case 'Green':\n                color = '#008000';\n                break;\n            case 'Violet':\n                color = '#800080';\n                break;\n            case 'DarkRed':\n                color = '#800000';\n                break;\n            case 'DarkYellow':\n                color = '#808000';\n                break;\n            case 'Gray50':\n                color = '#808080';\n                break;\n            case 'Gray25':\n                color = '#c0c0c0';\n                break;\n            case 'Black':\n                color = '#000000';\n                break;\n        }\n        return color;\n    };\n    /**\n     * Converts point to pixel.\n     * @param {number} point\n     * @private\n     */\n    HelperMethods.convertPointToPixel = function (point) {\n        var pixel = HelperMethods.round((point * 96 / 72), 5);\n        return pixel;\n    };\n    /**\n     * Converts pixel to point.\n     * @param {number} pixel\n     * @private\n     */\n    HelperMethods.convertPixelToPoint = function (pixel) {\n        var point = HelperMethods.round((pixel * 72 / 96), 5);\n        return point;\n    };\n    /**\n     * Return true if field linked\n     * @private\n     */\n    HelperMethods.isLinkedFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            return !isNullOrUndefined(inline.fieldEnd);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            return !isNullOrUndefined(inline.fieldBegin) && !isNullOrUndefined(inline.fieldEnd);\n        }\n        else {\n            return !isNullOrUndefined(inline.fieldBegin);\n        }\n    };\n    /**\n     * Removes white space in a string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.removeSpace = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            for (var i = 0; i < text.length; i++) {\n                if (text.charAt(i) === ' ') {\n                    //replace the space by empty string in string\n                    text = text.replace(' ', '');\n                }\n            }\n        }\n        return text;\n    };\n    /**\n     * Trims white space at start of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimStart = function (text) {\n        var i = 0;\n        for (i; i < text.length; i++) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(i, text.length);\n    };\n    /**\n     * Trims white space at end of the string.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.trimEnd = function (text) {\n        var i = text.length - 1;\n        for (i; i >= 0; i--) {\n            if (text[i] !== ' ') {\n                break;\n            }\n        }\n        return text.substring(0, i + 1);\n    };\n    /**\n     * Checks whether string ends with whitespace.\n     * @param {string} text\n     * @private\n     */\n    HelperMethods.endsWith = function (text) {\n        if (!isNullOrUndefined(text) && text.length !== 0) {\n            return text[text.length - 1] === ' ';\n        }\n        return false;\n    };\n    /**\n     * @private\n     * Write Characterformat\n     * @param {any} characterFormat\n     * @param {boolean} isInline\n     * @param {WCharacterFormat} format\n     */\n    HelperMethods.writeCharacterFormat = function (characterFormat, isInline, format) {\n        characterFormat.bold = isInline ? format.bold : format.getValue('bold');\n        characterFormat.italic = isInline ? format.italic : format.getValue('italic');\n        characterFormat.fontSize = isInline ? format.fontSize : format.getValue('fontSize');\n        characterFormat.fontFamily = isInline ? format.fontFamily : format.getValue('fontFamily');\n        characterFormat.underline = isInline ? format.underline : format.getValue('underline');\n        characterFormat.strikethrough = isInline ? format.strikethrough : format.getValue('strikethrough');\n        characterFormat.baselineAlignment = isInline ? format.baselineAlignment : format.getValue('baselineAlignment');\n        characterFormat.highlightColor = isInline ? format.highlightColor : format.getValue('highlightColor');\n        characterFormat.fontColor = isInline ? format.fontColor : format.getValue('fontColor');\n        characterFormat.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * Rounds the values with specified decimal digits.\n     * @param {number} value\n     * @param {number} decimalDigits\n     * @private\n     */\n    HelperMethods.round = function (value, decimalDigits) {\n        var temp = value;\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp * 10;\n        }\n        temp = Math.round(temp);\n        for (var i = 0; i < decimalDigits; i++) {\n            temp = temp / 10;\n        }\n        return temp;\n    };\n    /**\n     * @private\n     */\n    HelperMethods.wordBefore = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordAfter = '\\\\b';\n    /**\n     * @private\n     */\n    HelperMethods.wordSplitCharacters = [' ', ',', '.', ':', ';', '<', '>', '=',\n        '+', '-', '_', '{', '}', '[', ']', '`', '~', '!', '@', '#', '$', '%', '^', '&',\n        '*', '(', ')', '\"', '?', '/', '|', '\\\\', 'â€'];\n    return HelperMethods;\n}());\nexport { HelperMethods };\n/**\n * @private\n */\nvar Point = /** @class */ (function () {\n    function Point(xPosition, yPosition) {\n        this.xIn = 0;\n        this.yIn = 0;\n        this.xIn = xPosition;\n        this.yIn = yPosition;\n    }\n    Object.defineProperty(Point.prototype, \"x\", {\n        /**\n         * Gets or sets x value.\n         * @private\n         */\n        get: function () {\n            return this.xIn;\n        },\n        set: function (value) {\n            this.xIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Point.prototype, \"y\", {\n        /**\n         * Gets or sets y value.\n         * @private\n         */\n        get: function () {\n            return this.yIn;\n        },\n        set: function (value) {\n            this.yIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Point.prototype.copy = function (point) {\n        this.xIn = point.xIn;\n        this.yIn = point.yIn;\n    };\n    /**\n     * Destroys the internal objects maintained.\n     * @returns void\n     */\n    Point.prototype.destroy = function () {\n        this.xIn = undefined;\n        this.yIn = undefined;\n    };\n    return Point;\n}());\nexport { Point };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WParagraphFormat } from './paragraph-format';\nimport { WCharacterFormat } from './character-format';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WStyle = /** @class */ (function () {\n    function WStyle() {\n    }\n    return WStyle;\n}());\nexport { WStyle };\n/**\n * @private\n */\nvar WParagraphStyle = /** @class */ (function (_super) {\n    __extends(WParagraphStyle, _super);\n    function WParagraphStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WParagraphStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n        this.paragraphFormat.destroy();\n    };\n    WParagraphStyle.prototype.copyStyle = function (paraStyle) {\n        this.name = paraStyle.name;\n        this.ownerBase = paraStyle.ownerBase;\n        this.type = paraStyle.type;\n        this.next = paraStyle.next;\n        this.basedOn = paraStyle.basedOn;\n        this.link = paraStyle.link;\n        this.characterFormat.copyFormat(paraStyle.characterFormat);\n        this.paragraphFormat.copyFormat(paraStyle.paragraphFormat);\n    };\n    return WParagraphStyle;\n}(WStyle));\nexport { WParagraphStyle };\n/**\n * @private\n */\nvar WCharacterStyle = /** @class */ (function (_super) {\n    __extends(WCharacterStyle, _super);\n    function WCharacterStyle(node) {\n        var _this = _super.call(this) || this;\n        _this.ownerBase = node;\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    WCharacterStyle.prototype.destroy = function () {\n        this.characterFormat.destroy();\n    };\n    WCharacterStyle.prototype.copyStyle = function (charStyle) {\n        this.name = charStyle.name;\n        this.ownerBase = charStyle.ownerBase;\n        this.type = charStyle.type;\n        this.next = charStyle.next;\n        this.basedOn = charStyle.basedOn;\n        this.characterFormat.copyFormat(charStyle.characterFormat);\n    };\n    return WCharacterStyle;\n}(WStyle));\nexport { WCharacterStyle };\n/**\n * @private\n */\nvar WStyles = /** @class */ (function () {\n    function WStyles() {\n        this.collection = [];\n        /* tslint:enable:no-any */\n    }\n    Object.defineProperty(WStyles.prototype, \"length\", {\n        get: function () {\n            return this.collection.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WStyles.prototype.remove = function (item) {\n        this.collection = this.collection.filter(function (a) { return (a.name !== item.name); });\n    };\n    WStyles.prototype.push = function (item) {\n        if (item != null && item !== undefined) {\n            this.collection.push(item);\n        }\n        return 1;\n    };\n    WStyles.prototype.getItem = function (index) {\n        if (this.collection.length > index) {\n            return this.collection[index];\n        }\n        return null;\n    };\n    WStyles.prototype.indexOf = function (item) {\n        return this.collection.indexOf(item);\n    };\n    WStyles.prototype.contains = function (item) {\n        var index = this.collection.indexOf(item);\n        return index > -1 && index < this.collection.length;\n    };\n    WStyles.prototype.clear = function () {\n        while (this.collection.length > 0) {\n            this.collection.pop();\n        }\n    };\n    WStyles.prototype.findByName = function (name, type) {\n        var returnStyle;\n        for (var _i = 0, _a = this.collection; _i < _a.length; _i++) {\n            var value = _a[_i];\n            if (value.name === name) {\n                returnStyle = value;\n                if (!isNullOrUndefined(type) && value.type === type) {\n                    returnStyle = value;\n                }\n            }\n        }\n        return returnStyle;\n    };\n    WStyles.prototype.getStyleNames = function (type) {\n        return this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a.name; });\n    };\n    /* tslint:disable:no-any */\n    WStyles.prototype.getStyles = function (type) {\n        var styles = this.collection.filter(function (a) { return (a.type === type); }).map(function (a) { return a; });\n        var styleObjects = [];\n        for (var _i = 0, styles_1 = styles; _i < styles_1.length; _i++) {\n            var style = styles_1[_i];\n            var returnStyle = {};\n            var returnStyleObject = {};\n            returnStyleObject.characterFormat = {};\n            HelperMethods.writeCharacterFormat(returnStyleObject.characterFormat, true, style.characterFormat);\n            returnStyle.name = style.name;\n            returnStyle.style = JSON.stringify(returnStyleObject);\n            styleObjects.push(returnStyle);\n        }\n        return styleObjects;\n    };\n    return WStyles;\n}());\nexport { WStyles };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorder = /** @class */ (function () {\n    function WBorder(node) {\n        this.uniqueBorderFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorder.prototype, \"color\", {\n        get: function () {\n            return this.getPropertyValue('color');\n        },\n        set: function (value) {\n            this.setPropertyValue('color', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineStyle\", {\n        get: function () {\n            return this.getPropertyValue('lineStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"lineWidth\", {\n        get: function () {\n            return this.getPropertyValue('lineWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('lineWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"shadow\", {\n        get: function () {\n            return this.getPropertyValue('shadow');\n        },\n        set: function (value) {\n            this.setPropertyValue('shadow', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"space\", {\n        get: function () {\n            return this.getPropertyValue('space');\n        },\n        set: function (value) {\n            this.setPropertyValue('space', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorder.prototype, \"hasNoneStyle\", {\n        get: function () {\n            return this.getPropertyValue('hasNoneStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('hasNoneStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorder.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueBorderFormat) && this.uniqueBorderFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueBorderFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WBorder.getPropertyDefaultValue(property);\n    };\n    WBorder.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WBorder.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueBorderFormat)) {\n            this.initializeUniqueBorder(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            if (this.uniqueBorderFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueBorderFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueBorderFormat = WBorder.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat, property, value);\n        }\n    };\n    WBorder.prototype.initializeUniqueBorder = function (property, propValue) {\n        var uniqueBorderFormatTemp = new Dictionary();\n        this.addUniqueBorderFormat('color', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineStyle', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('lineWidth', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('shadow', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('space', property, propValue, uniqueBorderFormatTemp);\n        this.addUniqueBorderFormat('hasNoneStyle', property, propValue, uniqueBorderFormatTemp);\n        this.uniqueBorderFormat = WBorder.uniqueBorderFormats.addUniqueFormat(uniqueBorderFormatTemp, WBorder.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WBorder.prototype.addUniqueBorderFormat = function (property, modifiedProperty, propValue, uniqueBorderFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WBorder.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueBorderFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueBorderFormatTemp.add(propertyType, WBorder.getPropertyDefaultValue(property));\n        }\n    };\n    WBorder.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'color':\n                value = '#000000';\n                break;\n            case 'lineStyle':\n                value = 'None';\n                break;\n            case 'lineWidth':\n                value = 0;\n                break;\n            case 'shadow':\n                value = false;\n                break;\n            case 'space':\n                value = 0;\n                break;\n            case 'hasNoneStyle':\n                value = false;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getLineWidth = function () {\n        /* tslint:disable */\n        switch (this.lineStyle) {\n            case 'None':\n            case 'Cleared':\n                return 0;\n            case 'Triple':\n            case 'Double':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'Emboss3D':\n            case 'Engrave3D':\n                {\n                    var lineArray = this.getBorderLineWidthArray(this.lineStyle, this.lineWidth);\n                    var width = 0;\n                    for (var i = 0; i < lineArray.length; i++) {\n                        width += lineArray[i];\n                    }\n                    return width;\n                }\n            case 'Single':\n            case 'DashLargeGap':\n            case 'DashSmallGap':\n            case 'Dot':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Thick':\n                return this.lineWidth;\n            case 'SingleWavy':\n                return (this.lineWidth === 1.5 ? 3 : 2.5); //Double wave border only draw with the fixed width\n            case 'DoubleWavy':\n                return (6.75); //Double wave border only draw with the fixed width\n            case 'DashDotStroked':\n            case 'Outset':\n                return this.lineWidth;\n        }\n        return this.lineWidth;\n        /* tslint:enable */\n    };\n    WBorder.prototype.getBorderLineWidthArray = function (lineStyle, lineWidth) {\n        var borderLineArray = [lineWidth];\n        switch (lineStyle) {\n            case 'Double':\n                borderLineArray = [1, 1, 1];\n                break;\n            case 'ThinThickSmallGap':\n                borderLineArray = [1, -0.75, -0.75];\n                break;\n            case 'ThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1];\n                break;\n            case 'ThinThickMediumGap':\n                borderLineArray = [1, 0.5, 0.5];\n                break;\n            case 'ThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1];\n                break;\n            case 'ThinThickLargeGap':\n                borderLineArray = [-1.5, 1, -0.75];\n                break;\n            case 'ThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5];\n                break;\n            case 'Triple':\n                borderLineArray = [1, 1, 1, 1, 1];\n                break;\n            case 'ThinThickThinSmallGap':\n                borderLineArray = [-0.75, -0.75, 1, -0.75, -0.75];\n                break;\n            case 'ThinThickThinMediumGap':\n                borderLineArray = [0.5, 0.5, 1, 0.5, 0.5];\n                break;\n            case 'ThinThickThinLargeGap':\n                borderLineArray = [-0.75, 1, -1.5, 1, -0.75];\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                borderLineArray = [0.25, 0, 1, 0, 0.25];\n                break;\n        }\n        if (borderLineArray.length === 1) {\n            return [lineWidth];\n        }\n        for (var i = 0; i < borderLineArray.length; i++) {\n            if (borderLineArray[i] >= 0) {\n                borderLineArray[i] = borderLineArray[i] * lineWidth;\n            }\n            else {\n                borderLineArray[i] = Math.abs(borderLineArray[i]);\n            }\n        }\n        return borderLineArray;\n    };\n    WBorder.prototype.getBorderWeight = function () {\n        var weight = 0;\n        var numberOfLines = this.getNumberOfLines();\n        var borderNumber = this.getBorderNumber();\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'DashSmallGap':\n            case 'DashDot':\n            case 'DashDotDot':\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n            case 'SingleWavy':\n            case 'DoubleWavy':\n            case 'DashDotStroked':\n            case 'Emboss3D':\n            case 'Engrave3D':\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                weight = numberOfLines * borderNumber;\n                break;\n            case 'Dot':\n            case 'DashLargeGap':\n                weight = 1;\n                break;\n        }\n        return weight;\n    };\n    WBorder.prototype.getBorderNumber = function () {\n        var borderNumber = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                borderNumber = 1;\n                break;\n            case 'Thick':\n                borderNumber = 2;\n                break;\n            case 'Double':\n                borderNumber = 3;\n                break;\n            case 'Dot':\n                borderNumber = 4;\n                break;\n            case 'DashLargeGap': //dashed.\n                borderNumber = 5;\n                break;\n            case 'DashDot':\n                borderNumber = 6;\n                break;\n            case 'DashDotDot':\n                borderNumber = 7;\n                break;\n            case 'Triple':\n                borderNumber = 8;\n                break;\n            case 'ThinThickSmallGap':\n                borderNumber = 9;\n                break;\n            case 'ThickThinSmallGap':\n                borderNumber = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                borderNumber = 11;\n                break;\n            case 'ThinThickMediumGap':\n                borderNumber = 12;\n                break;\n            case 'ThickThinMediumGap':\n                borderNumber = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                borderNumber = 14;\n                break;\n            case 'ThinThickLargeGap':\n                borderNumber = 15;\n                break;\n            case 'ThickThinLargeGap':\n                borderNumber = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                borderNumber = 17;\n                break;\n            case 'SingleWavy': //wave.\n                borderNumber = 18;\n                break;\n            case 'DoubleWavy':\n                borderNumber = 19;\n                break;\n            case 'DashSmallGap':\n                borderNumber = 20;\n                break;\n            case 'DashDotStroked':\n                borderNumber = 21;\n                break;\n            case 'Emboss3D':\n                borderNumber = 22;\n                break;\n            case 'Engrave3D':\n                borderNumber = 23;\n                break;\n            case 'Outset':\n                borderNumber = 24;\n                break;\n            case 'Inset':\n                borderNumber = 25;\n                break;\n        }\n        return borderNumber;\n    };\n    WBorder.prototype.getNumberOfLines = function () {\n        //ToDo: Need to analyze more on this.\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n            case 'Dot':\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                value = 1;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Triple':\n                value = 5;\n                break;\n            case 'ThinThickSmallGap':\n                value = 3;\n                break;\n            case 'ThickThinSmallGap':\n                value = 3;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 5;\n                break;\n            case 'ThinThickMediumGap':\n                value = 3;\n                break;\n            case 'ThickThinMediumGap':\n                value = 3;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 5;\n                break;\n            case 'ThinThickLargeGap':\n                value = 3;\n                break;\n            case 'ThickThinLargeGap':\n                value = 3;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 5;\n                break;\n            case 'SingleWavy':\n                value = 1;\n                break;\n            case 'DoubleWavy':\n                value = 2;\n                break;\n            case 'DashDotStroked':\n                value = 1;\n                break;\n            case 'Emboss3D':\n            case 'Engrave3D':\n                value = 3;\n                break;\n            case 'Outset':\n            case 'Inset':\n            case 'Thick':\n                value = 1;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.getPrecedence = function () {\n        var value = 0;\n        switch (this.lineStyle) {\n            case 'Single':\n                value = 1;\n                break;\n            case 'Thick':\n                value = 2;\n                break;\n            case 'Double':\n                value = 3;\n                break;\n            case 'Dot':\n                value = 4;\n                break;\n            case 'DashLargeGap': //dashed.\n                value = 5;\n                break;\n            case 'DashDot':\n                value = 6;\n                break;\n            case 'DashDotDot':\n                value = 7;\n                break;\n            case 'Triple':\n                value = 8;\n                break;\n            case 'ThinThickSmallGap':\n                value = 9;\n                break;\n            case 'ThickThinSmallGap':\n                value = 10;\n                break;\n            case 'ThinThickThinSmallGap':\n                value = 11;\n                break;\n            case 'ThinThickMediumGap':\n                value = 12;\n                break;\n            case 'ThickThinMediumGap':\n                value = 13;\n                break;\n            case 'ThinThickThinMediumGap':\n                value = 14;\n                break;\n            case 'ThinThickLargeGap':\n                value = 15;\n                break;\n            case 'ThickThinLargeGap':\n                value = 16;\n                break;\n            case 'ThinThickThinLargeGap':\n                value = 17;\n                break;\n            case 'SingleWavy': //wave.\n                value = 18;\n                break;\n            case 'DoubleWavy':\n                value = 19;\n                break;\n            case 'DashSmallGap':\n                value = 20;\n                break;\n            case 'DashDotStroked':\n                value = 21;\n                break;\n            case 'Emboss3D':\n                value = 22;\n                break;\n            case 'Engrave3D':\n                value = 23;\n                break;\n            case 'Outset':\n                value = 24;\n                break;\n            case 'Inset':\n                value = 25;\n                break;\n        }\n        return value;\n    };\n    WBorder.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueBorderFormat.uniqueFormatType, property);\n            return this.uniqueBorderFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WBorder.prototype.cloneFormat = function () {\n        var border = new WBorder(undefined);\n        border.color = this.color;\n        border.lineStyle = this.lineStyle;\n        border.lineWidth = this.lineWidth;\n        border.shadow = this.shadow;\n        border.space = this.space;\n        return border;\n    };\n    WBorder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueBorderFormat)) {\n            WBorder.uniqueBorderFormats.remove(this.uniqueBorderFormat);\n        }\n        this.uniqueBorderFormat = undefined;\n    };\n    WBorder.prototype.copyFormat = function (border) {\n        if (!isNullOrUndefined(border) && !isNullOrUndefined(border.uniqueBorderFormat)) {\n            this.color = border.color;\n            this.lineStyle = border.lineStyle;\n            this.lineWidth = border.lineWidth;\n            this.shadow = border.shadow;\n            this.space = border.space;\n        }\n    };\n    WBorder.clear = function () {\n        this.uniqueBorderFormats.clear();\n    };\n    WBorder.uniqueBorderFormats = new WUniqueFormats();\n    WBorder.uniqueFormatType = 1;\n    return WBorder;\n}());\nexport { WBorder };\n","import { WBorder } from './border';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WBorders = /** @class */ (function () {\n    function WBorders(node) {\n        this.leftIn = new WBorder(this);\n        this.rightIn = new WBorder(this);\n        this.topIn = new WBorder(this);\n        this.bottomIn = new WBorder(this);\n        this.horizontalIn = new WBorder(this);\n        this.verticalIn = new WBorder(this);\n        this.diagonalUpIn = new WBorder(this);\n        this.diagonalDownIn = new WBorder(this);\n        this.lineWidthIn = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WBorders.prototype, \"left\", {\n        get: function () {\n            return this.leftIn;\n        },\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"right\", {\n        get: function () {\n            return this.rightIn;\n        },\n        set: function (value) {\n            this.rightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"top\", {\n        get: function () {\n            return this.topIn;\n        },\n        set: function (value) {\n            this.topIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"bottom\", {\n        get: function () {\n            return this.bottomIn;\n        },\n        set: function (value) {\n            this.bottomIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"horizontal\", {\n        get: function () {\n            return this.horizontalIn;\n        },\n        set: function (value) {\n            this.horizontalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"vertical\", {\n        get: function () {\n            return this.verticalIn;\n        },\n        set: function (value) {\n            this.verticalIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalUp\", {\n        get: function () {\n            return this.diagonalUpIn;\n        },\n        set: function (value) {\n            this.diagonalUpIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WBorders.prototype, \"diagonalDown\", {\n        get: function () {\n            return this.diagonalDownIn;\n        },\n        set: function (value) {\n            this.diagonalDownIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WBorders.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.left)) {\n            this.left.destroy();\n        }\n        if (!isNullOrUndefined(this.top)) {\n            this.top.destroy();\n        }\n        if (!isNullOrUndefined(this.bottom)) {\n            this.bottom.destroy();\n        }\n        if (!isNullOrUndefined(this.right)) {\n            this.right.destroy();\n        }\n        if (!isNullOrUndefined(this.horizontal)) {\n            this.horizontal.destroy();\n        }\n        if (!isNullOrUndefined(this.vertical)) {\n            this.vertical.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalDown)) {\n            this.diagonalDown.destroy();\n        }\n        if (!isNullOrUndefined(this.diagonalUp)) {\n            this.diagonalUp.destroy();\n        }\n        this.topIn = undefined;\n        this.bottomIn = undefined;\n        this.leftIn = undefined;\n        this.rightIn = undefined;\n        this.horizontalIn = undefined;\n        this.verticalIn = undefined;\n        this.diagonalDownIn = undefined;\n        this.diagonalUpIn = undefined;\n        this.lineWidthIn = undefined;\n        this.valueIn = undefined;\n    };\n    WBorders.prototype.cloneFormat = function () {\n        var borders = new WBorders(undefined);\n        borders.top = isNullOrUndefined(this.top) ? undefined : this.top.cloneFormat();\n        borders.bottom = isNullOrUndefined(this.bottom) ? undefined : this.bottom.cloneFormat();\n        borders.left = isNullOrUndefined(this.left) ? undefined : this.left.cloneFormat();\n        borders.right = isNullOrUndefined(this.right) ? undefined : this.right.cloneFormat();\n        borders.horizontal = isNullOrUndefined(this.horizontal) ? undefined : this.horizontal.cloneFormat();\n        borders.vertical = isNullOrUndefined(this.vertical) ? undefined : this.vertical.cloneFormat();\n        borders.diagonalUp = isNullOrUndefined(this.diagonalUp) ? undefined : this.diagonalUp.cloneFormat();\n        borders.diagonalDown = isNullOrUndefined(this.diagonalDown) ? undefined : this.diagonalDown.cloneFormat();\n        return borders;\n    };\n    WBorders.prototype.copyFormat = function (borders) {\n        if (!isNullOrUndefined(borders.left) && borders.left instanceof WBorder) {\n            this.left = new WBorder(this);\n            this.left.copyFormat(borders.left);\n        }\n        if (!isNullOrUndefined(borders.right) && borders.right instanceof WBorder) {\n            this.right = new WBorder(this);\n            this.right.copyFormat(borders.right);\n        }\n        if (!isNullOrUndefined(borders.top) && borders.top instanceof WBorder) {\n            this.top = new WBorder(this);\n            this.top.copyFormat(borders.top);\n        }\n        if (!isNullOrUndefined(borders.bottom) && borders.bottom instanceof WBorder) {\n            this.bottom = new WBorder(this);\n            this.bottom.copyFormat(borders.bottom);\n        }\n        if (!isNullOrUndefined(borders.horizontal) && borders.horizontal instanceof WBorder) {\n            this.horizontal = new WBorder(this);\n            this.horizontal.copyFormat(borders.horizontal);\n        }\n        if (!isNullOrUndefined(borders.vertical) && borders.vertical instanceof WBorder) {\n            this.vertical = new WBorder(this);\n            this.vertical.copyFormat(borders.vertical);\n        }\n        if (!isNullOrUndefined(borders.diagonalDown) && borders.diagonalDown instanceof WBorder) {\n            this.diagonalDown = new WBorder(this);\n            this.diagonalDown.copyFormat(borders.diagonalDown);\n        }\n        if (!isNullOrUndefined(borders.diagonalUp) && borders.diagonalUp instanceof WBorder) {\n            this.diagonalUp = new WBorder(this);\n            this.diagonalUp.copyFormat(borders.diagonalUp);\n        }\n    };\n    return WBorders;\n}());\nexport { WBorders };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { Dictionary } from '../../base/dictionary';\n/**\n * @private\n */\nvar WShading = /** @class */ (function () {\n    function WShading(node) {\n        this.uniqueShadingFormat = undefined;\n        this.ownerBase = undefined;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WShading.prototype, \"backgroundColor\", {\n        get: function () {\n            return this.getPropertyValue('backgroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('backgroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"foregroundColor\", {\n        get: function () {\n            return this.getPropertyValue('foregroundColor');\n        },\n        set: function (value) {\n            this.setPropertyValue('foregroundColor', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WShading.prototype, \"textureStyle\", {\n        get: function () {\n            return this.getPropertyValue('textureStyle');\n        },\n        set: function (value) {\n            this.setPropertyValue('textureStyle', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WShading.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueShadingFormat) && this.uniqueShadingFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueShadingFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WShading.getPropertyDefaultValue(property);\n    };\n    WShading.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WShading.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueShadingFormat)) {\n            this.initializeUniqueShading(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            if (this.uniqueShadingFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueShadingFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueShadingFormat = WShading.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat, property, value);\n        }\n    };\n    WShading.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'backgroundColor':\n                value = '#ffffff';\n                break;\n            case 'foregroundColor':\n                value = 'empty';\n                break;\n            case 'textureStyle':\n                value = 'TextureNone';\n                break;\n        }\n        return value;\n    };\n    WShading.prototype.initializeUniqueShading = function (property, propValue) {\n        var uniqueShadingTemp = new Dictionary();\n        this.addUniqueShading('backgroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('foregroundColor', property, propValue, uniqueShadingTemp);\n        this.addUniqueShading('textureStyle', property, propValue, uniqueShadingTemp);\n        // tslint:disable-next-line:max-line-length        \n        this.uniqueShadingFormat = WShading.uniqueShadingFormats.addUniqueFormat(uniqueShadingTemp, WShading.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WShading.prototype.addUniqueShading = function (property, modifiedProperty, propValue, uniqueShadingTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WShading.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueShadingTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueShadingTemp.add(propertyType, WShading.getPropertyDefaultValue(property));\n        }\n    };\n    WShading.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            WShading.uniqueShadingFormats.remove(this.uniqueShadingFormat);\n        }\n        this.uniqueShadingFormat = undefined;\n    };\n    WShading.prototype.cloneFormat = function () {\n        var shading = new WShading(undefined);\n        shading.backgroundColor = this.backgroundColor;\n        shading.foregroundColor = this.foregroundColor;\n        shading.textureStyle = this.textureStyle;\n        return shading;\n    };\n    WShading.prototype.copyFormat = function (shading) {\n        if (!isNullOrUndefined(shading) && !isNullOrUndefined(shading.uniqueShadingFormat)) {\n            this.backgroundColor = shading.backgroundColor;\n            this.foregroundColor = shading.foregroundColor;\n            this.textureStyle = shading.textureStyle;\n        }\n    };\n    WShading.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueShadingFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueShadingFormat.uniqueFormatType, property);\n            return this.uniqueShadingFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WShading.clear = function () {\n        this.uniqueShadingFormats.clear();\n    };\n    WShading.uniqueShadingFormats = new WUniqueFormats();\n    WShading.uniqueFormatType = 5;\n    return WShading;\n}());\nexport { WShading };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WTableFormat = /** @class */ (function () {\n    function WTableFormat(owner) {\n        this.uniqueTableFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = undefined;\n        this.ownerBase = owner;\n        this.assignTableMarginValue(5.4, 0, 5.4, 0);\n    }\n    Object.defineProperty(WTableFormat.prototype, \"cellSpacing\", {\n        get: function () {\n            return this.getPropertyValue('cellSpacing');\n        },\n        set: function (value) {\n            if (value < 0 || value > 264.6) {\n                throw new RangeError('The measurement must be between 0 px and 264.6 px.');\n            }\n            this.setPropertyValue('cellSpacing', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"leftIndent\", {\n        get: function () {\n            return this.getPropertyValue('leftIndent');\n        },\n        set: function (value) {\n            if (value < -1440 || value > 1440) {\n                throw new RangeError('The measurement must be between -1440 px and 1440 px.');\n            }\n            this.setPropertyValue('leftIndent', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"tableAlignment\", {\n        get: function () {\n            return this.getPropertyValue('tableAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('tableAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WTableFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WTableFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueTableFormat) && this.uniqueTableFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueTableFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WTableFormat.getPropertyDefaultValue(property);\n    };\n    WTableFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WTableFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueTableFormat)) {\n            this.initializeUniqueTableFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            if (this.uniqueTableFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueTableFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueTableFormat = WTableFormat.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat, property, value);\n        }\n    };\n    WTableFormat.prototype.initializeUniqueTableFormat = function (property, propValue) {\n        var uniqueTableFormatTemp = new Dictionary();\n        this.addUniqueTableFormat('cellSpacing', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('topMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('bottomMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('rightMargin', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('leftIndent', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('tableAlignment', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidth', property, propValue, uniqueTableFormatTemp);\n        this.addUniqueTableFormat('preferredWidthType', property, propValue, uniqueTableFormatTemp);\n        this.uniqueTableFormat = WTableFormat.uniqueTableFormats.addUniqueFormat(uniqueTableFormatTemp, WTableFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WTableFormat.prototype.addUniqueTableFormat = function (property, modifiedProperty, propValue, uniqueTableFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WTableFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueTableFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WTableFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'cellSpacing':\n                value = 0;\n                break;\n            case 'leftMargin':\n                value = 5.4;\n                break;\n            case 'topMargin':\n                value = 0;\n                break;\n            case 'bottomMargin':\n                value = 0;\n                break;\n            case 'rightMargin':\n                value = 5.4;\n                break;\n            case 'leftIndent':\n                value = 0;\n                break;\n            case 'tableAlignment':\n                value = 'Left';\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WTableFormat.prototype.assignTableMarginValue = function (left, top, right, bottom) {\n        this.leftMargin = left;\n        this.topMargin = top;\n        this.rightMargin = right;\n        this.bottomMargin = bottom;\n    };\n    WTableFormat.prototype.initializeTableBorders = function () {\n        this.borders.left.lineStyle = 'Single';\n        this.borders.left.lineWidth = 0.5;\n        this.borders.right.lineStyle = 'Single';\n        this.borders.right.lineWidth = 0.5;\n        this.borders.top.lineStyle = 'Single';\n        this.borders.top.lineWidth = 0.5;\n        this.borders.bottom.lineStyle = 'Single';\n        this.borders.bottom.lineWidth = 0.5;\n        this.borders.horizontal.lineStyle = 'Single';\n        this.borders.horizontal.lineWidth = 0.5;\n        this.borders.vertical.lineStyle = 'Single';\n        this.borders.vertical.lineWidth = 0.5;\n    };\n    WTableFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            WTableFormat.uniqueTableFormats.remove(this.uniqueTableFormat);\n        }\n        this.uniqueTableFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WTableFormat.prototype.cloneFormat = function () {\n        var tableFormat = new WTableFormat(undefined);\n        tableFormat.leftIndent = this.leftIndent;\n        tableFormat.tableAlignment = this.tableAlignment;\n        tableFormat.cellSpacing = this.cellSpacing;\n        tableFormat.leftMargin = this.leftMargin;\n        tableFormat.rightMargin = this.rightMargin;\n        tableFormat.topMargin = this.topMargin;\n        tableFormat.bottomMargin = this.bottomMargin;\n        tableFormat.preferredWidth = this.preferredWidth;\n        tableFormat.preferredWidthType = this.preferredWidthType;\n        tableFormat.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        tableFormat.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return tableFormat;\n    };\n    WTableFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueTableFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueTableFormat.uniqueFormatType, property);\n            return this.uniqueTableFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WTableFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueTableFormat)) {\n                this.cellSpacing = format.cellSpacing;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.leftIndent = format.leftIndent;\n                this.tableAlignment = format.tableAlignment;\n                this.preferredWidth = format.preferredWidth;\n                this.preferredWidthType = format.preferredWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n        }\n    };\n    WTableFormat.clear = function () {\n        this.uniqueTableFormats.clear();\n    };\n    WTableFormat.uniqueTableFormats = new WUniqueFormats();\n    WTableFormat.uniqueFormatType = 8;\n    return WTableFormat;\n}());\nexport { WTableFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\n/**\n * @private\n */\nvar WRowFormat = /** @class */ (function () {\n    function WRowFormat(node) {\n        this.uniqueRowFormat = undefined;\n        /**\n         * @private\n         */\n        this.borders = new WBorders(this);\n        /**\n         * @private\n         */\n        this.ownerBase = undefined;\n        /**\n         * @private\n         */\n        this.beforeWidth = 0;\n        /**\n         * @private\n         */\n        this.afterWidth = 0;\n        this.ownerBase = node;\n    }\n    Object.defineProperty(WRowFormat.prototype, \"gridBefore\", {\n        get: function () {\n            return this.getPropertyValue('gridBefore');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBefore', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridBeforeWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridBeforeWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridBeforeWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfter\", {\n        get: function () {\n            return this.getPropertyValue('gridAfter');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfter', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidth\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"gridAfterWidthType\", {\n        get: function () {\n            return this.getPropertyValue('gridAfterWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('gridAfterWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"allowBreakAcrossPages\", {\n        get: function () {\n            return this.getPropertyValue('allowBreakAcrossPages');\n        },\n        set: function (value) {\n            this.setPropertyValue('allowBreakAcrossPages', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"isHeader\", {\n        get: function () {\n            return this.getPropertyValue('isHeader');\n        },\n        set: function (value) {\n            this.setPropertyValue('isHeader', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"height\", {\n        get: function () {\n            return this.getPropertyValue('height');\n        },\n        set: function (value) {\n            if (value === 0 && (this.heightType === 'AtLeast' || this.heightType === 'Exactly')) {\n                value = 1;\n            }\n            else if (this.heightType === 'Auto') {\n                value = 0;\n            }\n            this.setPropertyValue('height', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WRowFormat.prototype, \"heightType\", {\n        get: function () {\n            return this.getPropertyValue('heightType');\n        },\n        set: function (value) {\n            if (value === 'AtLeast' || value === 'Exactly') {\n                this.height = 1;\n            }\n            else {\n                this.height = 0;\n            }\n            this.setPropertyValue('heightType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WRowFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueRowFormat) && this.uniqueRowFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueRowFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WRowFormat.getPropertyDefaultValue(property);\n    };\n    WRowFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WRowFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueRowFormat)) {\n            this.initializeUniqueRowFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            if (this.uniqueRowFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueRowFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueRowFormat = WRowFormat.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat, property, value);\n        }\n    };\n    WRowFormat.prototype.initializeUniqueRowFormat = function (property, propValue) {\n        var uniqueRowFormatTemp = new Dictionary();\n        this.addUniqueRowFormat('allowBreakAcrossPages', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('isHeader', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('height', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('heightType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBefore', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfter', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridgridAfterWidth', property, propValue, uniqueRowFormatTemp);\n        this.addUniqueRowFormat('gridBeforeWidthType', property, propValue, uniqueRowFormatTemp);\n        this.uniqueRowFormat = WRowFormat.uniqueRowFormats.addUniqueFormat(uniqueRowFormatTemp, WRowFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WRowFormat.prototype.addUniqueRowFormat = function (property, modifiedProperty, propValue, uniqueRowFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WRowFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueRowFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WRowFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'allowBreakAcrossPages':\n                value = true;\n                break;\n            case 'isHeader':\n                value = false;\n                break;\n            case 'height':\n                value = 0;\n                break;\n            case 'heightType':\n                value = 'Auto';\n                break;\n            case 'gridBefore':\n                value = 0;\n                break;\n            case 'gridBeforeWidth':\n                value = 0;\n                break;\n            case 'gridBeforeWidthType':\n                value = 'Point';\n                break;\n            case 'gridAfter':\n                value = 0;\n                break;\n            case 'gridAfterWidth':\n                value = 0;\n                break;\n            case 'gridAfterWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WRowFormat.prototype.cloneFormat = function () {\n        var format = new WRowFormat();\n        format.allowBreakAcrossPages = this.allowBreakAcrossPages;\n        format.heightType = this.heightType;\n        format.height = this.height;\n        format.isHeader = this.isHeader;\n        format.gridBefore = this.gridBefore;\n        format.gridBeforeWidth = this.gridBeforeWidth;\n        format.gridBeforeWidthType = this.gridBeforeWidthType;\n        format.gridAfter = this.gridAfter;\n        format.gridAfterWidth = this.gridAfterWidth;\n        format.gridAfterWidthType = this.gridAfterWidthType;\n        return format;\n    };\n    WRowFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueRowFormat.uniqueFormatType, property);\n            return this.uniqueRowFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WRowFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueRowFormat)) {\n                this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n                this.isHeader = format.isHeader;\n                this.heightType = format.heightType;\n                this.height = format.height;\n                this.gridBefore = format.gridBefore;\n                this.gridBeforeWidth = format.gridBeforeWidth;\n                this.gridBeforeWidthType = format.gridBeforeWidthType;\n                this.gridAfter = format.gridAfter;\n                this.gridAfterWidth = format.gridAfterWidth;\n                this.gridAfterWidthType = format.gridAfterWidthType;\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.ownerBase = format;\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WRowFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueRowFormat)) {\n            WRowFormat.uniqueRowFormats.remove(this.uniqueRowFormat);\n        }\n        this.beforeWidth = undefined;\n        this.afterWidth = undefined;\n        this.borders = undefined;\n        this.uniqueRowFormat = undefined;\n    };\n    WRowFormat.clear = function () {\n        this.uniqueRowFormats.clear();\n    };\n    WRowFormat.uniqueRowFormats = new WUniqueFormats();\n    WRowFormat.uniqueFormatType = 6;\n    return WRowFormat;\n}());\nexport { WRowFormat };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WBorders } from './borders';\nimport { WShading } from './shading';\n/**\n * @private\n */\nvar WCellFormat = /** @class */ (function () {\n    function WCellFormat(node) {\n        this.uniqueCellFormat = undefined;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n        this.ownerBase = node;\n        this.borders = new WBorders(this);\n        this.shading = new WShading(this);\n    }\n    Object.defineProperty(WCellFormat.prototype, \"leftMargin\", {\n        get: function () {\n            return this.getPropertyValue('leftMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('leftMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rightMargin\", {\n        get: function () {\n            return this.getPropertyValue('rightMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('rightMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"topMargin\", {\n        get: function () {\n            return this.getPropertyValue('topMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('topMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"bottomMargin\", {\n        get: function () {\n            return this.getPropertyValue('bottomMargin');\n        },\n        set: function (value) {\n            this.setPropertyValue('bottomMargin', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"cellWidth\", {\n        get: function () {\n            return this.getPropertyValue('cellWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('cellWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"columnSpan\", {\n        get: function () {\n            return this.getPropertyValue('columnSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('columnSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"rowSpan\", {\n        get: function () {\n            return this.getPropertyValue('rowSpan');\n        },\n        set: function (value) {\n            this.setPropertyValue('rowSpan', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidth\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidth');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidth', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"verticalAlignment\", {\n        get: function () {\n            return this.getPropertyValue('verticalAlignment');\n        },\n        set: function (value) {\n            this.setPropertyValue('verticalAlignment', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WCellFormat.prototype, \"preferredWidthType\", {\n        get: function () {\n            return this.getPropertyValue('preferredWidthType');\n        },\n        set: function (value) {\n            this.setPropertyValue('preferredWidthType', value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WCellFormat.prototype.getPropertyValue = function (property) {\n        var hasValue = this.hasValue(property);\n        if (hasValue) {\n            var propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n            if (!isNullOrUndefined(this.uniqueCellFormat) && this.uniqueCellFormat.propertiesHash.containsKey(propertyType)) {\n                return this.uniqueCellFormat.propertiesHash.get(propertyType);\n            }\n        }\n        return WCellFormat.getPropertyDefaultValue(property);\n    };\n    WCellFormat.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WCellFormat.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueCellFormat)) {\n            this.initializeUniqueCellFormat(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            if (this.uniqueCellFormat.propertiesHash.containsKey(propertyType) &&\n                this.uniqueCellFormat.propertiesHash.get(propertyType) === value) {\n                //Do nothing, since no change in property value and return\n                return;\n            }\n            this.uniqueCellFormat = WCellFormat.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat, property, value);\n        }\n    };\n    WCellFormat.prototype.initializeUniqueCellFormat = function (property, propValue) {\n        var uniqueCellFormatTemp = new Dictionary();\n        this.addUniqueCellFormat('leftMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('topMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('bottomMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rightMargin', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('cellWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('columnSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('rowSpan', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidth', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('verticalAlignment', property, propValue, uniqueCellFormatTemp);\n        this.addUniqueCellFormat('preferredWidthType', property, propValue, uniqueCellFormatTemp);\n        this.uniqueCellFormat = WCellFormat.uniqueCellFormats.addUniqueFormat(uniqueCellFormatTemp, WCellFormat.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WCellFormat.prototype.addUniqueCellFormat = function (property, modifiedProperty, propValue, uniqueCellFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WCellFormat.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCellFormatTemp.add(propertyType, propValue);\n        }\n    };\n    WCellFormat.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'leftMargin':\n                value = undefined;\n                break;\n            case 'topMargin':\n                value = undefined;\n                break;\n            case 'bottomMargin':\n                value = undefined;\n                break;\n            case 'rightMargin':\n                value = undefined;\n                break;\n            case 'cellWidth':\n                value = 0;\n                break;\n            case 'columnSpan':\n                value = 1;\n                break;\n            case 'rowSpan':\n                value = 1;\n                break;\n            case 'preferredWidth':\n                value = 0;\n                break;\n            case 'verticalAlignment':\n                value = 'Top';\n                break;\n            case 'preferredWidthType':\n                value = 'Point';\n                break;\n        }\n        return value;\n    };\n    WCellFormat.prototype.containsMargins = function () {\n        return (!isNullOrUndefined(this.leftMargin)\n            || !isNullOrUndefined(this.rightMargin)\n            || !isNullOrUndefined(this.bottomMargin)\n            || !isNullOrUndefined(this.topMargin));\n    };\n    WCellFormat.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.borders)) {\n            this.borders.destroy();\n        }\n        if (!isNullOrUndefined(this.shading)) {\n            this.shading.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            WCellFormat.uniqueCellFormats.remove(this.uniqueCellFormat);\n        }\n        this.uniqueCellFormat = undefined;\n        this.borders = undefined;\n        this.shading = undefined;\n    };\n    WCellFormat.prototype.cloneFormat = function () {\n        var format = new WCellFormat(undefined);\n        format.verticalAlignment = this.verticalAlignment;\n        format.leftMargin = this.leftMargin;\n        format.rightMargin = this.rightMargin;\n        format.topMargin = this.topMargin;\n        format.bottomMargin = this.bottomMargin;\n        format.preferredWidth = this.preferredWidth;\n        format.preferredWidthType = this.preferredWidthType;\n        format.cellWidth = this.cellWidth;\n        format.borders = isNullOrUndefined(this.borders) ? undefined : this.borders.cloneFormat();\n        format.shading = isNullOrUndefined(this.shading) ? undefined : this.shading.cloneFormat();\n        return format;\n    };\n    WCellFormat.prototype.hasValue = function (property) {\n        if (!isNullOrUndefined(this.uniqueCellFormat)) {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueCellFormat.uniqueFormatType, property);\n            return this.uniqueCellFormat.propertiesHash.containsKey(propertyType);\n        }\n        return false;\n    };\n    WCellFormat.prototype.copyFormat = function (format) {\n        if (!isNullOrUndefined(format)) {\n            if (!isNullOrUndefined(format.uniqueCellFormat)) {\n                this.cellWidth = format.cellWidth;\n                this.leftMargin = format.leftMargin;\n                this.topMargin = format.topMargin;\n                this.rightMargin = format.rightMargin;\n                this.bottomMargin = format.bottomMargin;\n                this.preferredWidth = format.preferredWidth;\n                this.columnSpan = format.columnSpan;\n                this.rowSpan = format.rowSpan;\n                this.preferredWidthType = format.preferredWidthType;\n                this.verticalAlignment = format.verticalAlignment;\n            }\n            if (!isNullOrUndefined(format.shading)) {\n                this.shading = new WShading(this);\n                this.shading.copyFormat(format.shading);\n            }\n            if (!isNullOrUndefined(format.borders)) {\n                this.borders = new WBorders(this);\n                this.borders.copyFormat(format.borders);\n            }\n        }\n    };\n    WCellFormat.clear = function () {\n        this.uniqueCellFormats.clear();\n    };\n    WCellFormat.uniqueCellFormats = new WUniqueFormats();\n    WCellFormat.uniqueFormatType = 4;\n    return WCellFormat;\n}());\nexport { WCellFormat };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { WParagraphFormat, WCharacterFormat, WBorder, WBorders } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Rect = /** @class */ (function () {\n    function Rect(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n    Object.defineProperty(Rect.prototype, \"right\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.x + this.width;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Rect.prototype, \"bottom\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.y + this.height;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Rect;\n}());\nexport { Rect };\n/**\n * @private\n */\nvar Margin = /** @class */ (function () {\n    function Margin(leftMargin, topMargin, rightMargin, bottomMargin) {\n        this.left = leftMargin;\n        this.top = topMargin;\n        this.right = rightMargin;\n        this.bottom = bottomMargin;\n    }\n    /**\n     * @private\n     */\n    Margin.prototype.clone = function () {\n        return new Margin(this.left, this.top, this.right, this.bottom);\n    };\n    /**\n     * @private\n     */\n    Margin.prototype.destroy = function () {\n        this.left = undefined;\n        this.right = undefined;\n        this.top = undefined;\n        this.bottom = undefined;\n    };\n    return Margin;\n}());\nexport { Margin };\n/**\n * @private\n */\nvar Widget = /** @class */ (function () {\n    function Widget() {\n        /**\n         * @private\n         */\n        this.childWidgets = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.index = 0;\n    }\n    Object.defineProperty(Widget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof BodyWidget && this.page) {\n                return this.page.bodyWidgets.indexOf(this);\n            }\n            else if (this.containerWidget && this.containerWidget.childWidgets) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"firstChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.childWidgets.length > 0 ? this.childWidgets[0] : undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"lastChild\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets) {\n                return this.childWidgets.length > 0 ?\n                    this.childWidgets[this.childWidgets.length - 1] : undefined;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (widget instanceof BodyWidget) {\n                widget = index > 0 ? widget.page.bodyWidgets[index - 1] : undefined;\n            }\n            else {\n                widget = index > 0 ? widget.containerWidget.childWidgets[index - 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index === -1) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                widget = index < widget.page.bodyWidgets.length - 1 ?\n                    widget.page.bodyWidgets[index + 1] : undefined;\n            }\n            else {\n                widget = index < widget.containerWidget.childWidgets.length - 1 ?\n                    widget.containerWidget.childWidgets[index + 1] : undefined;\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index > 0) {\n                    widget = widget.page.bodyWidgets[index - 1];\n                }\n                else {\n                    var page = widget.page.previousPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[page.bodyWidgets.length - 1] : undefined;\n                }\n            }\n            else {\n                if (index > 0) {\n                    widget = widget.containerWidget.childWidgets[index - 1];\n                }\n                else {\n                    var previousContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        previousContainer = widget.containerWidget.getPreviousSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to previous row.\n                        previousContainer = widget.containerWidget.previousRenderedWidget;\n                    }\n                    while (previousContainer && previousContainer.childWidgets.length === 0) {\n                        previousContainer = previousContainer.previousRenderedWidget;\n                        if (isNullOrUndefined(previousContainer)) {\n                            break;\n                        }\n                    }\n                    widget = previousContainer && previousContainer.constructor === widget.containerWidget.constructor ?\n                        previousContainer.lastChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextRenderedWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            var index = this.indexInOwner;\n            if (index < 0) {\n                return undefined;\n            }\n            if (widget instanceof BodyWidget) {\n                if (index < widget.page.bodyWidgets.length - 1) {\n                    widget = widget.page.bodyWidgets[index + 1];\n                }\n                else {\n                    var page = widget.page.nextPage;\n                    widget = page && page.bodyWidgets.length > 0 ? page.bodyWidgets[0] : undefined;\n                }\n            }\n            else {\n                if (index < widget.containerWidget.childWidgets.length - 1) {\n                    widget = widget.containerWidget.childWidgets[index + 1];\n                }\n                else {\n                    var nextContainer = undefined;\n                    if (widget.containerWidget instanceof TableCellWidget) {\n                        nextContainer = widget.containerWidget.getNextSplitWidget();\n                    }\n                    else if (!(widget.containerWidget instanceof TableRowWidget\n                        || widget.containerWidget instanceof HeaderFooterWidget)) {\n                        // Since cells are lay outed left to right, we should not navigate to next row.\n                        nextContainer = widget.containerWidget.nextRenderedWidget;\n                    }\n                    while (nextContainer && nextContainer.childWidgets.length === 0 && !(nextContainer instanceof TableCellWidget)) {\n                        nextContainer = nextContainer.nextRenderedWidget;\n                        if (isNullOrUndefined(nextContainer)) {\n                            break;\n                        }\n                    }\n                    widget = nextContainer && nextContainer.constructor === widget.containerWidget.constructor ?\n                        nextContainer.firstChild : undefined;\n                }\n            }\n            return widget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"previousSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getPreviousSplitWidget();\n            }\n            else {\n                var previous = widget.previousRenderedWidget;\n                if (widget instanceof BodyWidget && previous instanceof BodyWidget && widget.equals(previous)) {\n                    return previous;\n                }\n                else if (previous instanceof BlockWidget && widget.index === previous.index && widget.equals(previous)) {\n                    return previous;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Widget.prototype, \"nextSplitWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            if (widget instanceof TableCellWidget) {\n                return widget.getNextSplitWidget();\n            }\n            else {\n                var next = widget.nextRenderedWidget;\n                if (widget instanceof BodyWidget && next instanceof BodyWidget && widget.equals(next)) {\n                    return next;\n                }\n                else if (next instanceof BlockWidget && widget.index === next.index && widget.equals(next)) {\n                    return next;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    Widget.prototype.getPreviousSplitWidgets = function () {\n        var widgets = [];\n        var widget = this.previousSplitWidget;\n        while (widget) {\n            widgets.unshift(widget);\n            widget = widget.previousSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.getSplitWidgets = function () {\n        var widgets = this.getPreviousSplitWidgets();\n        var widget = this;\n        while (widget) {\n            widgets.push(widget);\n            widget = widget.nextSplitWidget;\n        }\n        return widgets;\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.combineWidget = function (viewer) {\n        var root = this;\n        var widgets = this.getSplitWidgets();\n        if (widgets.length > 1) {\n            root = widgets.shift();\n            while (widgets.length > 0) {\n                var splitWidget = widgets.shift();\n                root.combine(splitWidget, viewer);\n            }\n        }\n        if (root instanceof TableWidget) {\n            root.combineRows(viewer);\n        }\n        return root;\n    };\n    Widget.prototype.combine = function (widget, viewer) {\n        if (widget.childWidgets.length > 0) {\n            var lastChild = this.lastChild;\n            if (lastChild instanceof TableWidget) {\n                lastChild.combineWidget(viewer);\n            }\n            else {\n                var firstChild = widget.firstChild;\n                if (!(widget instanceof TableWidget) && lastChild instanceof Widget && firstChild instanceof Widget &&\n                    lastChild.index === firstChild.index) {\n                    lastChild.combine(widget.childWidgets.shift(), viewer);\n                }\n            }\n            this.addWidgets(widget.childWidgets);\n            widget.childWidgets = [];\n        }\n        widget.destroyInternal(viewer);\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.addWidgets = function (childWidgets) {\n        while (childWidgets.length > 0) {\n            var widget = childWidgets.shift();\n            if (widget instanceof LineWidget && this instanceof ParagraphWidget) {\n                widget.paragraph = this;\n                this.height += widget.height;\n            }\n            else if (widget instanceof Widget) {\n                var lastChild = this.lastChild;\n                widget.containerWidget = this;\n                widget.y = lastChild instanceof Widget ? lastChild.y + lastChild.height : this.y;\n                this.height += widget.height;\n            }\n            this.childWidgets.push(widget);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.removeChild = function (index) {\n        if (index > -1 && index < this.childWidgets.length) {\n            this.childWidgets.splice(index, 1);\n        }\n    };\n    /**\n     * @private\n     */\n    Widget.prototype.destroy = function () {\n        if (this.childWidgets) {\n            while (this.childWidgets.length > 0) {\n                var child = this.childWidgets.pop();\n                if (child instanceof LineWidget || child instanceof Widget) {\n                    child.destroy();\n                }\n            }\n        }\n        this.childWidgets = undefined;\n        if (this.containerWidget) {\n            this.containerWidget.removeChild(this.indexInOwner);\n        }\n        this.containerWidget = undefined;\n        // if (this.margin) {\n        //     this.margin.destroy();\n        // }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n        this.index = undefined;\n    };\n    return Widget;\n}());\nexport { Widget };\n/**\n * @private\n */\nvar BlockContainer = /** @class */ (function (_super) {\n    __extends(BlockContainer, _super);\n    function BlockContainer() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        /**\n         * @private\n         */\n        _this.sectionFormatIn = undefined;\n        return _this;\n    }\n    Object.defineProperty(BlockContainer.prototype, \"sectionFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            if (container instanceof BodyWidget) {\n                return container.sectionFormatIn;\n            }\n            else if (container.page) {\n                return container.page.bodyWidgets[0].sectionFormat;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (this instanceof BodyWidget) {\n                this.sectionFormatIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockContainer.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var container = this;\n            var index = 0;\n            if (container instanceof BodyWidget) {\n                index = container.index;\n            }\n            else if (container.page) {\n                index = container.page.bodyWidgets[0].index;\n            }\n            return index;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BlockContainer.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        if (node instanceof BodyWidget) {\n            hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        }\n        else {\n            if (node.headerFooterType.indexOf('Header') !== -1) {\n                hierarchicalIndex = 'H' + ';' + hierarchicalIndex;\n            }\n            else {\n                hierarchicalIndex = 'F' + ';' + hierarchicalIndex;\n            }\n        }\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    return BlockContainer;\n}(Widget));\nexport { BlockContainer };\n/**\n * @private\n */\nvar BodyWidget = /** @class */ (function (_super) {\n    __extends(BodyWidget, _super);\n    /**\n     * Initialize the constructor of BodyWidget\n     */\n    function BodyWidget() {\n        return _super.call(this) || this;\n    }\n    /**\n     * @private\n     */\n    BodyWidget.prototype.equals = function (widget) {\n        return widget instanceof BodyWidget && widget.sectionFormat === this.sectionFormat;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var viewer = undefined;\n        var node = this;\n        hierarchicalIndex = node.index + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.page)) {\n            viewer = this.page.viewer;\n            var pageIndex = viewer.pages.indexOf(this.page);\n            return pageIndex + ';' + hierarchicalIndex;\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.getTableCellWidget = function (touchPoint) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= touchPoint.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= touchPoint.y) {\n                return this.childWidgets[i].getTableCellWidget(touchPoint);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= touchPoint.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(touchPoint);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(touchPoint);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var n = 0; n < this.childWidgets.length; n++) {\n                var chilgWidget = this.childWidgets[n];\n                if (chilgWidget instanceof ParagraphWidget) {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                else {\n                    chilgWidget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                n--;\n            }\n            this.childWidgets = undefined;\n        }\n        // if (this instanceof HeaderFooterWidget && ((this as HeaderFooterWidget).currentNode ))) {\n        //     if (((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets )) {\n        //         let index: number = ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.indexOf(this);\n        //         ((this as HeaderFooterWidget).currentNode as WHeaderFooter).layoutedWidgets.splice(index, 1);\n        //     }\n        //     this.currentNode = undefined;\n        /* tslint:disable: one-line */\n        if (!isNullOrUndefined(this.page)) {\n            var index = this.indexInOwner;\n            if (this.indexInOwner > -1) {\n                this.page.bodyWidgets.splice(index, 1);\n                if (this.page.bodyWidgets.length === 0) {\n                    this.page.destroy();\n                    // }\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.headerWidget === this) {\n                    this.page.headerWidget = undefined;\n                }\n                else if ((this instanceof HeaderFooterWidget)\n                    && this.page.footerWidget === this) {\n                    this.page.footerWidget = undefined;\n                }\n                this.page = undefined;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    BodyWidget.prototype.destroy = function () {\n        // if (this.sectionFormat) {\n        //     this.sectionFormat.destroy();\n        // }\n        this.sectionFormat = undefined;\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return BodyWidget;\n}(BlockContainer));\nexport { BodyWidget };\n/**\n * @private\n */\nvar HeaderFooterWidget = /** @class */ (function (_super) {\n    __extends(HeaderFooterWidget, _super);\n    function HeaderFooterWidget(type) {\n        var _this = _super.call(this) || this;\n        _this.headerFooterType = type;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.equals = function (widget) {\n        // Todo: Need to work\n        return widget instanceof HeaderFooterWidget\n            && widget.containerWidget === this.containerWidget;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.clone = function () {\n        var headerFooter = new HeaderFooterWidget(this.headerFooterType);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            headerFooter.childWidgets.push(block);\n            block.index = i;\n            block.containerWidget = headerFooter;\n        }\n        headerFooter.x = this.x;\n        headerFooter.y = this.y;\n        headerFooter.height = 0;\n        headerFooter.width = 0;\n        return headerFooter;\n    };\n    /**\n     * @private\n     */\n    HeaderFooterWidget.prototype.destroyInternal = function (viewer) {\n        this.page = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return HeaderFooterWidget;\n}(BlockContainer));\nexport { HeaderFooterWidget };\n/**\n * @private\n */\nvar BlockWidget = /** @class */ (function (_super) {\n    __extends(BlockWidget, _super);\n    function BlockWidget() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(BlockWidget.prototype, \"bodyWidget\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var widget = this;\n            while (widget.containerWidget) {\n                if (widget.containerWidget instanceof BlockContainer) {\n                    return widget.containerWidget;\n                }\n                widget = widget.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"leftIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.leftIndent;\n            }\n            else if (blockAdv instanceof TableWidget && blockAdv.tableFormat instanceof WTableFormat) {\n                return blockAdv.tableFormat.leftIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"rightIndent\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var blockAdv = this;\n            if (blockAdv instanceof ParagraphWidget && blockAdv.paragraphFormat instanceof WParagraphFormat) {\n                return blockAdv.paragraphFormat.rightIndent;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInsideTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget instanceof TableCellWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"isInHeaderFooter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bodyWidget instanceof HeaderFooterWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BlockWidget.prototype, \"associatedCell\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableCellWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Check whether the paragraph contains only page break.\n     * @private\n     */\n    BlockWidget.prototype.isPageBreak = function () {\n        var isPageBreak = false;\n        if (this instanceof ParagraphWidget) {\n            var paragraph = this;\n            if (paragraph != null && paragraph.childWidgets.length === 1 &&\n                paragraph.firstChild.children.length === 1) {\n                var pageBreak = paragraph.firstChild.children[0];\n                isPageBreak = pageBreak.isPageBreak;\n            }\n        }\n        return isPageBreak;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.containerWidget.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (!isNullOrUndefined(node.containerWidget)) {\n            if (node.containerWidget instanceof BlockWidget) {\n                return node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n            else if (node.containerWidget instanceof BlockContainer) {\n                hierarchicalIndex = node.containerWidget.getHierarchicalIndex(hierarchicalIndex);\n            }\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getIndex = function () {\n        if (this instanceof ParagraphWidget || this instanceof TableWidget) {\n            return this.containerWidget.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableRowWidget) {\n            return this.ownerTable.childWidgets.indexOf(this);\n        }\n        else if (this instanceof TableCellWidget) {\n            return this.ownerRow.childWidgets.indexOf(this);\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BlockWidget.prototype.getContainerWidth = function () {\n        if (this.isInsideTable) {\n            return this.associatedCell.cellFormat.cellWidth - (this.associatedCell.margin.left + this.associatedCell.margin.right);\n        }\n        else {\n            var bodyWidget = this.bodyWidget;\n            var sectionFormat = bodyWidget.sectionFormat;\n            return sectionFormat.pageWidth - (sectionFormat.leftMargin + sectionFormat.rightMargin);\n        }\n    };\n    return BlockWidget;\n}(Widget));\nexport { BlockWidget };\n/**\n * @private\n */\nvar ParagraphWidget = /** @class */ (function (_super) {\n    __extends(ParagraphWidget, _super);\n    /**\n     * Initialize the constructor of ParagraphWidget\n     */\n    function ParagraphWidget() {\n        var _this = _super.call(this) || this;\n        _this.paragraphFormat = new WParagraphFormat(_this);\n        _this.characterFormat = new WCharacterFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(ParagraphWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.childWidgets.length > 0) {\n                return this.lastChild.isEndsWithPageBreak;\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.equals = function (widget) {\n        return widget instanceof ParagraphWidget && widget.paragraphFormat === this.paragraphFormat;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.isEmpty = function () {\n        if (isNullOrUndefined(this.childWidgets) || this.childWidgets.length === 0) {\n            return true;\n        }\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var inlineElement = this.childWidgets[j];\n            for (var i = 0; i < inlineElement.children.length; i++) {\n                var inline = inlineElement.children[i];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return false;\n                }\n            }\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getInline = function (offset, indexInInline) {\n        var inline = undefined;\n        var count = 0;\n        var isStarted = false;\n        var splittedWidget = this.getSplitWidgets();\n        for (var k = 0; k < splittedWidget.length; k++) {\n            var widget = splittedWidget[k];\n            for (var j = 0; j < widget.childWidgets.length; j++) {\n                var line = widget.childWidgets[j];\n                for (var i = 0; i < line.children.length; i++) {\n                    inline = line.children[i];\n                    if (inline instanceof ListTextElementBox) {\n                        continue;\n                    }\n                    if (!isStarted && (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                        || inline instanceof BookmarkElementBox || inline instanceof FieldElementBox\n                        && HelperMethods.isLinkedFieldCharacter(inline))) {\n                        isStarted = true;\n                    }\n                    if (isStarted && offset <= count + inline.length) {\n                        indexInInline = (offset - count);\n                        return { 'element': inline, 'index': indexInInline };\n                    }\n                    count += inline.length;\n                }\n            }\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inline) ? offset : inline.length;\n        }\n        return { 'element': inline, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getLength = function () {\n        var length = 0;\n        for (var j = 0; j < this.childWidgets.length; j++) {\n            var line = this.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof ListTextElementBox) {\n                    continue;\n                }\n                length += element.length;\n            }\n        }\n        return length;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.getTableCellWidget = function (point) {\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.clone = function () {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat.copyFormat(this.paragraphFormat);\n        paragraph.characterFormat.copyFormat(this.characterFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var line = this.childWidgets[i];\n            var cloneLine = line.clone();\n            paragraph.childWidgets.push(cloneLine);\n            cloneLine.paragraph = paragraph;\n        }\n        paragraph.x = this.x;\n        paragraph.y = this.y;\n        paragraph.height = this.height;\n        paragraph.width = this.width;\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroy();\n                if (this.childWidgets.length === 1 && isNullOrUndefined(this.childWidgets[0].children)) {\n                    this.childWidgets = undefined;\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget) && !isNullOrUndefined(this.containerWidget.childWidgets)\n            && this.containerWidget.childWidgets.indexOf(this) !== -1) {\n            this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n            this.containerWidget.height -= height;\n            // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n            //     && this.containerWidget instanceof BodyWidget) {\n            //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n            // }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    ParagraphWidget.prototype.destroy = function () {\n        // if (this.paragraphFormat) {\n        //     this.paragraphFormat.destroy();\n        // }\n        this.paragraphFormat = undefined;\n        // if (this.characterFormat) {\n        //     this.characterFormat.destroy();\n        // }\n        this.characterFormat = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ParagraphWidget;\n}(BlockWidget));\nexport { ParagraphWidget };\n/**\n * @private\n */\nvar TableWidget = /** @class */ (function (_super) {\n    __extends(TableWidget, _super);\n    function TableWidget() {\n        var _this = _super.call(this) || this;\n        _this.flags = 0;\n        /**\n         * @private\n         */\n        _this.leftMargin = 0;\n        /**\n         * @private\n         */\n        _this.topMargin = 0;\n        /**\n         * @private\n         */\n        _this.rightMargin = 0;\n        /**\n         * @private\n         */\n        _this.bottomMargin = 0;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.tableFormat = new WTableFormat(_this);\n        _this.tableHolder = new WTableHolder();\n        _this.spannedRowCollection = new Dictionary();\n        return _this;\n    }\n    Object.defineProperty(TableWidget.prototype, \"isGridUpdated\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x4) >> 2) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFB) | ((value ? 1 : 0) << 2));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"continueHeader\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return ((this.flags & 0x2) >> 1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFD) | ((value ? 1 : 0) << 1));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableWidget.prototype, \"header\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return (this.flags & 0x1) !== 0;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.flags = ((this.flags & 0xFE) | (value ? 1 : 0));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableWidget.prototype.equals = function (widget) {\n        return widget instanceof TableWidget && widget.tableFormat === this.tableFormat;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.combineRows = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.childWidgets.length === 0) {\n                row.destroy();\n                i--;\n            }\n            else {\n                row.combineCells(viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.contains = function (tableCell) {\n        if (this.equals(tableCell.ownerTable)) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (this.equals(tableCell.ownerTable)) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return this.equals(tableCell.ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getOwnerWidth = function (isBasedOnViewer) {\n        var width = this.getContainerWidth();\n        // Left and right indents should be neglected.\n        width = width - this.leftIndent - this.rightIndent;\n        return width >= 0 ? width : 0;\n    };\n    TableWidget.prototype.getTableWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rowWidth = 0;\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                rowWidth += row.childWidgets[j].cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableClientWidth = function (clientWidth) {\n        var tableWidth = clientWidth;\n        if (this.tableFormat.preferredWidthType === 'Point'\n            && this.tableFormat.preferredWidth > 0) {\n            tableWidth = this.tableFormat.preferredWidth;\n        }\n        else {\n            if (this.tableFormat.preferredWidthType === 'Percent'\n                && this.tableFormat.preferredWidth > 0) {\n                tableWidth = tableWidth * this.tableFormat.preferredWidth / 100;\n            }\n            else {\n                //By default, if Table preferred widthType is auto , width is set based on ClientWidth and type is set as 'Point'\n                this.tableFormat.preferredWidthType = 'Point';\n                this.tableFormat.preferredWidth = tableWidth;\n            }\n        }\n        return tableWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellWidth = function (preferredWidth, preferredWidthType, containerWidth, cell) {\n        var cellWidth = preferredWidth;\n        if (preferredWidthType === 'Percent') {\n            cellWidth = (preferredWidth * containerWidth) / 100;\n        }\n        else if (preferredWidthType === 'Point') {\n            cellWidth = preferredWidth;\n        }\n        // For grid before and grid after with auto width, no need to calculate minimum preferred width.\n        else if (!isNullOrUndefined(cell)) {\n            cellWidth = cell.getMinimumPreferredWidth();\n        }\n        return cellWidth;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitCellsToClientArea = function (clientWidth) {\n        var tableWidth = this.getTableWidth();\n        var factor = clientWidth / tableWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.rowFormat.gridAfterWidth *= factor;\n            row.rowFormat.gridBeforeWidth *= factor;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].cellFormat.cellWidth *= factor;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getTableCellWidget = function (point) {\n        var tableCellWidget = undefined;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                tableCellWidget = this.childWidgets[i].getTableCellWidget(point);\n                break;\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    TableWidget.prototype.calculateGrid = function () {\n        var tempGrid = [];\n        var spannedCells = [];\n        var containerWidth = this.getOwnerWidth(true);\n        var tableWidth = this.getTableClientWidth(containerWidth);\n        this.tableCellInfo = new Dictionary();\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowCellInfo = new Dictionary();\n            var rowFormat = row.rowFormat;\n            var cellWidth = 0;\n            var columnSpan = row.rowFormat.gridBefore;\n            var currOffset = 0;\n            if (tempGrid.indexOf(currOffset) < 0) {\n                tempGrid.push(currOffset);\n            }\n            //Converts the row grid before width from point to twips point by 15 factor.\n            cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, tableWidth, null);\n            currOffset += cellWidth;\n            var startOffset = Math.round(currOffset);\n            if (tempGrid.indexOf(startOffset) < 0) {\n                tempGrid.push(startOffset);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < spannedCells.length; k++) {\n                    if (spannedCells[k].columnIndex < columnSpan) {\n                        continue;\n                    }\n                    var rowSpan = spannedCells[k].cellFormat.rowSpan;\n                    var removeSpannedCell = true;\n                    if (spannedCells[k].columnIndex > columnSpan) {\n                        {\n                            removeSpannedCell = false;\n                            // If the cell is the last cell in the row and the row has grid after value..\n                            if (j === row.childWidgets.length - 1 && row.rowFormat.gridAfter > 0) {\n                                // tslint:disable-next-line:max-line-length\n                                cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                                currOffset += cellWidth;\n                            }\n                        }\n                    }\n                    else {\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder \n                        // will have the columns at that time we can get the column index from the table holder.\n                        //Converts the cell width from point to twips point by 15 factor.\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(spannedCells[k].cellFormat.preferredWidth, spannedCells[k].cellFormat.preferredWidthType, tableWidth, null);\n                        currOffset += cellWidth;\n                        columnSpan = spannedCells[k].columnIndex + spannedCells[k].cellFormat.columnSpan;\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - spannedCells[k].ownerRow.rowIndex === rowSpan - 1) {\n                        spannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (spannedCells.length === 0 || spannedCells[spannedCells.length - 1].columnIndex <= columnSpan) {\n                        spannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = spannedCells.length; m > 0; m--) {\n                            if (spannedCells[m - 1].columnIndex > columnSpan) {\n                                spannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                // Add start offset of each cell based on its index\n                if (!rowCellInfo.containsKey(cell.cellIndex)) {\n                    rowCellInfo.add(cell.cellIndex, Math.round(currOffset - startOffset));\n                }\n                columnSpan += cell.cellFormat.columnSpan;\n                //Converts the cell width from pixel to twips point by 15 factor.\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, null);\n                currOffset += cellWidth;\n                var offset = Math.round(currOffset);\n                if (tempGrid.indexOf(offset) < 0) {\n                    tempGrid.push(offset);\n                }\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfter > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    currOffset += cellWidth;\n                    if (tempGrid.indexOf(Math.round(currOffset)) < 0) {\n                        tempGrid.push(Math.round(currOffset));\n                    }\n                    columnSpan += rowFormat.gridAfter;\n                }\n                // Add rowindex and its cells info for each row\n                if (!this.tableCellInfo.containsKey(row.rowIndex)) {\n                    this.tableCellInfo.add(row.rowIndex, rowCellInfo);\n                }\n            }\n        }\n        tempGrid.sort(function (a, b) { return a - b; });\n        if (tempGrid.length - 1 !== this.tableHolder.columns.length) {\n            this.updateColumnSpans(tempGrid, tableWidth);\n        }\n        this.tableCellInfo.clear();\n        this.tableCellInfo = undefined;\n    };\n    TableWidget.prototype.updateColumnSpans = function (tempGrid, containerWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            if (row.rowFormat.gridBeforeWidth >= 0) {\n                row.rowFormat.gridBefore = row.getGridCount(tempGrid, undefined, -1, containerWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnSpan = row.getGridCount(tempGrid, cell, cell.getIndex(), containerWidth);\n                if (columnSpan > 0 && cell.cellFormat.columnSpan !== columnSpan) {\n                    cell.cellFormat.columnSpan = columnSpan;\n                }\n            }\n            if (row.rowFormat.gridAfterWidth >= 0) {\n                row.rowFormat.gridAfter = row.getGridCount(tempGrid, undefined, row.childWidgets.length, containerWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.buildTableColumns = function () {\n        if (this.isGridUpdated) {\n            return;\n        }\n        // Clear existing columns in order to start creating columns freshly.\n        this.tableHolder.resetColumns();\n        var containerWidth = 0;\n        var tableWidth = 0;\n        var rowSpannedCells = [];\n        var isAutoWidth = this.tableFormat.preferredWidthType === 'Auto';\n        // For continuous layout, window width should be considered. \n        // If preferred width exceeds this limit, it can take upto maximum of 2112 pixels (1584 points will be assigned by Microsoft Word).\n        containerWidth = this.getOwnerWidth(true);\n        tableWidth = this.getTableClientWidth(containerWidth);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowFormat = row.rowFormat;\n            var columnSpan = 0;\n            var cellWidth = 0;\n            var offset = 0;\n            if (rowFormat.gridBefore > 0) {\n                cellWidth = this.getCellWidth(rowFormat.gridBeforeWidth, row.rowFormat.gridAfterWidthType, tableWidth, null);\n                this.tableHolder.addColumns(columnSpan, columnSpan = rowFormat.gridBefore, cellWidth, cellWidth, offset = cellWidth);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (rowSpannedCells.length === 0) {\n                    cell.columnIndex = columnSpan;\n                }\n                for (var k = 0; k < rowSpannedCells.length; k++) {\n                    var rowSpannedCell = rowSpannedCells[k];\n                    if (rowSpannedCell.columnIndex < columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        continue;\n                    }\n                    var rowSpan = 1;\n                    var removeSpannedCell = true;\n                    rowSpan = rowSpannedCell.cellFormat.rowSpan;\n                    if (rowSpannedCell.columnIndex > columnSpan) {\n                        cell.columnIndex = columnSpan;\n                        removeSpannedCell = false;\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        cellWidth = this.getCellWidth(rowSpannedCell.cellFormat.preferredWidth, rowSpannedCell.cellFormat.preferredWidthType, tableWidth, rowSpannedCell);\n                        var minWidth_1 = rowSpannedCell.getMinimumPreferredWidth();\n                        // If the table gird alone calculted then column index of the rowspanned cell will be directly taken. \n                        // tslint:disable-next-line:max-line-length\n                        // If the gird calculation is done from the UI level opearations such as resizing then table holder will have the columns at that time we can get the column index from the table holder.\n                        // tslint:disable-next-line:max-line-length\n                        if (this.tableHolder.columns.length > 0) {\n                            this.tableHolder.addColumns(columnSpan, columnSpan = this.tableHolder.columns.indexOf(rowSpannedCell.ownerColumn) + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                        else {\n                            // tslint:disable-next-line:max-line-length\n                            this.tableHolder.addColumns(columnSpan, columnSpan = rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan, cellWidth, minWidth_1, offset += cellWidth);\n                            cell.columnIndex = columnSpan;\n                        }\n                    }\n                    if (!removeSpannedCell && j === row.childWidgets.length - 1) {\n                        removeSpannedCell = true;\n                    }\n                    if (removeSpannedCell && i - rowSpannedCell.ownerRow.rowIndex === rowSpan - 1) {\n                        rowSpannedCells.splice(k, 1);\n                        k--;\n                    }\n                }\n                // At the start of each row, we will process the row spanned cells to get the start column index.\n                // To calculate grid properly, we need the items in the spanned cells collection in the order of their column index\n                if (cell.cellFormat.rowSpan > 1) {\n                    if (rowSpannedCells.length === 0 || rowSpannedCells[rowSpannedCells.length - 1].columnIndex <= columnSpan) {\n                        rowSpannedCells.push(cell);\n                    }\n                    else {\n                        for (var m = rowSpannedCells.length; m > 0; m--) {\n                            if (rowSpannedCells[m - 1].columnIndex > columnSpan) {\n                                rowSpannedCells.splice(m - 1, 0, cell);\n                            }\n                        }\n                    }\n                }\n                cellWidth = this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, tableWidth, cell);\n                var minWidth = cell.getMinimumPreferredWidth();\n                this.tableHolder.addColumns(columnSpan, columnSpan += cell.cellFormat.columnSpan, cellWidth, minWidth, offset += cellWidth);\n                if (j === row.childWidgets.length - 1 && rowFormat.gridAfterWidth > 0) {\n                    cellWidth = this.getCellWidth(rowFormat.gridAfterWidth, 'Point', tableWidth, null);\n                    this.tableHolder.addColumns(columnSpan, columnSpan += rowFormat.gridAfter, cellWidth, cellWidth, offset += cellWidth);\n                }\n            }\n        }\n        this.tableHolder.validateColumnWidths();\n        // Fits the column width based on preferred width. i.e. Fixed layout.\n        this.tableHolder.fitColumns(containerWidth, tableWidth, isAutoWidth);\n        //Sets the width to cells\n        this.setWidthToCells(tableWidth, isAutoWidth);\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.setWidthToCells = function (tableWidth, isAutoWidth) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var rw = this.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.beforeWidth = this.tableHolder.getCellWidth(0, rowFormat.gridBefore, tableWidth, isAutoWidth);\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                // tslint:disable-next-line:max-line-length\n                cell.cellFormat.cellWidth = this.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoWidth);\n                //By default, if cell preferred widthType is auto , width set based on table width and type is changed to 'Point'\n                if (cell.cellFormat.preferredWidthType !== 'Percent') {\n                    cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                    cell.cellFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.afterWidth = this.tableHolder.getCellWidth(0, rowFormat.gridAfter, tableWidth, isAutoWidth);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getMaxRowWidth = function (clientWidth) {\n        var width = 0;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += this.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, clientWidth, cell);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateWidth = function (dragValue) {\n        var totalPreferredWidth = this.tableHolder.getTotalWidth();\n        var containerWidth = this.getTableClientWidth(this.getOwnerWidth(true));\n        if (containerWidth <= totalPreferredWidth) {\n            if (this.tableFormat.preferredWidthType === 'Auto') {\n                this.tableFormat.preferredWidthType = 'Point';\n            }\n        }\n        if (this.tableFormat.preferredWidthType !== 'Auto') {\n            if (this.tableFormat.preferredWidthType === 'Point') {\n                this.tableFormat.preferredWidth = this.getMaxRowWidth(containerWidth);\n            }\n            // else\n            // {   //ToDo:Need to anzlyze more the Percentage calculation for table width.\n            //     let value:number = ConvertPixelToPercent(GetMaxRowWidth(containerWidth));\n            //     this.tableFormat.preferredWidth = value;\n            // }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.convertPointToPercent = function (tablePreferredWidth, ownerWidth) {\n        var value = 0;\n        value = (tablePreferredWidth / ownerWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.clone = function () {\n        var table = new TableWidget();\n        table.tableHolder = this.tableHolder.clone();\n        table.tableFormat.copyFormat(this.tableFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i].clone();\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n            row.index = i;\n        }\n        table.x = this.x;\n        table.y = this.y;\n        table.height = this.height;\n        table.width = this.width;\n        table.containerWidget = this.containerWidget;\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableWidget.getTableOf = function (node) {\n        if (node instanceof WBorders) {\n            var row = TableRowWidget.getRowOf(node);\n            if (!isNullOrUndefined(row)) {\n                return row.ownerTable;\n            }\n            else if (node.ownerBase instanceof WTableFormat && node.ownerBase.ownerBase instanceof TableWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.fitChildToClientArea = function () {\n        var clientWidth = this.getContainerWidth();\n        if (Math.round(clientWidth) < Math.round(this.getTableWidth())) {\n            this.fitCellsToClientArea(clientWidth);\n        }\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    if (cell.childWidgets[k] instanceof TableWidget) {\n                        cell.childWidgets[k].fitChildToClientArea();\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getColumnCellsForSelection = function (startCell, endCell) {\n        var cells = [];\n        var start = startCell.columnIndex;\n        var end = endCell.columnIndex + endCell.cellFormat.columnSpan;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var columnIndex = cell.columnIndex;\n                var columnSpan = cell.cellFormat.columnSpan;\n                if ((columnIndex + columnSpan > start && columnIndex + columnSpan < end) || (columnIndex > start && columnIndex < end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if ((columnIndex > start && columnIndex < end && columnIndex + columnSpan < end)\n                    || (columnIndex < start && columnIndex + columnSpan > end)) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n                else if (columnIndex === start || columnIndex + columnSpan === end) {\n                    if (cells.indexOf(cell) < 0) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * Splits width equally for all the cells.\n     * @param tableClientWidth\n     * @private\n     */\n    TableWidget.prototype.splitWidthToTableCells = function (tableClientWidth) {\n        for (var row = 0; row < this.childWidgets.length; row++) {\n            this.childWidgets[row].splitWidthToRowCells(tableClientWidth);\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.insertTableRowsInternal = function (tableRows, startIndex) {\n        for (var i = 0; i < tableRows.length; i++) {\n            var row = tableRows.splice(i, 1)[0];\n            row.containerWidget = this;\n            this.childWidgets.splice(startIndex, 0, row);\n            i--;\n        }\n        this.updateRowIndex(startIndex);\n        this.isGridUpdated = false;\n        this.buildTableColumns();\n        this.isGridUpdated = true;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.updateRowIndex = function (startIndex) {\n        for (var i = startIndex; i < this.childWidgets.length; i++) {\n            var row = this.childWidgets[i];\n            row.index = i;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                row.childWidgets[j].index = j;\n                row.childWidgets[j].rowIndex = row.rowIndex;\n            }\n            startIndex++;\n        }\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.getCellStartOffset = function (cell) {\n        var offset = 0;\n        if (cell && this.tableCellInfo) {\n            if (this.tableCellInfo.containsKey(cell.ownerRow.rowIndex)) {\n                var rowCellInfo = this.tableCellInfo.get(cell.ownerRow.rowIndex);\n                if (rowCellInfo.containsKey(cell.cellIndex)) {\n                    offset = rowCellInfo.get(cell.cellIndex);\n                }\n            }\n        }\n        return offset;\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var j = 0; j < this.childWidgets.length; j++) {\n                var widget = undefined;\n                var childWidget = this.childWidgets[j];\n                widget = childWidget;\n                if (!isNullOrUndefined(widget)) {\n                    widget.destroyInternal(viewer);\n                }\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                j--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                if (this.containerWidget.childWidgets.indexOf(this) !== -1) {\n                    this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                }\n                this.containerWidget.height -= height;\n                // if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                //     && this.containerWidget instanceof BodyWidget) {\n                //     // (this.containerWidget as BodyWidget).destroyInternal(viewer);\n                // }\n            }\n            this.containerWidget = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableWidget.prototype.destroy = function () {\n        // if (this.tableFormat) {\n        //     this.tableFormat.destroy();\n        // }\n        this.tableFormat = undefined;\n        // if (this.spannedRowCollection) {\n        //     this.spannedRowCollection.destroy();\n        // }\n        this.spannedRowCollection = undefined;\n        this.tableGrids = [];\n        this.tableGrids = undefined;\n        // if (this.tableHolder) {\n        //     this.tableHolder.destroy();\n        // }\n        this.tableHolder = undefined;\n        this.flags = undefined;\n        this.leftMargin = undefined;\n        this.topMargin = undefined;\n        this.rightMargin = undefined;\n        this.bottomMargin = undefined;\n        this.headerHeight = undefined;\n        this.description = undefined;\n        this.title = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableWidget;\n}(BlockWidget));\nexport { TableWidget };\n/**\n * @private\n */\nvar TableRowWidget = /** @class */ (function (_super) {\n    __extends(TableRowWidget, _super);\n    function TableRowWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.spannedRowCollection = [];\n        _this.topBorderWidth = 0;\n        _this.bottomBorderWidth = 0;\n        _this.rowFormat = new WRowFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableRowWidget.prototype, \"rowIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget) {\n                return this.containerWidget.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableWidget) {\n                return this.containerWidget;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableRowWidget.prototype, \"nextRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.ownerTable.childWidgets.length - 1) {\n                return this.ownerTable.childWidgets[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.equals = function (widget) {\n        return widget instanceof TableRowWidget && widget.rowFormat === this.rowFormat;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.combineCells = function (viewer) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            cell.combineWidget(viewer);\n            if (cell.cellFormat.rowSpan === 1) {\n                var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n                if ((this.height - this.ownerTable.tableFormat.cellSpacing) < cell.height) {\n                    this.height = this.ownerTable.tableFormat.cellSpacing + cell.height;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.getRowOf = function (node) {\n        if (node instanceof WBorders) {\n            var cell = TableCellWidget.getCellOf(node);\n            if (!isNullOrUndefined(cell)) {\n                return cell.ownerRow;\n            }\n            else if (node.ownerBase instanceof WRowFormat && node.ownerBase.ownerBase instanceof TableRowWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getCell = function (rowIndex, cellIndex) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i];\n            if (cell.rowIndex === rowIndex && cell.index === cellIndex) {\n                return cell;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.splitWidthToRowCells = function (tableClientWidth) {\n        var cells = this.childWidgets;\n        var cellWidth = tableClientWidth / cells.length;\n        for (var cell = 0; cell < cells.length; cell++) {\n            cells[cell].cellFormat.preferredWidth = cellWidth;\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getGridCount = function (tableGrid, cell, index, containerWidth) {\n        var prevOffset = 0;\n        var width = 0;\n        var ownerTable = this.ownerTable;\n        var rowFormat = this.rowFormat;\n        if (index === -1) {\n            width = ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n        }\n        else {\n            prevOffset += ownerTable.getCellWidth(rowFormat.gridBeforeWidth, rowFormat.gridBeforeWidthType, containerWidth, null);\n            if (index >= 0) {\n                prevOffset += ownerTable.getCellStartOffset(cell);\n            }\n            if (index < this.childWidgets.length) {\n                width = ownerTable.getCellWidth(cell.cellFormat.preferredWidth, cell.cellFormat.preferredWidthType, containerWidth, null);\n            }\n            else {\n                width = ownerTable.getCellWidth(rowFormat.gridAfterWidth, rowFormat.gridAfterWidthType, containerWidth, null);\n            }\n        }\n        var gridStartIndex = this.getOffsetIndex(tableGrid, prevOffset);\n        var gridEndIndex = this.getOffsetIndex(tableGrid, prevOffset + width);\n        return gridEndIndex - gridStartIndex;\n    };\n    TableRowWidget.prototype.getOffsetIndex = function (tableGrid, offset) {\n        offset = Math.round(offset);\n        var index = 0;\n        if (tableGrid.indexOf(offset) >= 0) {\n            index = tableGrid.indexOf(offset);\n        }\n        else {\n            for (var i = 0; i < tableGrid.length; i++) {\n                if (tableGrid[i] > offset) {\n                    return i;\n                }\n            }\n            index = tableGrid.length - 1;\n        }\n        return index;\n    };\n    TableRowWidget.prototype.getCellOffset = function (index, containerWidth) {\n        var prevOffset = 0;\n        var ownerTable = this.ownerTable;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cellFormat = this.childWidgets[i].cellFormat;\n            if (i === index) {\n                break;\n            }\n            prevOffset += ownerTable.getCellWidth(cellFormat.preferredWidth, cellFormat.preferredWidthType, containerWidth, null);\n        }\n        return prevOffset;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.updateRowBySpannedCells = function () {\n        var rowSpannedCells = this.getPreviousRowSpannedCells();\n        var currentRowIndex = this.rowIndex;\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            var spannedCell = rowSpannedCells[i];\n            var rowSpanEnd = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n            // If current row is row span end or includes spanned cells. then, decrease the rowspan\n            if (rowSpanEnd >= currentRowIndex) {\n                spannedCell.cellFormat.rowSpan -= 1;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getPreviousRowSpannedCells = function (include) {\n        var rowSpannedCells = [];\n        var row = include ? this : this.previousWidget;\n        while (!isNullOrUndefined(row)) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (cell.cellFormat.rowSpan > 1) {\n                    rowSpannedCells.splice(0, 0, cell);\n                }\n            }\n            row = row.previousWidget;\n        }\n        return rowSpannedCells;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var x = Math.round(this.childWidgets[i].x);\n            if (x - this.childWidgets[i].margin.left - 1 <= point.x\n                && (x + this.childWidgets[i].width) >= point.x) {\n                return this.childWidgets[i];\n            }\n            else if (i === this.childWidgets.length - 1\n                && (this.childWidgets[i].x + this.childWidgets[i].width) + 1 <= point.x) {\n                return this.childWidgets[i];\n            }\n        }\n        var cellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].x <= point.x) {\n                cellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                cellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return cellWidget;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroyInternal = function (viewer) {\n        var height = this.height;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                widget.destroyInternal(viewer);\n                if (isNullOrUndefined(this.childWidgets)) {\n                    break;\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        if (!isNullOrUndefined(this.containerWidget)) {\n            if (!isNullOrUndefined(this.containerWidget.childWidgets)) {\n                this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this), 1);\n                if ((isNullOrUndefined(this.containerWidget.childWidgets) || this.containerWidget.childWidgets.length === 0)\n                    && this.containerWidget instanceof TableWidget) {\n                    this.containerWidget.destroyInternal(viewer);\n                }\n                else if (this.containerWidget.containerWidget instanceof BodyWidget) {\n                    this.containerWidget.containerWidget.height -= height;\n                }\n                this.containerWidget.height -= height;\n            }\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.clone = function () {\n        var row = new TableRowWidget();\n        row.rowFormat.copyFormat(this.rowFormat);\n        row.topBorderWidth = this.topBorderWidth;\n        row.bottomBorderWidth = this.bottomBorderWidth;\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var cell = this.childWidgets[i].clone();\n            row.childWidgets.push(cell);\n            cell.containerWidget = row;\n            cell.index = i;\n            cell.rowIndex = this.rowIndex;\n        }\n        row.x = this.x;\n        row.y = this.y;\n        row.height = this.height;\n        row.width = this.width;\n        return row;\n    };\n    /**\n     * @private\n     */\n    TableRowWidget.prototype.destroy = function () {\n        // if (this.rowFormat) {\n        //     this.rowFormat.destroy();\n        // }\n        this.rowFormat = undefined;\n        this.rowFormat = undefined;\n        this.spannedRowCollection = [];\n        this.spannedRowCollection = undefined;\n        this.topBorderWidth = undefined;\n        this.bottomBorderWidth = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableRowWidget;\n}(BlockWidget));\nexport { TableRowWidget };\n/**\n * @private\n */\nvar TableCellWidget = /** @class */ (function (_super) {\n    __extends(TableCellWidget, _super);\n    function TableCellWidget() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.rowIndex = -1;\n        _this.margin = new Margin(_this.leftMargin, _this.topMargin, _this.rightMargin, _this.bottomMargin);\n        _this.leftBorderWidth = 0;\n        _this.rightBorderWidth = 0;\n        _this.cellFormat = new WCellFormat(_this);\n        return _this;\n    }\n    Object.defineProperty(TableCellWidget.prototype, \"ownerColumn\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerTable.tableHolder.columns[this.columnIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"leftMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.leftMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.leftMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"topMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.topMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.topMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"rightMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.rightMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.rightMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"bottomMargin\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.cellFormat && this.cellFormat.containsMargins()) {\n                return this.cellFormat.bottomMargin;\n            }\n            else if (!isNullOrUndefined(this.ownerTable) && !isNullOrUndefined(this.ownerTable.tableFormat)) {\n                return this.ownerTable.tableFormat.bottomMargin;\n            }\n            else {\n                return 0;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"cellIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.ownerRow) {\n                return this.ownerRow.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerTable\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.containerWidget instanceof TableRowWidget) {\n                return this.containerWidget.ownerTable;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TableCellWidget.prototype, \"ownerRow\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.containerWidget;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.equals = function (widget) {\n        return widget instanceof TableCellWidget && widget.cellFormat === this.cellFormat;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getContainerTable = function () {\n        var table = this.ownerTable;\n        while (table instanceof TableWidget && table.associatedCell instanceof TableCellWidget) {\n            table = table.associatedCell.getContainerTable();\n        }\n        return table;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousSplitWidget = function () {\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.previousRenderedWidget;\n                if (isNullOrUndefined(row) || row.index < this.rowIndex) {\n                    break;\n                }\n                var previousCell = row.getCell(this.rowIndex, this.index);\n                if (previousCell && this.equals(previousCell)) {\n                    return previousCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getNextSplitWidget = function () {\n        var rowSpan = this.cellFormat.rowSpan;\n        if (this.containerWidget instanceof TableRowWidget) {\n            var row = this.containerWidget;\n            do {\n                row = row.nextRenderedWidget;\n                if (isNullOrUndefined(row) || row.index > this.rowIndex + rowSpan) {\n                    break;\n                }\n                var nextCell = row.getCell(this.rowIndex, this.index);\n                if (nextCell && this.equals(nextCell)) {\n                    return nextCell;\n                }\n            } while (row);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTableCellWidget = function (point) {\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            if (this.childWidgets[i].y <= point.y\n                && (this.childWidgets[i].y + this.childWidgets[i].height) >= point.y) {\n                return this.childWidgets[i].getTableCellWidget(point);\n            }\n        }\n        var tableCellWidget = undefined;\n        if (this.childWidgets.length > 0) {\n            if (this.childWidgets[0].y <= point.y) {\n                tableCellWidget = this.childWidgets[this.childWidgets.length - 1].getTableCellWidget(point);\n            }\n            else {\n                tableCellWidget = this.childWidgets[0].getTableCellWidget(point);\n            }\n        }\n        return tableCellWidget;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.updateWidth = function (preferredWidth) {\n        if (this.cellFormat.preferredWidthType === 'Auto') {\n            this.cellFormat.preferredWidth = preferredWidth;\n            this.cellFormat.preferredWidthType = 'Point';\n        }\n        else if (this.cellFormat.preferredWidthType === 'Point') {\n            this.cellFormat.preferredWidth = preferredWidth;\n        }\n        else if (this.cellFormat.preferredWidthType === 'Percent') {\n            this.cellFormat.preferredWidth = this.convertPointToPercent(preferredWidth);\n        }\n        this.cellFormat.cellWidth = preferredWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.convertPointToPercent = function (cellPreferredWidth) {\n        var value = 0;\n        var clientWidth = this.ownerTable.getOwnerWidth(true);\n        var tableWidth = this.ownerTable.getTableClientWidth(clientWidth);\n        value = (cellPreferredWidth / tableWidth) * 100;\n        value = Math.round(value);\n        return value < 100 ? value : 100; // The value should be lesser than or equal to 100%;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellLeftBorder = function (tableCell) {\n        var leftBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.left)) {\n            leftBorder = cellBorder.left;\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            leftBorder = tableCell.getLeftBorderToRenderByHierarchy(leftBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevCell = undefined;\n            if (!isNullOrUndefined(tableCell.previousWidget)) {\n                // if the border is shared then choose the border based on Conflict Resolution algorithm.\n                prevCell = tableCell.previousWidget;\n            }\n            else if ((tableCell.cellFormat.columnSpan > 1 || tableCell.columnIndex > 1) && tableCell.ownerRow.rowIndex > 0) {\n                var previousRow = tableCell.ownerRow.previousWidget;\n                while (!isNullOrUndefined(previousRow) && previousRow.childWidgets.length > 0) {\n                    for (var i = 0; i < previousRow.childWidgets.length; i++) {\n                        var prevRowCell = previousRow.childWidgets[i];\n                        if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan === tableCell.columnIndex) {\n                            prevCell = previousRow.childWidgets[i];\n                            break;\n                        }\n                    }\n                    if (!isNullOrUndefined(prevCell)) {\n                        break;\n                    }\n                    previousRow = previousRow.previousWidget;\n                }\n            }\n            leftBorder = tableCell.getPreviousCellLeftBorder(leftBorder, prevCell);\n        }\n        if (isNullOrUndefined(leftBorder)) {\n            leftBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderWidth = function () {\n        var borderWidth = 0;\n        //let ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        // update the margins values respect to layouting of borders.\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred.\n        // this border widths are not included in margins.\n        //     boderWidth = this.cellFormat.borders.GetRightBorderToRender(this).GetLineWidth();\n        //need to render rightBorder specifically for all the cells when the cellSpacing is greater than zero or for last cell of each row.\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderWidth = function () {\n        var borderWidth = 0;\n        var ownerTable = this.ownerTable;\n        //Added null condition check for asynchronous loading.\n        // if (this.cellFormat !== null && this.cellFormat.borders !== null) {\n        ///need to render right border specifically for all the cells when the cell spacing is \n        //greater than zero or for last cell of each row.\n        //     let isLastCell: boolean = false;\n        //     isLastCell = this.cellIndex === 0;\n        //     if (ownerTable.tableFormat.cellSpacing > 0 || isLastCell) {\n        //         boderWidth = this.cellFormat.borders.getLeftBorderToRender(this).GetLineWidth();\n        //     }\n        // }\n        return borderWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getCellSpacing = function () {\n        var actualCellSpacing = this.ownerTable && this.ownerTable.tableFormat ? this.ownerTable.tableFormat.cellSpacing : 0;\n        var cellSpacingToLayout = actualCellSpacing;\n        // Considers the left, right margins and border widths(only available for Layouted table) for Minimum width.\n        if (this.ownerRow.childWidgets.length === 1) {\n            cellSpacingToLayout = actualCellSpacing * 2;\n        }\n        else if (this.cellIndex === 0 || this.cellIndex === this.ownerRow.childWidgets.length - 1) {\n            cellSpacingToLayout = actualCellSpacing + (actualCellSpacing / 2);\n        }\n        else {\n            cellSpacingToLayout = actualCellSpacing;\n        }\n        return cellSpacingToLayout;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getMinimumPreferredWidth = function () {\n        var defaultWidth = 0;\n        defaultWidth = this.leftMargin + this.rightMargin + this.getLeftBorderWidth() + this.getRightBorderWidth() + this.getCellSpacing();\n        return defaultWidth;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellLeftBorder = function (leftBorder, previousCell) {\n        // tslint:disable-next-line:max-line-length\n        if ((isNullOrUndefined(previousCell) || (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle === 'None' && !leftBorder.hasNoneStyle)))) {\n            if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevCellRightBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousCell.cellFormat.borders) && !isNullOrUndefined(previousCell.cellFormat.borders.right) && previousCell.cellFormat.borders.right.lineStyle !== 'None') {\n                prevCellRightBorder = previousCell.cellFormat.borders.right;\n            }\n            if (!isNullOrUndefined(prevCellRightBorder) && prevCellRightBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(prevCellRightBorder, leftBorder);\n            }\n            else if (!isNullOrUndefined(leftBorder) && !(leftBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getLeftBorderToRenderByHierarchy(leftBorder, TableRowWidget.getRowOf(leftBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(leftBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return leftBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBorderBasedOnPriority = function (border, adjacentBorder) {\n        // If the cell and its adjacent cell defined different borders then based on this algorithm the border choose to render.\n        // Reference link :https://msdn.microsoft.com/en-us/library/office/documentformat.openxml.wordprocessing.tablecellborders.aspx\n        if (isNullOrUndefined(border)) {\n            return adjacentBorder;\n        }\n        else if (isNullOrUndefined(adjacentBorder)) {\n            return border;\n        }\n        var borderWeight = border.getBorderWeight();\n        var adjacentBorderWeight = adjacentBorder.getBorderWeight();\n        //the border with higher wight  shall be displayed.\n        if (borderWeight === adjacentBorderWeight) {\n            //if the border is equal weight the based on the priority the border will be choosen to render.\n            var borderPriority = border.getPrecedence();\n            var adjacentBorderPriority = adjacentBorder.getPrecedence();\n            if (borderPriority === adjacentBorderPriority) {\n                //The color with the smaller brightness value shall be displayed.\n                var borderColInRGB = this.convertHexToRGB(border.color);\n                var R1 = borderColInRGB.r;\n                var G1 = borderColInRGB.g;\n                var B1 = borderColInRGB.b;\n                var adjacentBorderColInRGB = this.convertHexToRGB(adjacentBorder.color);\n                var R2 = adjacentBorderColInRGB.r;\n                var G2 = adjacentBorderColInRGB.g;\n                var B2 = adjacentBorderColInRGB.b;\n                var borderBrightness = (R1 + B1 + (2 * G1));\n                var adjacentBorderBrightness = (R2 + B2 + (2 * G2));\n                if (borderBrightness === adjacentBorderBrightness) {\n                    borderBrightness = (B1 + (2 * G1));\n                    adjacentBorderBrightness = (B2 + (2 * G2));\n                    if (borderBrightness === adjacentBorderBrightness) {\n                        if (G1 === G2) {\n                            return border;\n                        }\n                        else if (G1 > G2) {\n                            return adjacentBorder;\n                        }\n                        else {\n                            return border;\n                        }\n                    }\n                    else if (borderBrightness > adjacentBorderBrightness) {\n                        return adjacentBorder;\n                    }\n                    else {\n                        return border;\n                    }\n                }\n                else if (borderBrightness > adjacentBorderBrightness) {\n                    return adjacentBorder;\n                }\n                else {\n                    return border;\n                }\n            }\n            else if (borderPriority > adjacentBorderPriority) {\n                return border;\n            }\n            else {\n                return adjacentBorder;\n            }\n        }\n        else if (borderWeight > adjacentBorderWeight) {\n            return border;\n        }\n        else {\n            return adjacentBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getLeftBorderToRenderByHierarchy = function (leftBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(leftBorder) && (leftBorder.lineStyle !== 'None' || (leftBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(leftBorder.lineStyle === 'None' && leftBorder.lineWidth === 0 && leftBorder.color === '#000000')))) {\n            return leftBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(leftBorder) && (leftBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(leftBorder.ownerBase).columnIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.left)) {\n                leftBorder = tableBorders.left;\n            }\n            return leftBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return leftBorder = tableBorders.vertical;\n        }\n        else {\n            return leftBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellRightBorder = function (tableCell) {\n        var rightBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.right)) {\n            rightBorder = cellBorder.right;\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            rightBorder = tableCell.getRightBorderToRenderByHierarchy(rightBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextCell = undefined;\n            if (!isNullOrUndefined(tableCell.nextWidget)) {\n                nextCell = tableCell.nextWidget;\n            }\n            // if the border is shared then choose the border based on Conflict Resolution algorithm.\n            rightBorder = tableCell.getAdjacentCellRightBorder(rightBorder, nextCell);\n        }\n        if (isNullOrUndefined(rightBorder)) {\n            rightBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellRightBorder = function (rightBorder, nextCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextCell) || (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle === 'None' && !rightBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var nextCellLeftBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextCell.cellFormat.borders) && !isNullOrUndefined(nextCell.cellFormat.borders.left) && nextCell.cellFormat.borders.left.lineStyle !== 'None') {\n                nextCellLeftBorder = nextCell.cellFormat.borders.left;\n            }\n            if (!isNullOrUndefined(nextCellLeftBorder) && nextCellLeftBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(rightBorder, nextCellLeftBorder);\n            }\n            else if (!isNullOrUndefined(rightBorder) && !(rightBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getRightBorderToRenderByHierarchy(rightBorder, TableRowWidget.getRowOf(rightBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(rightBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return rightBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getRightBorderToRenderByHierarchy = function (rightBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(rightBorder) && (rightBorder.lineStyle !== 'None' || (rightBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(rightBorder.lineStyle === 'None' && rightBorder.lineWidth === 0 && rightBorder.color === '#000000')))) {\n            return rightBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(rightBorder) && (rightBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(rightBorder.ownerBase).columnIndex === TableCellWidget.getCellOf(rightBorder.ownerBase).ownerRow.childWidgets.length - 1) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.right)) {\n                rightBorder = tableBorders.right;\n            }\n            return rightBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.vertical) && rowBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = rowBorders.vertical;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.vertical) && tableBorders.vertical.lineStyle !== 'None') {\n            return rightBorder = tableBorders.vertical;\n        }\n        else {\n            return rightBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellTopBorder = function (tableCell) {\n        var topBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.top)) {\n            topBorder = cellBorder.top;\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            topBorder = tableCell.getTopBorderToRenderByHierarchy(topBorder, rowBorders, tableBorders);\n        }\n        else {\n            var prevTopCell = undefined;\n            //ToDo: Need to analyze more to get the previous cell.\n            var prevRow = tableCell.ownerRow.previousWidget;\n            while (!isNullOrUndefined(prevRow) && prevRow.childWidgets.length > 0) {\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    var prevRowCell = prevRow.childWidgets[i];\n                    if (prevRowCell.columnIndex + prevRowCell.cellFormat.columnSpan - 1 >= tableCell.columnIndex) {\n                        prevTopCell = prevRow.childWidgets[i];\n                        break;\n                    }\n                }\n                if (!isNullOrUndefined(prevTopCell)) {\n                    break;\n                }\n                prevRow = prevRow.previousWidget;\n                //If all the previous rows checked and the previous top cell is null\n                // then TableCell previus row matched column index cell is taken for border calculation.\n                if (isNullOrUndefined(prevRow) && isNullOrUndefined(prevTopCell)) {\n                    prevRow = tableCell.ownerRow.previousWidget;\n                    if (tableCell.columnIndex < prevRow.childWidgets.length) {\n                        for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                            var prevRowCell = prevRow.childWidgets[i];\n                            if (prevRowCell.columnIndex === tableCell.columnIndex) {\n                                prevTopCell = prevRow.childWidgets[i];\n                                break;\n                            }\n                        }\n                        //If table cell Column index is greater than previous row cells count then last cell is taken as previous top cell.\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        prevTopCell = tableCell.ownerRow.previousWidget.childWidgets[tableCell.ownerRow.previousWidget.childWidgets.length - 1];\n                    }\n                }\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            topBorder = tableCell.getPreviousCellTopBorder(topBorder, prevTopCell);\n        }\n        if (isNullOrUndefined(topBorder)) {\n            topBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getPreviousCellTopBorder = function (topBorder, previousTopCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(previousTopCell) || (!isNullOrUndefined(topBorder) && (topBorder.lineStyle === 'None' && !topBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevTopCellBottomBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(previousTopCell.cellFormat.borders) && !isNullOrUndefined(previousTopCell.cellFormat.borders.bottom) && previousTopCell.cellFormat.borders.bottom.lineStyle !== 'None') {\n                prevTopCellBottomBorder = previousTopCell.cellFormat.borders.bottom;\n            }\n            if (!isNullOrUndefined(prevTopCellBottomBorder) && prevTopCellBottomBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(topBorder, prevTopCellBottomBorder);\n            }\n            else if (!isNullOrUndefined(topBorder) && !(topBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getTopBorderToRenderByHierarchy(topBorder, TableRowWidget.getRowOf(topBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(topBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return topBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getTopBorderToRenderByHierarchy = function (topBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(topBorder) && (topBorder.lineStyle !== 'None' || (topBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(topBorder.lineStyle === 'None' && topBorder.lineWidth === 0 && topBorder.color === '#000000')))) {\n            return topBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(topBorder) && (topBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(topBorder.ownerBase).ownerRow.rowIndex === 0) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.top)) {\n                topBorder = tableBorders.top;\n            }\n            return topBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return topBorder = tableBorders.horizontal;\n        }\n        else {\n            return topBorder;\n        }\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellBottomBorder = function (tableCell) {\n        var bottomBorder = undefined;\n        var cellBorder = tableCell.cellFormat.borders;\n        var rowBorders = !isNullOrUndefined(tableCell.ownerRow) ? tableCell.ownerRow.rowFormat.borders : undefined;\n        var tableBorders = !isNullOrUndefined(tableCell.ownerTable) ? tableCell.ownerTable.tableFormat.borders : undefined;\n        if (!isNullOrUndefined(cellBorder.bottom)) {\n            bottomBorder = cellBorder.bottom;\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            // tslint:disable-next-line:max-line-length\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders); // select the left border based on heirarchy.\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0) {\n            bottomBorder = tableCell.getBottomBorderToRenderByHierarchy(bottomBorder, rowBorders, tableBorders);\n        }\n        else {\n            var nextBottomCell = undefined;\n            var nextRow = tableCell.ownerRow.nextWidget;\n            if (!isNullOrUndefined(nextRow) && tableCell.columnIndex < nextRow.childWidgets.length) {\n                nextBottomCell = nextRow.childWidgets[tableCell.columnIndex];\n            }\n            //If the border is shared then choose the border based on Conflict Resolution algorithm.\n            bottomBorder = tableCell.getAdjacentCellBottomBorder(bottomBorder, nextBottomCell);\n        }\n        if (isNullOrUndefined(bottomBorder)) {\n            bottomBorder = new WBorder(tableCell.cellFormat.borders);\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getAdjacentCellBottomBorder = function (bottomBorder, nextBottomCell) {\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(nextBottomCell) || (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle === 'None' && !bottomBorder.hasNoneStyle))) {\n            if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        else {\n            var prevBottomCellTopBorder = undefined;\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(nextBottomCell.cellFormat.borders) && !isNullOrUndefined(nextBottomCell.cellFormat.borders.top) && nextBottomCell.cellFormat.borders.top.lineStyle !== 'None') {\n                prevBottomCellTopBorder = nextBottomCell.cellFormat.borders.top;\n            }\n            if (!isNullOrUndefined(prevBottomCellTopBorder) && prevBottomCellTopBorder.lineStyle !== 'None') {\n                return this.getBorderBasedOnPriority(bottomBorder, prevBottomCellTopBorder);\n            }\n            else if (!isNullOrUndefined(bottomBorder) && !(bottomBorder.ownerBase.ownerBase instanceof WTableFormat)) {\n                // tslint:disable-next-line:max-line-length\n                return this.getBottomBorderToRenderByHierarchy(bottomBorder, TableRowWidget.getRowOf(bottomBorder.ownerBase).rowFormat.borders, TableWidget.getTableOf(bottomBorder.ownerBase).tableFormat.borders);\n            }\n        }\n        return bottomBorder;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.getBottomBorderToRenderByHierarchy = function (bottomBorder, rowBorders, tableBorders) {\n        if (!isNullOrUndefined(bottomBorder) && (bottomBorder.lineStyle !== 'None' || (bottomBorder.hasNoneStyle &&\n            //If border defined with default values then border drawn based on hierarchy. \n            !(bottomBorder.lineStyle === 'None' && bottomBorder.lineWidth === 0 && bottomBorder.color === '#000000')))) {\n            return bottomBorder;\n            // tslint:disable-next-line:max-line-length\n        }\n        else if (!isNullOrUndefined(bottomBorder) && (bottomBorder.ownerBase instanceof WBorders) && TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerRow.rowIndex + TableCellWidget.getCellOf(bottomBorder.ownerBase).cellFormat.rowSpan === TableCellWidget.getCellOf(bottomBorder.ownerBase).ownerTable.childWidgets.length) {\n            if (!isNullOrUndefined(tableBorders) && !isNullOrUndefined(tableBorders.bottom)) {\n                bottomBorder = tableBorders.bottom;\n            }\n            return bottomBorder;\n        }\n        else if (!isNullOrUndefined(rowBorders)\n            && !isNullOrUndefined(rowBorders.horizontal) && rowBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = rowBorders.horizontal;\n        }\n        else if (!isNullOrUndefined(tableBorders)\n            && !isNullOrUndefined(tableBorders.horizontal) && tableBorders.horizontal.lineStyle !== 'None') {\n            return bottomBorder = tableBorders.horizontal;\n        }\n        else {\n            return bottomBorder;\n        }\n    };\n    TableCellWidget.prototype.convertHexToRGB = function (colorCode) {\n        if (colorCode) {\n            colorCode = colorCode.replace(/[^0-9A-Ã¢â‚¬Å’Ã¢â‚¬â€¹F]/gi, ''); // To remove # from color code string.\n            var colCodeNo = parseInt(colorCode, 16);\n            var r = (colCodeNo >> 16) & 255;\n            var g = (colCodeNo >> 8) & 255;\n            var b = colCodeNo & 255;\n            return { 'r': r, 'g': g, 'b': b };\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.getCellOf = function (node) {\n        if (node instanceof WBorders) {\n            if (node.ownerBase instanceof WCellFormat && node.ownerBase.ownerBase instanceof TableCellWidget) {\n                return node.ownerBase.ownerBase;\n            }\n            else {\n                return undefined;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroyInternal = function (viewer) {\n        // let viewer: LayoutViewer = undefined;\n        // let page: Page = this.getPage();\n        // if (!isNullOrUndefined(page ))\n        //     viewer = page.viewer;\n        if (!isNullOrUndefined(this.childWidgets)) {\n            for (var i = 0; i < this.childWidgets.length; i++) {\n                var widget = this.childWidgets[i];\n                if (widget instanceof ParagraphWidget) {\n                    widget.destroyInternal(viewer);\n                }\n                else {\n                    widget.destroyInternal(viewer);\n                }\n                i--;\n            }\n            this.childWidgets = undefined;\n        }\n        this.destroy();\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.clone = function () {\n        var cell = new TableCellWidget();\n        cell.cellFormat.copyFormat(this.cellFormat);\n        for (var i = 0; i < this.childWidgets.length; i++) {\n            var block = this.childWidgets[i].clone();\n            cell.childWidgets.push(block);\n            block.containerWidget = cell;\n            block.index = i;\n        }\n        cell.leftBorderWidth = this.leftBorderWidth;\n        cell.rightBorderWidth = this.rightBorderWidth;\n        if (this.margin) {\n            cell.margin = this.margin.clone();\n        }\n        cell.columnIndex = this.columnIndex;\n        cell.x = this.x;\n        cell.y = this.y;\n        cell.height = this.height;\n        cell.width = this.width;\n        return cell;\n    };\n    /**\n     * @private\n     */\n    TableCellWidget.prototype.destroy = function () {\n        // if (this.cellFormat) {\n        //     this.cellFormat.destroy();\n        // }\n        this.cellFormat = undefined;\n        this.rowIndex = undefined;\n        this.columnIndex = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TableCellWidget;\n}(BlockWidget));\nexport { TableCellWidget };\n/**\n * @private\n */\nvar LineWidget = /** @class */ (function () {\n    /**\n     * Initialize the constructor of LineWidget\n     */\n    function LineWidget(paragraphWidget) {\n        /**\n         * @private\n         */\n        this.children = [];\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.paragraph = paragraphWidget;\n    }\n    Object.defineProperty(LineWidget.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.paragraph && this.paragraph.childWidgets) {\n                return this.paragraph.childWidgets.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"nextLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            if (lineIndex <= paragraph.childWidgets.length - 2) {\n                return paragraph.childWidgets[lineIndex + 1];\n            }\n            else if (paragraph.nextSplitWidget) {\n                var line = paragraph.nextSplitWidget.firstChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"previousLine\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var paragraph = this.paragraph;\n            var lineIndex = this.indexInOwner;\n            var splitParagraph = paragraph.previousSplitWidget;\n            if (lineIndex > 0) {\n                return paragraph.childWidgets[lineIndex - 1];\n            }\n            else if (splitParagraph instanceof ParagraphWidget) {\n                var line = splitParagraph.lastChild;\n                if (line instanceof LineWidget && line.paragraph.equals(this.paragraph)) {\n                    return line;\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LineWidget.prototype, \"isEndsWithPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.children.length > 0) {\n                var lastElement = this.children[this.children.length - 1];\n                if (lastElement instanceof TextElementBox) {\n                    return lastElement.isPageBreak;\n                }\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    LineWidget.prototype.isFirstLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.previousSplitWidget === undefined) {\n            return index === 0;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.isLastLine = function () {\n        var index = this.indexInOwner;\n        if (index > -1 && this.paragraph.nextSplitWidget === undefined) {\n            return index === this.paragraph.childWidgets.length - 1;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getOffset = function (inline, index) {\n        if (isNullOrUndefined(inline)) {\n            return index;\n        }\n        var textIndex = index;\n        var line = inline.line;\n        var lineIndex = inline.line.paragraph.childWidgets.indexOf(inline.line);\n        for (var i = 0; i < line.children.length; i++) {\n            var inlineElement = line.children[i];\n            if (inline === inlineElement) {\n                break;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            textIndex += inlineElement.length;\n        }\n        return textIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getEndOffset = function () {\n        var startOffset = 0;\n        var count = 0;\n        for (var i = 0; i < this.children.length; i++) {\n            var inlineElement = this.children[i];\n            if (inlineElement.length === 0) {\n                continue;\n            }\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox || (inlineElement instanceof FieldElementBox\n                && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                startOffset = count + inlineElement.length;\n            }\n            count += inlineElement.length;\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getInline = function (offset, indexInInline) {\n        var inlineElement = undefined;\n        var count = 0;\n        var isStarted = false;\n        if (this.children.length === 0) {\n            if (this.previousLine) {\n                var elementBox = this.previousLine.children[this.previousLine.children.length - 1];\n                if (elementBox instanceof TextElementBox && elementBox.text === '\\v') {\n                    inlineElement = this.previousLine.children[this.previousLine.children.length - 1];\n                    indexInInline = 1;\n                    return { 'element': inlineElement, 'index': indexInInline };\n                }\n            }\n        }\n        for (var i = 0; i < this.children.length; i++) {\n            inlineElement = this.children[i];\n            if (inlineElement instanceof ListTextElementBox) {\n                continue;\n            }\n            if (!isStarted && (inlineElement instanceof TextElementBox || inlineElement instanceof ImageElementBox\n                || inlineElement instanceof BookmarkElementBox\n                || inlineElement instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inlineElement))) {\n                isStarted = true;\n            }\n            if (isStarted && offset <= count + inlineElement.length) {\n                indexInInline = (offset - count);\n                return { 'element': inlineElement, 'index': indexInInline };\n            }\n            count += inlineElement.length;\n        }\n        if (offset > count) {\n            indexInInline = isNullOrUndefined(inlineElement) ? offset : inlineElement.length;\n        }\n        return { 'element': inlineElement, 'index': indexInInline };\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.getHierarchicalIndex = function (hierarchicalIndex) {\n        var node = this;\n        hierarchicalIndex = node.paragraph.childWidgets.indexOf(node) + ';' + hierarchicalIndex;\n        if (node.paragraph instanceof BlockWidget) {\n            return node.paragraph.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.clone = function () {\n        var line = new LineWidget(undefined);\n        for (var j = 0; j < this.children.length; j++) {\n            var element = this.children[j];\n            var clone = element.clone();\n            line.children.push(clone);\n            clone.line = line;\n        }\n        line.width = this.width;\n        line.height = this.height;\n        return line;\n    };\n    /**\n     * @private\n     */\n    LineWidget.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.children)) {\n            for (var i = 0; i < this.children.length; i++) {\n                this.children[i].destroy();\n            }\n            this.children = [];\n        }\n        this.children = undefined;\n        if (this.paragraph) {\n            this.paragraph.removeChild(this.indexInOwner);\n        }\n        this.paragraph = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return LineWidget;\n}());\nexport { LineWidget };\n/**\n * @private\n */\nvar ElementBox = /** @class */ (function () {\n    /**\n     * Initialize the constructor of ElementBox\n     */\n    function ElementBox() {\n        /**\n         * @private\n         */\n        this.x = 0;\n        /**\n         * @private\n         */\n        this.y = 0;\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        /**\n         * @private\n         */\n        this.margin = new Margin(0, 0, 0, 0);\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        this.characterFormat = new WCharacterFormat(this);\n        this.margin = new Margin(0, 0, 0, 0);\n    }\n    Object.defineProperty(ElementBox.prototype, \"isPageBreak\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this instanceof TextElementBox) {\n                return this.text === '\\f';\n            }\n            return false;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldCharacter = function (viewer) {\n        if (!(this instanceof FieldElementBox)) {\n            return;\n        }\n        if (this.fieldType === 0) {\n            var fieldBegin = this;\n            if (isNullOrUndefined(fieldBegin.fieldEnd)) {\n                this.linkFieldTraversingForward(this.line, fieldBegin, fieldBegin);\n                if (viewer.fields.indexOf(fieldBegin) === -1) {\n                    viewer.fields.push(fieldBegin);\n                }\n            }\n        }\n        else if (this.fieldType === 2) {\n            var fieldSeparator = this;\n            //Links the field begin for the current separator.\n            if (isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                this.linkFieldTraversingBackwardSeparator(this.line, fieldSeparator, fieldSeparator);\n            }\n            fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n            if (!isNullOrUndefined(fieldSeparator.fieldBegin)) {\n                //Links to field end traversing from field separator.\n                var isFieldEnd = this.linkFieldTraversingForward(this.line, fieldSeparator.fieldBegin, fieldSeparator);\n                if (isNullOrUndefined(fieldSeparator.fieldEnd) && isFieldEnd) {\n                    fieldSeparator.fieldEnd = fieldSeparator.fieldBegin.fieldEnd;\n                }\n                if (fieldSeparator.fieldEnd) {\n                    fieldSeparator.fieldEnd.fieldSeparator = fieldSeparator;\n                }\n            }\n        }\n        else {\n            var fieldEnd = this;\n            //Links the field begin and separator for the current end.\n            if (isNullOrUndefined(fieldEnd.fieldBegin)) {\n                this.linkFieldTraversingBackward(this.line, fieldEnd, fieldEnd);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackward = function (line, fieldEnd, previousNode) {\n        var k = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            k = line.children.indexOf(previousNode) - 1;\n        }\n        for (var j = k; j >= 0; j--) {\n            var childNode = line.children[j];\n            if (childNode instanceof FieldElementBox) {\n                if (childNode.fieldType === 0) {\n                    if (isNullOrUndefined(childNode.fieldEnd)) {\n                        fieldEnd.fieldBegin = childNode;\n                        if (isNullOrUndefined(childNode.fieldEnd)) {\n                            childNode.fieldEnd = fieldEnd;\n                        }\n                        if (fieldEnd.fieldSeparator && isNullOrUndefined(fieldEnd.fieldSeparator.fieldBegin)) {\n                            fieldEnd.fieldSeparator.fieldBegin = childNode;\n                            if (isNullOrUndefined(childNode.fieldSeparator)) {\n                                childNode.fieldSeparator = fieldEnd.fieldSeparator;\n                            }\n                        }\n                    }\n                    return !isNullOrUndefined(fieldEnd.fieldBegin);\n                }\n                else if (childNode.fieldType === 2 && isNullOrUndefined(childNode.fieldEnd)) {\n                    fieldEnd.fieldSeparator = childNode;\n                    childNode.fieldEnd = fieldEnd;\n                    if (!isNullOrUndefined(childNode.fieldBegin)) {\n                        fieldEnd.fieldBegin = childNode.fieldBegin;\n                    }\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackward(line.previousLine, fieldEnd, this);\n        }\n        else if (line.paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n            var prevParagraph = line.paragraph.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            this.linkFieldTraversingBackward(prevParagraph.childWidgets[prevParagraph.childWidgets.length - 1], fieldEnd, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingForward = function (line, fieldBegin, previousNode) {\n        var i = 0;\n        if (line.children.indexOf(previousNode) > -1) {\n            i = line.children.indexOf(previousNode) + 1;\n        }\n        for (var j = i; j < line.children.length; j++) {\n            var node = line.children[j];\n            if (node instanceof FieldElementBox) {\n                if (node.fieldType === 1) {\n                    if (isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldEnd = node;\n                    }\n                    if (fieldBegin.fieldEnd && isNullOrUndefined(fieldBegin.fieldEnd.fieldBegin)) {\n                        fieldBegin.fieldEnd.fieldBegin = fieldBegin;\n                    }\n                    return true;\n                }\n                else if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    if (node.fieldType === 2 && isNullOrUndefined(node.fieldBegin)) {\n                        fieldBegin.fieldSeparator = node;\n                        if (!isNullOrUndefined(node.fieldEnd)) {\n                            fieldBegin.fieldEnd = node.fieldEnd;\n                            return true;\n                        }\n                    }\n                    else {\n                        return false;\n                    }\n                }\n            }\n        }\n        if (line.nextLine) {\n            this.linkFieldTraversingForward(line.nextLine, fieldBegin, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            this.linkFieldTraversingForward(line.paragraph.nextRenderedWidget.childWidgets[0], fieldBegin, this);\n        }\n        return true;\n    };\n    /**\n     * @private\n     */\n    ElementBox.prototype.linkFieldTraversingBackwardSeparator = function (line, fieldSeparator, previousNode) {\n        var index = line.children.length - 1;\n        if (line.children.indexOf(previousNode) > -1) {\n            index = line.children.indexOf(previousNode) - 1;\n        }\n        for (var i = index; i >= 0; i--) {\n            var childElement = line.children[i];\n            if (childElement instanceof FieldElementBox) {\n                if (childElement instanceof FieldElementBox && childElement.fieldType === 0) {\n                    if (isNullOrUndefined(childElement.fieldSeparator)) {\n                        fieldSeparator.fieldBegin = childElement;\n                    }\n                    return !isNullOrUndefined(fieldSeparator.fieldBegin);\n                }\n            }\n        }\n        if (line.previousLine) {\n            this.linkFieldTraversingBackwardSeparator(line.previousLine, fieldSeparator, this);\n        }\n        else if (line.paragraph.nextRenderedWidget instanceof ParagraphWidget) {\n            // tslint:disable-next-line:max-line-length\n            line = line.paragraph.previousRenderedWidget.childWidgets[line.paragraph.previousRenderedWidget.childWidgets.length - 1];\n            this.linkFieldTraversingBackwardSeparator(line, fieldSeparator, this);\n        }\n        else {\n            return true;\n        }\n        return true;\n    };\n    Object.defineProperty(ElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.getLength();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"indexInOwner\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.line instanceof LineWidget && this.line.children ? this.line.children.indexOf(this) : -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > 0 && index < this.line.children.length) {\n                return this.line.children[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextElement\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.indexInOwner;\n            if (index > -1 && index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"nextNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index < this.line.children.length - 1) {\n                return this.line.children[index + 1];\n            }\n            else if (lineIndex < this.line.paragraph.childWidgets.length - 1) {\n                return this.line.paragraph.childWidgets[lineIndex + 1].children[0];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"previousNode\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.line.children.indexOf(this);\n            var lineIndex = this.line.paragraph.childWidgets.indexOf(this.line);\n            if (index > 0) {\n                return this.line.children[index - 1];\n            }\n            else if (lineIndex > 0) {\n                var lineWidget = this.line.paragraph.childWidgets[lineIndex - 1];\n                return lineWidget.children[lineWidget.children.length - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ElementBox.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.line) {\n                return this.line.paragraph;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ElementBox.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.line) && this.line.children && this.line.children.indexOf(this) > -1) {\n            var index = this.line.children.indexOf(this);\n            this.line.children.splice(index, 1);\n        }\n        this.line = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n        }\n        this.characterFormat = undefined;\n        if (this.margin) {\n            this.margin.destroy();\n        }\n        this.margin = undefined;\n        this.x = undefined;\n        this.y = undefined;\n        this.width = undefined;\n        this.height = undefined;\n    };\n    /**\n     * @private\n     */\n    ElementBox.objectCharacter = String.fromCharCode(65532);\n    return ElementBox;\n}());\nexport { ElementBox };\n/**\n * @private\n */\nvar FieldElementBox = /** @class */ (function (_super) {\n    __extends(FieldElementBox, _super);\n    function FieldElementBox(type) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.fieldType = 0;\n        /**\n         * @private\n         */\n        _this.hasFieldEnd = false;\n        _this.fieldBeginInternal = undefined;\n        _this.fieldSeparatorInternal = undefined;\n        _this.fieldEndInternal = undefined;\n        _this.fieldType = type;\n        return _this;\n    }\n    Object.defineProperty(FieldElementBox.prototype, \"fieldBegin\", {\n        get: function () {\n            return this.fieldBeginInternal;\n        },\n        set: function (field) {\n            this.fieldBeginInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldSeparator\", {\n        get: function () {\n            return this.fieldSeparatorInternal;\n        },\n        set: function (field) {\n            this.fieldSeparatorInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(FieldElementBox.prototype, \"fieldEnd\", {\n        get: function () {\n            return this.fieldEndInternal;\n        },\n        set: function (field) {\n            this.fieldEndInternal = field;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.clone = function () {\n        var field = new FieldElementBox(this.fieldType);\n        field.characterFormat.copyFormat(this.characterFormat);\n        if (this.margin) {\n            field.margin = this.margin.clone();\n        }\n        field.width = this.width;\n        field.height = this.height;\n        return field;\n    };\n    /**\n     * @private\n     */\n    FieldElementBox.prototype.destroy = function () {\n        this.fieldType = undefined;\n        this.hasFieldEnd = undefined;\n        this.fieldBeginInternal = undefined;\n        this.fieldEndInternal = undefined;\n        this.fieldSeparatorInternal = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return FieldElementBox;\n}(ElementBox));\nexport { FieldElementBox };\n/**\n * @private\n */\nvar TextElementBox = /** @class */ (function (_super) {\n    __extends(TextElementBox, _super);\n    function TextElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.text = '';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.clone = function () {\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    /**\n     * @private\n     */\n    TextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return TextElementBox;\n}(ElementBox));\nexport { TextElementBox };\n/**\n * @private\n */\nvar FieldTextElementBox = /** @class */ (function (_super) {\n    __extends(FieldTextElementBox, _super);\n    function FieldTextElementBox() {\n        var _this = _super.call(this) || this;\n        _this.fieldText = '';\n        return _this;\n    }\n    Object.defineProperty(FieldTextElementBox.prototype, \"text\", {\n        get: function () {\n            return this.fieldText;\n        },\n        set: function (value) {\n            this.fieldText = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FieldTextElementBox.prototype.clone = function () {\n        var span = new FieldTextElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.fieldBegin = this.fieldBegin;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return FieldTextElementBox;\n}(TextElementBox));\nexport { FieldTextElementBox };\n/**\n * @private\n */\nvar TabElementBox = /** @class */ (function (_super) {\n    __extends(TabElementBox, _super);\n    function TabElementBox() {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.tabText = '';\n        /**\n         * @private\n         */\n        _this.tabLeader = 'None';\n        return _this;\n    }\n    /**\n     * @private\n     */\n    TabElementBox.prototype.destroy = function () {\n        this.tabText = undefined;\n        this.tabLeader = undefined;\n    };\n    /**\n     * @private\n     */\n    TabElementBox.prototype.clone = function () {\n        var span = new TabElementBox();\n        span.characterFormat.copyFormat(this.characterFormat);\n        span.tabText = this.tabText;\n        span.tabLeader = this.tabLeader;\n        span.text = this.text;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return TabElementBox;\n}(TextElementBox));\nexport { TabElementBox };\n/**\n * @private\n */\nvar BookmarkElementBox = /** @class */ (function (_super) {\n    __extends(BookmarkElementBox, _super);\n    function BookmarkElementBox(type) {\n        var _this = _super.call(this) || this;\n        _this.bookmarkTypeIn = 0;\n        _this.refereneceIn = undefined;\n        _this.nameIn = '';\n        _this.bookmarkTypeIn = type;\n        return _this;\n    }\n    Object.defineProperty(BookmarkElementBox.prototype, \"bookmarkType\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.bookmarkTypeIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"name\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.nameIn;\n        },\n        /**\n         * @private\n         */\n        set: function (name) {\n            this.nameIn = name;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BookmarkElementBox.prototype, \"reference\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.refereneceIn;\n        },\n        /**\n         * @private\n         */\n        set: function (reference) {\n            this.refereneceIn = reference;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.destroy = function () {\n        this.name = undefined;\n        this.reference = undefined;\n        this.bookmarkTypeIn = undefined;\n    };\n    /**\n     * Clones the bookmark element box.\n     * @param element - book mark element\n     */\n    /**\n     * @private\n     */\n    BookmarkElementBox.prototype.clone = function () {\n        var span = new BookmarkElementBox(this.bookmarkType);\n        span.name = this.name;\n        span.reference = this.reference;\n        if (this.margin) {\n            span.margin = this.margin.clone();\n        }\n        span.width = this.width;\n        span.height = this.height;\n        return span;\n    };\n    return BookmarkElementBox;\n}(ElementBox));\nexport { BookmarkElementBox };\n/**\n * @private\n */\nvar ImageElementBox = /** @class */ (function (_super) {\n    __extends(ImageElementBox, _super);\n    function ImageElementBox(isInlineImage) {\n        var _this = _super.call(this) || this;\n        _this.imageStr = '';\n        _this.imgElement = undefined;\n        _this.isInlineImageIn = true;\n        /**\n         * @private\n         */\n        _this.isMetaFile = false;\n        _this.isInlineImageIn = isInlineImage;\n        return _this;\n    }\n    Object.defineProperty(ImageElementBox.prototype, \"isInlineImage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.isInlineImageIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"element\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.imgElement)) {\n                this.imgElement = document.createElement('img');\n            }\n            return this.imgElement;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"length\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageElementBox.prototype, \"imageString\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.imageStr;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.imageStr = value;\n            if (!isNullOrUndefined(value)) {\n                this.element.src = this.imageStr;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.getLength = function () {\n        return 1;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.clone = function () {\n        var image = new ImageElementBox(this.isInlineImage);\n        image.characterFormat.copyFormat(this.characterFormat);\n        image.imageString = this.imageString;\n        image.isMetaFile = this.isMetaFile;\n        image.width = this.width;\n        image.height = this.height;\n        if (this.margin) {\n            image.margin = this.margin.clone();\n        }\n        return image;\n    };\n    /**\n     * @private\n     */\n    ImageElementBox.prototype.destroy = function () {\n        this.imgElement = undefined;\n        this.imageString = undefined;\n        this.isInlineImageIn = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ImageElementBox;\n}(ElementBox));\nexport { ImageElementBox };\n/**\n * @private\n */\nvar ListTextElementBox = /** @class */ (function (_super) {\n    __extends(ListTextElementBox, _super);\n    function ListTextElementBox(listLevel, isListFollowCharacter) {\n        var _this = _super.call(this) || this;\n        /**\n         * @private\n         */\n        _this.baselineOffset = 0;\n        /**\n         * @private\n         */\n        _this.isFollowCharacter = false;\n        _this.listLevel = listLevel;\n        _this.isFollowCharacter = isListFollowCharacter;\n        return _this;\n    }\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.getLength = function () {\n        return this.text ? this.text.length : 0;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.clone = function () {\n        var list = new ListTextElementBox(this.listLevel, this.isFollowCharacter);\n        list.text = this.text;\n        list.baselineOffset = this.baselineOffset;\n        if (this.margin) {\n            list.margin = this.margin.clone();\n        }\n        list.width = this.width;\n        list.height = this.height;\n        return list;\n    };\n    /**\n     * @private\n     */\n    ListTextElementBox.prototype.destroy = function () {\n        this.text = undefined;\n        _super.prototype.destroy.call(this);\n    };\n    return ListTextElementBox;\n}(ElementBox));\nexport { ListTextElementBox };\n/**\n * @private\n */\nvar Page = /** @class */ (function () {\n    /**\n     * Initialize the constructor of Page\n     */\n    function Page() {\n        /**\n         * Specifies the Bonding Rectangle\n         * @private\n         */\n        this.boundingRectangle = new Rect(96, 96, 816, 1056);\n        /**\n         * @private\n         */\n        this.repeatHeaderRowTableWidget = false;\n        /**\n         * Specifies the bodyWidgets\n         * @default []\n         * @private\n         */\n        this.bodyWidgets = [];\n        /**\n         * @private\n         */\n        this.headerWidget = undefined;\n        /**\n         * @private\n         */\n        this.footerWidget = undefined;\n        // let text: string = 'DocumentEditor';\n    }\n    Object.defineProperty(Page.prototype, \"index\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.pages.indexOf(this);\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"previousPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index > 0) {\n                return this.viewer.pages[index - 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"nextPage\", {\n        /**\n         * @private\n         */\n        get: function () {\n            var index = this.index;\n            if (index < this.viewer.pages.length - 1) {\n                return this.viewer.pages[index + 1];\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Page.prototype, \"sectionIndex\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.bodyWidgets.length > 0) {\n                return this.bodyWidgets[0].index;\n            }\n            return -1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Page.prototype.destroy = function () {\n        if (this.headerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.headerWidget);\n            }\n            this.headerWidget.destroy();\n        }\n        this.headerWidget = undefined;\n        if (this.footerWidget) {\n            if (this.viewer && this.viewer.owner.editor) {\n                this.viewer.owner.editor.removeFieldInWidget(this.footerWidget);\n            }\n            this.footerWidget.destroy();\n        }\n        this.footerWidget = undefined;\n        this.bodyWidgets = [];\n        this.bodyWidgets = undefined;\n        if (!isNullOrUndefined(this.viewer)) {\n            if (!isNullOrUndefined(this.viewer.pages)) {\n                this.viewer.removePage(this);\n            }\n        }\n        this.viewer = undefined;\n    };\n    return Page;\n}());\nexport { Page };\n/**\n * @private\n */\nvar WTableHolder = /** @class */ (function () {\n    function WTableHolder() {\n        this.tableColumns = [];\n        /**\n         * @private\n         */\n        this.tableWidth = 0;\n    }\n    Object.defineProperty(WTableHolder.prototype, \"columns\", {\n        get: function () {\n            return this.tableColumns;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WTableHolder.prototype.resetColumns = function () {\n        for (var i = 0; i < this.tableColumns.length; i++) {\n            this.tableColumns[i].destroy();\n        }\n        this.tableColumns = [];\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getPreviousSpannedCellWidth = function (previousColumnIndex, curColumnIndex) {\n        var width = 0;\n        for (var i = previousColumnIndex; i < curColumnIndex; i++) {\n            width += this.tableColumns[i].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.addColumns = function (currentColumnIndex, columnSpan, width, minWidth, offset) {\n        for (var i = this.columns.length; i < columnSpan; i++) {\n            this.columns.push(new WColumn());\n        }\n        var availableWidth = 0;\n        for (var j = currentColumnIndex; j < columnSpan; j++) {\n            availableWidth += this.columns[j].preferredWidth;\n        }\n        // If width to add is greater than preferred width, then preferred width will be increased.\n        // In case of Gridspan > 1, only last grid column width will be updated.\n        var gridSpan = columnSpan - currentColumnIndex;\n        if (!(gridSpan > 1) && availableWidth < width) {\n            this.columns[columnSpan - 1].preferredWidth += (width - availableWidth);\n        }\n        if (minWidth > this.columns[columnSpan - 1].minWidth) {\n            this.columns[columnSpan - 1].minWidth = minWidth;\n        }\n        if (offset > this.columns[columnSpan - 1].endOffset) {\n            this.columns[columnSpan - 1].endOffset = offset;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getTotalWidth = function () {\n        var width = 0;\n        for (var i = 0; i < this.columns.length; i++) {\n            var column = this.columns[i];\n            width += column.preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.isFitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            factor = isNaN(factor) ? 1 : factor;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                //column.PreferredWidth = factor * column.PreferredWidth;\n                if (factor * column.preferredWidth < column.minWidth) {\n                    return false;\n                }\n            }\n            return true;\n        }\n        else {\n            return true;\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.fitColumns = function (containerWidth, preferredTableWidth, isAutoWidth) {\n        // Gets total preferred width.\n        var totalColumnWidth = this.getTotalWidth();\n        // If auto table width, based on total column widths, minimum value will be updated.\n        if (isAutoWidth) {\n            this.tableWidth = preferredTableWidth > totalColumnWidth ? totalColumnWidth : preferredTableWidth;\n        }\n        else {\n            this.tableWidth = preferredTableWidth;\n        }\n        // If total columns width doesn't match table width, then all grid column widths will be updated by even factor.\n        // If totalColumnWidth < TableWidth, all grid columns are enlarged. Otherwise shrinked.\n        if (totalColumnWidth !== this.tableWidth) {\n            var factor = this.tableWidth / totalColumnWidth;\n            for (var i = 0; i < this.columns.length; i++) {\n                var column = this.columns[i];\n                column.preferredWidth = factor * column.preferredWidth;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.getCellWidth = function (columnIndex, columnSpan, preferredTableWidth, isAutoWidth) {\n        var width = 0;\n        for (var i = 0; i < columnSpan; i++) {\n            width += this.tableColumns[i + columnIndex].preferredWidth;\n        }\n        return width;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.validateColumnWidths = function () {\n        for (var i = 0; i < this.columns.length; i++) {\n            if (i === 0) {\n                if (this.columns[i].preferredWidth !== this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset;\n                }\n            }\n            else {\n                // If Previous column offset + current column preferred width is less than current column offset, \n                // Then current column preferred width is set to current column offset - previous column offset.\n                if (this.columns[i - 1].endOffset + this.columns[i].preferredWidth < this.columns[i].endOffset) {\n                    this.columns[i].preferredWidth = this.columns[i].endOffset - this.columns[i - 1].endOffset;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.clone = function () {\n        var tableHolder = new WTableHolder();\n        tableHolder.tableWidth = this.tableWidth;\n        for (var i = 0; i < this.columns.length; i++) {\n            tableHolder.columns.push(this.columns[i].clone());\n        }\n        return tableHolder;\n    };\n    /**\n     * @private\n     */\n    WTableHolder.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.tableColumns)) {\n            for (var i = 0; i < this.tableColumns.length; i++) {\n                var column = this.tableColumns[i];\n                column.destroy();\n            }\n        }\n        this.tableColumns = [];\n        this.tableColumns = undefined;\n        this.tableWidth = undefined;\n    };\n    return WTableHolder;\n}());\nexport { WTableHolder };\n/**\n * @private\n */\nvar WColumn = /** @class */ (function () {\n    function WColumn() {\n        /**\n         * @private\n         */\n        this.preferredWidth = 0;\n        /**\n         * @private\n         */\n        this.minWidth = 0;\n        /**\n         * @private\n         */\n        this.maxWidth = 0;\n        /**\n         * @private\n         */\n        this.endOffset = 0;\n    }\n    /**\n     * @private\n     */\n    WColumn.prototype.clone = function () {\n        var column = new WColumn();\n        column.preferredWidth = this.preferredWidth;\n        column.minWidth = this.minWidth;\n        column.maxWidth = this.maxWidth;\n        return column;\n    };\n    /**\n     * @private\n     */\n    WColumn.prototype.destroy = function () {\n        this.preferredWidth = undefined;\n        this.minWidth = undefined;\n        this.maxWidth = undefined;\n    };\n    return WColumn;\n}());\nexport { WColumn };\n","import { ContextMenu as Menu } from '@syncfusion/ej2-navigations';\nimport { isNullOrUndefined, L10n, setCulture, classList } from '@syncfusion/ej2-base';\nimport { FieldElementBox } from './viewer/page';\nvar CONTEXTMENU_COPY = '_contextmenu_copy';\nvar CONTEXTMENU_CUT = '_contextmenu_cut';\nvar CONTEXTMENU_PASTE = '_contextmenu_paste';\nvar CONTEXTMENU_UPDATE_FIELD = '_contextmenu_update_field';\nvar CONTEXTMENU_EDIT_FIELD = '_contextmenu_edit_field';\nvar CONTEXTMENU_HYPERLINK = '_contextmenu_hyperlink';\nvar CONTEXTMENU_OPEN_HYPERLINK = '_contextmenu_open_hyperlink';\nvar CONTEXTMENU_COPY_HYPERLINK = '_contextmenu_copy_hyperlink';\nvar CONTEXTMENU_REMOVE_HYPERLINK = '_contextmenu_remove_hyperlink';\nvar CONTEXTMENU_EDIT_HYPERLINK = '_contextmenu_edit_hyperlink';\nvar CONTEXTMENU_FONT_DIALOG = '_contextmenu_font_dialog';\nvar CONTEXTMENU_PARAGRAPH = '_contextmenu_paragraph_dialog';\nvar CONTEXTMENU_TABLE = '_contextmenu_table_dialog';\nvar CONTEXTMENU_INSERT_TABLE = '_contextmenu_insert_table';\nvar CONTEXTMENU_DELETE_TABLE = '_contextmenu_delete_table';\nvar CONTEXTMENU_INSERT_ABOVE = '_contextmenu_insert_above';\nvar CONTEXTMENU_INSERT_BELOW = '_contextmenu_insert_below';\nvar CONTEXTMENU_INSERT_RIGHT = '_contextmenu_insert_right';\nvar CONTEXTMENU_INSERT_LEFT = '_contextmenu_insert_left';\nvar CONTEXTMENU_COMPLETE_DELETE_TABLE = '_contextmenu_complete_table_delete';\nvar CONTEXTMENU_DELETE_ROW = '_contextmenu_delete_row';\nvar CONTEXTMENU_DELETE_COLUMN = '_contextmenu_delete_column';\nvar CONTEXTMENU_MERGE_CELL = '_contextmenu_merge_cell';\nvar CONTEXTMENU_CONTINUE_NUMBERING = '_contextmenu_continue_numbering';\nvar CONTEXTMENU_RESTART_AT = '_contextmenu_restart_at';\n/**\n * Context Menu class\n */\nvar ContextMenu = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ContextMenu(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.contextMenuInstance = undefined;\n        /**\n         * Handles on context menu key pressed.\n         * @param  {PointerEvent} event\n         * @private\n         */\n        this.onContextMenuInternal = function (event) {\n            if (_this.showHideElements(_this.viewer.selection)) {\n                _this.contextMenuInstance.open(event.y, event.x);\n                event.preventDefault();\n            }\n        };\n        this.viewer = viewer;\n        var locale = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n        locale.setLocale(this.viewer.owner.locale);\n        setCulture(this.viewer.owner.locale);\n        this.initContextMenu(locale);\n    }\n    /**\n     * Gets module name.\n     */\n    ContextMenu.prototype.getModuleName = function () {\n        return 'ContextMenu';\n    };\n    /**\n     * Initialize context menu.\n     * @param localValue Localize value.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ContextMenu.prototype.initContextMenu = function (localValue) {\n        var _this = this;\n        var id = this.viewer.owner.element.id;\n        this.contextMenu = document.createElement('div');\n        this.contextMenu.id = this.viewer.owner.containerId + 'e-de-contextmenu';\n        document.body.appendChild(this.contextMenu);\n        var ul = document.createElement('ul');\n        ul.style.width = 'auto';\n        ul.id = this.viewer.owner.containerId + 'e-de-contextmenu-list';\n        ul.style.listStyle = 'none';\n        ul.style.margin = '0px';\n        ul.style.padding = '0px';\n        ul.style.maxHeight = 'auto';\n        ul.oncontextmenu = this.disableBrowserContextmenu;\n        this.contextMenu.appendChild(ul);\n        var menuItems = [\n            {\n                text: localValue.getConstant('Cut'),\n                iconCss: 'e-icons e-de-cut',\n                id: id + CONTEXTMENU_CUT\n            },\n            {\n                text: localValue.getConstant('Copy'),\n                iconCss: 'e-icons e-de-copy',\n                id: id + CONTEXTMENU_COPY\n            },\n            {\n                text: localValue.getConstant('Paste'),\n                iconCss: 'e-icons e-de-paste',\n                id: id + CONTEXTMENU_PASTE\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Update Field'),\n                iconCss: 'e-icons e-de-update_field',\n                id: id + CONTEXTMENU_UPDATE_FIELD\n            },\n            {\n                text: localValue.getConstant('Edit Field'),\n                iconCss: 'e-icons e-de-edit_field',\n                id: id + CONTEXTMENU_EDIT_FIELD\n            },\n            {\n                text: localValue.getConstant('Continue Numbering'),\n                iconCss: 'e-icons e-de-continue-numbering',\n                id: id + CONTEXTMENU_CONTINUE_NUMBERING\n            },\n            {\n                text: localValue.getConstant('Restart At') + ' 1',\n                iconCss: 'e-icons e-de-restart-at',\n                id: id + CONTEXTMENU_RESTART_AT\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Hyperlink'),\n                iconCss: 'e-icons e-de-insertlink',\n                id: id + CONTEXTMENU_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Edit Hyperlink') + '...',\n                iconCss: 'e-icons e-de-edit-hyperlink',\n                id: id + CONTEXTMENU_EDIT_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Open Hyperlink'),\n                iconCss: 'e-icons e-de-open-hyperlink',\n                id: id + CONTEXTMENU_OPEN_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Copy Hyperlink'),\n                iconCss: 'e-icons e-de-copy-hyperlink',\n                id: id + CONTEXTMENU_COPY_HYPERLINK\n            },\n            {\n                text: localValue.getConstant('Remove Hyperlink'),\n                iconCss: 'e-icons e-de-remove-hyperlink',\n                id: id + CONTEXTMENU_REMOVE_HYPERLINK\n            },\n            {\n                separator: true\n            },\n            {\n                text: localValue.getConstant('Font'),\n                iconCss: 'e-icons e-de-fonts',\n                id: id + CONTEXTMENU_FONT_DIALOG\n            },\n            {\n                text: localValue.getConstant('Paragraph'),\n                iconCss: 'e-icons e-de-paragraph',\n                id: id + CONTEXTMENU_PARAGRAPH\n            },\n            {\n                separator: true,\n            },\n            {\n                text: localValue.getConstant('Table Properties'),\n                id: id + CONTEXTMENU_TABLE,\n                iconCss: 'e-icons e-de-table'\n            },\n            {\n                text: localValue.getConstant('Merge Cells'),\n                id: id + CONTEXTMENU_MERGE_CELL,\n                iconCss: 'e-icons e-de-icon-table-merge-cells'\n            },\n            {\n                text: localValue.getConstant('Insert'),\n                id: id + CONTEXTMENU_INSERT_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Insert Above'),\n                        id: id + CONTEXTMENU_INSERT_ABOVE,\n                        iconCss: 'e-icons e-de-insertabove'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Below'),\n                        id: id + CONTEXTMENU_INSERT_BELOW,\n                        iconCss: 'e-icons e-de-insertbelow'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Left'),\n                        id: id + CONTEXTMENU_INSERT_LEFT,\n                        iconCss: 'e-icons e-de-insertleft'\n                    },\n                    {\n                        text: localValue.getConstant('Insert Right'),\n                        id: id + CONTEXTMENU_INSERT_RIGHT,\n                        iconCss: 'e-icons e-de-insertright'\n                    }\n                ]\n            },\n            {\n                text: localValue.getConstant('Delete'),\n                id: id + CONTEXTMENU_DELETE_TABLE,\n                iconCss: 'e-icons',\n                items: [\n                    {\n                        text: localValue.getConstant('Delete Table'),\n                        id: id + CONTEXTMENU_COMPLETE_DELETE_TABLE,\n                        iconCss: 'e-icons e-de-delete-table'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Row'),\n                        id: id + CONTEXTMENU_DELETE_ROW,\n                        iconCss: 'e-icons e-de-deleterow'\n                    },\n                    {\n                        text: localValue.getConstant('Delete Column'),\n                        id: id + CONTEXTMENU_DELETE_COLUMN,\n                        iconCss: 'e-icons e-de-deletecolumn'\n                    }\n                ]\n            },\n        ];\n        var menuOptions = {\n            target: '#' + this.viewer.owner.containerId + 'e-de-contextmenu',\n            items: menuItems,\n            select: function (args) {\n                var item = args.element.id;\n                _this.handleContextMenuItem(item);\n            },\n        };\n        this.contextMenuInstance = new Menu(menuOptions, '#' + this.viewer.owner.containerId + 'e-de-contextmenu-list');\n        this.contextMenuInstance.beforeOpen = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, [], ['e-de-cursor-animation']);\n                _this.viewer.selection.showCaret();\n            }\n        };\n        this.contextMenuInstance.onClose = function () {\n            if (_this.viewer && _this.viewer.selection) {\n                classList(_this.viewer.selection.caret, ['e-de-cursor-animation'], []);\n                _this.viewer.updateFocus();\n            }\n        };\n    };\n    /**\n     * Disable browser context menu.\n     */\n    ContextMenu.prototype.disableBrowserContextmenu = function () {\n        return false;\n    };\n    /**\n     * Handles context menu items.\n     * @param  {string} item Specifies which item is selected.\n     * @private\n     */\n    ContextMenu.prototype.handleContextMenuItem = function (item) {\n        var id = this.viewer.owner.element.id;\n        switch (item) {\n            case id + CONTEXTMENU_COPY:\n                this.viewer.selection.copy();\n                break;\n            case id + CONTEXTMENU_CUT:\n                this.viewer.owner.editor.cut();\n                break;\n            case id + CONTEXTMENU_PASTE:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.pasteInternal(undefined);\n                }\n                break;\n            case id + CONTEXTMENU_UPDATE_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.editorModule.updateToc();\n                }\n                break;\n            case id + CONTEXTMENU_EDIT_FIELD:\n                if (!this.viewer.owner.isReadOnlyMode) {\n                    this.viewer.owner.tableOfContentsDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_FONT_DIALOG:\n                if (this.viewer.owner.fontDialogModule) {\n                    this.viewer.owner.fontDialogModule.showFontDialog();\n                }\n                break;\n            case id + CONTEXTMENU_OPEN_HYPERLINK:\n                this.viewer.selection.navigateHyperlink();\n                break;\n            case id + CONTEXTMENU_COPY_HYPERLINK:\n                this.viewer.selection.copyHyperlink();\n                break;\n            case id + CONTEXTMENU_EDIT_HYPERLINK:\n            case id + CONTEXTMENU_HYPERLINK:\n                if (this.viewer.owner.hyperlinkDialogModule) {\n                    this.viewer.owner.hyperlinkDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_REMOVE_HYPERLINK:\n                this.viewer.owner.editor.removeHyperlink();\n                break;\n            case id + CONTEXTMENU_PARAGRAPH:\n                if (this.viewer.owner.paragraphDialogModule) {\n                    this.viewer.owner.paragraphDialogModule.show();\n                }\n                break;\n            case id + CONTEXTMENU_TABLE:\n                this.viewer.owner.tablePropertiesDialogModule.show();\n                break;\n            case id + CONTEXTMENU_MERGE_CELL:\n                this.viewer.owner.editor.mergeCells();\n                break;\n            case id + CONTEXTMENU_INSERT_ABOVE:\n                this.viewer.owner.editor.insertRow(true);\n                break;\n            case id + CONTEXTMENU_INSERT_BELOW:\n                this.viewer.owner.editor.insertRow(false);\n                break;\n            case id + CONTEXTMENU_INSERT_LEFT:\n                this.viewer.owner.editor.insertColumn(true);\n                break;\n            case id + CONTEXTMENU_INSERT_RIGHT:\n                this.viewer.owner.editor.insertColumn(false);\n                break;\n            case id + CONTEXTMENU_COMPLETE_DELETE_TABLE:\n                this.viewer.owner.editor.deleteTable();\n                break;\n            case id + CONTEXTMENU_DELETE_ROW:\n                this.viewer.owner.editor.deleteRow();\n                break;\n            case id + CONTEXTMENU_DELETE_COLUMN:\n                this.viewer.owner.editor.deleteColumn();\n                break;\n            case id + CONTEXTMENU_CONTINUE_NUMBERING:\n                this.viewer.owner.editorModule.applyContinueNumbering(this.viewer.selection);\n                break;\n            case id + CONTEXTMENU_RESTART_AT:\n                this.viewer.owner.editorModule.applyRestartNumbering(this.viewer.selection);\n                break;\n        }\n    };\n    ContextMenu.prototype.showHideElements = function (selection) {\n        var owner = this.viewer.owner;\n        var id = owner.element.id;\n        var copy = document.getElementById(id + CONTEXTMENU_COPY);\n        var cut = document.getElementById(id + CONTEXTMENU_CUT);\n        var paste = document.getElementById(id + CONTEXTMENU_PASTE);\n        var updateField = document.getElementById(id + CONTEXTMENU_UPDATE_FIELD);\n        var editField = document.getElementById(id + CONTEXTMENU_EDIT_FIELD);\n        var font = document.getElementById(id + CONTEXTMENU_FONT_DIALOG);\n        var paragraph = document.getElementById(id + CONTEXTMENU_PARAGRAPH);\n        var tableProperties = document.getElementById(id + CONTEXTMENU_TABLE);\n        var insertTable = document.getElementById(id + CONTEXTMENU_INSERT_TABLE);\n        var deleteTable = document.getElementById(id + CONTEXTMENU_DELETE_TABLE);\n        var mergeCells = document.getElementById(id + CONTEXTMENU_MERGE_CELL);\n        var hyperlink = document.getElementById(id + CONTEXTMENU_HYPERLINK);\n        var openHyperlink = document.getElementById(id + CONTEXTMENU_OPEN_HYPERLINK);\n        var editHyperlink = document.getElementById(id + CONTEXTMENU_EDIT_HYPERLINK);\n        var copyHyperlink = document.getElementById(id + CONTEXTMENU_COPY_HYPERLINK);\n        var removeHyperlink = document.getElementById(id + CONTEXTMENU_REMOVE_HYPERLINK);\n        var continueNumbering = document.getElementById(id + CONTEXTMENU_CONTINUE_NUMBERING);\n        var restartAt = document.getElementById(id + CONTEXTMENU_RESTART_AT);\n        cut.style.display = 'none';\n        paste.style.display = 'none';\n        paste.nextSibling.style.display = 'none';\n        hyperlink.style.display = 'none';\n        openHyperlink.style.display = 'none';\n        copyHyperlink.style.display = 'none';\n        editHyperlink.style.display = 'none';\n        removeHyperlink.style.display = 'none';\n        removeHyperlink.nextSibling.style.display = 'none';\n        mergeCells.style.display = 'none';\n        font.style.display = 'none';\n        paragraph.style.display = 'none';\n        paragraph.nextSibling.style.display = 'none';\n        insertTable.style.display = 'none';\n        deleteTable.style.display = 'none';\n        tableProperties.style.display = 'none';\n        updateField.style.display = 'none';\n        editField.style.display = 'none';\n        continueNumbering.style.display = 'none';\n        restartAt.style.display = 'none';\n        restartAt.nextSibling.style.display = 'none';\n        if (isNullOrUndefined(selection)) {\n            return false;\n        }\n        selection.hideToolTip();\n        if (selection.isEmpty) {\n            cut.classList.add('e-disabled');\n            copy.classList.add('e-disabled');\n        }\n        else {\n            cut.classList.remove('e-disabled');\n            copy.classList.remove('e-disabled');\n        }\n        if (owner.isReadOnlyMode) {\n            return true;\n        }\n        cut.style.display = 'block';\n        paste.style.display = 'block';\n        paste.nextSibling.style.display = 'block';\n        insertTable.classList.add('e-blankicon');\n        deleteTable.classList.add('e-blankicon');\n        updateField.classList.add('e-blankicon');\n        editField.classList.add('e-blankicon');\n        if (owner.enableLocalPaste && !isNullOrUndefined(owner.editor.copiedData)) {\n            paste.classList.remove('e-disabled');\n        }\n        else {\n            paste.classList.add('e-disabled');\n        }\n        if (selection.contextType === 'TableOfContents') {\n            updateField.style.display = 'block';\n            editField.style.display = 'block';\n            restartAt.nextSibling.style.display = 'block';\n        }\n        else {\n            var start = selection.start;\n            var end = selection.end;\n            if (selection.contextType === 'List'\n                && owner.editorModule.getListLevel(start.paragraph).listLevelPattern !== 'Bullet') {\n                continueNumbering.style.display = 'block';\n                restartAt.style.display = 'block';\n                restartAt.nextSibling.style.display = 'block';\n            }\n            var isCellOrRowSelected = start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n                || start.paragraph.associatedCell !== end.paragraph.associatedCell\n                || selection.isCellSelected(start.paragraph.associatedCell, start, end));\n            if (isCellOrRowSelected) {\n                hyperlink.classList.add('e-disabled');\n            }\n            else {\n                if (hyperlink.classList.contains('e-disabled')) {\n                    hyperlink.classList.remove('e-disabled');\n                }\n            }\n            var field = selection.getHyperlinkField();\n            if (field instanceof FieldElementBox && !selection.isImageField()) {\n                openHyperlink.style.display = 'block';\n                copyHyperlink.style.display = 'block';\n                if (owner.hyperlinkDialogModule) {\n                    editHyperlink.style.display = 'block';\n                }\n                removeHyperlink.style.display = 'block';\n                removeHyperlink.nextSibling.style.display = 'block';\n            }\n            else {\n                if (owner.hyperlinkDialogModule) {\n                    hyperlink.style.display = 'block';\n                }\n            }\n        }\n        if (this.viewer.owner.selection.start.paragraph.isInsideTable\n            && this.viewer.owner.selection.end.paragraph.isInsideTable) {\n            paragraph.nextSibling.style.display = 'block';\n            if (owner.tablePropertiesDialogModule) {\n                tableProperties.style.display = 'block';\n            }\n            insertTable.style.display = 'block';\n            deleteTable.style.display = 'block';\n            if (this.viewer.owner.editor.canMergeCells()) {\n                mergeCells.style.display = 'block';\n            }\n        }\n        else {\n            if (this.viewer.owner.fontDialogModule) {\n                font.style.display = 'block';\n                font.previousSibling.style.display = 'block';\n            }\n            if (this.viewer.owner.paragraphDialogModule) {\n                paragraph.style.display = 'block';\n            }\n        }\n        if (selection.contextType === 'Image') {\n            font.style.display = 'none';\n            paragraph.style.display = 'none';\n            removeHyperlink.nextSibling.style.display = 'none';\n        }\n        return true;\n    };\n    /**\n     * Disposes the internal objects which are maintained.\n     * @private\n     */\n    ContextMenu.prototype.destroy = function () {\n        if (this.contextMenuInstance) {\n            this.contextMenuInstance.destroy();\n        }\n        if (this.contextMenu) {\n            if (this.contextMenu.parentElement) {\n                this.contextMenu.parentElement.removeChild(this.contextMenu);\n            }\n            this.contextMenu.innerHTML = '';\n        }\n        this.contextMenu = undefined;\n        this.contextMenuInstance = undefined;\n    };\n    return ContextMenu;\n}());\nexport { ContextMenu };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WAbstractList = /** @class */ (function () {\n    function WAbstractList() {\n        this.abstractListIdIn = -1;\n        this.levels = [];\n    }\n    Object.defineProperty(WAbstractList.prototype, \"abstractListId\", {\n        get: function () {\n            return this.abstractListIdIn;\n        },\n        set: function (abstractListId) {\n            this.abstractListIdIn = abstractListId;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WAbstractList.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.levels)) {\n            for (var i = 0; i < this.levels.length; i++) {\n                var listLevel = this.levels[i];\n                listLevel.destroy();\n                this.levels.splice(this.levels.indexOf(listLevel), 1);\n                i--;\n            }\n            this.levels = [];\n        }\n        this.levels = undefined;\n    };\n    return WAbstractList;\n}());\nexport { WAbstractList };\n","import { Dictionary } from '../../base/dictionary';\nimport { WUniqueFormat } from '../../base/unique-format';\nimport { WUniqueFormats } from '../../base/unique-formats';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { WAbstractList } from './abstract-list';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar WListLevel = /** @class */ (function () {\n    function WListLevel(node) {\n        this.uniqueListLevel = undefined;\n        this.paragraphFormat = undefined;\n        this.characterFormat = undefined;\n        if (node instanceof WAbstractList) {\n            this.ownerBase = node;\n        }\n        else {\n            this.ownerBase = node;\n        }\n        this.characterFormat = new WCharacterFormat(undefined);\n        this.paragraphFormat = new WParagraphFormat(undefined);\n    }\n    Object.defineProperty(WListLevel.prototype, \"listLevelPattern\", {\n        get: function () {\n            return this.getPropertyValue('listLevelPattern');\n        },\n        set: function (listLevelPattern) {\n            this.setPropertyValue('listLevelPattern', listLevelPattern);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"followCharacter\", {\n        get: function () {\n            return this.getPropertyValue('followCharacter');\n        },\n        set: function (followCharacter) {\n            this.setPropertyValue('followCharacter', followCharacter);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"startAt\", {\n        get: function () {\n            return this.getPropertyValue('startAt');\n        },\n        set: function (startAt) {\n            this.setPropertyValue('startAt', startAt);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"numberFormat\", {\n        get: function () {\n            return this.getPropertyValue('numberFormat');\n        },\n        set: function (numberFormat) {\n            this.setPropertyValue('numberFormat', numberFormat);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WListLevel.prototype, \"restartLevel\", {\n        get: function () {\n            return this.getPropertyValue('restartLevel');\n        },\n        set: function (restartLevel) {\n            this.setPropertyValue('restartLevel', restartLevel);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    WListLevel.prototype.getPropertyValue = function (property) {\n        var propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (!isNullOrUndefined(this.uniqueListLevel) && this.uniqueListLevel.propertiesHash.containsKey(propertyType)) {\n            return this.uniqueListLevel.propertiesHash.get(propertyType);\n        }\n        return WListLevel.getPropertyDefaultValue(property);\n    };\n    WListLevel.prototype.setPropertyValue = function (property, value) {\n        if (isNullOrUndefined(value) || value === '') {\n            value = WListLevel.getPropertyDefaultValue(property);\n        }\n        if (isNullOrUndefined(this.uniqueListLevel)) {\n            this.initializeUniqueWListLevel(property, value);\n        }\n        else {\n            var propertyType = WUniqueFormat.getPropertyType(this.uniqueListLevel.uniqueFormatType, property);\n            if (this.uniqueListLevel.propertiesHash.containsKey(propertyType) &&\n                // tslint:disable-next-line:max-line-length\n                this.uniqueListLevel.propertiesHash.get(propertyType) === value) { //Do nothing, since no change in property value and return\n                return;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.uniqueListLevel = WListLevel.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel, property, value);\n        }\n    };\n    WListLevel.prototype.initializeUniqueWListLevel = function (property, propValue) {\n        var uniqueListLevelTemp = new Dictionary();\n        this.addUniqueWListLevel('listLevelPattern', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('startAt', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('followCharacter', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('numberFormat', property, propValue, uniqueListLevelTemp);\n        this.addUniqueWListLevel('restartLevel', property, propValue, uniqueListLevelTemp);\n        // tslint:disable-next-line:max-line-length    \n        this.uniqueListLevel = WListLevel.uniqueListLevels.addUniqueFormat(uniqueListLevelTemp, WListLevel.uniqueFormatType);\n    };\n    // tslint:disable-next-line:max-line-length\n    WListLevel.prototype.addUniqueWListLevel = function (property, modifiedProperty, propValue, uniqueCharFormatTemp) {\n        var propertyType;\n        propertyType = WUniqueFormat.getPropertyType(WListLevel.uniqueFormatType, property);\n        if (property === modifiedProperty) {\n            uniqueCharFormatTemp.add(propertyType, propValue);\n        }\n        else {\n            uniqueCharFormatTemp.add(propertyType, WListLevel.getPropertyDefaultValue(property));\n        }\n    };\n    WListLevel.getPropertyDefaultValue = function (property) {\n        var value = undefined;\n        switch (property) {\n            case 'listLevelPattern':\n                value = 'Arabic';\n                break;\n            case 'startAt':\n                value = 0;\n                break;\n            case 'followCharacter':\n                value = 'Tab';\n                break;\n            case 'numberFormat':\n                value = '';\n                break;\n            case 'restartLevel':\n                value = 0;\n                break;\n        }\n        return value;\n    };\n    WListLevel.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.characterFormat)) {\n            this.characterFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.paragraphFormat)) {\n            this.paragraphFormat.destroy();\n        }\n        if (!isNullOrUndefined(this.uniqueListLevel)) {\n            WListLevel.uniqueListLevels.remove(this.uniqueListLevel);\n        }\n        this.uniqueListLevel = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n    };\n    WListLevel.clear = function () {\n        this.uniqueListLevels.clear();\n    };\n    WListLevel.dotBullet = '\\uf0b7';\n    WListLevel.squareBullet = '\\uf0a7'; //Symbol font \\u25aa.\n    WListLevel.arrowBullet = '\\u27a4';\n    WListLevel.circleBullet = '\\uf06f' + '\\u0020';\n    WListLevel.uniqueListLevels = new WUniqueFormats();\n    WListLevel.uniqueFormatType = 9;\n    return WListLevel;\n}());\nexport { WListLevel };\n","import { Dictionary } from '../../base/dictionary';\nimport { WListLevel } from '../list/list-level';\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WBorder } from '../format/index';\nimport { PageLayoutViewer } from './viewer';\nimport { LineWidget, Rect, Widget, Margin, ParagraphWidget, BodyWidget, TextElementBox, ElementBox, ListTextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Layout = /** @class */ (function () {\n    /**\n     * viewer definition\n     */\n    function Layout(viewer) {\n        /**\n         * @private\n         */\n        this.allowLayout = true;\n        /**\n         * @private\n         */\n        this.isInitialLoad = true;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = 0;\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    /**\n     * @private\n     */\n    Layout.prototype.layout = function () {\n        // Todo: Need to handle complete document layout(relayout).\n        var page = this.viewer.pages[0];\n        var body = page.bodyWidgets[0];\n    };\n    /**\n     * Releases un-managed and - optionally - managed resources.\n     */\n    Layout.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.value = undefined;\n        this.allowLayout = undefined;\n        this.isInitialLoad = undefined;\n        this.fieldBegin = undefined;\n        this.maxTextHeight = undefined;\n        this.maxBaseline = undefined;\n        this.maxTextBaseline = undefined;\n        this.isFieldCode = undefined;\n    };\n    /**\n     * Layouts the items\n     * @private\n     */\n    Layout.prototype.layoutItems = function (sections) {\n        var _this = this;\n        var page;\n        for (var i = 0; i < sections.length; i++) {\n            var section = sections[i];\n            page = this.viewer.createNewPage(section);\n            this.addBodyWidget(this.viewer.clientActiveArea, section);\n            if (this.viewer.pages.length > 1) {\n                var pageIndex = 0;\n                for (var i_1 = 0; i_1 < this.viewer.pages.length; i_1++) {\n                    var prevPage = this.viewer.pages[i_1];\n                    var prevSectionIndex = prevPage.sectionIndex;\n                    var index = section.index;\n                    if (prevSectionIndex > index || prevPage === page) {\n                        break;\n                    }\n                    pageIndex++;\n                }\n                if (pageIndex < this.viewer.pages.length - 1) {\n                    this.viewer.insertPage(pageIndex, page);\n                }\n            }\n            this.layoutSection(section, 0, this.viewer);\n        }\n        this.updateFieldElements();\n        setTimeout(function () {\n            if (_this.viewer) {\n                _this.viewer.updateScrollBars();\n                _this.isInitialLoad = false;\n            }\n        });\n    };\n    /**\n     * Layouts the items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutSection = function (section, index, viewer, ownerWidget) {\n        var block = section.firstChild;\n        var nextBlock;\n        do {\n            this.viewer.updateClientAreaForBlock(block, true);\n            nextBlock = this.layoutBlock(block, index);\n            index = 0;\n            this.viewer.updateClientAreaForBlock(block, false);\n            block = nextBlock;\n        } while (block);\n    };\n    /**\n     * Layouts the header footer items\n     * @param section\n     * @param viewer\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooter = function (section, viewer, page) {\n        //Header layout\n        var headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, true);\n        if (headerFooterWidget) {\n            var header = headerFooterWidget.clone();\n            header.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, true);\n            page.headerWidget = this.layoutHeaderFooterItems(viewer, header);\n            this.updateHeaderFooterToParent(header);\n        }\n        //Footer Layout\n        headerFooterWidget = viewer.getCurrentPageHeaderFooter(section, false);\n        if (headerFooterWidget) {\n            var footer = headerFooterWidget.clone();\n            footer.page = page;\n            viewer.updateHFClientArea(section.sectionFormat, false);\n            page.footerWidget = this.layoutHeaderFooterItems(viewer, footer);\n            this.updateHeaderFooterToParent(footer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateHeaderFooterToParent = function (node) {\n        var sectionIndex = node.page.sectionIndex;\n        var typeIndex = this.viewer.getHeaderFooter(node.headerFooterType);\n        var clone = node.clone();\n        this.viewer.headersFooters[sectionIndex][typeIndex] = clone;\n        for (var j = 0; j < clone.childWidgets.length; j++) {\n            var child = clone.childWidgets[j];\n            if (child instanceof TableWidget) {\n                this.clearTableWidget(child, false, true);\n            }\n        }\n        return clone;\n    };\n    Layout.prototype.linkFieldInHeaderFooter = function (widget) {\n        var firstChild = widget.firstChild;\n        do {\n            if (firstChild instanceof ParagraphWidget) {\n                this.linkFieldInParagraph(firstChild);\n            }\n            else {\n                this.linkFieldInTable(firstChild);\n            }\n            //tslint:disable:no-conditional-assignment\n        } while (firstChild = firstChild.nextWidget);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInParagraph = function (widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            var line = widget.childWidgets[j];\n            for (var i = 0; i < line.children.length; i++) {\n                var element = line.children[i];\n                if (element instanceof FieldElementBox && element.fieldType !== 0) {\n                    element.linkFieldCharacter(this.viewer);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.linkFieldInTable = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var row = widget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                for (var k = 0; k < cell.childWidgets.length; k++) {\n                    var block = cell.childWidgets[k];\n                    if (block instanceof ParagraphWidget) {\n                        this.linkFieldInParagraph(block);\n                    }\n                    else {\n                        this.linkFieldInTable(block);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Layouts the header footer items.\n     * @param viewer\n     * @param hfModule\n     * @private\n     */\n    Layout.prototype.layoutHeaderFooterItems = function (viewer, widget) {\n        this.viewer.updateClientAreaLocation(widget, viewer.clientActiveArea);\n        if (widget.childWidgets.length === 0) {\n            var pargaraph = new ParagraphWidget();\n            var line = new LineWidget(pargaraph);\n            pargaraph.childWidgets.push(line);\n            widget.childWidgets.push(pargaraph);\n            pargaraph.containerWidget = widget;\n        }\n        this.linkFieldInHeaderFooter(widget);\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        var type = widget.headerFooterType;\n        if (type === 'OddFooter' || type === 'EvenFooter' || type === 'FirstPageFooter') {\n            this.shiftChildLocation(viewer.clientArea.y - viewer.clientActiveArea.y, widget);\n        }\n        return widget;\n    };\n    /**\n     * Shifts the child location\n     * @param shiftTop\n     * @param bodyWidget\n     */\n    Layout.prototype.shiftChildLocation = function (shiftTop, bodyWidget) {\n        var widgetTop = bodyWidget.y + shiftTop;\n        var footerMaxHeight = bodyWidget.page.boundingRectangle.height - (bodyWidget.page.boundingRectangle.height / 100) * 40;\n        widgetTop = Math.max(widgetTop, footerMaxHeight);\n        shiftTop = widgetTop - bodyWidget.y;\n        bodyWidget.y = widgetTop;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var childWidget = bodyWidget.childWidgets[i];\n            if (childWidget instanceof ParagraphWidget) {\n                childWidget.x = childWidget.x;\n                childWidget.y = childWidget.y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table widget.\n     * @param tableWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableWidget = function (tableWidget, shiftTop) {\n        tableWidget.y = tableWidget.y + shiftTop;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var childWidget = tableWidget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget) {\n                this.shiftChildLocationForTableRowWidget(childWidget, shiftTop);\n            }\n        }\n    };\n    /**\n     * Shifts the child location for table row widget.\n     * @param rowWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableRowWidget = function (rowWidget, shiftTop) {\n        rowWidget.y = rowWidget.y + shiftTop;\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            this.shiftChildLocationForTableCellWidget(rowWidget.childWidgets[i], shiftTop);\n        }\n    };\n    /**\n     * Shifts the child location for table cell widget.\n     * @param cellWidget\n     * @param shiftTop\n     */\n    Layout.prototype.shiftChildLocationForTableCellWidget = function (cellWidget, shiftTop) {\n        cellWidget.y = cellWidget.y + shiftTop;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n                cellWidget.childWidgets[i].y = cellWidget.childWidgets[i].y + shiftTop;\n            }\n            else {\n                this.shiftChildLocationForTableWidget(cellWidget.childWidgets[i], shiftTop);\n            }\n        }\n    };\n    /**\n     * Layouts specified block.\n     * @param block\n     * @private\n     */\n    Layout.prototype.layoutBlock = function (block, index, moveToLine) {\n        var nextBlock;\n        if (block instanceof ParagraphWidget) {\n            nextBlock = this.layoutParagraph(block, index);\n        }\n        else {\n            nextBlock = this.layoutTable(block, index);\n        }\n        return nextBlock.nextRenderedWidget;\n    };\n    /**\n     * Adds paragraph widget.\n     * @param area\n     */\n    Layout.prototype.addParagraphWidget = function (area, paragraphWidget) {\n        var ownerParaWidget = undefined;\n        if (paragraphWidget.isEmpty() && !isNullOrUndefined(paragraphWidget.paragraphFormat) &&\n            (paragraphWidget.paragraphFormat.textAlignment === 'Center' || paragraphWidget.paragraphFormat.textAlignment === 'Right') &&\n            paragraphWidget.paragraphFormat.listFormat.listId === -1) {\n            var top_1 = 0;\n            var bottom = 0;\n            var width = this.viewer.textHelper.getParagraphMarkWidth(paragraphWidget.characterFormat);\n            var left = area.x;\n            if (paragraphWidget.paragraphFormat.textAlignment === 'Center') {\n                left += (area.width - width) / 2;\n            }\n            else {\n                left += area.width - width;\n            }\n            paragraphWidget.width = width;\n            paragraphWidget.x = left;\n            paragraphWidget.y = area.y;\n        }\n        else {\n            paragraphWidget.width = area.width;\n            paragraphWidget.x = area.x;\n            paragraphWidget.y = area.y;\n        }\n        return paragraphWidget;\n    };\n    /**\n     * Adds line widget.\n     * @param paragraph\n     */\n    Layout.prototype.addLineWidget = function (paragraphWidget) {\n        var line = undefined;\n        line = new LineWidget(paragraphWidget);\n        line.width = paragraphWidget.width;\n        paragraphWidget.childWidgets.push(line);\n        line.paragraph = paragraphWidget;\n        return line;\n    };\n    /**\n     * Layouts specified paragraph.\n     * @private\n     * @param paragraph\n     */\n    Layout.prototype.layoutParagraph = function (paragraph, lineIndex) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.layoutListItems(paragraph);\n        if (paragraph.isEmpty()) {\n            this.layoutEmptyLineWidget(paragraph, true);\n        }\n        else {\n            var line = lineIndex < paragraph.childWidgets.length ?\n                paragraph.childWidgets[lineIndex] : undefined;\n            while (line instanceof LineWidget) {\n                if (line.isFirstLine() && isNullOrUndefined(this.fieldBegin)) {\n                    if (!isNullOrUndefined(paragraph.paragraphFormat)) {\n                        // tslint:disable-next-line:max-line-length\n                        var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                        this.viewer.updateClientWidth(firstLineIndent);\n                    }\n                }\n                line = this.layoutLine(line, 0);\n                paragraph = line.paragraph;\n                line = line.nextLine;\n            }\n        }\n        this.updateWidgetToPage(this.viewer, paragraph);\n        return paragraph;\n    };\n    Layout.prototype.clearLineMeasures = function () {\n        this.maxBaseline = 0;\n        this.maxTextBaseline = 0;\n        this.maxTextHeight = 0;\n    };\n    Layout.prototype.moveElementFromNextLine = function (line) {\n        var nextLine = line.nextLine;\n        while (nextLine instanceof LineWidget) {\n            if (nextLine.children.length > 0) {\n                var element = nextLine.children.splice(0, 1)[0];\n                line.children.push(element);\n                element.line = line;\n                break;\n            }\n            else {\n                if (nextLine.paragraph.childWidgets.length === 1) {\n                    nextLine.paragraph.destroy();\n                }\n                else {\n                    nextLine.destroy();\n                }\n                nextLine = line.nextLine;\n            }\n        }\n    };\n    Layout.prototype.layoutLine = function (line, count) {\n        var paragraph = line.paragraph;\n        if (line.children.length === 0) {\n            this.moveElementFromNextLine(line);\n        }\n        var element = line.children[count];\n        this.clearLineMeasures();\n        while (element instanceof ElementBox) {\n            this.layoutElement(element, paragraph);\n            line = element.line;\n            element = element.nextElement;\n        }\n        return line;\n    };\n    // tslint:disable:max-func-body-length\n    Layout.prototype.layoutElement = function (element, paragraph) {\n        var line = element.line;\n        var text = '';\n        var index = element.indexInOwner;\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0 && this.viewer.fields.indexOf(element) === -1) {\n                this.viewer.fields.push(element);\n            }\n            this.layoutFieldCharacters(element);\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextNode) && !this.isFieldCode) {\n                if (isNullOrUndefined(element.fieldSeparator)) {\n                    this.layoutEmptyLineWidget(paragraph, false, element.line);\n                }\n                this.moveToNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && !isNullOrUndefined(line.nextLine) &&\n                    this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n            return;\n        }\n        if (element instanceof ListTextElementBox || this.isFieldCode || element instanceof BookmarkElementBox) {\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            if (element.line.isLastLine() && isNullOrUndefined(element.nextElement)) {\n                if (this.hasValidElement(line.paragraph)) {\n                    this.moveToNextLine(line);\n                }\n                else {\n                    this.layoutEmptyLineWidget(line.paragraph, false, line, false);\n                }\n            }\n            return;\n        }\n        var width = element.width;\n        if (element instanceof FieldTextElementBox) {\n            text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n            if (text !== '') {\n                element.text = text;\n            }\n            else {\n                text = element.text;\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            this.checkAndSplitTabOrLineBreakCharacter(element.text, element);\n            text = element.text;\n        }\n        // Here field code width and height update need to skipped based on the hidden property.\n        if (element instanceof TextElementBox) {\n            width = this.viewer.textHelper.getTextSize(element, element.characterFormat);\n            if (element.text === '\\t') {\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n            }\n        }\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, line);\n            if (element instanceof FieldTextElementBox) {\n                this.updateFieldText(element);\n            }\n            if (element.previousElement) {\n                this.cutClientWidth(element.previousElement);\n            }\n        }\n        if (width < this.viewer.clientActiveArea.width || !this.viewer.textWrap) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n            if (isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width > 0 && !element.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n            else if (!element.line.isLastLine() && isNullOrUndefined(element.nextElement) && this.viewer.clientActiveArea.width === 0) {\n                this.moveToNextLine(line);\n                if (line.paragraph.lastChild === line && this.viewer.clientActiveArea.height >= 0) {\n                    this.moveFromNextPage(line);\n                }\n            }\n        }\n        else if (element instanceof TextElementBox) {\n            if (element.text === '\\t') {\n                var currentLine = element.line;\n                this.addSplittedLineWidget(currentLine, currentLine.children.indexOf(element));\n                this.moveToNextLine(currentLine);\n                // Recalculates tab width based on new client active area X position\n                element.width = this.getTabWidth(paragraph, this.viewer, index, line, element);\n                this.addElementToLine(paragraph, element);\n            }\n            else {\n                //Splits the text and arrange line by line, till end of text.\n                do {\n                    line = element.line;\n                    this.splitTextForClientArea(line, element, element.text, element.width, element.characterFormat);\n                    this.checkLineWidgetWithClientArea(line, element);\n                    if (element instanceof FieldTextElementBox) {\n                        this.updateFieldText(element);\n                    }\n                } while (element.line !== line && this.cutClientWidth(element));\n            }\n        }\n        else {\n            do {\n                line = element.line;\n                this.splitElementForClientArea(paragraph, element);\n                this.checkLineWidgetWithClientArea(line, element);\n                if (element instanceof FieldTextElementBox) {\n                    this.updateFieldText(element);\n                }\n            } while (element.line !== line && this.cutClientWidth(element));\n        }\n        if (text === '\\v' || text === '\\f') {\n            var elementIndex = line.children.indexOf(element);\n            if (elementIndex > -1) {\n                this.addSplittedLineWidget(line, elementIndex);\n            }\n        }\n        if (element.line.isLastLine() && isNullOrUndefined(element.nextElement) || text === '\\v' || text === '\\f') {\n            this.moveToNextLine(element.line);\n            if (text === '\\v' && isNullOrUndefined(element.nextNode)) {\n                this.layoutEmptyLineWidget(paragraph, true, line, true);\n            }\n            else if (text === '\\f') {\n                if (isNullOrUndefined(element.nextNode)) {\n                    this.moveToNextPage(this.viewer, element.line, true);\n                }\n                else {\n                    this.moveToNextPage(this.viewer, element.line.nextLine, false);\n                }\n            }\n        }\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Layout.prototype.hasValidElement = function (paragraph) {\n        var line = paragraph.firstChild;\n        if (line && !isNullOrUndefined(this.viewer.selection)) {\n            var elementBox = line.children[0];\n            while (elementBox) {\n                if (elementBox instanceof FieldElementBox) {\n                    elementBox = this.viewer.selection.getNextValidElementForField(elementBox);\n                    if (!elementBox.line.paragraph.equals(paragraph)) {\n                        return false;\n                    }\n                }\n                if (elementBox instanceof TextElementBox) {\n                    return true;\n                }\n                elementBox = elementBox.nextNode;\n            }\n        }\n        return false;\n    };\n    Layout.prototype.updateFieldText = function (element) {\n        // tslint:disable-next-line:max-line-length\n        var text = this.viewer.getFieldResult(element.fieldBegin, element.paragraph.bodyWidget.page);\n        if (text !== '') {\n            element.text = text;\n            this.viewer.textHelper.getTextSize(element, element.characterFormat);\n        }\n    };\n    Layout.prototype.checkLineWidgetWithClientArea = function (line, element) {\n        if (line !== element.line || element.line === line && isNullOrUndefined(element.nextElement)\n            && !element.line.isLastLine()) {\n            this.moveToNextLine(line);\n        }\n        if (element.line !== line && this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height &&\n            this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, element.line);\n        }\n        else if (element.line === line && isNullOrUndefined(element.nextElement)\n            && line.paragraph.lastChild === line && !line.isLastLine() && this.viewer.clientActiveArea.height >= 0) {\n            this.moveFromNextPage(line);\n        }\n    };\n    Layout.prototype.checkAndSplitTabOrLineBreakCharacter = function (text, element) {\n        var char = ['\\t', '\\v', '\\f'];\n        var index = HelperMethods.indexOfAny(text, char);\n        if (index > -1) {\n            var character = text[index];\n            if ((character === '\\t' && text !== '\\t') || (character === '\\v' && text !== '\\v')\n                || (character === '\\f' && text !== '\\f')) {\n                this.splitByLineBreakOrTab(this.viewer, element, index, character);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveFromNextPage = function (line) {\n        var nextLine = line.nextLine;\n        if (nextLine && line.paragraph.childWidgets.indexOf(nextLine) === -1) {\n            nextLine.paragraph.childWidgets.splice(nextLine.indexInOwner, 1);\n            line.paragraph.childWidgets.push(nextLine);\n            nextLine.paragraph = line.paragraph;\n        }\n    };\n    Layout.prototype.cutClientWidth = function (currentElement) {\n        this.clearLineMeasures();\n        var line = currentElement.line;\n        var width = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            width += element.width;\n            if (currentElement === element) {\n                break;\n            }\n        }\n        var splitCurrentWidget = this.viewer.clientActiveArea.width - width < 0;\n        if (!splitCurrentWidget) {\n            this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + width);\n            if (currentElement.line.paragraph.paragraphFormat.textAlignment === 'Justify' &&\n                currentElement instanceof TextElementBox) {\n                this.splitTextElementWordByWord(currentElement);\n            }\n            if (isNullOrUndefined(currentElement.nextElement) && this.viewer.clientActiveArea.width > 0\n                && !currentElement.line.isLastLine()) {\n                this.moveElementFromNextLine(line);\n            }\n        }\n        else if (currentElement.previousElement) {\n            this.cutClientWidth(currentElement.previousElement);\n        }\n        return splitCurrentWidget;\n    };\n    Layout.prototype.layoutFieldCharacters = function (element) {\n        if (element.fieldType === 0) {\n            if (!this.isFieldCode && (!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                this.viewer.fieldStacks.push(element);\n                this.isFieldCode = true;\n                element.hasFieldEnd = true;\n            }\n        }\n        else if (this.viewer.fieldStacks.length > 0) {\n            if (element.fieldType === 2) {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (field.fieldSeparator === element && (!isNullOrUndefined(field.fieldEnd) || field.hasFieldEnd)) {\n                    this.isFieldCode = false;\n                }\n            }\n            else {\n                var field = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                if (element === field.fieldEnd) {\n                    this.viewer.fieldStacks.pop();\n                    this.isFieldCode = false;\n                }\n            }\n        }\n    };\n    /**\n     * Layouts empty line widget.\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutEmptyLineWidget = function (paragraph, isEmptyLine, line, isShiftEnter) {\n        isShiftEnter = isNullOrUndefined(isShiftEnter) ? false : isShiftEnter;\n        //Calculate line height and descent based on formatting defined in paragraph.\n        var paragraphMarkSize = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var maxHeight = paragraphMarkSize.Height;\n        var beforeSpacing = this.getBeforeSpacing(paragraph);\n        var lineWidget;\n        if (paragraph.childWidgets.length > 0 && !isShiftEnter) {\n            lineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            lineWidget = isEmptyLine ? this.addLineWidget(paragraph) : line;\n        }\n        //isNullOrUndefined(this.viewer.currentHeaderFooter) && \n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < beforeSpacing + maxHeight\n            && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            this.moveToNextPage(this.viewer, lineWidget);\n        }\n        //Gets line spacing.\n        var lineSpacing = this.getLineSpacing(paragraph, maxHeight);\n        var maxDescent = maxHeight - paragraphMarkSize.BaselineOffset;\n        //Calculate the bottom position of current line - max height + line spacing.\n        if (!isNaN(this.maxTextHeight)\n            && maxHeight < this.maxTextHeight) {\n            maxHeight = this.maxTextHeight;\n            maxDescent = maxHeight - this.maxTextBaseline;\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var leftMargin = 0;\n        var height = maxHeight;\n        var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n        if (lineSpacingType === 'Multiple') {\n            if (lineSpacing > maxHeight) {\n                bottomMargin += lineSpacing - maxHeight;\n            }\n            else {\n                topMargin += lineSpacing - maxHeight;\n            }\n        }\n        else if (lineSpacingType === 'Exactly') {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        else if (lineSpacing > topMargin + height + bottomMargin) {\n            topMargin += lineSpacing - (topMargin + height + bottomMargin);\n        }\n        topMargin += beforeSpacing;\n        bottomMargin += HelperMethods.convertPointToPixel(paragraph.paragraphFormat.afterSpacing);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var element = lineWidget.children[i];\n            if (element instanceof ListTextElementBox) {\n                var textAlignment = paragraph.paragraphFormat.textAlignment;\n                if (textAlignment === 'Right') { //Aligns the text as right justified.\n                    leftMargin = this.viewer.clientArea.width - element.width;\n                }\n                else if (textAlignment === 'Center') { //Aligns the text as center justified.\n                    leftMargin = (this.viewer.clientArea.width - element.width) / 2;\n                }\n                element.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n                element.line = lineWidget;\n                lineWidget.height = topMargin + height + bottomMargin;\n            }\n        }\n        lineWidget.height = topMargin + height + bottomMargin;\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + lineWidget.height);\n        //Clears the previous line elements from collection.     \n    };\n    /**\n     * @private\n     */\n    Layout.prototype.layoutListItems = function (paragraph) {\n        if (!this.isFieldCode) {\n            if (!isNullOrUndefined(paragraph.paragraphFormat)\n                && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)\n                && !isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId)) &&\n                paragraph.paragraphFormat.listFormat.listLevelNumber >= 0\n                && paragraph.paragraphFormat.listFormat.listLevelNumber < 9) {\n                this.clearListElementBox(paragraph);\n                this.layoutList(paragraph, this.viewer);\n            }\n            else if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId === -1) {\n                this.clearListElementBox(paragraph);\n            }\n        }\n    };\n    /**\n     * Layouts list.\n     * @param viewer\n     */\n    Layout.prototype.layoutList = function (paragraph, viewer) {\n        var list = viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n        viewer.updateClientWidth(-HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        var currentListLevel = this.getListLevel(list, paragraph.paragraphFormat.listFormat.listLevelNumber);\n        // if (isNullOrUndefined(currentListLevel)) {\n        //     return;\n        // }\n        var lineWidget = paragraph.childWidgets[0];\n        if (isNullOrUndefined(lineWidget)) {\n            lineWidget = new LineWidget(paragraph);\n            paragraph.childWidgets.push(lineWidget);\n        }\n        var element = new ListTextElementBox(currentListLevel, false);\n        element.line = lineWidget;\n        if (currentListLevel.listLevelPattern === 'Bullet') {\n            element.text = currentListLevel.numberFormat;\n        }\n        else {\n            element.text = this.getListNumber(paragraph.paragraphFormat.listFormat);\n        }\n        viewer.textHelper.updateTextSize(element, paragraph);\n        var moveToNextPage;\n        if (this.viewer instanceof PageLayoutViewer\n            && this.viewer.clientActiveArea.height < element.height && this.viewer.clientActiveArea.y !== this.viewer.clientArea.y) {\n            moveToNextPage = true;\n        }\n        viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n        //Adds the text element to the line\n        lineWidget.children.splice(0, 0, element);\n        if (currentListLevel.followCharacter !== 'None') {\n            element = new ListTextElementBox(currentListLevel, true);\n            if (currentListLevel.followCharacter === 'Tab') {\n                element.text = '\\t';\n                var index = lineWidget.children.indexOf(element);\n                element.width = this.getTabWidth(paragraph, viewer, index, lineWidget, undefined);\n            }\n            else {\n                element.text = ' ';\n                viewer.textHelper.updateTextSize(element, paragraph);\n            }\n            viewer.cutFromLeft(viewer.clientActiveArea.x + element.width);\n            //Adds the tabSpace to the line\n            lineWidget.children.splice(1, 0, element);\n            element.line = lineWidget;\n        }\n        if (moveToNextPage) {\n            this.moveToNextPage(this.viewer, lineWidget);\n            this.cutClientWidth(element);\n            return;\n        }\n        if (currentListLevel.followCharacter !== 'None') {\n            viewer.updateClientWidth(HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent));\n        }\n    };\n    /**\n     * Adds body widget.\n     * @param area\n     * @param section\n     * @private\n     */\n    Layout.prototype.addBodyWidget = function (area, widget) {\n        var bodyWidget;\n        if (widget) {\n            bodyWidget = widget;\n        }\n        else {\n            bodyWidget = new BodyWidget();\n        }\n        bodyWidget.width = area.width;\n        bodyWidget.x = area.x;\n        bodyWidget.y = area.y;\n        // this.addSectionInDictionary(this.viewer, section, bodyWidget);\n        return bodyWidget;\n    };\n    /**\n     * Adds list level.\n     * @param abstractList\n     */\n    Layout.prototype.addListLevels = function (abstractList) {\n        for (var i = abstractList.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractList);\n            var val = i % 3;\n            if (abstractList.levels[0].listLevelPattern === 'Bullet') {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = val === 0 ? '\\uf0b7' : val === 1 ? '\\uf0a7' : '\\uf0d8';\n                listLevel.characterFormat.fontFamily = listLevel.numberFormat === '\\uf0a7' || '\\uf0d8' ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                listLevel.listLevelPattern = this.getListLevelPattern(val);\n                listLevel.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            listLevel.paragraphFormat = new WParagraphFormat(undefined);\n            listLevel.paragraphFormat.leftIndent = 48 * (i + 1);\n            listLevel.paragraphFormat.firstLineIndent = -24;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    Layout.prototype.addSplittedLineWidget = function (lineWidget, elementIndex, splittedElementBox) {\n        var paragraph = lineWidget.paragraph;\n        var movedElementBox = [];\n        var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n        if (!isNullOrUndefined(splittedElementBox)) {\n            movedElementBox.push(splittedElementBox);\n        }\n        var newLineWidget = undefined;\n        //Move Next element box to temp collection\n        for (var i = elementIndex + 1; i < lineWidget.children.length; i++) {\n            movedElementBox.push(lineWidget.children[i]);\n        }\n        if (movedElementBox.length > 0) {\n            if (lineIndex === paragraph.childWidgets.length - 1) {\n                newLineWidget = new LineWidget(paragraph);\n            }\n            else {\n                newLineWidget = paragraph.childWidgets[lineIndex + 1];\n            }\n            for (var j = 0; j < movedElementBox.length; j++) {\n                movedElementBox[j].line = newLineWidget;\n            }\n            lineWidget.children.splice(elementIndex + 1, lineWidget.children.length - 1);\n            newLineWidget.children = movedElementBox.concat(newLineWidget.children);\n            if (paragraph.childWidgets.indexOf(newLineWidget) === -1) {\n                paragraph.childWidgets.splice(lineIndex + 1, 0, newLineWidget);\n            }\n        }\n    };\n    /**\n     * Adds element to line.\n     * @param element\n     */\n    Layout.prototype.addElementToLine = function (paragraph, element) {\n        this.viewer.cutFromLeft(this.viewer.clientActiveArea.x + element.width);\n        if (paragraph.paragraphFormat.textAlignment === 'Justify' && element instanceof TextElementBox) {\n            this.splitTextElementWordByWord(element);\n        }\n    };\n    /**\n     * Splits element for client area.\n     * @param element\n     */\n    Layout.prototype.splitElementForClientArea = function (paragraph, element) {\n        var line = element.line;\n        if (element.line.children.length > 0) {\n            var previousElement = element.previousElement;\n            var index = element.indexInOwner;\n            // if line widget contain only single image element box need to skip this from splitting\n            // else move element to next line\n            if (element.line.children.length > 1) {\n                if (previousElement && this.viewer.clientActiveArea.x !== this.viewer.clientArea.x) {\n                    index -= 1;\n                }\n            }\n            this.addSplittedLineWidget(element.line, index);\n        }\n    };\n    /**\n     * Splits by word\n     * @param elementBox\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByWord = function (lineWidget, paragraph, elementBox, text, width, characterFormat) {\n        var index = this.getSplitIndexByWord(this.viewer.clientActiveArea.width, text, width, characterFormat);\n        if (index > 0 && index < elementBox.length) {\n            var indexOf = lineWidget.children.indexOf(elementBox);\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElementBox = new TextElementBox();\n            text = text.substring(index);\n            splittedElementBox.text = text;\n            if (text[0] === ' ') {\n                var prevLength = text.length;\n                text = HelperMethods.trimStart(text); //To trim white space at starting of the text.\n                index += prevLength - text.length;\n            }\n            splittedElementBox.characterFormat.copyFormat(elementBox.characterFormat);\n            splittedElementBox.width = this.viewer.textHelper.getWidth(splittedElementBox.text, characterFormat);\n            elementBox.text = elementBox.text.substr(0, index);\n            elementBox.width -= splittedElementBox.width;\n            splittedElementBox.height = elementBox.height;\n            splittedElementBox.baselineOffset = elementBox.baselineOffset;\n            this.addSplittedLineWidget(lineWidget, indexOf, splittedElementBox);\n            this.addElementToLine(paragraph, elementBox);\n            if (elementBox.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n    };\n    /**\n     * Splits by character.\n     * @param textElement\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitByCharacter = function (lineWidget, textElement, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        // tslint:disable-next-line:max-line-length\n        var index = this.getTextSplitIndexByCharacter(this.viewer.clientArea.width, this.viewer.clientActiveArea.width, text, width, characterFormat);\n        var splitWidth = 0;\n        if (index < textElement.length) {\n            splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, index), characterFormat);\n            text = text.substring(index);\n        }\n        if (splitWidth > this.viewer.clientActiveArea.width && textElement.indexInOwner > 0) {\n            this.addSplittedLineWidget(lineWidget, textElement.indexInOwner - 1);\n            return;\n        }\n        var indexOf = lineWidget.children.indexOf(textElement);\n        if (index < textElement.length) {\n            var lineIndex = paragraph.childWidgets.indexOf(lineWidget);\n            var splittedElement = new TextElementBox();\n            splittedElement.text = text;\n            textElement.text = textElement.text.substr(0, index);\n            splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n            splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, characterFormat);\n            textElement.width -= splittedElement.width;\n            splittedElement.height = textElement.height;\n            splittedElement.baselineOffset = textElement.baselineOffset;\n            lineWidget.children.splice(textElement.indexInOwner + 1, 0, splittedElement);\n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n            if (textElement.width === 0) {\n                lineWidget.children.splice(indexOf, 1);\n            }\n        }\n        else {\n            //Adds the last text element on inline to line elements collection. \n            this.addSplittedLineWidget(lineWidget, indexOf);\n            this.addElementToLine(paragraph, textElement);\n        }\n    };\n    /**\n     * Splits text element word by word.\n     * @param textElement\n     */\n    Layout.prototype.splitTextElementWordByWord = function (textElement) {\n        var lineWidget = textElement.line;\n        var indexOf = lineWidget.children.indexOf(textElement);\n        var text = textElement.text;\n        var format;\n        var characterUptoWs = text.trim().indexOf(' ');\n        if (characterUptoWs >= 0) {\n            lineWidget.children.splice(indexOf, 1);\n            format = textElement.characterFormat;\n            var fontSize = format.fontSize;\n            var index = textElement.length - HelperMethods.trimStart(text).length; //Trim start\n            while (index < textElement.length) {\n                index = this.getTextIndexAfterSpace(text, index);\n                if (index === 0 || index === textElement.length) {\n                    break;\n                }\n                if (index < textElement.length) {\n                    var splittedElement = new TextElementBox();\n                    var splittedText = text.substring(0, index);\n                    text = text.substring(index);\n                    if (text.substring(0, 1) === ' ') {\n                        // start of the text is trimmed and its length is reduced from text length.                        \n                        index += text.length - HelperMethods.trimStart(text).length;\n                    }\n                    splittedElement.text = splittedText;\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    splittedElement.line = lineWidget;\n                    splittedElement.width = this.viewer.textHelper.getWidth(splittedElement.text, format);\n                    splittedElement.height = textElement.height;\n                    splittedElement.baselineOffset = textElement.baselineOffset;\n                    lineWidget.children.splice(indexOf, 0, splittedElement);\n                    textElement.text = text;\n                    textElement.width -= splittedElement.width;\n                    if (textElement.width === 0) {\n                        lineWidget.children.splice(lineWidget.children.indexOf(textElement), 1);\n                    }\n                    index = 0;\n                    indexOf++;\n                }\n            }\n            textElement.text = text;\n            lineWidget.children.splice(indexOf, 0, textElement);\n        }\n    };\n    /**\n     * Splits text for client area.\n     * @param element\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitTextForClientArea = function (lineWidget, element, text, width, characterFormat) {\n        var paragraph = lineWidget.paragraph;\n        var isSplitByWord = true;\n        var index = -1;\n        if (!(text.substring(0, 1) === ' ')) {\n            var textWidth = width;\n            var characterUptoWS = 0;\n            characterUptoWS = HelperMethods.trimEnd(text).indexOf(' ') + 1;\n            index = characterUptoWS;\n            //Checks whether text not starts with white space. If starts with white space, no need to check previous text blocks.\n            if (index > 0) {\n                textWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, index), characterFormat);\n            }\n            if (this.viewer.clientActiveArea.width < textWidth) {\n                //Check and split the previous text elements to next line.            \n                isSplitByWord = this.checkPreviousElement(lineWidget, lineWidget.children.indexOf(element), characterFormat);\n                if (isSplitByWord) {\n                    //lineWidget = paragraph.childWidgets[paragraph.childWidgets.indexOf(lineWidget) + 1] as LineWidget;\n                    //isSplitByWord = textWidth <= this.viewer.clientActiveArea.width;\n                    return;\n                }\n            }\n        }\n        else {\n            index = 1;\n        }\n        if (width <= this.viewer.clientActiveArea.width) {\n            //Fits the text in current line.\n            this.addElementToLine(paragraph, element);\n        }\n        else if (isSplitByWord && (index > 0 || text.indexOf(' ') !== -1)) {\n            this.splitByWord(lineWidget, paragraph, element, text, width, characterFormat);\n        }\n        else {\n            this.splitByCharacter(lineWidget, element, text, width, characterFormat);\n        }\n    };\n    /**\n     * Handle tab or line break character splitting\n     * @param  {LayoutViewer} viewer\n     * @param  {TextElementBox} span\n     * @param  {number} index\n     * @param  {string} spiltBy\n     * @private\n     */\n    Layout.prototype.splitByLineBreakOrTab = function (viewer, span, index, spiltBy) {\n        // Splits tab character to separate SpanAdv\n        var inlineIndex = span.line.children.indexOf(span);\n        var value = span.text;\n        var remainder = value.substring(index);\n        var newSpan = spiltBy === '\\t' ? new TabElementBox() : new TextElementBox();\n        newSpan.line = span.line;\n        newSpan.characterFormat.copyFormat(span.characterFormat);\n        span.line.children.splice(inlineIndex + 1, 0, newSpan);\n        if (index > 0 && remainder.length === 1) {\n            newSpan.text = value.substring(index);\n            span.text = value.substring(0, index);\n        }\n        else if (index > 0) {\n            newSpan.text = spiltBy;\n            var newText = new TextElementBox();\n            newText.line = span.line;\n            newText.text = value.substring(index + 1);\n            newText.characterFormat.copyFormat(span.characterFormat);\n            span.line.children.splice(inlineIndex + 2, 0, newText);\n            span.text = value.substring(0, index);\n        }\n        else if (remainder !== '') {\n            newSpan.text = value.substring(index + 1);\n            span.text = spiltBy;\n        }\n    };\n    /**\n     * Moves to next line.\n     */\n    Layout.prototype.moveToNextLine = function (line) {\n        var paragraph = line.paragraph;\n        var paraFormat = paragraph.paragraphFormat;\n        var isParagraphStart = line.isFirstLine();\n        var isParagraphEnd = line.isLastLine();\n        var height = 0;\n        var maxDescent = 0;\n        var afterSpacing = 0;\n        var beforeSpacing = 0;\n        var lineSpacing = 0;\n        var firstLineIndent = 0;\n        this.updateLineWidget(line);\n        height = this.maxTextHeight;\n        maxDescent = height - this.maxTextBaseline;\n        //Updates before spacing at the top of Paragraph first line.\n        if (isParagraphStart) {\n            beforeSpacing = this.getBeforeSpacing(paragraph);\n            firstLineIndent = HelperMethods.convertPointToPixel(paraFormat.firstLineIndent);\n        }\n        //Updates after spacing at the bottom of Paragraph last line.\n        if (isParagraphEnd) {\n            afterSpacing = HelperMethods.convertPointToPixel(paraFormat.afterSpacing);\n        }\n        if (isNaN(this.maxTextHeight)) {\n            //Calculate line height and descent based on formatting defined in paragraph.\n            var measurement = this.viewer.textHelper.measureText('a', paragraph.characterFormat);\n            height = measurement.Height;\n            maxDescent = height - measurement.BaselineOffset;\n        }\n        else {\n            height = this.maxTextHeight;\n            maxDescent = height - this.maxTextBaseline;\n        }\n        // Gets line spacing.\n        lineSpacing = this.getLineSpacing(paragraph, height);\n        if (paraFormat.lineSpacingType === 'Exactly'\n            && lineSpacing < maxDescent + this.maxBaseline) {\n            lineSpacing = maxDescent + this.maxBaseline;\n        }\n        var subWidth = 0;\n        var whiteSpaceCount = 0;\n        var textAlignment = paraFormat.textAlignment;\n        //Calculates the sub width, for text alignments - Center, Right, Justify.\n        if (textAlignment !== 'Left' && this.viewer.textWrap && !(textAlignment === 'Justify' && isParagraphEnd)) {\n            // tslint:disable-next-line:max-line-length\n            var getWidthAndSpace = this.getSubWidth(line, textAlignment === 'Justify', whiteSpaceCount, firstLineIndent);\n            subWidth = getWidthAndSpace.subWidth;\n            whiteSpaceCount = getWidthAndSpace.spaceCount;\n        }\n        var addSubWidth = false;\n        var lineSpacingType = paraFormat.lineSpacingType;\n        for (var i = 0; i < line.children.length; i++) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var leftMargin = 0;\n            var elementBox = line.children[i];\n            // tslint:disable-next-line:max-line-length\n            var alignElements = this.alignLineElements(elementBox, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, i === line.children.length - 1);\n            topMargin = alignElements.topMargin;\n            bottomMargin = alignElements.bottomMargin;\n            addSubWidth = alignElements.addSubWidth;\n            whiteSpaceCount = alignElements.whiteSpaceCount;\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > height) {\n                    bottomMargin += lineSpacing - height;\n                }\n                else {\n                    topMargin += lineSpacing - height;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + elementBox.height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + elementBox.height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += afterSpacing;\n            if (i === 0) {\n                line.height = topMargin + elementBox.height + bottomMargin;\n                if (textAlignment === 'Right') {\n                    //Aligns the text as right justified.\n                    leftMargin = subWidth;\n                }\n                else if (textAlignment === 'Center') {\n                    //Aligns the text as center justified.\n                    leftMargin = subWidth / 2;\n                }\n            }\n            elementBox.margin = new Margin(leftMargin, topMargin, 0, bottomMargin);\n            elementBox.line = line;\n        }\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + line.height);\n    };\n    Layout.prototype.updateLineWidget = function (line) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                if (this.maxTextHeight < element.height) {\n                    this.maxTextHeight = element.height;\n                    this.maxTextBaseline = element.baselineOffset;\n                }\n                if (this.maxBaseline < this.maxTextBaseline) {\n                    this.maxBaseline = this.maxTextBaseline;\n                }\n            }\n            else if (this.maxBaseline < element.height) {\n                this.maxBaseline = element.height;\n            }\n        }\n    };\n    /**\n     * @param viewer\n     */\n    Layout.prototype.moveToNextPage = function (viewer, line, isPageBreak) {\n        var paragraphWidget = line.paragraph;\n        var index = 0;\n        if (!isNullOrUndefined(line)) {\n            index = paragraphWidget.childWidgets.indexOf(line);\n            if (index > 0 || isPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n        }\n        var nextBody = this.moveBlocksToNextPage(paragraphWidget);\n        this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n        this.viewer.updateClientAreaForBlock(paragraphWidget, true);\n        if (index > 0) {\n            if (line.isLastLine() && isPageBreak) {\n                return;\n            }\n            var nextParagraph = void 0;\n            if (nextBody.firstChild instanceof ParagraphWidget && nextBody.firstChild.equals(paragraphWidget)) {\n                nextParagraph = nextBody.firstChild;\n            }\n            else {\n                nextParagraph = new ParagraphWidget();\n            }\n            nextParagraph = this.addParagraphWidget(this.viewer.clientActiveArea, nextParagraph);\n            nextParagraph.index = paragraphWidget.index;\n            var insertIndex = 0;\n            for (var i = index; i < paragraphWidget.childWidgets.length; i++) {\n                var lineWidget = paragraphWidget.childWidgets[i];\n                lineWidget.paragraph = nextParagraph;\n                nextParagraph.childWidgets.splice(insertIndex, 0, lineWidget);\n                lineWidget.paragraph = nextParagraph;\n                insertIndex++;\n            }\n            nextParagraph.paragraphFormat = paragraphWidget.paragraphFormat;\n            nextParagraph.characterFormat = paragraphWidget.characterFormat;\n            paragraphWidget.childWidgets.splice(index);\n            paragraphWidget = nextParagraph;\n        }\n        else if (!isPageBreak) {\n            paragraphWidget.containerWidget.removeChild(paragraphWidget.indexInOwner);\n        }\n        if (!isPageBreak) {\n            if (nextBody.childWidgets.indexOf(paragraphWidget) === -1) {\n                nextBody.childWidgets.splice(0, 0, paragraphWidget);\n            }\n            paragraphWidget.containerWidget = nextBody;\n            this.viewer.updateClientAreaLocation(paragraphWidget, this.viewer.clientActiveArea);\n        }\n    };\n    /**\n     * Aligns line elements\n     * @param element\n     * @param topMargin\n     * @param bottomMargin\n     * @param maxDescent\n     * @param addSubWidth\n     * @param subWidth\n     * @param textAlignment\n     * @param whiteSpaceCount\n     * @param isLastElement\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.alignLineElements = function (element, topMargin, bottomMargin, maxDescent, addSubWidth, subWidth, textAlignment, whiteSpaceCount, isLastElement) {\n        if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n            var textElement = element instanceof TextElementBox ? element : undefined;\n            //Updates the text to base line offset.\n            // tslint:disable-next-line:max-line-length\n            var baselineOffset = element instanceof TextElementBox ? textElement.baselineOffset : element.baselineOffset;\n            topMargin += this.maxBaseline - baselineOffset;\n            bottomMargin += maxDescent - (element.height - baselineOffset);\n            //Updates the text to base line offset.\n            if (!isNullOrUndefined(textElement) && textAlignment === 'Justify' && whiteSpaceCount > 0) {\n                //Aligns the text as Justified.\n                var width = textElement.width;\n                var text = textElement.text;\n                if (!addSubWidth) {\n                    text = HelperMethods.trimStart(text); // trim start\n                    addSubWidth = (text.length > 0);\n                }\n                if (addSubWidth) {\n                    var spaceCount = text.length - HelperMethods.removeSpace(text).length;\n                    if (isLastElement) {\n                        spaceCount -= text.length - HelperMethods.trimEnd(text).length;\n                    }\n                    if (whiteSpaceCount < spaceCount) {\n                        width = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text, textElement.characterFormat);\n                        spaceCount = whiteSpaceCount;\n                    }\n                    if (spaceCount > 0) {\n                        textElement.width = width + subWidth * spaceCount;\n                        whiteSpaceCount -= spaceCount;\n                    }\n                }\n            }\n        }\n        else {\n            addSubWidth = true;\n            //Updates the Image/UIElement to base line offset.\n            topMargin += this.maxBaseline - element.height;\n            bottomMargin += maxDescent;\n        }\n        return { 'topMargin': topMargin, 'bottomMargin': bottomMargin, 'addSubWidth': addSubWidth, 'whiteSpaceCount': whiteSpaceCount };\n    };\n    /**\n     * Updates widget to page.\n     * @param viewer\n     * @param block\n     * @private\n     */\n    Layout.prototype.updateWidgetToPage = function (viewer, paragraphWidget) {\n        if (paragraphWidget.isInsideTable) {\n            var cellWidget = paragraphWidget.associatedCell;\n            paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            // if (viewer instanceof PageLayoutViewer) {\n            if (isNullOrUndefined(paragraphWidget.associatedCell) || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow)\n                || isNullOrUndefined(paragraphWidget.associatedCell.ownerRow.rowFormat)) {\n                return;\n            }\n            if (paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'Exactly') {\n                cellWidget.height = HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if ([cellWidget].length <= 1 && paragraphWidget.associatedCell.ownerRow.rowFormat.heightType === 'AtLeast') {\n                    cellWidget.height = Math.max(HelperMethods.convertPointToPixel(paragraphWidget.associatedCell.ownerRow.rowFormat.height), this.getCellContentHeight(cellWidget));\n                }\n                else {\n                    cellWidget.height = cellWidget.height + paragraphWidget.height;\n                }\n            }\n            // } else {\n            //     cellWidget.height = cellWidget.height + paragraphWidget.height;\n            // }\n            // cellWidget.childWidgets.push(paragraphWidget);\n            paragraphWidget.containerWidget = cellWidget;\n        }\n        else {\n            if (!paragraphWidget.isEndsWithPageBreak) {\n                paragraphWidget.height = viewer.clientActiveArea.y - paragraphWidget.y;\n            }\n            //Adds the paragraph widget to the Header Footer/ Body widget.\n            // this.updateWidgetsToBody(paragraphWidget, viewer, paragraphWidget);\n            //For canvas no need to render paragraph widget here. In case of div, need to render paragraph here.\n            // tslint:disable-next-line:max-line-length             \n            // this.render.renderParagraphWidget((paragraphWidget.containerWidget as BodyWidget).page, paragraphWidget);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget) {\n            if (!paragraphWidget.isInsideTable) {\n                paragraphWidget.containerWidget.height += paragraphWidget.height;\n            }\n            if (this.viewer.owner.enableHeaderAndFooter && paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftFooterChildLocation = function (widget, viewer) {\n        var pageHeight = widget.page.bodyWidgets[0].sectionFormat.pageHeight;\n        if (widget.headerFooterType.indexOf('Footer') !== -1) {\n            var footerDistance = widget.page.bodyWidgets[0].sectionFormat.footerDistance;\n            var height = HelperMethods.convertPointToPixel(pageHeight - footerDistance);\n            var top_2;\n            if (widget.y + widget.height > height) {\n                top_2 = height - (widget.y + widget.height);\n            }\n            else if (widget.y + widget.height < height) {\n                top_2 = (widget.y + widget.height) - height;\n            }\n            if (!isNullOrUndefined(top_2)) {\n                top_2 = height - (widget.y + widget.height);\n                this.shiftChildLocation(top_2, widget);\n                viewer.clientActiveArea.y += top_2;\n            }\n        }\n    };\n    /**\n     * Checks previous element.\n     * @param characterFormat\n     */\n    Layout.prototype.checkPreviousElement = function (line, index, characterFormat) {\n        var paragraph = line.paragraph;\n        var isSplitByWord = false;\n        var lastTextElement = 0;\n        for (var i = index - 1; i >= 0; i--) {\n            var textElement = line.children[i];\n            if (textElement instanceof TextElementBox) {\n                var text = textElement.text;\n                lastTextElement = i;\n                if (text.length > 0 && text[text.length - 1] === ' ') {\n                    if (i === index - 1) {\n                        this.addSplittedLineWidget(line, index - 1);\n                        return true;\n                    }\n                    isSplitByWord = true;\n                    break;\n                }\n                else if (text === '\\t') {\n                    return false;\n                }\n                else if (text.indexOf(' ') >= 0) {\n                    isSplitByWord = true;\n                    var index_1 = text.lastIndexOf(' ') + 1;\n                    //Splits the text element by space.\n                    var splittedElement = new TextElementBox();\n                    splittedElement.text = text.substr(index_1);\n                    splittedElement.characterFormat.copyFormat(textElement.characterFormat);\n                    textElement.text = text.substr(0, index_1);\n                    this.viewer.textHelper.getTextSize(splittedElement, characterFormat);\n                    textElement.width -= splittedElement.width;\n                    textElement.height = splittedElement.height;\n                    if (textElement.width === 0) {\n                        line.children.splice(i, 1);\n                    }\n                    //Adds the text element to the line\n                    line.children.splice(i + 1, 0, splittedElement);\n                    break;\n                }\n            }\n            else if (!(textElement instanceof ListTextElementBox)) {\n                //Handled for inline images/UIelements.\n                lastTextElement = i;\n                isSplitByWord = true;\n                break;\n            }\n        }\n        if (isSplitByWord) {\n            lastTextElement++;\n            if (lastTextElement < line.children.length) {\n                var splitWidth = 0;\n                for (var i = lastTextElement; i < line.children.length; i++) {\n                    splitWidth += line.children[i].width;\n                    this.addSplittedLineWidget(line, i - 1);\n                    i--;\n                }\n                this.viewer.updateClientWidth(splitWidth);\n            }\n        }\n        return isSplitByWord;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearListElementBox = function (paragraph) {\n        if (paragraph.childWidgets.length === 0) {\n            return;\n        }\n        var line = paragraph.childWidgets[0];\n        if (isNullOrUndefined(line.children)) {\n            return;\n        }\n        for (var i = 0; i < line.children.length; i++) {\n            if (line.children[i] instanceof ListTextElementBox) {\n                line.children.splice(i, 1);\n                i--;\n            }\n            else {\n                break;\n            }\n        }\n    };\n    /**\n     * Gets list number.\n     * @param listFormat\n     * @param document\n     * @private\n     */\n    Layout.prototype.getListNumber = function (listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var levelNumber = listFormat.listLevelNumber;\n        var listLevel = this.getListLevel(list, listFormat.listLevelNumber);\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[levelNumber] : undefined;\n        // If LevelOverride exists and have either override list level or StartAtOverride, then only list numbering will be restarted.\n        // tslint:disable-next-line:max-line-length\n        // if (!isNullOrUndefined(levelOverride) && !(document.renderedLevelOverrides.indexOf(levelOverride) > -1) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n        //     //Add List Override style\n        //     document.renderedLevelOverrides.push(list.levelOverrides.getItem(levelNumber) as WLevelOverride);\n        //     if (document.renderedLists.containsKey((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId))) {\n        // tslint:disable-next-line:max-line-length\n        //         let levels: Dictionary<number, number> = document.renderedLists.get((list.wordDocument as WordDocument).getAbstractListById(list.abstractListId));\n        //         if (levels.containsKey(levelNumber)) {\n        //             levels.remove(levelNumber);\n        //         }\n        //     }\n        // }\n        this.updateListValues(list, levelNumber);\n        return this.getListText(list, levelNumber, listLevel);\n    };\n    /**\n     * Gets list start value\n     * @param listLevelNumber\n     * @param list\n     * @private\n     */\n    Layout.prototype.getListStartValue = function (listLevelNumber, list) {\n        // tslint:disable-next-line:max-line-length\n        var levelOverride = !isNullOrUndefined(list.levelOverrides) ? list.levelOverrides[listLevelNumber] : undefined;\n        if (!isNullOrUndefined(levelOverride) && isNullOrUndefined(levelOverride.overrideListLevel)) {\n            return levelOverride.startAt;\n        }\n        var listLevel = this.getListLevel(list, listLevelNumber);\n        if (isNullOrUndefined(listLevel)) {\n            return 0;\n        }\n        else {\n            return listLevel.startAt;\n        }\n    };\n    /**\n     * Updates list values.\n     * @param list\n     * @param listLevelNumber\n     * @param document\n     */\n    Layout.prototype.updateListValues = function (list, listLevelNumber) {\n        if (!this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(list.abstractListId))) {\n            var startVal = new Dictionary();\n            this.viewer.renderedLists.add(this.viewer.getAbstractListById(list.abstractListId), startVal);\n            var listLevel = this.getListLevel(list, listLevelNumber);\n            for (var i = 0; i <= listLevelNumber; i++) {\n                startVal.add(i, this.getListStartValue(i, list));\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(list.abstractListId));\n            if (levels.containsKey(listLevelNumber)) {\n                var startAt = levels.get(listLevelNumber);\n                levels.set(listLevelNumber, startAt + 1);\n                var levelNumber = listLevelNumber + 1;\n                while (levelNumber < this.viewer.getAbstractListById(list.abstractListId).levels.length) {\n                    var listLevel = this.getListLevel(list, levelNumber);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    if (levels.containsKey(levelNumber) && listLevel.restartLevel > listLevelNumber) {\n                        levels.remove(levelNumber);\n                        // if (document.renderedListLevels.indexOf(listLevel) > -1) {\n                        //     document.renderedListLevels.pop();\n                        // }\n                    }\n                    // }\n                    levelNumber++;\n                }\n            }\n            else {\n                var levelNumber = listLevelNumber;\n                while (!levels.containsKey(levelNumber - 1) && levelNumber > 0) {\n                    var listLevel = this.getListLevel(list, levelNumber - 1);\n                    // if (!isNullOrUndefined(listLevel)) {\n                    levels.add(levelNumber - 1, this.getListStartValue(levelNumber - 1, list));\n                    // if (document.renderedListLevels.indexOf(listLevel) !== -1) {\n                    //     document.renderedListLevels.push(listLevel);\n                    // }\n                    // }\n                    levelNumber--;\n                }\n                var startAt = this.getListStartValue(listLevelNumber, list);\n                levels.add(listLevelNumber, startAt);\n            }\n        }\n    };\n    /**\n     * Gets list text\n     * @param listAdv\n     * @param listLevelNumber\n     * @param currentListLevel\n     * @param document\n     */\n    Layout.prototype.getListText = function (listAdv, listLevelNumber, currentListLevel) {\n        var listText = currentListLevel.numberFormat;\n        // tslint:disable-next-line:max-line-length\n        if (this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(listAdv.abstractListId))) {\n            var levels = this.viewer.renderedLists.get(this.viewer.getAbstractListById(listAdv.abstractListId));\n            var keys = levels.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var levelNumber = keys[i];\n                var levelKey = '%' + (levelNumber + 1).toString();\n                var listLevel = this.getListLevel(listAdv, levelNumber);\n                if (listText.match(levelKey)) {\n                    if (levelNumber > listLevelNumber) {\n                        return '';\n                    }\n                    else if (levels.containsKey(levelNumber) && !isNullOrUndefined(listLevel)) {\n                        listText = listText.replace(levelKey, this.getListTextListLevel(listLevel, levels.get(levelNumber)));\n                    }\n                    else {\n                        listText = listText.replace(levelKey, '0');\n                    }\n                }\n            }\n        }\n        return listText;\n    };\n    /**\n     * Gets the roman letter.\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsLetter = function (number) {\n        // if (number <= 0) {\n        //     return '';\n        // }\n        var quotient = number / 26;\n        var remainder = number % 26;\n        if (remainder === 0) {\n            //If number denotes the factor of 26, then reduce quotient by 1 and set remainder as 26.\n            remainder = 26;\n            quotient--;\n        }\n        //Index of A char in the ASCII table.     \n        var letter = String.fromCharCode(65 - 1 + remainder);\n        var listValue = '';\n        while (quotient >= 0) {\n            listValue = listValue + letter.toString();\n            quotient--;\n        }\n        return listValue;\n    };\n    /**\n     * Gets list text using list level pattern.\n     * @param listLevel\n     * @param listValue\n     * @private\n     */\n    Layout.prototype.getListTextListLevel = function (listLevel, listValue) {\n        switch (listLevel.listLevelPattern) {\n            case 'UpRoman':\n                return this.getAsRoman(listValue).toUpperCase();\n            case 'LowRoman':\n                return this.getAsRoman(listValue).toLowerCase();\n            case 'UpLetter':\n                return this.getAsLetter(listValue).toUpperCase();\n            case 'LowLetter':\n                return this.getAsLetter(listValue).toLowerCase();\n            case 'Arabic':\n                return (listValue).toString();\n            case 'LeadingZero':\n                return this.getAsLeadingZero(listValue);\n            case 'Number':\n                return (listValue).toString();\n            case 'OrdinalText':\n                return (listValue).toString();\n            case 'Ordinal':\n                return (listValue).toString();\n            case 'FarEast':\n                return (listValue).toString();\n            case 'Special':\n                return (listValue).toString();\n            default:\n                return '';\n        }\n    };\n    /**\n     * Generate roman number for the specified number.\n     * @param number\n     * @param magnitude\n     * @param letter\n     */\n    Layout.prototype.generateNumber = function (number, magnitude, letter) {\n        var numberstring = '';\n        while (number >= magnitude) {\n            number -= magnitude;\n            numberstring += letter;\n            this.value = number;\n        }\n        return numberstring.toString();\n    };\n    /**\n     * Gets list value prefixed with zero, if less than 10\n     * @param listValue\n     */\n    Layout.prototype.getAsLeadingZero = function (listValue) {\n        if (listValue < 10) {\n            return '0' + listValue.toString();\n        }\n        else {\n            return listValue.toString();\n        }\n    };\n    /**\n     * Gets the roman number\n     * @param number\n     * @private\n     */\n    Layout.prototype.getAsRoman = function (number) {\n        var retval = '';\n        this.value = number;\n        retval += this.generateNumber(this.value, 1000, 'M');\n        retval += this.generateNumber(this.value, 900, 'CM');\n        retval += this.generateNumber(this.value, 500, 'D');\n        retval += this.generateNumber(this.value, 400, 'CD');\n        retval += this.generateNumber(this.value, 100, 'C');\n        retval += this.generateNumber(this.value, 90, 'XC');\n        retval += this.generateNumber(this.value, 50, 'L');\n        retval += this.generateNumber(this.value, 40, 'XL');\n        retval += this.generateNumber(this.value, 10, 'X');\n        retval += this.generateNumber(this.value, 9, 'IX');\n        retval += this.generateNumber(this.value, 5, 'V');\n        retval += this.generateNumber(this.value, 4, 'IV');\n        retval += this.generateNumber(this.value, 1, 'I');\n        return retval.toString();\n    };\n    /**\n     * Gets the list level\n     * @param list\n     * @param listLevelNumber\n     * @private\n     */\n    Layout.prototype.getListLevel = function (list, listLevelNumber) {\n        if (!isNullOrUndefined(list)) {\n            var abstractList = this.viewer.getAbstractListById(list.abstractListId);\n            if (!isNullOrUndefined(list) && abstractList.levels.length <= listLevelNumber\n                && listLevelNumber >= 0 && listLevelNumber < 9) {\n                this.addListLevels(abstractList);\n            }\n            var levelOverrideAdv = undefined;\n            var level = false;\n            level = (!isNullOrUndefined(list.levelOverrides))\n                && !isNullOrUndefined(((levelOverrideAdv = list.levelOverrides[listLevelNumber])))\n                && (!isNullOrUndefined(levelOverrideAdv.overrideListLevel));\n            if (level) {\n                return levelOverrideAdv.overrideListLevel;\n            }\n            else if (!isNullOrUndefined(abstractList) && listLevelNumber >= 0 && listLevelNumber < abstractList.levels.length) {\n                return abstractList.levels[listLevelNumber];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Gets tab width\n     * @param paragraph\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTabWidth = function (paragraph, viewer, index, lineWidget, element) {\n        var fposition = 0;\n        var isCustomTab = false;\n        var tabs = paragraph.paragraphFormat.getUpdatedTabs();\n        //  Calculate hanging width\n        if (viewer.clientActiveArea.x < viewer.clientArea.x) {\n            return viewer.clientArea.x - viewer.clientActiveArea.x;\n        }\n        // Calculates tabwidth based on pageleftmargin and defaulttabwidth property\n        var position = viewer.clientActiveArea.x -\n            (viewer.clientArea.x - HelperMethods.convertPointToPixel(paragraph.paragraphFormat.leftIndent));\n        var defaultTabWidth = HelperMethods.convertPointToPixel(viewer.defaultTabWidth);\n        if (tabs.length === 0 && (position === 0 || defaultTabWidth === 0)) {\n            return defaultTabWidth;\n        }\n        else {\n            if (tabs.length > 0) {\n                for (var i = 0; i < tabs.length; i++) {\n                    var tabPosition = HelperMethods.convertPointToPixel(tabs[i].position);\n                    if (tabs[i].tabJustification === 'Left' && position < tabPosition) {\n                        fposition = tabPosition;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                    else if (tabs[i].tabJustification === 'Right' && position < tabPosition) {\n                        var tabwidth = tabPosition - position;\n                        var width = this.getRightTabWidth(index + 1, lineWidget, paragraph);\n                        if (width < tabwidth) {\n                            defaultTabWidth = tabwidth - width;\n                        }\n                        else {\n                            defaultTabWidth = 0;\n                        }\n                        fposition = position;\n                        isCustomTab = true;\n                        if (!isNullOrUndefined(element)) {\n                            element.tabLeader = tabs[i].tabLeader;\n                            element.tabText = '';\n                        }\n                        break;\n                    }\n                }\n            }\n            if (!isCustomTab) {\n                var diff = ((Math.round(position) * 100) % (Math.round(defaultTabWidth) * 100)) / 100;\n                var cnt = (Math.round(position) - diff) / Math.round(defaultTabWidth);\n                fposition = (cnt + 1) * defaultTabWidth;\n            }\n            return (fposition - position) > 0 ? fposition - position : defaultTabWidth;\n        }\n    };\n    /**\n     * Returns the right tab width\n     * @param index - index of starting inline\n     * @param lineWidget - current line widget\n     * @param paragraph - current paragraph widget\n     */\n    Layout.prototype.getRightTabWidth = function (index, lineWidget, paragraph) {\n        var width = 0;\n        var isFieldCode = false;\n        while (index < lineWidget.children.length) {\n            var elementBox = lineWidget.children[index];\n            if ((elementBox instanceof FieldElementBox) || (elementBox instanceof BookmarkElementBox) || isFieldCode) {\n                if (elementBox instanceof FieldElementBox) {\n                    if (elementBox.fieldType === 0) {\n                        isFieldCode = true;\n                    }\n                    else if (elementBox.fieldType === 2) {\n                        isFieldCode = false;\n                    }\n                }\n                elementBox.width = 0;\n            }\n            else {\n                this.viewer.textHelper.getTextSize(elementBox, elementBox.characterFormat);\n            }\n            if (elementBox instanceof TextElementBox && elementBox.text === '\\t') {\n                return width;\n            }\n            else {\n                width = width + elementBox.width;\n            }\n            index++;\n        }\n        return width;\n    };\n    /**\n     * Gets split index by word.\n     * @param clientActiveWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    Layout.prototype.getSplitIndexByWord = function (clientActiveWidth, text, width, characterFormat) {\n        var index = 0;\n        var length = text.length;\n        while (index < length) {\n            var nextIndex = this.getTextIndexAfterSpace(text, index);\n            if (nextIndex === 0 || nextIndex === length) {\n                nextIndex = length - 1;\n            }\n            var splitWidth = width;\n            if ((nextIndex < length - 1 || (nextIndex === length - 1 && text[nextIndex - 1] === ' ')) && index !== nextIndex) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.slice(0, nextIndex), characterFormat);\n            }\n            if (splitWidth <= clientActiveWidth) {\n                index = nextIndex;\n            }\n            else {\n                if (index === 0 && text[0] === ' ') {\n                    index = this.getTextIndexAfterSpace(text, 0);\n                }\n                break;\n            }\n        }\n        return index;\n    };\n    /**\n     * Gets split index by character\n     * @param totalClientWidth\n     * @param clientActiveAreaWidth\n     * @param text\n     * @param width\n     * @param characterFormat\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getTextSplitIndexByCharacter = function (totalClientWidth, clientActiveAreaWidth, text, width, characterFormat) {\n        var length = text.length;\n        for (var i = 0; i < length; i++) {\n            var splitWidth = width;\n            if (i + 1 < length) {\n                splitWidth = this.viewer.textHelper.measureTextExcludingSpaceAtEnd(text.substring(0, i + 1), characterFormat);\n            }\n            if (splitWidth > clientActiveAreaWidth) {\n                if (i === 0 && splitWidth > totalClientWidth) {\n                    //Handle for cell/section having client width less than a character's width.\n                    return (length > 1 && text[1] === ' ') ? this.getTextIndexAfterSpace(text, 1) : 1;\n                }\n                return i;\n            }\n        }\n        return 0;\n    };\n    /**\n     * Gets sub width.\n     * @param justify\n     * @param spaceCount\n     * @param firstLineIndent\n     */\n    Layout.prototype.getSubWidth = function (lineWidget, justify, spaceCount, firstLineIndent) {\n        var width = 0;\n        var trimSpace = true;\n        var lineText = '';\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var element = lineWidget.children[i];\n            if (element instanceof TextElementBox) {\n                var elementText = element.text;\n                lineText = elementText + lineText;\n                if (trimSpace && (elementText.trim() !== '' || elementText === '\\t')) {\n                    if (HelperMethods.endsWith(elementText)) {\n                        width += this.viewer.textHelper.measureTextExcludingSpaceAtEnd(elementText, element.characterFormat);\n                    }\n                    else {\n                        width += element.width;\n                    }\n                    trimSpace = false;\n                }\n                else if (!trimSpace) {\n                    width += element.width;\n                }\n            }\n            else {\n                lineText = 'a' + lineText;\n                trimSpace = false;\n                width += element.width;\n            }\n            if (!justify) {\n                width = Math.round(width);\n            }\n        }\n        lineText = lineText.trim();\n        spaceCount = lineText.length - HelperMethods.removeSpace(lineText).length;\n        var subWidth = (this.viewer.clientArea.width - firstLineIndent - width);\n        if (subWidth <= 0 || (spaceCount === 0 && justify)) {\n            spaceCount = 0;\n            subWidth = 0;\n        }\n        else if (justify) {\n            subWidth = subWidth / spaceCount;\n        }\n        return { 'subWidth': subWidth, 'spaceCount': spaceCount };\n    };\n    /**\n     * Gets before spacing.\n     * @param paragraph\n     * @private\n     */\n    Layout.prototype.getBeforeSpacing = function (paragraph) {\n        var beforeSpacing = 0;\n        if (paragraph.previousWidget instanceof ParagraphWidget) {\n            if (paragraph.previousWidget.paragraphFormat.afterSpacing < paragraph.paragraphFormat.beforeSpacing) {\n                // tslint:disable-next-line:max-line-length\n                beforeSpacing = paragraph.paragraphFormat.beforeSpacing - paragraph.previousWidget.paragraphFormat.afterSpacing;\n            }\n        }\n        else {\n            beforeSpacing = paragraph.paragraphFormat.beforeSpacing;\n        }\n        return beforeSpacing;\n    };\n    /**\n     * Gets line spacing.\n     * @param paragraph\n     * @param maxHeight\n     * @private\n     */\n    Layout.prototype.getLineSpacing = function (paragraph, maxHeight) {\n        if (isNullOrUndefined(paragraph.paragraphFormat)) {\n            return 0;\n        }\n        var lineSpacing = 0;\n        switch (paragraph.paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n            case 'Exactly':\n                lineSpacing = paragraph.paragraphFormat.lineSpacing;\n                break;\n            default:\n                lineSpacing = paragraph.paragraphFormat.lineSpacing * maxHeight;\n                break;\n        }\n        return lineSpacing;\n    };\n    /**\n     * Checks whether current line is first line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphFirstLine = function (paragraph, line) {\n        var widget = paragraph;\n        if (isNullOrUndefined(widget.childWidgets) || widget.childWidgets.indexOf(line) === 0) {\n            //If the line elements conatins the elements from previous paragraph then need to retun false.\n            //Example scenario, Field start and field end in different paragraphs.\n            if (line.children.length > 0 && !isNullOrUndefined(paragraph.previousWidget)\n                && paragraph.previousWidget instanceof ParagraphWidget) {\n                return line.paragraph.index !== paragraph.previousWidget.index;\n            }\n            return true; //If the line elements count is zero then also need to return true.\n        }\n        return false;\n    };\n    /**\n     * Checks whether current line is last line in a paragraph.\n     * @param paragraph\n     */\n    Layout.prototype.isParagraphLastLine = function (element) {\n        var paragraph = element.line.paragraph;\n        var lastLineWidget = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        var lastInline = lastLineWidget.children[lastLineWidget.children.length - 1];\n        if (element === lastInline) {\n            // tslint:disable-next-line:max-line-length            \n            return (lastInline instanceof FieldElementBox) || ((!(lastInline instanceof TextElementBox && lastInline.text === '\\v')));\n        }\n        return false;\n    };\n    /**\n     * Gets text index after space.\n     * @param text\n     * @param startIndex\n     */\n    Layout.prototype.getTextIndexAfterSpace = function (text, startIndex) {\n        var length = text.length;\n        var index = 0;\n        index = text.indexOf(' ', startIndex) + 1;\n        var nextIndex = index;\n        if (nextIndex === 0 || nextIndex === length) {\n            return nextIndex;\n        }\n        while (text[nextIndex] === ' ') {\n            nextIndex++;\n            if (nextIndex === length) {\n                break;\n            }\n        }\n        return nextIndex;\n    };\n    //#region Table\n    /**\n     * @private\n     */\n    Layout.prototype.moveNextWidgetsToTable = function (tableWidget, rowWidgets, moveFromNext) {\n        var currentRow = moveFromNext ? rowWidgets[rowWidgets.length - 2] : rowWidgets[rowWidgets.length - 1];\n        var rowIndex = currentRow.indexInOwner;\n        var currentTable = tableWidget[tableWidget.length - 1];\n        if (moveFromNext) {\n            rowIndex += 1;\n        }\n        var nextWidgets = currentRow.containerWidget.childWidgets.splice(rowIndex);\n        for (var i = 0; i < nextWidgets.length; i++) {\n            currentTable.childWidgets.push(nextWidgets[i]);\n            nextWidgets[i].containerWidget = currentTable;\n        }\n    };\n    /**\n     * Adds table cell widget.\n     * @param cell\n     * @param area\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.addTableCellWidget = function (cell, area, maxCellMarginTop, maxCellMarginBottom) {\n        //let tableCellWidget: TableCellWidget = new TableCellWidget(cell);\n        var prevColumnIndex = 0;\n        var cellspace = 0;\n        var left = 0;\n        var top = maxCellMarginTop;\n        var right = 0;\n        var bottom = maxCellMarginBottom;\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            if (cell.cellFormat.containsMargins()) {\n                // tslint:disable-next-line:max-line-length\n                left = isNullOrUndefined(cell.cellFormat.leftMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.leftMargin);\n                right = isNullOrUndefined(cell.cellFormat.rightMargin) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin) : HelperMethods.convertPointToPixel(cell.cellFormat.rightMargin);\n            }\n            else {\n                left = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.leftMargin);\n                right = HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.rightMargin);\n            }\n        }\n        cell.margin = new Margin(left, top, right, bottom);\n        cell.width = HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n        if (!isNullOrUndefined(cell.previousWidget)) {\n            // tslint:disable-next-line:max-line-length\n            prevColumnIndex = cell.previousWidget.columnIndex + cell.previousWidget.cellFormat.columnSpan;\n        }\n        // tslint:disable-next-line:max-line-length\n        cellspace = !isNullOrUndefined(cell.ownerTable) && !isNullOrUndefined(cell.ownerTable.tableFormat) ? HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) : 0;\n        var prevSpannedCellWidth = 0;\n        if (prevColumnIndex < cell.columnIndex) {\n            // tslint:disable-next-line:max-line-length\n            prevSpannedCellWidth = HelperMethods.convertPointToPixel(cell.ownerTable.tableHolder.getPreviousSpannedCellWidth(prevColumnIndex, cell.columnIndex));\n            if (prevColumnIndex === 0) {\n                prevSpannedCellWidth = prevSpannedCellWidth - cellspace / 2;\n            }\n        }\n        cell.x = area.x + prevSpannedCellWidth + cell.margin.left;\n        cell.y = area.y + cell.margin.top + cellspace;\n        cell.width = cell.width - cell.margin.left - cell.margin.right;\n        if (cellspace > 0) {\n            cell.x += cellspace;\n            if (cell.ownerTable.tableHolder.columns.length === 1) {\n                cell.width -= cellspace * 2;\n            }\n            else if (cell.columnIndex === 0 || cell.columnIndex === cell.ownerTable.tableHolder.columns.length - 1) {\n                cell.width -= ((cellspace * 2) - cellspace / 2);\n            }\n            else {\n                cell.width -= cellspace;\n            }\n        }\n        // update the margins values respect to layouting of borders.\n        // tslint:disable-next-line:max-line-length\n        //For normal table cells only left border is rendred. for last cell left and right border is rendred. this border widths are not included in margins.\n        cell.leftBorderWidth = HelperMethods.convertPointToPixel(TableCellWidget.getCellLeftBorder(cell).getLineWidth());\n        cell.x += cell.leftBorderWidth;\n        cell.width -= cell.leftBorderWidth;\n        if (cellspace > 0 || cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n            cell.rightBorderWidth = TableCellWidget.getCellRightBorder(cell).getLineWidth();\n            cell.width -= cell.rightBorderWidth;\n        }\n        //Add the border widths to respective margin side.\n        cell.margin.left = cell.margin.left + cell.leftBorderWidth;\n        cell.margin.right = cell.margin.right + cell.rightBorderWidth;\n        //cell.ownerWidget = owner;\n        return cell;\n    };\n    /**\n     * Adds specified row widget to table.\n     * @param viewer\n     * @param tableRowWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.addWidgetToTable = function (viewer, tableCollection, rowCollection, row, endRowWidget) {\n        //Adds table row widget to owner table widget.\n        var tableWidget = tableCollection[0];\n        var index = tableWidget.childWidgets.length;\n        var prevWidget = undefined;\n        var rowWidgetIndex = rowCollection.indexOf(row);\n        if (rowWidgetIndex > 0) {\n            prevWidget = rowCollection[rowWidgetIndex - 1];\n            // Need to update on this further\n        }\n        else if (row.previousRenderedWidget instanceof TableRowWidget &&\n            row.previousRenderedWidget.ownerTable.equals(row.ownerTable)) {\n            // Need to update on this further\n            prevWidget = row.previousRenderedWidget;\n        }\n        if (!isNullOrUndefined(prevWidget)) {\n            tableWidget = prevWidget.containerWidget;\n            // index = tableWidget.childWidgets.length;\n            index = tableWidget.childWidgets.indexOf(prevWidget) + 1;\n            if (Math.round(row.y) !== Math.round(prevWidget.y + prevWidget.height)) {\n                var prevIndex = tableCollection.indexOf(tableWidget);\n                if (prevIndex + 1 >= tableCollection.length) {\n                    //Creates new table widget for splitted rows.\n                    this.addTableWidget(viewer.clientActiveArea, tableCollection, true);\n                }\n                tableWidget = tableCollection[prevIndex + 1];\n                index = tableWidget.childWidgets.length;\n            }\n            if (rowWidgetIndex > 0) {\n                index = 0;\n            }\n        }\n        this.updateRowHeightBySpannedCell(tableWidget, row, index);\n        this.updateRowHeightByCellSpacing(tableCollection, row, viewer);\n        //Remove widget from previous container after splitteing\n        if (row.containerWidget && row.containerWidget !== tableWidget &&\n            row.containerWidget.childWidgets.indexOf(row) !== -1) {\n            row.containerWidget.childWidgets.splice(row.containerWidget.childWidgets.indexOf(row), 1);\n        }\n        if (tableWidget.childWidgets.indexOf(row) === -1) {\n            tableWidget.childWidgets.splice(index, 0, row);\n        }\n        row.containerWidget = tableWidget;\n        tableWidget.height = tableWidget.height + row.height;\n        if (!isNullOrUndefined(tableWidget.containerWidget)\n            && tableWidget.containerWidget.childWidgets.indexOf(tableWidget) >= 0 &&\n            !(tableWidget.containerWidget instanceof HeaderFooterWidget)) {\n            tableWidget.containerWidget.height += row.height;\n        }\n        this.updateHeightForRowWidget(viewer, false, tableCollection, rowCollection, row, false, endRowWidget);\n        viewer.cutFromTop(row.y + row.height);\n    };\n    /**\n     * Updates row height by spanned cell.\n     * @param tableWidget\n     * @param rowWidget\n     * @param insertIndex\n     * @param row\n     * @private\n     */\n    Layout.prototype.updateRowHeightBySpannedCell = function (tableWidget, row, insertIndex) {\n        var rowSpan = 1;\n        if (tableWidget.childWidgets.length === 0 || insertIndex === 0) {\n            this.updateRowHeight(row, row);\n            return;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cellWidget = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            this.updateSpannedRowCollection(rowSpan, row);\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            for (var i = 0; i < row.ownerTable.spannedRowCollection.length; i++) {\n                if (row.ownerTable.spannedRowCollection.keys[i] === row.index) {\n                    // Back track to previous table row widgets and update it height if vertical merge ends with this row.\n                    for (var j = 0; j < insertIndex; j++) {\n                        var prevRowWidget = tableWidget.childWidgets[j];\n                        this.updateRowHeight(prevRowWidget, row);\n                    }\n                    row.ownerTable.spannedRowCollection.remove(row.ownerTable.spannedRowCollection.keys[i]);\n                    break;\n                }\n            }\n        }\n    };\n    /**\n     * Updates row height.\n     * @param prevRowWidget\n     * @param rowWidget\n     * @param row\n     */\n    Layout.prototype.updateRowHeight = function (prevRowWidget, row) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < prevRowWidget.childWidgets.length; i++) {\n            var cellWidget = prevRowWidget.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan : cellWidget.cellFormat.rowSpan;\n            //To update Row height- if row has row span value greater than 1, need to add it in spannedRowCollection            \n            this.updateSpannedRowCollection(rowSpan, row);\n            if (rowIndex - cellWidget.rowIndex === rowSpan - 1) {\n                var mergedCellHeight = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - row.y;\n                if (row.height < mergedCellHeight) {\n                    row.height = mergedCellHeight;\n                }\n            }\n        }\n    };\n    //if row has row span value greater than 1, need to add it in spannedRowCollection\n    Layout.prototype.updateSpannedRowCollection = function (rowSpan, row) {\n        if (rowSpan > 1 && !isNullOrUndefined(row.ownerTable)) {\n            //Checks the rowspan is already exist in the list\n            if (!row.ownerTable.spannedRowCollection.containsKey(row.index + rowSpan - 1)) {\n                row.ownerTable.spannedRowCollection.add(row.index + rowSpan - 1, row.index);\n            }\n        }\n    };\n    /**\n     * Updates row height by cell spacing\n     * @param rowWidget\n     * @param viewer\n     * @param row\n     */\n    Layout.prototype.updateRowHeightByCellSpacing = function (tableCollection, row, viewer) {\n        if (row.ownerTable.tableFormat.cellSpacing > 0) {\n            // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n            // In such case we have update the row height with half of cell spacing.\n            // Remaining cases we have to update the entire hight\n            // tslint:disable-next-line:max-line-length\n            if (tableCollection.length > 1 && row.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                row.height = row.height - HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) / 2;\n            }\n        }\n    };\n    /**\n     * Checks whether row span is end.\n     * @param row\n     * @param viewer\n     */\n    Layout.prototype.isRowSpanEnd = function (row, viewer) {\n        var rowIndex = row.index;\n        var rowSpan = 1;\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n            if (rowIndex - splittedCell.rowIndex === rowSpan - 1) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Checks whether vertical merged cell to continue or not.\n     * @param row\n     * @private\n     */\n    Layout.prototype.isVerticalMergedCellContinue = function (row) {\n        var colIndex = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            if (colIndex < cell.columnIndex) {\n                return true;\n            }\n            colIndex += cell.cellFormat.columnSpan;\n        }\n        return colIndex < row.ownerTable.tableHolder.columns.length;\n    };\n    /**\n     * Splits widgets.\n     * @param tableRowWidget\n     * @param viewer\n     * @param splittedWidget\n     * @param row\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidgets = function (tableRowWidget, viewer, tableCollection, rowCollection, splittedWidget, isLastRow) {\n        if (this.isFirstLineFitForRow(viewer.clientArea.bottom, tableRowWidget) && tableRowWidget.childWidgets.length > 0) {\n            splittedWidget = this.getSplittedWidgetForRow(viewer.clientArea.bottom, tableCollection, rowCollection, tableRowWidget);\n            if (viewer.splittedCellWidgets.length > 0 || splittedWidget !== tableRowWidget) {\n                if (isLastRow) {\n                    for (var i = 0; i < splittedWidget.childWidgets.length; i++) {\n                        var cell = splittedWidget.childWidgets[i];\n                        if (cell.rowIndex !== splittedWidget.index) {\n                            splittedWidget.childWidgets.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n                this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n            }\n        }\n        else {\n            //Adds the splitted widget of a vertical merged cell, to next row widget in the next page.\n            this.insertSplittedCellWidgets(viewer, tableCollection, splittedWidget, tableRowWidget.indexInOwner - 1);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted widget for row.\n     * @param bottom\n     * @param tableRowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForRow = function (bottom, tableCollection, rowCollection, tableRowWidget) {\n        var splittedWidget = undefined;\n        var rowIndex = tableRowWidget.index;\n        for (var i = 0; i < tableRowWidget.childWidgets.length; i++) {\n            var cellWidget = tableRowWidget.childWidgets[i];\n            var splittedCell = this.getSplittedWidget(bottom, true, tableCollection, rowCollection, cellWidget);\n            if (!isNullOrUndefined(splittedCell)) {\n                if (splittedCell === cellWidget) {\n                    //Returns if the whole content of the row does not fit in current page.\n                    return tableRowWidget;\n                }\n                if (tableRowWidget.childWidgets.indexOf(splittedCell) !== -1) {\n                    tableRowWidget.childWidgets.splice(tableRowWidget.childWidgets.indexOf(splittedCell), 1);\n                }\n                if (i === 0 || tableRowWidget.height < cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom) {\n                    tableRowWidget.height = cellWidget.height + cellWidget.margin.top + cellWidget.margin.bottom;\n                }\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new TableRowWidget();\n                    splittedWidget.containerWidget = tableRowWidget.containerWidget;\n                    splittedWidget.index = tableRowWidget.index;\n                    splittedWidget.rowFormat = tableRowWidget.rowFormat;\n                    this.updateWidgetLocation(tableRowWidget, splittedWidget);\n                    splittedWidget.height = 0;\n                    rowCollection.push(splittedWidget);\n                }\n                var rowSpan = 1;\n                // tslint:disable-next-line:max-line-length\n                rowSpan = (isNullOrUndefined(splittedCell) || isNullOrUndefined(splittedCell.cellFormat)) ? rowSpan : splittedCell.cellFormat.rowSpan;\n                if (rowIndex - splittedCell.rowIndex === rowSpan - 1\n                    && splittedWidget.height < splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom) {\n                    splittedWidget.height = splittedCell.height + splittedCell.margin.top + splittedCell.margin.bottom;\n                }\n                splittedWidget.childWidgets.push(splittedCell);\n                splittedCell.containerWidget = splittedWidget;\n            }\n        }\n        return splittedWidget;\n    };\n    /**\n     * Updates widget to table.\n     * @param row\n     * @param viewer\n     */\n    /* tslint:disable */\n    Layout.prototype.updateWidgetsToTable = function (tableWidgets, rowWidgets, row) {\n        var rowHeight = this.getRowHeight(row, [row]);\n        var viewer = this.viewer;\n        //initializing row properties with default values.\n        var isHeader = row.rowFormat.isHeader;\n        var isAllowBreakAcrossPages = row.rowFormat.allowBreakAcrossPages;\n        var heightType = row.rowFormat.heightType;\n        var cellSpacing = 0;\n        var count = 0;\n        var tableRowWidget = row;\n        var moveRowToNextTable = false;\n        if (row.ownerTable.continueHeader && !isHeader) {\n            row.ownerTable.continueHeader = false;\n        }\n        var isLastRow = false;\n        cellSpacing = (!isNullOrUndefined(row.ownerTable) && !isNullOrUndefined(row.ownerTable.tableFormat)) ? HelperMethods.convertPointToPixel(row.ownerTable.tableFormat.cellSpacing) : 0;\n        while (count < rowWidgets.length) {\n            count = rowWidgets.length;\n            if (row.ownerTable.isInsideTable || (viewer.splittedCellWidgets.length === 0 && tableRowWidget.y + tableRowWidget.height + cellSpacing <= viewer.clientArea.bottom)) {\n                this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                if (viewer.splittedCellWidgets.length > 0 && isNullOrUndefined(rowWidgets[rowWidgets.length - 1].nextRow)) {\n                    count--;\n                    isLastRow = true;\n                }\n            }\n            else {\n                //Split widget for next page\n                if (viewer.splittedCellWidgets.length > 0 && tableRowWidget.y + tableRowWidget.height <= viewer.clientArea.bottom) {\n                    var isRowSpanEnd = this.isRowSpanEnd(row, viewer);\n                    if (!isRowSpanEnd) {\n                        if (this.isVerticalMergedCellContinue(row) && tableRowWidget.y == viewer.clientArea.y) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, tableRowWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                        continue;\n                    }\n                }\n                var splittedWidget = tableRowWidget;\n                var tableWidget = tableWidgets[tableWidgets.length - 1];\n                if (rowHeight + tableRowWidget.y > viewer.clientArea.bottom) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isAllowBreakAcrossPages || (isHeader && row.ownerTable.continueHeader) || (heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientArea.bottom)) {\n                        // tslint:disable-next-line:max-line-length\n                        if ((heightType === 'AtLeast' && HelperMethods.convertPointToPixel(row.rowFormat.height) < viewer.clientActiveArea.height && isAllowBreakAcrossPages) || (heightType !== 'Exactly' && tableRowWidget.y === viewer.clientArea.y) || (heightType === 'Auto' && isAllowBreakAcrossPages)) {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                        if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                        if (isHeader && row.ownerTable.continueHeader) {\n                            row.ownerTable.header = false;\n                            row.ownerTable.continueHeader = false;\n                            row.ownerTable.headerHeight = 0;\n                            var pages = undefined;\n                            // if (viewer instanceof PageLayoutViewer) {\n                            pages = viewer.pages;\n                            // }\n                            if (!isNullOrUndefined(pages)) {\n                                for (var i = 0; i < pages.length; i++) {\n                                    if (pages[i].repeatHeaderRowTableWidget) {\n                                        pages[i].repeatHeaderRowTableWidget = false;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    else {\n                        if ((heightType === 'Auto' || heightType === 'AtLeast') && isAllowBreakAcrossPages) {\n                            // tslint:disable-next-line:max-line-length\n                            if (!(HelperMethods.convertPointToPixel(row.rowFormat.height) > viewer.clientArea.bottom) || tableRowWidget.y === viewer.clientArea.y) {\n                                splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                            }\n                        }\n                        else if (heightType === 'Exactly' && tableRowWidget.y === viewer.clientArea.y) {\n                            this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget);\n                            count++;\n                        }\n                    }\n                }\n                else {\n                    var isInsertSplittedWidgets = false;\n                    // Splitting handled for the merged cell with allowRowBreakAcross pages. \n                    if (this.isVerticalMergedCellContinue(row) && (isAllowBreakAcrossPages ||\n                        (isInsertSplittedWidgets = tableRowWidget.y == viewer.clientArea.y))) {\n                        if (isInsertSplittedWidgets) {\n                            this.insertSplittedCellWidgets(viewer, tableWidgets, splittedWidget, tableRowWidget.indexInOwner - 1);\n                        }\n                        else {\n                            splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                        }\n                    }\n                    else if (isLastRow && !isAllowBreakAcrossPages) {\n                        splittedWidget = this.splitWidgets(tableRowWidget, viewer, tableWidgets, rowWidgets, splittedWidget, isLastRow);\n                    }\n                }\n                //Create New table for splitted widget\n                if (!isNullOrUndefined(splittedWidget)) {\n                    if (splittedWidget !== tableRowWidget) {\n                        this.addWidgetToTable(viewer, tableWidgets, rowWidgets, tableRowWidget, tableRowWidget.nextRow);\n                        //Updates the fitted table rows to current page.\n                        this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, tableRowWidget.nextRow);\n                        var index_2 = tableWidgets.indexOf(tableRowWidget.containerWidget);\n                        if (index_2 + 1 >= tableWidgets.length) {\n                            //Creates new table widget for splitted rows.\n                            this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                        }\n                        tableRowWidget = splittedWidget;\n                    }\n                    else {\n                        if (row.index > 0) {\n                            //Updates the fitted table rows to current page.\n                            this.updateWidgetsToPage(tableWidgets, rowWidgets, row.ownerTable, row);\n                            // Need to update on this further\n                            if (row.previousRenderedWidget instanceof TableRowWidget) {\n                                // Need to update on this further\n                                var prevWidget = row.previousRenderedWidget;\n                                if (HelperMethods.round(tableRowWidget.y, 2) === HelperMethods.round(prevWidget.y + prevWidget.height, 2)) {\n                                    var prevIndex = tableWidgets.indexOf(prevWidget.containerWidget);\n                                    if (prevIndex + 1 >= tableWidgets.length) {\n                                        //Creates new table widget for splitted rows.\n                                        this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                    }\n                                }\n                                else {\n                                    //Creates new table widget for splitted rows.\n                                    this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                                }\n                            }\n                            else {\n                                //Creates new table widget for splitted rows.\n                                this.addTableWidget(viewer.clientActiveArea, tableWidgets, true);\n                            }\n                        }\n                        moveRowToNextTable = true;\n                        count--;\n                    }\n                    tableWidget = tableWidgets[tableWidgets.length - 1];\n                    var prevBodyWidget = undefined;\n                    if (tableWidgets.length > 1) {\n                        //Get Previous Splitted Widget container\n                        prevBodyWidget = tableWidgets[tableWidgets.length - 2].containerWidget;\n                    }\n                    else {\n                        var previousBlock = row.ownerTable.previousRenderedWidget;\n                        prevBodyWidget = previousBlock.containerWidget;\n                    }\n                    var pageIndex = 0;\n                    if (!isNullOrUndefined(prevBodyWidget)) {\n                        pageIndex = viewer.pages.indexOf(prevBodyWidget.page);\n                    }\n                    var index = row.ownerTable.containerWidget.index;\n                    var bodyWidget = void 0;\n                    var block = void 0;\n                    if (moveRowToNextTable && tableWidgets.length === 1) {\n                        block = tableWidgets[tableWidgets.length - 1];\n                    }\n                    else {\n                        block = tableWidgets[tableWidgets.length - 2];\n                    }\n                    bodyWidget = this.moveBlocksToNextPage(block);\n                    var curretTable = tableWidgets[tableWidgets.length - 1];\n                    //Move Next RowWidge to next page\n                    if (moveRowToNextTable) {\n                        // tslint:disable-next-line:max-line-length\n                        if (row.index === 0 && curretTable.containerWidget && curretTable.containerWidget.childWidgets.indexOf(curretTable) !== -1) {\n                            curretTable.containerWidget.childWidgets.splice(curretTable.containerWidget.childWidgets.indexOf(curretTable), 1);\n                        }\n                    }\n                    if (bodyWidget.childWidgets.indexOf(curretTable) !== -1) {\n                        bodyWidget.childWidgets.splice(bodyWidget.childWidgets.indexOf(curretTable), 1);\n                    }\n                    bodyWidget.childWidgets.unshift(curretTable);\n                    curretTable.containerWidget = bodyWidget;\n                    if (moveRowToNextTable && row.index > 0 || rowWidgets.length > 1) {\n                        this.moveNextWidgetsToTable(tableWidgets, rowWidgets, !moveRowToNextTable);\n                    }\n                    moveRowToNextTable = false;\n                    if (row.ownerTable.header && tableRowWidget.height < viewer.clientArea.bottom) {\n                        // if (viewer instanceof PageLayoutViewer) {\n                        viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n                        // }\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y + row.ownerTable.headerHeight;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y + row.ownerTable.headerHeight - cellspace, splittedWidget);\n                    }\n                    else {\n                        //Updates table widgets location.\n                        viewer.updateClientAreaForBlock(row.ownerTable, true, tableWidgets);\n                        // tslint:disable-next-line:max-line-length\n                        //Update splitted row widget location. if header is repeated update the y position of splitted widget to header height.\n                        splittedWidget.x = splittedWidget.x;\n                        splittedWidget.y = tableWidget.y;\n                        // let cellspace: number = viewer instanceof PageLayoutViewer ? cellspacing / 2 : cellspacing;\n                        var cellspace = cellSpacing / 2;\n                        this.updateChildLocationForRow(tableWidget.y - cellspace, splittedWidget);\n                    }\n                }\n                isLastRow = false;\n            }\n            if (isHeader && row.ownerTable.continueHeader) {\n                row.ownerTable.header = true;\n                row.ownerTable.headerHeight = rowHeight + row.ownerTable.headerHeight;\n            }\n            if (isHeader && !isNullOrUndefined(this.getHeader(row.ownerTable)) && row.index === this.getHeader(row.ownerTable).index) {\n                var headerHeight = this.getHeaderHeight(row.ownerTable, row, rowWidgets);\n                if (headerHeight > row.ownerTable.headerHeight || headerHeight > row.ownerTable.headerHeight) {\n                    row.ownerTable.headerHeight = headerHeight;\n                }\n                if (row.ownerTable.headerHeight > viewer.clientArea.height) {\n                    row.ownerTable.header = false;\n                    row.ownerTable.continueHeader = false;\n                    row.ownerTable.headerHeight = 0;\n                    var pages = viewer.pages;\n                    for (var i = 0; i < pages.length; i++) {\n                        if (pages[i].repeatHeaderRowTableWidget) {\n                            pages[i].repeatHeaderRowTableWidget = false;\n                        }\n                    }\n                }\n            }\n            if (tableWidgets.length > 2 && row.ownerTable.header && tableRowWidget.height < viewer.clientActiveArea.bottom &&\n                !viewer.currentRenderingPage.repeatHeaderRowTableWidget) {\n                viewer.currentRenderingPage.repeatHeaderRowTableWidget = true;\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * Gets header.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getHeader = function (table) {\n        var header = undefined;\n        var flag = true;\n        table = table.getSplitWidgets()[0];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.isHeader) {\n                header = row;\n            }\n            else {\n                flag = false;\n            }\n            if (!flag) {\n                break;\n            }\n        }\n        return header;\n    };\n    /**\n     * Gets header height.\n     * @param ownerTable\n     * @param row\n     */\n    Layout.prototype.getHeaderHeight = function (ownerTable, row, rowCollection) {\n        var height = 0;\n        if (row.ownerTable.childWidgets.length > 0 && ownerTable.childWidgets[0].rowFormat.isHeader) {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row_1 = ownerTable.childWidgets[i];\n                if (row_1.rowFormat.isHeader) {\n                    height = height + this.getRowHeight(row_1, rowCollection);\n                }\n                else {\n                    break;\n                }\n            }\n        }\n        return height;\n    };\n    /**\n     * Updates widgets to row.\n     * @param cell\n     */\n    Layout.prototype.updateWidgetToRow = function (cell) {\n        var viewer = this.viewer;\n        //Adds table cell widget to owner row widget.\n        var rowWidget = cell.ownerRow;\n        var cellLeft = rowWidget.x;\n        if (rowWidget.childWidgets.length > 0) {\n            var lastWidget = rowWidget.childWidgets[rowWidget.childWidgets.length - 1];\n            cellLeft = lastWidget.x + lastWidget.width + lastWidget.margin.right;\n        }\n        // rowWidget.childWidgets.push(cell);\n        cell.containerWidget = rowWidget;\n        //If the row height is set as Atleast then height is set to atleast height for the first cell of the row.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(cell.ownerRow) && cell.ownerRow.rowFormat.heightType !== 'Exactly' && HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height) > 0 && cell.cellIndex === 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(cell.ownerRow.rowFormat.height);\n        }\n        //Add condition not cell merged vertically.\n        if (cell.cellFormat.rowSpan === 1) {\n            var cellHeight = cell.height + cell.margin.top + cell.margin.bottom;\n            if (rowWidget.height - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing) < cellHeight) {\n                rowWidget.height = cellHeight + HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            }\n        }\n    };\n    /**\n     * Updates height for row widget.\n     * @param viewer\n     * @param isUpdateVerticalPosition\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForRowWidget = function (viewer, isUpdateVerticalPosition, tableCollection, rowCollection, rowWidget, isLayouted, endRowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellspacing = 0;\n            var cellWidget = undefined;\n            var childWidget = rowWidget.childWidgets[i];\n            // if (childWidget instanceof TableCellWidget) {\n            cellWidget = childWidget;\n            // }\n            var rowSpan = 1;\n            rowSpan = cellWidget.cellFormat.rowSpan;\n            cellspacing = HelperMethods.convertPointToPixel(cellWidget.ownerTable.tableFormat.cellSpacing);\n            if (rowSpan > 1) {\n                var currentRowWidgetIndex = rowWidget.containerWidget.childWidgets.indexOf(rowWidget);\n                // tslint:disable-next-line:max-line-length\n                var rowSpanWidgetEndIndex = currentRowWidgetIndex + rowSpan - 1 - (rowWidget.index - cellWidget.rowIndex);\n                if (viewer.clientArea.bottom < cellWidget.y + cellWidget.height + cellWidget.margin.bottom\n                    || rowSpanWidgetEndIndex >= currentRowWidgetIndex + 1) {\n                    this.splitSpannedCellWidget(cellWidget, tableCollection, rowCollection, viewer);\n                }\n                var spanEndRowWidget = rowWidget;\n                if (rowSpanWidgetEndIndex > 0) {\n                    if (rowSpanWidgetEndIndex < rowWidget.containerWidget.childWidgets.length) {\n                        var childWidget_1 = rowWidget.containerWidget.childWidgets[rowSpanWidgetEndIndex];\n                        if (childWidget_1 instanceof TableRowWidget) {\n                            spanEndRowWidget = childWidget_1;\n                            if (spanEndRowWidget === endRowWidget) {\n                                spanEndRowWidget = rowWidget;\n                            }\n                        }\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        spanEndRowWidget = rowWidget.containerWidget.childWidgets[rowWidget.containerWidget.childWidgets.length - 1];\n                    }\n                }\n                if (cellWidget.y + cellWidget.height + cellWidget.margin.bottom < spanEndRowWidget.y + spanEndRowWidget.height) {\n                    cellWidget.height = spanEndRowWidget.y + spanEndRowWidget.height - cellWidget.y - cellWidget.margin.bottom;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isLayouted && spanEndRowWidget && (spanEndRowWidget.y !== 0 && spanEndRowWidget.height !== 0) && cellWidget.y + cellWidget.height + cellWidget.margin.bottom > spanEndRowWidget.y + spanEndRowWidget.height) {\n                    spanEndRowWidget.height = cellWidget.y + cellWidget.height + cellWidget.margin.bottom - spanEndRowWidget.y;\n                    // tslint:disable-next-line:max-line-length\n                    //Update the next rowlayout widget location. Reason for the updation is previous row height is updated when cell height is greater. So already layouted next row location has to be updated again.\n                    // if (rowWidget === spanEndRowWidget && rowWidget.nextWidget instanceof TableRowWidget) {\n                    //     let nextRow: TableRowWidget = rowWidget.nextWidget as TableRowWidget;\n                    //     // Need to update on this further\n                    //     // if (viewer.renderedElements.containsKey(nextRow)) {\n                    //     //     let nextWidget: TableRowWidget[] = viewer.renderedElements.get(nextRow) as TableRowWidget[];\n                    //     //     if (nextWidget.length > 0) {\n                    //     //         nextWidget[0].x = nextWidget[0].x;\n                    //     //         nextWidget[0].y = rowWidget.y + rowWidget.height;\n                    //     //     }\n                    //     // }\n                    // }\n                }\n            }\n            else {\n                if (cellspacing > 0) {\n                    // In the Case of tableWidget is greater than one and rowWidget is start at the Top Position of the page. \n                    // In such case we have update the cell height with half of cell spacing.\n                    // Remaining cases we have to update the entire hight\n                    // tslint:disable-next-line:max-line-length\n                    if (tableCollection.length > 1 && rowWidget.y === viewer.clientArea.y && viewer instanceof PageLayoutViewer) {\n                        cellspacing = cellspacing / 2;\n                    }\n                }\n                cellWidget.height = rowWidget.height - cellWidget.margin.top - cellWidget.margin.bottom - cellspacing;\n            }\n            this.updateHeightForCellWidget(viewer, tableCollection, rowCollection, cellWidget);\n            var widget = rowWidget.containerWidget;\n            while (widget.containerWidget instanceof Widget) {\n                widget = widget.containerWidget;\n            }\n            var page = undefined;\n            if (widget instanceof BodyWidget) {\n                page = widget.page;\n            }\n            // tslint:disable-next-line:max-line-length\n            if ((viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(page) !== -1) || isUpdateVerticalPosition) {\n                this.updateCellVerticalPosition(cellWidget, false, false);\n            }\n            //Renders the current table row contents, after relayout based on editing.\n            // if (viewer instanceof PageLayoutViewer && (viewer as PageLayoutViewer).visiblePages.indexOf(page) !== -1) {\n            //     //Added proper undefined condition check for Asynchronous operation.\n            //     if (!isNullOrUndefined(rowWidget.tableRow) && !isNullOrUndefined(rowWidget.tableRow.rowFormat)) {\n            //         this.viewer.updateScrollBars();\n            //         //this.render.renderTableCellWidget(page, cellWidget);\n            //     }\n            // }\n        }\n    };\n    /**\n     * Updates height for cell widget.\n     * @param viewer\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForCellWidget = function (viewer, tableWidget, rowCollection, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateHeightForTableWidget(tableWidget, rowCollection, cellWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Gets row height.\n     * @param row\n     * @private\n     */\n    Layout.prototype.getRowHeight = function (row, rowCollection) {\n        var height = 0;\n        if (row.rowFormat.heightType === 'Exactly') {\n            height = row.rowFormat.height;\n        }\n        else {\n            for (var i = 0; i < rowCollection.length; i++) {\n                if (rowCollection[i] instanceof TableRowWidget) {\n                    height = rowCollection[i].height + height;\n                }\n            }\n            height = Math.max(height, row.rowFormat.height);\n        }\n        return height;\n    };\n    /**\n     * splits spanned cell widget.\n     * @param cellWidget\n     * @param viewer\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitSpannedCellWidget = function (cellWidget, tableCollection, rowCollection, viewer) {\n        var splittedCell = this.getSplittedWidget(viewer.clientArea.bottom, false, tableCollection, rowCollection, cellWidget);\n        if (!isNullOrUndefined(splittedCell)) {\n            //Adds the splitted contents of a vertical merged cell, in order preserve in next page.\n            viewer.splittedCellWidgets.push(splittedCell);\n        }\n    };\n    /**\n     * Inserts splitted cell widgets.\n     * @param viewer\n     * @param rowWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertSplittedCellWidgets = function (viewer, tableCollection, rowWidget, previousRowIndex) {\n        var left = rowWidget.x;\n        var tableWidth = 0;\n        tableWidth = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableHolder.tableWidth);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (Math.round(left) < Math.round(cellWidget.x - cellWidget.margin.left)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i)) {\n                    i--;\n                    continue;\n                }\n                var length_1 = rowWidget.childWidgets.length;\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i, previousRowIndex);\n                if (length_1 < rowWidget.childWidgets.length) {\n                    i--;\n                    continue;\n                }\n            }\n            left += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            if (i === rowWidget.childWidgets.length - 1 && Math.round(left) < Math.round(rowWidget.x + tableWidth)) {\n                if (this.insertRowSpannedWidget(rowWidget, viewer, left, i + 1)) {\n                    continue;\n                }\n                this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, i + 1, previousRowIndex);\n                continue;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        // Special case: when the child widgets of row is equal to 0 then the splitted widgets in the viewer is added in the table row widgets. \n        if ((isNullOrUndefined(rowWidget.childWidgets) || rowWidget.childWidgets.length === 0) && viewer.splittedCellWidgets.length > 0) {\n            for (var j = 0; j < viewer.splittedCellWidgets.length; j++) {\n                var widget = viewer.splittedCellWidgets[j];\n                if (Math.round(left) <= Math.round(widget.x - widget.margin.left)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j)) {\n                        j--;\n                        continue;\n                    }\n                    var count = rowWidget.childWidgets.length;\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j, previousRowIndex);\n                    if (count < rowWidget.childWidgets.length) {\n                        j--;\n                        continue;\n                    }\n                }\n                left += widget.margin.left + widget.width + widget.margin.right;\n                if (j === rowWidget.childWidgets.length - 1 && Math.round(left) <\n                    Math.round(rowWidget.x + tableWidth)) {\n                    if (this.insertRowSpannedWidget(rowWidget, viewer, left, j + 1)) {\n                        continue;\n                    }\n                    this.insertEmptySplittedCellWidget(rowWidget, tableCollection, left, j + 1, previousRowIndex);\n                    continue;\n                }\n            }\n        }\n        if (viewer.splittedCellWidgets.length > 0) {\n            viewer.splittedCellWidgets = [];\n        }\n    };\n    /**\n     * Inserts spanned row widget.\n     * @param rowWidget\n     * @param viewer\n     * @param left\n     * @param index\n     */\n    Layout.prototype.insertRowSpannedWidget = function (rowWidget, viewer, left, index) {\n        var cellSpacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            cellSpacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < viewer.splittedCellWidgets.length; i++) {\n            var splittedCell = viewer.splittedCellWidgets[i];\n            if (Math.round(left) === Math.round(splittedCell.x - splittedCell.margin.left)) {\n                rowWidget.childWidgets.splice(index, 0, splittedCell);\n                splittedCell.containerWidget = rowWidget;\n                //If the splitted cell location differs from expected location update the location of row child widgets.\n                if (splittedCell.y !== rowWidget.y + splittedCell.margin.top + cellSpacing) {\n                    this.updateChildLocationForRow(rowWidget.y, rowWidget);\n                }\n                viewer.splittedCellWidgets = [];\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Inserts empty splitted cell widgets.\n     * @param rowWidget\n     * @param left\n     * @param index\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.insertEmptySplittedCellWidget = function (currentRow, tableCollection, left, index, previousRowIndex) {\n        var tableWidget = tableCollection[tableCollection.length - 1];\n        for (var i = previousRowIndex; i >= 0; i--) {\n            var rowWidget = tableWidget.childWidgets[i];\n            var previousLeft = rowWidget.x;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var rowSpan = 1;\n                var cellWidget = rowWidget.childWidgets[j];\n                if (Math.round(left) === Math.round(previousLeft)) {\n                    rowSpan = (isNullOrUndefined(cellWidget) || isNullOrUndefined(cellWidget.cellFormat)) ? rowSpan :\n                        cellWidget.cellFormat.rowSpan;\n                    if (rowSpan > 1) {\n                        var emptyCellWidget = this.createCellWidget(cellWidget);\n                        currentRow.childWidgets.splice(index, 0, emptyCellWidget);\n                        emptyCellWidget.containerWidget = currentRow;\n                    }\n                    return;\n                }\n                previousLeft += cellWidget.margin.left + cellWidget.width + cellWidget.margin.right;\n            }\n        }\n    };\n    /**\n     * Gets spllited widget.\n     * @param bottom\n     * @param splitMinimalWidget\n     * @param cellWidget\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidget = function (bottom, splitMinimalWidget, tableCollection, rowCollection, cellWidget) {\n        var splittedWidget = undefined;\n        if (cellWidget.y + cellWidget.height > bottom - cellWidget.margin.bottom) {\n            for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n                if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                    var paragraphWidget = cellWidget.childWidgets[i];\n                    var splittedPara = this.getSplittedWidgetForPara(bottom - cellWidget.margin.bottom, paragraphWidget);\n                    if (!isNullOrUndefined(splittedPara)) {\n                        if (i === 0 && splittedPara === paragraphWidget) {\n                            //Returns if the whole content of the cell does not fit in current page.\n                            return cellWidget;\n                        }\n                        if (cellWidget.childWidgets.indexOf(splittedPara) !== -1) {\n                            cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedPara), 1);\n                            i--;\n                        }\n                        cellWidget.height -= splittedPara.height;\n                        if (isNullOrUndefined(splittedWidget)) {\n                            //Creates new widget, to hold the splitted contents.\n                            splittedWidget = this.createCellWidget(cellWidget);\n                        }\n                        splittedWidget.height += splittedPara.height;\n                        splittedWidget.childWidgets.push(splittedPara);\n                        splittedPara.containerWidget = splittedWidget;\n                    }\n                }\n                else {\n                    var tableWidget = cellWidget.childWidgets[i];\n                    var tableCol = [tableWidget];\n                    //Check for nested table.\n                    if (bottom - cellWidget.margin.bottom < tableWidget.y + tableWidget.height) {\n                        var tableHeight = tableWidget.height;\n                        // tslint:disable-next-line:max-line-length\n                        var splittedTable = this.getSplittedWidgetForTable(bottom - cellWidget.margin.bottom, tableCol, tableWidget);\n                        if (!isNullOrUndefined(splittedTable)) {\n                            if (i === 0 && splittedTable === tableWidget) {\n                                //Returns if the whole table does not fit in current page.\n                                return cellWidget;\n                            }\n                            if (cellWidget.childWidgets.indexOf(splittedTable) !== -1) {\n                                cellWidget.childWidgets.splice(cellWidget.childWidgets.indexOf(splittedTable), 1);\n                                i--;\n                                cellWidget.height -= splittedTable.height;\n                            }\n                            else {\n                                cellWidget.height -= tableHeight - tableWidget.height;\n                            }\n                            if (isNullOrUndefined(splittedWidget)) {\n                                //Creates new widget, to hold the splitted contents.\n                                splittedWidget = this.createCellWidget(cellWidget);\n                            }\n                            splittedWidget.height += splittedTable.height;\n                            splittedWidget.childWidgets.push(splittedTable);\n                            splittedTable.containerWidget = splittedWidget;\n                        }\n                    }\n                }\n            }\n        }\n        if (isNullOrUndefined(splittedWidget) && splitMinimalWidget) {\n            //Creates new widget, to hold the splitted contents.\n            splittedWidget = this.createCellWidget(cellWidget);\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets list level pattern\n     * @param value\n     * @private\n     */\n    Layout.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case 0:\n                return 'Arabic';\n            case 1:\n                return 'UpRoman';\n            case 2:\n                return 'LowRoman';\n            case 3:\n                return 'UpLetter';\n            case 4:\n                return 'LowLetter';\n            case 5:\n                return 'Ordinal';\n            case 6:\n                return 'Number';\n            case 7:\n                return 'OrdinalText';\n            case 8:\n                return 'LeadingZero';\n            case 9:\n                return 'Bullet';\n            case 10:\n                return 'FarEast';\n            case 11:\n                return 'Special';\n            default:\n                return 'None';\n        }\n    };\n    /**\n     * Creates cell widget.\n     * @param cell\n     */\n    Layout.prototype.createCellWidget = function (cell) {\n        var cellWidget = new TableCellWidget();\n        cellWidget.cellFormat = cell.cellFormat;\n        cellWidget.index = cell.index;\n        cellWidget.rowIndex = cell.rowIndex;\n        cellWidget.columnIndex = cell.columnIndex;\n        cellWidget.containerWidget = cell.containerWidget;\n        this.updateWidgetLocation(cell, cellWidget);\n        cellWidget.margin = cell.margin;\n        cellWidget.leftBorderWidth = HelperMethods.convertPointToPixel(cell.leftBorderWidth);\n        cellWidget.rightBorderWidth = HelperMethods.convertPointToPixel(cell.rightBorderWidth);\n        return cellWidget;\n    };\n    /**\n     * Create Table Widget\n     */\n    Layout.prototype.createTableWidget = function (table) {\n        var newTable = new TableWidget();\n        if (table.header) {\n            newTable.header = table.header;\n            newTable.headerHeight = table.headerHeight;\n        }\n        newTable.index = table.index;\n        newTable.tableFormat = table.tableFormat;\n        newTable.tableHolder = table.tableHolder;\n        newTable.isGridUpdated = table.isGridUpdated;\n        return newTable;\n    };\n    /**\n     * Gets splitted widget for paragraph.\n     * @param bottom\n     * @param paragraphWidget\n     */\n    Layout.prototype.getSplittedWidgetForPara = function (bottom, paragraphWidget) {\n        var lineBottom = paragraphWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var lineWidget = paragraphWidget.childWidgets[i];\n            if (bottom < lineBottom + lineWidget.height) {\n                if (i === 0) {\n                    if (lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                        //checks first line of the page is exceed the page height\n                        if (lineWidget.paragraph.containerWidget.y === paragraphWidget.y) {\n                            lineBottom += lineWidget.height;\n                            continue;\n                        }\n                    }\n                    splittedWidget = paragraphWidget;\n                    break;\n                }\n                if (paragraphWidget.childWidgets.indexOf(lineWidget) !== -1) {\n                    paragraphWidget.childWidgets.splice(paragraphWidget.childWidgets.indexOf(lineWidget), 1);\n                    i--;\n                }\n                paragraphWidget.height -= lineWidget.height;\n                if (isNullOrUndefined(splittedWidget)) {\n                    //Creates new widget, to hold the splitted contents.\n                    splittedWidget = new ParagraphWidget();\n                    splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                    splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                    splittedWidget.index = paragraphWidget.index;\n                    this.updateWidgetLocation(paragraphWidget, splittedWidget);\n                    splittedWidget.height = lineWidget.height;\n                }\n                else {\n                    splittedWidget.height += lineWidget.height;\n                }\n                splittedWidget.childWidgets.push(lineWidget);\n                lineWidget.paragraph = splittedWidget;\n            }\n            lineBottom += lineWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Gets splitted table widget.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.getSplittedWidgetForTable = function (bottom, tableCollection, tableWidget) {\n        var rowBottom = tableWidget.y;\n        var splittedWidget = undefined;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = undefined;\n            var childWidget = tableWidget.childWidgets[i];\n            // if (childWidget instanceof TableRowWidget) {\n            rowWidget = childWidget;\n            // }\n            var rowHeight = rowWidget.height;\n            if (bottom < rowBottom + rowHeight || !isNullOrUndefined(splittedWidget)) {\n                //ToDo: Check whether row included in vertical merge or AllowRowSplitbyPage is true, if so split row.\n                //Checks if atleast first line fits in the client area.                \n                var splittedRow = undefined;\n                var allowRowBreakAcrossPages = true;\n                if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(rowWidget.rowFormat)) {\n                    allowRowBreakAcrossPages = rowWidget.rowFormat.allowBreakAcrossPages;\n                }\n                if (allowRowBreakAcrossPages) {\n                    // tslint:disable-next-line:max-line-length\n                    splittedRow = (isNullOrUndefined(splittedWidget) && this.isFirstLineFitForRow(bottom, rowWidget)) ? this.getSplittedWidgetForRow(bottom, tableCollection, [rowWidget], rowWidget) : rowWidget;\n                }\n                if (!isNullOrUndefined(splittedRow)) {\n                    if (i === 0 && splittedRow === rowWidget) {\n                        //Returns if the whole table does not fit in current page.\n                        return tableWidget;\n                    }\n                    if (tableWidget.childWidgets.indexOf(splittedRow) !== -1) {\n                        tableWidget.childWidgets.splice(tableWidget.childWidgets.indexOf(splittedRow), 1);\n                        i--;\n                        tableWidget.height -= splittedRow.height;\n                    }\n                    else {\n                        tableWidget.height -= rowHeight - rowWidget.height;\n                    }\n                    if (isNullOrUndefined(splittedWidget)) {\n                        //Creates new widget, to hold the splitted contents.\n                        splittedWidget = this.createTableWidget(tableWidget);\n                        this.updateWidgetLocation(tableWidget, splittedWidget);\n                        splittedWidget.height = splittedRow.height;\n                    }\n                    else {\n                        splittedWidget.height += splittedRow.height;\n                    }\n                    splittedWidget.childWidgets.push(splittedRow);\n                    splittedRow.containerWidget = splittedWidget;\n                }\n            }\n            rowBottom += rowWidget.height;\n        }\n        return splittedWidget;\n    };\n    /**\n     * Checks whether first line fits for paragraph or not.\n     * @param bottom\n     * @param paraWidget\n     */\n    Layout.prototype.isFirstLineFitForPara = function (bottom, paraWidget) {\n        var lineWidget = paraWidget.childWidgets[0];\n        var cellwidget = lineWidget.paragraph.containerWidget;\n        // let document: WordDocument = undefined;\n        // if (!isNullOrUndefined(lineWidget.paragraph.currentNode) && !isNullOrUndefined(cellwidget.containerWidget)) {\n        //     document = WordDocument.getDocumentOf(lineWidget.paragraph.currentNode);\n        // }\n        //checks first line of the page is exceed the page height\n        if (this.viewer.isFirstLineFitInShiftWidgets) {\n            if (this.viewer.clientActiveArea.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        else {\n            // For nested tables,\n            if (cellwidget.ownerTable.isInsideTable) {\n                // Gets the container cell widgets, consider it as client area for the cell widget.\n                var containerCellWidget = undefined;\n                if (cellwidget.containerWidget instanceof TableRowWidget &&\n                    cellwidget.containerWidget.containerWidget instanceof TableWidget\n                    && cellwidget.containerWidget.containerWidget.containerWidget instanceof TableCellWidget) {\n                    containerCellWidget = cellwidget.containerWidget.containerWidget.containerWidget;\n                }\n                if (!isNullOrUndefined(containerCellWidget) && cellwidget.containerWidget.y === containerCellWidget.y\n                    && paraWidget.y + lineWidget.height >= bottom) {\n                    return true;\n                }\n            }\n            else if (cellwidget.containerWidget.y === this.viewer.clientArea.y && paraWidget.y + lineWidget.height >= bottom) {\n                return true;\n            }\n        }\n        return (paraWidget.y + lineWidget.height <= bottom);\n    };\n    /**\n     * Checks whether first line fits for table or not.\n     * @param bottom\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.isFirstLineFitForTable = function (bottom, tableWidget) {\n        var rowWidget = undefined;\n        var isFit = false;\n        var childWidget = tableWidget.childWidgets[0];\n        // if (childWidget instanceof TableRowWidget) {\n        rowWidget = childWidget;\n        // }\n        if (!isNullOrUndefined(rowWidget)) {\n            isFit = this.isFirstLineFitForRow(bottom, rowWidget);\n        }\n        return isFit;\n    };\n    /**\n     * Checks whether first line fits for row or not.\n     * @param bottom\n     * @param rowWidget\n     */\n    Layout.prototype.isFirstLineFitForRow = function (bottom, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            if (!this.isFirstLineFitForCell(bottom, cellWidget)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    /**\n     * Checks whether first line fits for cell or not.\n     * @param bottom\n     * @param cellWidget\n     */\n    Layout.prototype.isFirstLineFitForCell = function (bottom, cellWidget) {\n        if (cellWidget.childWidgets.length === 0) {\n            return true;\n        }\n        if (cellWidget.childWidgets[0] instanceof ParagraphWidget) {\n            var paraWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForPara(bottom - cellWidget.margin.bottom, paraWidget);\n        }\n        else {\n            var tableWidget = cellWidget.childWidgets[0];\n            return this.isFirstLineFitForTable(bottom - cellWidget.margin.bottom, tableWidget);\n        }\n    };\n    /**\n     * Updates widget location.\n     * @param widget\n     * @param table\n     */\n    Layout.prototype.updateWidgetLocation = function (widget, table) {\n        table.x = widget.x;\n        table.y = widget.y;\n        table.width = widget.width;\n    };\n    /**\n     * Updates child location for table.\n     * @param top\n     * @param tableWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForTable = function (top, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.x = rowWidget.x;\n            rowWidget.y = top;\n            this.updateChildLocationForRow(top, rowWidget);\n            top += rowWidget.height;\n        }\n    };\n    /**\n     * Updates child location for row.\n     * @param top\n     * @param rowWidget\n     * @private\n     */\n    Layout.prototype.updateChildLocationForRow = function (top, rowWidget) {\n        var spacing = 0;\n        if (rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            spacing = HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n        }\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var cellWidget = rowWidget.childWidgets[i];\n            cellWidget.x = cellWidget.x;\n            cellWidget.y = top + cellWidget.margin.top + spacing;\n            this.updateChildLocationForCell(cellWidget.y, cellWidget);\n        }\n    };\n    /**\n     * Updates child location for cell.\n     * @param top\n     * @param cellWidget\n     */\n    Layout.prototype.updateChildLocationForCell = function (top, cellWidget) {\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            cellWidget.childWidgets[i].x = cellWidget.childWidgets[i].x;\n            cellWidget.childWidgets[i].y = top;\n            if (cellWidget.childWidgets[i] instanceof TableWidget) {\n                this.updateChildLocationForTable(top, cellWidget.childWidgets[i]);\n            }\n            top += cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates cell vertical position.\n     * @param cellWidget\n     * @param isUpdateToTop\n     * @param isInsideTable\n     * @private\n     */\n    Layout.prototype.updateCellVerticalPosition = function (cellWidget, isUpdateToTop, isInsideTable) {\n        if (cellWidget.ownerTable.containerWidget instanceof BodyWidget || isInsideTable) {\n            var displacement = this.getDisplacement(cellWidget, isUpdateToTop);\n            //Update Y position alone for the child widget of cell\n            this.updateCellContentVerticalPosition(cellWidget, displacement, isUpdateToTop);\n        }\n    };\n    /**\n     * Updates cell content vertical position.\n     * @param cellWidget\n     * @param displacement\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateCellContentVerticalPosition = function (cellWidget, displacement, isUpdateToTop) {\n        if (displacement === 0) {\n            return;\n        }\n        var location = cellWidget.y + displacement;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                cellWidget.childWidgets[i].y = location;\n            }\n            else {\n                location = this.updateTableWidgetLocation(cellWidget.childWidgets[i], location, isUpdateToTop);\n            }\n            location = location + cellWidget.childWidgets[i].height;\n        }\n    };\n    /**\n     * Updates table widget location.\n     * @param tableWidget\n     * @param location\n     * @param isUpdateToTop\n     */\n    Layout.prototype.updateTableWidgetLocation = function (tableWidget, location, isUpdateToTop) {\n        tableWidget.y = location = location + tableWidget.topBorderWidth;\n        var cellSpacing = 0;\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            rowWidget.y = location;\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                var cellWidget = rowWidget.childWidgets[j];\n                cellWidget.y = location + cellWidget.margin.top + cellSpacing;\n                this.updateCellVerticalPosition(cellWidget, isUpdateToTop, true);\n            }\n            location = location + rowWidget.height;\n        }\n        return location;\n    };\n    /**\n     * Gets displacement.\n     * @param cellWidget\n     * @param isUpdateToTop\n     */\n    Layout.prototype.getDisplacement = function (cellWidget, isUpdateToTop) {\n        //Gets the height of row\n        var rowHeight = 0;\n        var rowWidget = cellWidget.containerWidget;\n        var padding = cellWidget.margin.top + cellWidget.margin.bottom;\n        if (!isNullOrUndefined(cellWidget.cellFormat) && cellWidget.cellFormat.rowSpan > 1) {\n            rowHeight = cellWidget.height;\n        }\n        else {\n            rowHeight = ((!isNullOrUndefined(rowWidget) ? rowWidget.height : 0) - padding);\n        }\n        //Gets the height of content within the cell\n        var cellContentHeight = this.getCellContentHeight(cellWidget);\n        //Displacement field holds the value which has reduced from rowHeight and cellContentHeight\n        var displacement = 0;\n        if (rowHeight > cellContentHeight) {\n            displacement = rowHeight - cellContentHeight;\n            if (cellWidget.cellFormat.verticalAlignment === 'Center') {\n                displacement = displacement / 2;\n            }\n            else if ((cellWidget.cellFormat.verticalAlignment === 'Top' || isUpdateToTop)) {\n                displacement = 0;\n            }\n        }\n        return displacement;\n    };\n    /**\n     * Gets cell content height.\n     * @param cellWidget\n     */\n    Layout.prototype.getCellContentHeight = function (cellWidget) {\n        if (isNullOrUndefined(cellWidget.childWidgets)) {\n            return 0;\n        }\n        var contentHeight = 0;\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            if (cellWidget.childWidgets[i] instanceof ParagraphWidget) {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n            else {\n                contentHeight += cellWidget.childWidgets[i].height;\n            }\n        }\n        return contentHeight;\n    };\n    /**\n     * Gets table left borders.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableLeftBorder = function (borders) {\n        if (!isNullOrUndefined(borders.left)) {\n            return borders.left;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table right border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableRightBorder = function (borders) {\n        if (!isNullOrUndefined(borders.right)) {\n            return borders.right;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get table top border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableTopBorder = function (borders) {\n        if (!isNullOrUndefined(borders.top)) {\n            return borders.top;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Gets table bottom border.\n     * @param borders\n     * @private\n     */\n    Layout.prototype.getTableBottomBorder = function (borders) {\n        if (!isNullOrUndefined(borders.bottom)) {\n            return borders.bottom;\n        }\n        else {\n            var border = new WBorder(borders);\n            border.lineStyle = 'Single';\n            border.lineWidth = 0.66;\n            return border;\n        }\n    };\n    /**\n     * Get diagonal cell up border.\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalUpBorder = function (tableCell) {\n        var diagonalUpBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalUpBorder = cellBorder.diagonalUp;\n        return diagonalUpBorder;\n    };\n    /**\n     * Gets diagonal cell down border\n     * @param tableCell\n     * @private\n     */\n    Layout.prototype.getCellDiagonalDownBorder = function (tableCell) {\n        var diagonalDownBorder = undefined;\n        var cellBorder = undefined;\n        cellBorder = tableCell.cellFormat.borders;\n        diagonalDownBorder = cellBorder.diagonalDown;\n        return diagonalDownBorder;\n    };\n    /**\n     * Gets table width.\n     * @param table\n     * @private\n     */\n    Layout.prototype.getTableWidth = function (table) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                rowWidth += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    //#region shifting\n    /**\n     * @private\n     */\n    Layout.prototype.layoutNextItemsBlock = function (blockAdv, viewer) {\n        var sectionIndex = blockAdv.bodyWidget.sectionIndex;\n        var block = blockAdv;\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        if (isNullOrUndefined(nextBlock) || this.viewer.blockToShift === block) {\n            this.viewer.blockToShift = undefined;\n        }\n        var updateNextBlockList = true;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.sectionIndex === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            // if (viewer.fieldEndParagraph === block) {\n            //     //Sets field end paragraph to undefined, inorder to hold reLayouting with this paragraph.\n            //     viewer.fieldEndParagraph = undefined;\n            // }\n            block = nextBlock;\n            if (viewer.blockToShift === block) {\n                viewer.blockToShift = undefined;\n            }\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            nextWidget = block.getSplitWidgets()[0];\n            // tslint:disable-next-line:max-line-length\n            if (viewer.fieldStacks.length === 0 && !isNullOrUndefined(nextWidget) && currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(currentWidget.y + currentWidget.height, 2))) {\n                if (!isNullOrUndefined(viewer.blockToShift)) {\n                    viewer.blockToShift = block;\n                    break;\n                }\n                if (isNullOrUndefined(nextWidget.nextWidget)) {\n                    break;\n                }\n            }\n            updateNextBlockList = true;\n            if (viewer.owner.isShiftingEnabled && viewer.fieldStacks.length === 0) {\n                viewer.blockToShift = block;\n                break;\n            }\n            else if (isNullOrUndefined(this.viewer.owner.editorModule) || !this.viewer.owner.editorModule.isInsertingTOC) {\n                block = block.combineWidget(this.viewer);\n                var paragraph = void 0;\n                if (currentWidget.containerWidget !== block.containerWidget) {\n                    if (!(currentWidget instanceof ParagraphWidget) ||\n                        (currentWidget instanceof ParagraphWidget) && !currentWidget.isEndsWithPageBreak) {\n                        // tslint:disable-next-line:max-line-length\n                        this.updateContainerWidget(block, currentWidget.containerWidget, currentWidget.indexInOwner + 1, false);\n                    }\n                }\n                if (block instanceof TableWidget) {\n                    this.clearTableWidget(block, true, true);\n                    block.isGridUpdated = false;\n                    paragraph = this.viewer.selection.getFirstParagraphInFirstCell(block);\n                }\n                else {\n                    paragraph = block;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n                }\n                viewer.updateClientAreaForBlock(block, true);\n                this.viewer.layout.layoutBlock(block, 0);\n                viewer.updateClientAreaForBlock(block, false);\n            }\n            splittedWidget = nextBlock.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (!viewer.owner.isShiftingEnabled || this.viewer.blockToShift !== block) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateClientAreaForLine = function (paragraph, startLineWidget, elementIndex) {\n        //Clears the line widget starting from current line.\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.clientArea.x;\n        this.viewer.cutFromTop(top);\n        this.viewer.cutFromLeft(left);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.getParentTable = function (block) {\n        var widget = block;\n        while (widget.containerWidget) {\n            if (widget.containerWidget instanceof BlockContainer) {\n                return widget;\n            }\n            widget = widget.containerWidget;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutParagraph = function (paragraphWidget, lineIndex, elementBoxIndex) {\n        if (this.viewer.blockToShift === paragraphWidget) {\n            this.layoutBodyWidgetCollection(paragraphWidget.index, paragraphWidget.containerWidget, paragraphWidget, false);\n        }\n        // let isElementMoved: boolean = elementBoxIndex > 0;\n        if (paragraphWidget.isInsideTable) {\n            this.reLayoutTable(paragraphWidget);\n        }\n        else {\n            this.reLayoutLine(paragraphWidget, lineIndex);\n        }\n        if (paragraphWidget.bodyWidget instanceof HeaderFooterWidget &&\n            paragraphWidget.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n            this.shiftFooterChildLocation(paragraphWidget.bodyWidget, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.reLayoutTable = function (block) {\n        //Get Top level owner of block\n        var table = this.getParentTable(block);\n        //Combine splitted table in to single table\n        // this.combineTableWidgets(this.viewer, table, undefined);\n        //Get Parent table\n        var currentTable = table.combineWidget(this.viewer);\n        currentTable.isGridUpdated = false;\n        currentTable.buildTableColumns();\n        currentTable.isGridUpdated = true;\n        var bodyWidget = currentTable.containerWidget;\n        if (this.viewer.owner.enableHeaderAndFooter || block.isInHeaderFooter) {\n            bodyWidget.height -= currentTable.height;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(table.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(table), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        //Clear Hieght for all the content \n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            var block_1 = this.viewer.selection.getFirstParagraphInFirstCell(currentTable);\n            this.viewer.owner.editorModule.updateWholeListItems(block_1);\n        }\n        this.viewer.updateClientAreaForBlock(currentTable, true);\n        //Remove border width\n        currentTable.x -= currentTable.leftBorderWidth;\n        currentTable.y -= currentTable.topBorderWidth;\n        //Update Client area for current position\n        this.viewer.cutFromTop(currentTable.y);\n        this.clearTableWidget(currentTable, true, true);\n        this.layoutBlock(currentTable, 0, true);\n        this.viewer.updateClientAreaForBlock(currentTable, false);\n        this.layoutNextItemsBlock(currentTable, this.viewer);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearTableWidget = function (table, clearPosition, clearHeight) {\n        table.height = 0;\n        if (clearPosition) {\n            table.y = 0;\n            table.x = 0;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            this.clearRowWidget(row, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearRowWidget = function (row, clearPosition, clearHeight) {\n        row.height = 0;\n        if (clearPosition) {\n            row.y = 0;\n            row.x = 0;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            this.clearCellWidget(cell, clearPosition, clearHeight);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.clearCellWidget = function (cell, clearPosition, clearHeight) {\n        cell.height = 0;\n        if (clearPosition) {\n            cell.y = 0;\n            cell.x = 0;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                if (clearHeight) {\n                    block.height = 0;\n                }\n            }\n            else {\n                this.clearTableWidget(block, clearPosition, clearHeight);\n            }\n        }\n    };\n    /**\n     * @param blockIndex\n     * @param bodyWidget\n     * @param block\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.layoutBodyWidgetCollection = function (blockIndex, bodyWidget, block, shiftNextWidget) {\n        if (!isNullOrUndefined(this.viewer.owner)\n            && this.viewer.owner.isLayoutEnabled) {\n            if (bodyWidget instanceof BlockContainer) {\n                var curretBlock = this.checkAndGetBlock(bodyWidget, blockIndex);\n                if (isNullOrUndefined(curretBlock)) {\n                    return;\n                }\n                if (bodyWidget instanceof HeaderFooterWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.updateHCFClientAreaWithTop(bodyWidget.sectionFormat, bodyWidget.headerFooterType.indexOf('Header') !== -1, bodyWidget.page);\n                    curretBlock.containerWidget.height -= curretBlock.height;\n                }\n                else {\n                    this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n                }\n                if (blockIndex > 0) {\n                    var prevWidget = curretBlock.getSplitWidgets()[0].previousRenderedWidget;\n                    if (!(prevWidget instanceof ParagraphWidget) ||\n                        (prevWidget instanceof ParagraphWidget) && !prevWidget.isEndsWithPageBreak) {\n                        this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                        if (curretBlock.containerWidget !== prevWidget.containerWidget) {\n                            // tslint:disable-next-line:max-line-length\n                            this.updateContainerWidget(curretBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                        }\n                    }\n                    else if (prevWidget instanceof ParagraphWidget && prevWidget.isEndsWithPageBreak &&\n                        prevWidget.containerWidget === curretBlock.containerWidget) {\n                        this.moveBlocksToNextPage(prevWidget);\n                    }\n                }\n                var currentParagraph = void 0;\n                curretBlock = curretBlock.combineWidget(this.viewer);\n                if (curretBlock instanceof TableWidget) {\n                    this.clearTableWidget(curretBlock, true, true);\n                    curretBlock.isGridUpdated = false;\n                    currentParagraph = this.viewer.selection.getFirstParagraphInFirstCell(curretBlock);\n                }\n                else {\n                    currentParagraph = curretBlock;\n                }\n                if ((this.viewer.owner.isDocumentLoaded) && this.viewer.owner.editorModule) {\n                    this.viewer.owner.editorModule.updateWholeListItems(currentParagraph);\n                }\n                this.viewer.updateClientAreaForBlock(curretBlock, true);\n                this.viewer.layout.layoutBlock(curretBlock, 0, true);\n                this.viewer.updateClientAreaForBlock(curretBlock, false);\n                if (shiftNextWidget) {\n                    this.shiftNextWidgets(curretBlock);\n                }\n                else {\n                    this.layoutNextItemsBlock(curretBlock, this.viewer);\n                }\n            }\n            else if (bodyWidget instanceof TableCellWidget) {\n                var table = this.viewer.layout.getParentTable(bodyWidget.ownerTable.getSplitWidgets()[0]);\n                this.reLayoutTable(bodyWidget.ownerTable);\n                this.layoutNextItemsBlock(table, this.viewer);\n            }\n        }\n    };\n    Layout.prototype.checkAndGetBlock = function (containerWidget, blockIndex) {\n        var sectionIndex = containerWidget.index;\n        while (containerWidget && containerWidget.index === sectionIndex) {\n            if (containerWidget.childWidgets.length > 0 && containerWidget.firstChild.index <= blockIndex &&\n                containerWidget.lastChild.index >= blockIndex) {\n                for (var i = 0; i < containerWidget.childWidgets.length; i++) {\n                    var block = containerWidget.childWidgets[i];\n                    if (block.index === blockIndex) {\n                        return block;\n                    }\n                }\n            }\n            if (containerWidget instanceof BodyWidget) {\n                containerWidget = containerWidget.nextRenderedWidget;\n            }\n            else {\n                break;\n            }\n        }\n        return undefined;\n    };\n    //#endregion\n    //#region Table\n    /**\n     * Layouts table.\n     * @param table\n     * @private\n     */\n    Layout.prototype.layoutTable = function (table, startIndex) {\n        if (!table.isGridUpdated) {\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n        }\n        var tableView = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tableView);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var isHeader = table.childWidgets[0].rowFormat.isHeader;\n        if (table.childWidgets.length > 0) {\n            table.header = isHeader;\n            table.continueHeader = isHeader;\n            table.headerHeight = 0;\n        }\n        var row = table.childWidgets[startIndex];\n        while (row) {\n            row = this.layoutRow(tableView, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tableView, [], table);\n        return tableView[tableView.length - 1];\n    };\n    /**\n     * Adds table widget.\n     * @param area\n     * @param table\n     * @private\n     */\n    Layout.prototype.addTableWidget = function (area, table, create) {\n        var tableWidget = table[table.length - 1];\n        if (create) {\n            tableWidget = this.createTableWidget(tableWidget);\n            table.push(tableWidget);\n        }\n        tableWidget.width = area.width;\n        tableWidget.x = area.x;\n        tableWidget.y = area.y;\n        //Update the table height of tableWidget when cell spacing has been defined. \n        if (tableWidget.tableFormat.cellSpacing > 0) {\n            tableWidget.height = tableWidget.height + HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n            // tslint:disable-next-line:max-line-length\n            tableWidget.leftBorderWidth = HelperMethods.convertPointToPixel(this.getTableLeftBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.rightBorderWidth = HelperMethods.convertPointToPixel(this.getTableRightBorder(tableWidget.tableFormat.borders).getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            tableWidget.topBorderWidth = HelperMethods.convertPointToPixel(this.getTableTopBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(this.getTableBottomBorder(tableWidget.tableFormat.borders).getLineWidth());\n            tableWidget.x += tableWidget.leftBorderWidth;\n            tableWidget.y += tableWidget.topBorderWidth;\n            tableWidget.width -= tableWidget.leftBorderWidth;\n            tableWidget.width -= tableWidget.rightBorderWidth;\n            tableWidget.height += tableWidget.bottomBorderWidth;\n        }\n        return tableWidget;\n    };\n    /**\n     * Updates widget to page.\n     * @param table\n     * @private\n     */\n    Layout.prototype.updateWidgetsToPage = function (tables, rows, table, endRowWidget) {\n        var viewer = this.viewer;\n        var tableWidget = tables[tables.length - 1];\n        if (!table.isInsideTable) {\n            this.updateHeightForTableWidget(tables, rows, tableWidget, endRowWidget);\n            if (tableWidget.childWidgets.length > 0 && tableWidget.y !== tableWidget.childWidgets[0].y) {\n                tableWidget.y = tableWidget.childWidgets[0].y;\n            }\n            // Need to update on this further\n            //Adds the table widget to owner cell widget.\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).childWidgets.push(tableWidget);\n            // tableWidget.containerWidget = viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as BodyWidget;\n            // tslint:disable-next-line:max-line-length\n            // (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height = (viewer.renderedElements.get(table.associatedCell)[viewer.renderedElements.get(table.associatedCell).length - 1] as TableCellWidget).height + tableWidget.height;\n        }\n        if (table.tableFormat.cellSpacing > 0) {\n            // tslint:disable-next-line:max-line-length\n            if (tableWidget.y + tableWidget.height + HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) > viewer.clientArea.bottom && viewer instanceof PageLayoutViewer) {\n                //update the table height when split to next page. Which is equivalent Ms Word Behaviour. \n                //In Ms Word if the Table Split to next page the bottom spacing of the table will be half of the current spacing.\n                //And the Remaining space will be used in next page top of the table.\n                tableWidget.height = tableWidget.height - HelperMethods.convertPointToPixel(table.tableFormat.cellSpacing) / 2;\n            }\n            //Update the current Y position of current clientactivearea.\n            viewer.cutFromTop(tableWidget.y + tableWidget.height);\n        }\n        if (table.bodyWidget instanceof HeaderFooterWidget) {\n            table.containerWidget.height += table.height;\n            if (this.viewer.owner.enableHeaderAndFooter && table.bodyWidget.headerFooterType.indexOf('Footer') !== -1) {\n                this.shiftFooterChildLocation(table.bodyWidget, this.viewer);\n            }\n        }\n    };\n    /**\n     * Updates height for table widget.\n     * @param viewer\n     * @param tableWidget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.updateHeightForTableWidget = function (tables, rows, tableWidget, endRowWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var rowWidget = tableWidget.childWidgets[i];\n            if (rowWidget === endRowWidget) {\n                break;\n            }\n            this.updateHeightForRowWidget(this.viewer, true, tables, rows, rowWidget, true, endRowWidget);\n        }\n    };\n    //#endregion\n    //#region Row\n    /**\n     * Layouts table row.\n     * @param row\n     * @private\n     */\n    Layout.prototype.layoutRow = function (tableWidget, row) {\n        var viewer = this.viewer;\n        var rowWidgets = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rowWidgets);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.layoutCell(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth, widget);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        var rows = [row];\n        this.updateWidgetsToTable(tableWidget, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @param area\n     * @param row\n     */\n    Layout.prototype.addTableRowWidget = function (area, row) {\n        var rowWidget = row[row.length - 1];\n        rowWidget.x = area.x + rowWidget.rowFormat.gridBeforeWidth;\n        rowWidget.y = area.y;\n        rowWidget.width = area.width;\n        var borderWidth = 0;\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat)\n            && rowWidget.ownerTable.tableFormat.cellSpacing > 0) {\n            rowWidget.height = rowWidget.height + HelperMethods.convertPointToPixel(rowWidget.ownerTable.tableFormat.cellSpacing);\n            //Update the table height with the border width to layout the border when the cell spacing is defined..\n            for (var j = 0; j < rowWidget.childWidgets.length; j++) {\n                if (!isNullOrUndefined(rowWidget.childWidgets[j].cellFormat)\n                    && !isNullOrUndefined(rowWidget.childWidgets[j].cellFormat.borders)) {\n                    // tslint:disable-next-line:max-line-length\n                    var width = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[j]).getLineWidth();\n                    if (width > borderWidth) {\n                        borderWidth = width;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            if (rowWidget.index > 0 && !isNullOrUndefined(rowWidget.previousWidget)) {\n                var prevRow = rowWidget.previousWidget;\n                borderWidth = 0;\n                for (var i = 0; i < prevRow.childWidgets.length; i++) {\n                    // tslint:disable-next-line:max-line-length\n                    if (!isNullOrUndefined(prevRow.childWidgets[i].cellFormat) && !isNullOrUndefined(prevRow.childWidgets[i].cellFormat.borders)) {\n                        var value = TableCellWidget.getCellBottomBorder(prevRow.childWidgets[i]).getLineWidth();\n                        if (value > borderWidth) {\n                            borderWidth = value;\n                        }\n                    }\n                }\n                //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n                rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n            }\n        }\n        if (!isNullOrUndefined(rowWidget.childWidgets)) {\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellTopBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n        }\n        //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n        rowWidget.topBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        //Update the table height of tableWidget when cell spacing has been defined. \n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(rowWidget.ownerTable) && !isNullOrUndefined(rowWidget.ownerTable.tableFormat) && rowWidget.ownerTable.tableFormat.cellSpacing <= 0 && rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n            // Update the bottom width for last row .\n            for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(rowWidget.childWidgets[i].cellFormat) && !isNullOrUndefined(rowWidget.childWidgets[i].cellFormat.borders)) {\n                    var value = TableCellWidget.getCellBottomBorder(rowWidget.childWidgets[i]).getLineWidth();\n                    if (value > borderWidth) {\n                        borderWidth = value;\n                    }\n                }\n            }\n            //Maximum border width is calculated and hold it in a variable to add with the padding of the cells.\n            rowWidget.bottomBorderWidth = HelperMethods.convertPointToPixel(borderWidth);\n        }\n        //tableRowWidget.ownerWidget = owner;\n        return rowWidget;\n    };\n    /**\n     * Gets maximum top or bottom cell margin.\n     * @param row\n     * @param topOrBottom\n     */\n    Layout.prototype.getMaxTopOrBottomCellMargin = function (row, topOrBottom) {\n        if (isNullOrUndefined(row.childWidgets)) {\n            return 0;\n        }\n        var value = 0;\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            if (row.childWidgets.length > 0) {\n                var cellFormat = row.childWidgets[i].cellFormat;\n                if (cellFormat.containsMargins()) {\n                    if (topOrBottom === 0 && !isNullOrUndefined(cellFormat.topMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && !isNullOrUndefined(cellFormat.bottomMargin) &&\n                        HelperMethods.convertPointToPixel(cellFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(cellFormat.bottomMargin);\n                    }\n                }\n                else {\n                    var tableFormat = row.childWidgets[i].ownerTable.tableFormat;\n                    if (topOrBottom === 0 && HelperMethods.convertPointToPixel(tableFormat.topMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.topMargin);\n                    }\n                    else if (topOrBottom === 1 && HelperMethods.convertPointToPixel(tableFormat.bottomMargin) > value) {\n                        value = HelperMethods.convertPointToPixel(tableFormat.bottomMargin);\n                    }\n                }\n            }\n        }\n        return value;\n    };\n    //#endregion Row\n    //#region cell\n    /**\n     * Layouts cell\n     * @param cell\n     * @param maxCellMarginTop\n     * @param maxCellMarginBottom\n     */\n    Layout.prototype.layoutCell = function (cell, maxCellMarginTop, maxCellMarginBottom, owner) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        if (cell.childWidgets.length === 0) {\n            var paragraphWidget = new ParagraphWidget();\n            paragraphWidget.characterFormat = new WCharacterFormat();\n            paragraphWidget.paragraphFormat = new WParagraphFormat();\n            paragraphWidget.index = 0;\n            var lineWidget = new LineWidget(undefined);\n            paragraphWidget.childWidgets.push(lineWidget);\n            cell.childWidgets.push(paragraphWidget);\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            block.containerWidget = cell;\n            this.layoutBlock(block, 0);\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    //endregion cell\n    //#region Shifting\n    /**\n     * @private\n     */\n    Layout.prototype.shiftLayoutedItems = function () {\n        if (isNullOrUndefined(this.viewer.blockToShift) || isNullOrUndefined(this.viewer.blockToShift.containerWidget)) {\n            this.viewer.blockToShift = undefined;\n            return;\n        }\n        var block = this.viewer.blockToShift;\n        var sectionIndex = block.bodyWidget.index;\n        this.reLayoutOrShiftWidgets(block, this.viewer);\n        var updateNextBlockList = true;\n        // If flow layout, then all sections are in single page. Hence need to update till last block of last section.\n        // Todo: For page layout and section break continuous, need to handle the same.\n        var splittedWidget = block.getSplitWidgets();\n        var nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        while (nextBlock instanceof BlockWidget && nextBlock.bodyWidget.index === sectionIndex) {\n            var currentWidget = undefined;\n            var blocks = block.getSplitWidgets();\n            currentWidget = blocks[blocks.length - 1];\n            block = nextBlock;\n            updateNextBlockList = false;\n            var nextWidget = undefined;\n            blocks = block.getSplitWidgets();\n            if (block instanceof ParagraphWidget) {\n                nextWidget = blocks[0];\n            }\n            else {\n                if (block instanceof TableWidget) {\n                    nextWidget = blocks[0];\n                }\n            }\n            if (currentWidget.containerWidget === nextWidget.containerWidget\n                && (HelperMethods.round(nextWidget.y, 2) === HelperMethods.round(this.viewer.clientActiveArea.y, 2)) &&\n                isNullOrUndefined(nextWidget.nextWidget)) {\n                break;\n            }\n            updateNextBlockList = true;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n            splittedWidget = block.getSplitWidgets();\n            nextBlock = splittedWidget[splittedWidget.length - 1].nextRenderedWidget;\n        }\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateListItemsTillEnd(block, updateNextBlockList);\n        }\n        this.viewer.blockToShift = undefined;\n        var viewer = this.viewer;\n        // if (viewer instanceof PageLayoutViewer) {\n        viewer.removeEmptyPages();\n        this.updateFieldElements();\n        viewer.updateScrollBars();\n        // }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateFieldElements = function () {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var fieldBegin = this.viewer.fields[i];\n            if (!isNullOrUndefined(this.viewer.selection)) {\n                var fieldCode = this.viewer.selection.getFieldCode(fieldBegin);\n                if (!isNullOrUndefined(fieldCode) && fieldCode.toLowerCase().match('numpages')) {\n                    var textElement = fieldBegin.fieldSeparator.nextNode;\n                    if (!isNullOrUndefined(textElement)) {\n                        textElement.text = this.viewer.pages.length.toString();\n                        var paragraph = fieldBegin.line.paragraph;\n                        if (!isNullOrUndefined(paragraph.bodyWidget) && !isNullOrUndefined(paragraph.bodyWidget.page)) {\n                            var lineIndex = paragraph.childWidgets.indexOf(fieldBegin.line);\n                            var elementIndex = fieldBegin.line.children.indexOf(textElement);\n                            this.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    Layout.prototype.reLayoutOrShiftWidgets = function (blockAdv, viewer) {\n        var reLayoutItems = false;\n        var block = blockAdv;\n        // if (block instanceof ParagraphWidget) {\n        //     reLayoutItems = viewer.renderedElements.get(block as ParagraphWidget).length === 0;\n        // } else {\n        //     reLayoutItems = viewer.renderedElements.get(block as TableWidget).length === 0;\n        // }\n        // if (reLayoutItems) {\n        //     //Handle layouting the block.\n        //     viewer.updateClientAreaForBlock(block, true);\n        //     this.layoutMod.layoutBlock(block);\n        //     viewer.updateClientAreaForBlock(block, false);\n        // } else {\n        //Handled to check client area and shift layouted widget.\n        this.shiftWidgetsBlock(block, viewer);\n        //Updates the list value of the rendered paragraph.\n        if (this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateRenderedListItems(block);\n        }\n        // }\n    };\n    Layout.prototype.shiftWidgetsBlock = function (block, viewer) {\n        if (block instanceof ParagraphWidget) {\n            this.shiftWidgetsForPara(block, viewer);\n        }\n        else if (block instanceof TableWidget) {\n            this.shiftWidgetsForTable(block, viewer);\n        }\n    };\n    Layout.prototype.shiftWidgetsForPara = function (paragraph, viewer) {\n        var prevBodyObj = this.getBodyWidgetOfPreviousBlock(paragraph, 0);\n        var prevBodyWidget = prevBodyObj.bodyWidget;\n        var index = prevBodyObj.index;\n        var prevWidget = undefined;\n        for (var i = 0; i < paragraph.getSplitWidgets().length; i++) {\n            var widget = paragraph.getSplitWidgets()[i];\n            if (!isNullOrUndefined(prevWidget)) {\n                var isPageBreak = prevWidget.lastChild ? prevWidget.lastChild.isEndsWithPageBreak : false;\n                this.shiftToPreviousWidget(widget, viewer, prevWidget, isPageBreak);\n                if ((isNullOrUndefined(widget.childWidgets) || widget.childWidgets.length === 0) && !isPageBreak) {\n                    i--;\n                    continue;\n                }\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    if (isPageBreak) {\n                        viewer.updateClientAreaByWidget(widget);\n                    }\n                }\n            }\n            if (this.isFitInClientArea(widget, viewer)) {\n                //Check whether this widget is moved to previous container widget.\n                prevWidget = widget;\n                widget.y = viewer.clientActiveArea.y;\n                viewer.cutFromTop(viewer.clientActiveArea.y + widget.height);\n                //Moves the paragraph widget to previous body widget.\n                if (!isNullOrUndefined(prevBodyWidget) && prevBodyWidget !== widget.containerWidget) {\n                    index++;\n                    if (!prevBodyWidget.lastChild.isEndsWithPageBreak) {\n                        this.updateContainerWidget(widget, prevBodyWidget, index, true);\n                    }\n                }\n                if (widget.isEndsWithPageBreak) {\n                    var nextBodyWidget = this.createOrGetNextBodyWidget(prevBodyWidget, this.viewer);\n                    nextBodyWidget = this.moveBlocksToNextPage(widget);\n                    viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                }\n            }\n            else {\n                var previousBlock = widget.previousRenderedWidget;\n                var isPageBreak = false;\n                if (previousBlock instanceof ParagraphWidget && previousBlock.isEndsWithPageBreak) {\n                    isPageBreak = true;\n                }\n                var isSplittedToNewPage = this.splitWidget(widget, viewer, prevBodyWidget, index + 1, isPageBreak);\n                prevWidget = undefined;\n                if (prevBodyWidget !== widget.containerWidget) {\n                    prevBodyWidget = widget.containerWidget;\n                    i--;\n                }\n                index = prevBodyWidget.childWidgets.indexOf(widget);\n                if (isSplittedToNewPage) {\n                    prevBodyWidget = paragraph.getSplitWidgets()[i + 1].containerWidget;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftTableWidget = function (table, viewer) {\n        var tables = [table];\n        this.addTableWidget(this.viewer.clientActiveArea, tables);\n        this.viewer.updateClientAreaTopOrLeft(table, true);\n        var row = table.childWidgets[0];\n        while (row) {\n            row = this.shiftRowWidget(tables, row);\n            row = row.nextRow;\n        }\n        this.updateWidgetsToPage(tables, [], table);\n        return tables[tables.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftRowWidget = function (tables, row) {\n        var viewer = this.viewer;\n        var rows = [row];\n        var widget = this.addTableRowWidget(viewer.clientActiveArea, rows);\n        viewer.updateClientAreaForRow(row, true);\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            // tslint:disable-next-line:max-line-length\n            this.shiftCellWidget(cell, this.getMaxTopOrBottomCellMargin(row, 0) + row.topBorderWidth, this.getMaxTopOrBottomCellMargin(row, 1) + row.bottomBorderWidth);\n        }\n        viewer.updateClientAreaForRow(row, false);\n        this.updateWidgetsToTable(tables, rows, row);\n        return rows[rows.length - 1];\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftCellWidget = function (cell, maxCellMarginTop, maxCellMarginBottom) {\n        var viewer = this.viewer;\n        this.addTableCellWidget(cell, viewer.clientActiveArea, maxCellMarginTop, maxCellMarginBottom);\n        viewer.updateClientAreaForCell(cell, true);\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            viewer.updateClientAreaForBlock(block, true);\n            if (block instanceof ParagraphWidget) {\n                this.shiftParagraphWidget(block);\n            }\n            else {\n                this.shiftTableWidget(block, viewer);\n            }\n            viewer.updateClientAreaForBlock(block, false);\n        }\n        this.updateWidgetToRow(cell);\n        viewer.updateClientAreaForCell(cell, false);\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.shiftParagraphWidget = function (paragraph) {\n        this.addParagraphWidget(this.viewer.clientActiveArea, paragraph);\n        this.viewer.cutFromTop(this.viewer.clientActiveArea.y + paragraph.height);\n        this.updateWidgetToPage(this.viewer, paragraph);\n    };\n    Layout.prototype.shiftWidgetsForTable = function (table, viewer) {\n        var prevObj = this.getBodyWidgetOfPreviousBlock(table, 0);\n        var prevBodyWidget = prevObj.bodyWidget;\n        var index = prevObj.index;\n        var isPageBreak = prevBodyWidget.lastChild.lastChild.isEndsWithPageBreak;\n        if (prevBodyWidget !== table.containerWidget) {\n            if (!isPageBreak) {\n                this.updateContainerWidget(table, prevBodyWidget, index + 1, true);\n            }\n            else {\n                viewer.updateClientArea(table.bodyWidget.sectionFormat, table.bodyWidget.page);\n            }\n        }\n        if (table.isInHeaderFooter) {\n            table.containerWidget.height -= table.height;\n        }\n        table.y = this.viewer.clientActiveArea.y;\n        this.updateVerticalPositionToTop(table, true);\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        var combinedTable = table.combineWidget(this.viewer);\n        this.viewer.layout.updateChildLocationForTable(combinedTable.y, combinedTable);\n        this.clearTableWidget(combinedTable, true, false);\n        this.shiftTableWidget(combinedTable, this.viewer);\n        this.updateVerticalPositionToTop(table, false);\n    };\n    Layout.prototype.updateVerticalPositionToTop = function (table, isUpdateTop) {\n        //Iterate the tableWidgets counts\n        for (var i = 0; i < table.getSplitWidgets().length; i++) {\n            var tablewidget = table.getSplitWidgets()[i];\n            //Iterate the tableWidget child items\n            for (var j = 0; j < tablewidget.childWidgets.length; j++) {\n                var rowWidget = tablewidget.childWidgets[j];\n                //Iterate the RowWidgets child items\n                for (var k = 0; k < rowWidget.childWidgets.length; k++) {\n                    var cellWidget = rowWidget.childWidgets[k];\n                    //Iterate the RowWidgets child items\n                    this.viewer.layout.updateCellVerticalPosition(cellWidget, isUpdateTop, false);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.splitWidget = function (paragraphWidget, viewer, previousBodyWidget, index, isPageBreak) {\n        var firstLine = paragraphWidget.childWidgets[0];\n        var maxElementHeight = this.getMaxElementHeight(firstLine, viewer);\n        var paragraphView = paragraphWidget.getSplitWidgets();\n        var nextBodyWidget = paragraphWidget.containerWidget;\n        if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n            var splittedWidget = undefined;\n            var widgetIndex = paragraphView.indexOf(paragraphWidget);\n            if (widgetIndex < (paragraphView.length - 1)) {\n                splittedWidget = paragraphView[widgetIndex + 1];\n                nextBodyWidget = splittedWidget.containerWidget;\n            }\n            else {\n                splittedWidget = new ParagraphWidget();\n                splittedWidget.index = paragraphWidget.index;\n                splittedWidget.characterFormat = paragraphWidget.characterFormat;\n                splittedWidget.paragraphFormat = paragraphWidget.paragraphFormat;\n                splittedWidget.width = paragraphWidget.width;\n                splittedWidget.x = paragraphWidget.x;\n                splittedWidget.y = paragraphWidget.y;\n                paragraphView.push(splittedWidget);\n            }\n            if (previousBodyWidget !== paragraphWidget.containerWidget) {\n                this.updateContainerWidget(paragraphWidget, previousBodyWidget, index, true);\n            }\n            for (var i = paragraphWidget.childWidgets.length - 1; i > 0; i--) {\n                if (this.isFitInClientArea(paragraphWidget, viewer)) {\n                    break;\n                }\n                else {\n                    var line = paragraphWidget.childWidgets[i];\n                    //Moves the line widget to next widget.\n                    this.updateParagraphWidgetInternal(line, splittedWidget, 0);\n                }\n            }\n            if (isNullOrUndefined(splittedWidget.containerWidget) && splittedWidget.childWidgets.length > 0) {\n                var y = viewer.clientActiveArea.y;\n                // tslint:disable-next-line:max-line-length\n                var clientArea = new Rect(viewer.clientArea.x, viewer.clientArea.y, viewer.clientArea.width, viewer.clientArea.height);\n                var activeArea = new Rect(viewer.clientActiveArea.x, viewer.clientActiveArea.y, viewer.clientActiveArea.width, viewer.clientActiveArea.height);\n                //Checks whether next node exists, else adds new page.\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                // nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, viewer);\n                nextBodyWidget.childWidgets.splice(0, 0, splittedWidget);\n                nextBodyWidget.height += splittedWidget.height;\n                splittedWidget.containerWidget = nextBodyWidget;\n                if (nextBodyWidget.childWidgets.length === 1 && nextBodyWidget.firstChild instanceof ParagraphWidget &&\n                    nextBodyWidget.firstChild.equals(paragraphWidget)) {\n                    paragraphWidget.x = paragraphWidget.x;\n                    paragraphWidget.y = y;\n                    return true;\n                }\n                else {\n                    //Resetting Client area\n                    viewer.clientArea = clientArea;\n                    viewer.clientActiveArea = activeArea;\n                }\n            }\n        }\n        else {\n            nextBodyWidget = this.createOrGetNextBodyWidget(previousBodyWidget, this.viewer);\n            if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n            }\n        }\n        if (previousBodyWidget === paragraphWidget.containerWidget) {\n            paragraphWidget.y = viewer.clientActiveArea.y;\n            viewer.cutFromTop(viewer.clientActiveArea.y + paragraphWidget.height);\n        }\n        else {\n            //Updates client area based on next body widget.\n            viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n        }\n        return false;\n    };\n    Layout.prototype.getMaxElementHeight = function (lineWidget, viewer) {\n        var height = 0;\n        // tslint:disable-next-line:max-line-length\n        if (lineWidget.children.length === 0 || ((lineWidget.children.length === 1 && lineWidget.children[0] instanceof ListTextElementBox) || (lineWidget.children.length === 2 && lineWidget.children[0] instanceof ListTextElementBox && lineWidget.children[1] instanceof ListTextElementBox))) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            height = viewer.selection.getParagraphMarkSize(lineWidget.paragraph, topMargin, bottomMargin).height;\n            height += topMargin;\n            if (lineWidget.children.length > 0) {\n                var element = lineWidget.children[0];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < lineWidget.children.length; i++) {\n                var element = lineWidget.children[i];\n                if (height < element.margin.top + element.height) {\n                    height = element.margin.top + element.height;\n                }\n            }\n        }\n        return height;\n    };\n    Layout.prototype.createOrGetNextBodyWidget = function (bodyWidget, viewer) {\n        var nextBodyWidget = undefined;\n        var pageIndex = 0;\n        pageIndex = viewer.pages.indexOf(bodyWidget.page);\n        var page = undefined;\n        var index = undefined;\n        index = bodyWidget.index;\n        if (pageIndex === viewer.pages.length - 1\n            || viewer.pages[pageIndex + 1].sectionIndex !== index) {\n            var currentWidget = new BodyWidget();\n            currentWidget.sectionFormat = bodyWidget.sectionFormat;\n            currentWidget.index = bodyWidget.index;\n            page = viewer.createNewPage(currentWidget);\n            if (viewer.pages[pageIndex + 1].sectionIndex !== index) {\n                viewer.insertPage(pageIndex + 1, page);\n            }\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        else {\n            page = viewer.pages[pageIndex + 1];\n            nextBodyWidget = page.bodyWidgets[0];\n        }\n        return nextBodyWidget;\n    };\n    Layout.prototype.isFitInClientArea = function (paragraphWidget, viewer) {\n        var lastLine = paragraphWidget.childWidgets[paragraphWidget.childWidgets.length - 1];\n        var height = paragraphWidget.height;\n        var maxElementHeight = this.getMaxElementHeight(lastLine, viewer);\n        if (lastLine.height > maxElementHeight) {\n            height -= lastLine.height - maxElementHeight;\n        }\n        return viewer.clientActiveArea.height >= height;\n    };\n    // tslint:disable-next-line:max-line-length\n    Layout.prototype.shiftToPreviousWidget = function (paragraphWidget, viewer, previousWidget, isPageBreak) {\n        for (var i = 0; i < paragraphWidget.childWidgets.length; i++) {\n            var line = paragraphWidget.childWidgets[i];\n            var maxElementHeight = this.getMaxElementHeight(line, viewer);\n            if (viewer.clientActiveArea.height >= maxElementHeight && !isPageBreak) {\n                //Moves the line widget to previous widget.\n                this.updateParagraphWidgetInternal(line, previousWidget, previousWidget.childWidgets.length);\n                i--;\n                viewer.cutFromTop(viewer.clientActiveArea.y + line.height);\n                if (isNullOrUndefined(paragraphWidget.childWidgets)) {\n                    break;\n                }\n            }\n            else {\n                var bodyWidget = previousWidget.containerWidget;\n                var nextBodyWidget = this.createOrGetNextBodyWidget(bodyWidget, viewer);\n                if (paragraphWidget.containerWidget !== nextBodyWidget) {\n                    nextBodyWidget = this.moveBlocksToNextPage(paragraphWidget);\n                }\n                if (bodyWidget !== nextBodyWidget) {\n                    this.updateContainerWidget(paragraphWidget, nextBodyWidget, 0, true);\n                }\n                //Updates client area based on next page.\n                viewer.updateClientArea(nextBodyWidget.sectionFormat, nextBodyWidget.page);\n                break;\n            }\n        }\n    };\n    Layout.prototype.updateParagraphWidgetInternal = function (lineWidget, newParagraphWidget, index) {\n        if (!isNullOrUndefined(lineWidget.paragraph)) {\n            lineWidget.paragraph.childWidgets.splice(lineWidget.paragraph.childWidgets.indexOf(lineWidget), 1);\n            lineWidget.paragraph.height -= lineWidget.height;\n            if (!isNullOrUndefined(lineWidget.paragraph.containerWidget)) {\n                lineWidget.paragraph.containerWidget.height -= lineWidget.height;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(lineWidget.paragraph.childWidgets) || lineWidget.paragraph.childWidgets.length === 0) {\n                lineWidget.paragraph.destroyInternal(this.viewer);\n            }\n        }\n        newParagraphWidget.childWidgets.splice(index, 0, lineWidget);\n        lineWidget.paragraph = newParagraphWidget;\n        newParagraphWidget.height += lineWidget.height;\n        if (!isNullOrUndefined(newParagraphWidget.containerWidget)) {\n            newParagraphWidget.containerWidget.height += lineWidget.height;\n        }\n    };\n    Layout.prototype.shiftNextWidgets = function (blockAdv) {\n        var block = blockAdv;\n        while (block.nextWidget instanceof BlockWidget) {\n            block = block.nextWidget;\n            this.reLayoutOrShiftWidgets(block, this.viewer);\n        }\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.updateContainerWidget = function (widget, bodyWidget, index, destroyAndScroll) {\n        if (!isNullOrUndefined(widget.containerWidget)) {\n            widget.containerWidget.childWidgets.splice(widget.containerWidget.childWidgets.indexOf(widget), 1);\n            widget.containerWidget.height -= bodyWidget.height;\n            if ((isNullOrUndefined(widget.containerWidget.childWidgets) || widget.containerWidget.childWidgets.length === 0)\n                && widget.containerWidget instanceof BodyWidget && widget.containerWidget !== bodyWidget && destroyAndScroll) {\n                var page = widget.containerWidget.page;\n                if (this.viewer.pages[this.viewer.pages.length - 1] === page &&\n                    this.viewer.visiblePages.indexOf(page) !== -1) {\n                    this.viewer.scrollToBottom();\n                }\n                if (isNullOrUndefined(page.nextPage) || page.nextPage.bodyWidgets[0].index !== widget.containerWidget.index) {\n                    widget.containerWidget.destroyInternal(this.viewer);\n                }\n            }\n        }\n        bodyWidget.childWidgets.splice(index, 0, widget);\n        bodyWidget.height += bodyWidget.height;\n        widget.containerWidget = bodyWidget;\n    };\n    Layout.prototype.getBodyWidgetOfPreviousBlock = function (block, index) {\n        index = 0;\n        var prevBodyWidget = undefined;\n        var previousBlock = block.previousRenderedWidget;\n        prevBodyWidget = (previousBlock && previousBlock.containerWidget.equals(block.containerWidget)) ?\n            previousBlock.containerWidget : block.containerWidget;\n        index = previousBlock && previousBlock.containerWidget.equals(block.containerWidget) ?\n            prevBodyWidget.childWidgets.indexOf(previousBlock) : block.containerWidget.childWidgets.indexOf(block);\n        return { bodyWidget: prevBodyWidget, index: index };\n    };\n    /**\n     * @private\n     */\n    Layout.prototype.moveBlocksToNextPage = function (block) {\n        var body = block.bodyWidget;\n        var page = body.page;\n        var pageIndex = page.index + 1;\n        var nextPage = undefined;\n        var nextBody = undefined;\n        var insertPage = false;\n        if (this.viewer.pages.length > pageIndex) {\n            nextPage = this.viewer.pages[pageIndex];\n            if (nextPage.bodyWidgets.length === 0 || !body.equals(nextPage.bodyWidgets[0])) {\n                nextPage = undefined;\n                insertPage = true;\n            }\n            else {\n                nextBody = nextPage.bodyWidgets[0];\n                this.viewer.updateClientArea(nextBody.sectionFormat, nextBody.page);\n            }\n        }\n        if (isNullOrUndefined(nextPage)) {\n            nextBody = this.createSplitBody(body);\n            nextPage = this.viewer.createNewPage(nextBody, pageIndex);\n            if (insertPage) {\n                this.viewer.insertPage(pageIndex, nextPage);\n            }\n        }\n        //tslint:disable :no-constant-condition\n        do {\n            var lastBlock = body.lastChild;\n            if (block === lastBlock) {\n                break;\n            }\n            body.childWidgets.pop();\n            nextBody.childWidgets.splice(0, 0, lastBlock);\n            lastBlock.containerWidget = nextBody;\n            nextBody.height += lastBlock.height;\n        } while (true);\n        return nextBody;\n    };\n    Layout.prototype.createSplitBody = function (body) {\n        var newBody = this.addBodyWidget(this.viewer.clientActiveArea);\n        newBody.sectionFormat = body.sectionFormat;\n        newBody.index = body.index;\n        return newBody;\n    };\n    //endregion\n    //#region Relayout Parargaph \n    /**\n     * Relayout Paragraph from specified line widget\n     * @param paragraph Paragraph to reLayout\n     * @param lineIndex start line index to reLayout\n     * @private\n     */\n    Layout.prototype.reLayoutLine = function (paragraph, lineIndex) {\n        if (this.viewer.owner.isDocumentLoaded && this.viewer.owner.editorModule) {\n            this.viewer.owner.editorModule.updateWholeListItems(paragraph);\n        }\n        var lineWidget;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n            lineWidget = paragraph.getSplitWidgets()[0].firstChild;\n        }\n        else {\n            lineWidget = paragraph.childWidgets[lineIndex];\n        }\n        var lineToLayout = lineWidget.previousLine;\n        if (isNullOrUndefined(lineToLayout)) {\n            lineToLayout = lineWidget;\n        }\n        var currentParagraph = lineToLayout.paragraph;\n        var bodyWidget = paragraph.containerWidget;\n        bodyWidget.height -= paragraph.height;\n        if (this.viewer.owner.enableHeaderAndFooter || paragraph.isInHeaderFooter) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.updateHCFClientAreaWithTop(paragraph.bodyWidget.sectionFormat, this.viewer.isBlockInHeader(paragraph), bodyWidget.page);\n        }\n        else {\n            this.viewer.updateClientArea(bodyWidget.sectionFormat, bodyWidget.page);\n        }\n        this.viewer.updateClientAreaForBlock(paragraph, true);\n        if (lineToLayout.paragraph.isEmpty()) {\n            this.viewer.cutFromTop(paragraph.y);\n            this.layoutParagraph(paragraph, 0);\n        }\n        else {\n            this.updateClientAreaForLine(lineToLayout.paragraph, lineToLayout, 0);\n            this.layoutListItems(lineToLayout.paragraph);\n            if (lineToLayout.isFirstLine() && !isNullOrUndefined(paragraph.paragraphFormat)) {\n                var firstLineIndent = -HelperMethods.convertPointToPixel(paragraph.paragraphFormat.firstLineIndent);\n                this.viewer.updateClientWidth(firstLineIndent);\n            }\n            do {\n                lineToLayout = this.layoutLine(lineToLayout, 0);\n                paragraph = lineToLayout.paragraph;\n                lineToLayout = lineToLayout.nextLine;\n            } while (lineToLayout);\n            this.updateWidgetToPage(this.viewer, paragraph);\n            this.viewer.updateClientAreaForBlock(paragraph, false);\n        }\n        this.layoutNextItemsBlock(paragraph, this.viewer);\n    };\n    return Layout;\n}());\nexport { Layout };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Rect, ImageElementBox, ParagraphWidget, ListTextElementBox, TableRowWidget, TableWidget, TableCellWidget, FieldElementBox, TabElementBox } from './page';\nimport { Layout } from './layout';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar Renderer = /** @class */ (function () {\n    function Renderer(viewer) {\n        this.isPrinting = false;\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.isFieldCode = false;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(Renderer.prototype, \"pageCanvas\", {\n        /**\n         * Gets page canvas.\n         * @private\n         */\n        get: function () {\n            if (this.isPrinting) {\n                if (isNullOrUndefined(this.pageCanvasIn)) {\n                    this.pageCanvasIn = document.createElement('canvas');\n                    this.pageCanvasIn.getContext('2d').save();\n                }\n                return this.pageCanvasIn;\n            }\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.containerCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         */\n        get: function () {\n            return isNullOrUndefined(this.viewer) ? undefined : this.viewer.selectionCanvas;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"pageContext\", {\n        /**\n         * Gets page context.\n         */\n        get: function () {\n            return this.pageCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Renderer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets the color.\n     * @private\n     */\n    Renderer.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                if (color.length > 7) {\n                    return color.substr(0, 7);\n                }\n            }\n        }\n        return color;\n    };\n    /**\n     * Renders widgets.\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     * @param {number} width\n     * @param {number} height\n     * @private\n     */\n    Renderer.prototype.renderWidgets = function (page, left, top, width, height) {\n        if (isNullOrUndefined(this.pageCanvas) || isNullOrUndefined(page)) {\n            return;\n        }\n        this.pageContext.fillStyle = this.getColor(this.viewer.backgroundColor);\n        this.pageContext.beginPath();\n        this.pageContext.fillRect(left, top, width, height);\n        this.pageContext.closePath();\n        this.pageContext.strokeStyle = this.viewer.owner.pageOutline;\n        this.pageContext.strokeRect(left, top, width, height);\n        this.pageLeft = left;\n        this.pageTop = top;\n        if (this.isPrinting) {\n            this.setPageSize(page);\n        }\n        else {\n            this.pageContext.beginPath();\n            this.pageContext.save();\n            this.pageContext.rect(left, top, width, height);\n            this.pageContext.clip();\n        }\n        if (page.headerWidget) {\n            this.renderHFWidgets(page, page.headerWidget, width, true);\n        }\n        if (page.footerWidget) {\n            this.renderHFWidgets(page, page.footerWidget, width, false);\n        }\n        for (var i = 0; i < page.bodyWidgets.length; i++) {\n            this.render(page, page.bodyWidgets[i]);\n        }\n        if (this.viewer.owner.enableHeaderAndFooter && !this.isPrinting) {\n            this.renderHeaderSeparator(page, this.pageLeft, this.pageTop, page.headerWidget);\n        }\n        this.pageLeft = 0;\n        this.pageTop = 0;\n        this.pageContext.restore();\n    };\n    /**\n     * Sets page size.\n     * @param {Page} page\n     */\n    Renderer.prototype.setPageSize = function (page) {\n        this.pageContext.clearRect(0, 0, this.pageCanvas.width, this.pageCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        this.pageContext.restore();\n        this.selectionContext.restore();\n        var width = page.boundingRectangle.width;\n        var height = page.boundingRectangle.height;\n        var dpr = Math.max(1, window.devicePixelRatio || 1);\n        if (this.pageCanvas.width !== width * dpr || this.pageCanvas.height !== height * dpr) {\n            this.pageCanvas.height = height * dpr;\n            this.pageCanvas.width = width * dpr;\n            this.pageCanvas.style.height = height + 'px';\n            this.pageCanvas.style.width = width + 'px';\n            this.pageContext.globalAlpha = 1;\n            this.pageContext.scale(dpr, dpr);\n        }\n    };\n    /**\n     * Renders header footer widget.\n     * @param {Page} page\n     * @param {HeaderFooterWidget} headFootWidget\n     */\n    Renderer.prototype.renderHFWidgets = function (page, widget, width, isHeader) {\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 1 : 0.65;\n        var cliped = false;\n        if (isHeader) {\n            var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n            var widgetHeight = Math.max((widget.y + widget.height), topMargin);\n            var headerFooterHeight = page.boundingRectangle.height / 100 * 40;\n            if (widgetHeight > headerFooterHeight) {\n                cliped = true;\n                this.pageContext.beginPath();\n                this.pageContext.save();\n                this.pageContext.rect(this.pageLeft, this.pageTop, width, this.getScaledValue(headerFooterHeight));\n                this.pageContext.clip();\n            }\n        }\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var block = widget.childWidgets[i];\n            this.renderWidget(page, block);\n        }\n        if (cliped) {\n            this.pageContext.restore();\n        }\n        this.pageContext.globalAlpha = this.viewer.owner.enableHeaderAndFooter ? 0.65 : 1;\n    };\n    Renderer.prototype.renderHeaderSeparator = function (page, left, top, widget) {\n        //Header Widget\n        var topMargin = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin);\n        var y = this.getScaledValue(Math.max((widget.y + widget.height), topMargin));\n        var pageWidth = this.getScaledValue(page.boundingRectangle.width);\n        var ctx = this.pageContext;\n        ctx.save();\n        ctx.globalAlpha = 0.65;\n        var headerFooterHeight = (this.getScaledValue(page.boundingRectangle.height) / 100) * 40;\n        //Maximum header height limit       \n        y = Math.min(y, headerFooterHeight);\n        //Dash line Separator\n        this.renderDashLine(ctx, left, top + y, pageWidth, '#000000', false);\n        var type = this.getHeaderFooterType(page, true);\n        ctx.font = '9pt Arial';\n        var width = ctx.measureText(type).width;\n        this.renderHeaderFooterMark(ctx, left + 5, top + y, width + 10, 20);\n        this.renderHeaderFooterMarkText(ctx, type, left + 10, y + top + 15);\n        if (page.footerWidget) {\n            //Footer Widget\n            var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n            // tslint:disable-next-line:max-line-length\n            var footerHeight = this.getScaledValue(page.boundingRectangle.height) -\n                this.getScaledValue(Math.max(page.footerWidget.height + footerDistance, HelperMethods.convertPointToPixel(page.footerWidget.sectionFormat.bottomMargin)));\n            //Maximum footer height limit     \n            footerHeight = Math.max((this.getScaledValue(page.boundingRectangle.height) - headerFooterHeight), footerHeight);\n            this.renderDashLine(ctx, left, top + footerHeight, pageWidth, '#000000', false);\n            type = this.getHeaderFooterType(page, false);\n            width = ctx.measureText(type).width;\n            this.renderHeaderFooterMark(ctx, left + 5, top + footerHeight - 20, width + 10, 20);\n            this.renderHeaderFooterMarkText(ctx, type, left + 10, top + footerHeight - 5);\n            ctx.restore();\n        }\n    };\n    Renderer.prototype.getHeaderFooterType = function (page, isHeader) {\n        var type;\n        type = isHeader ? 'Header' : 'Footer';\n        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && this.viewer.pages.indexOf(page) === 0) {\n            type = isHeader ? 'First Page Header' : 'First Page Footer';\n        }\n        else if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n            if ((this.viewer.pages.indexOf(page) + 1) % 2 === 0) {\n                type = isHeader ? 'Even Page Header' : 'Even Page Footer';\n            }\n            else {\n                type = isHeader ? 'Odd Page Header' : 'Odd Page Footer';\n            }\n        }\n        return type;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderDashLine = function (ctx, x, y, width, fillStyle, isSmallDash) {\n        ctx.beginPath();\n        ctx.strokeStyle = fillStyle;\n        ctx.lineWidth = 1;\n        if (isSmallDash) {\n            ctx.setLineDash([3, 2]);\n        }\n        else {\n            ctx.setLineDash([6, 4]);\n        }\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + width, y);\n        ctx.stroke();\n        ctx.setLineDash([]);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMark = function (ctx, x, y, w, h) {\n        ctx.beginPath();\n        ctx.fillStyle = 'lightgray';\n        ctx.fillRect(x, y, w, h);\n        ctx.strokeStyle = 'black';\n        ctx.strokeRect(x, y, w, h);\n        ctx.closePath();\n    };\n    Renderer.prototype.renderHeaderFooterMarkText = function (ctx, content, x, y) {\n        ctx.beginPath();\n        ctx.fillStyle = '#000000';\n        ctx.textBaseline = 'alphabetic';\n        ctx.fillText(content, x, y);\n        ctx.closePath();\n    };\n    /**\n     * Renders body widget.\n     * @param {Page} page\n     * @param {BodyWidget} bodyWidget\n     */\n    Renderer.prototype.render = function (page, bodyWidget) {\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var widget = bodyWidget.childWidgets[i];\n            if (i === 0 && bodyWidget.childWidgets[0] instanceof TableWidget && page.repeatHeaderRowTableWidget) {\n                // tslint:disable-next-line:max-line-length\n                this.renderHeader(page, widget, this.viewer.layout.getHeader(bodyWidget.childWidgets[0]));\n            }\n            this.renderWidget(page, widget);\n        }\n    };\n    /**\n     * Renders block widget.\n     * @param {Page} page\n     * @param {Widget} widget\n     */\n    Renderer.prototype.renderWidget = function (page, widget) {\n        if (widget instanceof ParagraphWidget) {\n            this.renderParagraphWidget(page, widget);\n        }\n        else {\n            this.renderTableWidget(page, widget);\n        }\n    };\n    /**\n     * Renders header.\n     * @param {Page} page\n     * @param {TableWidget} widget\n     * @param {WRow} header\n     * @private\n     */\n    Renderer.prototype.renderHeader = function (page, widget, header) {\n        if (isNullOrUndefined(header)) {\n            return;\n        }\n        var top = page.viewer.clientArea.y;\n        for (var i = 0; i <= header.rowIndex; i++) {\n            if (header.ownerTable.getSplitWidgets()[0].childWidgets.length === 0) {\n                return;\n            }\n            var row = header.ownerTable.getSplitWidgets()[0].childWidgets[0];\n            var headerWidget = row.clone();\n            headerWidget.containerWidget = row.containerWidget;\n            // tslint:disable-next-line:max-line-length\n            page.viewer.updateClientAreaLocation(headerWidget, new Rect(page.viewer.clientArea.x, top, headerWidget.width, headerWidget.height));\n            page.viewer.layout.updateChildLocationForRow(top, headerWidget);\n            var cell = undefined;\n            //Renders table cell outline rectangle - Border and background color.\n            for (var j = 0; j < headerWidget.childWidgets.length; j++) {\n                cell = headerWidget.childWidgets[j];\n                this.renderTableCellWidget(page, cell);\n            }\n            top += headerWidget.height;\n        }\n        if (widget.y !== top) {\n            //this.Location.Y = top;\n            page.viewer.layout.updateChildLocationForTable(top, widget);\n        }\n    };\n    /**\n     * Renders paragraph widget.\n     * @param {Page} page\n     * @param {ParagraphWidget} paraWidget\n     */\n    Renderer.prototype.renderParagraphWidget = function (page, paraWidget) {\n        var top = paraWidget.y;\n        var left = paraWidget.x;\n        for (var i = 0; i < paraWidget.childWidgets.length; i++) {\n            var widget = paraWidget.childWidgets[i];\n            this.renderLine(widget, page, left, top);\n            top += widget.height;\n        }\n    };\n    /**\n     * Renders table widget.\n     * @param {Page} page\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableWidget = function (page, tableWidget) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var widget = tableWidget.childWidgets[i];\n            this.renderTableRowWidget(page, widget);\n            if (tableWidget.tableFormat.cellSpacing > 0) {\n                this.renderTableOutline(tableWidget);\n            }\n        }\n    };\n    /**\n     * Renders table row widget.\n     * @param {Page} page\n     * @param {Widget} rowWidget\n     */\n    Renderer.prototype.renderTableRowWidget = function (page, rowWidget) {\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            this.renderTableCellWidget(page, widget);\n        }\n    };\n    /**\n     * Renders table cell widget.\n     * @param {Page} page\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellWidget = function (page, cellWidget) {\n        if (!this.isPrinting) {\n            if (this.getScaledValue(cellWidget.y, 2) + cellWidget.height * this.viewer.zoomFactor < 0 ||\n                this.getScaledValue(cellWidget.y, 2) > this.viewer.visibleBounds.height) {\n                return;\n            }\n        }\n        var widgetHeight = 0;\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlightTable(this.selectionContext, cellWidget);\n        }\n        this.renderTableCellOutline(page.viewer, cellWidget);\n        for (var i = 0; i < cellWidget.childWidgets.length; i++) {\n            var widget = cellWidget.childWidgets[i];\n            var width = cellWidget.width + cellWidget.margin.left - cellWidget.leftBorderWidth;\n            this.clipRect(cellWidget.x, cellWidget.y, this.getScaledValue(width), this.getScaledValue(cellWidget.height));\n            this.renderWidget(page, widget);\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders line widget.\n     * @param {LineWidget} lineWidget\n     * @param {Page} page\n     * @param {number} left\n     * @param {number} top\n     */\n    Renderer.prototype.renderLine = function (lineWidget, page, left, top) {\n        if (!this.isPrinting && page.viewer.owner.selection && page.viewer.owner.selection.selectedWidgets.length > 0) {\n            page.viewer.owner.selection.addSelectionHighlight(this.selectionContext, lineWidget, top);\n        }\n        if (lineWidget.isFirstLine()) {\n            left += HelperMethods.convertPointToPixel(lineWidget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (this.viewer.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(page.viewer.owner.searchModule.searchHighlighters) && page.viewer.owner.searchModule.searchHighlighters.containsKey(lineWidget)) {\n                var widgetInfo = page.viewer.owner.searchModule.searchHighlighters.get(lineWidget);\n                for (var i = 0; i < widgetInfo.length; i++) {\n                    this.pageContext.fillStyle = '#ffe97f';\n                    // tslint:disable-next-line:max-line-length\n                    this.pageContext.fillRect(this.getScaledValue(widgetInfo[i].left, 1), this.getScaledValue(top, 2), this.getScaledValue(widgetInfo[i].width), this.getScaledValue(lineWidget.height));\n                }\n            }\n        }\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var elementBox = lineWidget.children[i];\n            if (elementBox instanceof FieldElementBox || this.isFieldCode ||\n                (elementBox.width === 0 && elementBox.height === 0)) {\n                if (this.isFieldCode) {\n                    elementBox.width = 0;\n                }\n                left += elementBox.width + elementBox.margin.left;\n                this.toSkipFieldCode(elementBox);\n                continue;\n            }\n            var underlineY = this.getUnderlineYPosition(lineWidget);\n            if (!this.isPrinting) {\n                if (this.getScaledValue(top + elementBox.margin.top, 2) + elementBox.height * this.viewer.zoomFactor < 0 ||\n                    this.getScaledValue(top + elementBox.margin.top, 2) > this.viewer.visibleBounds.height) {\n                    left += elementBox.width + elementBox.margin.left;\n                    continue;\n                }\n            }\n            if (elementBox instanceof ListTextElementBox) {\n                this.renderListTextElementBox(elementBox, left, top, underlineY);\n            }\n            else if (elementBox instanceof ImageElementBox) {\n                this.renderImageElementBox(elementBox, left, top, underlineY);\n            }\n            else {\n                this.renderTextElementBox(elementBox, left, top, underlineY);\n            }\n            left += elementBox.width + elementBox.margin.left;\n        }\n    };\n    Renderer.prototype.toSkipFieldCode = function (element) {\n        if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                if ((!isNullOrUndefined(element.fieldEnd) || element.hasFieldEnd)) {\n                    this.isFieldCode = true;\n                }\n            }\n            else if (element.fieldType === 2 || element.fieldType === 1) {\n                this.isFieldCode = false;\n            }\n        }\n    };\n    /**\n     * Gets underline y position.\n     * @param {LineWidget} lineWidget\n     * @private\n     */\n    Renderer.prototype.getUnderlineYPosition = function (lineWidget) {\n        var height = 0;\n        var lineHeight = 0;\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            if (lineWidget.children[i] instanceof FieldElementBox ||\n                (lineWidget.children[i].width === 0 && lineWidget.children[i].height === 0)) {\n                continue;\n            }\n            if (height < lineWidget.children[i].height + lineWidget.children[i].margin.top) {\n                height = lineWidget.children[i].margin.top + lineWidget.children[i].height;\n                lineHeight = lineWidget.children[i].height / 20;\n            }\n        }\n        return height - 2 * lineHeight;\n    };\n    /**\n     * Renders list element box\n     * @param {ListTextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    Renderer.prototype.renderListTextElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var format = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = elementBox.line.paragraph.characterFormat;\n        var color = format.fontColor === '#000000' ? breakCharacterFormat.fontColor : format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontFamily = format.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily : format.fontFamily;\n        var fontSize = format.fontSize === 11 ? breakCharacterFormat.fontSize : format.fontSize;\n        // tslint:disable-next-line:max-line-length\n        var baselineAlignment = format.baselineAlignment === 'Normal' ? breakCharacterFormat.baselineAlignment : format.baselineAlignment;\n        bold = format.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var strikethrough = format.strikethrough === 'None' ? breakCharacterFormat.strikethrough : format.strikethrough;\n        var highlightColor = format.highlightColor === 'NoColor' ? breakCharacterFormat.highlightColor :\n            format.highlightColor;\n        if (highlightColor !== 'NoColor') {\n            if (highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + fontFamily;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(elementBox.text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width));\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, baselineAlignment);\n        }\n        if (strikethrough !== 'None') {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, baselineAlignment);\n        }\n    };\n    /**\n     * Renders text element box.\n     * @param {TextElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderTextElementBox = function (elementBox, left, top, underlineY) {\n        var isHeightType = false;\n        var containerWidget = elementBox.line.paragraph.containerWidget;\n        if (containerWidget instanceof TableCellWidget) {\n            isHeightType = (containerWidget.ownerRow.rowFormat.heightType === 'Exactly');\n        }\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        if (isHeightType) {\n            // tslint:disable-next-line:max-line-length\n            this.clipRect(containerWidget.x, containerWidget.y, this.getScaledValue(containerWidget.width), this.getScaledValue(containerWidget.height));\n        }\n        var format = elementBox.characterFormat;\n        if (format.highlightColor !== 'NoColor') {\n            if (format.highlightColor.substring(0, 1) !== '#') {\n                this.pageContext.fillStyle = HelperMethods.getHighlightColorCode(format.highlightColor);\n            }\n            else {\n                this.pageContext.fillStyle = this.getColor(format.highlightColor);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        var color = format.fontColor;\n        this.pageContext.textBaseline = 'top';\n        var bold = '';\n        var italic = '';\n        var fontSize = 11;\n        bold = format.bold ? 'bold' : '';\n        italic = format.italic ? 'italic' : '';\n        fontSize = format.fontSize === 0 ? 0.5 : format.fontSize / (format.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.pageContext.font = bold + ' ' + italic + ' ' + fontSize * this.viewer.zoomFactor + 'pt' + ' ' + format.fontFamily;\n        if (format.baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - elementBox.height / 1.5;\n        }\n        this.pageContext.fillStyle = this.getColor(color);\n        var scaledWidth = this.getScaledValue(elementBox.width);\n        var text = elementBox.text;\n        // tslint:disable-next-line:max-line-length\n        if (elementBox instanceof TabElementBox) {\n            var tabElement = elementBox;\n            if (tabElement.tabText === '' && !isNullOrUndefined(tabElement.tabLeader) && tabElement.tabLeader !== 'None') {\n                text = this.getTabLeader(elementBox);\n                tabElement.tabText = text;\n            }\n            else if (tabElement.tabText !== '') {\n                text = tabElement.tabText;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillText(text, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), scaledWidth);\n        if (format.underline !== 'None' && !isNullOrUndefined(format.underline)) {\n            // tslint:disable-next-line:max-line-length\n            this.renderUnderline(elementBox, left, top, underlineY, color, format.underline, format.baselineAlignment);\n        }\n        if (format.strikethrough !== 'None' && !isNullOrUndefined(format.strikethrough)) {\n            this.renderStrikeThrough(elementBox, left, top, format.strikethrough, color, format.baselineAlignment);\n        }\n        if (isHeightType) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Returns tab leader\n     */\n    Renderer.prototype.getTabLeader = function (elementBox) {\n        var textWidth = 0;\n        var tabString = this.getTabLeaderString(elementBox.tabLeader);\n        var tabText = tabString;\n        textWidth = this.viewer.textHelper.getWidth(tabText, elementBox.characterFormat);\n        var count = Math.floor(elementBox.width / textWidth);\n        for (var i = 0; i <= count; i++) {\n            tabText += tabString;\n        }\n        return tabText.slice(0, -1);\n    };\n    /**\n     * Returns tab leader string.\n     */\n    Renderer.prototype.getTabLeaderString = function (tabLeader) {\n        var tabString = '';\n        switch (tabLeader) {\n            case 'Dot':\n                tabString = '.';\n                break;\n            case 'Hyphen':\n                tabString = '-';\n                break;\n            case 'Underscore':\n                tabString = '_';\n                break;\n        }\n        return tabString;\n    };\n    /**\n     * Clips the rectangle with specified position.\n     * @param {number} xPos\n     * @param {number} yPos\n     * @param {number} width\n     * @param {number} height\n     */\n    Renderer.prototype.clipRect = function (xPos, yPos, width, height) {\n        this.pageContext.beginPath();\n        this.pageContext.save();\n        this.pageContext.rect(this.getScaledValue(xPos, 1), this.getScaledValue(yPos, 2), width, height);\n        this.pageContext.clip();\n    };\n    /**\n     * Renders underline.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     * @param {string} color\n     * @param {Underline} underline\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderUnderline = function (elementBox, left, top, underlineY, color, underline, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        var underlineHeight = renderedHeight / 20;\n        var y = 0;\n        if (baselineAlignment === 'Subscript' || elementBox instanceof ListTextElementBox) {\n            y = (renderedHeight - 2 * underlineHeight) + top;\n            topMargin += elementBox.height - renderedHeight;\n            y += topMargin > 0 ? topMargin : 0;\n        }\n        else {\n            y = underlineY + top;\n        }\n        // tslint:disable-next-line:max-line-length\n        this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y, 2), this.getScaledValue(elementBox.width), this.getScaledValue(underlineHeight));\n    };\n    /**\n     * Renders strike through.\n     * @param {ElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {Strikethrough} strikethrough\n     * @param {string} color\n     * @param {BaselineAlignment} baselineAlignment\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderStrikeThrough = function (elementBox, left, top, strikethrough, color, baselineAlignment) {\n        var renderedHeight = elementBox.height / (baselineAlignment === 'Normal' ? 1 : 1.5);\n        var topMargin = elementBox.margin.top;\n        if (baselineAlignment === 'Subscript') {\n            topMargin += elementBox.height - renderedHeight;\n        }\n        top += topMargin > 0 ? topMargin : 0;\n        var lineHeight = renderedHeight / 20;\n        var y = (renderedHeight / 2) + (0.5 * lineHeight);\n        var lineCount = 0;\n        if (strikethrough === 'DoubleStrike') {\n            y -= lineHeight;\n        }\n        while (lineCount < (strikethrough === 'DoubleStrike' ? 2 : 1)) {\n            lineCount++;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left + elementBox.margin.left, 1), this.getScaledValue(y + top, 2), this.getScaledValue(elementBox.width), this.getScaledValue(lineHeight));\n            y += 2 * lineHeight;\n        }\n    };\n    /**\n     * Renders image element box.\n     * @param {ImageElementBox} elementBox\n     * @param {number} left\n     * @param {number} top\n     * @param {number} underlineY\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderImageElementBox = function (elementBox, left, top, underlineY) {\n        var topMargin = elementBox.margin.top;\n        var leftMargin = elementBox.margin.left;\n        var color = 'black';\n        this.pageContext.textBaseline = 'top';\n        var widgetWidth = 0;\n        var isClipped = false;\n        if (topMargin < 0 || elementBox.line.paragraph.width < elementBox.width) {\n            var containerWid = elementBox.line.paragraph.containerWidget;\n            // if (containerWid instanceof BodyWidget) {\n            //     widgetWidth = containerWid.width + containerWid.x;\n            // } else \n            if (containerWid instanceof TableCellWidget) {\n                var leftIndent = 0;\n                if (containerWid.childWidgets[0] instanceof ParagraphWidget) {\n                    var paraAdv = containerWid.childWidgets[0];\n                    leftIndent = paraAdv.paragraphFormat.leftIndent;\n                }\n                widgetWidth = containerWid.width + containerWid.margin.left - containerWid.leftBorderWidth - leftIndent;\n                isClipped = true;\n                // tslint:disable-next-line:max-line-length\n                this.clipRect(left + leftMargin, top + topMargin, this.getScaledValue(widgetWidth), this.getScaledValue(containerWid.height));\n            }\n        }\n        if (elementBox.isMetaFile) {\n            /* tslint:disable:no-empty */\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.drawImage(elementBox.element, this.getScaledValue(left + leftMargin, 1), this.getScaledValue(top + topMargin, 2), this.getScaledValue(elementBox.width), this.getScaledValue(elementBox.height));\n        }\n        if (isClipped) {\n            this.pageContext.restore();\n        }\n    };\n    /**\n     * Renders table outline.\n     * @param {TableWidget} tableWidget\n     */\n    Renderer.prototype.renderTableOutline = function (tableWidget) {\n        var layout = new Layout(this.viewer);\n        var table = tableWidget;\n        tableWidget.width = this.viewer.layout.getTableWidth(table);\n        var border = layout.getTableTopBorder(table.tableFormat.borders);\n        var lineWidth = 0;\n        //ToDo: Need to draw the borders based on the line style.\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y, tableWidget.x - tableWidget.margin.left - lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableTopBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y - lineWidth / 2, lineWidth);\n        // }\n        border = layout.getTableRightBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y, tableWidget.x + tableWidget.width + tableWidget.margin.right + lineWidth / 2, tableWidget.y + tableWidget.height, lineWidth);\n        // }\n        border = layout.getTableBottomBorder(table.tableFormat.borders);\n        lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, tableWidget.x - tableWidget.margin.left - lineWidth, tableWidget.y + tableWidget.height - lineWidth / 2, tableWidget.x + tableWidget.width + lineWidth + tableWidget.margin.right, tableWidget.y + tableWidget.height - lineWidth / 2, lineWidth);\n        // }\n    };\n    /**\n     * Renders table cell outline.\n     * @param {LayoutViewer} viewer\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderTableCellOutline = function (viewer, cellWidget) {\n        var layout = viewer.layout;\n        var borders = undefined;\n        var tableCell = cellWidget;\n        var cellTopMargin = 0;\n        var cellBottomMargin = 0;\n        var cellLeftMargin = 0;\n        var cellRightMargin = 0;\n        var height = 0;\n        borders = tableCell.cellFormat.borders;\n        if (cellWidget.containerWidget instanceof TableRowWidget) {\n            cellBottomMargin = cellWidget.margin.bottom - cellWidget.containerWidget.bottomBorderWidth;\n            cellTopMargin = cellWidget.margin.top - cellWidget.containerWidget.topBorderWidth;\n        }\n        cellLeftMargin = cellWidget.margin.left - cellWidget.leftBorderWidth;\n        cellRightMargin = cellWidget.margin.right - cellWidget.rightBorderWidth;\n        if (!isNullOrUndefined(tableCell.ownerRow) && tableCell.ownerRow.rowFormat.heightType === 'Exactly') {\n            height = HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height) + cellTopMargin + cellBottomMargin;\n        }\n        else {\n            if (!isNullOrUndefined(tableCell.ownerRow) && [tableCell.ownerRow].length <= 1) {\n                // tslint:disable-next-line:max-line-length\n                height = Math.max(HelperMethods.convertPointToPixel(tableCell.ownerRow.rowFormat.height), cellWidget.height) + cellTopMargin + cellBottomMargin;\n            }\n            else {\n                height = cellWidget.height + cellTopMargin + cellBottomMargin;\n            }\n        }\n        this.renderCellBackground(height, cellWidget);\n        var border = TableCellWidget.getCellLeftBorder(tableCell);\n        var lineWidth = 0;\n        // if (!isNullOrUndefined(border )) {       \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth()); //Renders the cell left border.\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y - cellTopMargin, cellWidget.x - cellLeftMargin - lineWidth, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        // }\n        border = TableCellWidget.getCellTopBorder(tableCell);\n        // if (!isNullOrUndefined(border )) { //Renders the cell top border.        \n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        // tslint:disable-next-line:max-line-length\n        this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y - cellWidget.margin.top + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y - cellWidget.margin.top + lineWidth / 2, lineWidth);\n        // }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.cellIndex === tableCell.ownerRow.childWidgets.length - 1) {\n            border = TableCellWidget.getCellRightBorder(tableCell);\n            // if (!isNullOrUndefined(border )) { //Renders the cell right border.           \n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellWidget.margin.right - lineWidth / 2, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n            // }\n        }\n        var nextRow = tableCell.ownerRow.nextWidget;\n        //Specifies the next row is within the current table widget.\n        //True means current row is not rendered at page end; Otherwise False.\n        var nextRowIsInCurrentTableWidget = false;\n        if (!isNullOrUndefined(nextRow)) {\n            var nextRowWidget = undefined;\n            // if (viewer.renderedElements.containsKey(nextRow) && viewer.renderedElements.get(nextRow).length > 0) {\n            nextRowWidget = nextRow;\n            // }\n            if (nextRowWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                if (cellWidget.containerWidget instanceof TableRowWidget && cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                    nextRowIsInCurrentTableWidget = cellWidget.containerWidget.containerWidget.childWidgets.indexOf(nextRowWidget) !== -1;\n                }\n            }\n        }\n        if (tableCell.ownerTable.tableFormat.cellSpacing > 0 || tableCell.ownerRow.rowIndex === tableCell.ownerTable.childWidgets.length - 1\n            || (tableCell.cellFormat.rowSpan > 1\n                && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ||\n            !nextRowIsInCurrentTableWidget) {\n            // tslint:disable-next-line:max-line-length\n            border = (tableCell.cellFormat.rowSpan > 1 && tableCell.ownerRow.rowIndex + tableCell.cellFormat.rowSpan === tableCell.ownerTable.childWidgets.length) ?\n                //true part for vertically merged cells specifically.\n                tableCell.getBorderBasedOnPriority(tableCell.cellFormat.borders.bottom, TableCellWidget.getCellBottomBorder(tableCell))\n                //false part for remaining cases that has been handled inside method. \n                : TableCellWidget.getCellBottomBorder(tableCell);\n            // if (!isNullOrUndefined(border )) {\n            //Renders the cell bottom border.\n            lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellWidget.margin.left, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, cellWidget.x + cellWidget.width + cellWidget.margin.right, cellWidget.y + cellWidget.height + cellBottomMargin + lineWidth / 2, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalUpBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal up border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y + cellWidget.height + cellBottomMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y - cellTopMargin, lineWidth);\n            // }\n        }\n        border = layout.getCellDiagonalDownBorder(tableCell);\n        // if (!isNullOrUndefined(border )) {\n        //Renders the cell diagonal down border.\n        lineWidth = HelperMethods.convertPointToPixel(border.getLineWidth());\n        if (lineWidth > 0) {\n            // tslint:disable-next-line:max-line-length\n            this.renderSingleBorder(border, cellWidget.x - cellLeftMargin, cellWidget.y - cellTopMargin, cellWidget.x + cellWidget.width + cellRightMargin, cellWidget.y + cellWidget.height + cellBottomMargin, lineWidth);\n        }\n        // }\n    };\n    /**\n     * Renders cell background.\n     * @param {number} height\n     * @param {TableCellWidget} cellWidget\n     */\n    Renderer.prototype.renderCellBackground = function (height, cellWidget) {\n        var cellFormat = cellWidget.cellFormat;\n        var bgColor = cellFormat.shading.backgroundColor === '#ffffff' ?\n            cellWidget.ownerTable.tableFormat.shading.backgroundColor : cellFormat.shading.backgroundColor;\n        this.pageContext.beginPath();\n        if (bgColor !== 'empty') {\n            this.pageContext.fillStyle = this.getColor(bgColor);\n            var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n            var top_1 = cellWidget.y - HelperMethods.convertPointToPixel(cellWidget.topMargin);\n            // tslint:disable-next-line:max-line-length\n            var width = cellWidget.width + cellWidget.margin.left + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n            // tslint:disable-next-line:max-line-length\n            this.pageContext.fillRect(this.getScaledValue(left, 1), this.getScaledValue(top_1, 2), this.getScaledValue(width), this.getScaledValue(height));\n            this.pageContext.closePath();\n        }\n    };\n    /**\n     * Renders single border.\n     * @param {WBorder} border\n     * @param {number} startX\n     * @param {number} startY\n     * @param {number} endX\n     * @param {number} endY\n     * @param {number} lineWidth\n     */\n    // tslint:disable-next-line:max-line-length\n    Renderer.prototype.renderSingleBorder = function (border, startX, startY, endX, endY, lineWidth) {\n        this.pageContext.beginPath();\n        this.pageContext.moveTo(this.getScaledValue(startX, 1), this.getScaledValue(startY, 2));\n        this.pageContext.lineTo(this.getScaledValue(endX, 1), this.getScaledValue(endY, 2));\n        this.pageContext.lineWidth = this.getScaledValue(lineWidth);\n        // set line color\n        this.pageContext.strokeStyle = border.color;\n        if (lineWidth > 0) {\n            this.pageContext.stroke();\n        }\n        this.pageContext.closePath();\n    };\n    /**\n     * Gets scaled value.\n     * @param {number} value\n     * @param {number} type\n     * @private\n     */\n    Renderer.prototype.getScaledValue = function (value, type) {\n        if (this.isPrinting) {\n            return value;\n        }\n        if (isNullOrUndefined(type)) {\n            type = 0;\n        }\n        var x = value * this.viewer.zoomFactor;\n        return x + (type === 1 ? this.pageLeft : (type === 2 ? this.pageTop : 0));\n    };\n    /**\n     * Destroys the internal objects which is maintained.\n     */\n    Renderer.prototype.destroy = function () {\n        this.viewer = undefined;\n        if (!isNullOrUndefined(this.pageCanvasIn)) {\n            this.pageCanvasIn.innerHTML = '';\n        }\n        this.pageCanvasIn = undefined;\n    };\n    return Renderer;\n}());\nexport { Renderer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WCharacterFormat } from '../index';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar TextHelper = /** @class */ (function () {\n    function TextHelper(viewer) {\n        this.owner = viewer;\n        if (!isNullOrUndefined(viewer)) {\n            this.context = viewer.containerContext;\n        }\n    }\n    Object.defineProperty(TextHelper.prototype, \"paragraphMark\", {\n        get: function () {\n            return 'Â¶';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextHelper.prototype, \"lineBreakMark\", {\n        get: function () {\n            return 'â†²';\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkWidth = function (characterFormat) {\n        return this.getWidth(this.paragraphMark, characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getParagraphMarkSize = function (characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(this.paragraphMark, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getTextSize = function (elementBox, characterFormat) {\n        // Gets the text element's width;\n        var textTrimEndWidth = 0;\n        textTrimEndWidth = this.getWidth(elementBox.text, characterFormat);\n        elementBox.width = textTrimEndWidth;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n        if (elementBox.text[elementBox.text.length - 1] === ' ') {\n            textTrimEndWidth = this.getWidth(HelperMethods.trimEnd(elementBox.text), characterFormat);\n        }\n        return textTrimEndWidth;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeight = function (characterFormat) {\n        // Get character format property as  below predefined structure to make it easy to check and retrieve\n        // Predefined static structure `[FontName];[FontSize];bold;italic` to maintain as key in the collection \n        var key = this.getFormatText(characterFormat);\n        if (!isNullOrUndefined(this.owner.heightInfoCollection[key])) {\n            return this.owner.heightInfoCollection[key];\n        }\n        var sizeInfo = this.getHeightInternal(characterFormat);\n        this.owner.heightInfoCollection[key] = sizeInfo;\n        return sizeInfo;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getFormatText = function (characterFormat) {\n        var formatText = characterFormat.fontFamily.toLocaleLowerCase();\n        formatText += ';' + characterFormat.fontSize;\n        if (characterFormat.bold) {\n            formatText += ';' + 'bold';\n        }\n        if (characterFormat.italic) {\n            formatText += ';' + 'italic';\n        }\n        return formatText;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getHeightInternal = function (characterFormat) {\n        var textHeight = 0;\n        var baselineOffset = 0;\n        var spanElement = document.createElement('span');\n        spanElement.id = 'tempSpan';\n        spanElement.style.whiteSpace = 'nowrap';\n        spanElement.innerText = 'm';\n        this.applyStyle(spanElement, characterFormat);\n        var body = document.getElementsByTagName('body');\n        var parentDiv = document.createElement('div');\n        parentDiv.style.display = 'inline-block';\n        var tempDiv = document.createElement('div');\n        tempDiv.setAttribute('style', 'display:inline-block;width: 1px; height: 0px;vertical-align: baseline;');\n        parentDiv.appendChild(spanElement);\n        parentDiv.appendChild(tempDiv);\n        document.body.appendChild(parentDiv);\n        // Sets the text element's height.\n        textHeight = spanElement.offsetHeight;\n        // Calculate the text element's baseline offset.\n        var textTopVal = spanElement.offsetTop;\n        var tempDivTopVal = tempDiv.offsetTop;\n        baselineOffset = tempDivTopVal - textTopVal;\n        document.body.removeChild(parentDiv);\n        return { 'Height': textHeight, 'BaselineOffset': baselineOffset };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureTextExcludingSpaceAtEnd = function (text, characterFormat) {\n        return this.getWidth(HelperMethods.trimEnd(text), characterFormat);\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.getWidth = function (text, characterFormat) {\n        if (text.match('\\v')) {\n            text.replace('\\v', this.lineBreakMark);\n        }\n        var bold = '';\n        var italic = '';\n        var fontFamily = '';\n        var fontSize = characterFormat.fontSize;\n        bold = characterFormat.bold ? 'bold' : '';\n        italic = characterFormat.italic ? 'italic' : '';\n        fontFamily = characterFormat.fontFamily;\n        fontSize = fontSize === 0 ? 0.5 : fontSize / (characterFormat.baselineAlignment === 'Normal' ? 1 : 1.5);\n        this.context.font = bold + ' ' + italic + ' ' + fontSize + 'pt' + ' ' + fontFamily;\n        return this.context.measureText(text).width;\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.applyStyle = function (spanElement, characterFormat) {\n        if (!isNullOrUndefined(spanElement) && !isNullOrUndefined(characterFormat)) {\n            if (characterFormat.fontFamily !== '') {\n                spanElement.style.fontFamily = characterFormat.fontFamily;\n            }\n            var fontSize = characterFormat.fontSize;\n            if (fontSize <= 0.5) {\n                fontSize = 0.5;\n            }\n            spanElement.style.fontSize = fontSize.toString() + 'pt';\n            if (characterFormat.bold) {\n                spanElement.style.fontWeight = 'bold';\n            }\n            if (characterFormat.italic) {\n                spanElement.style.fontStyle = 'italic';\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.measureText = function (text, characterFormat) {\n        // Gets the text element's width;\n        var width = this.getWidth(text, characterFormat);\n        var height = 0;\n        var baselineOffset = 0;\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(characterFormat);\n        return {\n            'Width': width, 'Height': textHelper.Height, 'BaselineOffset': textHelper.BaselineOffset\n        };\n    };\n    /**\n     * @private\n     */\n    TextHelper.prototype.updateTextSize = function (elementBox, paragraph) {\n        var format = new WCharacterFormat(undefined);\n        var listCharacterFormat = elementBox.listLevel.characterFormat;\n        var breakCharacterFormat = paragraph.characterFormat;\n        format.fontSize = listCharacterFormat.fontSize === 11 ? breakCharacterFormat.fontSize : listCharacterFormat.fontSize;\n        format.fontFamily = listCharacterFormat.fontFamily === 'Verdana' ? breakCharacterFormat.fontFamily\n            : listCharacterFormat.fontFamily;\n        var bold = '';\n        var italic = '';\n        var baselineAlignment = listCharacterFormat.baselineAlignment === 'Normal' ?\n            breakCharacterFormat.baselineAlignment : listCharacterFormat.baselineAlignment;\n        bold = listCharacterFormat.bold ? 'bold' : breakCharacterFormat.bold ? 'bold' : '';\n        italic = listCharacterFormat.italic ? 'italic' : breakCharacterFormat.italic ? 'italic' : '';\n        format.baselineAlignment = baselineAlignment;\n        if (bold) {\n            format.bold = true;\n        }\n        if (italic) {\n            format.italic = true;\n        }\n        elementBox.width = this.getWidth(elementBox.text, format);\n        // Calculate the text element's height and baseline offset.\n        var textHelper = this.getHeight(format);\n        elementBox.height = textHelper.Height;\n        elementBox.baselineOffset = textHelper.BaselineOffset;\n    };\n    TextHelper.prototype.destroy = function () {\n        this.owner = undefined;\n        this.context = undefined;\n    };\n    return TextHelper;\n}());\nexport { TextHelper };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar Zoom = /** @class */ (function () {\n    function Zoom(viewer) {\n        var _this = this;\n        this.onMouseWheelInternal = function (event) {\n            if (event.ctrlKey === true) {\n                event.preventDefault();\n                var pageX = event.pageX - _this.viewer.viewerContainer.offsetLeft;\n                if (pageX < _this.viewer.pageContainer.offsetWidth) {\n                    var wheel = navigator.userAgent.match('Firefox') ? event.detail < 0 : event.wheelDelta > 0;\n                    var zoomFactor = _this.viewer.zoomFactor;\n                    if (wheel) {\n                        if (zoomFactor <= 4.90) {\n                            zoomFactor += .10;\n                        }\n                        else {\n                            zoomFactor = 5.00;\n                        }\n                    }\n                    else {\n                        if (zoomFactor >= .20) {\n                            zoomFactor -= .10;\n                        }\n                        else {\n                            zoomFactor = 0.10;\n                        }\n                    }\n                    _this.viewer.zoomFactor = zoomFactor;\n                }\n            }\n        };\n        this.viewer = viewer;\n    }\n    Zoom.prototype.setZoomFactor = function (value) {\n        this.onZoomFactorChanged();\n        if (!isNullOrUndefined(this.viewer.selection)) {\n            this.viewer.selection.updateCaretPosition();\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (!isNullOrUndefined(this.viewer.owner.imageResizerModule)) {\n            this.viewer.owner.imageResizerModule.updateImageResizerPosition();\n        }\n        this.viewer.owner.fireZoomFactorChange();\n    };\n    //Zoom Implementation Starts\n    Zoom.prototype.onZoomFactorChanged = function () {\n        if (this.viewer.zoomFactor > 5) {\n            this.viewer.zoomFactor = 5;\n        }\n        else if (this.viewer.zoomFactor < 0.1) {\n            this.viewer.zoomFactor = 0.1;\n        }\n        this.zoom();\n    };\n    Zoom.prototype.zoom = function () {\n        var viewer = this.viewer;\n        viewer.clearContent();\n        viewer.handleZoom();\n        viewer.updateFocus();\n    };\n    return Zoom;\n}());\nexport { Zoom };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Dictionary } from '../../base/dictionary';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WParagraphFormat, WStyles } from '../format/index';\nimport { Layout } from './layout';\nimport { Renderer } from './render';\nimport { createElement, Browser } from '@syncfusion/ej2-base';\nimport { Page, Rect, ListTextElementBox, ParagraphWidget, HeaderFooterWidget } from './page';\nimport { LineWidget, TableWidget } from './page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { TextHelper } from './text-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Zoom } from './zooming';\nimport { Dialog } from '@syncfusion/ej2-popups';\n/**\n * @private\n */\nvar LayoutViewer = /** @class */ (function () {\n    //#endregion\n    function LayoutViewer(owner) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.textWrap = true;\n        /**\n         * @private\n         */\n        this.currentPage = undefined;\n        this.selectionStartPageIn = undefined;\n        this.selectionEndPageIn = undefined;\n        /**\n         * @private\n         */\n        this.fieldStacks = [];\n        /**\n         * @private\n         */\n        this.splittedCellWidgets = [];\n        /**\n         * @private\n         */\n        this.tableLefts = [];\n        this.tapCount = 0;\n        this.timer = -1;\n        this.isTimerStarted = false;\n        /**\n         * @private\n         */\n        this.isFirstLineFitInShiftWidgets = false;\n        /**\n         * @private\n         */\n        this.preZoomFactor = 0;\n        /**\n         * @private\n         */\n        this.preDifference = -1;\n        /**\n         * @private\n         */\n        this.fieldEndParagraph = undefined;\n        /**\n         * @private\n         */\n        this.fieldToLayout = undefined;\n        /**\n         * @private\n         */\n        this.backgroundColor = '#FFFFFF';\n        /**\n         * @private\n         */\n        this.containerTop = 0;\n        /**\n         * @private\n         */\n        this.containerLeft = 0;\n        // Event \n        /**\n         * @private\n         */\n        this.isMouseDown = false;\n        /**\n         * @private\n         */\n        this.isSelectionChangedOnMouseMoved = false;\n        /**\n         * @private\n         */\n        this.isControlPressed = false;\n        /**\n         * @private\n         */\n        this.isTouchInput = false;\n        /**\n         * @private\n         */\n        this.useTouchSelectionMark = false;\n        /**\n         * @private\n         */\n        this.touchDownOnSelectionMark = 0;\n        /**\n         * @private\n         */\n        this.isComposingIME = false;\n        /**\n         * @private\n         */\n        this.lastComposedText = '';\n        /**\n         * @private\n         */\n        this.isCompositionStart = false;\n        /**\n         * @private\n         */\n        this.isCompositionUpdated = false;\n        /**\n         * @private\n         */\n        this.isCompositionCanceled = false;\n        /**\n         * @private\n         */\n        this.isCompositionEnd = false;\n        /**\n         * @private\n         */\n        this.prefix = '';\n        /**\n         * @private\n         */\n        this.suffix = '';\n        /**\n         * @private\n         */\n        this.fields = [];\n        /**\n         * @private\n         */\n        this.heightInfoCollection = {};\n        /**\n         * @private\n         */\n        this.defaultTabWidth = 36;\n        /**\n         * @private\n         */\n        this.lists = [];\n        /**\n         * @private\n         */\n        this.abstractLists = [];\n        /**\n         * @private\n         */\n        this.styles = new WStyles();\n        /**\n         * @private\n         */\n        this.preDefinedStyles = undefined;\n        /**\n         * @private\n         */\n        this.isRowOrCellResizing = false;\n        this.isMouseDownInFooterRegion = false;\n        this.pageFitTypeIn = 'None';\n        /**\n         * @private\n         */\n        this.fieldCollection = [];\n        /**\n         * @private\n         */\n        this.isPageField = false;\n        /**\n         * @private\n         */\n        this.mouseDownOffset = new Point(0, 0);\n        this.zoomFactorInternal = 1;\n        /**\n         * @private\n         */\n        this.onTextInput = function (event) {\n            if (!_this.isComposingIME) {\n                event.preventDefault();\n                var text = event.data;\n                _this.owner.editor.handleTextInput(text);\n            }\n        };\n        //#region Composition Event\n        /**\n         * Fires when composition starts.\n         * @private\n         */\n        this.compositionStart = function (event) {\n            if (!Browser.isDevice && !_this.owner.isReadOnlyMode) {\n                _this.isComposingIME = true;\n                _this.positionEditableTarget();\n                if (_this.owner.editorHistory) {\n                    _this.owner.editor.initComplexHistory('IMEInput');\n                }\n            }\n            _this.isCompositionStart = true;\n        };\n        /**\n         * Fires on every input during composition.\n         * @private\n         */\n        this.compositionUpdated = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                /* tslint:disable:align */\n                setTimeout(function () {\n                    _this.owner.editor.insertIMEText(_this.getEditableDivTextContent(), true);\n                }, 0);\n            }\n            _this.isCompositionUpdated = true;\n        };\n        /**\n         * Fires when user selects a character/word and finalizes the input.\n         * @private\n         */\n        this.compositionEnd = function (event) {\n            if (_this.isComposingIME && !_this.owner.isReadOnlyMode) {\n                var text = _this.getEditableDivTextContent();\n                if (text !== '') {\n                    _this.owner.editor.insertIMEText(text, false);\n                }\n                _this.isComposingIME = false;\n                _this.lastComposedText = '';\n                _this.iframe.setAttribute('style', 'pointer-events:none;position:absolute;top:-10000px');\n                _this.editableDiv.innerHTML = '';\n                if (_this.owner.editorHistory) {\n                    _this.owner.editorHistory.updateComplexHistory();\n                    if (text === '') {\n                        // tslint:disable-next-line:max-line-length\n                        //When the composition in live. The Undo operation will terminate the composition and empty text will be return from text box.\n                        //At that time the the history should be updated. Undo the operation and clear the redo stack. This undo operation will not be saved for redo operation.\n                        _this.owner.editorHistory.undo();\n                        _this.owner.editorHistory.redoStack.pop();\n                    }\n                }\n            }\n            event.preventDefault();\n            _this.isCompositionUpdated = false;\n            _this.isCompositionEnd = true;\n        };\n        // tslint:disable:no-any \n        this.onImageResizer = function (args) {\n            if (!isNullOrUndefined(_this.owner.imageResizerModule) && _this.owner.imageResizerModule.isImageResizerVisible\n                && _this.owner.imageResizerModule.isImageResizing) {\n                if (args instanceof MouseEvent) {\n                    _this.onMouseUpInternal(args);\n                }\n                else if (args instanceof TouchEvent) {\n                    _this.onTouchUpInternal(args);\n                }\n            }\n        };\n        // tslint:enable:no-any \n        this.onKeyPressInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                var key = event.keyCode || event.charCode;\n                var char = '';\n                if (key) {\n                    char = String.fromCharCode(key);\n                }\n                else if (event.key) {\n                    char = event.key;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (char !== 'Spacebar' && char !== '\\r' && char !== '\\b' && char !== '\\u001B' && !_this.owner.isReadOnlyMode && event.ctrlKey === false) {\n                    _this.owner.editorModule.handleTextInput(char);\n                }\n                else if (char === 'Spacebar') {\n                    _this.owner.editorModule.handleTextInput(' ');\n                }\n                event.preventDefault();\n            }\n        };\n        this.onTextInputInternal = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.onTextInputInternal(event);\n            }\n            else {\n                _this.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.owner.editorModule.pasteInternal(event);\n            }\n            _this.editableDiv.innerText = '';\n            event.preventDefault();\n        };\n        /**\n         * Fires when editable div loses focus.\n         * @private\n         */\n        this.onFocusOut = function () {\n            if (!isNullOrUndefined(_this.selection)) {\n                if (_this.owner.contextMenuModule && _this.owner.contextMenuModule.contextMenuInstance &&\n                    _this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                    return;\n                }\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Updates focus to editor area.\n         * @private\n         */\n        this.updateFocus = function () {\n            if (_this.selection) {\n                _this.editableDiv.focus();\n                _this.selection.showCaret();\n            }\n        };\n        /**\n         * Fires on scrolling.\n         */\n        this.scrollHandler = function () {\n            _this.clearContent();\n            _this.updateScrollBars();\n            var vtHeight = _this.containerTop + _this.visibleBounds.height;\n            if (vtHeight > _this.pageContainer.offsetHeight) {\n                _this.viewerContainer.scrollTop = _this.containerTop - (vtHeight - _this.pageContainer.offsetHeight);\n            }\n            var viewer = _this;\n            if (viewer instanceof PageLayoutViewer && !isNullOrUndefined(_this.owner)) {\n                _this.owner.fireViewChange();\n            }\n        };\n        /**\n         * Fires when the window gets resized.\n         * @private\n         */\n        this.onWindowResize = function () {\n            var viewer = _this;\n            var resizeTimer;\n            /* tslint:disable:align */\n            resizeTimer = setTimeout(function () {\n                if (!isNullOrUndefined(viewer.owner) && !isNullOrUndefined(_this.owner.element)) {\n                    viewer.updateViewerSizeInternal(document.getElementById(viewer.owner.element.id));\n                    viewer.updateScrollBars();\n                    if (!isNullOrUndefined(_this.selection)) {\n                        _this.selection.updateCaretPosition();\n                    }\n                    viewer.updateTouchMarkPosition();\n                    if (viewer.owner.contextMenuModule && viewer.owner.contextMenuModule.contextMenuInstance) {\n                        viewer.owner.contextMenuModule.contextMenuInstance.close();\n                    }\n                    if (resizeTimer) {\n                        clearTimeout(resizeTimer);\n                    }\n                }\n            }, 100);\n        };\n        /**\n         * @private\n         */\n        this.onContextMenu = function (event) {\n            if (_this.owner.contextMenuModule) {\n                _this.owner.contextMenuModule.onContextMenuInternal(event);\n            }\n        };\n        /**\n         * Called on mouse down.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseDownInternal = function (event) {\n            if (_this.isTouchInput || event.offsetX > (_this.visibleBounds.width - (_this.visibleBounds.width - _this.viewerContainer.clientWidth))\n                || event.offsetY > (_this.visibleBounds.height - (_this.visibleBounds.height - _this.viewerContainer.clientHeight))) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.updateCursor(event);\n                // tslint:disable-next-line:max-line-length\n                if (_this.isLeftButtonPressed(event) && !_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                    _this.owner.imageResizerModule.isImageResizing = true;\n                }\n                event.preventDefault();\n                if (!_this.isTouchInput) {\n                    _this.selection.hideCaret();\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                _this.mouseDownOffset.x = touchPoint.x;\n                _this.mouseDownOffset.y = touchPoint.y;\n                // tslint:disable-next-line:max-line-length\n                _this.isMouseDownInFooterRegion = _this.selection.isCursorInsidePageRect(cursorPoint, _this.currentPage) && _this.selection.isCursorInFooterRegion(cursorPoint, _this.currentPage);\n                _this.isSelectionChangedOnMouseMoved = false;\n                if (!_this.owner.isReadOnlyMode && (_this.owner.editorModule.tableResize.isInCellResizerArea(touchPoint) ||\n                    _this.owner.editorModule.tableResize.isInRowResizerArea(touchPoint))) {\n                    _this.selection.hideCaret();\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    if (_this.isLeftButtonPressed(event)) {\n                        _this.owner.editorModule.tableResize.startingPoint.x = touchPoint.x;\n                        _this.owner.editorModule.tableResize.startingPoint.y = touchPoint.y;\n                        _this.owner.editorModule.tableResize.handleResize(touchPoint);\n                    }\n                    return;\n                }\n                if (event.ctrlKey) {\n                    _this.isControlPressed = true;\n                }\n                if (_this.owner.selection.isEmpty) {\n                    _this.useTouchSelectionMark = false;\n                }\n                if (event.which === 3 && !_this.owner.selection.isEmpty\n                    && _this.selection.checkCursorIsInSelection(_this.getLineWidget(touchPoint), touchPoint)) {\n                    event.preventDefault();\n                    return;\n                }\n                _this.isTouchInput = false;\n                _this.isMouseDown = true;\n                _this.updateFocus();\n                /* tslint:disable:align */\n                _this.timer = setTimeout(function () {\n                    _this.tapCount++;\n                    if (_this.tapCount === 4) {\n                        _this.tapCount = 1;\n                    }\n                }, 200);\n            }\n        };\n        /**\n         * Called on mouse move.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseMoveInternal = function (event) {\n            event.preventDefault();\n            if (!isNullOrUndefined(_this.selection)) {\n                //For image Resizing\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode\n                    && _this.owner.imageResizerModule.isImageResizing) {\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnMouse(event);\n                    }\n                    return;\n                }\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                var touchPoint = _this.findFocusedPage(cursorPoint, !_this.owner.enableHeaderAndFooter);\n                if (_this.isMouseDown) {\n                    if (!isNullOrUndefined(_this.currentPage)) {\n                        var xPosition = touchPoint.x;\n                        var yPosition = touchPoint.y;\n                        if (!_this.owner.isReadOnlyMode && _this.isRowOrCellResizing) {\n                            _this.owner.editorModule.tableResize.handleResizing(touchPoint);\n                        }\n                        else {\n                            if (!(_this.isTouchInput || _this.isSelectionChangedOnMouseMoved || _this.touchDownOnSelectionMark > 0)) {\n                                _this.updateTextPositionForSelection(touchPoint, 1);\n                            }\n                            if (_this.isLeftButtonPressed(event)) {\n                                event.preventDefault();\n                                var touchY = yPosition;\n                                var textPosition = _this.owner.selection.end;\n                                var touchPoint_1 = new Point(xPosition, touchY);\n                                if (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizerVisible) {\n                                    _this.owner.selection.moveTextPosition(touchPoint_1, textPosition);\n                                }\n                                _this.isSelectionChangedOnMouseMoved = true;\n                            }\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!_this.isRowOrCellResizing && !_this.isSelectionChangedOnMouseMoved) {\n                    _this.updateCursor(event);\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.selection.hideCaret();\n                }\n            }\n        };\n        /**\n         * Fired on double tap.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onDoubleTap = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                _this.isTouchInput = false;\n                var cursorPoint = new Point(event.offsetX, event.offsetY);\n                if (_this.selection.checkAndEnableHeaderFooter(cursorPoint, _this.findFocusedPage(cursorPoint, true))) {\n                    return;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.selection.isEmpty && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                    _this.owner.selection.selectCurrentWord();\n                    _this.selection.checkForCursorVisibility();\n                    _this.tapCount = 2;\n                }\n            }\n        };\n        /**\n         * Called on mouse up.\n         * @param {MouseEvent} event\n         * @private\n         */\n        this.onMouseUpInternal = function (event) {\n            event.preventDefault();\n            _this.isListTextSelected = false;\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = _this.findFocusedPage(cursorPoint, true);\n            if (!isNullOrUndefined(_this.selection)) {\n                var tapCount = 1;\n                if (!Browser.isIE) {\n                    if (event.detail > 2) {\n                        tapCount = event.detail;\n                    }\n                }\n                else {\n                    tapCount = _this.tapCount;\n                }\n                if (_this.isRowOrCellResizing) {\n                    _this.owner.editorModule.tableResize.updateResizingHistory(touchPoint);\n                }\n                if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved\n                    && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (!_this.owner.enableImageResizerMode || !_this.owner.imageResizerModule.isImageResizing)) {\n                    if (_this.touchDownOnSelectionMark === 0 && !_this.isRowOrCellResizing) {\n                        _this.updateTextPositionForSelection(touchPoint, tapCount);\n                        if (Browser.isIE && tapCount === 2) {\n                            _this.selection.checkAndEnableHeaderFooter(cursorPoint, touchPoint);\n                        }\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n                if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)\n                    && (_this.owner.selection.isEmpty || _this.owner.selection.isImageSelected) &&\n                    (((event.ctrlKey && _this.owner.useCtrlClickToFollowHyperlink ||\n                        !_this.owner.useCtrlClickToFollowHyperlink) && _this.isLeftButtonPressed(event) === true))) {\n                    _this.selection.navigateHyperLinkOnEvent(touchPoint, false);\n                }\n                if (!_this.owner.isReadOnlyMode && _this.isSelectionInListText(touchPoint)) {\n                    _this.selection.selectListText();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (!_this.owner.isReadOnlyMode && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && !isNullOrUndefined(_this.selection.caret)) {\n                    _this.selection.caret.style.display = 'none';\n                }\n                _this.isMouseDown = false;\n                _this.isSelectionChangedOnMouseMoved = false;\n                _this.isTouchInput = false;\n                _this.useTouchSelectionMark = true;\n                _this.isControlPressed = false;\n                _this.updateFocus();\n                if (_this.isListTextSelected) {\n                    _this.selection.hideCaret();\n                }\n                if (_this.owner.enableImageResizerMode) {\n                    var imageResizer = _this.owner.imageResizerModule;\n                    imageResizer.isImageResizing = false;\n                    imageResizer.isImageMoveToNextPage = false;\n                    imageResizer.leftValue = undefined;\n                    imageResizer.topValue = undefined;\n                }\n                _this.isMouseDownInFooterRegion = false;\n            }\n        };\n        /**\n         * Fired on touch start.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchStartInternal = function (event) {\n            if (_this.selection) {\n                _this.isCompositionStart = false;\n                _this.isCompositionEnd = false;\n                _this.isCompositionUpdated = false;\n                _this.isCompositionCanceled = true;\n                _this.isTouchInput = true;\n                if (_this.isTimerStarted) {\n                    if (_this.tapCount === 1) {\n                        _this.tapCount = 2;\n                    }\n                    else {\n                        _this.tapCount = 3;\n                        _this.isTimerStarted = false;\n                    }\n                }\n                else {\n                    _this.isTimerStarted = true;\n                    _this.tapCount = 1;\n                }\n                if (event.touches.length === 1) {\n                    _this.zoomX = event.touches[0].clientX;\n                    _this.zoomY = event.touches[0].clientY;\n                    if (_this.owner.selection.isEmpty) {\n                        _this.useTouchSelectionMark = false;\n                    }\n                    _this.isMouseDown = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                    var point = void 0;\n                    if (_this.isMouseDown) {\n                        point = _this.getTouchOffsetValue(event);\n                    }\n                    point = _this.findFocusedPage(point, true);\n                    if (_this.owner.enableImageResizerMode) {\n                        var resizeObj = _this.owner.imageResizerModule.getImagePointOnTouch(point);\n                        _this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.owner.enableImageResizerMode && !isNullOrUndefined(_this.owner.imageResizerModule.selectedResizeElement)) {\n                        _this.owner.imageResizerModule.isImageResizing = true;\n                    }\n                    var x = _this.owner.selection.end.location.x;\n                    var y = _this.selection.getCaretBottom(_this.owner.selection.end, _this.owner.selection.isEmpty) + 9;\n                    //TouchDownOnSelectionMark will be 2 when touch end is pressed\n                    _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                        && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 1 : 0;\n                    if (!_this.owner.selection.isEmpty && _this.touchDownOnSelectionMark === 0) {\n                        x = _this.owner.selection.start.location.x;\n                        y = _this.selection.getCaretBottom(_this.owner.selection.start, false) + 9;\n                        //TouchDownOnSelectionMark will be 1 when touch start is pressed\n                        _this.touchDownOnSelectionMark = ((point.y <= y && point.y >= y - 20 || point.y >= y && point.y <= y + 20)\n                            && (point.x <= x && point.x >= x - 20 || point.x >= x && point.x <= x + 20)) ? 2 : 0;\n                    }\n                }\n                if (!isNullOrUndefined(_this.owner.contextMenuModule) && _this.owner.contextMenuModule.contextMenuInstance) {\n                    _this.owner.contextMenuModule.contextMenuInstance.close();\n                }\n                if (_this.touchDownOnSelectionMark || event.touches.length > 1) {\n                    event.preventDefault();\n                }\n                _this.timer = setTimeout(function () {\n                    _this.isTimerStarted = false;\n                }, 200);\n            }\n        };\n        /**\n         * Fired on touch move.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchMoveInternal = function (event) {\n            var touch = event.touches;\n            var cursorPoint;\n            if (!isNullOrUndefined(_this.selection)) {\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.editorModule && _this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    event.preventDefault();\n                    if (!_this.owner.imageResizerModule.isImageMoveToNextPage) {\n                        _this.owner.imageResizerModule.handleImageResizingOnTouch(event);\n                        _this.selection.caret.style.display = 'none';\n                    }\n                    return;\n                }\n                if (_this.isMouseDown) {\n                    cursorPoint = _this.getTouchOffsetValue(event);\n                    var touchPoint = _this.findFocusedPage(cursorPoint, true);\n                    if (_this.touchDownOnSelectionMark > 0 /*|| !this.useTouchSelectionMark*/) {\n                        event.preventDefault();\n                        var touchY = touchPoint.y;\n                        var textPosition = _this.owner.selection.end;\n                        var touchPointer = void 0;\n                        if (touchPoint.y <= 26) {\n                            touchY -= touchPoint.y < 0 ? 0 : touchPoint.y + 0.5;\n                        }\n                        else {\n                            touchY -= 36.5;\n                        }\n                        textPosition = _this.touchDownOnSelectionMark === 2 ? _this.selection.start : _this.selection.end;\n                        touchPoint = new Point(touchPoint.x, touchY);\n                        _this.owner.selection.moveTextPosition(touchPoint, textPosition);\n                        _this.isSelectionChangedOnMouseMoved = true;\n                    }\n                    _this.selection.checkForCursorVisibility();\n                }\n            }\n            if (touch.length > 1) {\n                event.preventDefault();\n                _this.isMouseDown = false;\n                _this.zoomX = (touch[0].clientX + touch[1].clientX) / 2;\n                _this.zoomY = (touch[0].clientY + touch[1].clientY) / 2;\n                // tslint:disable-next-line:max-line-length\n                var currentDiff = Math.sqrt(Math.pow((touch[0].clientX - touch[1].clientX), 2) + Math.pow((touch[0].clientY - touch[1].clientY), 2));\n                if (_this.preDifference > -1) {\n                    if (currentDiff > _this.preDifference) {\n                        _this.onPinchOutInternal(event);\n                    }\n                    else if (currentDiff < _this.preDifference) {\n                        _this.onPinchInInternal(event);\n                    }\n                }\n                else if (_this.zoomFactor < 2) {\n                    if (_this.preDifference !== -1) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                else if (_this.preDifference === -1) {\n                    if (_this.zoomFactor > 2) {\n                        if (currentDiff > _this.preDifference) {\n                            _this.onPinchInInternal(event);\n                        }\n                    }\n                }\n                _this.preDifference = currentDiff;\n            }\n        };\n        /**\n         * Fired on touch up.\n         * @param {TouchEvent} event\n         * @private\n         */\n        this.onTouchUpInternal = function (event) {\n            if (!isNullOrUndefined(_this.selection)) {\n                var point = _this.getTouchOffsetValue(event);\n                var touchPoint = _this.findFocusedPage(point, true);\n                if (event.changedTouches.length === 1) {\n                    _this.zoomX = undefined;\n                    _this.zoomY = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    if (_this.isMouseDown && !_this.isSelectionChangedOnMouseMoved && !isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.owner.selection.start)) {\n                        if (_this.touchDownOnSelectionMark === 0) {\n                            _this.updateTextPositionForSelection(new Point(touchPoint.x, touchPoint.y), _this.tapCount);\n                            if (_this.tapCount === 2) {\n                                _this.selection.checkAndEnableHeaderFooter(point, touchPoint);\n                            }\n                        }\n                        if (_this.owner.selection.isEmpty) {\n                            _this.selection.updateCaretPosition();\n                        }\n                        _this.selection.checkForCursorVisibility();\n                    }\n                    if (!isNullOrUndefined(_this.currentPage) && !isNullOrUndefined(_this.selection.start)\n                        && !_this.isSelectionChangedOnMouseMoved && (_this.selection.isEmpty ||\n                        _this.selection.isImageField() && (!_this.owner.enableImageResizerMode ||\n                            _this.owner.enableImageResizerMode && !_this.owner.imageResizerModule.isImageResizing))) {\n                        _this.selection.navigateHyperLinkOnEvent(touchPoint, true);\n                    }\n                    _this.isMouseDown = false;\n                    _this.touchDownOnSelectionMark = 0;\n                    _this.useTouchSelectionMark = true;\n                    _this.isSelectionChangedOnMouseMoved = false;\n                }\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizing) {\n                    _this.owner.imageResizerModule.mouseUpInternal();\n                    _this.owner.imageResizerModule.isImageResizing = false;\n                    _this.owner.imageResizerModule.isImageMoveToNextPage = false;\n                    _this.scrollToPosition(_this.owner.selection.start, _this.owner.selection.end);\n                    _this.owner.imageResizerModule.updateHistoryForImageResizer();\n                }\n                // tslint:disable-next-line:max-line-length\n                if (_this.owner.enableImageResizerMode && _this.owner.imageResizerModule.isImageResizerVisible && _this.isTouchInput) {\n                    _this.touchStart.style.display = 'none';\n                    _this.touchEnd.style.display = 'none';\n                }\n                // if (!this.owner.isReadOnlyMode && this.isSelectionInListText(touchPoint)) {\n                //     this.selection.selectListText();\n                // }\n                event.preventDefault();\n            }\n            _this.preDifference = -1;\n            _this.isTouchInput = false;\n            if (!_this.isTimerStarted) {\n                _this.tapCount = 1;\n            }\n            if (_this.isListTextSelected) {\n                _this.selection.hideCaret();\n            }\n        };\n        /**\n         * Fired on keyup event.\n         * @private\n         */\n        this.onKeyUpInternal = function (event) {\n            if (Browser.isDevice) {\n                if (window.getSelection().anchorOffset !== _this.prefix.length) {\n                    _this.selection.setEditableDivCaretPosition(_this.editableDiv.innerText.length);\n                }\n            }\n            if (event.ctrlKey || (event.keyCode === 17 || event.which === 17)) {\n                _this.isControlPressed = false;\n            }\n        };\n        /**\n         * Fired on keydown.\n         * @private\n         */\n        this.onKeyDownInternal = function (event) {\n            var isHandled = false;\n            var keyEventArgs = { 'event': event, 'isHandled': false, source: _this.owner };\n            _this.owner.trigger('keyDown', keyEventArgs);\n            if (keyEventArgs.isHandled) {\n                return;\n            }\n            var key = event.which || event.keyCode;\n            var ctrl = (event.ctrlKey || event.metaKey) ? true : ((key === 17) ? true : false); // ctrl detection       \n            var shift = event.shiftKey ? event.shiftKey : ((key === 16) ? true : false); // Shift Key detection        \n            var alt = event.altKey ? event.altKey : ((key === 18) ? true : false); // alt key detection\n            if (ctrl && !shift && !alt) {\n                switch (key) {\n                    case 80:\n                        event.preventDefault();\n                        _this.owner.print();\n                        isHandled = true;\n                        break;\n                    case 83:\n                        event.preventDefault();\n                        _this.owner.save(_this.owner.documentName === '' ? 'sample' : _this.owner.documentName, 'Sfdt');\n                        isHandled = true;\n                        break;\n                }\n            }\n            if (!isHandled && !isNullOrUndefined(_this.selection)) {\n                _this.selection.onKeyDownInternal(event, ctrl, shift, alt);\n            }\n            if (isHandled) {\n                event.preventDefault();\n            }\n        };\n        this.owner = owner;\n        this.pages = [];\n        this.render = new Renderer(this);\n        this.lists = [];\n        this.abstractLists = [];\n        this.characterFormat = new WCharacterFormat(this);\n        this.paragraphFormat = new WParagraphFormat(this);\n        this.renderedLists = new Dictionary();\n        this.headersFooters = [];\n        this.styles = new WStyles();\n        this.preDefinedStyles = new Dictionary();\n        this.initalizeStyles();\n        this.bookmarks = new Dictionary();\n    }\n    Object.defineProperty(LayoutViewer.prototype, \"containerCanvas\", {\n        //#region Properties\n        /**\n         * Gets container canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.containerCanvasIn)) {\n                this.containerCanvasIn = document.createElement('canvas');\n                this.containerCanvasIn.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.containerCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.containerCanvasIn);\n            }\n            return this.containerCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionCanvas\", {\n        /**\n         * Gets selection canvas.\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.selectionCanvasIn)) {\n                this.selectionCanvasIn = document.createElement('canvas');\n                this.selectionCanvas.getContext('2d').save();\n            }\n            if (!isNullOrUndefined(this.pageContainer)\n                && this.selectionCanvasIn.parentElement !== this.pageContainer) {\n                this.pageContainer.appendChild(this.selectionCanvasIn);\n            }\n            return this.selectionCanvasIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"containerContext\", {\n        /**\n         * Gets container context.\n         * @private\n         */\n        get: function () {\n            return this.containerCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionContext\", {\n        /**\n         * Gets selection context.\n         * @private\n         */\n        get: function () {\n            return this.selectionCanvas.getContext('2d');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"currentRenderingPage\", {\n        /**\n         * Gets the current rendering page.\n         */\n        get: function () {\n            if (this.pages.length === 0) {\n                return undefined;\n            }\n            return this.pages[this.pages.length - 1];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"visibleBounds\", {\n        /**\n         * Gets visible bounds.\n         * @private\n         */\n        get: function () {\n            return this.visibleBoundsIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"zoomFactor\", {\n        /**\n         * Gets or sets zoom factor.\n         * @private\n         */\n        get: function () {\n            return this.zoomFactorInternal;\n        },\n        set: function (value) {\n            if (this.zoomFactorInternal !== value) {\n                this.preZoomFactor = this.zoomFactor;\n                this.zoomFactorInternal = value;\n                this.zoomModule.setZoomFactor(value);\n                this.owner.zoomFactor = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selection\", {\n        /**\n         * Gets the selection.\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionStartPage\", {\n        /**\n         * Gets or sets selection start page.\n         * @private\n         */\n        get: function () {\n            return this.selectionStartPageIn;\n        },\n        set: function (value) {\n            this.selectionStartPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"selectionEndPage\", {\n        /**\n         * Gets or sets selection end page.\n         * @private\n         */\n        get: function () {\n            return this.selectionEndPageIn;\n        },\n        set: function (value) {\n            this.selectionEndPageIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal) {\n                this.initDialog();\n            }\n            return this.dialogInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"dialog2\", {\n        /**\n         * Gets the initialized default dialog.\n         * @private\n         */\n        get: function () {\n            if (!this.dialogInternal2) {\n                this.initDialog2();\n            }\n            return this.dialogInternal2;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(LayoutViewer.prototype, \"pageFitType\", {\n        /**\n         * Gets or sets page fit type.\n         * @private\n         */\n        get: function () {\n            return this.pageFitTypeIn;\n        },\n        set: function (value) {\n            this.pageFitTypeIn = value;\n            this.onPageFitTypeChanged(this.pageFitTypeIn);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    LayoutViewer.prototype.initalizeStyles = function () {\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Normal', '{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1', '{\"type\":\"Paragraph\",\"name\":\"Heading 1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 1 Char\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":12.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level1\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2', '{\"type\":\"Paragraph\",\"name\":\"Heading 2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 2 Char\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level2\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3', '{\"type\":\"Paragraph\",\"name\":\"Heading 3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 3 Char\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level3\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4', '{\"type\":\"Paragraph\",\"name\":\"Heading 4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 4 Char\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level4\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5', '{\"type\":\"Paragraph\",\"name\":\"Heading 5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 5 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level5\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6', '{\"type\":\"Paragraph\",\"name\":\"Heading 6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"link\":\"Heading 6 Char\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"},\"paragraphFormat\":{\"leftIndent\":0.0,\"rightIndent\":0.0,\"firstLineIndent\":0.0,\"beforeSpacing\":2.0,\"afterSpacing\":0.0,\"lineSpacing\":1.0791666507720947,\"lineSpacingType\":\"Multiple\",\"textAlignment\":\"Left\",\"outlineLevel\":\"Level6\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Default Paragraph Font', '{\"type\":\"Character\",\"name\":\"Default Paragraph Font\"}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 1 Char', '{\"type\":\"Character\",\"name\":\"Heading 1 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":16.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 2 Char', '{\"type\":\"Character\",\"name\":\"Heading 2 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":13.0,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 3 Char', '{\"type\":\"Character\",\"name\":\"Heading 3 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontSize\":12.0,\"fontFamily\":\"Calibri Light\",\"fontColor\": \"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 4 Char', '{\"type\":\"Character\",\"name\":\"Heading 4 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"italic\":true,\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 5 Char', '{\"type\":\"Character\",\"name\":\"Heading 5 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#2F5496\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Heading 6 Char', '{\"type\":\"Character\",\"name\":\"Heading 6 Char\",\"basedOn\":\"Default Paragraph Font\",\"characterFormat\":{\"fontFamily\":\"Calibri Light\",\"fontColor\":\"#1F3763\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Hyperlink', '{\"type\":\"Character\",\"name\":\"Hyperlink\",\"basedOn\":\"Default Paragraph Font\",\"next\":\"Normal\",\"characterFormat\":{\"fontColor\":\"#0563C1\",\"underline\": \"Single\"}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc1', '{\"type\":\"Paragraph\",\"name\":\"Toc1\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc2', '{\"type\":\"Paragraph\",\"name\":\"Toc2\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :11.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc3', '{\"type\":\"Paragraph\",\"name\":\"Toc3\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :22.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc4', '{\"type\":\"Paragraph\",\"name\":\"Toc4\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :33.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc5', '{\"type\":\"Paragraph\",\"name\":\"Toc5\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :44.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc6', '{\"type\":\"Paragraph\",\"name\":\"Toc6\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :55.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc7', '{\"type\":\"Paragraph\",\"name\":\"Toc7\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :66.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc8', '{\"type\":\"Paragraph\",\"name\":\"Toc8\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :77.0,\"afterSpacing\":5.0}}');\n        /* tslint:disable-next-line:max-line-length */\n        this.preDefinedStyles.add('Toc9', '{\"type\":\"Paragraph\",\"name\":\"Toc9\",\"basedOn\":\"Normal\",\"next\":\"Normal\",\"paragraphFormat\":{\"leftIndent\" :88.0,\"afterSpacing\":5.0}}');\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.clearDocumentItems = function () {\n        this.headersFooters = [];\n        this.fields = [];\n        this.bookmarks.clear();\n        this.styles.clear();\n        this.characterFormat.clearFormat();\n        this.paragraphFormat.clearFormat();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getAbstractListById = function (id) {\n        if (isNullOrUndefined(this.abstractLists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.abstractLists.length; i++) {\n            var abstractList = this.abstractLists[i];\n            if (abstractList instanceof WAbstractList && abstractList.abstractListId === id) {\n                return abstractList;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getListById = function (id) {\n        if (isNullOrUndefined(this.lists)) {\n            return undefined;\n        }\n        for (var i = 0; i < this.lists.length; i++) {\n            if (!isNullOrUndefined(this.lists[i]) && this.lists[i].listId === id) {\n                return this.lists[i];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.getListLevelNumber = function (listLevel) {\n        if (listLevel.ownerBase instanceof WLevelOverride) {\n            return listLevel.ownerBase.levelNumber;\n        }\n        else if (listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(listLevel.ownerBase.levels)) {\n            return listLevel.ownerBase.levels.indexOf(listLevel);\n        }\n        else {\n            return -1;\n        }\n    };\n    /**\n     * Gets the bookmarks.\n     * @private\n     */\n    LayoutViewer.prototype.getBookmarks = function (includeHidden) {\n        var bookmarks = [];\n        for (var i = 0; i < this.bookmarks.keys.length; i++) {\n            var bookmark = this.bookmarks.keys[i];\n            if (includeHidden || bookmark.indexOf('_') !== 0) {\n                bookmarks.push(bookmark);\n            }\n        }\n        return bookmarks;\n    };\n    /**\n     * Initializes components.\n     * @private\n     */\n    LayoutViewer.prototype.initializeComponents = function () {\n        var element = this.owner.element;\n        if (isNullOrUndefined(element)) {\n            return;\n        }\n        var viewer = this;\n        this.optionsPaneContainer = createElement('div', {\n            className: 'e-documenteditor-optionspane'\n        });\n        element.appendChild(this.optionsPaneContainer);\n        this.viewerContainer = createElement('div', { id: this.owner.containerId + '_viewerContainer' });\n        this.viewerContainer.style.cssText = 'position:relative;backgroundColor:#FBFBFB;overflow:auto';\n        this.optionsPaneContainer.appendChild(this.viewerContainer);\n        this.viewerContainer.tabIndex = 0;\n        this.viewerContainer.style.outline = 'none';\n        this.pageContainer = createElement('div', { id: this.owner.containerId + '_pageContainer', className: 'e-de-background' });\n        this.viewerContainer.appendChild(this.pageContainer);\n        this.pageContainer.style.top = '0px';\n        this.pageContainer.style.left = '0px';\n        this.pageContainer.style.position = 'relative';\n        this.pageContainer.style.pointerEvents = 'none';\n        if (Browser.isDevice) {\n            this.createEditableDiv(element);\n        }\n        else {\n            this.createEditableIFrame();\n        }\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.initializeImageResizer();\n        }\n        this.updateViewerSizeInternal(element);\n        this.layout = new Layout(this);\n        this.textHelper = new TextHelper(this);\n        this.zoomModule = new Zoom(this);\n        // let locale: L10n = new L10n('documenteditor', this.owner.defaultLocale);\n        // locale.setLocale(this.owner.locale);\n        // setCulture(this.owner.locale);\n        this.initTouchEllipse();\n        this.wireEvent();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.createEditableDiv = function (element) {\n        this.editableDiv = document.createElement('div');\n        this.editableDiv.contentEditable = 'true';\n        this.editableDiv.style.position = 'fixed';\n        this.editableDiv.style.left = '-150em';\n        this.editableDiv.style.width = '100%';\n        this.editableDiv.style.height = '100%';\n        this.editableDiv.id = element.id + '_editableDiv';\n        document.body.appendChild(this.editableDiv);\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.createEditableIFrame = function () {\n        this.iframe = createElement('iframe', {\n            attrs: {\n                'scrolling': 'no', 'src': 'javascript:false',\n                'style': 'pointer-events:none;position:absolute;top:-10000px'\n            },\n            className: 'e-de-text-target'\n        });\n        var innerHtml = '<!DOCTYPE html>'\n            + '<html><head></head>'\n            + '<body spellcheck=\"false\"style=\"background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;\" >'\n            + '<div contenteditable=\"true\" style=\"background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;\"></div>'\n            + '</body>'\n            + '</html>';\n        this.viewerContainer.appendChild(this.iframe);\n        this.iframe.contentDocument.open();\n        this.iframe.contentDocument.write(innerHtml);\n        this.iframe.contentDocument.close();\n        this.editableDiv = this.iframe.contentDocument.body.children[0];\n    };\n    /**\n     * Wires events and methods.\n     */\n    LayoutViewer.prototype.wireEvent = function () {\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.initCaret();\n        }\n        this.editableDiv.addEventListener('paste', this.onPaste);\n        if (!Browser.isDevice) {\n            this.editableDiv.addEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.addEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.addEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.addEventListener('blur', this.onFocusOut);\n        this.editableDiv.addEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.addEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.addEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.addEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.addEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.addEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.addEventListener('keydown', this.onKeyDownInternal);\n        this.viewerContainer.addEventListener('mousemove', this.onMouseMoveInternal);\n        this.viewerContainer.addEventListener('contextmenu', this.onContextMenu);\n        this.viewerContainer.addEventListener('dblclick', this.onDoubleTap);\n        this.viewerContainer.addEventListener('mouseup', this.onMouseUpInternal);\n        window.addEventListener('resize', this.onWindowResize);\n        window.addEventListener('keyup', this.onKeyUpInternal);\n        window.addEventListener('mouseup', this.onImageResizer);\n        window.addEventListener('touchend', this.onImageResizer);\n        this.viewerContainer.addEventListener('touchstart', this.onTouchStartInternal);\n        this.viewerContainer.addEventListener('touchmove', this.onTouchMoveInternal);\n        this.viewerContainer.addEventListener('touchend', this.onTouchUpInternal);\n        if (navigator.userAgent.match('Firefox')) {\n            this.viewerContainer.addEventListener('DOMMouseScroll', this.zoomModule.onMouseWheelInternal);\n        }\n        this.viewerContainer.addEventListener('mousewheel', this.zoomModule.onMouseWheelInternal);\n    };\n    LayoutViewer.prototype.getEditableDivTextContent = function () {\n        return this.editableDiv.textContent;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.positionEditableTarget = function () {\n        var point = this.selection.getRect(this.selection.start);\n        var page = this.selection.getSelectionPage(this.selection.start);\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.start);\n        var sectionFormat = page.bodyWidgets[0].sectionFormat;\n        var left = page.boundingRectangle.x + (HelperMethods.convertPointToPixel(sectionFormat.leftMargin) * this.zoomFactor);\n        var top = point.y;\n        var pageWidth = sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin;\n        var iframeStyle = 'left:' + left + 'px;';\n        iframeStyle += 'top:' + top + 'px;';\n        iframeStyle += 'width:' + (HelperMethods.convertPointToPixel(pageWidth) * this.zoomFactor) + 'px;';\n        iframeStyle += 'height:250px;outline-style:none;position:absolute';\n        this.iframe.setAttribute('style', iframeStyle);\n        var style = 'background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;';\n        style += 'text-indent:' + (point.x - left) + 'px;';\n        style += 'color:transparent;pointer-events:none;outline-style:none;';\n        style += 'font-size:' + (HelperMethods.convertPointToPixel(this.selection.characterFormat.fontSize) * this.zoomFactor) + 'px;';\n        style += 'font-family' + this.selection.characterFormat.fontFamily + ';';\n        style += 'overflow:hidden;text-decoration:none;white-space:normal;';\n        this.editableDiv.setAttribute('style', style);\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog = function () {\n        if (!this.dialogInternal) {\n            this.dialogTarget = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(this.dialogTarget);\n            this.dialogInternal = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'center' }, zIndex: 20\n            });\n            this.dialogInternal.open = this.selection.hideCaret;\n            this.dialogInternal.beforeClose = this.updateFocus;\n            this.dialogInternal.appendTo(this.dialogTarget);\n        }\n    };\n    /**\n     * Initializes dialog template.\n     */\n    LayoutViewer.prototype.initDialog2 = function () {\n        if (!this.dialogInternal2) {\n            var target = createElement('div', { className: 'e-de-dlg-target' });\n            document.body.appendChild(target);\n            this.dialogInternal2 = new Dialog({\n                target: document.body, showCloseIcon: true,\n                allowDragging: true, visible: false, width: '1px', isModal: true, position: { X: 'center', Y: 'Top' }, zIndex: 10\n            });\n            this.dialogInternal2.appendTo(target);\n        }\n    };\n    /**\n     * Clears the context.\n     * @private\n     */\n    LayoutViewer.prototype.clearContent = function () {\n        this.containerContext.clearRect(0, 0, this.containerCanvas.width, this.containerCanvas.height);\n        this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n    };\n    /**\n     * Fired when the document gets changed.\n     * @param {WordDocument} document\n     */\n    LayoutViewer.prototype.onDocumentChanged = function (sections) {\n        this.clearContent();\n        if (this.owner.editorModule) {\n            this.owner.editorModule.tocStyles = {};\n            this.owner.editorModule.tocBookmarkId = 0;\n        }\n        this.heightInfoCollection = {};\n        this.owner.isDocumentLoaded = false;\n        for (var i = 0; i < this.pages.length; i++) {\n            this.pages[i].bodyWidgets[0].destroy();\n        }\n        this.pages = [];\n        if (!isNullOrUndefined(this.renderedLists)) {\n            this.renderedLists.clear();\n        }\n        if (!isNullOrUndefined(this.owner.editorHistory)) {\n            this.owner.editorHistory.destroy();\n        }\n        this.owner.isDocumentLoaded = true;\n        this.layout.isInitialLoad = true;\n        this.layout.layoutItems(sections);\n        if (this.owner.selection) {\n            this.owner.selection.selectRange(this.owner.documentStart, this.owner.documentStart);\n        }\n        if (this.owner.optionsPaneModule) {\n            this.owner.optionsPaneModule.showHideOptionsPane(false);\n        }\n        this.owner.fireDocumentChange();\n    };\n    /**\n     * Initialize touch ellipse.\n     */\n    LayoutViewer.prototype.initTouchEllipse = function () {\n        var style = 'height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5';\n        // tslint:disable-next-line:max-line-length\n        var ellipse = ' height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;';\n        this.touchStart = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        var start = createElement('div', { styles: ellipse });\n        this.touchEnd = createElement('div', { className: 'e-touch-ellipse', styles: style });\n        this.touchStart.style.display = 'none';\n        var end = createElement('div', { styles: ellipse });\n        this.touchStart.appendChild(start);\n        this.touchEnd.appendChild(end);\n        this.touchEnd.style.display = 'none';\n        this.viewerContainer.appendChild(this.touchStart);\n        this.viewerContainer.appendChild(this.touchEnd);\n    };\n    /**\n     * Updates touch mark position.\n     * @private\n     */\n    LayoutViewer.prototype.updateTouchMarkPosition = function () {\n        if (this.touchStart.style.display !== 'none' && !isNullOrUndefined(this.selection)) {\n            if (!this.selection.isEmpty) {\n                var y = this.selection.getCaretBottom(this.selection.start, false);\n                var page = this.selection.getPage(this.selection.start.paragraph);\n                var viewer = this;\n                // tslint:disable-next-line:max-line-length\n                var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.pages.indexOf(page) + 1)) * this.zoomFactor + viewer.pageGap * (this.pages.indexOf(page) + 1);\n                // tslint:disable-next-line:max-line-length\n                this.touchStart.style.left = page.boundingRectangle.x + (Math.round(this.selection.start.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchStart.style.top = pageTop + ((y) * this.zoomFactor) + 'px';\n                if (!this.selection.isEmpty) {\n                    y = this.selection.getCaretBottom(this.selection.end, false);\n                    page = this.selection.getPage(this.selection.end.paragraph);\n                }\n                // tslint:disable-next-line:max-line-length\n                this.touchEnd.style.left = page.boundingRectangle.x + (Math.round(this.selection.end.location.x) * this.zoomFactor - 14) + 'px';\n                this.touchEnd.style.top = pageTop + (y * this.zoomFactor) + 'px';\n            }\n            else {\n                this.selection.updateCaretPosition();\n            }\n        }\n    };\n    LayoutViewer.prototype.isSelectionInListText = function (cursorPoint) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget) && widget.children[0] instanceof ListTextElementBox) {\n            var left = this.getLeftValue(widget);\n            var width = widget.children[0].width;\n            var height = widget.children[0].height;\n            if (this.isInsideRect(left, widget.paragraph.y, width, height, cursorPoint)) {\n                this.selectionLineWidget = widget;\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Check whether touch point is inside the rectangle or not.\n     * @param x\n     * @param y\n     * @param width\n     * @param height\n     * @param touchPoint\n     * @private\n     */\n    LayoutViewer.prototype.isInsideRect = function (x, y, width, height, touchPoint) {\n        if ((touchPoint.x > x && touchPoint.x <= x + width) && (touchPoint.y > y && touchPoint.y <= y + height)) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.getLeftValue = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.selection.isParagraphFirstLine(widget)) {\n            if (paragraphFormat.textAlignment === 'Right') {\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n                left -= HelperMethods.convertPointToPixel(paragraphFormat.leftIndent);\n            }\n            else {\n                left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n            }\n        }\n        var element = widget.children[0];\n        if (element instanceof ListTextElementBox) {\n            left += element.margin.left;\n        }\n        return left;\n    };\n    /**\n     * Checks whether left mouse button is pressed or not.\n     */\n    LayoutViewer.prototype.isLeftButtonPressed = function (event) {\n        this.isTouchInput = false;\n        var button = event.which || event.button;\n        return button === 1;\n    };\n    /**\n     * Gets touch offset value.\n     */\n    LayoutViewer.prototype.getTouchOffsetValue = function (event) {\n        var targetElement = this.viewerContainer;\n        var offset = targetElement.getBoundingClientRect();\n        var touchOffsetValues = event.touches[0];\n        if (isNullOrUndefined(touchOffsetValues)) {\n            touchOffsetValues = event.changedTouches[0];\n        }\n        var offsetX = touchOffsetValues.pageX - offset.left;\n        var offsetY = touchOffsetValues.pageY - offset.top;\n        return new Point(offsetX, offsetY);\n    };\n    /**\n     * Fired on pinch zoom in.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchInInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor - 0.01;\n        if (updatedZoomFactor < 5 && updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor - 0.01;\n        }\n        if (updatedZoomFactor < 0.1) {\n            updatedZoomFactor = 0.1;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Fired on pinch zoom out.\n     * @param {TouchEvent} event\n     */\n    LayoutViewer.prototype.onPinchOutInternal = function (event) {\n        this.preZoomFactor = this.zoomFactor;\n        var updatedZoomFactor = this.zoomFactor + 0.01;\n        if (updatedZoomFactor > 2) {\n            updatedZoomFactor = updatedZoomFactor + 0.01;\n        }\n        if (updatedZoomFactor > 5) {\n            updatedZoomFactor = 5;\n        }\n        this.zoomFactor = updatedZoomFactor;\n    };\n    /**\n     * Gets page width.\n     * @private\n     */\n    LayoutViewer.prototype.getPageWidth = function (page) {\n        var width = page.boundingRectangle.width;\n        return width;\n    };\n    /**\n     * Removes specified page.\n     * @private\n     */\n    LayoutViewer.prototype.removePage = function (page) {\n        if (this.currentPage === page) {\n            this.currentPage = undefined;\n        }\n        var index = this.pages.indexOf(page);\n        // if (index > -1) {\n        this.pages.splice(index, 1);\n        // }        \n        //this.removeRenderedPages();\n        var viewer = this;\n        if (!isNullOrUndefined(viewer.visiblePages)) {\n            if ((viewer.visiblePages).indexOf(page) > -1) {\n                var pageIndex = (viewer.visiblePages).indexOf(page);\n                (viewer.visiblePages).splice(pageIndex, 1);\n            }\n        }\n        //(viewer as PageLayoutViewer).visiblePages.remove(page);\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        //Updates the vertical height.\n        height -= page.boundingRectangle.height + 20;\n        //ToDo:Update horizontal width, if removed page has max width.\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        if (index !== -1) {\n            for (var i = index; i < this.pages.length; i++) {\n                //Update bounding rectangle of next pages in collection.\n                page = this.pages[i];\n                // tslint:disable-next-line:max-line-length\n                page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n                top = page.boundingRectangle.bottom + 20;\n                page.repeatHeaderRowTableWidget = false;\n            }\n        }\n    };\n    // private removeRenderedPages(): void {\n    //     for (let i: number = 0; i < this.pages.length; i++) {\n    //         this.clearContainer(this.pages[i]);\n    //     }\n    // }\n    /**\n     * Updates viewer size on window resize.\n     * @private\n     */\n    LayoutViewer.prototype.updateViewerSize = function () {\n        var viewer = this;\n        var element = this.owner.getDocumentEditorElement();\n        viewer.updateViewerSizeInternal(element);\n        viewer.updateScrollBars();\n        if (!isNullOrUndefined(this.selection)) {\n            this.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Updates viewer size.\n     */\n    LayoutViewer.prototype.updateViewerSizeInternal = function (element) {\n        if (!isNullOrUndefined(element)) {\n            var rect = element.getBoundingClientRect();\n            var width = 0;\n            var height = 0;\n            height = rect.height > 0 ? rect.height : 200;\n            if (this.owner.optionsPaneModule && this.owner.optionsPaneModule.isOptionsPaneShow) {\n                var optionsRect = this.owner.optionsPaneModule.optionsPane.getBoundingClientRect();\n                width = (rect.width - optionsRect.width) > 0 ? (rect.width - optionsRect.width) : 200;\n            }\n            else {\n                width = rect.width > 0 ? rect.width : 200;\n            }\n            this.viewerContainer.style.height = height.toString() + 'px';\n            this.viewerContainer.style.width = Math.ceil(width) + 'px';\n            this.visibleBoundsIn = new Rect(0, 0, width, height);\n            this.containerCanvas.width = width;\n            this.containerCanvas.height = height;\n            this.selectionCanvas.width = width;\n            this.selectionCanvas.height = height;\n        }\n    };\n    /**\n     * Updates client area for block.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForBlock = function (block, beforeLayout, tableCollection) {\n        var leftIndent = HelperMethods.convertPointToPixel(block.leftIndent);\n        var rightIndent = HelperMethods.convertPointToPixel(block.rightIndent);\n        if (beforeLayout) {\n            if (block instanceof TableWidget && tableCollection) {\n                var tableWidget = tableCollection[0];\n                this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n                this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n                //Updates the location of last item.\n                tableWidget = tableCollection[tableCollection.length - 1];\n                tableWidget.x = this.clientActiveArea.x;\n                tableWidget.y = this.clientActiveArea.y;\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                if (block instanceof TableWidget && !isNullOrUndefined(block.tableFormat) && block.tableFormat.tableAlignment !== 'Left') {\n                    if (!block.isGridUpdated) {\n                        block.buildTableColumns();\n                        block.isGridUpdated = true;\n                    }\n                    var tableWidth = block.getMaxRowWidth(block.getTableClientWidth(block.getOwnerWidth(false)));\n                    // Fore resizing table, the tableholder table width taken for updated width. \n                    // Since, the columns will be cleared if we performed resizing.\n                    if (this.owner.editor && this.owner.editor.tableResize.currentResizingTable === block\n                        && this.owner.editor.tableResize.resizerPosition === 0) {\n                        tableWidth = block.tableHolder.tableWidth;\n                    }\n                    tableWidth = HelperMethods.convertPointToPixel(tableWidth);\n                    if (block.tableFormat.tableAlignment === 'Center') {\n                        leftIndent = (this.clientArea.width - tableWidth) / 2;\n                    }\n                    else {\n                        leftIndent = this.clientArea.width - tableWidth;\n                    }\n                    this.tableLefts.push(leftIndent);\n                }\n                this.clientActiveArea.x = this.clientArea.x = this.clientArea.x + leftIndent;\n                var width = this.clientArea.width - (leftIndent + rightIndent);\n                this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n                // tslint:disable-next-line:max-line-length\n                this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n                // tslint:disable-next-line:max-line-length\n                this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n            }\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (block instanceof TableWidget && block.tableFormat.tableAlignment !== 'Left' && this.tableLefts.length > 0) {\n                leftIndent = this.tableLefts.pop();\n            }\n            this.clientActiveArea.x = this.clientArea.x = this.clientArea.x - leftIndent;\n            var width = this.clientArea.width + leftIndent + rightIndent;\n            this.clientActiveArea.width = this.clientArea.width = width > 0 ? width : 0;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client active area left.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromLeft = function (x) {\n        if (x < this.clientActiveArea.x) {\n            x = this.clientActiveArea.x;\n        }\n        if (x > this.clientActiveArea.right && this.textWrap) {\n            x = this.clientActiveArea.right;\n        }\n        this.clientActiveArea.width = this.clientActiveArea.right > x ? this.clientActiveArea.right - x : 0;\n        this.clientActiveArea.x = x;\n    };\n    /**\n     * Updates client active area top.\n     * @private\n     */\n    LayoutViewer.prototype.cutFromTop = function (y) {\n        if (y < this.clientActiveArea.y) {\n            y = this.clientActiveArea.y;\n        }\n        if (y > this.clientActiveArea.bottom) {\n            y = this.clientActiveArea.bottom;\n        }\n        this.clientActiveArea.height = this.clientActiveArea.bottom - y;\n        this.clientActiveArea.x = this.clientArea.x;\n        this.clientActiveArea.width = this.clientArea.width;\n        this.clientActiveArea.y = y;\n    };\n    /**\n     * Updates client width.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientWidth = function (width) {\n        this.clientActiveArea.x -= width;\n        if (this.clientActiveArea.width + width > 0) {\n            this.clientActiveArea.width += width;\n        }\n        else {\n            this.clientActiveArea.width = 0;\n        }\n    };\n    /**\n     * Inserts page in specified index.\n     * @private\n     */\n    LayoutViewer.prototype.insertPage = function (index, page) {\n        if (this.pages.indexOf(page) > -1) {\n            this.pages.splice(this.pages.indexOf(page), 1);\n        }\n        this.pages.splice(index, 0, page);\n        var top = 20;\n        if (index > 0) {\n            top += this.pages[index - 1].boundingRectangle.bottom;\n        }\n        for (var i = index; i < this.pages.length; i++) {\n            //Update bounding rectangle of next pages in collection.\n            page = this.pages[i];\n            page.boundingRectangle = new Rect(page.boundingRectangle.x, top, page.boundingRectangle.width, page.boundingRectangle.height);\n            top = page.boundingRectangle.bottom + 20;\n        }\n    };\n    /**\n     * Updates client area.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientArea = function (sectionFormat, page) {\n        var top = 0;\n        var headerDistance = 48;\n        var footerDistance = 48;\n        var pageHeight = HelperMethods.convertPointToPixel(sectionFormat.pageHeight);\n        var bottomMargin = HelperMethods.convertPointToPixel(sectionFormat.bottomMargin);\n        if (!isNullOrUndefined(sectionFormat)) {\n            top = HelperMethods.convertPointToPixel(sectionFormat.topMargin);\n            headerDistance = HelperMethods.convertPointToPixel(sectionFormat.headerDistance);\n            footerDistance = HelperMethods.convertPointToPixel(sectionFormat.footerDistance);\n        }\n        if (!isNullOrUndefined(page.headerWidget)) {\n            top = Math.min(Math.max(headerDistance + page.headerWidget.height, top), pageHeight / 100 * 40);\n        }\n        var bottom = 0.667 + bottomMargin;\n        if (!isNullOrUndefined(page.footerWidget)) {\n            bottom = 0.667 + Math.min(pageHeight / 100 * 40, Math.max(footerDistance + page.footerWidget.height, bottomMargin));\n        }\n        var width = 0;\n        var height = 0;\n        if (!isNullOrUndefined(sectionFormat)) {\n            width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n            height = pageHeight - top - bottom;\n        }\n        if (width < 0) {\n            width = 0;\n        }\n        this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), top, width, pageHeight - top - bottom);\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * Updates client area left or top position.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaTopOrLeft = function (tableWidget, beforeLayout) {\n        if (beforeLayout) {\n            this.clientActiveArea.y = this.clientActiveArea.y + tableWidget.topBorderWidth;\n            this.clientActiveArea.x = this.clientActiveArea.x + tableWidget.leftBorderWidth;\n        }\n    };\n    /**\n     * Updates client area for table.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForTable = function (tableWidget) {\n        this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n        this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n    };\n    /**\n     * Updates client area for row.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForRow = function (row, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var tableWidget = row.ownerTable;\n        if (beforeLayout) {\n            //tslint:disable:no-empty\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = tableWidget.x;\n            this.clientActiveArea.width = this.clientArea.width = tableWidget.width;\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates client area for cell.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaForCell = function (cell, beforeLayout) {\n        // tslint:disable-next-line:max-line-length\n        var rowWidget = cell.ownerRow;\n        var cellWidget = cell;\n        if (beforeLayout) {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x;\n            this.clientActiveArea.y = cellWidget.y;\n            this.clientActiveArea.width = this.clientArea.width = cellWidget.width > 0 ? cellWidget.width : 0;\n            if (this instanceof PageLayoutViewer) {\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n        else {\n            this.clientActiveArea.x = this.clientArea.x = cellWidget.x + cellWidget.width + cellWidget.margin.right;\n            if (rowWidget.x + rowWidget.width - this.clientArea.x < 0) {\n                this.clientActiveArea.width = this.clientArea.width = 0;\n            }\n            else {\n                this.clientActiveArea.width = this.clientArea.width = rowWidget.x + rowWidget.width - this.clientArea.x;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea.y = cellWidget.y - cellWidget.margin.top - HelperMethods.convertPointToPixel(cell.ownerTable.tableFormat.cellSpacing);\n            if (!cell.ownerTable.isInsideTable) {\n                this.clientActiveArea.height = this.clientArea.bottom - rowWidget.y > 0 ? this.clientArea.bottom - rowWidget.y : 0;\n            }\n            this.clientArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n            // tslint:disable-next-line:max-line-length\n            this.clientActiveArea = new Rect(this.clientActiveArea.x, this.clientActiveArea.y, this.clientActiveArea.width, this.clientActiveArea.height);\n        }\n    };\n    /**\n     * Updates the client area based on widget.\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaByWidget = function (widget) {\n        this.clientArea.x = widget.x;\n        this.clientArea.y = widget.y;\n        this.clientActiveArea.x = widget.x;\n        this.clientActiveArea.y = widget.y;\n    };\n    //Widget\n    /**\n     * Updates client area location.\n     * @param widget\n     * @param area\n     * @private\n     */\n    LayoutViewer.prototype.updateClientAreaLocation = function (widget, area) {\n        widget.x = area.x;\n        widget.y = area.y;\n        widget.width = area.width;\n    };\n    /**\n     * Updates text position for selection.\n     * @param cursorPoint\n     * @param tapCount\n     * @param clearMultiSelection\n     * @private\n     */\n    LayoutViewer.prototype.updateTextPositionForSelection = function (cursorPoint, tapCount) {\n        var widget = this.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            this.selection.updateTextPosition(widget, cursorPoint);\n        }\n        if (tapCount > 1) {\n            this.isMouseDown = false;\n            this.useTouchSelectionMark = false;\n            if (this.pages.length === 0) {\n                return;\n            }\n            //Double tap/triple tap selection\n            if (!isNullOrUndefined(this.currentPage) && !isNullOrUndefined(this.owner.selection.start)) {\n                if (tapCount % 2 === 0) {\n                    this.owner.selection.selectCurrentWord();\n                }\n                else {\n                    this.owner.selection.selectCurrentParagraph();\n                }\n            }\n        }\n    };\n    /**\n     * Scrolls to specified position.\n     * @param startPosition\n     * @param endPosition\n     * @private\n     */\n    LayoutViewer.prototype.scrollToPosition = function (startPosition, endPosition) {\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizing\n            || this.isMouseDownInFooterRegion || this.isRowOrCellResizing) {\n            return;\n        }\n        var lineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, true);\n        if (isNullOrUndefined(lineWidget)) {\n            return;\n        }\n        var top = this.selection.getTop(lineWidget);\n        if (this.isMouseDown) {\n            var prevLineWidget = this.selection.getLineWidgetInternal(endPosition.currentWidget, endPosition.offset, false);\n            var prevTop = this.selection.getTop(prevLineWidget);\n            if (prevLineWidget !== lineWidget && endPosition.location.y >= prevTop) {\n                lineWidget = prevLineWidget;\n            }\n        }\n        var height = lineWidget.height;\n        //Gets current page.\n        var endPage = this.selection.getPage(lineWidget.paragraph);\n        this.currentPage = endPage;\n        var x = 0;\n        var y = 0;\n        var viewer = this;\n        var horizontalWidth = 0;\n        var isPageLayout = viewer instanceof PageLayoutViewer;\n        if (isPageLayout) {\n            var pageLayout = viewer;\n            if (isNullOrUndefined(endPage)) {\n                return;\n            }\n            var pageWidth = endPage.boundingRectangle.width;\n            x = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * this.zoomFactor + (this.pages.indexOf(endPage) + 1) * viewer.pageGap * (1 - this.zoomFactor);\n        }\n        var scrollTop = this.containerTop;\n        var scrollLeft = this.containerLeft;\n        var pageHeight = this.visibleBounds.height;\n        var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n        var topMargin = caretInfo.topMargin;\n        var caretHeight = caretInfo.height;\n        x += (endPosition.location.x) * this.zoomFactor;\n        y += (endPosition.location.y + topMargin) * this.zoomFactor;\n        //vertical scroll bar update\n        if ((scrollTop + 20) > y) {\n            this.viewerContainer.scrollTop = (y - 10);\n        }\n        else if (scrollTop + pageHeight < y + caretHeight) {\n            this.viewerContainer.scrollTop = y + caretHeight - pageHeight + 10;\n        }\n        else {\n            this.selection.updateCaretToPage(startPosition, endPage);\n        }\n        this.selection.updateCaretToPage(startPosition, endPage);\n        var scrollBarWidth = this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        if (scrollLeft > x) {\n            this.viewerContainer.scrollLeft = x - (viewer.pageContainer.offsetWidth / 100) * 20;\n        }\n        else if (scrollLeft + this.visibleBounds.width < x + scrollBarWidth) {\n            this.viewerContainer.scrollLeft = scrollLeft + (viewer.pageContainer.offsetWidth / 100) * 15 + scrollBarWidth;\n        }\n    };\n    /**\n     * Gets line widget using cursor point.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidget = function (cursorPoint) {\n        return this.getLineWidgetInternal(cursorPoint, false);\n    };\n    /**\n     * Gets line widget.\n     * @private\n     */\n    LayoutViewer.prototype.getLineWidgetInternal = function (cursorPoint, isMouseDragged) {\n        var widget = undefined;\n        if (!isNullOrUndefined(this.currentPage)) {\n            var childWidgets = void 0;\n            if (this.owner.enableHeaderAndFooter) {\n                var page = this.currentPage;\n                var pageTop = this.selection.getPageTop(page);\n                var pageBottom = page.boundingRectangle.height;\n                var headerHeight = Math.max((page.headerWidget.y + page.headerWidget.height), HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin)) * this.zoomFactor;\n                var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n                var footerHeight = (page.boundingRectangle.height -\n                    Math.max(page.footerWidget.height + footerDistance, footerDistance * 2));\n                if (isMouseDragged) {\n                    if (this.isBlockInHeader(this.selection.start.paragraph)) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                    else {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                }\n                else {\n                    if (cursorPoint.y <= pageBottom && cursorPoint.y >= footerHeight) {\n                        childWidgets = this.currentPage.footerWidget;\n                    }\n                    else if ((cursorPoint.y) >= 0 && (cursorPoint.y) <= headerHeight) {\n                        childWidgets = this.currentPage.headerWidget;\n                    }\n                }\n                if (isNullOrUndefined(childWidgets)) {\n                    return undefined;\n                }\n                return this.selection.getLineWidgetBodyWidget(childWidgets, cursorPoint);\n            }\n            else {\n                for (var i = 0; i < this.currentPage.bodyWidgets.length; i++) {\n                    var bodyWidgets = this.currentPage.bodyWidgets[i];\n                    widget = this.selection.getLineWidgetBodyWidget(bodyWidgets, cursorPoint);\n                    if (!isNullOrUndefined(widget)) {\n                        break;\n                    }\n                }\n            }\n        }\n        return widget;\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.isBlockInHeader = function (block) {\n        while (!(block.containerWidget instanceof HeaderFooterWidget)) {\n            if (!block.containerWidget) {\n                return false;\n            }\n            block = block.containerWidget;\n        }\n        return block.containerWidget.headerFooterType.indexOf('Header') !== -1;\n    };\n    /**\n     * Clears selection highlight.\n     * @private\n     */\n    LayoutViewer.prototype.clearSelectionHighlight = function () {\n        var canClear = true;\n        canClear = (!this.isControlPressed || !this.isMouseDown);\n        // if (this.owner.selection.selectionRanges.length > 0 && canClear) {\n        if (this.owner.selection.clearSelectionHighlightInSelectedWidgets()) {\n            this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        }\n        // } else if (!isNullOrUndefined(this.owner.selection.currentSelectionRange) && this.isMouseDown) {\n        //     this.owner.selection.currentSelectionRange.clearSelectionHighlight();\n        // }\n        //this.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.removeEmptyPages = function () {\n        var scrollToLastPage = false;\n        var viewer = this;\n        for (var j = 0; j < this.pages.length; j++) {\n            var page = this.pages[j];\n            if (page.bodyWidgets.length === 0 || page.bodyWidgets[0].childWidgets.length === 0) {\n                // tslint:disable-next-line:max-line-length\n                if (j === this.pages.length - 1 && viewer instanceof PageLayoutViewer && viewer.visiblePages.indexOf(this.pages[j]) !== -1) {\n                    scrollToLastPage = true;\n                }\n                this.removePage(this.pages[j]);\n                j--;\n            }\n        }\n        if (scrollToLastPage) {\n            this.scrollToBottom();\n        }\n    };\n    /**\n     * @private\n     */\n    LayoutViewer.prototype.scrollToBottom = function () {\n        if (this.selection.start.paragraph && this.selection.start.paragraph.bodyWidget) {\n            var page = this.selection.start.paragraph.bodyWidget.page;\n            var containerHeight = this.visibleBounds.height;\n            this.viewerContainer.scrollTop = page.boundingRectangle.bottom - containerHeight;\n        }\n    };\n    /**\n     * Returns the field code result.\n     * @private\n     */\n    LayoutViewer.prototype.getFieldResult = function (fieldBegin, page) {\n        if (!isNullOrUndefined(page) && !isNullOrUndefined(this.selection)) {\n            var fieldCode = this.selection.getFieldCode(fieldBegin);\n            var fieldCodes = fieldCode.split('\\*');\n            if (fieldCodes.length > 1) {\n                var fieldCategory = fieldCodes[0].replace(/[^\\w\\s]/gi, '').trim().toLowerCase();\n                var fieldPattern = fieldCodes[1].replace(/[^\\w\\s]/gi, '').trim();\n                switch (fieldCategory) {\n                    case 'page':\n                        return this.getFieldText(fieldPattern, (page.index + 1));\n                    case 'numpages':\n                        return this.getFieldText(fieldPattern, page.viewer.pages.length);\n                    default:\n                        break;\n                }\n            }\n        }\n        return '';\n    };\n    /**\n     * Returns field text.\n     */\n    LayoutViewer.prototype.getFieldText = function (pattern, value) {\n        switch (pattern) {\n            case 'ALPHABETIC':\n                return this.layout.getAsLetter(value).toUpperCase();\n            case 'alphabetic':\n                return this.layout.getAsLetter(value).toLowerCase();\n            case 'roman':\n                return this.layout.getAsRoman(value).toLowerCase();\n            case 'ROMAN':\n                return this.layout.getAsRoman(value).toUpperCase();\n            default:\n                return value.toString();\n        }\n    };\n    /**\n     * Destroys the internal objects maintained for control.\n     */\n    LayoutViewer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.owner)) {\n            this.unWireEvent();\n        }\n        this.pages = [];\n        this.pages = undefined;\n        this.fieldStacks = [];\n        this.fieldStacks = undefined;\n        this.splittedCellWidgets = [];\n        this.splittedCellWidgets = undefined;\n        this.fields = [];\n        this.fields = undefined;\n        if (this.layout) {\n            this.layout.destroy();\n        }\n        this.layout = undefined;\n        if (!isNullOrUndefined(this.render)) {\n            this.render.destroy();\n        }\n        this.render = undefined;\n        if (this.dialogInternal) {\n            this.dialogInternal.destroy();\n        }\n        this.dialogInternal = undefined;\n        if (this.dialogTarget && this.dialogTarget.parentElement) {\n            this.dialogTarget.parentElement.removeChild(this.dialogTarget);\n        }\n        this.dialogTarget = undefined;\n        if (!isNullOrUndefined(this.touchStart)) {\n            this.touchStart.innerHTML = '';\n        }\n        if (this.textHelper) {\n            this.textHelper.destroy();\n        }\n        this.textHelper = undefined;\n        this.touchStart = undefined;\n        if (!isNullOrUndefined(this.touchEnd)) {\n            this.touchEnd.innerHTML = '';\n        }\n        this.touchEnd = undefined;\n        if (!isNullOrUndefined(this.containerCanvasIn)) {\n            this.containerCanvasIn.innerHTML = '';\n        }\n        this.containerCanvasIn = undefined;\n        if (!isNullOrUndefined(this.selectionCanvasIn)) {\n            this.selectionCanvasIn.innerHTML = '';\n        }\n        this.selectionCanvasIn = undefined;\n        if (!isNullOrUndefined(this.editableDiv)) {\n            this.editableDiv.innerHTML = '';\n            this.editableDiv.parentElement.removeChild(this.editableDiv);\n        }\n        this.editableDiv = undefined;\n        if (!isNullOrUndefined(this.pageContainer)) {\n            this.pageContainer.innerHTML = '';\n        }\n        this.pageContainer = undefined;\n        if (!isNullOrUndefined(this.viewerContainer)) {\n            this.viewerContainer.innerHTML = '';\n        }\n        this.viewerContainer = undefined;\n        this.owner = undefined;\n        this.heightInfoCollection = undefined;\n    };\n    /**\n     * Un-Wires events and methods\n     */\n    LayoutViewer.prototype.unWireEvent = function () {\n        this.viewerContainer.removeEventListener('scroll', this.scrollHandler);\n        this.viewerContainer.removeEventListener('mousedown', this.onMouseDownInternal);\n        this.viewerContainer.removeEventListener('mousemove', this.onMouseMoveInternal);\n        if (!Browser.isDevice) {\n            this.editableDiv.removeEventListener('keypress', this.onKeyPressInternal);\n            if (Browser.info.name === 'chrome') {\n                this.editableDiv.removeEventListener('textInput', this.onTextInput);\n            }\n        }\n        else {\n            this.editableDiv.removeEventListener('input', this.onTextInputInternal);\n        }\n        this.editableDiv.removeEventListener('paste', this.onPaste);\n        this.viewerContainer.removeEventListener('contextmenu', this.onContextMenu);\n        this.editableDiv.removeEventListener('blur', this.onFocusOut);\n        this.editableDiv.removeEventListener('keydown', this.onKeyDownInternal);\n        this.editableDiv.removeEventListener('compositionstart', this.compositionStart);\n        this.editableDiv.removeEventListener('compositionupdate', this.compositionUpdated);\n        this.editableDiv.removeEventListener('compositionend', this.compositionEnd);\n        this.viewerContainer.removeEventListener('mouseup', this.onMouseUpInternal);\n        this.viewerContainer.removeEventListener('dblclick', this.onDoubleTap);\n        window.removeEventListener('resize', this.onWindowResize);\n        window.removeEventListener('keyup', this.onKeyUpInternal);\n        window.removeEventListener('mouseup', this.onImageResizer);\n        window.removeEventListener('touchend', this.onImageResizer);\n    };\n    return LayoutViewer;\n}());\nexport { LayoutViewer };\n/**\n * @private\n */\nvar PageLayoutViewer = /** @class */ (function (_super) {\n    __extends(PageLayoutViewer, _super);\n    /**\n     * Initialize the constructor of PageLayoutViewer\n     */\n    function PageLayoutViewer(owner) {\n        var _this = _super.call(this, owner) || this;\n        _this.pageLeft = 30;\n        /**\n         * @private\n         */\n        _this.pageGap = 20;\n        /**\n         * @private\n         */\n        _this.visiblePages = [];\n        if (isNullOrUndefined(owner) || isNullOrUndefined(owner.element)) {\n            return _this;\n        }\n        return _this;\n    }\n    /**\n     * Creates new page.\n     * @private\n     */\n    PageLayoutViewer.prototype.createNewPage = function (section, index) {\n        var viewer = this;\n        var yPos = this.pageGap;\n        if (this.pages.length > 0) {\n            yPos = this.pages[this.pages.length - 1].boundingRectangle.bottom + this.pageGap;\n        }\n        var page = new Page();\n        page.viewer = this;\n        // tslint:disable-next-line:max-line-length\n        var pageWidth = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth) : 816;\n        // tslint:disable-next-line:max-line-length\n        var pageHeight = !isNullOrUndefined(section.sectionFormat) ? HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight) : 1056;\n        var xPos = (this.visibleBounds.width - pageWidth * this.zoomFactor) / 2;\n        if (xPos < this.pageLeft) {\n            xPos = this.pageLeft;\n        }\n        page.boundingRectangle = new Rect(xPos, yPos, pageWidth, pageHeight);\n        if (isNullOrUndefined(index)) {\n            this.pages.push(page);\n        }\n        else {\n            this.pages.splice(index, 0, page);\n        }\n        this.updateClientArea(section.sectionFormat, page);\n        page.bodyWidgets.push(section);\n        page.bodyWidgets[page.bodyWidgets.length - 1].page = page;\n        this.layout.layoutHeaderFooter(section, viewer, page);\n        this.updateClientArea(section.sectionFormat, page);\n        return page;\n    };\n    /**\n     * Updates cursor.\n     */\n    PageLayoutViewer.prototype.updateCursor = function (event) {\n        var hyperlinkField = undefined;\n        var div = this.viewerContainer;\n        var point = new Point(event.offsetX, event.offsetY);\n        var touchPoint = this.findFocusedPage(point, true);\n        var widget = this.getLineWidget(touchPoint);\n        var widgetInfo;\n        var left;\n        var top;\n        var editor = !this.owner.isReadOnlyMode ? this.owner.editorModule : undefined;\n        var isRowResize = editor ? editor.tableResize.isInRowResizerArea(touchPoint) : false;\n        var isCellResize = editor ? editor.tableResize.isInCellResizerArea(touchPoint) : false;\n        var resizePosition = '';\n        if (this.owner.enableImageResizerMode) {\n            var resizeObj = this.owner.imageResizerModule.getImagePoint(touchPoint);\n            this.owner.imageResizerModule.selectedResizeElement = resizeObj.selectedElement;\n            resizePosition = resizeObj.resizePosition;\n        }\n        var lineLeft = 0;\n        if (!isNullOrUndefined(widget)) {\n            lineLeft = this.selection.getLineStartLeft(widget);\n            hyperlinkField = this.selection.getHyperLinkFieldInCurrentSelection(widget, touchPoint);\n            widgetInfo = this.selection.updateTextPositionIn(widget, undefined, 0, touchPoint, true);\n            left = this.selection.getLeft(widget);\n            top = this.selection.getTop(widget);\n            this.selection.setHyperlinkContentToToolTip(hyperlinkField, widget, touchPoint.x);\n        }\n        if (!isNullOrUndefined(hyperlinkField) && (event.ctrlKey &&\n            this.owner.useCtrlClickToFollowHyperlink || !this.owner.useCtrlClickToFollowHyperlink)) {\n            div.style.cursor = 'pointer';\n            return;\n        }\n        else if (touchPoint.x >= lineLeft &&\n            event.offsetX < (this.visibleBounds.width - (this.visibleBounds.width - this.viewerContainer.clientWidth)) &&\n            event.offsetY < (this.visibleBounds.height - (this.visibleBounds.height - this.viewerContainer.clientHeight))) {\n            if (this.selection.isEmpty) {\n                div.style.cursor = 'text';\n            }\n            else {\n                div.style.cursor = this.selection.checkCursorIsInSelection(widget, touchPoint) ? 'default' : 'text';\n            }\n        }\n        else {\n            div.style.cursor = 'default';\n        }\n        if (!isNullOrUndefined(resizePosition) && resizePosition !== '') {\n            div.style.cursor = resizePosition;\n        }\n        else if (!isNullOrUndefined(widgetInfo) && widgetInfo.isImageSelected && left < touchPoint.x && top < touchPoint.y &&\n            left + widget.width > touchPoint.x && top + widget.height > touchPoint.y) {\n            div.style.cursor = 'move';\n        }\n        if (isRowResize) {\n            div.style.cursor = 'row-resize';\n        }\n        else if (isCellResize) {\n            div.style.cursor = 'col-resize';\n        }\n    };\n    /**\n     * Finds focused page.\n     * @private\n     */\n    PageLayoutViewer.prototype.findFocusedPage = function (currentPoint, updateCurrentPage) {\n        var point = new Point(currentPoint.x, currentPoint.y);\n        point.x += this.viewerContainer.scrollLeft;\n        point.y += this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var pageTop = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageHeight = (page.boundingRectangle.height * this.zoomFactor) + this.pageGap;\n            var pageLeft = page.boundingRectangle.x;\n            var pageRight = ((page.boundingRectangle.right - pageLeft) * this.zoomFactor) + pageLeft;\n            if (pageTop <= point.y && pageTop + pageHeight >= point.y) {\n                if (updateCurrentPage) {\n                    this.currentPage = page;\n                }\n                point.y = (point.y - (pageTop)) / this.zoomFactor;\n                if (point.x > pageRight) {\n                    point.x = page.boundingRectangle.right;\n                }\n                else if (point.x < pageLeft) {\n                    point.x = 0;\n                }\n                else {\n                    point.x = (point.x - pageLeft) / this.zoomFactor;\n                }\n                return point;\n            }\n        }\n        return point;\n    };\n    /**\n     * Fired when page fit type changed.\n     * @private\n     */\n    PageLayoutViewer.prototype.onPageFitTypeChanged = function (pageFitType) {\n        var width = this.visibleBounds.width;\n        var height = this.visibleBounds.height;\n        var section = this.visiblePages[0].bodyWidgets[0];\n        var pageWidth = HelperMethods.convertPointToPixel(section.sectionFormat.pageWidth);\n        var pageHeight = HelperMethods.convertPointToPixel(section.sectionFormat.pageHeight);\n        switch (pageFitType) {\n            case 'FitOnePage':\n                if (height > 0 && pageHeight > 0) {\n                    var zoomFactor = (this.visibleBounds.height - 2 * this.pageGap - (this.pageGap - 2)) / pageHeight;\n                    if (zoomFactor === this.zoomFactor) {\n                        if (!isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(this.owner.selection.start) &&\n                            !isNullOrUndefined(this.owner.selection.end)) {\n                            this.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n                        }\n                    }\n                    else {\n                        this.zoomFactor = zoomFactor;\n                    }\n                }\n                break;\n            case 'FitPageWidth':\n                if (width > 0 && pageWidth > 0) {\n                    this.zoomFactor = (this.visibleBounds.width - 80) / pageWidth;\n                }\n                break;\n            default:\n                this.zoomFactor = 100 / 100;\n                break;\n        }\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.handleZoom = function () {\n        var prevScaleFactor = this.preZoomFactor;\n        var page = null;\n        var verticalHeight = 0;\n        var scrollToPosition = false;\n        if (this.selection && isNullOrUndefined(this.zoomX && isNullOrUndefined(this.zoomY))) {\n            var x = 0;\n            var y = 0;\n            var endPage = this.selection.getPage(this.selection.end.currentWidget.paragraph);\n            x = (this.visibleBounds.width - endPage.boundingRectangle.width * prevScaleFactor) / 2;\n            if (x < 30) {\n                x = 30;\n            }\n            // tslint:disable-next-line:max-line-length\n            y = endPage.boundingRectangle.y * prevScaleFactor + (this.pages.indexOf(endPage) + 1) * this.pageGap * (1 - prevScaleFactor);\n            var caretInfo = this.selection.updateCaretSize(this.owner.selection.end, true);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            x += (this.selection.end.location.x) * prevScaleFactor;\n            y += (this.selection.end.location.y + topMargin) * prevScaleFactor;\n            if (x >= this.containerLeft && x <= this.visibleBounds.width &&\n                y >= this.containerTop && y <= this.containerTop + this.visibleBounds.height) {\n                scrollToPosition = true;\n            }\n        }\n        for (var i = 0; i < this.pages.length; i++) {\n            verticalHeight = verticalHeight + this.pages[i].boundingRectangle.height;\n        }\n        var horizontalWidth = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (horizontalWidth < this.pages[i].boundingRectangle.width) {\n                horizontalWidth = this.pages[i].boundingRectangle.width;\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (verticalHeight * this.zoomFactor + (this.pages.length + 1) * this.pageGap * (1 - this.zoomFactor)) - this.visibleBounds.height;\n        var horWidth = horizontalWidth * this.zoomFactor - this.visibleBounds.width;\n        if (this.visibleBounds.width - horizontalWidth * this.zoomFactor < 60) {\n            horWidth += 60;\n        }\n        //Update Vertical Scroll bar\n        if (height > 0) {\n            var value = this.containerTop;\n            if (this.visiblePages.length > 0) {\n                page = this.visiblePages[0];\n                // tslint:disable-next-line:max-line-length\n                var prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                var zoomY = this.zoomY;\n                if (isNullOrUndefined) {\n                    zoomY = this.visibleBounds.height / 2;\n                }\n                var prevY = value + zoomY;\n                while (prevY > prevPageTop + (page.boundingRectangle.height * prevScaleFactor)) {\n                    var pageIndex = page.index + 1;\n                    if (pageIndex === this.pages.length) {\n                        break;\n                    }\n                    page = this.pages[pageIndex];\n                    // tslint:disable-next-line:max-line-length\n                    prevPageTop = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * prevScaleFactor + (page.index + 1) * this.pageGap;\n                }\n                // tslint:disable-next-line:max-line-length\n                var currentY = (page.boundingRectangle.y - (page.index + 1) * this.pageGap) * this.zoomFactor + (page.index + 1) * this.pageGap\n                    + ((prevY - prevPageTop) < 0 ? prevY - prevPageTop : (prevY - prevPageTop) * (this.zoomFactor / prevScaleFactor));\n                value = currentY - zoomY;\n                zoomY = this.visibleBounds.height / 2;\n            }\n            this.viewerContainer.scrollTop = value;\n        }\n        else {\n            this.viewerContainer.scrollTop = 0;\n        }\n        // update Horizontal Scroll Bar\n        if (horWidth > 0) {\n            var value = this.containerLeft;\n            if (this.visiblePages.length > 0) {\n                if (page === null) {\n                    page = this.visiblePages[0];\n                }\n                var zoomX = this.zoomX;\n                if (isNullOrUndefined(zoomX)) {\n                    zoomX = this.visibleBounds.width / 2;\n                }\n                var prevValue = (page.boundingRectangle.width * prevScaleFactor) / page.boundingRectangle.width;\n                var prevX = value + zoomX;\n                // tslint:disable-next-line:max-line-length\n                var currentX = page.boundingRectangle.x\n                    + ((prevX - page.boundingRectangle.x) < 0 ? prevX - page.boundingRectangle.x : (prevX - page.boundingRectangle.x) * (this.zoomFactor / prevValue));\n                value = currentX - zoomX;\n                zoomX = this.visibleBounds.width / 2;\n            }\n            this.viewerContainer.scrollLeft = value;\n        }\n        else {\n            this.viewerContainer.scrollLeft = 0;\n        }\n        this.updateScrollBars();\n        if (scrollToPosition) {\n            this.scrollToPosition(this.selection.start, this.selection.end);\n        }\n    };\n    /**\n     * Gets current page header footer.\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentPageHeaderFooter = function (section, isHeader) {\n        return this.getCurrentHeaderFooter(this.getHeaderFooterType(section, isHeader), section.index);\n    };\n    /**\n     * Get header footer type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooterType = function (section, isHeader) {\n        var type;\n        type = isHeader ? 'OddHeader' : 'OddFooter';\n        // tslint:disable-next-line:max-line-length\n        if (section.sectionFormat.differentFirstPage && (this.pages.length === 1 || this.pages[this.pages.length - 1].bodyWidgets[0].index !== section.index)) {\n            type = isHeader ? 'FirstPageHeader' : 'FirstPageFooter';\n        }\n        else if (section.sectionFormat.differentOddAndEvenPages && this.pages.length % 2 === 0) {\n            type = isHeader ? 'EvenHeader' : 'EvenFooter';\n        }\n        return type;\n    };\n    /**\n     * Gets current header footer.\n     * @param type\n     * @param section\n     * @private\n     */\n    PageLayoutViewer.prototype.getCurrentHeaderFooter = function (type, sectionIndex) {\n        if (this.headersFooters[sectionIndex]) {\n            var index = this.getHeaderFooter(type);\n            var headerFooter = this.headersFooters[sectionIndex][index];\n            if (!headerFooter) {\n                headerFooter = this.createHeaderFooterWidget(type);\n                this.headersFooters[sectionIndex][index] = headerFooter;\n            }\n            return headerFooter;\n        }\n        else if (sectionIndex > 0) {\n            return this.getCurrentHeaderFooter(type, sectionIndex - 1);\n        }\n        return undefined;\n    };\n    PageLayoutViewer.prototype.createHeaderFooterWidget = function (type) {\n        var headerFooter = new HeaderFooterWidget(type);\n        var paragraph = new ParagraphWidget();\n        paragraph.childWidgets.push(new LineWidget(paragraph));\n        return headerFooter;\n    };\n    /**\n     * Gets header footer.\n     * @param type\n     * @private\n     */\n    PageLayoutViewer.prototype.getHeaderFooter = function (type) {\n        switch (type) {\n            case 'OddHeader':\n                return 0;\n            case 'OddFooter':\n                return 1;\n            case 'EvenHeader':\n                return 2;\n            case 'EvenFooter':\n                return 3;\n            case 'FirstPageHeader':\n                return 4;\n            case 'FirstPageFooter':\n                return 5;\n        }\n    };\n    /**\n     * Updates header footer client area.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHFClientArea = function (sectionFormat, isHeader) {\n        // tslint:disable-next-line:max-line-length\n        var width = HelperMethods.convertPointToPixel(sectionFormat.pageWidth - sectionFormat.leftMargin - sectionFormat.rightMargin);\n        if (width < 0) {\n            width = 0;\n        }\n        if (isHeader) {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.headerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.clientArea = new Rect(HelperMethods.convertPointToPixel(sectionFormat.leftMargin), HelperMethods.convertPointToPixel(sectionFormat.pageHeight - sectionFormat.footerDistance), width, Number.POSITIVE_INFINITY);\n        }\n        this.clientActiveArea = new Rect(this.clientArea.x, this.clientArea.y, this.clientArea.width, this.clientArea.height);\n    };\n    /**\n     * @private\n     */\n    PageLayoutViewer.prototype.updateHCFClientAreaWithTop = function (sectionFormat, isHeader, page) {\n        this.updateHFClientArea(sectionFormat, isHeader);\n        if (!isHeader) {\n            if (page.footerWidget.y < this.clientActiveArea.y) {\n                this.clientActiveArea.y = page.footerWidget.y;\n                this.clientActiveArea.height = Number.POSITIVE_INFINITY;\n            }\n        }\n    };\n    /**\n     * Scrolls to the specified page\n     * @private\n     */\n    PageLayoutViewer.prototype.scrollToPage = function (pageIndex) {\n        var top = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            top = this.pages[i].boundingRectangle.y - (this.pageGap / 2);\n            if (i === pageIndex) {\n                break;\n            }\n        }\n        this.viewerContainer.scrollTop = top;\n        this.updateScrollBars();\n    };\n    /**\n     * Updates scroll bars.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateScrollBars = function () {\n        var height = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            height = height + this.pages[i].boundingRectangle.height;\n        }\n        var width = 0;\n        for (var i = 0; i < this.pages.length; i++) {\n            if (width < this.pages[i].boundingRectangle.width) {\n                width = this.pages[i].boundingRectangle.width;\n            }\n        }\n        var containerWidth = (width * this.zoomFactor) + (this.pageLeft * 2);\n        var containerHeight = (height * this.zoomFactor) + (this.pages.length + 1) * this.pageGap;\n        var viewerWidth = this.visibleBounds.width;\n        var viewerHeight = this.visibleBounds.height;\n        if (this.visibleBounds.width !== this.viewerContainer.clientWidth) {\n            viewerWidth -= (this.visibleBounds.width - this.viewerContainer.clientWidth);\n        }\n        else if (containerHeight > viewerHeight) {\n            viewerWidth -= this.viewerContainer.offsetWidth - this.viewerContainer.clientWidth;\n        }\n        if (containerWidth > viewerWidth) {\n            viewerHeight -= (this.visibleBounds.height - this.viewerContainer.clientHeight);\n        }\n        width = containerWidth > viewerWidth ? containerWidth : viewerWidth;\n        height = containerHeight > viewerHeight ? containerHeight : viewerHeight;\n        if (parseInt(this.pageContainer.style.width.replace('px', ''), 10) !== width ||\n            parseInt(this.pageContainer.style.height.replace('px', ''), 10) !== width) {\n            this.pageContainer.style.width = width.toString() + 'px';\n            this.pageContainer.style.height = height.toString() + 'px';\n        }\n        // if (!isNullOrUndefined(this.selection) && !this.selection.isEmpty) {\n        //     this.selectionContext.clearRect(0, 0, this.selectionCanvas.width, this.selectionCanvas.height);\n        // }\n        var displayPixelRatio = Math.max(1, window.devicePixelRatio || 1);\n        if (this.containerCanvas.width !== Math.floor(viewerWidth * displayPixelRatio)\n            || this.containerCanvas.height !== Math.floor(viewerHeight * displayPixelRatio)) {\n            this.containerCanvas.width = viewerWidth * displayPixelRatio;\n            this.containerCanvas.height = viewerHeight * displayPixelRatio;\n            this.containerCanvas.style.width = viewerWidth + 'px';\n            this.containerCanvas.style.height = viewerHeight + 'px';\n            this.containerContext.scale(displayPixelRatio, displayPixelRatio);\n            this.selectionCanvas.width = viewerWidth * displayPixelRatio;\n            this.selectionCanvas.height = viewerHeight * displayPixelRatio;\n            this.selectionCanvas.style.width = viewerWidth + 'px';\n            this.selectionCanvas.style.height = viewerHeight + 'px';\n            this.selectionContext.scale(displayPixelRatio, displayPixelRatio);\n        }\n        this.containerContext.globalAlpha = 1;\n        this.selectionContext.globalAlpha = 0.4;\n        for (var i = 0; i < this.pages.length; i++) {\n            var left = (width - this.pages[i].boundingRectangle.width * this.zoomFactor) / 2;\n            if (left > this.pageLeft) {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(left, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                this.pages[i].boundingRectangle = new Rect(this.pageLeft, this.pages[i].boundingRectangle.y, this.pages[i].boundingRectangle.width, this.pages[i].boundingRectangle.height);\n            }\n        }\n        this.updateScrollBarPosition(containerWidth, containerHeight, viewerWidth, viewerHeight, width, height);\n    };\n    // tslint:disable-next-line:max-line-length\n    PageLayoutViewer.prototype.updateScrollBarPosition = function (containerWidth, containerHeight, viewerWidth, viewerHeight, width, height) {\n        var left = 0;\n        var viewerHeight1 = parseFloat(this.viewerContainer.style.height);\n        var containerHeight1 = parseFloat(this.pageContainer.style.height);\n        this.containerTop = this.viewerContainer.scrollTop;\n        this.containerCanvas.style.position = 'absolute';\n        this.containerCanvas.style.top = this.containerTop.toString() + 'px';\n        this.selectionCanvas.style.position = 'absolute';\n        this.selectionCanvas.style.top = this.containerTop.toString() + 'px';\n        this.containerLeft = this.viewerContainer.scrollLeft;\n        this.containerCanvas.style.left = this.containerLeft + 'px';\n        this.selectionCanvas.style.left = this.containerLeft + 'px';\n        this.updateVisiblePages();\n    };\n    /**\n     * Updates visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.updateVisiblePages = function () {\n        var left = 0;\n        var width = 0;\n        // Clears the container first.\n        this.visiblePages = [];\n        var height = this.visibleBounds.height;\n        var vertical = this.viewerContainer.scrollTop;\n        for (var i = 0; i < this.pages.length; i++) {\n            var page = this.pages[i];\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            var pageH = page.boundingRectangle.height * this.zoomFactor;\n            var left_1 = page.boundingRectangle.x;\n            var isTopFit = y >= vertical && y <= vertical + height;\n            var isBottomFit = y + pageH >= vertical && y + pageH <= vertical + height;\n            var isMiddleFit = y <= vertical && y + pageH >= vertical + height;\n            //UI Virtualization\n            if (isTopFit || isBottomFit || isMiddleFit) {\n                this.addVisiblePage(page, left_1, y);\n            }\n        }\n    };\n    /**\n     * Adds visible pages.\n     */\n    PageLayoutViewer.prototype.addVisiblePage = function (page, x, y) {\n        var width = page.boundingRectangle.width * this.zoomFactor;\n        var height = page.boundingRectangle.height * this.zoomFactor;\n        // tslint:disable-next-line:max-line-length\n        if (this.owner.enableImageResizerMode && this.owner.imageResizerModule.currentPage !== undefined && this.owner.imageResizerModule.currentPage === page && this.owner.imageResizerModule.isImageResizerVisible) {\n            this.owner.imageResizerModule.setImageResizerPositions(x, y, width, height);\n        }\n        this.visiblePages.push(page);\n        this.renderPage(page, x, y, width, height);\n    };\n    /**\n     * Render specified page widgets.\n     */\n    PageLayoutViewer.prototype.renderPage = function (page, x, y, width, height) {\n        this.render.renderWidgets(page, x - this.containerLeft, y - this.containerTop, width, height);\n    };\n    /**\n     * Renders visible pages.\n     * @private\n     */\n    PageLayoutViewer.prototype.renderVisiblePages = function () {\n        if (isNullOrUndefined(this.visiblePages) || this.visiblePages.length < 1) {\n            return;\n        }\n        this.clearContent();\n        for (var i = 0; i < this.visiblePages.length; i++) {\n            var page = this.visiblePages[i];\n            var width = page.boundingRectangle.width * this.zoomFactor;\n            var height = page.boundingRectangle.height * this.zoomFactor;\n            var x = page.boundingRectangle.x;\n            var y = (page.boundingRectangle.y - this.pageGap * (i + 1)) * this.zoomFactor + this.pageGap * (i + 1);\n            this.renderPage(page, x, y, width, height);\n        }\n    };\n    return PageLayoutViewer;\n}(LayoutViewer));\nexport { PageLayoutViewer };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WListLevel } from '../list/list-level';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { WCharacterFormat, WListFormat, WParagraphFormat, WCellFormat, WTableFormat, WSectionFormat, WRowFormat } from '../format/index';\nimport { WCharacterStyle, WParagraphStyle, WTabStop } from '../format/index';\nimport { LineWidget, ParagraphWidget, ImageElementBox, BodyWidget, TextElementBox, TableCellWidget, TableRowWidget, TableWidget, FieldElementBox, HeaderFooterWidget, BookmarkElementBox, FieldTextElementBox, TabElementBox } from './page';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar SfdtReader = /** @class */ (function () {\n    function SfdtReader(viewer) {\n        /* tslint:disable:no-any */\n        this.viewer = undefined;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SfdtReader.prototype, \"isPasting\", {\n        get: function () {\n            return this.viewer && this.viewer.owner.isPastingContent;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     * @param json\n     */\n    SfdtReader.prototype.convertJsonToDocument = function (json) {\n        var sections = [];\n        var jsonObject = JSON.parse(json);\n        this.parseCharacterFormat(jsonObject.characterFormat, this.viewer.characterFormat);\n        this.parseParagraphFormat(jsonObject.paragraphFormat, this.viewer.paragraphFormat);\n        if (!isNullOrUndefined(jsonObject.background)) {\n            this.viewer.backgroundColor = this.getColor(jsonObject.background.color);\n        }\n        if (!isNullOrUndefined(jsonObject.abstractLists)) {\n            this.parseAbstractList(jsonObject, this.viewer.abstractLists);\n        }\n        if (!isNullOrUndefined(jsonObject.lists)) {\n            this.parseList(jsonObject, this.viewer.lists);\n        }\n        if (!isNullOrUndefined(jsonObject.styles)) {\n            this.parseStyles(jsonObject, this.viewer.styles);\n        }\n        if (!isNullOrUndefined(jsonObject.sections)) {\n            this.parseSections(jsonObject.sections, sections);\n        }\n        return sections;\n    };\n    SfdtReader.prototype.parseStyles = function (data, styles) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (isNullOrUndefined(this.viewer.styles.findByName(data.styles[i].name))) {\n                this.parseStyle(data, data.styles[i], styles);\n            }\n        }\n    };\n    SfdtReader.prototype.parseStyle = function (data, style, styles) {\n        var wStyle;\n        if (!isNullOrUndefined(style.type)) {\n            if (style.type === 'Paragraph') {\n                wStyle = new WParagraphStyle();\n                wStyle.type = 'Paragraph';\n            }\n            if (style.type === 'Character') {\n                wStyle = new WCharacterStyle();\n                wStyle.type = 'Character';\n            }\n            if (!isNullOrUndefined(style.name)) {\n                wStyle.name = style.name;\n            }\n            styles.push(wStyle);\n            if (!isNullOrUndefined(style.basedOn)) {\n                var basedOn = styles.findByName(style.basedOn);\n                if (!isNullOrUndefined(basedOn)) {\n                    if (basedOn.type === wStyle.type) {\n                        wStyle.basedOn = basedOn;\n                    }\n                }\n                else {\n                    var basedStyle = this.getStyle(style.basedOn, data);\n                    var styleString = void 0;\n                    if (!isNullOrUndefined(basedStyle) && basedStyle.type === wStyle.type) {\n                        styleString = basedStyle;\n                    }\n                    else {\n                        if (wStyle.type === 'Paragraph') {\n                            styleString = JSON.parse('{\"type\":\"Paragraph\",\"name\":\"Normal\",\"next\":\"Normal\"}');\n                        }\n                        else {\n                            styleString = JSON.parse('{\"type\": \"Character\",\"name\": \"Default Paragraph Font\"}');\n                        }\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.basedOn = styles.findByName(styleString.name);\n                }\n            }\n            if (!isNullOrUndefined(style.link)) {\n                var link = styles.findByName(style.link);\n                var linkStyle = this.getStyle(style.link, data);\n                var styleString = void 0;\n                if (isNullOrUndefined(link)) {\n                    if (isNullOrUndefined(linkStyle)) {\n                        //Construct the CharacterStyle string\n                        var charaStyle = {};\n                        charaStyle.characterFormat = style.characterFormat;\n                        charaStyle.name = style.name + ' Char';\n                        charaStyle.type = 'Character';\n                        //TODO: Implement basedOn\n                        charaStyle.basedOn = style.basedOn === 'Normal' ? 'Default Paragraph Font' : (style.basedOn + ' Char');\n                        styleString = charaStyle;\n                    }\n                    else {\n                        styleString = linkStyle;\n                    }\n                    this.parseStyle(data, styleString, styles);\n                    wStyle.link = isNullOrUndefined(styles.findByName(styleString.name)) ? style.link : styles.findByName(styleString.name);\n                }\n                else {\n                    wStyle.link = link;\n                }\n            }\n            if (!isNullOrUndefined(style.characterFormat)) {\n                this.parseCharacterFormat(style.characterFormat, wStyle.characterFormat);\n            }\n            if (!isNullOrUndefined(style.paragraphFormat)) {\n                this.parseParagraphFormat(style.paragraphFormat, wStyle.paragraphFormat);\n            }\n            if (!isNullOrUndefined(style.next)) {\n                if (style.next === style.name) {\n                    wStyle.next = wStyle;\n                }\n                else {\n                    var next = styles.findByName(style.next);\n                    if (!isNullOrUndefined(next) && next.type === wStyle.type) {\n                        wStyle.next = next;\n                    }\n                    else {\n                        var nextStyleString = this.getStyle(style.next, data);\n                        if (!isNullOrUndefined(nextStyleString)) {\n                            this.parseStyle(data, nextStyleString, styles);\n                            wStyle.next = styles.findByName(nextStyleString.name);\n                        }\n                        else {\n                            wStyle.next = wStyle;\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.getStyle = function (name, data) {\n        for (var i = 0; i < data.styles.length; i++) {\n            if (data.styles[i].name === name) {\n                return data.styles[i];\n            }\n        }\n        return undefined;\n    };\n    SfdtReader.prototype.parseAbstractList = function (data, abstractLists) {\n        for (var i = 0; i < data.abstractLists.length; i++) {\n            var abstractList = new WAbstractList();\n            var abstract = data.abstractLists[i];\n            abstractLists.push(abstractList);\n            if (!isNullOrUndefined(abstract)) {\n                if (!isNullOrUndefined(abstract.abstractListId)) {\n                    abstractList.abstractListId = abstract.abstractListId;\n                }\n                if (!isNullOrUndefined(abstract.levels)) {\n                    for (var j = 0; j < abstract.levels.length; j++) {\n                        var level = abstract.levels[j];\n                        if (!isNullOrUndefined(level)) {\n                            var listLevel = this.parseListLevel(level, abstractList);\n                            abstractList.levels.push(listLevel);\n                        }\n                    }\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseListLevel = function (data, owner) {\n        var listLevel = new WListLevel(owner);\n        if (data.listLevelPattern === 'Bullet') {\n            listLevel.listLevelPattern = 'Bullet';\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n        }\n        else {\n            listLevel.listLevelPattern = data.listLevelPattern;\n            listLevel.startAt = data.startAt;\n            listLevel.numberFormat = !isNullOrUndefined(data.numberFormat) ? data.numberFormat : '';\n            if (data.restartLevel >= 0) {\n                listLevel.restartLevel = data.restartLevel;\n            }\n            else {\n                listLevel.restartLevel = data.levelNumber;\n            }\n        }\n        listLevel.followCharacter = data.followCharacter;\n        this.parseCharacterFormat(data.characterFormat, listLevel.characterFormat);\n        this.parseParagraphFormat(data.paragraphFormat, listLevel.paragraphFormat);\n        return listLevel;\n    };\n    SfdtReader.prototype.parseList = function (data, listCollection) {\n        for (var i = 0; i < data.lists.length; i++) {\n            var list = new WList();\n            var lists = data.lists[i];\n            if (!isNullOrUndefined(lists.abstractListId)) {\n                list.abstractListId = lists.abstractListId;\n                list.abstractList = this.viewer.getAbstractListById(lists.abstractListId);\n            }\n            listCollection.push(list);\n            if (!isNullOrUndefined(lists.listId)) {\n                list.listId = lists.listId;\n            }\n            if (lists.hasOwnProperty('levelOverrides')) {\n                this.parseLevelOverride(lists.levelOverrides, list);\n            }\n        }\n    };\n    SfdtReader.prototype.parseLevelOverride = function (data, list) {\n        if (isNullOrUndefined(data)) {\n            return;\n        }\n        for (var i = 0; i < data.length; i++) {\n            var levelOverrides = new WLevelOverride();\n            var levelOverride = data[i];\n            levelOverrides.startAt = levelOverride.startAt;\n            levelOverrides.levelNumber = levelOverride.levelNumber;\n            if (!isNullOrUndefined(levelOverride.overrideListLevel)) {\n                levelOverrides.overrideListLevel = this.parseListLevel(levelOverride.overrideListLevel, levelOverrides);\n            }\n            list.levelOverrides.push(levelOverrides);\n        }\n    };\n    SfdtReader.prototype.parseSections = function (data, sections) {\n        for (var i = 0; i < data.length; i++) {\n            var section = new BodyWidget();\n            section.sectionFormat = new WSectionFormat(section);\n            section.index = i;\n            var item = data[i];\n            if (!isNullOrUndefined(item.sectionFormat)) {\n                this.parseSectionFormat(item.sectionFormat, section.sectionFormat);\n            }\n            if (isNullOrUndefined(item.headersFooters)) {\n                item.headersFooters = {};\n            }\n            this.viewer.headersFooters.push(this.parseHeaderFooter(item.headersFooters, this.viewer.headersFooters));\n            this.parseTextBody(item.blocks, section);\n            for (var i_1 = 0; i_1 < section.childWidgets.length; i_1++) {\n                section.childWidgets[i_1].containerWidget = section;\n            }\n            sections.push(section);\n        }\n    };\n    /**\n     * @private\n     */\n    SfdtReader.prototype.parseHeaderFooter = function (data, headersFooters) {\n        var hfs = {};\n        if (!isNullOrUndefined(data.header)) {\n            var oddHeader = new HeaderFooterWidget('OddHeader');\n            hfs[0] = oddHeader;\n            this.parseTextBody(data.header.blocks, oddHeader);\n        }\n        if (!isNullOrUndefined(data.footer)) {\n            var oddFooter = new HeaderFooterWidget('OddFooter');\n            hfs[1] = oddFooter;\n            this.parseTextBody(data.footer.blocks, oddFooter);\n        }\n        if (!isNullOrUndefined(data.evenHeader)) {\n            var evenHeader = new HeaderFooterWidget('EvenHeader');\n            hfs[2] = evenHeader;\n            this.parseTextBody(data.evenHeader.blocks, evenHeader);\n        }\n        if (!isNullOrUndefined(data.evenFooter)) {\n            var evenFooter = new HeaderFooterWidget('EvenFooter');\n            hfs[3] = evenFooter;\n            this.parseTextBody(data.evenFooter.blocks, evenFooter);\n        }\n        if (!isNullOrUndefined(data.firstPageHeader)) {\n            var firstPageHeader = new HeaderFooterWidget('FirstPageHeader');\n            hfs[4] = firstPageHeader;\n            this.parseTextBody(data.firstPageHeader.blocks, firstPageHeader);\n        }\n        if (!isNullOrUndefined(data.firstPageFooter)) {\n            var firstPageFooter = new HeaderFooterWidget('FirstPageFooter');\n            hfs[5] = firstPageFooter;\n            this.parseTextBody(data.firstPageFooter.blocks, firstPageFooter);\n        }\n        return hfs;\n    };\n    SfdtReader.prototype.parseTextBody = function (data, section) {\n        this.parseBody(data, section.childWidgets, section);\n    };\n    SfdtReader.prototype.parseBody = function (data, blocks, container) {\n        if (!isNullOrUndefined(data)) {\n            for (var i = 0; i < data.length; i++) {\n                var block = data[i];\n                if (block.hasOwnProperty('inlines')) {\n                    var writeInlineFormat = false;\n                    //writeInlineFormat = this.isPasting && i === data.length - 1;\n                    var paragraph = new ParagraphWidget();\n                    paragraph.characterFormat = new WCharacterFormat(paragraph);\n                    paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n                    this.parseCharacterFormat(block.characterFormat, paragraph.characterFormat);\n                    this.parseParagraphFormat(block.paragraphFormat, paragraph.paragraphFormat);\n                    var styleObj = void 0;\n                    if (!isNullOrUndefined(block.paragraphFormat) && !isNullOrUndefined(block.paragraphFormat.styleName)) {\n                        styleObj = this.viewer.styles.findByName(block.paragraphFormat.styleName, 'Paragraph');\n                        if (!isNullOrUndefined(styleObj)) {\n                            paragraph.paragraphFormat.ApplyStyle(styleObj);\n                        }\n                    }\n                    if (block.inlines.length > 0) {\n                        this.parseParagraph(block.inlines, paragraph, writeInlineFormat);\n                    }\n                    blocks.push(paragraph);\n                    paragraph.index = i;\n                    paragraph.containerWidget = container;\n                }\n                else if (block.hasOwnProperty('rows')) {\n                    this.parseTable(block, blocks, i, container);\n                }\n            }\n        }\n    };\n    SfdtReader.prototype.parseTable = function (block, blocks, index, section) {\n        var table = new TableWidget();\n        table.index = index;\n        table.tableFormat = new WTableFormat(table);\n        if (!isNullOrUndefined(block.tableFormat)) {\n            this.parseTableFormat(block.tableFormat, table.tableFormat);\n        }\n        table.title = block.title;\n        table.description = block.description;\n        for (var i = 0; i < block.rows.length; i++) {\n            var row = new TableRowWidget();\n            row.rowFormat = new WRowFormat(row);\n            var tableRow = block.rows[i];\n            if (tableRow.hasOwnProperty('rowFormat')) {\n                this.parseRowFormat(tableRow.rowFormat, row.rowFormat);\n                this.parseRowGridValues(tableRow, row.rowFormat);\n                this.parseRowGridValues(tableRow.rowFormat, row.rowFormat);\n                row.index = i;\n                for (var j = 0; j < block.rows[i].cells.length; j++) {\n                    var cell = new TableCellWidget();\n                    cell.cellFormat = new WCellFormat(cell);\n                    row.childWidgets.push(cell);\n                    cell.containerWidget = row;\n                    cell.index = j;\n                    cell.rowIndex = i;\n                    if (block.rows[i].cells[j].hasOwnProperty('cellFormat')) {\n                        this.parseCellFormat(block.rows[i].cells[j].cellFormat, cell.cellFormat);\n                    }\n                    this.parseTextBody(block.rows[i].cells[j].blocks, cell);\n                }\n            }\n            table.childWidgets.push(row);\n            row.containerWidget = table;\n        }\n        table.containerWidget = section;\n        blocks.push(table);\n        table.isGridUpdated = false;\n    };\n    SfdtReader.prototype.parseRowGridValues = function (data, rowFormat) {\n        if (!isNullOrUndefined(data.gridBefore)) {\n            rowFormat.gridBefore = data.gridBefore;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidth)) {\n            rowFormat.gridBeforeWidth = data.gridBeforeWidth;\n        }\n        if (!isNullOrUndefined(data.gridBeforeWidthType)) {\n            rowFormat.gridBeforeWidthType = data.gridBeforeWidthType;\n        }\n        if (!isNullOrUndefined(data.gridAfter)) {\n            rowFormat.gridAfter = data.gridAfter;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidth)) {\n            rowFormat.gridAfterWidth = data.gridAfterWidth;\n        }\n        if (!isNullOrUndefined(data.gridAfterWidthType)) {\n            rowFormat.gridAfterWidthType = data.gridAfterWidthType;\n        }\n    };\n    SfdtReader.prototype.parseParagraph = function (data, paragraph, writeInlineFormat) {\n        var lineWidget = new LineWidget(paragraph);\n        for (var i = 0; i < data.length; i++) {\n            var inline = data[i];\n            if (inline.hasOwnProperty('text')) {\n                var textElement = undefined;\n                if (this.viewer.isPageField) {\n                    textElement = new FieldTextElementBox();\n                    textElement.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                }\n                else if (inline.text === '\\t') {\n                    textElement = new TabElementBox();\n                }\n                else {\n                    textElement = new TextElementBox();\n                }\n                textElement.characterFormat = new WCharacterFormat(textElement);\n                this.parseCharacterFormat(inline.characterFormat, textElement.characterFormat, writeInlineFormat);\n                /*ï¿½tslint:disable-next-line:max-line-length */\n                if (!isNullOrUndefined(inline.characterFormat) && !isNullOrUndefined(inline.characterFormat.styleName)) {\n                    var charStyle = this.viewer.styles.findByName(inline.characterFormat.styleName, 'Character');\n                    textElement.characterFormat.ApplyStyle(charStyle);\n                }\n                textElement.text = inline.text;\n                textElement.line = lineWidget;\n                lineWidget.children.push(textElement);\n            }\n            else if (inline.hasOwnProperty('imageString')) {\n                var image = new ImageElementBox(data[i].isInlineImage);\n                image.isMetaFile = data[i].isMetaFile;\n                image.characterFormat = new WCharacterFormat(image);\n                image.line = lineWidget;\n                lineWidget.children.push(image);\n                image.imageString = inline.imageString;\n                image.width = HelperMethods.convertPointToPixel(inline.width);\n                image.height = HelperMethods.convertPointToPixel(inline.height);\n                this.parseCharacterFormat(inline.characterFormat, image.characterFormat);\n            }\n            else if (inline.hasOwnProperty('hasFieldEnd') || (inline.hasOwnProperty('fieldType') && inline.fieldType === 0)) {\n                var fieldBegin = new FieldElementBox(0);\n                fieldBegin.hasFieldEnd = inline.hasFieldEnd;\n                this.viewer.fieldStacks.push(fieldBegin);\n                fieldBegin.line = lineWidget;\n                this.viewer.fields.push(fieldBegin);\n                lineWidget.children.push(fieldBegin);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                var field = undefined;\n                if (inline.fieldType === 2) {\n                    field = new FieldElementBox(2);\n                    this.fieldSeparator = field;\n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldSeparator = field;\n                        //finds the whether the field is page filed or not\n                        var lineWidgetCount = lineWidget.children.length;\n                        if (lineWidgetCount >= 2 && (lineWidget.children[lineWidgetCount - 2] instanceof FieldElementBox)\n                            && lineWidget.children[lineWidgetCount - 2].hasFieldEnd\n                            && (lineWidget.children[lineWidgetCount - 1] instanceof TextElementBox)) {\n                            var fieldElementText = lineWidget.children[lineWidgetCount - 1].text;\n                            if (fieldElementText.match('PAGE')) {\n                                this.viewer.isPageField = true;\n                            }\n                        }\n                    }\n                }\n                else if (inline.fieldType === 1) {\n                    field = new FieldElementBox(1);\n                    //For Field End Updated begin and separator.                                      \n                    if (this.viewer.fieldStacks.length > 0) {\n                        field.fieldBegin = this.viewer.fieldStacks[this.viewer.fieldStacks.length - 1];\n                        field.fieldBegin.fieldEnd = field;\n                    }\n                    if (!isNullOrUndefined(field.fieldBegin) && field.fieldBegin.fieldSeparator) {\n                        field.fieldSeparator = field.fieldBegin.fieldSeparator;\n                        field.fieldBegin.fieldSeparator.fieldEnd = field;\n                    }\n                    //After setting all the property clear the field values\n                    this.viewer.fieldStacks.splice(this.viewer.fieldStacks.length - 1, 1);\n                    this.fieldSeparator = undefined;\n                    this.viewer.isPageField = false;\n                    this.viewer.fieldCollection.push(field.fieldBegin);\n                }\n                field.line = lineWidget;\n                lineWidget.children.push(field);\n            }\n            else if (inline.hasOwnProperty('bookmarkType')) {\n                var bookmark = undefined;\n                bookmark = new BookmarkElementBox(inline.bookmarkType);\n                bookmark.name = inline.name;\n                lineWidget.children.push(bookmark);\n                bookmark.line = lineWidget;\n                if (inline.bookmarkType === 0) {\n                    this.viewer.bookmarks.add(bookmark.name, bookmark);\n                }\n                else if (inline.bookmarkType === 1) {\n                    if (this.viewer.bookmarks.containsKey(bookmark.name)) {\n                        var bookmarkStart = this.viewer.bookmarks.get(bookmark.name);\n                        bookmarkStart.reference = bookmark;\n                        bookmark.reference = bookmarkStart;\n                    }\n                }\n            }\n        }\n        paragraph.childWidgets.push(lineWidget);\n    };\n    SfdtReader.prototype.parseTableFormat = function (sourceFormat, tableFormat) {\n        this.parseBorders(sourceFormat.borders, tableFormat.borders);\n        if (!isNullOrUndefined(sourceFormat.cellSpacing)) {\n            tableFormat.cellSpacing = sourceFormat.cellSpacing;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            tableFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            tableFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            tableFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            tableFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n            tableFormat.leftIndent = sourceFormat.leftIndent;\n        }\n        this.parseShading(sourceFormat.shading, tableFormat.shading);\n        if (!isNullOrUndefined(sourceFormat.tableAlignment)) {\n            tableFormat.tableAlignment = sourceFormat.tableAlignment;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n            tableFormat.preferredWidth = sourceFormat.preferredWidth;\n        }\n        if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n            tableFormat.preferredWidthType = sourceFormat.preferredWidthType;\n        }\n    };\n    SfdtReader.prototype.parseCellFormat = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            this.parseBorders(sourceFormat.borders, cellFormat.borders);\n            if (!sourceFormat.isSamePaddingAsTable) {\n                //    cellFormat.ClearMargins();\n                //else\n                this.parseCellMargin(sourceFormat, cellFormat);\n            }\n            if (!isNullOrUndefined(sourceFormat.cellWidth)) {\n                cellFormat.cellWidth = sourceFormat.cellWidth;\n            }\n            if (!isNullOrUndefined(sourceFormat.columnSpan)) {\n                cellFormat.columnSpan = sourceFormat.columnSpan;\n            }\n            if (!isNullOrUndefined(sourceFormat.rowSpan)) {\n                cellFormat.rowSpan = sourceFormat.rowSpan;\n            }\n            this.parseShading(sourceFormat.shading, cellFormat.shading);\n            if (!isNullOrUndefined(sourceFormat.verticalAlignment)) {\n                cellFormat.verticalAlignment = sourceFormat.verticalAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidthType)) {\n                cellFormat.preferredWidthType = sourceFormat.preferredWidthType;\n            }\n            if (!isNullOrUndefined(sourceFormat.preferredWidth)) {\n                cellFormat.preferredWidth = sourceFormat.preferredWidth;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCellMargin = function (sourceFormat, cellFormat) {\n        if (!isNullOrUndefined(sourceFormat.leftMargin)) {\n            cellFormat.leftMargin = sourceFormat.leftMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.rightMargin)) {\n            cellFormat.rightMargin = sourceFormat.rightMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.topMargin)) {\n            cellFormat.topMargin = sourceFormat.topMargin;\n        }\n        if (!isNullOrUndefined(sourceFormat.bottomMargin)) {\n            cellFormat.bottomMargin = sourceFormat.bottomMargin;\n        }\n    };\n    SfdtReader.prototype.parseRowFormat = function (sourceFormat, rowFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.allowBreakAcrossPages)) {\n                rowFormat.allowBreakAcrossPages = sourceFormat.allowBreakAcrossPages;\n            }\n            if (!isNullOrUndefined(sourceFormat.isHeader)) {\n                rowFormat.isHeader = sourceFormat.isHeader;\n            }\n            if (!isNullOrUndefined(sourceFormat.heightType)) {\n                rowFormat.heightType = sourceFormat.heightType;\n            }\n            if (!isNullOrUndefined(sourceFormat.height)) {\n                rowFormat.height = sourceFormat.height;\n            }\n            this.parseBorders(sourceFormat.borders, rowFormat.borders);\n        }\n    };\n    SfdtReader.prototype.parseBorders = function (sourceBorders, destBorder) {\n        if (!isNullOrUndefined(sourceBorders)) {\n            this.parseBorder(sourceBorders.left, destBorder.left);\n            this.parseBorder(sourceBorders.right, destBorder.right);\n            this.parseBorder(sourceBorders.top, destBorder.top);\n            this.parseBorder(sourceBorders.bottom, destBorder.bottom);\n            this.parseBorder(sourceBorders.vertical, destBorder.vertical);\n            this.parseBorder(sourceBorders.horizontal, destBorder.horizontal);\n            this.parseBorder(sourceBorders.diagonalDown, destBorder.diagonalDown);\n            this.parseBorder(sourceBorders.diagonalUp, destBorder.diagonalUp);\n        }\n    };\n    SfdtReader.prototype.parseBorder = function (sourceBorder, destBorder) {\n        if (!isNullOrUndefined(sourceBorder)) {\n            if (!isNullOrUndefined(sourceBorder.color)) {\n                destBorder.color = this.getColor(sourceBorder.color);\n            }\n            if (!isNullOrUndefined(sourceBorder.lineStyle)) {\n                destBorder.lineStyle = sourceBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(sourceBorder.lineWidth)) {\n                destBorder.lineWidth = sourceBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(sourceBorder.hasNoneStyle)) {\n                destBorder.hasNoneStyle = sourceBorder.hasNoneStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseShading = function (sourceShading, destShading) {\n        if (!isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(sourceShading.backgroundColor)) {\n                destShading.backgroundColor = this.getColor(sourceShading.backgroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.foregroundColor)) {\n                destShading.foregroundColor = this.getColor(sourceShading.foregroundColor);\n            }\n            if (!isNullOrUndefined(sourceShading.texture) || !isNullOrUndefined(sourceShading.textureStyle)) {\n                destShading.textureStyle = !isNullOrUndefined(sourceShading.texture) ? sourceShading.texture : sourceShading.textureStyle;\n            }\n        }\n    };\n    SfdtReader.prototype.parseCharacterFormat = function (sourceFormat, characterFormat, writeInlineFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (writeInlineFormat && sourceFormat.hasOwnProperty('inlineFormat')) {\n                this.parseCharacterFormat(sourceFormat.inlineFormat, characterFormat);\n                return;\n            }\n            if (!isNullOrUndefined(sourceFormat.baselineAlignment)) {\n                characterFormat.baselineAlignment = sourceFormat.baselineAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.underline)) {\n                characterFormat.underline = sourceFormat.underline;\n            }\n            if (!isNullOrUndefined(sourceFormat.strikethrough)) {\n                characterFormat.strikethrough = sourceFormat.strikethrough;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontSize)) {\n                characterFormat.fontSize = sourceFormat.fontSize;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontFamily)) {\n                characterFormat.fontFamily = sourceFormat.fontFamily;\n            }\n            if (!isNullOrUndefined(sourceFormat.bold)) {\n                characterFormat.bold = sourceFormat.bold;\n            }\n            if (!isNullOrUndefined(sourceFormat.italic)) {\n                characterFormat.italic = sourceFormat.italic;\n            }\n            if (!isNullOrUndefined(sourceFormat.highlightColor)) {\n                characterFormat.highlightColor = sourceFormat.highlightColor;\n            }\n            if (!isNullOrUndefined(sourceFormat.fontColor)) {\n                characterFormat.fontColor = this.getColor(sourceFormat.fontColor);\n            }\n        }\n    };\n    SfdtReader.prototype.getColor = function (color) {\n        var convertColor = color;\n        return convertColor || '#ffffff';\n    };\n    SfdtReader.prototype.parseParagraphFormat = function (sourceFormat, paragraphFormat) {\n        if (!isNullOrUndefined(sourceFormat)) {\n            if (!isNullOrUndefined(sourceFormat.leftIndent)) {\n                paragraphFormat.leftIndent = sourceFormat.leftIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.rightIndent)) {\n                paragraphFormat.rightIndent = sourceFormat.rightIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.firstLineIndent)) {\n                paragraphFormat.firstLineIndent = sourceFormat.firstLineIndent;\n            }\n            if (!isNullOrUndefined(sourceFormat.afterSpacing)) {\n                paragraphFormat.afterSpacing = sourceFormat.afterSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.beforeSpacing)) {\n                paragraphFormat.beforeSpacing = sourceFormat.beforeSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacing)) {\n                paragraphFormat.lineSpacing = sourceFormat.lineSpacing;\n            }\n            if (!isNullOrUndefined(sourceFormat.lineSpacingType)) {\n                paragraphFormat.lineSpacingType = sourceFormat.lineSpacingType;\n            }\n            if (!isNullOrUndefined(sourceFormat.textAlignment)) {\n                paragraphFormat.textAlignment = sourceFormat.textAlignment;\n            }\n            if (!isNullOrUndefined(sourceFormat.outlineLevel)) {\n                paragraphFormat.outlineLevel = sourceFormat.outlineLevel;\n            }\n            paragraphFormat.listFormat = new WListFormat();\n            if (sourceFormat.hasOwnProperty('listFormat')) {\n                this.parseListFormat(sourceFormat, paragraphFormat.listFormat);\n            }\n            if (sourceFormat.hasOwnProperty('tabs')) {\n                this.parseTabStop(sourceFormat.tabs, paragraphFormat.tabs);\n            }\n        }\n    };\n    SfdtReader.prototype.parseListFormat = function (block, listFormat) {\n        if (!isNullOrUndefined(block.listFormat)) {\n            if (!isNullOrUndefined(block.listFormat.listId)) {\n                listFormat.listId = block.listFormat.listId;\n                listFormat.list = this.viewer.getListById(block.listFormat.listId);\n            }\n            if (!isNullOrUndefined(block.listFormat.listLevelNumber)) {\n                listFormat.listLevelNumber = block.listFormat.listLevelNumber;\n            }\n        }\n    };\n    SfdtReader.prototype.parseSectionFormat = function (data, sectionFormat) {\n        if (!isNullOrUndefined(data.pageWidth)) {\n            sectionFormat.pageWidth = data.pageWidth;\n        }\n        if (!isNullOrUndefined(data.pageHeight)) {\n            sectionFormat.pageHeight = data.pageHeight;\n        }\n        if (!isNullOrUndefined(data.leftMargin)) {\n            sectionFormat.leftMargin = data.leftMargin;\n        }\n        if (!isNullOrUndefined(data.topMargin)) {\n            sectionFormat.topMargin = data.topMargin;\n        }\n        if (!isNullOrUndefined(data.rightMargin)) {\n            sectionFormat.rightMargin = data.rightMargin;\n        }\n        if (!isNullOrUndefined(data.bottomMargin)) {\n            sectionFormat.bottomMargin = data.bottomMargin;\n        }\n        if (!isNullOrUndefined(data.headerDistance)) {\n            sectionFormat.headerDistance = data.headerDistance;\n        }\n        if (!isNullOrUndefined(data.footerDistance)) {\n            sectionFormat.footerDistance = data.footerDistance;\n        }\n        if (!isNullOrUndefined(data.differentFirstPage)) {\n            sectionFormat.differentFirstPage = data.differentFirstPage;\n        }\n        if (!isNullOrUndefined(data.differentOddAndEvenPages)) {\n            sectionFormat.differentOddAndEvenPages = data.differentOddAndEvenPages;\n        }\n    };\n    SfdtReader.prototype.parseTabStop = function (wTabs, tabs) {\n        for (var i = 0; i < wTabs.length; i++) {\n            var tabStop = new WTabStop();\n            tabStop.position = wTabs[i].position;\n            tabStop.tabLeader = wTabs[i].tabLeader;\n            tabStop.deletePosition = wTabs[i].deletePosition;\n            tabStop.tabJustification = wTabs[i].tabJustification;\n            tabs.push(tabStop);\n        }\n    };\n    return SfdtReader;\n}());\nexport { SfdtReader };\n","import { WShading } from '../format/index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\n/**\n * Selection character format implementation\n */\nvar SelectionCharacterFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCharacterFormat(selection) {\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.fontSizeIn = 0;\n        this.fontColorIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontSize\", {\n        /**\n         * Gets or sets the font size of selected contents.\n         */\n        get: function () {\n            return this.fontSizeIn;\n        },\n        set: function (value) {\n            if (value === this.fontSizeIn) {\n                return;\n            }\n            this.fontSizeIn = value;\n            this.notifyPropertyChanged('fontSize');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontFamily\", {\n        /**\n         * Gets or sets the font family of selected contents.\n         */\n        get: function () {\n            return this.fontFamilyIn;\n        },\n        set: function (value) {\n            if (value === this.fontFamilyIn) {\n                return;\n            }\n            this.fontFamilyIn = value;\n            this.notifyPropertyChanged('fontFamily');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"fontColor\", {\n        /**\n         * Gets or sets the font color of selected contents.\n         */\n        get: function () {\n            return this.fontColorIn;\n        },\n        set: function (value) {\n            if (value === this.fontColorIn) {\n                return;\n            }\n            this.fontColorIn = value;\n            this.notifyPropertyChanged('fontColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"bold\", {\n        /**\n         * Gets or sets the bold formatting of selected contents.\n         */\n        get: function () {\n            return this.boldIn;\n        },\n        set: function (value) {\n            if (value === this.boldIn) {\n                return;\n            }\n            this.boldIn = value;\n            this.notifyPropertyChanged('bold');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"italic\", {\n        /**\n         * Gets or sets the italic formatting of selected contents.\n         */\n        get: function () {\n            return this.italicIn;\n        },\n        set: function (value) {\n            if (value === this.italic) {\n                return;\n            }\n            this.italicIn = value;\n            this.notifyPropertyChanged('italic');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"strikethrough\", {\n        /**\n         * Gets or sets the strikethrough property of selected contents.\n         */\n        get: function () {\n            return this.strikeThroughIn;\n        },\n        set: function (value) {\n            if (value === this.strikeThroughIn) {\n                return;\n            }\n            this.strikeThroughIn = value;\n            this.notifyPropertyChanged('strikethrough');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"baselineAlignment\", {\n        /**\n         * Gets or sets the baseline alignment property of selected contents.\n         */\n        get: function () {\n            return this.baselineAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.baselineAlignmentIn) {\n                return;\n            }\n            this.baselineAlignmentIn = value;\n            this.notifyPropertyChanged('baselineAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"underline\", {\n        /**\n         * Gets or sets the underline style of selected contents.\n         */\n        get: function () {\n            return this.underlineIn;\n        },\n        set: function (value) {\n            if (value === this.underlineIn) {\n                return;\n            }\n            this.underlineIn = value;\n            this.notifyPropertyChanged('underline');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCharacterFormat.prototype, \"highlightColor\", {\n        /**\n         * Gets or sets the highlight color of selected contents.\n         */\n        get: function () {\n            return this.highlightColorIn;\n        },\n        set: function (value) {\n            if (value === this.highlightColorIn) {\n                return;\n            }\n            this.highlightColorIn = value;\n            this.notifyPropertyChanged('highlightColor');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionCharacterFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'bold':\n                return this.bold;\n            case 'italic':\n                return this.italic;\n            case 'fontSize':\n                if (this.fontSize >= 1) {\n                    return this.fontSize;\n                }\n                return undefined;\n            case 'fontFamily':\n                return this.fontFamily;\n            case 'strikethrough':\n                return this.strikethrough;\n            case 'baselineAlignment':\n                return this.baselineAlignment;\n            case 'highlightColor':\n                return this.highlightColor;\n            case 'underline':\n                return this.underline;\n            case 'fontColor':\n                return this.fontColor;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionCharacterFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared || this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var propertyValue = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(propertyValue)) {\n                this.selection.owner.editorModule.onApplyCharacterFormat(propertyName, propertyValue);\n            }\n        }\n    };\n    /**\n     * Copies the source format.\n     * @param  {WCharacterFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseCharStyle) ? format.baseCharStyle.name : 'Default Paragraph Font';\n        this.fontSize = format.fontSize;\n        this.fontFamily = format.fontFamily;\n        this.bold = format.bold;\n        this.italic = format.italic;\n        this.baselineAlignment = format.baselineAlignment;\n        this.underline = format.underline;\n        this.fontColor = format.fontColor;\n        this.highlightColor = format.highlightColor;\n        this.strikethrough = format.strikethrough;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    SelectionCharacterFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.bold) && this.bold !== format.bold) {\n            this.bold = undefined;\n        }\n        if (!isNullOrUndefined(this.italic) && this.italic !== format.italic) {\n            this.italic = undefined;\n        }\n        if (this.fontSize !== 0 && this.fontSize !== format.fontSize) {\n            this.fontSize = 0;\n        }\n        if (!isNullOrUndefined(this.fontFamily) && this.fontFamily !== format.fontFamily) {\n            this.fontFamily = undefined;\n        }\n        if (!isNullOrUndefined(this.highlightColor) && this.highlightColor !== format.highlightColor) {\n            this.highlightColor = undefined;\n        }\n        if (!isNullOrUndefined(this.baselineAlignment) && this.baselineAlignment !== format.baselineAlignment) {\n            this.baselineAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.fontColor) && (this.fontColor !== format.fontColor)) {\n            this.fontColor = undefined;\n        }\n        if (!isNullOrUndefined(this.underline) && this.underline !== format.underline) {\n            this.underline = undefined;\n        }\n        if (!isNullOrUndefined(this.strikethrough) && this.strikethrough !== format.strikethrough) {\n            this.strikethrough = undefined;\n        }\n    };\n    /**\n     * Clones the format.\n     * @param  {SelectionCharacterFormat} selectionCharacterFormat\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.cloneFormat = function (selectionCharacterFormat) {\n        this.bold = selectionCharacterFormat.bold;\n        this.italic = selectionCharacterFormat.italic;\n        this.underline = selectionCharacterFormat.underline;\n        this.strikethrough = selectionCharacterFormat.strikethrough;\n        this.baselineAlignment = selectionCharacterFormat.baselineAlignment;\n        this.highlightColor = selectionCharacterFormat.highlightColor;\n        this.fontSize = selectionCharacterFormat.fontSize;\n        this.fontFamily = selectionCharacterFormat.fontFamily;\n        this.fontColor = selectionCharacterFormat.fontColor;\n        this.styleName = selectionCharacterFormat.styleName;\n    };\n    /**\n     * Checks whether current format is equal to the source format or not.\n     * @param  {SelectionCharacterFormat} format\n     * @returns boolean\n     * @private\n     */\n    SelectionCharacterFormat.prototype.isEqualFormat = function (format) {\n        return (this.fontSize === format.fontSize\n            && this.strikethrough === format.strikethrough\n            && this.bold === format.bold\n            && this.fontFamily === format.fontFamily\n            && this.underline === format.underline\n            && this.highlightColor === format.highlightColor\n            && this.italic === format.italic\n            && this.baselineAlignment === format.baselineAlignment\n            && this.fontColor === format.fontColor);\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.clearFormat = function () {\n        this.fontSizeIn = 0;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.highlightColorIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.styleName = undefined;\n    };\n    /**\n     * Destroys the maintained resources.\n     * @returns void\n     * @private\n     */\n    SelectionCharacterFormat.prototype.destroy = function () {\n        this.fontSizeIn = undefined;\n        this.boldIn = undefined;\n        this.italicIn = undefined;\n        this.fontFamilyIn = undefined;\n        this.fontColorIn = undefined;\n        this.underlineIn = undefined;\n        this.strikeThroughIn = undefined;\n        this.baselineAlignmentIn = undefined;\n        this.highlightColorIn = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionCharacterFormat;\n}());\nexport { SelectionCharacterFormat };\n/**\n * Selection paragraph format implementation\n */\nvar SelectionParagraphFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionParagraphFormat(selection, viewer) {\n        // Declaring the character format properties.\n        this.leftIndentIn = 0;\n        this.rightIndentIn = 0;\n        this.beforeSpacingIn = 0;\n        this.afterSpacingIn = 0;\n        this.textAlignmentIn = undefined;\n        this.firstLineIndentIn = 0;\n        this.lineSpacingIn = 1;\n        this.lineSpacingTypeIn = undefined;\n        this.listLevelNumberIn = -1;\n        this.selection = selection;\n        this.viewer = viewer;\n    }\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"rightIndent\", {\n        /**\n         * Gets or Sets the right indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightIndentIn;\n        },\n        set: function (value) {\n            if (value === this.rightIndentIn) {\n                return;\n            }\n            this.rightIndentIn = value;\n            this.notifyPropertyChanged('rightIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"firstLineIndent\", {\n        /**\n         * Gets or Sets the first line indent for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.firstLineIndentIn;\n        },\n        set: function (value) {\n            if (value === this.firstLineIndentIn) {\n                return;\n            }\n            this.firstLineIndentIn = value;\n            this.notifyPropertyChanged('firstLineIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"textAlignment\", {\n        /**\n         * Gets or Sets the text alignment for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.textAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.textAlignmentIn) {\n                return;\n            }\n            this.textAlignmentIn = value;\n            this.notifyPropertyChanged('textAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"afterSpacing\", {\n        /**\n         * Gets or Sets the after spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.afterSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.afterSpacingIn) {\n                return;\n            }\n            this.afterSpacingIn = value;\n            this.notifyPropertyChanged('afterSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"beforeSpacing\", {\n        /**\n         * Gets or Sets the before spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.beforeSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.beforeSpacingIn) {\n                return;\n            }\n            this.beforeSpacingIn = value;\n            this.notifyPropertyChanged('beforeSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacing\", {\n        /**\n         * Gets or Sets the line spacing for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingIn) {\n                return;\n            }\n            this.lineSpacingIn = value;\n            this.notifyPropertyChanged('lineSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"lineSpacingType\", {\n        /**\n         * Gets or Sets the line spacing type for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.lineSpacingTypeIn;\n        },\n        set: function (value) {\n            if (value === this.lineSpacingTypeIn) {\n                return;\n            }\n            this.lineSpacingTypeIn = value;\n            this.notifyPropertyChanged('lineSpacingType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listLevelNumber\", {\n        /**\n         * Gets or Sets the list level number for selected paragraphs.\n         * @default undefined\n         */\n        get: function () {\n            return this.listLevelNumberIn;\n        },\n        set: function (value) {\n            if (value === this.listLevelNumberIn) {\n                return;\n            }\n            this.listLevelNumberIn = value;\n            this.notifyPropertyChanged('listLevelNumber');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionParagraphFormat.prototype, \"listText\", {\n        /**\n         * Gets the list text for selected paragraphs.\n         */\n        get: function () {\n            var listFormat = undefined;\n            var list = this.viewer.getListById(this.listId);\n            if (list instanceof WList && this.listLevelNumberIn > -1 && this.listLevelNumberIn < 9) {\n                var listLevel = list.getListLevel(this.listLevelNumber);\n                if (listLevel instanceof WListLevel) {\n                    if (listLevel.listLevelPattern === 'Bullet') {\n                        listFormat = listLevel.numberFormat;\n                    }\n                    else {\n                        listFormat = listLevel.numberFormat;\n                        for (var i = 0; i < 9; i++) {\n                            var levelPattern = '%' + (i + 1);\n                            if (listFormat.indexOf(levelPattern) > -1) {\n                                var level = i === this.listLevelNumberIn ? listLevel : list.getListLevel(i);\n                                var listTextElement = this.selection.getListTextElementBox(this.selection.start.paragraph);\n                                var listText = listTextElement ? listTextElement.text : '';\n                                listFormat = listText;\n                            }\n                        }\n                    }\n                }\n            }\n            return listFormat;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionParagraphFormat.prototype.getPropertyValue = function (property) {\n        switch (property) {\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'rightIndent':\n                return this.rightIndent;\n            case 'firstLineIndent':\n                return this.firstLineIndent;\n            case 'beforeSpacing':\n                return this.beforeSpacing;\n            case 'afterSpacing':\n                return this.afterSpacing;\n            case 'textAlignment':\n                return this.textAlignment;\n            case 'lineSpacing':\n                return this.lineSpacing;\n            case 'lineSpacingType':\n                return this.lineSpacingType;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Notifies whenever the property gets changed.\n     * @param  {string} propertyName\n     */\n    SelectionParagraphFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) &&\n            (this.selection.owner.isReadOnlyMode || !this.selection.owner.isDocumentLoaded)\n            && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var editorModule = this.selection.owner.editorModule;\n            var value = this.getPropertyValue(propertyName);\n            if ((propertyName === 'leftIndent' || propertyName === 'rightIndent' || propertyName === 'firstLineIndent')\n                && !(value >= -1056 && value < 1056)) {\n                return;\n            }\n            if (propertyName === 'listLevelNumber') {\n                editorModule.onApplyListInternal(this.viewer.getListById(this.listId), this.listLevelNumber);\n            }\n            else {\n                editorModule.onApplyParagraphFormat(propertyName, value, propertyName === 'textAlignment' ? true : false, false);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WParagraphFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyFormat = function (format) {\n        this.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : 'Normal';\n        this.leftIndent = format.leftIndent;\n        this.rightIndent = format.rightIndent;\n        this.firstLineIndent = format.firstLineIndent;\n        this.afterSpacing = format.afterSpacing;\n        this.beforeSpacing = format.beforeSpacing;\n        this.lineSpacing = format.lineSpacing;\n        this.lineSpacingType = format.lineSpacingType;\n        this.textAlignment = format.textAlignment;\n        if (!isNullOrUndefined(format.listFormat) && !isNullOrUndefined(format.listFormat.listId)) {\n            this.listId = format.listFormat.listId;\n            this.listLevelNumber = format.listFormat.listLevelNumber;\n        }\n        else {\n            this.listId = undefined;\n            this.listLevelNumber = 0;\n        }\n    };\n    /**\n     * Copies to format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.copyToFormat = function (format) {\n        if (isNullOrUndefined(format)) {\n            return;\n        }\n        if (!isNullOrUndefined(this.afterSpacing)) {\n            format.afterSpacing = this.afterSpacing;\n        }\n        if (!isNullOrUndefined(this.beforeSpacing)) {\n            format.beforeSpacing = this.beforeSpacing;\n        }\n        if (!isNullOrUndefined(this.leftIndent)) {\n            format.leftIndent = this.leftIndent;\n        }\n        if (!isNullOrUndefined(this.rightIndent)) {\n            format.rightIndent = this.rightIndent;\n        }\n        if (!isNullOrUndefined(this.textAlignment)) {\n            format.textAlignment = this.textAlignment;\n        }\n        if (!isNullOrUndefined(this.lineSpacing)) {\n            format.lineSpacing = this.lineSpacing;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType)) {\n            format.lineSpacingType = this.lineSpacingType;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent)) {\n            format.firstLineIndent = this.firstLineIndent;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WParagraphFormat} format\n     * @private\n     */\n    SelectionParagraphFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftIndent) && this.leftIndent !== format.leftIndent) {\n            this.leftIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.rightIndent) && this.rightIndent !== format.rightIndent) {\n            this.rightIndent = undefined;\n        }\n        if (!isNullOrUndefined(this.firstLineIndent) && this.firstLineIndent !== format.firstLineIndent) {\n            this.firstLineIndent = undefined;\n        }\n        if (this.lineSpacing !== 0 && this.lineSpacing !== format.lineSpacing) {\n            this.lineSpacing = 0;\n        }\n        if (this.beforeSpacing !== -1 && this.beforeSpacing !== format.beforeSpacing) {\n            this.beforeSpacing = -1;\n        }\n        if (this.afterSpacing !== -1 && this.afterSpacing !== format.afterSpacing) {\n            this.afterSpacing = -1;\n        }\n        if (!isNullOrUndefined(this.lineSpacingType) && this.lineSpacingType !== format.lineSpacingType) {\n            this.lineSpacingType = undefined;\n        }\n        if (!isNullOrUndefined(this.textAlignment) && this.textAlignment !== format.textAlignment) {\n            this.textAlignment = undefined;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (this.listLevelNumber >= 0 && !isNullOrUndefined(this.listId) && (isNullOrUndefined(format.listFormat) || format.listFormat.listLevelNumber !== this.listLevelNumber)) {\n            this.listLevelNumber = -1;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (isNullOrUndefined(format.listFormat) || isNullOrUndefined(format.listFormat.listId) || (!isNullOrUndefined(this.listId) && this.listId !== format.listFormat.listId)) {\n            this.listId = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.clearFormat = function () {\n        this.leftIndent = 0;\n        this.rightIndent = 0;\n        this.beforeSpacing = 0;\n        this.afterSpacing = 0;\n        this.firstLineIndent = 0;\n        this.lineSpacing = 1;\n        this.textAlignment = undefined;\n        this.lineSpacingType = undefined;\n        this.listId = undefined;\n        this.listLevelNumber = -1;\n        this.styleName = undefined;\n    };\n    /**\n     * Gets the clone of list at current selection.\n     * @returns WList\n     * @private\n     */\n    SelectionParagraphFormat.prototype.getList = function () {\n        var list = this.viewer.getListById(this.listId);\n        if (!isNullOrUndefined(list)) {\n            var listAdv = new WList();\n            var abstractList = new WAbstractList();\n            var currentAbstractList = this.viewer.getAbstractListById(list.abstractListId);\n            var editor = this.selection.owner.editorModule;\n            if (!isNullOrUndefined(currentAbstractList)) {\n                for (var i = 0; i < currentAbstractList.levels.length; i++) {\n                    var level = editor.cloneListLevel(currentAbstractList.levels[i]);\n                    abstractList.levels.push(level);\n                    level.ownerBase = abstractList;\n                }\n            }\n            else {\n                abstractList.levels.push(new WListLevel(abstractList));\n            }\n            if (!isNullOrUndefined(list.levelOverrides)) {\n                for (var i = 0; i < list.levelOverrides.length; i++) {\n                    var levelOverride = editor.cloneLevelOverride(list.levelOverrides[i]);\n                    listAdv.levelOverrides.push(levelOverride);\n                }\n            }\n            listAdv.abstractList = abstractList;\n            listAdv.abstractListId = abstractList.abstractListId;\n            listAdv.sourceListId = list.listId;\n            return listAdv;\n        }\n        return undefined;\n    };\n    /**\n     * Modifies the list at current selection.\n     * @param  {WList} listAdv\n     * @private\n     */\n    SelectionParagraphFormat.prototype.setList = function (listAdv) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        var list = this.viewer.getListById(this.listId);\n        var collection = undefined;\n        var currentAbstractList = listAdv ? this.viewer.getAbstractListById(listAdv.abstractListId) : undefined;\n        if (!isNullOrUndefined(list) && !isNullOrUndefined(listAdv)\n            && !isNullOrUndefined(currentAbstractList) && listAdv.sourceListId === list.listId) {\n            var history_1 = this.viewer.owner.editorHistory;\n            var listLevel = this.viewer.layout.getListLevel(list, 1);\n            this.selection.owner.isLayoutEnabled = false;\n            this.viewer.owner.editorModule.setOffsetValue(this.selection);\n            if (history_1) {\n                collection = history_1.updateListChangesInHistory(currentAbstractList, list);\n            }\n            this.viewer.owner.editorModule.updateListParagraphs();\n            if (history_1) {\n                history_1.applyListChanges(this.selection, collection);\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.renderedLists.clear();\n            // this.viewer.pages = [];\n            this.viewer.owner.editorModule.layoutWholeDocument();\n            this.viewer.owner.editorModule.updateSelectionTextPosition(false);\n            if (history_1 && history_1.currentBaseHistoryInfo) {\n                if (history_1.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                    history_1.currentBaseHistoryInfo.updateSelection();\n                }\n                history_1.updateHistory();\n            }\n            this.viewer.owner.editorModule.fireContentChange();\n        }\n        else if (!isNullOrUndefined(listAdv)) {\n            this.selection.owner.isLayoutEnabled = false;\n            if (!isNullOrUndefined(currentAbstractList) && this.viewer.abstractLists.indexOf(currentAbstractList) === -1) {\n                this.viewer.abstractLists.push(currentAbstractList);\n            }\n            if (this.viewer.lists.indexOf(listAdv) === -1) {\n                this.viewer.lists.push(listAdv);\n            }\n            //currentAbstractList.listType = 'Numbering';\n            this.selection.owner.isLayoutEnabled = true;\n            this.selection.owner.editorModule.onApplyList(listAdv);\n        }\n        else {\n            this.selection.owner.editorModule.onApplyList(undefined);\n        }\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionParagraphFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.rightIndentIn = undefined;\n        this.beforeSpacingIn = undefined;\n        this.afterSpacingIn = undefined;\n        this.firstLineIndentIn = undefined;\n        this.lineSpacingIn = undefined;\n        this.textAlignmentIn = undefined;\n        this.lineSpacingTypeIn = undefined;\n        this.listId = undefined;\n        this.listLevelNumberIn = undefined;\n        this.viewer = undefined;\n        this.selection = undefined;\n        this.styleName = undefined;\n    };\n    return SelectionParagraphFormat;\n}());\nexport { SelectionParagraphFormat };\n/**\n * Selection section format implementation\n */\nvar SelectionSectionFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionSectionFormat(selection) {\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageHeight\", {\n        /**\n         * Gets or sets the page height.\n         */\n        get: function () {\n            return this.pageHeightIn;\n        },\n        set: function (value) {\n            this.pageHeightIn = value;\n            this.notifyPropertyChanged('pageHeight');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"pageWidth\", {\n        /**\n         * Gets or sets the page width.\n         */\n        get: function () {\n            return this.pageWidthIn;\n        },\n        set: function (value) {\n            this.pageWidthIn = value;\n            this.notifyPropertyChanged('pageWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or sets the page left margin.\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or sets the page bottom margin.\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or sets the page top margin.\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or sets the page right margin.\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"headerDistance\", {\n        /**\n         * Gets or sets the header distance.\n         */\n        get: function () {\n            return this.headerDistanceIn;\n        },\n        set: function (value) {\n            this.headerDistanceIn = value;\n            this.notifyPropertyChanged('headerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"footerDistance\", {\n        /**\n         * Gets or sets the footer distance.\n         */\n        get: function () {\n            return this.footerDistanceIn;\n        },\n        set: function (value) {\n            this.footerDistanceIn = value;\n            this.notifyPropertyChanged('footerDistance');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentFirstPage\", {\n        /**\n         * Gets or sets a value indicating whether the section has different first page.\n         */\n        get: function () {\n            return this.differentFirstPageIn;\n        },\n        set: function (value) {\n            this.differentFirstPageIn = value;\n            this.notifyPropertyChanged('differentFirstPage');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionSectionFormat.prototype, \"differentOddAndEvenPages\", {\n        /**\n         * Gets or sets a value indicating whether the section has different odd and even page.\n         */\n        get: function () {\n            return this.differentOddAndEvenPagesIn;\n        },\n        set: function (value) {\n            this.differentOddAndEvenPagesIn = value;\n            this.notifyPropertyChanged('differentOddAndEvenPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Copies the format.\n     * @param  {WSectionFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.copyFormat = function (format) {\n        this.pageHeight = format.pageHeight;\n        this.pageWidth = format.pageWidth;\n        this.leftMargin = format.leftMargin;\n        this.topMargin = format.topMargin;\n        this.rightMargin = format.rightMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.headerDistance = format.headerDistance;\n        this.footerDistance = format.footerDistance;\n        this.differentFirstPage = format.differentFirstPage;\n        this.differentOddAndEvenPages = format.differentOddAndEvenPages;\n    };\n    SelectionSectionFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isPastingContent\n            || selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded)\n            && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyvalue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplySectionFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionSectionFormat.prototype.getPropertyvalue = function (propertyName) {\n        switch (propertyName) {\n            case 'pageHeight':\n                if (this.pageHeight > 0) {\n                    return this.pageHeight;\n                }\n                return undefined;\n            case 'pageWidth':\n                if (this.pageWidth > 0) {\n                    return this.pageWidth;\n                }\n                return undefined;\n            case 'leftMargin':\n                if (this.leftMargin >= 0) {\n                    return this.leftMargin;\n                }\n                return undefined;\n            case 'rightMargin':\n                if (this.rightMargin >= 0) {\n                    return this.rightMargin;\n                }\n                return undefined;\n            case 'topMargin':\n                if (this.topMargin >= 0) {\n                    return this.topMargin;\n                }\n                return undefined;\n            case 'bottomMargin':\n                if (this.bottomMargin >= 0) {\n                    return this.bottomMargin;\n                }\n                return undefined;\n            case 'differentFirstPage':\n                if (!isNullOrUndefined(this.differentFirstPage)) {\n                    return this.differentFirstPage;\n                }\n                return undefined;\n            case 'differentOddAndEvenPages':\n                if (!isNullOrUndefined(this.differentOddAndEvenPages)) {\n                    return this.differentOddAndEvenPages;\n                }\n                return undefined;\n            case 'headerDistance':\n                return this.headerDistanceIn;\n            case 'footerDistance':\n                return this.footerDistance;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Combines the format.\n     * @param  {WSectionFormat} format\n     * @private\n     */\n    SelectionSectionFormat.prototype.combineFormat = function (format) {\n        if (this.pageHeight > 0 && this.pageHeight !== format.pageHeight) {\n            this.pageHeight = 0;\n        }\n        if (this.pageWidth > 0 && this.pageWidth !== format.pageWidth) {\n            this.pageWidth = 0;\n        }\n        if (this.leftMargin > -1 && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = -1;\n        }\n        if (this.topMargin > -1 && this.topMargin !== format.topMargin) {\n            this.topMargin = -1;\n        }\n        if (this.rightMargin > -1 && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = -1;\n        }\n        if (this.bottomMargin > -1 && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = -1;\n        }\n        if (this.headerDistance !== 0 && this.headerDistance !== format.headerDistance) {\n            this.headerDistance = 0;\n        }\n        if (this.footerDistance !== 0 && this.footerDistance !== format.footerDistance) {\n            this.footerDistance = 0;\n        }\n        if (!isNullOrUndefined(this.differentFirstPage) && this.differentFirstPage !== format.differentFirstPage) {\n            this.differentFirstPage = undefined;\n        }\n        if (!isNullOrUndefined(this.differentOddAndEvenPages) && this.differentOddAndEvenPages !== format.differentOddAndEvenPages) {\n            this.differentOddAndEvenPages = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.clearFormat = function () {\n        this.headerDistance = 0;\n        this.footerDistance = 0;\n        this.pageHeight = 0;\n        this.pageWidth = 0;\n        this.leftMargin = -1;\n        this.rightMargin = -1;\n        this.topMargin = -1;\n        this.bottomMargin = -1;\n        this.differentFirstPage = undefined;\n        this.differentOddAndEvenPages = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionSectionFormat.prototype.destroy = function () {\n        this.headerDistanceIn = undefined;\n        this.footerDistanceIn = undefined;\n        this.pageHeightIn = undefined;\n        this.pageWidthIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.differentFirstPageIn = undefined;\n        this.differentOddAndEvenPagesIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionSectionFormat;\n}());\nexport { SelectionSectionFormat };\n/**\n * Selection table format implementation\n */\nvar SelectionTableFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionTableFormat(selection) {\n        this.leftIndentIn = 0;\n        this.backgroundIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.cellSpacingIn = 0;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.preferredWidthIn = 0;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionTableFormat.prototype, \"table\", {\n        /**\n         * Gets or sets the table.\n         * @private\n         */\n        get: function () {\n            return this.tableIn;\n        },\n        set: function (value) {\n            this.tableIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftIndent\", {\n        /**\n         * Gets or Sets the left indent for selected table.\n         * @private\n         */\n        get: function () {\n            return this.leftIndentIn;\n        },\n        set: function (value) {\n            if (value === this.leftIndentIn) {\n                return;\n            }\n            this.leftIndentIn = value;\n            this.notifyPropertyChanged('leftIndent');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the default top margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"tableAlignment\", {\n        /**\n         * Gets or Sets the table alignment for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.tableAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.tableAlignmentIn) {\n                return;\n            }\n            this.tableAlignmentIn = value;\n            this.notifyPropertyChanged('tableAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the default left margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the default bottom margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"cellSpacing\", {\n        /**\n         * Gets or Sets the cell spacing for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.cellSpacingIn;\n        },\n        set: function (value) {\n            if (value === this.cellSpacingIn) {\n                return;\n            }\n            this.cellSpacingIn = value;\n            this.notifyPropertyChanged('cellSpacing');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the default right margin of cell for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionTableFormat.prototype, \"preferredWidthType\", {\n        /**\n         * Gets or Sets the preferred width type for selected table.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionTableFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'tableAlignment':\n                return this.tableAlignment;\n            case 'leftIndent':\n                return this.leftIndent;\n            case 'cellSpacing':\n                return this.cellSpacing;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            default:\n                return undefined;\n        }\n    };\n    SelectionTableFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        if (!isNullOrUndefined(this.selection) && (this.selection.isCleared\n            || !this.selection.owner.isDocumentLoaded || this.selection.owner.isReadOnlyMode\n            || this.selection.owner.isPastingContent) && !this.selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(this.selection) && !isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (propertyName === 'background') {\n                propertyName = 'shading';\n            }\n            if (!isNullOrUndefined(value)) {\n                this.selection.owner.editorModule.onApplyTableFormat(propertyName, value);\n            }\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WTableFormat} format Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.copyFormat = function (format) {\n        this.leftIndent = format.leftIndent;\n        this.background = format.shading.backgroundColor;\n        this.tableAlignment = format.tableAlignment;\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.cellSpacing = format.cellSpacing;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.clearFormat = function () {\n        this.table = undefined;\n        this.leftIndent = 0;\n        this.background = undefined;\n        this.leftIndent = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.bottomMargin = 0;\n        this.cellSpacing = 0;\n        this.tableAlignment = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionTableFormat.prototype.destroy = function () {\n        this.leftIndentIn = undefined;\n        this.backgroundIn = undefined;\n        this.leftIndentIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.cellSpacingIn = undefined;\n        this.tableAlignmentIn = undefined;\n        this.tableIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionTableFormat;\n}());\nexport { SelectionTableFormat };\n/**\n * Selection cell format implementation\n */\nvar SelectionCellFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionCellFormat(selection) {\n        this.verticalAlignmentIn = undefined;\n        this.leftMarginIn = 0;\n        this.rightMarginIn = 0;\n        this.topMarginIn = 0;\n        this.bottomMarginIn = 0;\n        this.backgroundIn = undefined;\n        this.preferredWidthTypeIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionCellFormat.prototype, \"verticalAlignment\", {\n        /**\n         * Gets or sets the vertical alignment of the selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.verticalAlignmentIn;\n        },\n        set: function (value) {\n            if (value === this.verticalAlignmentIn) {\n                return;\n            }\n            this.verticalAlignmentIn = value;\n            this.notifyPropertyChanged('verticalAlignment');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"leftMargin\", {\n        /**\n         * Gets or Sets the left margin for selected cells.\n         * @default undefined\n         */\n        /* tslint:disable */\n        get: function () {\n            return this.leftMarginIn;\n        },\n        set: function (value) {\n            if (value === this.leftMarginIn) {\n                return;\n            }\n            this.leftMarginIn = value;\n            this.notifyPropertyChanged('leftMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"rightMargin\", {\n        /**\n         * Gets or Sets the right margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.rightMarginIn;\n        },\n        set: function (value) {\n            if (value === this.rightMarginIn) {\n                return;\n            }\n            this.rightMarginIn = value;\n            this.notifyPropertyChanged('rightMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"topMargin\", {\n        /**\n         * Gets or Sets the top margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.topMarginIn;\n        },\n        set: function (value) {\n            if (value === this.topMarginIn) {\n                return;\n            }\n            this.topMarginIn = value;\n            this.notifyPropertyChanged('topMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"bottomMargin\", {\n        /**\n         * Gets or Sets the bottom margin for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.bottomMarginIn;\n        },\n        set: function (value) {\n            if (value === this.bottomMarginIn) {\n                return;\n            }\n            this.bottomMarginIn = value;\n            this.notifyPropertyChanged('bottomMargin');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"background\", {\n        /**\n         * Gets or Sets the background for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.backgroundIn;\n        },\n        /* tslint:enable */\n        set: function (value) {\n            if (value === this.backgroundIn) {\n                return;\n            }\n            this.backgroundIn = value;\n            this.notifyPropertyChanged('background');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidthType\", {\n        /* tslint:disable */\n        /**\n         * Gets or Sets the preferred width type for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthTypeIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthTypeIn) {\n                return;\n            }\n            this.preferredWidthTypeIn = value;\n            this.notifyPropertyChanged('preferredWidthType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionCellFormat.prototype, \"preferredWidth\", {\n        /**\n         * Gets or Sets the preferred width  for selected cells.\n         * @default undefined\n         */\n        get: function () {\n            return this.preferredWidthIn;\n        },\n        set: function (value) {\n            if (value === this.preferredWidthIn) {\n                return;\n            }\n            this.preferredWidthIn = value;\n            this.notifyPropertyChanged('preferredWidth');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /* tslint:enable */\n    SelectionCellFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection)) {\n            if ((selection.isCleared || !selection.owner.isDocumentLoaded\n                || selection.owner.isReadOnlyMode || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n                return;\n            }\n            if (!isNullOrUndefined(this.selection.start) && !this.selection.isRetrieveFormatting) {\n                var value = this.getPropertyValue(propertyName);\n                if (propertyName === 'background') {\n                    propertyName = 'shading';\n                }\n                if (!isNullOrUndefined(value)) {\n                    this.selection.owner.editorModule.onApplyTableCellFormat(propertyName, value);\n                }\n            }\n        }\n    };\n    SelectionCellFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'verticalAlignment':\n                return this.verticalAlignment;\n            case 'leftMargin':\n                return this.leftMargin;\n            case 'rightMargin':\n                return this.rightMargin;\n            case 'topMargin':\n                return this.topMargin;\n            case 'bottomMargin':\n                return this.bottomMargin;\n            case 'preferredWidth':\n                return this.preferredWidth;\n            case 'preferredWidthType':\n                return this.preferredWidthType;\n            case 'background':\n                var shading = new WShading();\n                shading.backgroundColor = this.background;\n                return shading;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WCellFormat} format Source Format to copy.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.copyFormat = function (format) {\n        this.leftMargin = format.leftMargin;\n        this.rightMargin = format.rightMargin;\n        this.topMargin = format.topMargin;\n        this.bottomMargin = format.bottomMargin;\n        this.background = format.shading.backgroundColor;\n        this.verticalAlignment = format.verticalAlignment;\n        this.preferredWidth = format.preferredWidth;\n        this.preferredWidthType = format.preferredWidthType;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearCellFormat = function () {\n        this.leftMargin = undefined;\n        this.rightMargin = undefined;\n        this.topMargin = undefined;\n        this.bottomMargin = undefined;\n        this.background = undefined;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Combines the format.\n     * @param  {WCellFormat} format\n     * @private\n     */\n    SelectionCellFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.leftMargin) && this.leftMargin !== format.leftMargin) {\n            this.leftMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.topMargin) && this.topMargin !== format.topMargin) {\n            this.topMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.rightMargin) && this.rightMargin !== format.rightMargin) {\n            this.rightMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.bottomMargin) && this.bottomMargin !== format.bottomMargin) {\n            this.bottomMargin = undefined;\n        }\n        if (!isNullOrUndefined(this.background) && this.background !== format.shading.backgroundColor) {\n            this.background = undefined;\n        }\n        if (!isNullOrUndefined(this.verticalAlignment) && this.verticalAlignment !== format.verticalAlignment) {\n            this.verticalAlignment = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidth) && this.preferredWidth !== format.preferredWidth) {\n            this.preferredWidth = undefined;\n        }\n        if (!isNullOrUndefined(this.preferredWidthType) && this.preferredWidthType !== format.preferredWidthType) {\n            this.preferredWidthType = undefined;\n        }\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.clearFormat = function () {\n        this.background = undefined;\n        this.bottomMargin = 0;\n        this.leftMargin = 0;\n        this.rightMargin = 0;\n        this.topMargin = 0;\n        this.verticalAlignment = undefined;\n    };\n    /**\n     * Destroys the manages resources.\n     * @returns void\n     * @private\n     */\n    SelectionCellFormat.prototype.destroy = function () {\n        this.backgroundIn = undefined;\n        this.verticalAlignmentIn = undefined;\n        this.bottomMarginIn = undefined;\n        this.leftMarginIn = undefined;\n        this.rightMarginIn = undefined;\n        this.topMarginIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionCellFormat;\n}());\nexport { SelectionCellFormat };\n/**\n * Selection row format implementation\n */\nvar SelectionRowFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionRowFormat(selection) {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.isHeaderIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionRowFormat.prototype, \"height\", {\n        /**\n         * Gets or Sets the height for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        set: function (value) {\n            if (value === this.heightIn) {\n                return;\n            }\n            this.heightIn = value;\n            this.notifyPropertyChanged('height');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"heightType\", {\n        /**\n         * Gets or Sets the height type for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.heightTypeIn;\n        },\n        set: function (value) {\n            if (value === this.heightTypeIn) {\n                return;\n            }\n            this.heightTypeIn = value;\n            this.notifyPropertyChanged('heightType');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"isHeader\", {\n        /**\n         * Gets or Sets a value indicating whether the selected rows are header rows or not.\n         * @default undefined\n         */\n        get: function () {\n            return this.isHeaderIn;\n        },\n        set: function (value) {\n            if (value === this.isHeaderIn) {\n                return;\n            }\n            this.isHeaderIn = value;\n            this.notifyPropertyChanged('isHeader');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionRowFormat.prototype, \"allowBreakAcrossPages\", {\n        /**\n         * Gets or Sets a value indicating whether to allow break across pages for selected rows.\n         * @default undefined\n         */\n        get: function () {\n            return this.allowRowBreakAcrossPagesIn;\n        },\n        set: function (value) {\n            if (value === this.allowRowBreakAcrossPagesIn) {\n                return;\n            }\n            this.allowRowBreakAcrossPagesIn = value;\n            this.notifyPropertyChanged('allowBreakAcrossPages');\n        },\n        enumerable: true,\n        configurable: true\n    });\n    SelectionRowFormat.prototype.notifyPropertyChanged = function (propertyName) {\n        var selection = this.selection;\n        if (!isNullOrUndefined(selection) && (selection.isCleared || selection.owner.isReadOnlyMode\n            || !selection.owner.isDocumentLoaded || selection.owner.isPastingContent) && !selection.isRetrieveFormatting) {\n            return;\n        }\n        if (!isNullOrUndefined(selection) && !isNullOrUndefined(selection.start) && !selection.isRetrieveFormatting) {\n            var value = this.getPropertyValue(propertyName);\n            if (!isNullOrUndefined(value)) {\n                selection.owner.editorModule.onApplyTableRowFormat(propertyName, value);\n            }\n        }\n    };\n    SelectionRowFormat.prototype.getPropertyValue = function (propertyName) {\n        switch (propertyName) {\n            case 'height':\n                return this.height;\n            case 'heightType':\n                return this.heightType;\n            case 'isHeader':\n                return this.isHeader;\n            case 'allowBreakAcrossPages':\n                return this.allowBreakAcrossPages;\n            default:\n                return undefined;\n        }\n    };\n    /**\n     * Copies the format.\n     * @param  {WRowFormat} format\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.copyFormat = function (format) {\n        this.height = format.height;\n        this.heightType = format.heightType;\n        this.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        this.isHeader = format.isHeader;\n    };\n    /**\n     * Combines the format.\n     * @param  {WRowFormat} format\n     * @private\n     */\n    SelectionRowFormat.prototype.combineFormat = function (format) {\n        if (!isNullOrUndefined(this.height) && this.height !== format.height) {\n            this.height = undefined;\n        }\n        if (!isNullOrUndefined(this.heightType) && this.heightType !== format.heightType) {\n            this.heightType = undefined;\n        }\n        if (!isNullOrUndefined(this.allowBreakAcrossPages) && this.allowBreakAcrossPages !== format.allowBreakAcrossPages) {\n            this.allowBreakAcrossPages = undefined;\n        }\n        if (!isNullOrUndefined(this.isHeader) && this.isHeader !== format.isHeader) {\n            this.isHeader = undefined;\n        }\n    };\n    /**\n     * Clears the row format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearRowFormat = function () {\n        this.height = undefined;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Clears the format.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.clearFormat = function () {\n        this.height = 0;\n        this.heightType = undefined;\n        this.allowBreakAcrossPages = undefined;\n        this.isHeader = undefined;\n    };\n    /**\n     * Destroys the managed resources.\n     * @returns void\n     * @private\n     */\n    SelectionRowFormat.prototype.destroy = function () {\n        this.heightIn = undefined;\n        this.heightTypeIn = undefined;\n        this.allowRowBreakAcrossPagesIn = undefined;\n        this.isHeaderIn = undefined;\n        this.selection = undefined;\n    };\n    return SelectionRowFormat;\n}());\nexport { SelectionRowFormat };\n/**\n * Selection image format implementation\n */\nvar SelectionImageFormat = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SelectionImageFormat(selection) {\n        this.selection = selection;\n    }\n    Object.defineProperty(SelectionImageFormat.prototype, \"width\", {\n        /**\n         * Gets the width of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.width;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionImageFormat.prototype, \"height\", {\n        /**\n         * Gets the height of the image.\n         */\n        get: function () {\n            if (this.image) {\n                return this.image.height;\n            }\n            return 0;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Resizes the image based on given size.\n     * @param width\n     * @param height\n     */\n    SelectionImageFormat.prototype.resize = function (width, height) {\n        this.updateImageFormat(width, height);\n    };\n    /**\n     * Update image width and height\n     * @private\n     */\n    SelectionImageFormat.prototype.updateImageFormat = function (width, height) {\n        if (this.image) {\n            if (this.selection.owner.editorModule) {\n                this.selection.owner.editorModule.onImageFormat(this.image, width, height);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.copyImageFormat = function (image) {\n        this.image = image;\n    };\n    /**\n     * @private\n     */\n    SelectionImageFormat.prototype.clearImageFormat = function () {\n        this.image = undefined;\n    };\n    return SelectionImageFormat;\n}());\nexport { SelectionImageFormat };\n/* tslint:enable */ \n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * @private\n */\nvar HtmlExport = /** @class */ (function () {\n    function HtmlExport() {\n        /* tslint:disable:no-any */\n        this.document = undefined;\n        /* tslint:disable:no-any */\n        /**\n         * @private\n         */\n        this.fieldCheck = 0;\n        /* tslint:enable:no-any */\n    }\n    /* tslint:disable:no-any */\n    /**\n     * @private\n     */\n    HtmlExport.prototype.writeHtml = function (document) {\n        this.document = document;\n        var html = '';\n        for (var i = 0; i < document.sections.length; i++) {\n            html = this.serializeSection(document.sections[i]);\n        }\n        return html;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSection = function (section) {\n        var string = '';\n        for (var i = 0; i < section.blocks.length; i++) {\n            var block = section.blocks[i];\n            if (block.hasOwnProperty('inlines')) {\n                string += this.serializeParagraph(block);\n            }\n            else {\n                string += this.serializeTable(block);\n            }\n        }\n        return string;\n    };\n    // Serialize Paragraph \n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraph = function (paragraph) {\n        var blockStyle = '';\n        var startString = undefined;\n        var isList = false;\n        var tagAttributes = [];\n        tagAttributes.push('style=\"' + this.serializeParagraphStyle(paragraph, '', isList) + '\"');\n        blockStyle += this.createAttributesTag('p', tagAttributes);\n        if (paragraph.inlines.length === 0) {\n            //Handled to preserve non breaking space for empty paragraphs similar to MS Word behavior.\n            blockStyle += '&nbsp;';\n        }\n        else {\n            blockStyle = this.serializeInlines(paragraph, blockStyle);\n        }\n        blockStyle += this.endTag('p');\n        return blockStyle;\n    };\n    //SerializeInlines\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlines = function (paragraph, blockStyle) {\n        var inline = undefined;\n        var i = 0;\n        while (paragraph.inlines.length > i) {\n            inline = paragraph.inlines[i];\n            if (inline.hasOwnProperty('imageString')) {\n                blockStyle += this.serializeImageContainer(inline);\n            }\n            else if (inline.hasOwnProperty('fieldType')) {\n                if (inline.fieldType === 0) {\n                    this.fieldCheck = 1;\n                    var tagAttributes = [];\n                    tagAttributes.push('style=\"' + this.serializeInlineStyle(inline.characterFormat, '') + '\"');\n                    blockStyle += this.createAttributesTag('a', tagAttributes);\n                }\n                else if (inline.fieldType === 2) {\n                    this.fieldCheck = 2;\n                }\n                else {\n                    blockStyle += this.endTag('a');\n                    this.fieldCheck = 0;\n                }\n            }\n            else {\n                var text = isNullOrUndefined(inline.text) ? '' : inline.text;\n                if (this.fieldCheck === 0) {\n                    blockStyle += this.serializeSpan(text, inline.characterFormat);\n                }\n                if (this.fieldCheck === 1) {\n                    var hyperLink = text.replace('\\\"', '');\n                    blockStyle += ' href= \\\"' + hyperLink.replace('HYPERLINK', '').trim();\n                    blockStyle += '\\\"';\n                    blockStyle += '>';\n                }\n                if (this.fieldCheck === 2) {\n                    blockStyle += text;\n                }\n            }\n            i++;\n        }\n        return blockStyle;\n    };\n    // Serialize Span\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeSpan = function (spanText, characterFormat) {\n        var spanClass = '';\n        if (spanText.indexOf('\\v') !== -1) {\n            spanClass += '<br>';\n            return spanClass.toString();\n        }\n        var tagAttributes = [];\n        this.serializeInlineStyle(characterFormat, '');\n        tagAttributes.push('style=\"' + this.serializeInlineStyle(characterFormat, '') + '\"');\n        spanClass += this.createAttributesTag('span', tagAttributes);\n        var ignoreFirstSpace = false;\n        // Todo: Need to handle it.\n        // If the text starts with white-space, need to check whether it is a continuous space.\n        // if (characterFormat.ownerBase instanceof WInline) {\n        //     let inline: WInline = (characterFormat.ownerBase as WInline);\n        //     tslint:disable:max-line-length            \n        //     if (inline instanceof WSpan && !isNullOrUndefined(inline.text) && inline.text !== '' && (inline as WSpan).text[0] === ' ') {\n        //         Check previous inline until, it has valid rendered text.\n        //         do {\n        //             inline = WInline.getPreviousTextInline((inline as WSpan));\n        //         } while (inline instanceof WSpan && !isNullOrUndefined(inline.text));\n        //     } else {\n        //         inline = undefined;\n        //     }\n        //     If current white-space is a continuation of consecutive spaces, this will be set true.\n        //     ignoreFirstSpace = inline instanceof WSpan && !isNullOrUndefined(inline.text)\n        //         && (inline as WSpan).text[(inline as WSpan).text.length - 1] === ' ';\n        // }\n        var text = this.decodeHtmlNames(spanText.toString());\n        spanClass += text;\n        spanClass += this.endTag('span');\n        return spanClass.toString();\n    };\n    //Serialize Image\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeImageContainer = function (image) {\n        var imageStyle = '';\n        var tagAttributes = [];\n        this.serializeInlineStyle(image.characterFormat, '');\n        var imageSource = '';\n        if (!isNullOrUndefined(image.imageString)) {\n            imageSource = image.imageString;\n        }\n        var width = HelperMethods.convertPointToPixel(image.width);\n        var height = HelperMethods.convertPointToPixel(image.height);\n        tagAttributes.push('width=\"', width.toString() + '\"');\n        tagAttributes.push('height=\"', height.toString() + '\"');\n        tagAttributes.push('src=\"', imageSource + '\"');\n        imageStyle += this.createAttributesTag('img', tagAttributes);\n        imageStyle += (this.endTag('img'));\n        return imageStyle.toString();\n    };\n    // Serialize Table Cell\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCell = function (cell) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        var cellHtml = '';\n        tagAttributes = [];\n        if (!isNullOrUndefined(cell.cellFormat)) {\n            //if (cell.cellFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + cell.cellFormat.shading.backgroundColor + '\"');\n            // }\n            if (cell.cellFormat.columnSpan > 1) {\n                tagAttributes.push('colspan=\"' + cell.cellFormat.columnSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.rowSpan > 1) {\n                tagAttributes.push('rowspan=\"' + cell.cellFormat.rowSpan.toString() + '\"');\n            }\n            if (cell.cellFormat.cellWidth !== 0) {\n                tagAttributes.push('width=\"' + cell.cellFormat.cellWidth.toString() + '\"');\n            }\n            if (cell.cellFormat.verticalAlignment !== 'Top') {\n                tagAttributes.push('valign=\"' + cell.cellFormat.verticalAlignment.toString().toLowerCase() + '\"');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.leftMargin) && cell.cellFormat.leftMargin !== 0) {\n                cellHtml += ('padding-left:' + cell.cellFormat.leftMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.rightMargin) && cell.cellFormat.rightMargin !== 0) {\n                cellHtml += ('padding-right:' + cell.cellFormat.rightMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.topMargin) && cell.cellFormat.topMargin !== 0) {\n                cellHtml += ('padding-top:' + cell.cellFormat.topMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.bottomMargin) && cell.cellFormat.bottomMargin !== 0) {\n                cellHtml += ('padding-bottom:' + cell.cellFormat.bottomMargin.toString() + 'pt;');\n            }\n            if (!isNullOrUndefined(cell.cellFormat.borders)) {\n                cellHtml += this.serializeCellBordersStyle(cell.cellFormat.borders);\n            }\n        }\n        if (cellHtml.length !== 0) {\n            tagAttributes.push('style=\"' + cellHtml + '\"');\n        }\n        blockStyle += (this.createAttributesTag('td', tagAttributes));\n        for (var k = 0; k < cell.blocks.length; k++) {\n            var block = cell.blocks[k];\n            if (block.hasOwnProperty('rows')) {\n                blockStyle += this.serializeTable(block);\n            }\n            else {\n                blockStyle += this.serializeParagraph(block);\n            }\n        }\n        blockStyle += (this.endTag('td'));\n        return blockStyle;\n    };\n    // Serialize Table\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTable = function (table) {\n        var html = '';\n        html += this.createTableStartTag(table);\n        for (var j = 0; j < table.rows.length; j++) {\n            html += this.serializeRow(table.rows[j]);\n        }\n        html += this.createTableEndTag();\n        return html;\n    };\n    // Serialize Row\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeRow = function (row) {\n        var html = '';\n        html += this.createRowStartTag(row);\n        for (var k = 0; k < row.cells.length; k++) {\n            html += this.serializeCell(row.cells[k]);\n        }\n        return html;\n    };\n    // Serialize Styles\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphStyle = function (paragraph, className, isList) {\n        var paragraphClass = '';\n        paragraphClass += this.serializeCharacterFormat(paragraph.characterFormat);\n        paragraphClass += this.serializeParagraphFormat(paragraph.paragraphFormat, isList);\n        return paragraphClass;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeInlineStyle = function (characterFormat, className) {\n        return this.serializeCharacterFormat(characterFormat);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeTableBorderStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle += ('border-left-style:' + this.convertBorderLineStyle(borders.left.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-left-width:' + borders.left.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-left-color:' + borders.left.color);\n        borderStyle += ';';\n        borderStyle += ('border-right-style:' + this.convertBorderLineStyle(borders.right.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-right-width:' + borders.right.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-right-color:' + borders.right.color);\n        borderStyle += ';';\n        borderStyle += ('border-top-style:' + this.convertBorderLineStyle(borders.top.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-top-width:' + borders.top.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-top-color:' + borders.top.color);\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-style:' + this.convertBorderLineStyle(borders.bottom.lineStyle));\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-width:' + borders.bottom.lineWidth.toString() + 'pt');\n        borderStyle += ';';\n        borderStyle += ('border-Bottom-color:' + borders.bottom.color);\n        borderStyle += ';';\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCellBordersStyle = function (borders) {\n        var borderStyle = '';\n        borderStyle = 'border:solid 1px;';\n        // Todo: handle\n        // let border: WBorder = undefined;\n        // //LeftBorder\n        // border = WCell.getCellLeftBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'left');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-left-style:none;');\n        // }\n        // //RightBorder\n        // border = WCell.getCellRightBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'right');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-right-style:none');\n        // }\n        // //TopBorder\n        // border = WCell.getCellTopBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'top');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-top-style:none');\n        // }\n        // //BottomBorder\n        // border = WCell.getCellBottomBorder(WCell.getCellOf(borders));\n        // if (!isNullOrUndefined(border) && border.lineStyle !== 'None') {\n        //     borderStyle += this.serializeBorderStyle(border, 'bottom');\n        // } else if (!isNullOrUndefined(border) && border.hasNoneStyle) {\n        //     borderStyle += ('border-bottom-style:none');\n        // }\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeBorderStyle = function (border, borderPosition) {\n        var borderStyle = '';\n        borderStyle += ('border-' + borderPosition + '-style:' + this.convertBorderLineStyle(border.lineStyle));\n        borderStyle += ';';\n        if (border.lineWidth > 0) {\n            borderStyle += ('border-' + borderPosition + '-width:' + border.lineWidth.toString() + 'pt;');\n        }\n        //if (border.color !== Color.FromArgb(0, 0, 0, 0))\n        borderStyle += ('border-' + borderPosition + '-color:' + border.color + ';');\n        return borderStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.convertBorderLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'None':\n                return 'none';\n            case 'Single':\n                return 'solid';\n            case 'Dot':\n                return 'dotted';\n            case 'DashSmallGap':\n            case 'DashLargeGap':\n            case 'DashDot':\n            case 'DashDotDot':\n                return 'dashed';\n            case 'Double':\n            case 'Triple':\n            case 'ThinThickSmallGap':\n            case 'ThickThinSmallGap':\n            case 'ThinThickThinSmallGap':\n            case 'ThinThickMediumGap':\n            case 'ThickThinMediumGap':\n            case 'ThinThickThinMediumGap':\n            case 'ThinThickLargeGap':\n            case 'ThickThinLargeGap':\n            case 'ThinThickThinLargeGap':\n                return 'double';\n            case 'SingleWavy':\n                return 'solid';\n            case 'DoubleWavy':\n                return 'double';\n            case 'DashDotStroked':\n                return 'solid';\n            case 'Emboss3D':\n                return 'ridge';\n            case 'Engrave3D':\n                return 'groove';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            default:\n                return 'solid';\n        }\n    };\n    // Serialize Format\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat.inlineFormat)) {\n            return this.serializeCharacterFormat(characterFormat.inlineFormat);\n        }\n        var propertyValue;\n        var charStyle = '';\n        if (characterFormat.bold) {\n            charStyle += 'font-weight';\n            charStyle += ':';\n            charStyle += 'bold';\n            charStyle += ';';\n        }\n        charStyle += 'font-style';\n        charStyle += ':';\n        if (characterFormat.italic) {\n            charStyle += 'italic';\n        }\n        else {\n            charStyle += 'normal';\n        }\n        charStyle += ';';\n        // Double strike through will become Single strike through while saving HTML using MS Word.\n        if (characterFormat.strikethrough === 'SingleStrike' || characterFormat.strikethrough === 'DoubleStrike') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'line-through';\n            charStyle += ';';\n        }\n        //Text Baseline Alignment\n        // tslint:disable-next-line:max-line-length\n        if (characterFormat.baselineAlignment === 'Superscript' || characterFormat.baselineAlignment === 'Subscript') {\n            charStyle += 'vertical-align';\n            charStyle += ':';\n            charStyle += characterFormat.baselineAlignment === 'Superscript' ? 'super' : 'sub';\n            charStyle += ';';\n        }\n        //Text Foreground and Background Color \n        if (!isNullOrUndefined(characterFormat.highlightColor)) {\n            charStyle += 'background-color';\n            charStyle += ':';\n            charStyle += characterFormat.highlightColor.toString();\n            charStyle += ';';\n        }\n        //Font Color\n        propertyValue = characterFormat.fontColor;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'color';\n            charStyle += ':';\n            charStyle += propertyValue;\n            charStyle += ';';\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            charStyle += 'text-decoration';\n            charStyle += ':';\n            charStyle += 'underline';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontSize;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-size';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += 'pt';\n            charStyle += ';';\n        }\n        propertyValue = characterFormat.fontFamily;\n        if (!isNullOrUndefined(propertyValue)) {\n            charStyle += 'font-family';\n            charStyle += ':';\n            charStyle += propertyValue.toString();\n            charStyle += ';';\n        }\n        return charStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.serializeParagraphFormat = function (paragraphFormat, isList) {\n        if (!isNullOrUndefined(paragraphFormat.inlineFormat)) {\n            return this.serializeParagraphFormat(paragraphFormat.inlineFormat, isList);\n        }\n        var propertyValue;\n        var paraStyle = '';\n        propertyValue = paragraphFormat.textAlignment;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'text-align:' + propertyValue.toLowerCase() + ';';\n        }\n        propertyValue = paragraphFormat.beforeSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-top:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.rightIndent;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-right:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.afterSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-bottom:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.leftIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = -48;\n            }\n            else {\n                propertyValue -= 48;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue)) {\n            paraStyle += 'margin-left:' + propertyValue.toString() + 'pt; ';\n        }\n        propertyValue = paragraphFormat.firstLineIndent;\n        if (isList) {\n            if (isNullOrUndefined(propertyValue)) {\n                propertyValue = 24;\n            }\n            else {\n                propertyValue += 24;\n            }\n        }\n        if (!isNullOrUndefined(propertyValue) && propertyValue !== 0) {\n            paraStyle += 'text-indent:' + propertyValue.toString() + 'pt;';\n        }\n        propertyValue = paragraphFormat.lineSpacing;\n        if (!isNullOrUndefined(propertyValue)) {\n            if (paragraphFormat.lineSpacingType === 'Multiple') {\n                propertyValue = (propertyValue * 100).toString() + '%;';\n            }\n            else {\n                propertyValue = propertyValue.toString() + 'pt;';\n            }\n            paraStyle += 'line-height:' + propertyValue;\n        }\n        return paraStyle.toString();\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createAttributesTag = function (tagValue, localProperties) {\n        var sb = '';\n        sb += '<';\n        sb += tagValue;\n        for (var i = 0; i < localProperties.length; i++) {\n            sb += ' ';\n            sb += localProperties[i];\n        }\n        if (tagValue !== 'a') {\n            sb += '>';\n        }\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTag = function (tagValue) {\n        var s = '';\n        s += '<';\n        s += tagValue;\n        s += '>';\n        return s;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.endTag = function (tagValue) {\n        var sb = '';\n        sb += '<';\n        sb += '/';\n        sb += tagValue;\n        sb += '>';\n        return sb;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableStartTag = function (table) {\n        var blockStyle = '';\n        var tableStyle = '';\n        var tagAttributes = [];\n        tagAttributes.push('border=\"' + '1\"');\n        if (!isNullOrUndefined(table.tableFormat)) {\n            //if (table.tableFormat.shading.backgroundColor !== Color.FromArgb(0, 0, 0, 0)) {\n            tagAttributes.push('bgcolor=\"' + table.tableFormat.shading.backgroundColor + '\"');\n            //}\n            if (table.tableFormat.leftIndent !== 0) {\n                tagAttributes.push('left-indent=\"' + table.tableFormat.leftIndent.toString() + 'pt;');\n            }\n            if (table.tableFormat.cellSpacing > 0) {\n                tagAttributes.push('cellspacing=\"' + (((table.tableFormat.cellSpacing * 72) / 96) * 2).toString() + '\"');\n            }\n            else {\n                tableStyle += ('border-collapse:collapse;');\n            }\n            tagAttributes.push('cellpadding=\"' + '0\"');\n            if (!isNullOrUndefined(table.tableFormat.borders)) {\n                tableStyle += this.serializeTableBorderStyle(table.tableFormat.borders);\n            }\n        }\n        if (tableStyle.length !== 0) {\n            tagAttributes.push('style=\"', tableStyle.toString() + '\"');\n        }\n        return blockStyle += (this.createAttributesTag('table', tagAttributes));\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createTableEndTag = function () {\n        var blockStyle = '';\n        blockStyle += (this.endTag('table'));\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowStartTag = function (row) {\n        var blockStyle = '';\n        var tagAttributes = [];\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.createTag('thead'));\n        }\n        if (row.rowFormat.height > 0) {\n            tagAttributes.push('height=\"' + row.rowFormat.height + '\"');\n        }\n        return blockStyle + this.createAttributesTag('tr', tagAttributes);\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.createRowEndTag = function (row) {\n        var blockStyle = '';\n        blockStyle += (this.endTag('tr'));\n        if (row.rowFormat.isHeader) {\n            blockStyle += (this.endTag('thead'));\n        }\n        return blockStyle;\n    };\n    /**\n     * @private\n     */\n    HtmlExport.prototype.decodeHtmlNames = function (text) {\n        if (text === '\\t') {\n            return '&emsp;';\n        }\n        var splittedText = text.split(' ');\n        var htmlText = '';\n        if (splittedText.length > 0) {\n            htmlText = splittedText[0];\n            for (var i = 0; i < splittedText.length - 1; i++) {\n                htmlText += '&nbsp;' + splittedText[i + 1];\n            }\n        }\n        return htmlText;\n    };\n    return HtmlExport;\n}());\nexport { HtmlExport };\n","import { Widget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockContainer, BookmarkElementBox } from '../index';\nimport { HelperMethods } from '../index';\nimport { Point } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * @private\n */\nvar TextPosition = /** @class */ (function () {\n    function TextPosition(owner) {\n        /**\n         * @private\n         */\n        this.location = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.isUpdateLocation = true;\n        this.owner = owner;\n        this.viewer = this.owner.viewer;\n    }\n    Object.defineProperty(TextPosition.prototype, \"paragraph\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.currentWidget.paragraph;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphStart\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.offset === this.owner.selection.getStartOffset(this.paragraph);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"isAtParagraphEnd\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection.isParagraphLastLine(this.currentWidget)\n                && this.offset === this.owner.selection.getLineLength(this.currentWidget);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"selection\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.selection;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextPosition.prototype, \"hierarchicalPosition\", {\n        /**\n         * Gets the hierarchical position of logical text position in the document\n         * @returns {string}\n         */\n        get: function () {\n            return this.getHierarchicalIndexInternal();\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Return clone of current text position\n     * @private\n     */\n    TextPosition.prototype.clone = function () {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.currentWidget = this.currentWidget;\n        textPosition.offset = this.offset;\n        textPosition.location = this.location;\n        return textPosition;\n    };\n    /**\n     * Set text position for paragraph and inline\n     * @private\n     */\n    TextPosition.prototype.setPositionForSelection = function (line, element, index, physicalLocation) {\n        //Set the start end position\n        var isParagraphEnd = false;\n        if (isNullOrUndefined(element)) {\n            this.currentWidget = line;\n        }\n        else {\n            this.currentWidget = element.line;\n            if (element.nextNode instanceof FieldElementBox && index > element.length) {\n                isParagraphEnd = this.selection.isLastRenderedInline(element, element.length);\n            }\n        }\n        this.location = physicalLocation;\n        if (isParagraphEnd) {\n            this.offset = this.selection.getParagraphLength(this.currentWidget.paragraph) + 1;\n        }\n        else {\n            this.offset = this.currentWidget.getOffset(element, index);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPositionFromLine = function (line, offset, location) {\n        this.currentWidget = line;\n        this.offset = offset;\n        if (location instanceof Point) {\n            this.location.copy(location);\n        }\n    };\n    /**\n     * Set text position\n     * @private\n     */\n    TextPosition.prototype.setPosition = function (line, positionAtStart) {\n        this.currentWidget = line;\n        this.offset = positionAtStart ? this.selection.getStartOffset(line.paragraph)\n            : this.selection.getParagraphLength(line.paragraph) + 1;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Set position for text position\n     * @private\n     */\n    TextPosition.prototype.setPositionInternal = function (textPosition) {\n        this.currentWidget = textPosition.currentWidget;\n        this.offset = textPosition.offset;\n        this.location = textPosition.location;\n    };\n    /**\n     * Set position for current index\n     * @private\n     */\n    TextPosition.prototype.setPositionForCurrentIndex = function (hierarchicalIndex) {\n        var index = { index: hierarchicalIndex };\n        var paragraph = this.getParagraphWidget(index); //ref hierarchicalIndex\n        this.offset = parseFloat(index.index);\n        this.setPositionParagraph(paragraph, this.offset);\n    };\n    /**\n     * Get Page\n     */\n    TextPosition.prototype.getPage = function (position) {\n        var page;\n        var index = position.index.indexOf(';');\n        var newValue = '0';\n        if (index >= 0) {\n            newValue = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        index = parseInt(newValue, 10);\n        page = this.viewer.pages[index];\n        return page;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getParagraphWidget = function (position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var page = this.getPage(position);\n        var child = this.getLineWidget(undefined, position, page);\n        return child;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getLineWidget = function (widget, position, page) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        if (value === 'H' || value === 'F') {\n            if (value === 'H') {\n                widget = page.headerWidget;\n            }\n            else {\n                widget = page.footerWidget;\n            }\n        }\n        else if (!isNullOrUndefined(page)) {\n            widget = page.bodyWidgets[0];\n        }\n        index = parseInt(value, 10);\n        if (widget instanceof BlockContainer) {\n            index = position.index.indexOf(';');\n            value = '0';\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n            index = parseInt(value, 10);\n        }\n        if (widget instanceof TableRowWidget && index >= widget.childWidgets.length) {\n            position.index = '0;0';\n            index = widget.childWidgets.length - 1;\n        }\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[index];\n            if (child instanceof LineWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getLineWidget(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.getLineWidget(this.selection.getFirstParagraphInFirstCell(child), position);\n                    }\n                    else if (child instanceof TableRowWidget && position.index.indexOf(';') === -1) {\n                        return this.selection.getFirstParagraphInFirstCell(child.ownerTable).childWidgets[0];\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (widget.nextRenderedWidget instanceof Widget) {\n            position.index = '0';\n            if (widget.nextRenderedWidget instanceof TableWidget) {\n                return this.selection.getFirstParagraphInFirstCell(widget.nextRenderedWidget).firstChild;\n            }\n            return this.getLineWidget(widget.nextRenderedWidget, position);\n        }\n        return undefined;\n    };\n    /**\n     * Update physical location of paragraph\n     * @private\n     */\n    TextPosition.prototype.updatePhysicalPosition = function (moveNextLine) {\n        if (this.currentWidget && this.owner.isLayoutEnabled && this.isUpdateLocation) {\n            this.location = this.selection.getPhysicalPositionInternal(this.currentWidget, this.offset, moveNextLine);\n        }\n    };\n    /**\n     * Return true if text position are in same paragraph and offset\n     * @private\n     */\n    TextPosition.prototype.isAtSamePosition = function (textPosition) {\n        return this.currentWidget === textPosition.currentWidget\n            && this.offset === textPosition.offset;\n    };\n    /**\n     * Return true if text position is in same paragraph\n     * @private\n     */\n    TextPosition.prototype.isInSameParagraph = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        return this.paragraph === textPosition.paragraph;\n    };\n    /**\n     * Return true is current text position exist before given text position\n     * @private\n     */\n    TextPosition.prototype.isExistBefore = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset < textPosition.offset;\n        }\n        var currentParagraph = this.currentWidget.paragraph;\n        var paragraph = textPosition.currentWidget.paragraph;\n        if (currentParagraph === paragraph) {\n            return currentParagraph.childWidgets.indexOf(this.currentWidget) < paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        if (currentParagraph.containerWidget === paragraph.containerWidget) {\n            if (currentParagraph.isInsideTable) {\n                return currentParagraph.associatedCell.childWidgets.indexOf(currentParagraph) <\n                    paragraph.associatedCell.childWidgets.indexOf(paragraph);\n                //handle after header footer implementation\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) <\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph)) <\n                    (paragraph.containerWidget.childWidgets.indexOf(paragraph));\n            }\n        }\n        return this.owner.selection.isExistBefore(currentParagraph, paragraph);\n    };\n    /**\n     * Return true is current text position exist after given text position\n     * @private\n     */\n    TextPosition.prototype.isExistAfter = function (textPosition) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        if (this.currentWidget === textPosition.currentWidget) {\n            return this.offset > textPosition.offset;\n        }\n        if (this.currentWidget.paragraph === textPosition.currentWidget.paragraph) {\n            return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget) >\n                textPosition.currentWidget.paragraph.childWidgets.indexOf(textPosition.currentWidget);\n        }\n        var startParagraph = this.currentWidget.paragraph;\n        var endParagraph = textPosition.currentWidget.paragraph;\n        if (startParagraph.containerWidget.index === endParagraph.containerWidget.index) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n                // } else if ((this.currentParagraph).owner instanceof WHeaderFooter) {\n                //     return ((this.currentParagraph).owner as WHeaderFooter).blocks.indexOf((this.currentParagraph)) >\n                //         ((textPosition.currentParagraph).owner as WHeaderFooter).blocks.indexOf((textPosition.currentParagraph));\n            }\n            else {\n                return (startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    (endParagraph.containerWidget.childWidgets.indexOf(endParagraph)));\n            }\n        }\n        return this.owner.selection.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Return hierarchical index of current text position\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndexInternal = function () {\n        return this.getHierarchicalIndex(this.currentWidget, this.offset.toString());\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.getHierarchicalIndex = function (line, hierarchicalIndex) {\n        var node = line;\n        if (node) {\n            return node.getHierarchicalIndex(hierarchicalIndex);\n        }\n        return hierarchicalIndex;\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionParagraph = function (line, offsetInLine) {\n        this.currentWidget = line;\n        this.offset = offsetInLine;\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.setPositionForLineWidget = function (lineWidget, offset) {\n        var lineLength = this.selection.getLineLength(lineWidget);\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        if (lineWidget.isLastLine()) {\n            lineLength = lineLength + 1;\n        }\n        if (offset > lineLength) {\n            var nextLineWidget = void 0;\n            if (lineIndex >= lineWidget.paragraph.childWidgets.length - 1) {\n                var nextBlock = this.selection.getNextRenderedBlock(lineWidget.paragraph);\n                if (nextBlock && nextBlock.index === lineWidget.paragraph.index) {\n                    nextLineWidget = nextBlock.firstChild;\n                }\n            }\n            else {\n                nextLineWidget = lineWidget.paragraph.childWidgets[lineIndex + 1];\n            }\n            this.setPositionForLineWidget(nextLineWidget, offset - lineLength);\n            return;\n        }\n        else if (offset < 0) {\n            var prevLine = lineWidget.paragraph.childWidgets[lineIndex - 1];\n            var currentOffSet = this.selection.getLineLength(prevLine) + offset;\n            this.setPositionForLineWidget(prevLine, currentOffSet);\n            return;\n        }\n        else {\n            this.currentWidget = lineWidget;\n            this.offset = offset;\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move to next text position\n     * @private\n     */\n    TextPosition.prototype.moveNextPosition = function (isNavigate) {\n        if (isNullOrUndefined(isNavigate)) {\n            isNavigate = true;\n        }\n        var inline = this.selection.getNextStartInline(this.currentWidget, this.offset);\n        if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n            if (isNavigate) {\n                this.moveNextPositionInternal(inline);\n                this.moveNextPosition();\n                return;\n            }\n            else {\n                var line = inline.fieldEnd.line;\n                var fieldEnd = inline.fieldEnd;\n                var fieldEndOffset = line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(line, fieldEndOffset.toString());\n                if (TextPosition.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(), fieldEndIndex)) {\n                    //If field end is after selection end, extend selection end to field end.\n                    this.selection.end.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                this.moveToInline(inline.fieldEnd, 1);\n            }\n        }\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var index = 0;\n        if (nextOffset > this.offset) {\n            this.offset = nextOffset;\n            var info = this.currentWidget.getInline(this.offset, index);\n            inline = info.element;\n            index = info.index;\n            if (!isNullOrUndefined(inline) && index === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n            }\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                this.offset++;\n            }\n        }\n        else {\n            this.updateOffsetToNextParagraph(index, false);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move text position to previous paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousParagraphInTable = function (selection) {\n        var previousParagraph;\n        var currentPara = this.currentWidget.paragraph;\n        if (currentPara.isInsideTable) {\n            previousParagraph = selection.getPreviousSelectionCell(currentPara.associatedCell);\n        }\n        else {\n            previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n        }\n        if (isNullOrUndefined(previousParagraph)) {\n            return;\n        }\n        this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    TextPosition.prototype.updateOffsetToNextParagraph = function (indexInInline, isHighlight) {\n        //Moves to owner and get next paragraph.\n        var inline;\n        var positionAtStart = false;\n        var nextParagraph = undefined;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (!isHighlight) {\n            nextParagraph = this.selection.getNextParagraphBlock(this.paragraph);\n        }\n        else if (lineIndex + 1 < this.paragraph.childWidgets.length) {\n            var nextLineWidget = this.paragraph.childWidgets[lineIndex + 1];\n            if (nextLineWidget) {\n                this.currentWidget = nextLineWidget;\n                this.offset = 0;\n            }\n        }\n        else {\n            nextParagraph = this.selection.getNextSelectionBlock(this.paragraph);\n            if (!isNullOrUndefined(nextParagraph)) {\n                if (nextParagraph.containerWidget instanceof TableCellWidget) {\n                    if (this.selection.start.paragraph.isInsideTable) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, nextParagraph.associatedCell);\n                        positionAtStart = !containerCell.ownerTable.contains(nextParagraph.associatedCell);\n                    }\n                    else {\n                        positionAtStart = true;\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(nextParagraph) && nextParagraph.childWidgets.length > 0) {\n            if (!positionAtStart) {\n                this.currentWidget = nextParagraph.firstChild;\n                this.offset = isHighlight ? 1 : this.selection.getStartLineOffset(this.currentWidget);\n            }\n            else {\n                this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n                this.offset = this.selection.getLineLength(this.currentWidget) + 1;\n            }\n        }\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n    };\n    TextPosition.prototype.updateOffsetToPrevPosition = function (index, isHighlight) {\n        var inlineInfo;\n        var inline;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        var prevOffset = this.selection.getPreviousValidOffset(this.currentWidget.paragraph, this.offset);\n        if (this.offset > prevOffset) {\n            this.offset = prevOffset;\n        }\n        else if (lineIndex > 0) {\n            var prevLineWidget = this.paragraph.childWidgets[lineIndex - 1];\n            if (prevLineWidget) {\n                this.currentWidget = prevLineWidget;\n                this.offset = this.currentWidget.getEndOffset();\n            }\n        }\n        else {\n            //Moves to owner and get previous paragraph.\n            var previousParagraph = undefined;\n            var positionAtStart = false;\n            if (!isHighlight) {\n                previousParagraph = this.selection.getPreviousParagraphBlock(this.paragraph);\n            }\n            else {\n                previousParagraph = this.selection.getPreviousSelectionBlock(this.paragraph);\n                if (!isNullOrUndefined(previousParagraph)) {\n                    if (previousParagraph.containerWidget instanceof TableCellWidget) {\n                        if (this.selection.start.paragraph.isInsideTable) {\n                            // tslint:disable-next-line:max-line-length\n                            var containerCell = this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell, previousParagraph.associatedCell);\n                            positionAtStart = !containerCell.ownerTable.contains(previousParagraph.associatedCell);\n                        }\n                        else {\n                            positionAtStart = true;\n                        }\n                    }\n                }\n            }\n            if (!isNullOrUndefined(previousParagraph)) {\n                if (!positionAtStart) {\n                    this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n                else {\n                    this.currentWidget = previousParagraph.firstChild;\n                    this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                }\n            }\n        }\n        index = 0;\n        inlineInfo = this.currentWidget.getInline(this.offset, index);\n        inline = inlineInfo.element;\n        index = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            this.offset++;\n        }\n        if (inline instanceof FieldElementBox) {\n            //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n            var previousInline = this.selection.getPreviousValidElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                inline = previousInline;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, inline.length);\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    this.offset--;\n                }\n            }\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the next paragraph.\n     */\n    TextPosition.prototype.moveToNextParagraphStartInternal = function () {\n        var paragraph = this.currentWidget.paragraph;\n        if (!isNullOrUndefined(this.selection.getNextParagraphBlock(paragraph))) {\n            // tslint:disable-next-line:max-line-length\n            this.currentWidget = this.selection.getNextParagraphBlock(paragraph).firstChild;\n            this.offset = this.selection.getStartOffset(paragraph);\n            this.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Move to previous position\n     * @private\n     */\n    TextPosition.prototype.movePreviousPosition = function () {\n        var index = 0;\n        var inlineInfo = this.currentWidget.getInline(this.offset, index);\n        var inline = inlineInfo.element;\n        index = inlineInfo.index;\n        var lineIndex = this.paragraph.childWidgets.indexOf(this.currentWidget);\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(index, false);\n    };\n    /**\n     * Move to next position\n     * @private\n     */\n    TextPosition.prototype.moveNextPositionInternal = function (fieldBegin) {\n        var inline;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            this.currentWidget = inline.line;\n            // tslint:disable-next-line:max-line-length\n            if (this.currentWidget === fieldBegin.fieldEnd.line && !this.selection.hasValidInline(this.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, 1);\n    };\n    /**\n     * Move text position backward\n     * @private\n     */\n    TextPosition.prototype.moveBackward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!this.owner.selection.isEmpty && !isNullOrUndefined(inline)) {\n            var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldEndOffset = nextInline.fieldEnd.line.getOffset(nextInline.fieldEnd, 1);\n                // tslint:disable-next-line:max-line-length\n                var fieldEndIndex = this.getHierarchicalIndex(nextInline.fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, hierarchicalIndex)) {\n                    //If field end is after selection start, move selection start to field end.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(nextInline.fieldEnd.line, fieldEndOffset);\n                    return;\n                }\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n            var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var fieldEndOffset = inline.line.getOffset(inline, 1);\n            var fieldEndIndex = this.getHierarchicalIndex(inline.line, fieldEndOffset.toString());\n            if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldEndIndex)) {\n                //If field end is after selection start, extend selection end to field begin.\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                this.currentWidget = inline.fieldBegin.line;\n                this.offset = fieldBeginOffset;\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n            this.movePreviousPositionInternal(inline);\n        }\n        this.updateOffsetToPrevPosition(indexInInline, true);\n    };\n    /**\n     * Move text position forward\n     * @private\n     */\n    TextPosition.prototype.moveForward = function () {\n        var indexInInline = 0;\n        var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline)) {\n            if (!this.owner.selection.isEmpty && indexInInline === inline.length && inline instanceof FieldElementBox\n                && inline.fieldType === 1) {\n                var hierarchicalIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginOffset = inline.fieldBegin.line.getOffset(inline.fieldBegin, 0);\n                // tslint:disable-next-line:max-line-length\n                var fieldBeginIndex = this.getHierarchicalIndex(inline.fieldBegin.line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(hierarchicalIndex, fieldBeginIndex)) {\n                    //If field begin is before selection start, move selection start to field begin.\n                    // tslint:disable-next-line:max-line-length\n                    this.owner.selection.start.setPositionParagraph(inline.fieldBegin.line, fieldBeginOffset);\n                    return;\n                }\n            }\n            inline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n        }\n        if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n            var selectionStartParagraph = this.owner.selection.start.paragraph;\n            var selectionStartIndex = 0;\n            // tslint:disable-next-line:max-line-length\n            var selectionStartInlineObj = selectionStartParagraph.getInline(this.owner.selection.start.offset, selectionStartIndex);\n            var selectionStartInline = selectionStartInlineObj.element;\n            selectionStartIndex = selectionStartInlineObj.index;\n            var nextRenderInline = this.selection.getNextRenderedElementBox(selectionStartInline, selectionStartIndex);\n            if (nextRenderInline === inline) {\n                this.moveNextPositionInternal(inline);\n            }\n            else {\n                //If selection start is before field begin, extend selection end to field end.\n                inline = inline.fieldEnd;\n                this.currentWidget = inline.line;\n                this.offset = this.currentWidget.getOffset(inline, 1);\n                //Updates physical position in current page.\n                this.updatePhysicalPosition(true);\n                return;\n            }\n        }\n        else if ((inline instanceof FieldElementBox)\n            && (inline.fieldType === 0 || inline.fieldType === 1)) {\n            this.currentWidget = inline.line;\n            this.offset = this.currentWidget.getOffset(inline, 1);\n        }\n        indexInInline = 0;\n        var nextOffset = this.selection.getNextValidOffset(this.currentWidget, this.offset);\n        var length = this.selection.getLineLength(this.currentWidget);\n        var isParagraphEnd = this.selection.isParagraphLastLine(this.currentWidget);\n        if (this.offset < nextOffset) {\n            this.offset = nextOffset;\n            var inlineObj_1 = this.currentWidget.getInline(this.offset, indexInInline);\n            inline = inlineObj_1.element;\n            indexInInline = inlineObj_1.index;\n            if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n                var nextValidInline = this.selection.getNextValidElement(inline.nextNode);\n                //Moves to field end mark.\n                if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 1) {\n                    inline = nextValidInline;\n                    this.offset = this.currentWidget.getOffset(inline, 1);\n                }\n            }\n        }\n        else if (this.offset === nextOffset && this.offset < length + 1 && isParagraphEnd) {\n            this.offset = length + 1;\n        }\n        else {\n            this.updateOffsetToNextParagraph(indexInInline, true);\n        }\n        //Gets physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to given inline\n     * @private\n     */\n    TextPosition.prototype.moveToInline = function (inline, index) {\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, index);\n        //Updates physical position in current page.\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Return true is start element exist before end element\n     * @private\n     */\n    TextPosition.isForwardSelection = function (start, end) {\n        if (start === end) {\n            return true;\n        }\n        start = start.replace(/C;/g, '');\n        end = end.replace(/C;/g, '');\n        start = start.replace(/H;/g, '');\n        end = end.replace(/H;/g, '');\n        start = start.replace(/F;/g, '');\n        end = end.replace(/F;/g, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        var length = selectionStart.length;\n        if (length > selectionEnd.length) {\n            length = selectionEnd.length - 1;\n        }\n        for (var i = 0; i < length; i++) {\n            var startOffset = parseFloat(selectionStart[i]);\n            var endOffset = parseFloat(selectionEnd[i]);\n            if (startOffset !== endOffset) {\n                return startOffset < endOffset;\n            }\n        }\n        return false;\n    };\n    /**\n     * Move to previous position offset\n     * @private\n     */\n    TextPosition.prototype.movePreviousPositionInternal = function (fieldEnd) {\n        var inline;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            inline = this.selection.getPreviousValidElement(fieldEnd.fieldBegin);\n        }\n        else {\n            inline = this.selection.getPreviousValidElement(fieldEnd);\n        }\n        this.currentWidget = inline.line;\n        this.offset = this.currentWidget.getOffset(inline, inline instanceof FieldElementBox ? 0 : inline.length);\n    };\n    /**\n     * Moves the text position to start of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordStartInternal = function (type) {\n        var endOffset = this.currentWidget.getEndOffset();\n        var currentPara = this.currentWidget.paragraph;\n        var selection = this.selection;\n        if (type === 2 && (this.offset === endOffset || this.offset === endOffset + 1)) {\n            return;\n        }\n        if (this.offset === endOffset + 1) {\n            this.offset = endOffset;\n        }\n        else if (this.offset === selection.getStartOffset(currentPara) && this.currentWidget === currentPara.childWidgets[0]) {\n            var previousParagraph = selection.getPreviousParagraphBlock(currentPara);\n            if (isNullOrUndefined(previousParagraph)) {\n                return;\n            }\n            this.currentWidget = previousParagraph.childWidgets[previousParagraph.childWidgets.length - 1];\n            this.offset = this.currentWidget.getEndOffset();\n        }\n        else {\n            if (this.offset === selection.getStartLineOffset(this.currentWidget)) {\n                var lineIndex = currentPara.childWidgets.indexOf(this.currentWidget);\n                if (lineIndex - 1 >= 0) {\n                    this.currentWidget = currentPara.childWidgets[lineIndex - 1];\n                    this.offset = this.currentWidget.getEndOffset();\n                }\n            }\n            var isStarted = false;\n            var endSelection = false;\n            var indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length           \n            this.getPreviousWordOffset(inline, selection, indexInInline, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, this);\n        }\n        if (type === 1) {\n            this.calculateOffset();\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Get next word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffset = function (inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (inline instanceof TextElementBox) {\n            this.getNextWordOffsetSpan(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetImage(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldBegin(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2 || inline instanceof BookmarkElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldEnd(inline, indexInInline, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldBegin = function (fieldBegin, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            this.getNextWordOffsetFieldEnd(fieldBegin.fieldEnd, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (type === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffsetFieldSeperator(fieldBegin.fieldSeparator, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n        else if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n            var inline = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            if (inline.line.paragraph === fieldBegin.fieldEnd.line.paragraph && !this.selection.hasValidInline(inline.line.paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getNextWordOffset(inline, 0, type, !(endPosition.paragraph === fieldBegin.line.paragraph && endPosition.offset === startOffset), endSelection, endPosition, excludeSpace);\n            // tslint:disable-next-line:max-line-length\n            if (endSelection && !isNullOrUndefined(fieldBegin.fieldSeparator) && (endPosition.paragraph === fieldBegin.line.paragraph) && (endPosition.offset === fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length))) {\n                endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldBegin.fieldEnd.line, fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, fieldBegin.fieldEnd.length));\n            }\n        }\n    };\n    /**\n     * get next word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetImage = function (image, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === 0) {\n            var startOffset = image.line.getOffset(image, 0);\n            endSelection = true;\n            if (endPosition.offset === startOffset) {\n                if (isNullOrUndefined(image.nextNode)) {\n                    endPosition.setPositionParagraph(image.line, startOffset + image.length);\n                }\n                else {\n                    this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, startOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.nextNode)) {\n            this.getNextWordOffset(image.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from span\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetSpan = function (span, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === 0) {\n                endSelection = true;\n                var startOffset = span.line.getOffset(span, 0);\n                if (endPosition.offset === startOffset) {\n                    endPosition.setPositionParagraph(span.line, startOffset + span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, startOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n        else {\n            var wordEndIndex = 0;\n            if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0]) === -1)) {\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                if (isInField) {\n                    return;\n                }\n            }\n            else if (indexInInline < span.length) {\n                // tslint:disable-next-line:max-line-length\n                var txt = indexInInline > 0 && span.text.length - 1 >= indexInInline ? span.text.slice(indexInInline, span.length) : span.text;\n                wordEndIndex = HelperMethods.indexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordEndIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    var offset = span.line.getOffset(span, wordEndIndex + indexInInline);\n                    // tslint:disable-next-line:max-line-length\n                    if ((excludeSpace || txt[wordEndIndex] !== ' ') && !endSelection && span.line.paragraph === endPosition.paragraph && offset !== endPosition.offset) {\n                        endSelection = true;\n                        endPosition.setPositionParagraph(span.line, offset);\n                        return;\n                    }\n                    wordEndIndex++;\n                    while (wordEndIndex < txt.length && HelperMethods.wordSplitCharacters.indexOf(txt[wordEndIndex]) !== -1) {\n                        if (txt[wordEndIndex] !== ' ' && txt[wordEndIndex] !== 'ã€€') {\n                            break;\n                        }\n                        wordEndIndex++;\n                    }\n                    endSelection = true;\n                    if (wordEndIndex < txt.length) {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                    else if (!isNullOrUndefined(span.nextNode)) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                    }\n                    else {\n                        // tslint:disable-next-line:max-line-length\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, wordEndIndex + indexInInline));\n                    }\n                }\n                else if (!isNullOrUndefined(span.nextNode)) {\n                    this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, span.line.getEndOffset());\n                }\n            }\n            else if (!isNullOrUndefined(span.nextNode)) {\n                this.getNextWordOffset(span.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n            }\n        }\n    };\n    /**\n     * get next word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldSeperator = function (fieldSeparator, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(fieldSeparator.nextNode)) {\n            this.getNextWordOffset(fieldSeparator.nextNode, 0, type, isInField, endSelection, endPosition, excludeSpace);\n        }\n    };\n    /**\n     * get next word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getNextWordOffsetFieldEnd = function (fieldEnd, indexInInline, type, isInField, endSelection, endPosition, excludeSpace) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (endPosition.offset === startOffset) {\n            endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n            if (isNullOrUndefined(fieldEnd.nextNode)) {\n                return;\n            }\n        }\n        if (!isNullOrUndefined(fieldEnd.nextNode)) {\n            this.getNextWordOffset(fieldEnd.nextNode, 0, type, false, endSelection, endPosition, excludeSpace);\n            if (endPosition.offset === endOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldEnd.line, startOffset);\n        }\n        endSelection = true;\n    };\n    /**\n     * Get previous word offset\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffset = function (inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (inline instanceof TextElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ImageElementBox) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetImage(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldBegin(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldSeparator(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetFieldEnd(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof BookmarkElementBox) {\n            this.getPreviousWordOffsetBookMark(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (inline instanceof ListTextElementBox && inline.previousNode) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffsetSpan(inline.previousNode, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetBookMark = function (bookmark, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (bookmark.previousNode) {\n            if (bookmark.previousNode instanceof TextElementBox) {\n                var inline = bookmark.previousNode;\n                if (HelperMethods.lastIndexOfAny(inline.text, HelperMethods.wordSplitCharacters) !== inline.text.length - 1) {\n                    this.getPreviousWordOffset(inline, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n                else {\n                    endPosition.setPositionParagraph(bookmark.line, bookmark.line.getOffset(bookmark, 0));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(bookmark.line, selection.getStartLineOffset(bookmark.line));\n        }\n    };\n    /**\n     * get previous word offset from field end\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldEnd = function (fieldEnd, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldEnd.line.getOffset(fieldEnd, 0);\n        var endOffset = startOffset + fieldEnd.length;\n        if (isNullOrUndefined(fieldEnd.fieldSeparator)) {\n            this.getPreviousWordOffsetFieldBegin(fieldEnd.fieldBegin, selection, 0, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else if (type === 0 && !isNullOrUndefined(fieldEnd.previousNode)) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, (inline instanceof FieldElementBox && inline.fieldType === 1), isStarted, endSelection, endPosition);\n        }\n        else if (!isNullOrUndefined(fieldEnd.fieldBegin) && type !== 0) {\n            var inline = fieldEnd.previousNode;\n            // tslint:disable-next-line:max-line-length\n            if (isNullOrUndefined(inline) || (inline.line.paragraph === fieldEnd.fieldBegin.line.paragraph && !selection.hasValidInline(inline.line.paragraph, inline, fieldEnd.fieldBegin))) {\n                inline = fieldEnd.fieldBegin;\n            }\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(inline, selection, inline.length, type, !(endPosition.paragraph === fieldEnd.line.paragraph && endPosition.offset === endOffset), isStarted, endSelection, endPosition);\n            if (endSelection && endPosition.paragraph === fieldEnd.line.paragraph\n                && endPosition.offset === startOffset) {\n                endPosition.setPositionParagraph(fieldEnd.line, endOffset);\n                return;\n            }\n            if (!endSelection) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.setPositionParagraph(fieldEnd.fieldBegin.line, fieldEnd.fieldBegin.line.getOffset(fieldEnd.fieldBegin, 0));\n            }\n        }\n    };\n    /**\n     * get previous word offset from field separator\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldSeparator = function (fieldSeparator, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        this.getPreviousWordOffsetFieldBegin(fieldSeparator.fieldBegin, selection, fieldSeparator.fieldBegin.length, type, isInField, isStarted, endSelection, endPosition);\n    };\n    /**\n     * get previous word offset from field begin\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetFieldBegin = function (fieldBegin, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        var startOffset = fieldBegin.line.getOffset(fieldBegin, 0);\n        var endOffset = startOffset + fieldBegin.length;\n        if (endPosition.offset === endOffset) {\n            endPosition.setPositionParagraph(fieldBegin.line, startOffset);\n        }\n        if (!isNullOrUndefined(fieldBegin.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(fieldBegin.previousNode, selection, fieldBegin.previousNode.length, type, false, isStarted, endSelection, endPosition);\n            if (endPosition.offset === startOffset) {\n                if (type !== 0 && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    // tslint:disable-next-line:max-line-length\n                    endPosition.setPositionParagraph(fieldBegin.line, fieldBegin.fieldSeparator.line.getOffset(fieldBegin.fieldSeparator, fieldBegin.fieldSeparator.length));\n                }\n            }\n        }\n        else {\n            endPosition.setPositionParagraph(fieldBegin.line, selection.getStartLineOffset(fieldBegin.line));\n        }\n    };\n    /**\n     * get previous word offset from image\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.getPreviousWordOffsetImage = function (image, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (isInField) {\n            endPosition.setPositionParagraph(image.line, image.line.getOffset(image, indexInInline));\n            endSelection = false;\n            return;\n        }\n        if (indexInInline === image.length) {\n            var endOffset = image.line.getOffset(image, image.length);\n            if (endOffset === endPosition.offset) {\n                endPosition.setPositionParagraph(image.line, endOffset - image.length);\n            }\n            else {\n                endPosition.setPositionParagraph(image.line, endOffset);\n            }\n        }\n        else if (!isNullOrUndefined(image.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(image.previousNode, selection, image.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n    };\n    /**\n     * Get previous word offset from span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length   \n    TextPosition.prototype.getPreviousWordOffsetSpan = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.text === '\\t' || span.text === '\\v') {\n            if (isInField) {\n                endSelection = false;\n                return;\n            }\n            if (indexInInline === span.length) {\n                endSelection = true;\n                var endOffset = span.line.getOffset(span, span.length);\n                if (endOffset === endPosition.offset) {\n                    endPosition.setPositionParagraph(span.line, endOffset - span.length);\n                }\n                else {\n                    endPosition.setPositionParagraph(span.line, endOffset);\n                }\n            }\n            else if (!isNullOrUndefined(span.previousNode)) {\n                // tslint:disable-next-line:max-line-length\n                this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n        else {\n            var wordStartIndex = 0;\n            if (!isStarted) {\n                while (indexInInline > 0 && span.text[indexInInline - 1] === ' ') {\n                    indexInInline--;\n                }\n                endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n            }\n            if (indexInInline > 0) {\n                isStarted = true;\n                if (indexInInline === 0 && endSelection && (HelperMethods.wordSplitCharacters.indexOf(span.text[0])) === -1) {\n                    endPosition.setPositionParagraph(span.line, span.line.getOffset(span, indexInInline));\n                    endSelection = true;\n                    return;\n                }\n                var txt = span.text.length > indexInInline ? span.text.slice(0, indexInInline) : span.text;\n                wordStartIndex = HelperMethods.lastIndexOfAny(txt, HelperMethods.wordSplitCharacters);\n                if (wordStartIndex !== -1) {\n                    if (isInField) {\n                        endSelection = false;\n                        return;\n                    }\n                    while (wordStartIndex > 0 && endSelection && txt[wordStartIndex] !== ' '\n                        && (HelperMethods.wordSplitCharacters.indexOf(txt[wordStartIndex - 1])) !== -1) {\n                        wordStartIndex--;\n                    }\n                    if (txt[wordStartIndex] === ' ' || txt[wordStartIndex] === 'ã€€' || !endSelection) {\n                        wordStartIndex++;\n                    }\n                    endSelection = true;\n                    if (wordStartIndex > 0) {\n                        var offset = span.line.getOffset(span, wordStartIndex);\n                        if (span.line.paragraph === endPosition.paragraph && offset === endPosition.offset) {\n                            // tslint:disable-next-line:max-line-length\n                            this.getPreviousWordOffsetSpan(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                        }\n                        else {\n                            endPosition.setPositionParagraph(span.line, offset);\n                        }\n                    }\n                    else if (span.previousNode instanceof TextElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n                    }\n                    else {\n                        endPosition.setPositionParagraph(span.line, span.line.getOffset(span, 0));\n                    }\n                }\n                else {\n                    this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n                }\n            }\n            else {\n                this.setPreviousWordOffset(span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition);\n            }\n        }\n    };\n    /**\n     * set previous word offset in span\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    TextPosition.prototype.setPreviousWordOffset = function (span, selection, indexInInline, type, isInField, isStarted, endSelection, endPosition) {\n        if (span.previousNode instanceof ElementBox && span.line === span.previousNode.line) {\n            // tslint:disable-next-line:max-line-length\n            this.getPreviousWordOffset(span.previousNode, selection, span.previousNode.length, type, isInField, isStarted, endSelection, endPosition);\n        }\n        else {\n            endPosition.setPositionParagraph(span.line, selection.getStartLineOffset(span.line));\n        }\n    };\n    /**\n     * Validate if text position is in field forward\n     * @private\n     */\n    TextPosition.prototype.validateForwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var isPositionMoved = false;\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(currentIndex, selectionEndIndex)) {\n            if (!isPositionMoved) {\n                textPosition.moveNextPosition(false);\n                var nextIndex = textPosition.getHierarchicalIndexInternal();\n                //Handled specifically to break infinite looping, if selection ends at last paragraph mark.\n                if (currentIndex === nextIndex) {\n                    break;\n                }\n            }\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n                if (indexInInline === inline.length && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    if (inline.line.getOffset(inline, 0) === this.offset) {\n                        return;\n                    }\n                    var lineWidget = inline.fieldBegin.line;\n                    var fieldBeginOffset = lineWidget.getOffset(inline.fieldBegin, 0);\n                    var fieldBeginIndex = this.getHierarchicalIndex(lineWidget, fieldBeginOffset.toString());\n                    if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n                        this.selection.start.setPositionParagraph(lineWidget, fieldBeginOffset);\n                    }\n                }\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (!isNullOrUndefined(nextInline) && nextInline instanceof ElementBox) {\n                    inline = nextInline;\n                }\n            }\n            isPositionMoved = (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd));\n            if (isPositionMoved) {\n                if (inline.line.getOffset(inline, 0) === this.offset) {\n                    return;\n                }\n                var fieldEnd = inline.fieldEnd;\n                var paragraph = fieldEnd.line.paragraph;\n                var fieldEndOffset = fieldEnd.line.getOffset(fieldEnd, 1);\n                var fieldEndIndex = this.getHierarchicalIndex(fieldEnd.line, fieldEndOffset.toString());\n                if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n                    //If selection end is after field begin, extend selection end to field end.\n                    this.moveToInline(inline.fieldEnd, 1);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldEnd, 1);\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * Validate if text position is in field backward\n     * @private\n     */\n    TextPosition.prototype.validateBackwardFieldSelection = function (currentIndex, selectionEndIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(currentIndex);\n        textPosition.isUpdateLocation = false;\n        var selectionStartIndex = this.selection.start.getHierarchicalIndexInternal();\n        while (currentIndex !== selectionEndIndex && TextPosition.isForwardSelection(selectionEndIndex, currentIndex)) {\n            var indexInInline = 0;\n            var inlineObj = textPosition.currentWidget.getInline(textPosition.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                var nextInline = this.selection.getNextRenderedElementBox(inline, indexInInline);\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n                    var paragraph = nextInline.fieldEnd.line;\n                    var fieldEndOffset = paragraph.getOffset(nextInline.fieldEnd, 1);\n                    var fieldEndIndex = this.getHierarchicalIndex(paragraph, fieldEndOffset.toString());\n                    if (!TextPosition.isForwardSelection(fieldEndIndex, selectionStartIndex)) {\n                        this.selection.start.setPositionParagraph(paragraph, fieldEndOffset);\n                        selectionStartIndex = fieldEndIndex;\n                    }\n                }\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                var line = inline.fieldBegin.line;\n                var fieldBegin = inline.fieldBegin;\n                var fieldBeginOffset = line.getOffset(fieldBegin, 0);\n                var fieldBeginIndex = this.getHierarchicalIndex(line, fieldBeginOffset.toString());\n                if (!TextPosition.isForwardSelection(selectionEndIndex, fieldBeginIndex)) {\n                    //If field begin is before selection end, extend selection end to field begin.\n                    this.moveToInline(inline.fieldBegin, 0);\n                    return;\n                }\n                textPosition.moveToInline(inline.fieldBegin, 0);\n            }\n            else {\n                textPosition.movePreviousPosition();\n            }\n            currentIndex = textPosition.getHierarchicalIndexInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.paragraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var offset = selection.getStartLineOffset(this.currentWidget);\n        if (this.offset === offset && moveToPreviousParagraph) {\n            var startParagraph = this.moveToNextParagraphInTableCheck();\n            if (startParagraph) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n                var paragraphValue = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = paragraphValue.childWidgets[0];\n                this.offset = selection.getStartLineOffset(this.currentWidget);\n            }\n        }\n        else {\n            this.currentWidget = this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0];\n            this.offset = offset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.calculateOffset = function () {\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Moves the text position to start of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphStartInternal = function (selection, moveToPreviousParagraph) {\n        var startOffset = selection.getStartOffset(this.paragraph);\n        if (this.offset === startOffset && moveToPreviousParagraph) {\n            var paragraphstart = this.moveToNextParagraphInTableCheck();\n            if (paragraphstart) {\n                this.moveToPreviousParagraphInTable(selection);\n            }\n            else if (!isNullOrUndefined(selection.getPreviousParagraphBlock(this.paragraph))) {\n                this.currentWidget = selection.getPreviousParagraphBlock(this.paragraph).firstChild;\n                this.offset = selection.getStartOffset(this.paragraph);\n            }\n        }\n        else {\n            this.currentWidget = this.paragraph.firstChild;\n            this.offset = selection.getStartLineOffset(this.currentWidget);\n        }\n        var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            this.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n        }\n        this.updatePhysicalPosition(false);\n    };\n    /**\n     * Moves the text position to end of the paragraph.\n     * @private\n     */\n    TextPosition.prototype.moveToParagraphEndInternal = function (selection, moveToNextParagraph) {\n        // tslint:disable-next-line:max-line-length\n        var splittedParagraph = this.currentWidget.paragraph;\n        while (splittedParagraph.nextSplitWidget) {\n            splittedParagraph = splittedParagraph.nextSplitWidget;\n        }\n        this.currentWidget = splittedParagraph.childWidgets[splittedParagraph.childWidgets.length - 1];\n        var endOffset = this.currentWidget.getEndOffset() + 1;\n        if (this.offset === endOffset && moveToNextParagraph) {\n            var paragraphEnd = this.moveToNextParagraphInTableCheck();\n            if (paragraphEnd) {\n                this.moveToNextParagraphInTable();\n            }\n            else if (!isNullOrUndefined(selection.getNextParagraphBlock(this.currentWidget.paragraph))) {\n                var endParagraph = selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                this.currentWidget = endParagraph.childWidgets[endParagraph.childWidgets.length - 1];\n                this.offset = this.currentWidget.getEndOffset() + 1;\n            }\n        }\n        else {\n            this.offset = endOffset;\n        }\n        this.calculateOffset();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveUp = function (selection, left) {\n        var paragraph = this.currentWidget.paragraph;\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        //Moves previous line starting.\n        this.movePreviousPosition();\n        var prevLine = undefined;\n        var currentParagraph = this.currentWidget.paragraph;\n        if (paragraph.isInsideTable && paragraph !== currentParagraph && paragraph.associatedCell !== currentParagraph.associatedCell\n            // tslint:disable-next-line:max-line-length\n            && (!isNullOrUndefined(currentParagraph.associatedCell) && (paragraph.associatedCell.ownerRow === currentParagraph.associatedCell.ownerRow))) {\n            var ownerRow = currentParagraph.associatedCell.ownerRow;\n            if (ownerRow.previousRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(ownerRow.previousRenderedWidget, currentParagraph.associatedCell, left, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else {\n                var prevBlock = ownerRow.ownerTable.previousRenderedWidget;\n                do {\n                    if (prevBlock instanceof TableWidget) {\n                        prevBlock = selection.getLastBlockInLastCell(prevBlock);\n                    }\n                } while (prevBlock instanceof TableWidget);\n                if (prevBlock instanceof ParagraphWidget) {\n                    this.setPosition(prevBlock.childWidgets[prevBlock.childWidgets.length - 1], false);\n                }\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!paragraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (paragraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && paragraph.associatedCell.ownerRow.previousRenderedWidget !== paragraph.associatedCell.ownerRow.previousSplitWidget &&\n                paragraph.associatedCell.ownerRow.previousRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = selection.getTop(prevLine);\n        selection.updateTextPositionWidget(prevLine, new Point(left, top), this, false);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveDown = function (selection, left) {\n        //Moves text position to end of line.\n        var prevParagraph = this.currentWidget.paragraph;\n        var prevOffset = this.offset;\n        this.moveToLineEndInternal(selection, true);\n        var length = this.selection.getParagraphLength(this.currentWidget.paragraph);\n        if (this.offset > length) {\n            this.offset = length;\n        }\n        //Moves next line starting.\n        this.moveNextPosition();\n        var nextLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (prevParagraph.isInsideTable && prevParagraph !== this.currentWidget.paragraph && prevParagraph.associatedCell !== this.currentWidget.paragraph.associatedCell && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n            var ownerRow = this.currentWidget.paragraph.associatedCell.ownerRow;\n            // tslint:disable-next-line:max-line-length\n            if (prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable && prevParagraph.associatedCell.cellFormat.rowSpan > 1 && prevParagraph.associatedCell.cellFormat.rowSpan + prevParagraph.associatedCell.ownerRow.rowIndex === prevParagraph.associatedCell.ownerTable.childWidgets.length) {\n                //If the prevParagraph  owner cell is Verically merged upto the last row, then theposition moved to next column. the position moved to out of the current tabel so owner row is assigned to last row.\n                // tslint:disable-next-line:max-line-length\n                ownerRow = this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length - 1];\n            }\n            if (ownerRow.nextRenderedWidget instanceof TableRowWidget) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(ownerRow.nextRenderedWidget, this.currentWidget.paragraph.associatedCell, left, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n            }\n            else {\n                var nextBlock = this.selection.getNextRenderedBlock(ownerRow.ownerTable);\n                do {\n                    if (nextBlock instanceof TableWidget) {\n                        nextBlock = this.selection.getFirstBlockInFirstCell(nextBlock);\n                    }\n                } while (nextBlock instanceof TableWidget);\n                if (nextBlock instanceof ParagraphWidget) {\n                    this.setPosition(nextBlock.childWidgets[0], true);\n                }\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        else {\n            if (!prevParagraph.isInsideTable && this.currentWidget.paragraph.isInsideTable) {\n                // tslint:disable-next-line:max-line-length\n                var cell = this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, false);\n                this.setPosition(this.selection.getFirstParagraph(cell).childWidgets[0], true);\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (prevParagraph.isInsideTable && (!isNullOrUndefined(this.currentWidget.paragraph.associatedCell) && prevParagraph.associatedCell.ownerRow.nextRenderedWidget !== prevParagraph.associatedCell.ownerRow.nextSplitWidget\n                && prevParagraph.associatedCell.ownerRow.nextRenderedWidget === this.currentWidget.paragraph.associatedCell.ownerRow)) {\n                // tslint:disable-next-line:max-line-length\n                var cell = selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow, this.currentWidget.paragraph.associatedCell, this.owner.selection.upDownSelectionLength, true);\n                this.setPosition(selection.getFirstParagraph(cell).childWidgets[0], false);\n            }\n            nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        }\n        //Moves till the Up/Down selection width.\n        var top = this.selection.getTop(nextLine);\n        this.selection.updateTextPositionWidget(nextLine, new Point(left, top), this, false);\n    };\n    /**\n     * Moves the text position to start of the line.\n     * @private\n     */\n    TextPosition.prototype.moveToLineStartInternal = function (selection, moveToPreviousLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetInternal(this.currentWidget, this.offset, moveToPreviousLine);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        if (isNullOrUndefined(firstElement) && this.offset > startOffset) {\n            var index = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, index);\n            var inline = inlineObj.element;\n            index = inlineObj.index;\n            if (inline instanceof TextElementBox && inline.text !== '\\v') {\n                this.offset = startOffset;\n            }\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var indexInInline = selection.getIndexInInline(firstElement);\n            this.currentWidget = firstElement.line;\n            this.offset = this.currentWidget.getOffset(firstElement, indexInInline);\n            indexInInline = 0;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (inline instanceof FieldElementBox) {\n                //Checks if field character is part of rendered field, otherwise moves to previous rendered content.\n                var prevInline = selection.getPreviousValidElement(inline);\n                if (!isNullOrUndefined(prevInline)) {\n                    inline = prevInline;\n                    this.currentWidget = inline.line;\n                    this.offset = this.currentWidget.getOffset(inline, inline.length);\n                    if (inline instanceof FieldElementBox) {\n                        this.offset--;\n                    }\n                }\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Check paragraph is inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTableCheck = function () {\n        if ((this.selection.start.paragraph.isInsideTable || this.paragraph.isInsideTable)\n            && (this.selection.start.paragraph.associatedCell !== this.paragraph.associatedCell\n                || this.selection.isCellSelected(this.selection.start.paragraph.associatedCell, this.selection.start, this))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Moves the text position to end of the word.\n     * @private\n     */\n    TextPosition.prototype.moveToWordEndInternal = function (type, excludeSpace) {\n        // type === 0 -------->CTRL+ARROW Navigation\n        // type === 1 -------->CTRL+SHIFT+ARROW Selection\n        // type === 2 -------->Double-tap Word Selection\n        var incrementValue = 0;\n        var endOffset = this.currentWidget.getEndOffset();\n        if (this.selection.isParagraphFirstLine(this.currentWidget)) {\n            if (this.currentWidget.children[0] instanceof ListTextElementBox) {\n                incrementValue = 1;\n            }\n            if (this.currentWidget.children[1] instanceof ListTextElementBox) {\n                incrementValue = 2;\n            }\n        }\n        if (this.offset + incrementValue === endOffset || this.offset === endOffset + 1) {\n            if (this.offset === endOffset && type !== 0) {\n                this.setPositionParagraph(this.currentWidget, endOffset + 1);\n            }\n            else {\n                var nextParagraph = this.selection.getNextParagraphBlock(this.currentWidget.paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    return;\n                }\n                this.currentWidget = nextParagraph.childWidgets[0];\n                this.offset = this.selection.getStartLineOffset(this.currentWidget);\n                if (type === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    var nextWord = this.moveToNextParagraphInTableCheck();\n                    if (nextWord) {\n                        this.moveToNextParagraphInTable();\n                    }\n                    else {\n                        this.moveToWordEndInternal(type, excludeSpace);\n                    }\n                }\n            }\n        }\n        else {\n            var indexInInline = 0;\n            var endSelection = false;\n            var inlineObj = this.currentWidget.getInline(this.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.getNextWordOffset(inline, indexInInline, type, false, endSelection, this, excludeSpace);\n        }\n        if (type !== 0) {\n            var selectionStartIndex = this.owner.selection.start.getHierarchicalIndexInternal();\n            var selectionEndIndex = this.getHierarchicalIndexInternal();\n            if (selectionStartIndex !== selectionEndIndex) {\n                this.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * move text position to next paragraph inside table\n     * @private\n     */\n    TextPosition.prototype.moveToNextParagraphInTable = function () {\n        var paragraph = this.currentWidget.paragraph;\n        var nextParagraph = (paragraph.isInsideTable) ? this.selection.getNextSelectionCell(paragraph.associatedCell) :\n            this.selection.getNextParagraphBlock(paragraph);\n        if (isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        this.currentWidget = nextParagraph.childWidgets[nextParagraph.childWidgets.length - 1];\n        this.offset = this.currentWidget.getEndOffset() + 1;\n    };\n    /**\n     * Moves the text position to start of the previous paragraph.\n     */\n    TextPosition.prototype.moveToPreviousParagraph = function (selection) {\n        var startOffset = selection.getStartOffset(this.currentWidget.paragraph);\n        // tslint:disable-next-line:max-line-length\n        if (this.offset === startOffset && !isNullOrUndefined(selection.getPreviousParagraphBlock(this.currentWidget.paragraph))) {\n            var previousParagraph = selection.getPreviousParagraphBlock(this.currentWidget.paragraph);\n            this.currentWidget = previousParagraph.childWidgets[0];\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        else {\n            this.offset = selection.getStartOffset(this.currentWidget.paragraph);\n        }\n        this.updatePhysicalPosition(true);\n    };\n    /**\n     * Move to previous line from current position\n     * @private\n     */\n    TextPosition.prototype.moveToPreviousLine = function (selection, left) {\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        //Moves text position to start of line.\n        this.moveToLineStartInternal(selection, true);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveUpInTable(selection);\n        }\n        else {\n            this.moveBackward();\n        }\n        var prevLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(prevLine);\n        var lineWidth = selection.getWidth(prevLine, true);\n        //Moves till the Up/Down selection width.\n        if (lineWidth + lineStart >= left && currentLine !== prevLine) {\n            var top_1 = selection.getTop(prevLine);\n            var point = new Point(left, top_1);\n            selection.updateTextPositionWidget(prevLine, point, this, true);\n        }\n        //Checks if the current position is between field result, then move to field begin.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateBackwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.moveToLineEndInternal = function (selection, moveToNextLine) {\n        if (this.location.x > this.viewer.clientActiveArea.right) {\n            this.offset = this.offset - 1;\n        }\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var firstElement = selection.getFirstElementInternal(currentLine);\n        if (isNullOrUndefined(firstElement) && this.offset === selection.getStartLineOffset(this.currentWidget)) {\n            this.offset = selection.getParagraphLength(this.paragraph) + 1;\n            this.updatePhysicalPosition(true);\n        }\n        else if (!isNullOrUndefined(firstElement)) {\n            var lastElement = currentLine.children[currentLine.children.length - 1];\n            var index = 0;\n            index += lastElement instanceof TextElementBox ? lastElement.length : 1;\n            this.currentWidget = lastElement.line;\n            if (index === lastElement.length\n                && isNullOrUndefined(lastElement.nextNode) && selection.isParagraphLastLine(this.currentWidget)) {\n                var length_1 = selection.getLineLength(this.currentWidget);\n                this.offset = moveToNextLine ? length_1 + 1 : length_1;\n            }\n            else {\n                var inline = lastElement;\n                while (!isNullOrUndefined(inline) && inline.length === index && inline.nextNode instanceof FieldElementBox) {\n                    var nextInline = selection.getNextValidElement(inline.nextNode);\n                    if (inline !== nextInline) {\n                        inline = nextInline;\n                        index = 0;\n                    }\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        var fieldBegin = inline;\n                        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                            inline = fieldBegin.fieldEnd;\n                        }\n                        else {\n                            inline = fieldBegin.fieldSeparator;\n                            this.currentWidget = inline.line;\n                            if (this.currentWidget === fieldBegin.fieldEnd.line\n                                && !selection.hasValidInline(this.currentWidget.paragraph, inline, fieldBegin.fieldEnd)) {\n                                inline = fieldBegin.fieldEnd;\n                            }\n                        }\n                        this.currentWidget = inline.line;\n                    }\n                    if (inline instanceof FieldElementBox) {\n                        index = 1;\n                    }\n                }\n                if (index === inline.length && isNullOrUndefined(inline.nextNode)) {\n                    index++;\n                }\n                if (!moveToNextLine && inline instanceof ElementBox && inline.text === '\\v') {\n                    index--;\n                }\n                this.offset = this.currentWidget.getOffset(inline, index);\n            }\n            this.updatePhysicalPosition(moveToNextLine);\n        }\n    };\n    /**\n     * Move to next line\n     * @private\n     */\n    TextPosition.prototype.moveToNextLine = function (left) {\n        var selection = this.selection;\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionInternal(this);\n        var currentIndex = this.getHierarchicalIndexInternal();\n        var currentLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var isAtLineStart = this.offset === 0 ? true : false;\n        //Moves text position to end of line.\n        this.moveToLineEndInternal(selection, true);\n        var isMoveToLineEnd = !textPosition.isAtSamePosition(this);\n        textPosition.setPositionInternal(this);\n        if (this.currentWidget.paragraph.isInsideTable) {\n            this.moveDownInTable(selection);\n        }\n        else {\n            this.moveNextPosition();\n            this.moveForward();\n        }\n        var nextLine = selection.getLineWidgetParagraph(this.offset, this.currentWidget);\n        var lineStart = selection.getLeft(nextLine);\n        var firstElement = selection.getFirstElementInternal(nextLine);\n        // tslint:disable-next-line:max-line-length\n        var firstItemWidth = isNullOrUndefined(firstElement) ? selection.getWidth(nextLine, true) : selection.getLeftInternal(nextLine, firstElement, 1) - lineStart;\n        //Moves till the Up/Down selection width.\n        if (lineStart < left && (firstItemWidth / 2 < left - lineStart)) {\n            var top_2 = selection.getTop(nextLine);\n            var point = new Point(left, top_2);\n            selection.updateTextPositionWidget(nextLine, point, this, true);\n            var width = selection.getWidth(nextLine, true);\n            if (width < left - lineStart) {\n                this.moveToLineEndInternal(selection, true);\n            }\n        }\n        else if (isMoveToLineEnd && this.currentWidget.paragraph.isInsideTable\n            && this.currentWidget === this.owner.selection.start.currentWidget) {\n            this.setPositionInternal(textPosition);\n        }\n        else if (!isMoveToLineEnd) {\n            this.moveToLineEndInternal(selection, true);\n        }\n        //Checks if the current position is between field result, then move to field end.\n        var selectionEndIndex = this.getHierarchicalIndexInternal();\n        this.validateForwardFieldSelection(currentIndex, selectionEndIndex);\n    };\n    /**\n     * Move upward in table\n     * @private\n     */\n    TextPosition.prototype.moveUpInTable = function (selection) {\n        var isPositionUpdated = false;\n        var end = this.owner.selection.end;\n        var isBackwardSelection = !this.owner.selection.isEmpty;\n        isPositionUpdated = end.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.currentWidget.paragraph.associatedCell;\n            var endCell = end.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(endCell, startCell);\n            isPositionUpdated = containerCell.ownerTable.contains(startCell);\n            if (isPositionUpdated) {\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this, end);\n                if (!isContainerCellSelected) {\n                    // tslint:disable-next-line:max-line-length\n                    isContainerCellSelected = this.currentWidget.paragraph === selection.getFirstParagraph(containerCell) && this.isAtParagraphStart;\n                }\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(startCell.ownerRow.previousRenderedWidget)) {\n                    //Moves to cell in previous row.\n                    var row = startCell.ownerRow.previousRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getFirstCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, true);\n                    var previousParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(previousParagraph.childWidgets[0], true);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(startCell.ownerRow.previousRenderedWidget) || !isInContainerCell) {\n                    if (isBackwardSelection) {\n                        //Moves to first cell of row.\n                        startCell = startCell.ownerRow.childWidgets[0];\n                        var previousParagraph = selection.getFirstParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], true);\n                    }\n                    else {\n                        //Moves to last cell of row.\n                        startCell = startCell.ownerRow.childWidgets[startCell.ownerRow.childWidgets.length - 1];\n                        var previousParagraph = selection.getLastParagraph(startCell);\n                        this.setPosition(previousParagraph.childWidgets[0], false);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to previous row / previous block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isBackwardSelection) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.childWidgets[0];\n                var previousParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], true);\n            }\n            else {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var previousParagraph = selection.getLastParagraph(cell);\n                this.setPosition(previousParagraph.childWidgets[0], false);\n            }\n        }\n        //Moves to previous row / previous block.\n        this.moveBackward();\n    };\n    /**\n     * Move down inside table\n     * @private\n     */\n    TextPosition.prototype.moveDownInTable = function (selection) {\n        var isPositionUpdated = false;\n        var isForwardSelection = this.owner.selection.isEmpty || this.owner.selection.isForward;\n        isPositionUpdated = this.owner.selection.start.paragraph.isInsideTable;\n        if (isPositionUpdated) {\n            var startCell = this.owner.selection.start.paragraph.associatedCell;\n            var endCell = this.currentWidget.paragraph.associatedCell;\n            var containerCell = selection.getContainerCellOf(startCell, endCell);\n            isPositionUpdated = containerCell.ownerTable.contains(endCell);\n            if (isPositionUpdated) {\n                startCell = selection.getSelectedCell(startCell, containerCell);\n                endCell = selection.getSelectedCell(endCell, containerCell);\n                // tslint:disable-next-line:max-line-length\n                var isInContainerCell = selection.containsCell(containerCell, this.currentWidget.paragraph.associatedCell);\n                var isContainerCellSelected = selection.isCellSelected(containerCell, this.owner.selection.start, this);\n                if ((isInContainerCell && isContainerCellSelected\n                    || !isInContainerCell) && !isNullOrUndefined(endCell.ownerRow.nextRenderedWidget)) {\n                    //Moves to cell in next row.\n                    var row = endCell.ownerRow.nextRenderedWidget;\n                    // tslint:disable-next-line:max-line-length\n                    var cell = selection.getLastCellInRegion(row, containerCell, this.owner.selection.upDownSelectionLength, false);\n                    var lastParagraph = selection.getLastParagraph(cell);\n                    this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    return;\n                }\n                else if (isInContainerCell && isContainerCellSelected\n                    && isNullOrUndefined(endCell.ownerRow.nextRenderedWidget) || !isInContainerCell) {\n                    if (isForwardSelection) {\n                        //Moves to last cell of row.\n                        endCell = endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1];\n                        var lastParagraph = selection.getLastParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n                    }\n                    else {\n                        //Moves to first cell of row.\n                        endCell = endCell.ownerRow.childWidgets[0];\n                        var lastParagraph = selection.getFirstParagraph(endCell);\n                        this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n                    }\n                }\n            }\n        }\n        if (!isPositionUpdated) {\n            //Moves to next row / next block.\n            var cell = selection.getContainerCell(this.currentWidget.paragraph.associatedCell);\n            if (isForwardSelection) {\n                //Moves to end of row.\n                cell = cell.ownerRow.childWidgets[cell.ownerRow.childWidgets.length - 1];\n                var lastParagraph = selection.getLastParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], false);\n            }\n            else if (cell.ownerRow.nextRenderedWidget) {\n                //Moves to first cell of row.\n                cell = cell.ownerRow.nextRenderedWidget.childWidgets[0];\n                var lastParagraph = selection.getFirstParagraph(cell);\n                this.setPosition(lastParagraph.childWidgets[lastParagraph.childWidgets.length - 1], true);\n            }\n        }\n        //Moves to next row / next block.\n        this.moveForward();\n    };\n    /**\n     * @private\n     */\n    TextPosition.prototype.destroy = function () {\n        this.offset = undefined;\n        this.isUpdateLocation = undefined;\n        if (!isNullOrUndefined(this.location)) {\n            this.location.destroy();\n        }\n        this.location = undefined;\n        this.currentWidget = undefined;\n        this.owner = undefined;\n        this.viewer = undefined;\n    };\n    return TextPosition;\n}());\nexport { TextPosition };\n/**\n * @private\n */\nvar SelectionWidgetInfo = /** @class */ (function () {\n    function SelectionWidgetInfo(left, width) {\n        this.leftIn = 0;\n        this.widthIn = 0;\n        this.leftIn = left;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"left\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.leftIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.leftIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectionWidgetInfo.prototype, \"width\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    SelectionWidgetInfo.prototype.destroy = function () {\n        this.widthIn = undefined;\n        this.leftIn = undefined;\n    };\n    return SelectionWidgetInfo;\n}());\nexport { SelectionWidgetInfo };\n/**\n * @private\n */\nvar Hyperlink = /** @class */ (function () {\n    function Hyperlink(fieldBeginAdv, selection) {\n        this.linkInternal = '';\n        this.localRef = '';\n        this.opensNewWindow = false;\n        var fieldCode = selection.getFieldCode(fieldBeginAdv);\n        var lowercase = fieldCode.toLowerCase();\n        if (lowercase.substring(0, 9) === 'hyperlink') {\n            this.parseFieldValues(fieldCode.substring(9).trim(), selection);\n        }\n    }\n    Object.defineProperty(Hyperlink.prototype, \"navigationLink\", {\n        /**\n         * Gets navigation link.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.linkInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"localReference\", {\n        /**\n         * Gets the local reference if any.\n         * @returns string\n         * @private\n         */\n        get: function () {\n            return this.localRef;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Hyperlink.prototype, \"linkType\", {\n        /**\n         * Gets hyper link type.\n         * @returns HyperLinkType\n         * @private\n         */\n        get: function () {\n            return this.typeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Parse field values\n     * @param  {string} value\n     * @returns Void\n     */\n    Hyperlink.prototype.parseFieldValues = function (value, selection) {\n        var codes = value.split(' ');\n        var isLocalRef = false;\n        for (var i = 0; i < codes.length; i++) {\n            var code = codes[i];\n            if (code.length < 1) {\n                continue;\n            }\n            if (code === '\\\\t' || code === '\\\\l') {\n                isLocalRef = true;\n            }\n            else if (code === '\\\\n') {\n                this.opensNewWindow = true;\n            }\n            else {\n                code = this.parseFieldValue(code, code[0] === '\\\"' ? '\\\"' : undefined);\n                if (isLocalRef) {\n                    this.localRef = code;\n                    isLocalRef = false;\n                }\n                else {\n                    this.linkInternal = code;\n                }\n            }\n        }\n        this.setLinkType();\n    };\n    Hyperlink.prototype.parseFieldValue = function (value, endChar) {\n        value = value.substring(1);\n        var endIndex = endChar ? value.indexOf(endChar) : -1;\n        if (endIndex < 0) {\n            endIndex = value.length;\n        }\n        return value.substring(0, endIndex).trim();\n    };\n    Hyperlink.prototype.setLinkType = function () {\n        // If only local reference.\n        if (isNullOrUndefined(this.linkInternal) || this.linkInternal.length < 1) {\n            this.typeInternal = 'Bookmark';\n            return;\n        }\n        // Validates link.\n        if (this.linkInternal.substring(0, 4) === ('www.')) {\n            this.linkInternal = 'http://' + this.navigationLink;\n        }\n        else if (this.linkInternal[0] === '@') {\n            this.linkInternal = 'mailto:' + this.navigationLink;\n        }\n        // Finds proper link type.\n        if (this.linkInternal.substring(0, 7) === 'http://'\n            || this.linkInternal.substring(0, 8) === 'https://') {\n            this.typeInternal = 'WebPage';\n        }\n        else if (this.linkInternal.substring(0, 7) === 'mailto:') {\n            this.typeInternal = 'Email';\n        }\n        else {\n            this.typeInternal = 'File';\n        }\n    };\n    /**\n     * @private\n     */\n    Hyperlink.prototype.destroy = function () {\n        this.linkInternal = undefined;\n        this.localRef = undefined;\n        this.typeInternal = undefined;\n        this.opensNewWindow = undefined;\n    };\n    return Hyperlink;\n}());\nexport { Hyperlink };\n/**\n * @private\n */\nvar ImageFormat = /** @class */ (function () {\n    /**\n     * Constructor for image format class\n     * @param imageContainer - Specifies for image width and height values.\n     */\n    function ImageFormat(imageContainer) {\n        /**\n         * @private\n         */\n        this.width = 0;\n        /**\n         * @private\n         */\n        this.height = 0;\n        this.width = imageContainer.width;\n        this.height = imageContainer.height;\n    }\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageFormat.prototype.destroy = function () {\n        this.width = undefined;\n        this.height = undefined;\n    };\n    return ImageFormat;\n}());\nexport { ImageFormat };\n","import { Widget, BodyWidget, TableRowWidget, TableWidget, LineWidget, ElementBox, TextElementBox, ListTextElementBox, ImageElementBox, ParagraphWidget, TableCellWidget, FieldElementBox, BlockWidget, HeaderFooterWidget, BlockContainer, BookmarkElementBox } from '../viewer/page';\nimport { HelperMethods, Point } from '../editor/editor-helper';\nimport { SelectionCharacterFormat, SelectionCellFormat, SelectionParagraphFormat, SelectionRowFormat, SelectionSectionFormat, SelectionTableFormat, SelectionImageFormat } from './selection-format';\nimport { isNullOrUndefined, createElement, L10n } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../base/dictionary';\nimport { WCharacterFormat, WParagraphFormat, WParagraphStyle } from '../index';\nimport { HtmlExport } from '../writer/html-export';\nimport { Popup } from '@syncfusion/ej2-popups';\nimport { TextPosition, SelectionWidgetInfo, Hyperlink } from './selection-helper';\n/**\n * Selection\n */\nvar Selection = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Selection(documentEditor) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.upDownSelectionLength = 0;\n        /**\n         * @private\n         */\n        this.isSkipLayouting = false;\n        /**\n         * @private\n         */\n        this.isImageSelected = false;\n        this.contextTypeInternal = undefined;\n        /**\n         * @private\n         */\n        this.caret = undefined;\n        //Format Retrieval Field\n        /**\n         * @private\n         */\n        this.isRetrieveFormatting = false;\n        /**\n         * @private\n         */\n        this.skipFormatRetrieval = false;\n        this.isMoveDownOrMoveUp = false;\n        /**\n         * @private\n         */\n        this.selectedWidgets = undefined;\n        /**\n         * Hides caret.\n         * @private\n         */\n        this.hideCaret = function () {\n            _this.caret.style.display = 'none';\n        };\n        this.owner = documentEditor;\n        this.viewer = this.owner.viewer;\n        this.start = new TextPosition(this.owner);\n        this.end = new TextPosition(this.owner);\n        this.selectedWidgets = new Dictionary();\n        this.characterFormatIn = new SelectionCharacterFormat(this);\n        this.paragraphFormatIn = new SelectionParagraphFormat(this, this.viewer);\n        this.sectionFormatIn = new SelectionSectionFormat(this);\n        this.rowFormatIn = new SelectionRowFormat(this);\n        this.cellFormatIn = new SelectionCellFormat(this);\n        this.tableFormatIn = new SelectionTableFormat(this);\n        this.imageFormatInternal = new SelectionImageFormat(this);\n    }\n    Object.defineProperty(Selection.prototype, \"htmlWriter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.htmlWriterIn)) {\n                this.htmlWriterIn = new HtmlExport();\n            }\n            return this.htmlWriterIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"start\", {\n        /**\n         * Gets the start text position of last range in the selection\n         * @returns {TextPosition}\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.viewer)) {\n                if (isNullOrUndefined(this.startInternal)) {\n                    this.startInternal = this.owner.documentStart;\n                }\n                return this.startInternal;\n            }\n            return undefined;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.startInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"characterFormat\", {\n        //Format retrieval properties\n        /**\n         * Gets the instance of selection character format.\n         * @default undefined\n         * @return {SelectionCharacterFormat}\n         */\n        get: function () {\n            return this.characterFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"paragraphFormat\", {\n        /**\n         * Gets the instance of selection paragraph format.\n         * @default undefined\n         * @return {SelectionParagraphFormat}\n         */\n        get: function () {\n            return this.paragraphFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"sectionFormat\", {\n        /**\n         * Gets the instance of selection section format.\n         * @default undefined\n         * @return {SelectionSectionFormat}\n         */\n        get: function () {\n            return this.sectionFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"tableFormat\", {\n        /**\n         * Gets the instance of selection table format.\n         * @default undefined\n         * @return {SelectionTableFormat}\n         */\n        get: function () {\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"cellFormat\", {\n        /**\n         * Gets the instance of selection cell format.\n         * @default undefined\n         * @return {SelectionCellFormat}\n         */\n        get: function () {\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"rowFormat\", {\n        /**\n         * Gets the instance of selection row format.\n         * @default undefined\n         * @returns SelectionRowFormat\n         */\n        get: function () {\n            return this.rowFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"imageFormat\", {\n        /**\n         * Gets the instance of selection image format.\n         * @default undefined\n         * @returns SelectionImageFormat\n         */\n        get: function () {\n            return this.imageFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"end\", {\n        /**\n         * Gets the start text position of selection range.\n         * @private\n         */\n        get: function () {\n            return this.endInternal;\n        },\n        /**\n         * For internal use\n         * @private\n         */\n        set: function (value) {\n            this.endInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"startPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionStartPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionStartPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"endPage\", {\n        /**\n         * Gets the page number where the selection ends.\n         * @private\n         */\n        get: function () {\n            if (!this.owner.isDocumentLoaded || isNullOrUndefined(this.viewer)\n                || isNullOrUndefined(this.viewer.selectionEndPage)) {\n                return 1;\n            }\n            return this.viewer.pages.indexOf(this.viewer.selectionEndPage) + 1;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isForward\", {\n        /**\n         * Determines whether the selection direction is forward or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            return this.start.isExistBefore(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isEmpty\", {\n        /**\n         * Determines whether the start and end positions are same or not.\n         * @default false\n         * @returns {boolean}\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.start)) {\n                return true;\n            }\n            return this.start.isAtSamePosition(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"text\", {\n        /**\n         * Gets the text within selection.\n         * @default ''\n         * @returns {string}\n         */\n        get: function () {\n            return this.getText(false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"contextType\", {\n        /**\n         * Gets the context type of the selection.\n         */\n        get: function () {\n            return this.contextTypeInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Selection.prototype, \"isCleared\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return isNullOrUndefined(this.end);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Selection.prototype.getModuleName = function () {\n        return 'Selection';\n    };\n    //Public API\n    /**\n     * Moves the selection to the header of current page.\n     */\n    Selection.prototype.goToHeader = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget);\n    };\n    /**\n     * Moves the selection to the footer of current page.\n     */\n    Selection.prototype.goToFooter = function () {\n        this.owner.enableHeaderAndFooter = true;\n        this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget);\n    };\n    /**\n     * Closes the header and footer region.\n     */\n    Selection.prototype.closeHeaderFooter = function () {\n        this.disableHeaderFooter();\n    };\n    /**\n     * Moves the selection to the start of specified page number.\n     */\n    Selection.prototype.goToPage = function (pageNumber) {\n        if (pageNumber >= 1 && pageNumber <= this.viewer.pages.length) {\n            var page = this.viewer.pages[pageNumber - 1];\n            this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        }\n    };\n    /**\n     * Selects the entire table if the context is within table.\n     */\n    Selection.prototype.selectTable = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableInternal();\n    };\n    /**\n     * Selects the entire row if the context is within table.\n     */\n    Selection.prototype.selectRow = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableRow();\n    };\n    /**\n     * Selects the entire column if the context is within table.\n     */\n    Selection.prototype.selectColumn = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectColumnInternal();\n    };\n    /**\n     * Selects the entire cell if the context is within table.\n     */\n    Selection.prototype.selectCell = function () {\n        if (!this.owner.enableSelection) {\n            return;\n        }\n        this.selectTableCell();\n    };\n    /**\n     * Select content based on selection settings\n     */\n    Selection.prototype.select = function (selectionSettings) {\n        var point = new Point(selectionSettings.x, selectionSettings.y);\n        var pageCoordinates = this.viewer.findFocusedPage(point, true);\n        if (selectionSettings.extend) {\n            this.moveTextPosition(pageCoordinates, this.end);\n        }\n        else {\n            this.viewer.updateTextPositionForSelection(pageCoordinates, 1);\n        }\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleBold = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleBold();\n        }\n    };\n    /**\n     * Toggles the italic property of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleItalic = function () {\n        if (this.owner.editorModule) {\n            this.owner.editorModule.toggleItalic();\n        }\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of â€˜underlineâ€™ parameter is Single.\n     * @private\n     */\n    Selection.prototype.toggleUnderline = function (underline) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleUnderline(underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     * @private\n     */\n    Selection.prototype.toggleStrikethrough = function (strikethrough) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleStrikethrough(strikethrough);\n        }\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of â€˜underlineâ€™ parameter is Yellow.\n     * @private\n     */\n    Selection.prototype.toggleHighlightColor = function (highlightColor) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleHighlightColor(highlightColor);\n        }\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSubscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSubscript();\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     * @private\n     */\n    Selection.prototype.toggleSuperscript = function () {\n        if (this.owner.editor) {\n            this.owner.editor.toggleSuperscript();\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of â€˜textAlignment parameter is TextAlignment.Left.\n     * @private\n     */\n    Selection.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.owner.editor) {\n            this.owner.editor.toggleTextAlignment(textAlignment);\n        }\n    };\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.increaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.increaseIndent();\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     * @private\n     */\n    Selection.prototype.decreaseIndent = function () {\n        if (this.owner.editor) {\n            this.owner.editor.decreaseIndent();\n        }\n    };\n    /**\n     * Fires the `requestNavigate` event if current selection context is in hyperlink.\n     */\n    Selection.prototype.navigateHyperlink = function () {\n        var fieldBegin = this.getHyperlinkField();\n        if (fieldBegin) {\n            this.fireRequestNavigate(fieldBegin);\n        }\n    };\n    /**\n     * Navigate Hyperlink\n     * @param fieldBegin\n     * @private\n     */\n    Selection.prototype.fireRequestNavigate = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var eventArgs = {\n            isHandled: false,\n            navigationLink: hyperlink.navigationLink,\n            linkType: hyperlink.linkType,\n            localReference: hyperlink.localReference,\n            source: this.owner\n        };\n        this.owner.trigger('requestNavigate', eventArgs);\n        if (!eventArgs.isHandled) {\n            this.viewer.selection.navigateBookmark(hyperlink.localReference, true);\n        }\n    };\n    /**\n     * Copies the hyperlink URL if the context is within hyperlink.\n     */\n    Selection.prototype.copyHyperlink = function () {\n        var hyperLinkField = this.getHyperlinkField();\n        var linkText = this.getLinkText(hyperLinkField);\n        this.copyToClipboard(linkText);\n    };\n    //Selection add, Highlight, remove API starts\n    /**\n     * @private\n     */\n    Selection.prototype.highlightSelection = function (isSelectionChanged) {\n        if (this.owner.enableImageResizerMode) {\n            this.owner.imageResizerModule.hideImageResizer();\n        }\n        if (this.isEmpty) {\n            this.updateCaretPosition();\n        }\n        else {\n            if (this.isForward) {\n                this.highlightSelectedContent(this.start, this.end);\n            }\n            else {\n                this.highlightSelectedContent(this.end, this.start);\n            }\n            if (this.viewer.isComposingIME) {\n                this.updateCaretPosition();\n            }\n        }\n        this.viewer.updateTouchMarkPosition();\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.start, this.end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        if (width < 0) {\n            width = 0;\n        }\n        var page = this.getPage(lineWidget.paragraph);\n        var height = lineWidget.height;\n        var selectionWidget = undefined;\n        if (!this.selectedWidgets.containsKey(lineWidget)) {\n            selectionWidget = new SelectionWidgetInfo(left, width);\n            this.selectedWidgets.add(lineWidget, selectionWidget);\n        }\n        var viewer = this.viewer;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        if (viewer.containerTop <= pageTop\n            || pageTop < viewer.containerTop + viewer.selectionCanvas.height) {\n            var zoomFactor = viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            if (this.viewer.isComposingIME) {\n                // tslint:disable-next-line:max-line-length\n                this.renderDashLine(viewer.selectionContext, page, lineWidget, (pageLeft + (left * zoomFactor)) - viewer.containerLeft, top, width * zoomFactor, height);\n            }\n            else {\n                viewer.selectionContext.fillStyle = 'gray';\n                viewer.selectionContext.globalAlpha = 0.4;\n                // tslint:disable-next-line:max-line-length\n                viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - viewer.containerLeft, (pageTop + (top * zoomFactor)) - viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            }\n            viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * Create selection highlight inside table\n     * @private\n     */\n    Selection.prototype.createHighlightBorderInsideTable = function (cellWidget) {\n        var page = this.getPage(cellWidget);\n        var selectionWidget = undefined;\n        var left = cellWidget.x - cellWidget.margin.left + cellWidget.leftBorderWidth;\n        var width = cellWidget.width + cellWidget.margin.left\n            + cellWidget.margin.right - cellWidget.leftBorderWidth - cellWidget.rightBorderWidth;\n        var top = cellWidget.y;\n        var height = cellWidget.height;\n        var pageTop = this.getPageTop(page);\n        var pageLeft = page.boundingRectangle.x;\n        var isVisiblePage = this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height;\n        if (this.selectedWidgets.containsKey(cellWidget)) {\n            selectionWidget = this.selectedWidgets.get(cellWidget);\n            if (isVisiblePage) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.selectionContext.clearRect((pageLeft + (selectionWidget.left * this.viewer.zoomFactor) - this.viewer.containerLeft), (pageTop + (top * this.viewer.zoomFactor)) - this.viewer.containerTop, selectionWidget.width * this.viewer.zoomFactor, height * this.viewer.zoomFactor);\n            }\n        }\n        selectionWidget = new SelectionWidgetInfo(left, width);\n        this.selectedWidgets.add(cellWidget, selectionWidget);\n        if (isVisiblePage) {\n            this.viewer.selectionContext.fillStyle = 'gray';\n            this.viewer.selectionContext.globalAlpha = 0.4;\n            var zoomFactor = this.viewer.zoomFactor;\n            this.clipSelection(page, pageTop);\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.fillRect((pageLeft + (left * zoomFactor)) - this.viewer.containerLeft, (pageTop + (top * zoomFactor)) - this.viewer.containerTop, width * zoomFactor, height * zoomFactor);\n            this.viewer.selectionContext.restore();\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.clipSelection = function (page, pageTop) {\n        var viewer = this.viewer;\n        var width = page.boundingRectangle.width * viewer.zoomFactor;\n        var height = page.boundingRectangle.height * viewer.zoomFactor;\n        var left = page.boundingRectangle.x;\n        viewer.selectionContext.beginPath();\n        viewer.selectionContext.save();\n        viewer.selectionContext.rect(left - viewer.containerLeft, pageTop - viewer.containerTop, width, height);\n        viewer.selectionContext.clip();\n    };\n    /**\n     * Add selection highlight\n     * @private\n     */\n    Selection.prototype.addSelectionHighlight = function (canvasContext, widget, top) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            var height = widget.height;\n            var widgetInfo = this.selectedWidgets.get(widget);\n            var width = this.viewer.render.getScaledValue(widgetInfo.width);\n            var left = this.viewer.render.getScaledValue(widgetInfo.left, 1);\n            var page = this.owner.selection.getPage(widget.paragraph);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            if (this.viewer.isComposingIME) {\n                this.renderDashLine(canvasContext, page, widget, left, top, width, height);\n            }\n            else {\n                height = this.viewer.render.getScaledValue(height);\n                canvasContext.globalAlpha = 0.4;\n                canvasContext.fillStyle = 'gray';\n                canvasContext.fillRect(left, this.viewer.render.getScaledValue(top, 2), width, height);\n            }\n            canvasContext.restore();\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.renderDashLine = function (ctx, page, widget, left, top, width, height) {\n        var fontColor = this.characterFormat.fontColor;\n        var fillColor = fontColor ? this.viewer.render.getColor(fontColor) : '#000000';\n        ctx.globalAlpha = 1;\n        // Get character format copied from selection format\n        var format = this.owner.editor.copyInsertFormat(new WCharacterFormat(), false);\n        var heightInfo = this.viewer.textHelper.getHeight(format);\n        var pageTop = this.getPageTop(page);\n        var descent = heightInfo.Height - heightInfo.BaselineOffset;\n        top = this.viewer.render.getUnderlineYPosition(widget) + top + 4 - descent;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.render.renderDashLine(ctx, left, (pageTop - this.viewer.containerTop) + (top * this.viewer.zoomFactor), width, fillColor, true);\n    };\n    /**\n     * Add Selection highlight inside table\n     * @private\n     */\n    Selection.prototype.addSelectionHighlightTable = function (canvasContext, tableCellWidget) {\n        if (this.selectedWidgets.containsKey(tableCellWidget)) {\n            var selectionWidget = this.selectedWidgets.get(tableCellWidget);\n            var left = this.viewer.render.getScaledValue(selectionWidget.left, 1);\n            var top_1 = this.viewer.render.getScaledValue(tableCellWidget.y, 2);\n            var width = this.viewer.render.getScaledValue(selectionWidget.width);\n            var height = this.viewer.render.getScaledValue(tableCellWidget.height);\n            canvasContext.fillStyle = 'gray';\n            var page = this.owner.selection.getPage(tableCellWidget);\n            this.owner.selection.clipSelection(page, this.owner.selection.getPageTop(page));\n            canvasContext.fillRect(left, top_1, width, height);\n            canvasContext.restore();\n        }\n    };\n    /**\n     * Remove Selection highlight\n     * @private\n     */\n    Selection.prototype.removeSelectionHighlight = function (widget) {\n        var left = 0;\n        var top = 0;\n        var width = 0;\n        var height = 0;\n        var page = undefined;\n        if (widget instanceof LineWidget) {\n            var lineWidget = widget;\n            var currentParaWidget = lineWidget.paragraph;\n            page = !isNullOrUndefined(currentParaWidget) ?\n                this.getPage((lineWidget.paragraph)) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = this.getTop(lineWidget);\n            height = lineWidget.height;\n        }\n        else if (widget instanceof TableCellWidget) {\n            page = !isNullOrUndefined(widget) ?\n                this.getPage(widget) : undefined;\n            if (isNullOrUndefined(page)) {\n                return;\n            }\n            top = widget.y;\n            height = widget.height;\n        }\n        if (isNullOrUndefined(page)) {\n            return;\n        }\n        var widgetInfo = this.selectedWidgets.get(widget);\n        width = widgetInfo.width;\n        left = widgetInfo.left;\n        var pageRect = page.boundingRectangle;\n        var pageIndex = this.viewer.pages.indexOf(page);\n        var pageGap = this.viewer.pageGap;\n        var pageTop = (pageRect.y - pageGap * (pageIndex + 1)) * this.viewer.zoomFactor + pageGap * (pageIndex + 1);\n        var pageLeft = pageRect.x;\n        var zoomFactor = this.viewer.zoomFactor;\n        if (this.viewer.containerTop <= pageTop\n            || pageTop < this.viewer.containerTop + this.viewer.selectionCanvas.height) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selectionContext.clearRect((pageLeft + (left * zoomFactor) - this.viewer.containerLeft) - 0.5, (pageTop + (top * zoomFactor)) - this.viewer.containerTop - 0.5, width * zoomFactor + 0.5, height * zoomFactor + 0.5);\n        }\n    };\n    /**\n     * Select Current word\n     * @private\n     */\n    Selection.prototype.selectCurrentWord = function () {\n        var startPosition = this.start.clone();\n        var endPosition = this.end.clone();\n        this.selectCurrentWordRange(startPosition, endPosition, false);\n        this.selectRange(startPosition, endPosition);\n    };\n    /**\n     * Select current paragraph\n     * @private\n     */\n    Selection.prototype.selectCurrentParagraph = function () {\n        if (!isNullOrUndefined(this.start)) {\n            this.start.paragraphStartInternal(this, false);\n            this.end.moveToParagraphEndInternal(this, false);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select current word range\n     * @private\n     */\n    Selection.prototype.selectCurrentWordRange = function (startPosition, endPosition, excludeSpace) {\n        if (!isNullOrUndefined(startPosition)) {\n            if (startPosition.offset > 0) {\n                var wordStart = startPosition.clone();\n                var indexInInline = 0;\n                var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                if (!isNullOrUndefined(inline) && inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    // tslint:disable-next-line:max-line-length\n                    if (startPosition.offset > 2 && (!isNullOrUndefined(inline.fieldSeparator) || isNullOrUndefined(inline.fieldBegin))) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 2);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset - 1)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                    else if (startPosition.offset > 3 && isNullOrUndefined(inline.fieldSeparator)) {\n                        wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 3);\n                        wordStart.moveToWordEndInternal(0, false);\n                        if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                            startPosition.moveToWordStartInternal(2);\n                        }\n                    }\n                }\n                else {\n                    wordStart.setPositionParagraph(wordStart.currentWidget, startPosition.offset - 1);\n                    wordStart.moveToWordEndInternal(0, false);\n                    if (!(wordStart.paragraph === startPosition.paragraph && wordStart.offset === startPosition.offset)) {\n                        startPosition.moveToWordStartInternal(2);\n                    }\n                }\n            }\n            endPosition.moveToWordEndInternal(2, excludeSpace);\n        }\n    };\n    /**\n     * Extend selection to paragraph start\n     * @private\n     */\n    Selection.prototype.extendToParagraphStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.paragraphStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to paragraph end\n     * @private\n     */\n    Selection.prototype.extendToParagraphEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToParagraphEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next text position\n     * @private\n     */\n    Selection.prototype.moveNextPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.moveNextPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateForwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to next paragraph\n     * @private\n     */\n    Selection.prototype.moveToNextParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextParagraphStartInternal();\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous text position\n     * @private\n     */\n    Selection.prototype.movePreviousPosition = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (this.isEmpty) {\n            this.start.movePreviousPosition();\n            this.end.setPositionInternal(this.start);\n        }\n        this.updateBackwardSelection();\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to previous paragraph\n     * @private\n     */\n    Selection.prototype.moveToPreviousParagraph = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousParagraph(this);\n        this.start.setPositionInternal(this.end);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to previous line\n     * @private\n     */\n    Selection.prototype.extendToPreviousLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToPreviousLine(this, this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to line end\n     * @private\n     */\n    Selection.prototype.extendToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineEndInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend to line start\n     * @private\n     */\n    Selection.prototype.extendToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToLineStartInternal(this, true);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveUp = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.upDownSelectionLength = this.start.location.x;\n        this.start.moveUp(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.moveDown = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n            this.upDownSelectionLength = this.start.location.x;\n        }\n        this.start.moveDown(this, this.upDownSelectionLength);\n        this.end.setPositionInternal(this.start);\n        this.fireSelectionChanged(true);\n    };\n    Selection.prototype.updateForwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.setPositionInternal(this.end);\n            }\n            else {\n                this.end.setPositionInternal(this.start);\n            }\n        }\n    };\n    Selection.prototype.updateBackwardSelection = function () {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.end.setPositionInternal(this.start);\n            }\n            else {\n                this.start.setPositionInternal(this.end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstrow = table.childWidgets[0];\n            if (firstrow.childWidgets.length > 0) {\n                var firstcell = firstrow.childWidgets[0];\n                if (firstcell.childWidgets.length === 0) {\n                    return undefined;\n                }\n                return firstcell.childWidgets[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFirstCellInRegion = function (row, startCell, selectionLength, isMovePrevious) {\n        var cellStart = this.getCellLeft(row, startCell);\n        var cellEnd = cellStart + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (cellStart <= selectionLength && selectionLength < cellEnd) {\n            for (var k = 0; k < row.childWidgets.length; k++) {\n                var left = this.getCellLeft(row, row.childWidgets[k]);\n                if (HelperMethods.round(cellStart, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(cellEnd, 2)) {\n                    flag = false;\n                    return row.childWidgets[k];\n                }\n            }\n        }\n        else {\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cellLeft = this.getCellLeft(row, row.childWidgets[j]);\n                if (cellLeft <= selectionLength && cellLeft +\n                    row.childWidgets[j].cellFormat.cellWidth > selectionLength) {\n                    flag = false;\n                    return row.childWidgets[j];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrevious) {\n                var previousWidget = row.previousRenderedWidget;\n                return this.getFirstCellInRegion(previousWidget, startCell, selectionLength, isMovePrevious);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrevious) {\n                return this.getFirstCellInRegion(row.nextRenderedWidget, startCell, selectionLength, isMovePrevious);\n            }\n        }\n        return row.childWidgets[0];\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstParagraph = function (tableCell) {\n        while (tableCell.previousSplitWidget) {\n            tableCell = tableCell.previousSplitWidget;\n        }\n        var firstBlock = tableCell.firstChild;\n        return this.getFirstParagraphBlock(firstBlock);\n    };\n    /**\n     * Get last block in last cell\n     * @private\n     */\n    //Table\n    Selection.prototype.getLastBlockInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.childWidgets[table.childWidgets.length - 1];\n            var lastcell = lastrow.childWidgets[lastrow.childWidgets.length - 1];\n            return lastcell.childWidgets[lastcell.childWidgets.length - 1];\n        }\n        return undefined;\n    };\n    /**\n     * Move to line start\n     * @private\n     */\n    Selection.prototype.moveToLineStart = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateBackwardSelection();\n        this.start.moveToLineStartInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Move to line end\n     * @private\n     */\n    Selection.prototype.moveToLineEnd = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.updateForwardSelection();\n        this.start.moveToLineEndInternal(this, false);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Get Page top\n     * @private\n     */\n    Selection.prototype.getPageTop = function (page) {\n        // tslint:disable-next-line:max-line-length\n        return (page.boundingRectangle.y - this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + this.viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n    };\n    /**\n     * Move text position to cursor point\n     * @private\n     */\n    Selection.prototype.moveTextPosition = function (cursorPoint, textPosition) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        //Updates the text position based on the cursor position.\n        var widget = this.viewer.getLineWidgetInternal(cursorPoint, true);\n        if (!isNullOrUndefined(widget)) {\n            this.updateTextPositionWidget(widget, cursorPoint, textPosition, true);\n        }\n        this.upDownSelectionLength = textPosition.location.x;\n        var selectionStartIndex = this.start.getHierarchicalIndexInternal();\n        var selectionEndIndex = this.end.getHierarchicalIndexInternal();\n        if (selectionStartIndex !== selectionEndIndex) {\n            // Extends selection end to field begin or field end.\n            if (TextPosition.isForwardSelection(selectionStartIndex, selectionEndIndex)) {\n                textPosition.validateForwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n            else {\n                textPosition.validateBackwardFieldSelection(selectionStartIndex, selectionEndIndex);\n            }\n        }\n        this.fireSelectionChanged(true);\n    };\n    //Helper Method Implementation \n    //Document\n    /**\n     * Get document start position\n     * @private\n     */\n    Selection.prototype.getDocumentStart = function () {\n        var textPosition = undefined;\n        var block = this.viewer.pages[0].bodyWidgets[0].childWidgets[0];\n        return this.setPositionForBlock(block, true);\n    };\n    /**\n     * Get document end position\n     * @private\n     */\n    Selection.prototype.getDocumentEnd = function () {\n        var textPosition = undefined;\n        var documentStart = this.owner.documentStart;\n        var lastPage = this.viewer.pages[this.viewer.pages.length - 1];\n        if (!isNullOrUndefined(documentStart) && lastPage.bodyWidgets[0].childWidgets.length > 0) {\n            var block = undefined;\n            var section = lastPage.bodyWidgets[0];\n            var blocks = section.childWidgets;\n            var lastBlkItem = blocks.length - 1;\n            var lastBlock = blocks[lastBlkItem];\n            if (lastBlock instanceof BlockWidget) {\n                block = lastBlock;\n            }\n            textPosition = this.setPositionForBlock(block, false);\n        }\n        return textPosition;\n    };\n    //Keyboard shortcut internal API\n    /**\n     * @private\n     * Handles control end key.\n     */\n    Selection.prototype.handleControlEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.owner.selection.selectContent(documentEnd, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control home key.\n     */\n    Selection.prototype.handleControlHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.owner.selection.selectContent(documentStart, true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control left key.\n     */\n    Selection.prototype.handleControlLeftKey = function () {\n        this.extendToWordStart(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control right key.\n     */\n    Selection.prototype.handleControlRightKey = function () {\n        this.extendToWordEnd(true);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control down key.\n     * @private\n     */\n    Selection.prototype.handleControlDownKey = function () {\n        this.moveToNextParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control up key.\n     * @private\n     */\n    Selection.prototype.handleControlUpKey = function () {\n        this.moveToPreviousParagraph();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles shift left key.\n     */\n    Selection.prototype.handleShiftLeftKey = function () {\n        this.extendBackward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift up key.\n     * @private\n     */\n    Selection.prototype.handleShiftUpKey = function () {\n        this.extendToPreviousLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift right key.\n     * @private\n     */\n    Selection.prototype.handleShiftRightKey = function () {\n        this.extendForward();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift down key.\n     * @private\n     */\n    Selection.prototype.handleShiftDownKey = function () {\n        this.extendToNextLine();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     * Handles control shift left key.\n     */\n    Selection.prototype.handleControlShiftLeftKey = function () {\n        this.extendToWordStart(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift up key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftUpKey = function () {\n        this.extendToParagraphStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift right key\n     * @private\n     */\n    Selection.prototype.handleControlShiftRightKey = function () {\n        this.extendToWordEnd(false);\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift down key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftDownKey = function () {\n        this.extendToParagraphEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles left key.\n     * @private\n     */\n    Selection.prototype.handleLeftKey = function () {\n        this.movePreviousPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles up key.\n     * @private\n     */\n    Selection.prototype.handleUpKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveUp();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles right key.\n     * @private\n     */\n    Selection.prototype.handleRightKey = function () {\n        this.moveNextPosition();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles end key.\n     * @private\n     */\n    Selection.prototype.handleEndKey = function () {\n        this.moveToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles home key.\n     * @private\n     */\n    Selection.prototype.handleHomeKey = function () {\n        this.moveToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles down key.\n     * @private\n     */\n    Selection.prototype.handleDownKey = function () {\n        this.isMoveDownOrMoveUp = true;\n        this.moveDown();\n        this.isMoveDownOrMoveUp = false;\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift end key.\n     * @private\n     */\n    Selection.prototype.handleShiftEndKey = function () {\n        this.extendToLineEnd();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles shift home key.\n     * @private\n     */\n    Selection.prototype.handleShiftHomeKey = function () {\n        this.extendToLineStart();\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift end key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftEndKey = function () {\n        var documentEnd = undefined;\n        if (!isNullOrUndefined(this.owner.documentEnd)) {\n            documentEnd = this.owner.documentEnd;\n        }\n        if (!isNullOrUndefined(documentEnd)) {\n            this.end.setPosition(documentEnd.currentWidget, false);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles control shift home key.\n     * @private\n     */\n    Selection.prototype.handleControlShiftHomeKey = function () {\n        var documentStart = undefined;\n        if (!isNullOrUndefined(this.owner.documentStart)) {\n            documentStart = this.owner.documentStart;\n        }\n        if (!isNullOrUndefined(documentStart)) {\n            this.end.setPositionInternal(documentStart);\n            this.fireSelectionChanged(true);\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Handles tab key.\n     * @param isNavigateInCell\n     * @param isShiftTab\n     * @private\n     */\n    Selection.prototype.handleTabKey = function (isNavigateInCell, isShiftTab) {\n        var start = this.start;\n        if (isNullOrUndefined(start)) {\n            return;\n        }\n        if (start.paragraph.isInsideTable && this.end.paragraph.isInsideTable && (isNavigateInCell || isShiftTab)) {\n            //Perform tab navigation\n            if (isShiftTab) {\n                this.selectPreviousCell();\n            }\n            else {\n                this.selectNextCell();\n            }\n        }\n        else if ((isNavigateInCell || isShiftTab) && !isNullOrUndefined(start) && start.offset === this.getStartOffset(start.paragraph)\n            && !isNullOrUndefined(start.paragraph.paragraphFormat) && !isNullOrUndefined(start.paragraph.paragraphFormat.listFormat)\n            && start.paragraph.paragraphFormat.listFormat.listId !== -1 && !this.owner.isReadOnlyMode) {\n            this.owner.editorModule.updateListLevel(isShiftTab ? false : true);\n        }\n        else if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.handleTextInput('\\t');\n        }\n        this.checkForCursorVisibility();\n    };\n    Selection.prototype.selectPreviousCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.previousWidget)) {\n            if (!isNullOrUndefined(tableRow.previousRenderedWidget)) {\n                //Move text selection or cursor to previous row's last cell\n                var prevRow = undefined;\n                if (tableRow.previousRenderedWidget instanceof TableRowWidget) {\n                    prevRow = tableRow.previousRenderedWidget;\n                }\n                this.selectTableCellInternal(prevRow.childWidgets[prevRow.childWidgets.length - 1], true);\n            }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var prevCell = undefined;\n            if (tableCell.previousWidget instanceof TableCellWidget) {\n                prevCell = tableCell.previousWidget;\n            }\n            this.selectTableCellInternal(prevCell, true);\n        }\n    };\n    Selection.prototype.selectNextCell = function () {\n        var tableCell = this.start.paragraph.associatedCell;\n        var tableRow = tableCell.ownerRow;\n        var tableAdv = tableRow.ownerTable;\n        if (isNullOrUndefined(tableCell.nextWidget)) {\n            if (isNullOrUndefined(tableRow.nextRenderedWidget) && !this.owner.isReadOnlyMode) {\n                //Insert new row below                  \n                this.owner.editorModule.insertRow(false);\n            }\n            else {\n                //Move text selection or cursor to next row's first cell\n                var nextRow = undefined;\n                if (tableRow.nextRenderedWidget instanceof TableRowWidget) {\n                    nextRow = tableRow.nextRenderedWidget;\n                }\n                this.selectTableCellInternal(nextRow.childWidgets[0], true);\n            }\n            // }\n        }\n        else {\n            //Move text selection or cursor to next cell in current row\n            var nextCell = undefined;\n            if (tableCell.nextRenderedWidget instanceof TableCellWidget) {\n                nextCell = tableCell.nextRenderedWidget;\n            }\n            this.selectTableCellInternal(nextCell, true);\n        }\n    };\n    /**\n     * Select given table cell\n     * @private\n     */\n    Selection.prototype.selectTableCellInternal = function (tableCell, clearMultiSelection) {\n        var firstParagraph = this.getFirstParagraph(tableCell);\n        var lastParagraph = this.getLastParagraph(tableCell);\n        if (firstParagraph === lastParagraph && lastParagraph.isEmpty()) {\n            this.selectParagraph(lastParagraph, true);\n        }\n        else {\n            var firstLineWidget = lastParagraph.childWidgets[0];\n            this.start.setPosition(firstParagraph.childWidgets[0], true);\n            this.end.setPositionParagraph(firstLineWidget, firstLineWidget.getEndOffset());\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select while table\n     * @private\n     */\n    Selection.prototype.selectTableInternal = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.getTable(start, end))) {\n            var containerCell = this.getContainerCellOf(start.paragraph.associatedCell, end.paragraph.associatedCell);\n            var table = containerCell.ownerTable;\n            var firstPara = this.getFirstParagraphBlock(table);\n            var lastPara = this.getLastParagraphBlock(table);\n            var offset = lastPara.lastChild.getEndOffset();\n            this.start.setPosition(firstPara.childWidgets[0], true);\n            this.end.setPositionParagraph(lastPara.lastChild, offset + 1);\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single column\n     * @private\n     */\n    Selection.prototype.selectColumnInternal = function () {\n        var startTextPos = this.start;\n        var endTextPos = this.end;\n        if (!this.isForward) {\n            startTextPos = this.end;\n            endTextPos = this.start;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(startTextPos) && !isNullOrUndefined(endTextPos) && !isNullOrUndefined(this.getTable(startTextPos, endTextPos))) {\n            var containerCell = this.getContainerCellOf(startTextPos.paragraph.associatedCell, endTextPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endTextPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startTextPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endTextPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endTextPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var columnCells = containerCell.ownerTable.getColumnCellsForSelection(containerCell, containerCell);\n                    if (columnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(columnCells[0]);\n                        var lastPara = this.getLastParagraph(columnCells[columnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n                else {\n                    var startCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(startCell, startCell);\n                    var endCellColumnCells = containerCell.ownerTable.getColumnCellsForSelection(endCell, endCell);\n                    if (startCellColumnCells.length > 0 && endCellColumnCells.length > 0) {\n                        var firstPara = this.getFirstParagraph(startCellColumnCells[0]);\n                        // tslint:disable-next-line:max-line-length\n                        var lastPara = this.getLastParagraph(endCellColumnCells[endCellColumnCells.length - 1]);\n                        this.start.setPosition(firstPara.firstChild, true);\n                        var lastLine = lastPara.lastChild;\n                        this.end.setPositionParagraph(lastLine, lastLine.getEndOffset() + 1);\n                    }\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single row\n     * @private\n     */\n    Selection.prototype.selectTableRow = function () {\n        var startPos = this.start;\n        var endPos = this.end;\n        if (!this.isForward) {\n            startPos = this.end;\n            endPos = this.start;\n        }\n        if (!isNullOrUndefined(startPos) && !isNullOrUndefined(endPos) && !isNullOrUndefined(this.getTable(startPos, endPos))) {\n            var containerCell = void 0;\n            containerCell = this.getContainerCellOf(startPos.paragraph.associatedCell, endPos.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(endPos.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(startPos.paragraph.associatedCell, containerCell);\n                var endCell = this.getSelectedCell(endPos.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, endPos.paragraph.associatedCell)) {\n                    var row = startCell.ownerRow;\n                    var firstPara = this.getFirstParagraph(row.childWidgets[0]);\n                    var lastPara = this.getLastParagraph(row.childWidgets[row.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    var firstPara = this.getFirstParagraph(startCell.ownerRow.childWidgets[0]);\n                    var lastPara = void 0;\n                    // tslint:disable-next-line:max-line-length\n                    lastPara = this.getLastParagraph(endCell.ownerRow.childWidgets[endCell.ownerRow.childWidgets.length - 1]);\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * Select single cell\n     * @private\n     */\n    Selection.prototype.selectTableCell = function () {\n        var start = this.start;\n        var end = this.end;\n        if (!this.isForward) {\n            start = this.end;\n            end = this.start;\n        }\n        if (isNullOrUndefined(this.getTable(start, end))) {\n            return;\n        }\n        if (this.isEmpty) {\n            if (start.paragraph.isInsideTable && !isNullOrUndefined(start.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(start.paragraph.associatedCell);\n                var lastPara = this.getLastParagraph(end.paragraph.associatedCell);\n                if (firstPara === lastPara) {\n                    this.start.setPosition(lastPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n                else {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        else {\n            var containerCell = this.getContainerCell(start.paragraph.associatedCell);\n            // tslint:disable-next-line:max-line-length\n            if (this.containsCell(containerCell, start.paragraph.associatedCell) && this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                var firstPara = this.getFirstParagraph(containerCell);\n                var lastPara = this.getLastParagraph(containerCell);\n                if (!isNullOrUndefined(firstPara) && !isNullOrUndefined(lastPara)) {\n                    this.start.setPosition(firstPara.firstChild, true);\n                    this.end.setPositionParagraph(lastPara.lastChild, lastPara.lastChild.getEndOffset() + 1);\n                }\n            }\n        }\n        this.selectPosition(this.start, this.end);\n    };\n    /**\n     * @private\n     * Selects the entire document.\n     */\n    Selection.prototype.selectAll = function () {\n        var documentStart;\n        var documentEnd;\n        if (this.owner.enableHeaderAndFooter) {\n            var headerFooter = this.getContainerWidget(this.start.paragraph);\n            documentStart = this.setPositionForBlock(headerFooter.firstChild, true);\n            documentEnd = this.setPositionForBlock(headerFooter.lastChild, false);\n        }\n        else {\n            documentStart = this.owner.documentStart;\n            documentEnd = this.owner.documentEnd;\n        }\n        //Selects the entire document.        \n        if (!isNullOrUndefined(documentStart)) {\n            this.start.setPositionInternal(documentStart);\n            this.end.setPositionParagraph(documentEnd.currentWidget, documentEnd.offset + 1);\n            this.upDownSelectionLength = this.end.location.x;\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Extend selection backward\n     * @private\n     */\n    Selection.prototype.extendBackward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveBackward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection forward\n     * @private\n     */\n    Selection.prototype.extendForward = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveForward();\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to word start and end\n     * @private\n     */\n    Selection.prototype.extendToWordStartEnd = function () {\n        if ((this.start.paragraph.isInsideTable || this.end.paragraph.isInsideTable)\n            && (this.start.paragraph.associatedCell !== this.end.paragraph.associatedCell\n                || this.isCellSelected(this.start.paragraph.associatedCell, this.start, this.end))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Extend selection to word start\n     * @private\n     */\n    Selection.prototype.extendToWordStart = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelected = this.extendToWordStartEnd();\n        if (isCellSelected) {\n            this.end.moveToPreviousParagraphInTable(this);\n        }\n        else {\n            this.end.moveToWordStartInternal(isNavigation ? 0 : 1);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extent selection to word end\n     * @private\n     */\n    Selection.prototype.extendToWordEnd = function (isNavigation) {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        var isCellSelect = this.extendToWordStartEnd();\n        if (isCellSelect) {\n            this.end.moveToNextParagraphInTable();\n        }\n        else {\n            this.end.moveToWordEndInternal(isNavigation ? 0 : 1, false);\n        }\n        if (isNavigation) {\n            this.start.setPositionInternal(this.end);\n        }\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Extend selection to next line\n     * @private\n     */\n    Selection.prototype.extendToNextLine = function () {\n        if (isNullOrUndefined(this.start)) {\n            return;\n        }\n        this.end.moveToNextLine(this.upDownSelectionLength);\n        this.fireSelectionChanged(true);\n    };\n    //Selection Text get API\n    //Selection add, Highlight, remove API enda\n    Selection.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        textPosition.setPositionForCurrentIndex(hierarchicalIndex);\n        return textPosition;\n    };\n    /**\n     * Get Selected text\n     * @private\n     */\n    Selection.prototype.getText = function (includeObject) {\n        if (isNullOrUndefined(this.start) || isNullOrUndefined(this.end)\n            || isNullOrUndefined(this.start.paragraph) || isNullOrUndefined(this.end.paragraph)) {\n            return undefined;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (startPosition.isAtSamePosition(endPosition)) {\n            return '';\n        }\n        return this.getTextInternal(startPosition, endPosition, includeObject);\n    };\n    /**\n     * Get selected text\n     * @private\n     */\n    Selection.prototype.getTextInternal = function (start, end, includeObject) {\n        if (start.isExistAfter(end)) {\n            var temp = end;\n            end = start;\n            start = temp;\n        }\n        var startPosition = start;\n        var endPosition = end;\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n            var startIndex = 0;\n            var endIndex = 0;\n            var startOffset = start.offset;\n            var endOffset = end.offset;\n            var startInlineObj = start.currentWidget.getInline(startOffset, startIndex);\n            startIndex = startInlineObj.index;\n            var inline = startInlineObj.element;\n            // If the start position is at the beginning of field begin that has field end, then field code should be skipped.\n            if (inline instanceof FieldElementBox && !isNullOrUndefined(inline.fieldEnd)) {\n                var elementInfo = this.getRenderedInline(inline, startIndex);\n                inline = elementInfo.element;\n                startIndex = elementInfo.index;\n            }\n            var endInlineObj = end.currentWidget.getInline(endOffset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            var text = '';\n            // Retrieves the text from start inline.\n            if (inline instanceof ImageElementBox && includeObject && startIndex === 0) {\n                text = ElementBox.objectCharacter;\n            }\n            else if (inline instanceof TextElementBox) {\n                // tslint:disable-next-line:max-line-length\n                text = ((isNullOrUndefined(inline.text)) || (inline.text) === '') || inline.text.length < startIndex ? text : inline.text.substring(startIndex);\n            }\n            if (startPosition.paragraph === endPosition.paragraph) {\n                if (inline instanceof ElementBox) {\n                    if (inline === endInline && inline instanceof TextElementBox) {\n                        text = text.length < endIndex - startIndex ? text : text.substring(0, endIndex - startIndex);\n                    }\n                    else if (inline.nextNode instanceof ElementBox) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            else {\n                if (inline instanceof ElementBox && inline.nextNode instanceof ElementBox) {\n                    text = text + this.getTextInline(inline.nextNode, endPosition.paragraph, undefined, 0, includeObject);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(startPosition.paragraph);\n                    text = text + '\\r';\n                    while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n                        text = text + '\\r';\n                        if (nextParagraphWidget === endPosition.paragraph) {\n                            return text;\n                        }\n                        nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n                    }\n                    if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n                        // tslint:disable-next-line:max-line-length\n                        text = text + this.getTextInline(nextParagraphWidget.childWidgets[0].children[0], endPosition.paragraph, endInline, endIndex, includeObject);\n                    }\n                }\n            }\n            // If the selection includes end paragraph mark.\n            if (endOffset === (endPosition.currentWidget).getEndOffset() + 1) {\n                text = text + '\\r';\n            }\n            return text;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getListTextElementBox = function (paragarph) {\n        if (isNullOrUndefined(paragarph)) {\n            return undefined;\n        }\n        var listTextElement;\n        if (!paragarph.isEmpty()) {\n            var lineWidget = paragarph.childWidgets[0];\n            if (lineWidget.children.length > 1) {\n                if (lineWidget.children[0] instanceof ListTextElementBox) {\n                    listTextElement = lineWidget.children[0];\n                }\n            }\n        }\n        return listTextElement;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getTextInline = function (inlineElement, endParagraphWidget, endInline, endIndex, includeObject) {\n        var text = '';\n        do {\n            if (inlineElement === endInline) {\n                if (inlineElement instanceof TextElementBox) {\n                    var span = inlineElement;\n                    if (!(isNullOrUndefined(span.text) || span.text === '')) {\n                        if (span.text.length < endIndex) {\n                            text = text + span.text;\n                        }\n                        else {\n                            text = text + span.text.substring(0, endIndex);\n                        }\n                    }\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (inlineElement instanceof ImageElementBox && includeObject && endIndex === inlineElement.length) {\n                    text = text + ElementBox.objectCharacter;\n                }\n                return text;\n            }\n            if (inlineElement instanceof TextElementBox) {\n                text = text + inlineElement.text;\n            }\n            else if (inlineElement instanceof ImageElementBox && includeObject) {\n                text = text + ElementBox.objectCharacter;\n            }\n            else if (inlineElement instanceof FieldElementBox && !isNullOrUndefined(inlineElement.fieldEnd)) {\n                if (!isNullOrUndefined(inlineElement.fieldSeparator)) {\n                    inlineElement = inlineElement.fieldSeparator;\n                }\n                else {\n                    inlineElement = inlineElement.fieldEnd;\n                }\n            }\n            if (isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            inlineElement = inlineElement.nextNode;\n        } while (!isNullOrUndefined(inlineElement));\n        if (endParagraphWidget === inlineElement.line.paragraph) {\n            return text;\n        }\n        // tslint:disable-next-line:max-line-length\n        var nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.isEmpty()) {\n            text = text + '\\r';\n            if (nextParagraphWidget === endParagraphWidget) {\n                return text;\n            }\n            nextParagraphWidget = this.viewer.selection.getNextParagraphBlock(nextParagraphWidget);\n        }\n        if (!isNullOrUndefined(nextParagraphWidget) && !nextParagraphWidget.isEmpty()) {\n            var lineWidget = nextParagraphWidget.childWidgets[0];\n            // tslint:disable-next-line:max-line-length\n            text = text + '\\r' + this.getTextInline(lineWidget.children[0], endParagraphWidget, endInline, endIndex, includeObject);\n        }\n        return text;\n    };\n    /**\n     * Returns field code.\n     * @private\n     * @param fieldBegin\n     */\n    Selection.prototype.getFieldCode = function (fieldBegin) {\n        var fieldCode = '';\n        if (!(fieldBegin.fieldEnd instanceof FieldElementBox)) {\n            return fieldCode;\n        }\n        var paragraph = fieldBegin.paragraph;\n        var endParagraph = fieldBegin.fieldEnd.paragraph;\n        if (fieldBegin.fieldSeparator instanceof FieldElementBox) {\n            endParagraph = fieldBegin.fieldSeparator.paragraph;\n        }\n        var startLineIndex = fieldBegin.line.indexInOwner;\n        var startIndex = fieldBegin.indexInOwner;\n        do {\n            fieldCode += this.getFieldCodeInternal(paragraph, startLineIndex, startIndex);\n            if (paragraph === endParagraph) {\n                break;\n            }\n            paragraph = this.getNextParagraphBlock(paragraph);\n            startLineIndex = 0;\n            startIndex = 0;\n        } while (paragraph instanceof ParagraphWidget);\n        return fieldCode.trim();\n    };\n    Selection.prototype.getFieldCodeInternal = function (paragraph, startLineIndex, inlineIndex) {\n        var fieldCode = '';\n        for (var i = startLineIndex; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var i_1 = inlineIndex; i_1 < line.children.length; i_1++) {\n                var element = line.children[i_1];\n                if (element instanceof TextElementBox) {\n                    fieldCode += element.text;\n                }\n                if (element instanceof FieldElementBox\n                    && (element.fieldType === 2 || element.fieldType === 1)) {\n                    return fieldCode;\n                }\n            }\n            inlineIndex = 0;\n        }\n        return fieldCode;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getTocFieldInternal = function () {\n        var paragraph = this.start.paragraph;\n        if (!this.isEmpty && !this.isForward) {\n            paragraph = this.end.paragraph;\n        }\n        while (paragraph instanceof ParagraphWidget && paragraph.childWidgets.length > 0) {\n            var line = paragraph.firstChild;\n            if (line.children.length > 0) {\n                var element = line.children[0];\n                var nextElement = element.nextNode;\n                if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                    && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                    return element;\n                }\n            }\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph in bodyWidget\n     * @private\n     */\n    Selection.prototype.getNextParagraph = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraph = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var bodyWidget = section.previousRenderedWidget;\n            var block = bodyWidget.childWidgets[bodyWidget.childWidgets.length - 1];\n            return this.getLastParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInCell = function (cell) {\n        var firstBlock = cell.childWidgets[0];\n        if (firstBlock instanceof ParagraphWidget) {\n            return firstBlock;\n        }\n        else {\n            return this.getFirstParagraphInFirstCell(firstBlock);\n        }\n    };\n    /**\n     * Get first paragraph in first cell\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInFirstCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var firstRow = table.childWidgets[0];\n            var cell = firstRow.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in last cell\n     * @private\n     */\n    Selection.prototype.getLastParagraphInLastCell = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastrow = table.lastChild;\n            var lastcell = lastrow.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in first row\n     * @private\n     */\n    Selection.prototype.getLastParagraphInFirstRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var row = table.firstChild;\n            var lastcell = row.lastChild;\n            var lastBlock = lastcell.lastChild;\n            return this.getLastParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get Next start inline\n     * @private\n     */\n    Selection.prototype.getNextStartInline = function (line, offset) {\n        var indexInInline = 0;\n        var inlineObj = line.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Get previous text inline\n     * @private\n     */\n    Selection.prototype.getPreviousTextInline = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (inline.previousNode instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline.previousNode)) {\n            if (inline.previousNode.fieldType === 0 || inline.previousNode.fieldType === 1) {\n                return inline.previousNode;\n            }\n            return inline.previousNode.fieldBegin;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextInline((inline.previousNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextInline = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (inline.nextNode instanceof FieldElementBox && (HelperMethods.isLinkedFieldCharacter(inline.nextNode))) {\n            if (inline.nextNode.fieldType === 1 || inline.nextNode.fieldType === 0) {\n                return inline.nextNode;\n            }\n            return inline.nextNode.fieldEnd;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextInline((inline.nextNode));\n        }\n        return undefined;\n    };\n    /**\n     * Get container table\n     * @private\n     */\n    Selection.prototype.getContainerTable = function (block) {\n        if (block.isInsideTable) {\n            if (block.associatedCell.ownerTable.isInsideTable) {\n                block = this.getContainerTable(block.associatedCell.ownerTable);\n            }\n            else {\n                block = block.associatedCell.ownerTable;\n            }\n        }\n        if (block instanceof TableWidget) {\n            return block;\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistBefore = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) < cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex < cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                }\n                //Checks if current block exists before the block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistBefore(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistBefore(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex < cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex < cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistBefore(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistBefore(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistBefore(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistBefore(start, ownerTable);\n        }\n        else {\n            {\n                if (start.containerWidget === block.containerWidget) {\n                    return start.index <\n                        block.index;\n                }\n                if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                    //Splitted blocks                     \n                    var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                    var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                    return startPage < endPage;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isExistAfter = function (start, block) {\n        if (start.isInsideTable) {\n            var cell1 = start.associatedCell;\n            //Current paragraph in cell, paragraph in cell\n            if (block.isInsideTable) {\n                var cell2 = block.associatedCell;\n                if (cell1 === cell2) {\n                    return cell1.childWidgets.indexOf(start) > cell1.childWidgets.indexOf(block);\n                }\n                if (cell1.ownerRow === cell2.ownerRow) {\n                    return cell1.cellIndex > cell2.cellIndex;\n                }\n                if (cell1.ownerTable === cell2.ownerTable) {\n                    return cell1.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                }\n                //Checks if this block exists before block.\n                var containerCell = this.getContainerCellOf(cell1, cell2);\n                if (containerCell.ownerTable.contains(cell2)) {\n                    cell1 = this.getSelectedCell(cell1, containerCell);\n                    cell2 = this.getSelectedCell(cell2, containerCell);\n                    if (cell1 === containerCell) {\n                        return this.isExistAfter(start, cell2.ownerTable);\n                    }\n                    if (cell2 === containerCell) {\n                        return this.isExistAfter(cell1.ownerTable, block);\n                    }\n                    if (containerCell.ownerRow === cell2.ownerRow) {\n                        return containerCell.cellIndex > cell2.cellIndex;\n                    }\n                    if (containerCell.ownerTable === cell2.ownerTable) {\n                        return containerCell.ownerRow.rowIndex > cell2.ownerRow.rowIndex;\n                    }\n                    return this.isExistAfter(cell1.ownerTable, cell2.ownerTable);\n                }\n                return this.isExistAfter(containerCell.ownerTable, this.getContainerTable(cell2.ownerTable));\n            }\n            else {\n                var ownerTable = this.getContainerTable(start);\n                return this.isExistAfter(ownerTable, block);\n            }\n        }\n        else if (block.isInsideTable) {\n            var ownerTable = this.getContainerTable(block);\n            return this.isExistAfter(start, ownerTable);\n        }\n        else {\n            if (start.containerWidget === block.containerWidget) {\n                return start.index >\n                    block.index;\n            }\n            if (start.containerWidget instanceof BodyWidget && block.containerWidget instanceof BodyWidget) {\n                //Splitted blocks                     \n                var startPage = this.viewer.pages.indexOf(start.containerWidget.page);\n                var endPage = this.viewer.pages.indexOf(block.containerWidget.page);\n                return startPage > endPage;\n            }\n            //     if (start.owner instanceof WHeaderFooter) {\n            //         return (start.owner as WHeaderFooter).childWidgets.indexOf(start) \n            // > (block.owner as WHeaderFooter).childWidgets.indexOf(block);\n            //     } else if (start.section === block.section && start.section instanceof WSection) {\n            //         return (start.section as WSection).childWidgets.indexOf(start)\n            //  > (start.section as WSection).childWidgets.indexOf(block);\n            //     } else if (start.wordDocument instanceof WordDocument) {\n            // tslint:disable-next-line:max-line-length\n            //         return (start.wordDocument as WordDocument).sections.indexOf(start.section as WSection) > (start.wordDocument as WordDocument).sections.indexOf(block.section as WSection);\n        }\n        return false;\n    };\n    /**\n     * Return true if current inline in exist before inline\n     * @private\n     */\n    Selection.prototype.isExistBeforeInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) <\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                < inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) <\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) <\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistBefore(startParagraph, endParagraph);\n    };\n    /**\n     * Return true id current inline is exist after inline\n     * @private\n     */\n    Selection.prototype.isExistAfterInline = function (currentInline, inline) {\n        if (currentInline.line === inline.line) {\n            return currentInline.line.children.indexOf(currentInline) >\n                inline.line.children.indexOf(inline);\n        }\n        if (currentInline.line.paragraph === inline.line.paragraph) {\n            return currentInline.line.paragraph.childWidgets.indexOf(currentInline.line)\n                > inline.line.paragraph.childWidgets.indexOf(inline.line);\n        }\n        var startParagraph = currentInline.line.paragraph;\n        var endParagraph = inline.line.paragraph;\n        if (startParagraph.containerWidget === endParagraph.containerWidget) {\n            if (startParagraph.isInsideTable) {\n                return startParagraph.associatedCell.childWidgets.indexOf(startParagraph) >\n                    endParagraph.associatedCell.childWidgets.indexOf(endParagraph);\n            }\n            else if (startParagraph.containerWidget instanceof HeaderFooterWidget) {\n                // return ((currentInline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(currentInline.owner as WParagraph) <\n                //     ((inline.owner as WParagraph).owner as WHeaderFooter).blocks.indexOf(inline.owner as WParagraph);\n            }\n            else {\n                return startParagraph.containerWidget.childWidgets.indexOf(startParagraph) >\n                    endParagraph.containerWidget.childWidgets.indexOf(endParagraph);\n            }\n        }\n        return this.isExistAfter(startParagraph, endParagraph);\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getNextRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.nextWidget)) {\n            return block.nextRenderedWidget;\n        }\n        return block.nextWidget;\n    };\n    /**\n     * Get next rendered block\n     * @private\n     */\n    Selection.prototype.getPreviousRenderedBlock = function (block) {\n        if (isNullOrUndefined(block.previousWidget)) {\n            return block.previousRenderedWidget;\n        }\n        return block.previousWidget;\n    };\n    /**\n     * Get Next paragraph in block\n     * @private\n     */\n    Selection.prototype.getNextParagraphBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block.nextRenderedWidget);\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextParagraphCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            var bodyWidget = block.containerWidget;\n            return this.getNextParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getFirstBlockInNextHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlockInNextHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var nextBlock;\n        if (headerFooter.headerFooterType.indexOf('Header') !== -1) {\n            nextBlock = headerFooter.page.footerWidget.firstChild;\n        }\n        else if (headerFooter.page.nextPage) {\n            nextBlock = headerFooter.page.nextPage.headerWidget.firstChild;\n        }\n        else {\n            return undefined;\n        }\n        if (nextBlock instanceof ParagraphWidget) {\n            return nextBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(nextBlock);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLastBlockInPreviousHeaderFooter = function (block) {\n        var headerFooter = block.containerWidget;\n        var previousBlock;\n        if (headerFooter.headerFooterType.indexOf('Footer') !== -1) {\n            previousBlock = headerFooter.page.headerWidget.lastChild;\n        }\n        else if (headerFooter.page.previousPage) {\n            previousBlock = headerFooter.page.previousPage.footerWidget.lastChild;\n        }\n        else {\n            return undefined;\n        }\n        if (previousBlock instanceof ParagraphWidget) {\n            return previousBlock;\n        }\n        else {\n            return this.getFirstBlockInFirstCell(previousBlock);\n        }\n    };\n    /**\n     * Get previous paragraph in block\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            return this.getLastParagraphInLastCell((block.previousRenderedWidget));\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousParagraphCell((block.containerWidget));\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousParagraph(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget && this.isMoveDownOrMoveUp) {\n            return this.getLastBlockInPreviousHeaderFooter(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get first paragraph in block\n     * @private\n     */\n    Selection.prototype.getFirstParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getFirstParagraphInFirstCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Get last paragraph in block\n     * @private\n     */\n    Selection.prototype.getLastParagraphBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            return block;\n        }\n        else if (block instanceof TableWidget) {\n            return this.getLastParagraphInLastCell(block);\n        }\n        return undefined;\n    };\n    /**\n     * Return true if paragraph has valid inline\n     * @private\n     */\n    Selection.prototype.hasValidInline = function (paragraph, start, end) {\n        var index = paragraph.childWidgets.indexOf(start.line);\n        for (var i = index; i < paragraph.childWidgets.length; i++) {\n            for (var j = 0; j < paragraph.childWidgets[i].children.length; j++) {\n                var inline = paragraph.childWidgets[i].children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (inline === end) {\n                    return false;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    /**\n     * Get paragraph length\n     * @private\n     */\n    Selection.prototype.getParagraphLength = function (paragraph, endLine, elementInfo) {\n        var length = 0;\n        for (var j = 0; j < paragraph.childWidgets.length; j++) {\n            var line = paragraph.childWidgets[j];\n            if (endLine instanceof LineWidget && endLine === line) {\n                if (elementInfo) {\n                    length += this.getLineLength(line, elementInfo);\n                }\n                break;\n            }\n            length += this.getLineLength(line);\n        }\n        return length;\n    };\n    /**\n     * Get Line length\n     * @private\n     */\n    Selection.prototype.getLineLength = function (line, elementInfo) {\n        var length = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (elementInfo && elementInfo.element instanceof ElementBox && elementInfo.element === element) {\n                length += elementInfo.index;\n                break;\n            }\n            length += element.length;\n        }\n        return length;\n    };\n    /**\n     * Get line information\n     * @private\n     */\n    Selection.prototype.getLineInfo = function (paragraph, offset) {\n        var line = undefined;\n        var length = 0;\n        var childLength = paragraph.childWidgets.length;\n        for (var j = 0; j < childLength; j++) {\n            line = paragraph.childWidgets[j];\n            length = this.getLineLength(line);\n            if (offset <= length || j === childLength - 1) {\n                break;\n            }\n            else {\n                offset = offset - length;\n            }\n        }\n        return { 'line': line, 'offset': offset };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementInfo = function (line, offset) {\n        var index = 0;\n        var element = undefined;\n        for (var i = 0; i < line.children.length; i++) {\n            element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset > element.length\n                && (!(offset === element.length + 1 && isNullOrUndefined(element.nextNode)))) {\n                offset = offset - element.length;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'index': offset };\n    };\n    /**\n     * Get paragraph start offset\n     * @private\n     */\n    Selection.prototype.getStartOffset = function (paragraph) {\n        var startOffset = 0;\n        if (paragraph.childWidgets.length > 0) {\n            var childWidgets = paragraph.childWidgets[0];\n            return this.getStartLineOffset(childWidgets);\n        }\n        return startOffset;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getStartLineOffset = function (line) {\n        var startOffset = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0) {\n                continue;\n            }\n            if (inline instanceof TextElementBox || inline instanceof ImageElementBox || inline instanceof BookmarkElementBox\n                || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                return startOffset;\n            }\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            startOffset += inline.length;\n        }\n        return startOffset;\n    };\n    /**\n     * Get previous paragraph from selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var block = cell.previousRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n            }\n            else {\n                var widgets = cell.previousRenderedWidget.childWidgets;\n                var block = widgets[widgets.length - 1];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(block.childWidgets[block.childWidgets.length - 1]);\n                }\n            }\n        }\n        return this.getPreviousSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get previous paragraph selection in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            if (!this.isForward) {\n                var cell = row.previousRenderedWidget.childWidgets[0];\n                var block = cell.childWidgets[0];\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getPreviousParagraphSelection(row.previousRenderedWidget);\n            }\n        }\n        return this.getPreviousSelectionBlock(row.ownerTable);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextSelectionBlock = function (block) {\n        if (block.nextRenderedWidget instanceof ParagraphWidget) {\n            return block.nextRenderedWidget;\n        }\n        else if (block.nextRenderedWidget instanceof TableWidget) {\n            if (this.isEmpty || this.isForward) {\n                return this.getLastParagraphInFirstRow(block.nextRenderedWidget);\n            }\n            else {\n                return this.getNextParagraphSelection(block.nextRenderedWidget.childWidgets[0]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getNextSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getNextSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get next paragraph from selected cell\n     * @private\n     */\n    Selection.prototype.getNextSelectionCell = function (cell) {\n        if (!isNullOrUndefined(cell.nextRenderedWidget)) {\n            if (this.isEmpty || this.isForward) {\n                // tslint:disable-next-line:max-line-length\n                var block = cell.nextRenderedWidget.childWidgets[cell.nextRenderedWidget.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                //Return first paragraph in cell. \n                var block = cell.nextRenderedWidget.childWidgets[0];\n                if (block instanceof ParagraphWidget) {\n                    return block;\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return this.getNextSelectionRow(cell.ownerRow);\n    };\n    /**\n     * Get next paragraph in selection\n     * @private\n     */\n    Selection.prototype.getNextSelectionRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var isForwardSelection = this.isEmpty || this.isForward;\n            if (isForwardSelection) {\n                // tslint:disable-next-line:max-line-length\n                var cell = row.nextRenderedWidget.childWidgets[row.nextRenderedWidget.childWidgets.length - 1];\n                var block = cell.childWidgets[cell.childWidgets.length - 1];\n                return this.getLastParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphSelection(row.nextRenderedWidget);\n            }\n        }\n        return this.getNextSelectionBlock(row.ownerTable);\n    };\n    /**\n     * Get next block with selection\n     * @private\n     */\n    Selection.prototype.getNextSelection = function (section) {\n        if (section.nextRenderedWidget instanceof BodyWidget) {\n            var block = section.nextRenderedWidget.childWidgets[0];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (this.isEmpty || this.isForward) {\n                    return this.getLastParagraphInFirstRow(block);\n                }\n                else {\n                    return this.getNextParagraphSelection(block.childWidgets[0]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[0];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getFirstCellInRegion(row, startCell, this.upDownSelectionLength, false);\n        }\n        var block = cell.childWidgets[0];\n        return this.getFirstParagraphBlock(block);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousSelectionBlock = function (block) {\n        if (block.previousRenderedWidget instanceof ParagraphWidget) {\n            return block.previousRenderedWidget;\n        }\n        else if (block.previousRenderedWidget instanceof TableWidget) {\n            if (!this.isForward) {\n                return this.getFirstParagraphInLastRow(block.previousRenderedWidget);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                return this.getPreviousParagraphSelection(block.previousRenderedWidget.childWidgets[block.previousRenderedWidget.childWidgets.length - 1]);\n            }\n        }\n        if (block.containerWidget instanceof TableCellWidget) {\n            return this.getPreviousSelectionCell(block.containerWidget);\n        }\n        else if (block.containerWidget instanceof BodyWidget) {\n            return this.getPreviousSelection(block.containerWidget);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous paragraph in selection\n     * @private\n     */\n    Selection.prototype.getPreviousSelection = function (section) {\n        if (section.previousRenderedWidget instanceof BodyWidget) {\n            var prevBodyWidget = section.previousRenderedWidget;\n            var block = prevBodyWidget.childWidgets[prevBodyWidget.childWidgets.length - 1];\n            if (block instanceof ParagraphWidget) {\n                return block;\n            }\n            else {\n                if (!this.isForward) {\n                    return this.getFirstParagraphInLastRow(block);\n                }\n                else {\n                    var tableWidget = block;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getPreviousParagraphSelection(tableWidget.childWidgets[tableWidget.childWidgets.length - 1]);\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphSelection = function (row) {\n        //Iterate the exact cell based on UP/Down selection length.\n        var cell = row.childWidgets[row.childWidgets.length - 1];\n        if (this.start.paragraph.isInsideTable\n            && row.ownerTable.contains(this.start.paragraph.associatedCell)) {\n            var startCell = this.getCellInTable(row.ownerTable, this.start.paragraph.associatedCell);\n            cell = this.getLastCellInRegion(row, startCell, this.upDownSelectionLength, true);\n        }\n        var block = cell.childWidgets[cell.childWidgets.length - 1];\n        return this.getLastParagraphBlock(block);\n    };\n    /**\n     * Get last cell in the selected region\n     * @private\n     */\n    Selection.prototype.getLastCellInRegion = function (row, startCell, selLength, isMovePrev) {\n        var start = this.getCellLeft(row, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var flag = true;\n        if (start <= selLength && selLength < end) {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        else {\n            for (var i = row.childWidgets.length - 1; i >= 0; i--) {\n                var left = this.getCellLeft(row, row.childWidgets[i]);\n                if (left <= selLength && left + row.childWidgets[i].cellFormat.cellWidth > selLength) {\n                    flag = false;\n                    return row.childWidgets[i];\n                }\n            }\n        }\n        if (flag) {\n            if (!isNullOrUndefined(row.previousRenderedWidget) && isMovePrev) {\n                return this.getLastCellInRegion(row.previousRenderedWidget, startCell, selLength, isMovePrev);\n            }\n            else if (!isNullOrUndefined(row.nextRenderedWidget) && !isMovePrev) {\n                return this.getLastCellInRegion(row.nextRenderedWidget, startCell, selLength, isMovePrev);\n            }\n        }\n        return row.childWidgets[row.childWidgets.length - 1];\n    };\n    /**\n     * Get Container table\n     * @private\n     */\n    Selection.prototype.getCellInTable = function (table, tableCell) {\n        while (tableCell.ownerTable.isInsideTable) {\n            if (table.equals(tableCell.ownerTable)) {\n                return tableCell;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return tableCell;\n    };\n    /**\n     * Get first paragraph in last row\n     * @private\n     */\n    Selection.prototype.getFirstParagraphInLastRow = function (table) {\n        if (table.childWidgets.length > 0) {\n            var lastRow = table.childWidgets[table.childWidgets.length - 1];\n            var lastCell = lastRow.childWidgets[0];\n            var lastBlock = lastCell.childWidgets[0];\n            return this.getFirstParagraphBlock(lastBlock);\n        }\n        return undefined;\n    };\n    /**\n     * Get previous valid offset\n     * @private\n     */\n    Selection.prototype.getPreviousValidOffset = function (paragraph, offset) {\n        if (offset === 0) {\n            return 0;\n        }\n        var validOffset = 0;\n        var count = 0;\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (inline.length === 0) {\n                    continue;\n                }\n                if (offset <= count + inline.length) {\n                    return offset - 1 === count ? validOffset : offset - 1;\n                }\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    validOffset = count + inline.length;\n                }\n                count += inline.length;\n            }\n        }\n        return offset - 1 === count ? validOffset : offset - 1;\n    };\n    /**\n     * Get next valid offset\n     * @private\n     */\n    Selection.prototype.getNextValidOffset = function (line, offset) {\n        var count = 0;\n        for (var i = 0; i < line.children.length; i++) {\n            var inline = line.children[i];\n            if (inline.length === 0 || inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                if (inline instanceof TextElementBox || inline instanceof ImageElementBox\n                    || (inline instanceof FieldElementBox && HelperMethods.isLinkedFieldCharacter(inline))) {\n                    return (offset > count ? offset : count) + 1;\n                }\n            }\n            count += inline.length;\n        }\n        return offset;\n    };\n    /**\n     * Get paragraph mark size info\n     * @private\n     */\n    Selection.prototype.getParagraphMarkSize = function (paragraph, topMargin, bottomMargin) {\n        var size = this.viewer.textHelper.getParagraphMarkSize(paragraph.characterFormat);\n        var baselineOffset = size.BaselineOffset;\n        var maxHeight = size.Height;\n        var maxBaselineOffset = baselineOffset;\n        if (paragraph instanceof ParagraphWidget) {\n            // let paragraphWidget: ParagraphWidget[] = paragraph.renderedElement() as ParagraphWidget[];\n            if (paragraph.childWidgets.length > 0) {\n                var lineWidget = paragraph.childWidgets[0];\n            }\n            //Gets line spacing.\n            var lineSpacing = this.viewer.layout.getLineSpacing(paragraph, maxHeight);\n            var beforeSpacing = this.viewer.layout.getBeforeSpacing(paragraph);\n            topMargin = maxBaselineOffset - baselineOffset;\n            bottomMargin = maxHeight - maxBaselineOffset - (size.Height - baselineOffset);\n            //Updates line spacing, paragraph after/ before spacing and aligns the text to base line offset.\n            var lineSpacingType = paragraph.paragraphFormat.lineSpacingType;\n            if (lineSpacingType === 'Multiple') {\n                if (lineSpacing > maxHeight) {\n                    bottomMargin += lineSpacing - maxHeight;\n                }\n                else {\n                    topMargin += lineSpacing - maxHeight;\n                }\n            }\n            else if (lineSpacingType === 'Exactly') {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            else if (lineSpacing > topMargin + size.Height + bottomMargin) {\n                topMargin += lineSpacing - (topMargin + size.Height + bottomMargin);\n            }\n            topMargin += beforeSpacing;\n            bottomMargin += paragraph.paragraphFormat.afterSpacing;\n        }\n        return { 'width': size.Width, 'height': size.Height, 'topMargin': topMargin, 'bottomMargin': bottomMargin };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInternal = function (line, offset, moveNextLine) {\n        if (line.paragraph.isEmpty()) {\n            var paragraphWidget = line.paragraph;\n            var left = paragraphWidget.x;\n            if (paragraphWidget.childWidgets.length > 0) {\n                var lineWidget = paragraphWidget.childWidgets[0];\n                left = this.getLeft(lineWidget);\n            }\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(line.paragraph, topMargin, bottomMargin);\n            if (offset > 0) {\n                left += size.width;\n            }\n            return new Point(left, paragraphWidget.y + topMargin);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = line.getInline(offset, indexInInline);\n            var inline = inlineObj.element; //return indexInInline must\n            indexInInline = inlineObj.index;\n            // tslint:disable-next-line:max-line-length\n            // if (inline.length === indexInInline && !isNullOrUndefined(inline.nextNode) && this.viewer.renderedElements.containsKey(inline) &&\n            //     this.viewer.renderedElements.get(inline).length > 0 && this.viewer.renderedElements.containsKey(inline.nextNode as WInline)\n            //     && this.viewer.renderedElements.get(inline.nextNode as WInline).length > 0 &&\n            // tslint:disable-next-line:max-line-length\n            //     (this.viewer.renderedElements.get(inline)[this.viewer.renderedElements.get(inline).length - 1] as ElementBox).line !== (this.viewer.renderedElements.get(inline.nextNode as WInline)[0] as ElementBox).line) {\n            //     //Handled specifically to move the cursor at start of next line.\n            //     inline = inline.nextNode as WInline;\n            //     indexInInline = 0;\n            // }\n            return this.getPhysicalPositionInline(inline, indexInInline, moveNextLine);\n        }\n    };\n    /**\n     * Highlight selected content\n     * @private\n     */\n    Selection.prototype.highlightSelectedContent = function (start, end) {\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || (!start.paragraph.associatedCell.equals(end.paragraph.associatedCell))\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.highlightCell(start.paragraph.associatedCell, this, start, end);\n        }\n        else {\n            var inline = undefined;\n            var index = 0;\n            if (!this.owner.isReadOnlyMode && start.paragraph === end.paragraph) {\n                if (start.offset + 1 === end.offset) {\n                    var inlineObj = end.currentWidget.getInline(end.offset, index);\n                    inline = inlineObj.element; // return index value\n                    index = inlineObj.index;\n                    if (inline instanceof ImageElementBox) {\n                        var startOffset = start.currentWidget.getOffset(inline, 0);\n                        if (startOffset !== start.offset) {\n                            inline = undefined;\n                        }\n                    }\n                }\n                else {\n                    var indexInInline = 0;\n                    var startInlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n                    var startInline = startInlineObj.element; //return indexInInline\n                    indexInInline = startInlineObj.index;\n                    if (indexInInline === startInline.length) {\n                        startInline = this.getNextRenderedElementBox(startInline, indexInInline);\n                    }\n                    var endInlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n                    var endInline = endInlineObj.element; //return indexInInline\n                    indexInInline = endInlineObj.index;\n                    // tslint:disable-next-line:max-line-length\n                    if (startInline instanceof FieldElementBox && endInline instanceof FieldElementBox && !isNullOrUndefined(startInline.fieldSeparator)) {\n                        var fieldValue = startInline.fieldSeparator.nextNode;\n                        if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                            inline = fieldValue;\n                        }\n                    }\n                }\n            }\n            if (!this.owner.isReadOnlyMode && inline instanceof ImageElementBox && this.owner.isDocumentLoaded) {\n                var elementBoxObj = this.getElementBoxInternal(inline, index);\n                var elementBox = elementBoxObj.element; //return index \n                index = elementBoxObj.index;\n                if (this.owner.enableImageResizerMode) {\n                    this.owner.imageResizerModule.positionImageResizer(elementBox);\n                    this.owner.imageResizerModule.showImageResizer();\n                }\n                if (this.viewer.isTouchInput) {\n                    this.viewer.touchStart.style.display = 'none';\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n            }\n            else {\n                this.highlight(start.paragraph, start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlight = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = undefined;\n        var endElement = undefined;\n        var startLineWidget = undefined;\n        var endLineWidget = undefined;\n        //return start Element and selection start index\n        var startLineObj = this.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        startElement = startLineObj.element;\n        if (isNullOrUndefined(startElement)) {\n            startLineWidget = paragraph.childWidgets[0];\n        }\n        else {\n            startLineWidget = startElement.line;\n        }\n        selectionStartIndex = startLineObj.index;\n        var endLineObj = this.getEndLineWidget(end, endElement, selectionEndIndex);\n        endElement = endLineObj.element;\n        if (endElement) {\n            endLineWidget = endElement.line;\n        }\n        else {\n            endLineWidget = end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        }\n        selectionEndIndex = endLineObj.index;\n        var top = 0;\n        var left = 0;\n        if (!isNullOrUndefined(startLineWidget)) {\n            top = this.getTop(startLineWidget);\n            left = this.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        }\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //Selection ends in current line.\n            var right = this.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                var x = startLineWidget.paragraph.x;\n                this.createHighlightBorder(startLineWidget, this.getWidth(startLineWidget, true) - (left - x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or selection end.                                             \n                this.highlightParagraph(paragraph, lineIndex + 1, endLineWidget, endElement, selectionEndIndex);\n                if (paragraph.childWidgets.indexOf(end.currentWidget) !== -1) {\n                    return;\n                }\n            }\n            this.highlightNextBlock(paragraph, start, end);\n        }\n    };\n    Selection.prototype.highlightNextBlock = function (paragraph, start, end) {\n        var block = paragraph.nextRenderedWidget;\n        if (!isNullOrUndefined(block)) {\n            if (block instanceof ParagraphWidget) {\n                this.highlight(block, start, end);\n            }\n            else {\n                this.highlightTable(block, start, end);\n            }\n        }\n    };\n    /**\n     * Get start line widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getStartLineWidget = function (paragraph, start, startElement, selectionStartIndex) {\n        var offset = paragraph === start.paragraph ? start.offset : this.getStartOffset(paragraph);\n        var startInlineObj = undefined;\n        if (paragraph === start.paragraph) {\n            startInlineObj = start.currentWidget.getInline(offset, selectionStartIndex);\n        }\n        else {\n            startInlineObj = paragraph.firstChild.getInline(offset, selectionStartIndex);\n        }\n        startElement = startInlineObj.element; //return selectionStartIndex\n        selectionStartIndex = startInlineObj.index;\n        if (startElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(startElement, selectionStartIndex);\n            startElement = inlineInfo.element;\n            selectionStartIndex = inlineInfo.index;\n        }\n        if (offset === this.getParagraphLength(start.paragraph) + 1) {\n            selectionStartIndex++;\n        }\n        return {\n            'index': selectionStartIndex, 'element': startElement\n        };\n    };\n    /**\n     * Get end line widget\n     * @private\n     */\n    Selection.prototype.getEndLineWidget = function (end, endElement, selectionEndIndex) {\n        var endInlineObj = end.currentWidget.getInline(end.offset, selectionEndIndex);\n        endElement = endInlineObj.element; //return selection end index\n        selectionEndIndex = endInlineObj.index;\n        if (endElement instanceof FieldElementBox) {\n            var inlineInfo = this.getRenderedInline(endElement, selectionEndIndex);\n            endElement = inlineInfo.element;\n            selectionEndIndex = inlineInfo.index;\n        }\n        var lineIndex = end.paragraph.childWidgets.indexOf(end.currentWidget);\n        if (lineIndex === end.paragraph.childWidgets.length - 1 && end.offset === this.getLineLength(end.currentWidget) + 1) {\n            selectionEndIndex = endElement ? endElement.length + 1 : 1;\n        }\n        return { 'index': selectionEndIndex, 'element': endElement };\n    };\n    /**\n     * Get line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternal = function (line, offset, moveToNextLine) {\n        var lineWidget = undefined;\n        if (line.children.length === 0 && line instanceof LineWidget) {\n            lineWidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            lineWidget = inline instanceof ElementBox ? inline.line\n                : this.getLineWidgetInternalInline(inline, indexInInline, moveToNextLine);\n        }\n        return lineWidget;\n    };\n    /**\n     * Get last line widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParagraph = function (offset, line) {\n        var linewidget = undefined;\n        if (line.children.length === 0) {\n            linewidget = line;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineInfo = line.getInline(offset, indexInInline);\n            var inline = inlineInfo.element;\n            indexInInline = inlineInfo.index;\n            linewidget = this.getLineWidget(inline, indexInInline);\n        }\n        return linewidget;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    // tslint:disable-next-line:max-line-length    \n    Selection.prototype.highlightCells = function (table, startCell, endCell) {\n        var start = this.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > this.upDownSelectionLength) {\n            start = this.upDownSelectionLength;\n        }\n        if (end < this.upDownSelectionLength) {\n            end = this.upDownSelectionLength;\n        }\n        var tableWidgetCollection = table.getSplitWidgets();\n        var startTableIndex = tableWidgetCollection.indexOf(startCell.ownerRow.ownerTable);\n        var endTableIndex = tableWidgetCollection.indexOf(endCell.ownerRow.ownerTable);\n        if (startTableIndex === endTableIndex) {\n            var count = table.childWidgets.indexOf(endCell.ownerRow);\n            for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n                this.highlightRow(table.childWidgets[i], start, end);\n            }\n        }\n        else {\n            var startRowIndex = 0;\n            var endRowIndex = 0;\n            for (var i = startTableIndex; i <= endTableIndex; i++) {\n                table = tableWidgetCollection[i];\n                if (i === startTableIndex) {\n                    startRowIndex = table.childWidgets.indexOf(startCell.ownerRow);\n                }\n                else {\n                    startRowIndex = 0;\n                }\n                if (i === endTableIndex) {\n                    endRowIndex = table.childWidgets.indexOf(endCell.ownerRow);\n                }\n                else {\n                    endRowIndex = table.childWidgets.length - 1;\n                }\n                for (var j = startRowIndex; j <= endRowIndex; j++) {\n                    this.highlightRow(table.childWidgets[j], start, end);\n                }\n            }\n        }\n    };\n    /* tslint:enable */\n    /**\n     * highlight selected table\n     * @private\n     */\n    Selection.prototype.highlightTable = function (table, start, end) {\n        this.highlightInternal(table.childWidgets[0], start, end);\n        if (!end.paragraph.isInsideTable //Selection end is outside the table cell.\n            || !table.contains(end.paragraph.associatedCell)) { //Selection end is not inside the current table.\n            this.highlightNextBlock(table, start, end);\n        }\n    };\n    /**\n     * Get cell left\n     * @private\n     */\n    Selection.prototype.getCellLeft = function (row, cell) {\n        var left = 0;\n        left += cell.x - cell.margin.left;\n        return left;\n    };\n    /**\n     * Get next paragraph for row\n     * @private\n     */\n    Selection.prototype.getNextParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.nextRenderedWidget)) {\n            var cell = row.nextRenderedWidget.childWidgets[0];\n            var block = cell.childWidgets[0];\n            return this.getFirstParagraphBlock(block);\n        }\n        return this.getNextParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Get previous paragraph from row\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphRow = function (row) {\n        if (!isNullOrUndefined(row.previousRenderedWidget)) {\n            // tslint:disable-next-line:max-line-length\n            var cell = row.previousRenderedWidget.lastChild;\n            var block = cell.lastChild ? cell.lastChild : (cell.previousSplitWidget).lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphBlock(row.ownerTable);\n    };\n    /**\n     * Return true if row contain cell\n     * @private\n     */\n    Selection.prototype.containsRow = function (row, tableCell) {\n        if (row.childWidgets.indexOf(tableCell) !== -1) {\n            return true;\n        }\n        while (tableCell.ownerTable.isInsideTable) {\n            if (row.childWidgets.indexOf(tableCell) !== -1) {\n                return true;\n            }\n            tableCell = tableCell.ownerTable.associatedCell;\n        }\n        return row.childWidgets.indexOf(tableCell) !== -1;\n    };\n    /**\n     * Highlight selected row\n     * @private\n     */\n    Selection.prototype.highlightRow = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var left = this.getCellLeft(row, row.childWidgets[i]);\n            if (HelperMethods.round(start, 2) <= HelperMethods.round(left, 2) &&\n                HelperMethods.round(left, 2) < HelperMethods.round(end, 2)) {\n                this.highlightCellWidget(row.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightInternal = function (row, start, end) {\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            this.highlightCellWidget(row.childWidgets[i]);\n        }\n        if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n            return;\n        }\n        else if (row.nextRenderedWidget instanceof TableRowWidget) {\n            this.highlightInternal(row.nextRenderedWidget, start, end);\n        }\n    };\n    /**\n     * Get last paragraph in cell\n     * @private\n     */\n    Selection.prototype.getLastParagraph = function (cell) {\n        while (cell.nextSplitWidget) {\n            if (cell.nextSplitWidget.childWidgets.length > 0) {\n                cell = cell.nextSplitWidget;\n            }\n            else {\n                break;\n            }\n        }\n        var lastBlock;\n        if (cell.childWidgets.length > 0) {\n            lastBlock = cell.lastChild;\n        }\n        else {\n            lastBlock = cell.previousSplitWidget.lastChild;\n        }\n        return this.getLastParagraphBlock(lastBlock);\n    };\n    /**\n     * Return true is source cell contain cell\n     * @private\n     */\n    Selection.prototype.containsCell = function (sourceCell, cell) {\n        if (sourceCell.equals(cell)) {\n            return true;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (sourceCell.equals(cell.ownerTable.associatedCell)) {\n                return true;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return false;\n    };\n    /**\n     * Return true if cell is selected\n     * @private\n     */\n    Selection.prototype.isCellSelected = function (cell, startPosition, endPosition) {\n        var lastParagraph = this.getLastParagraph(cell);\n        // tslint:disable-next-line:max-line-length\n        var isAtCellEnd = lastParagraph === endPosition.paragraph && endPosition.offset === this.getParagraphLength(lastParagraph) + 1;\n        return isAtCellEnd || (!this.containsCell(cell, startPosition.paragraph.associatedCell) ||\n            !this.containsCell(cell, endPosition.paragraph.associatedCell));\n    };\n    /**\n     * Return Container cell\n     * @private\n     */\n    Selection.prototype.getContainerCellOf = function (cell, tableCell) {\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.contains(tableCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Get Selected cell\n     * @private\n     */\n    Selection.prototype.getSelectedCell = function (cell, containerCell) {\n        if (cell.ownerTable.equals(containerCell.ownerTable)) {\n            return cell;\n        }\n        while (cell.ownerTable.isInsideTable) {\n            if (cell.ownerTable.associatedCell.equals(containerCell)) {\n                return cell;\n            }\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getSelectedCells = function () {\n        var cells = [];\n        for (var i = 0; i < this.selectedWidgets.keys.length; i++) {\n            var widget = this.selectedWidgets.keys[i];\n            if (widget instanceof TableCellWidget) {\n                cells.push(widget);\n            }\n        }\n        return cells;\n    };\n    /**\n     * Get Next paragraph from cell\n     * @private\n     */\n    Selection.prototype.getNextParagraphCell = function (cell) {\n        if (cell.nextRenderedWidget && cell.nextRenderedWidget instanceof TableCellWidget) {\n            //Return first paragraph in cell.            \n            cell = cell.nextRenderedWidget;\n            var block = cell.firstChild;\n            if (block) {\n                return this.getFirstParagraphBlock(block);\n            }\n            else {\n                return this.getNextParagraphCell(cell);\n            }\n        }\n        return this.getNextParagraphRow(cell.containerWidget);\n    };\n    /**\n     * Get previous paragraph from cell\n     * @private\n     */\n    Selection.prototype.getPreviousParagraphCell = function (cell) {\n        if (!isNullOrUndefined(cell.previousRenderedWidget) && cell.previousRenderedWidget instanceof TableCellWidget) {\n            cell = cell.previousRenderedWidget;\n            var block = cell.lastChild;\n            return this.getLastParagraphBlock(block);\n        }\n        return this.getPreviousParagraphRow(cell.ownerRow);\n    };\n    /**\n     * Get cell's container cell\n     * @private\n     */\n    Selection.prototype.getContainerCell = function (cell) {\n        while (!isNullOrUndefined(cell.ownerTable) && cell.ownerTable.isInsideTable) {\n            cell = cell.ownerTable.associatedCell;\n        }\n        return cell;\n    };\n    /**\n     * Highlight selected cell\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.highlightCell = function (cell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    /* tslint:enable */\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.highlightCellWidget(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.highlight(start.paragraph, start, end);\n                        }\n                        else {\n                            this.highlightContainer(startCell, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Selection end is not in container cell.\n                    this.highlightCellWidget(containerCell);\n                    if (containerCell.ownerRow.equals(endCell.ownerRow)) {\n                        //Highlight other selected cells in current row.\n                        startCell = containerCell;\n                        while (!isNullOrUndefined(startCell.nextRenderedWidget)) {\n                            startCell = startCell.nextRenderedWidget;\n                            this.highlightCellWidget(startCell);\n                            if (startCell === endCell) {\n                                break;\n                            }\n                        }\n                    }\n                    else {\n                        this.highlightCells(containerCell.ownerTable, containerCell, endCell);\n                    }\n                }\n            }\n            else {\n                this.highlightContainer(containerCell, start, end);\n            }\n        }\n        else {\n            var cell1 = this.getContainerCell(cell);\n            this.highlightContainer(cell1, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.highlightContainer = function (cell, start, end) {\n        this.highlightInternal(cell.containerWidget, start, end);\n        this.highlightNextBlock(cell.ownerTable, start, end);\n    };\n    /**\n     * Get previous valid element\n     * @private\n     */\n    Selection.prototype.getPreviousValidElement = function (inline) {\n        var previousValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n                    previousValidInline = inline;\n                }\n                else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    previousValidInline = inline;\n                    if (isNullOrUndefined(inline.fieldSeparator)) {\n                        inline = inline.fieldBegin;\n                        previousValidInline = inline;\n                    }\n                }\n                else {\n                    inline = inline.fieldBegin;\n                    previousValidInline = inline;\n                }\n            }\n            inline = inline.previousNode;\n        }\n        return isNullOrUndefined(previousValidInline) ? inline : previousValidInline;\n    };\n    /**\n     * Get next valid element\n     * @private\n     */\n    Selection.prototype.getNextValidElement = function (inline) {\n        var nextValidInline = undefined;\n        while (inline instanceof FieldElementBox) {\n            if (inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                return isNullOrUndefined(nextValidInline) ? inline : nextValidInline;\n            }\n            else if (inline.fieldType === 1 && !isNullOrUndefined(inline.fieldBegin)) {\n                nextValidInline = inline;\n            }\n            inline = inline.nextNode;\n        }\n        return (isNullOrUndefined(nextValidInline) ? inline : nextValidInline);\n    };\n    /**\n     * Return next valid inline with index\n     * @private\n     */\n    Selection.prototype.validateTextPosition = function (inline, index) {\n        if (inline.length === index && inline.nextNode instanceof FieldElementBox) {\n            //If inline is last item within field, then set field end as text position.\n            var nextInline = this.getNextValidElement(inline.nextNode);\n            if (nextInline instanceof FieldElementBox && nextInline.fieldType === 1) {\n                inline = nextInline;\n                index = 1;\n            }\n        }\n        else if (index === 0 && inline.previousNode instanceof FieldElementBox) {\n            var prevInline = this.getPreviousValidElement(inline.previousNode);\n            inline = prevInline;\n            index = inline instanceof FieldElementBox ? 0 : inline.length;\n            if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                index++;\n            }\n        }\n        return { 'element': inline, 'index': index };\n    };\n    /**\n     * Get inline physical location\n     * @private\n     */\n    Selection.prototype.getPhysicalPositionInline = function (inline, index, moveNextLine) {\n        var element = undefined;\n        element = this.getElementBox(inline, index, moveNextLine).element;\n        var lineWidget = undefined;\n        if (isNullOrUndefined(element) || isNullOrUndefined(element.line)) {\n            if (inline instanceof FieldElementBox || inline instanceof BookmarkElementBox) {\n                return this.getFieldCharacterPosition(inline);\n            }\n            return new Point(0, 0);\n        }\n        var margin = element.margin;\n        var top = 0;\n        var left = 0;\n        if (element instanceof TextElementBox && element.text === '\\v' && isNullOrUndefined(inline.nextNode)) {\n            lineWidget = this.getNextLineWidget(element.line.paragraph, element);\n            index = 0;\n        }\n        else {\n            lineWidget = element.line;\n        }\n        top = this.getTop(lineWidget);\n        if (element instanceof ImageElementBox) {\n            var format = element.line.paragraph.characterFormat;\n            var previousInline = this.getPreviousTextElement(inline);\n            if (!isNullOrUndefined(previousInline)) {\n                format = previousInline.characterFormat;\n            }\n            else {\n                var nextInline = this.getNextTextElement(inline);\n                if (!isNullOrUndefined(nextInline)) {\n                    format = nextInline.characterFormat;\n                }\n            }\n            var measureObj = this.viewer.textHelper.getHeight(format);\n            if (element.margin.top + element.height - measureObj.BaselineOffset > 0) {\n                top += element.margin.top + element.height - measureObj.BaselineOffset;\n            }\n        }\n        else if (!(element instanceof FieldElementBox)) {\n            top += margin.top > 0 ? margin.top : 0;\n        }\n        left = (isNullOrUndefined(element) || isNullOrUndefined(lineWidget)) ? 0 : this.getLeftInternal(lineWidget, element, index);\n        return new Point(left, top);\n    };\n    /**\n     * Get field character position\n     * @private\n     */\n    Selection.prototype.getFieldCharacterPosition = function (firstInline) {\n        var nextValidInline = this.getNextValidElementForField(firstInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = firstInline.line.paragraph;\n            return this.getEndPosition(nextParagraph);\n        }\n        else {\n            return this.getPhysicalPositionInline(nextValidInline, 0, true);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextValidElementForField = function (firstInline) {\n        if (firstInline instanceof FieldElementBox && firstInline.fieldType === 0\n            && HelperMethods.isLinkedFieldCharacter(firstInline)) {\n            var fieldBegin = firstInline;\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                firstInline = fieldBegin.fieldEnd;\n            }\n            else {\n                firstInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(firstInline.nextNode)) {\n            nextValidInline = this.getNextValidElement(firstInline.nextNode);\n        }\n        return nextValidInline;\n    };\n    /**\n     * Get paragraph end position\n     * @private\n     */\n    Selection.prototype.getEndPosition = function (widget) {\n        var left = widget.x;\n        var top = widget.y;\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            left += this.getWidth(lineWidget, false);\n        }\n        if (!isNullOrUndefined(lineWidget)) {\n            top = this.getTop(lineWidget);\n        }\n        var topMargin = 0;\n        var bottomMargin = 0;\n        var size = this.getParagraphMarkSize(widget, topMargin, bottomMargin);\n        return new Point(left, top + size.topMargin);\n    };\n    /**\n     * Get element box\n     * @private\n     */\n    Selection.prototype.getElementBox = function (currentInline, index, moveToNextLine) {\n        var elementBox = undefined;\n        if (!(currentInline instanceof FieldElementBox || currentInline instanceof BookmarkElementBox)) {\n            elementBox = currentInline;\n        }\n        return { 'element': elementBox, 'index': index };\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getPreviousTextElement = function (inline) {\n        if (inline.previousNode instanceof TextElementBox) {\n            return inline.previousNode;\n        }\n        if (!isNullOrUndefined(inline.previousNode)) {\n            return this.getPreviousTextElement(inline.previousNode);\n        }\n        return undefined;\n    };\n    /**\n     * Get next text inline\n     * @private\n     */\n    Selection.prototype.getNextTextElement = function (inline) {\n        if (inline.nextNode instanceof TextElementBox) {\n            return inline.nextNode;\n        }\n        if (!isNullOrUndefined(inline.nextNode)) {\n            return this.getNextTextElement(inline.nextNode);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getNextRenderedElementBox = function (inline, indexInInline) {\n        if (inline instanceof FieldElementBox) {\n            var fieldBegin = inline;\n            if (fieldBegin.fieldType === 0) {\n                inline = this.getRenderedField(fieldBegin);\n                if (fieldBegin === inline) {\n                    return fieldBegin;\n                }\n            }\n            indexInInline = 1;\n        }\n        while (!isNullOrUndefined(inline) && indexInInline === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement((inline.nextNode));\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                var fieldBegin = nextValidInline;\n                inline = this.getRenderedField(fieldBegin);\n                if (!isNullOrUndefined(inline) && fieldBegin === inline) {\n                    return fieldBegin;\n                }\n                indexInInline = 1;\n            }\n            else {\n                inline = nextValidInline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getElementBoxInternal = function (inline, index) {\n        var element = undefined;\n        element = inline;\n        return {\n            'element': element, 'index': index\n        };\n    };\n    /**\n     * Get Line widget\n     * @private\n     */\n    Selection.prototype.getLineWidget = function (inline, index) {\n        return this.getLineWidgetInternalInline(inline, index, true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLineWidgetInternalInline = function (inline, index, moveToNextLine) {\n        var elementObj = this.getElementBox(inline, index, moveToNextLine);\n        var element = elementObj.element; //return index\n        index = elementObj.index;\n        if (!isNullOrUndefined(element)) {\n            if (moveToNextLine && element instanceof TextElementBox && element.text === '\\v' && index === 1) {\n                return this.getNextLineWidget(element.line.paragraph, element);\n            }\n            else {\n                return element.line;\n            }\n        }\n        var startInline = inline;\n        //ToDo: Check previous inline here.\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var lineWidget = undefined;\n            var widget = startInline.line.paragraph;\n            if (widget.childWidgets.length > 0) {\n                lineWidget = widget.childWidgets[widget.childWidgets.length - 1];\n            }\n            return lineWidget;\n        }\n        else {\n            return this.getLineWidget(nextValidInline, 0);\n        }\n    };\n    /**\n     * Get next line widget\n     * @private\n     */\n    Selection.prototype.getNextLineWidget = function (paragraph, element) {\n        var lineWidget = undefined;\n        var widget = paragraph;\n        if (widget.childWidgets.length > 0) {\n            var widgetIndex = widget.childWidgets.indexOf(element.line);\n            if (widgetIndex === widget.childWidgets.length - 1) {\n                widget = paragraph;\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widgetIndex = -1;\n            }\n            else if (widgetIndex > widget.childWidgets.length - 1) {\n                widget = this.getNextParagraphBlock(paragraph);\n                widgetIndex = -1;\n            }\n            else if (widgetIndex < 0) {\n                // widget = paragraph.leafWidgets[paragraph.leafWidgets.length - 1];\n                widget = paragraph;\n                widgetIndex = widget.childWidgets.indexOf(element.line);\n            }\n            lineWidget = widget.childWidgets[widgetIndex + 1];\n        }\n        return lineWidget;\n    };\n    /**\n     * Get Caret height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCaretHeight = function (inline, index, format, isEmptySelection, topMargin, isItalic) {\n        var elementBoxInfo = this.getElementBox(inline, index, false);\n        var element = elementBoxInfo.element;\n        var currentInline = inline;\n        if (isNullOrUndefined(element)) {\n            if (currentInline instanceof FieldElementBox) {\n                return this.getFieldCharacterHeight(currentInline, format, isEmptySelection, topMargin, isItalic);\n            }\n            return { 'height': this.viewer.textHelper.getHeight(format).Height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var margin = element.margin;\n        var heightElement = element.height;\n        var maxLineHeight = 0;\n        if (element instanceof ImageElementBox) {\n            var previousInline = this.getPreviousTextElement(inline);\n            var nextInline = this.getNextTextElement(inline);\n            if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n                var top_2 = 0;\n                var bottom = 0;\n                var paragarph = inline.line.paragraph;\n                var sizeInfo = this.getParagraphMarkSize(paragarph, top_2, bottom);\n                top_2 = sizeInfo.topMargin;\n                bottom = sizeInfo.bottomMargin;\n                maxLineHeight = sizeInfo.height;\n                isItalic = paragarph.characterFormat.italic;\n                if (!isEmptySelection) {\n                    maxLineHeight += paragarph.paragraphFormat.afterSpacing;\n                }\n            }\n            else if (isNullOrUndefined(previousInline)) {\n                isItalic = nextInline.characterFormat.italic;\n                return this.getCaretHeight(nextInline, 0, nextInline.characterFormat, isEmptySelection, topMargin, isItalic);\n            }\n            else {\n                if (!isNullOrUndefined(nextInline) && element instanceof ImageElementBox) {\n                    //Calculates the caret size using image character format.\n                    var textSizeInfo = this.viewer.textHelper.getHeight(element.characterFormat);\n                    var charHeight = textSizeInfo.Height;\n                    var baselineOffset = textSizeInfo.BaselineOffset;\n                    // tslint:disable-next-line:max-line-length\n                    maxLineHeight = (element.margin.top < 0 && baselineOffset > element.margin.top + element.height) ? element.margin.top + element.height + charHeight - baselineOffset : charHeight;\n                    if (!isEmptySelection) {\n                        maxLineHeight += element.margin.bottom;\n                    }\n                }\n                else {\n                    isItalic = previousInline.characterFormat.italic;\n                    // tslint:disable-next-line:max-line-length\n                    return this.getCaretHeight(previousInline, previousInline.length, previousInline.characterFormat, isEmptySelection, topMargin, isItalic);\n                }\n            }\n        }\n        else {\n            var baselineAlignment = format.baselineAlignment;\n            var elementHeight = heightElement;\n            if (baselineAlignment !== 'Normal' && isEmptySelection) {\n                //Set the caret height as sub/super script text height and updates the top margin for sub script text.\n                elementHeight = elementHeight / 1.5;\n                if (baselineAlignment === 'Subscript') {\n                    topMargin = heightElement - elementHeight;\n                }\n            }\n            maxLineHeight = (margin.top < 0 ? margin.top : 0) + elementHeight;\n            if (!isEmptySelection) {\n                maxLineHeight += margin.bottom;\n            }\n        }\n        if (!isEmptySelection) {\n            return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        var height = this.viewer.textHelper.getHeight(format).Height;\n        if (height > maxLineHeight) {\n            height = maxLineHeight;\n        }\n        return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n    };\n    /**\n     * Get field characters height\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getFieldCharacterHeight = function (startInline, format, isEmptySelection, topMargin, isItalic) {\n        var nextValidInline = this.getNextValidElementForField(startInline);\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            var nextParagraph = startInline.line.paragraph;\n            var height = this.viewer.textHelper.getParagraphMarkSize(format).Height;\n            var top_3 = 0;\n            var bottom = 0;\n            var sizeInfo = this.getParagraphMarkSize(nextParagraph, top_3, bottom);\n            var maxLineHeight = sizeInfo.height;\n            top_3 = sizeInfo.topMargin;\n            bottom = sizeInfo.bottomMargin;\n            if (!isEmptySelection) {\n                maxLineHeight += bottom;\n                return { 'height': maxLineHeight, 'topMargin': topMargin, 'isItalic': isItalic };\n            }\n            if (height > maxLineHeight) {\n                height = maxLineHeight;\n            }\n            return { 'height': height, 'topMargin': topMargin, 'isItalic': isItalic };\n        }\n        else {\n            return this.getCaretHeight(nextValidInline, 0, format, isEmptySelection, topMargin, isItalic);\n        }\n    };\n    /**\n     * Get rendered inline\n     * @private\n     */\n    //FieldCharacter\n    Selection.prototype.getRenderedInline = function (inline, inlineIndex) {\n        var prevInline = this.getPreviousValidElement(inline);\n        while (prevInline instanceof FieldElementBox) {\n            prevInline = this.getPreviousTextElement(prevInline);\n            if (prevInline instanceof FieldElementBox) {\n                prevInline = prevInline.previousNode;\n            }\n        }\n        if (!isNullOrUndefined(prevInline)) {\n            inlineIndex = prevInline.length;\n            return { 'element': prevInline, 'index': inlineIndex };\n        }\n        inlineIndex = 0;\n        var nextInline = this.getNextRenderedElementBox(inline, 0);\n        if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0) {\n            nextInline = nextInline.fieldSeparator;\n            nextInline = nextInline.nextNode;\n            while (nextInline instanceof FieldElementBox) {\n                if (nextInline instanceof FieldElementBox && nextInline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(nextInline)) {\n                    if (isNullOrUndefined(nextInline.fieldSeparator)) {\n                        nextInline = nextInline.fieldEnd;\n                    }\n                    else {\n                        nextInline = nextInline.fieldSeparator;\n                    }\n                }\n                nextInline = nextInline.nextNode;\n            }\n        }\n        return { 'element': nextInline, 'index': inlineIndex };\n    };\n    //Field Begin\n    /**\n     * Get rendered field\n     * @private\n     */\n    Selection.prototype.getRenderedField = function (fieldBegin) {\n        var inline = fieldBegin;\n        if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            inline = fieldBegin.fieldEnd;\n        }\n        else {\n            inline = fieldBegin.fieldSeparator;\n            var paragraph = inline.line.paragraph;\n            if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                inline = fieldBegin.fieldEnd;\n            }\n            else {\n                return inline;\n            }\n        }\n        return inline;\n    };\n    /**\n     * Return true is inline is tha last inline\n     * @private\n     */\n    Selection.prototype.isLastRenderedInline = function (inline, index) {\n        while (index === inline.length && inline.nextNode instanceof FieldElementBox) {\n            var nextValidInline = this.getNextValidElement(inline.nextNode);\n            index = 0;\n            if (nextValidInline instanceof FieldElementBox && nextValidInline.fieldType === 0) {\n                inline = nextValidInline;\n            }\n            if (inline instanceof FieldElementBox && inline.fieldType === 0 && !isNullOrUndefined(inline.fieldEnd)) {\n                var fieldBegin = inline;\n                if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    inline = fieldBegin.fieldEnd;\n                    index = 1;\n                }\n                else {\n                    inline = fieldBegin.fieldSeparator;\n                    var paragraph = inline.line.paragraph;\n                    index = 1;\n                    if (paragraph === fieldBegin.fieldEnd.line.paragraph\n                        && !this.hasValidInline(paragraph, inline, fieldBegin.fieldEnd)) {\n                        inline = fieldBegin.fieldEnd;\n                    }\n                    else {\n                        break;\n                    }\n                }\n            }\n        }\n        return index === inline.length && isNullOrUndefined(inline.nextNode);\n    };\n    /**\n     * Get page\n     * @private\n     */\n    Selection.prototype.getPage = function (widget) {\n        var page = undefined;\n        if (widget.containerWidget instanceof BlockContainer) {\n            var bodyWidget = widget.containerWidget;\n            page = widget.containerWidget.page;\n        }\n        else if (!isNullOrUndefined(widget.containerWidget)) {\n            page = this.getPage(widget.containerWidget);\n        }\n        return page;\n    };\n    /**\n     * Clear Selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightInSelectedWidgets = function () {\n        var isNonEmptySelection = false;\n        var widgets = this.selectedWidgets.keys;\n        for (var i = 0; i < widgets.length; i++) {\n            this.removeSelectionHighlight(widgets[i]);\n            isNonEmptySelection = true;\n        }\n        this.selectedWidgets.clear();\n        return isNonEmptySelection;\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearChildSelectionHighlight = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i] instanceof LineWidget) {\n                this.clearSelectionHighlightLineWidget(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof TableCellWidget) {\n                this.clearSelectionHighlight(widget.childWidgets[i]);\n            }\n            else if (widget.childWidgets[i] instanceof Widget) {\n                this.clearChildSelectionHighlight(widget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    //Body Widget\n    Selection.prototype.getLineWidgetBodyWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof Widget && childWidget.y <= point.y\n                && (childWidget.y + childWidget.height) >= point.y) {\n                if (childWidget instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(childWidget, point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(childWidget, point);\n                }\n            }\n        }\n        var line = undefined;\n        if (widget.childWidgets.length > 0) {\n            var firstChild = widget.childWidgets[0];\n            if (firstChild instanceof Widget && firstChild.y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    line = this.getLineWidgetTableWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n            }\n            else {\n                var childWidget = undefined;\n                if (firstChild instanceof Widget) {\n                    childWidget = firstChild;\n                }\n                if (!isNullOrUndefined(childWidget)) {\n                    if (childWidget instanceof ParagraphWidget) {\n                        line = this.getLineWidgetParaWidget(firstChild, point);\n                    }\n                    else {\n                        line = this.getLineWidgetTableWidget(firstChild, point);\n                    }\n                }\n            }\n        }\n        return line;\n    };\n    //ParagraphWidget\n    /**\n     * Get line widget from paragraph widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetParaWidget = function (widget, point) {\n        var childWidgets = widget.childWidgets;\n        var top = widget.y;\n        for (var i = 0; i < childWidgets.length; i++) {\n            if (top <= point.y\n                && (top + childWidgets[i].height) >= point.y) {\n                return childWidgets[i];\n            }\n            top += childWidgets[i].height;\n        }\n        var lineWidget = undefined;\n        if (childWidgets.length > 0) {\n            if (widget.y <= point.y) {\n                lineWidget = childWidgets[childWidgets.length - 1];\n            }\n            else {\n                lineWidget = childWidgets[0];\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * highlight paragraph widget\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.highlightParagraph = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var i = startIndex; i < widget.childWidgets.length; i++) {\n            var line = widget.childWidgets[i];\n            if (i === startIndex) {\n                top = this.getTop(line);\n            }\n            var left = this.getLeft(line);\n            if (line === endLine) {\n                //Selection ends in current line.\n                var right = this.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(line, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(line, this.getWidth(line, true) - (left - widget.x), left, top);\n            top += line.height;\n        }\n    };\n    //Table Widget\n    /**\n     * Get line widget form table widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetTableWidget = function (widget, point) {\n        var lineWidget = undefined;\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            //Removed the height condition check to handle the vertically merged cells.\n            var childWidget = widget.childWidgets[i];\n            if (childWidget instanceof TableRowWidget && childWidget.y <= point.y) {\n                lineWidget = this.getLineWidgetRowWidget(childWidget, point);\n                var cellWidget = undefined;\n                if (!isNullOrUndefined(lineWidget) && lineWidget.paragraph.containerWidget instanceof TableCellWidget) {\n                    cellWidget = lineWidget.paragraph.containerWidget;\n                }\n                var cellSpacing = 0;\n                var rowSpan = 0;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var tableWidget = cellWidget.ownerRow.containerWidget;\n                    cellSpacing = HelperMethods.convertPointToPixel(tableWidget.tableFormat.cellSpacing);\n                    rowSpan = cellWidget.cellFormat.rowSpan;\n                }\n                var leftCellSpacing = 0;\n                var rightCellSpacing = 0;\n                var topCellSpacing = 0;\n                var bottomCellSpacing = 0;\n                if (cellSpacing > 0) {\n                    leftCellSpacing = cellWidget.cellIndex === 0 ? cellSpacing : cellSpacing / 2;\n                    // tslint:disable-next-line:max-line-length\n                    rightCellSpacing = cellWidget.cellIndex === cellWidget.ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n                    var rowWidget = undefined;\n                    if (cellWidget.containerWidget instanceof TableRowWidget) {\n                        rowWidget = cellWidget.containerWidget;\n                    }\n                    var tableWidget = undefined;\n                    if (cellWidget.containerWidget.containerWidget instanceof TableWidget) {\n                        tableWidget = cellWidget.containerWidget.containerWidget;\n                    }\n                    if (!isNullOrUndefined(rowWidget) && !isNullOrUndefined(tableWidget)) {\n                        topCellSpacing = cellWidget.ownerRow.rowIndex === 0 ? cellSpacing : cellSpacing / 2;\n                        if (cellWidget.ownerRow.rowIndex + rowSpan === cellWidget.ownerTable.childWidgets.length) {\n                            bottomCellSpacing = cellSpacing;\n                        }\n                        else {\n                            bottomCellSpacing = cellSpacing / 2;\n                        }\n                    }\n                }\n                if ((!isNullOrUndefined(lineWidget) && lineWidget.paragraph.x <= point.x\n                    && lineWidget.paragraph.x + lineWidget.width >= point.x\n                    && lineWidget.paragraph.y <= point.y && this.getTop(lineWidget) + lineWidget.height >= point.y)\n                    || (!isNullOrUndefined(cellWidget) && cellWidget.x - cellWidget.margin.left - leftCellSpacing <= point.x\n                        && cellWidget.x + cellWidget.width + cellWidget.margin.right + rightCellSpacing >= point.x\n                        && cellWidget.y - cellWidget.margin.top - topCellSpacing <= point.y\n                        && cellWidget.y + cellWidget.height + cellWidget.margin.bottom + bottomCellSpacing >= point.y)) {\n                    break;\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //TableRowWidget\n    /**\n     * Get line widget fom row\n     * @private\n     */\n    Selection.prototype.getLineWidgetRowWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            var cellSpacing = 0;\n            cellSpacing = HelperMethods.convertPointToPixel(widget.ownerTable.tableFormat.cellSpacing);\n            var leftCellSpacing = 0;\n            var rightCellSpacing = 0;\n            if (cellSpacing > 0) {\n                leftCellSpacing = widget.childWidgets[i].columnIndex === 0 ? cellSpacing : cellSpacing / 2;\n                // tslint:disable-next-line:max-line-length\n                rightCellSpacing = widget.childWidgets[i].cellIndex === widget.childWidgets[i].ownerRow.childWidgets.length - 1 ? cellSpacing : cellSpacing / 2;\n            }\n            if (widget.childWidgets[i].x -\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].margin.left - leftCellSpacing <= point.x && (widget.childWidgets[i].x +\n                // tslint:disable-next-line:max-line-length\n                widget.childWidgets[i].width) + widget.childWidgets[i].margin.right + rightCellSpacing >= point.x) {\n                return this.getLineWidgetCellWidget(widget.childWidgets[i], point);\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].x <= point.x) {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n            }\n            else {\n                lineWidget = this.getLineWidgetCellWidget(widget.childWidgets[0], point);\n            }\n        }\n        return lineWidget;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getFirstBlock = function (cell) {\n        if (cell.childWidgets.length > 0) {\n            return cell.childWidgets[0];\n        }\n        return undefined;\n    };\n    //Table Cell Widget\n    /**\n     * Highlight selected cell widget\n     * @private\n     */\n    Selection.prototype.highlightCellWidget = function (widget) {\n        var widgets = [];\n        if (widget.previousSplitWidget || widget.nextSplitWidget) {\n            widgets = widget.getSplitWidgets();\n        }\n        else {\n            widgets.push(widget);\n        }\n        for (var i = 0; i < widgets.length; i++) {\n            widget = widgets[i];\n            //Clears Selection highlight of the child widgets.\n            this.clearChildSelectionHighlight(widget);\n            //Highlights the entire cell.\n            this.createHighlightBorderInsideTable(widget);\n        }\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlight = function (widget) {\n        if (this.selectedWidgets.containsKey(widget)) {\n            this.removeSelectionHighlight(widget);\n            this.selectedWidgets.remove(widget);\n        }\n    };\n    /**\n     * Get line widget from cell widget\n     * @private\n     */\n    Selection.prototype.getLineWidgetCellWidget = function (widget, point) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            if (widget.childWidgets[i].y <= point.y\n                && (widget.childWidgets[i].y + widget.childWidgets[i].height) >= point.y) {\n                if (widget.childWidgets[i] instanceof ParagraphWidget) {\n                    return this.getLineWidgetParaWidget(widget.childWidgets[i], point);\n                }\n                else {\n                    return this.getLineWidgetTableWidget(widget.childWidgets[i], point);\n                }\n            }\n        }\n        var lineWidget = undefined;\n        if (widget.childWidgets.length > 0) {\n            if (widget.childWidgets[0].y <= point.y) {\n                if (widget.childWidgets[widget.childWidgets.length - 1] instanceof ParagraphWidget) {\n                    // tslint:disable-next-line:max-line-length\n                    lineWidget = this.getLineWidgetParaWidget(widget.childWidgets[widget.childWidgets.length - 1], point);\n                }\n                else {\n                    lineWidget = this.getLineWidgetTableWidget(widget.childWidgets[0], point);\n                }\n            }\n        }\n        return lineWidget;\n    };\n    //LineWidget\n    /**\n     * update text position\n     * @private\n     */\n    Selection.prototype.updateTextPosition = function (widget, point) {\n        var caretPosition = point;\n        var element = undefined;\n        var index = 0;\n        var isImageSelected = false;\n        var isImageSelectedObj = this.updateTextPositionIn(widget, element, index, point, false);\n        if (!isNullOrUndefined(isImageSelectedObj)) {\n            element = isImageSelectedObj.element;\n            index = isImageSelectedObj.index;\n            caretPosition = isImageSelectedObj.caretPosition;\n            isImageSelected = isImageSelectedObj.isImageSelected;\n            this.isImageSelected = isImageSelected;\n        }\n        if (isImageSelected) {\n            this.selectInternal(widget, element, index, caretPosition);\n            if (index === 0) {\n                this.extendForward();\n            }\n            else {\n                this.extendBackward();\n            }\n        }\n        else {\n            this.selectInternal(widget, element, index, caretPosition);\n        }\n    };\n    /**\n     * @private\n     */\n    /* tslint:disable */\n    Selection.prototype.updateTextPositionIn = function (widget, inline, index, caretPosition, includeParagraphMark) {\n        var isImageSelected = false;\n        var top = this.getTop(widget);\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        var element = elementValues.element;\n        left = elementValues.left;\n        if (isNullOrUndefined(element)) {\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var size = this.getParagraphMarkSize(widget.paragraph, topMargin, bottomMargin);\n            topMargin = size.topMargin;\n            bottomMargin = size.bottomMargin;\n            var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + size.width) : true;\n            if (selectParaMark && includeParagraphMark && caretPosition.x > left + size.width / 2) {\n                left += size.width;\n                if (widget.children.length > 0) {\n                    inline = widget.children[widget.children.length - 1];\n                    index = inline.length;\n                }\n                index++;\n            }\n            caretPosition = new Point(left, topMargin > 0 ? top + topMargin : top);\n        }\n        else {\n            if (!isNullOrUndefined(element)) {\n                if (caretPosition.x > left + element.margin.left) {\n                    for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                        element = widget.children[i];\n                        if (caretPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                            break;\n                        }\n                        left += element.margin.left + element.width;\n                    }\n                    if (caretPosition.x > left + element.margin.left + element.width) {\n                        //Line End\n                        index = element instanceof TextElementBox ? element.length : 1;\n                        left += element.margin.left + element.width;\n                    }\n                    else if (element instanceof TextElementBox) {\n                        var x = caretPosition.x - left - element.margin.left;\n                        left += element.margin.left;\n                        var prevWidth = 0;\n                        var charIndex = 0;\n                        for (var i = 1; i <= element.length; i++) {\n                            var width = 0;\n                            if (i === element.length) {\n                                width = element.width;\n                            }\n                            else {\n                                width = this.viewer.textHelper.getWidth(element.text.substr(0, i), element.characterFormat);\n                            }\n                            if (x < width || i === element.length) {\n                                //Updates exact left position of the caret.\n                                var charWidth = width - prevWidth;\n                                if (x - prevWidth > charWidth / 2) {\n                                    left += width;\n                                    charIndex = i;\n                                }\n                                else {\n                                    left += prevWidth;\n                                    charIndex = i - 1;\n                                    if (i === 1 && element !== widget.children[0]) {\n                                        var curIndex = widget.children.indexOf(element);\n                                        if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                            element = widget.children[curIndex - 1];\n                                            charIndex = element instanceof TextElementBox ? element.length : 1;\n                                        }\n                                    }\n                                }\n                                break;\n                            }\n                            prevWidth = width;\n                        }\n                        index = charIndex;\n                    }\n                    else {\n                        isImageSelected = element instanceof ImageElementBox;\n                        if (caretPosition.x - left - element.margin.left > element.width / 2) {\n                            index = 1;\n                            left += element.margin.left + element.width;\n                        }\n                        else if (element !== widget.children[0] && !isImageSelected) {\n                            var curIndex = widget.children.indexOf(element);\n                            if (!(widget.children[curIndex - 1] instanceof ListTextElementBox)) {\n                                element = widget.children[curIndex - 1];\n                                index = element instanceof TextElementBox ? element.length : 1;\n                            }\n                        }\n                    }\n                    if (element instanceof TextElementBox && element.text === '\\v') {\n                        index = 0;\n                    }\n                }\n                else {\n                    left += element.margin.left;\n                }\n                if (element instanceof TextElementBox) {\n                    top += element.margin.top > 0 ? element.margin.top : 0;\n                }\n                else {\n                    var textMetrics = this.viewer.textHelper.getHeight(element.characterFormat); //for ascent and descent\n                    var height = element.height;\n                    if (element instanceof BookmarkElementBox && !this.viewer.layout.hasValidElement(element.line.paragraph)) {\n                        height = textMetrics.Height; //after text helper class\n                    }\n                    top += element.margin.top + height - textMetrics.BaselineOffset;\n                }\n                inline = element;\n                var inlineObj = this.validateTextPosition(inline, index);\n                inline = inlineObj.element;\n                index = inlineObj.index;\n                var isParagraphEnd = isNullOrUndefined(inline.nextNode) && index === inline.length;\n                var isLineEnd = isNullOrUndefined(inline.nextNode)\n                    && inline instanceof TextElementBox && inline.text === '\\v';\n                if (includeParagraphMark && inline.nextNode instanceof FieldElementBox && index === inline.length) {\n                    isParagraphEnd = this.isLastRenderedInline(inline, index);\n                }\n                if (includeParagraphMark && isParagraphEnd || isLineEnd) {\n                    var width = 0;\n                    //Include width of Paragraph mark.\n                    if (isParagraphEnd) {\n                        width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n                        var selectParaMark = this.viewer.mouseDownOffset.y >= top && this.viewer.mouseDownOffset.y < top + widget.height ? (this.viewer.mouseDownOffset.x < left + width) : true;\n                        if (selectParaMark && caretPosition.x > left + width / 2) {\n                            left += width;\n                            index = inline.length + 1;\n                        }\n                        //Include width of line break mark.\n                    }\n                    else if (isLineEnd) {\n                        width = element.width;\n                        left += width;\n                        index = inline.length;\n                    }\n                }\n                caretPosition = new Point(left, top);\n            }\n        }\n        return {\n            'element': inline,\n            'index': index,\n            'caretPosition': caretPosition,\n            'isImageSelected': isImageSelected\n        };\n    };\n    /* tslint:enable */\n    /**\n     * Get text length if the line widget\n     * @private\n     */\n    // public getTextLength(viewer: LayoutViewer, widget: LineWidget, element: ElementBox): number {\n    //     let length: number = 0;\n    //     let count: number = widget.children.indexOf(element);\n    //     if (widget.children.length > 0 && widget.children[0] instanceof ListTextElementBox) {\n    //         if (widget.children[1] instanceof ListTextElementBox) {\n    //             count -= 2;\n    //         } else {\n    //             count -= 1;\n    //         }\n    //     }\n    //     for (let i: number = 1; i < count; i++) {\n    //         length += widget.children[i].length;\n    //     }\n    //     return length;\n    // }\n    /**\n     * Get Line widget left\n     * @private\n     */\n    Selection.prototype.getLeft = function (widget) {\n        var left = widget.paragraph.x;\n        var paragraphFormat = widget.paragraph.paragraphFormat;\n        if (this.isParagraphFirstLine(widget) && !(paragraphFormat.textAlignment === 'Right')) {\n            left += HelperMethods.convertPointToPixel(paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            var element = widget.children[i];\n            if (element instanceof ListTextElementBox) { //after list implementation\n                if (i === 0) {\n                    left += element.margin.left + element.width;\n                }\n                else {\n                    left += element.width;\n                }\n            }\n            else {\n                left += element.margin.left;\n                break;\n            }\n        }\n        return left;\n    };\n    /**\n     * Get line widget top\n     * @private\n     */\n    Selection.prototype.getTop = function (widget) {\n        var top = widget.paragraph.y;\n        var count = widget.paragraph.childWidgets.indexOf(widget);\n        for (var i = 0; i < count; i++) {\n            top += widget.paragraph.childWidgets[i].height;\n        }\n        return top;\n    };\n    /**\n     * Get first element the widget\n     * @private\n     */\n    Selection.prototype.getFirstElement = function (widget, left) {\n        var firstLineIndent = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            firstLineIndent = HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        left += firstLineIndent;\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                left += element.margin.left + element.width;\n                element = undefined;\n                // }\n                //  else if (element instanceof FieldElementBox || element instanceof BookmarkElementBox\n                //     || (element.nextNode instanceof FieldElementBox && ((element.nextNode as FieldElementBox).fieldType === 2))) {\n                //     element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return { 'element': element, 'left': left };\n    };\n    /**\n     * Return inline index\n     * @private\n     */\n    //ElementBox\n    Selection.prototype.getIndexInInline = function (elementBox) {\n        var indexInInline = 0;\n        if (elementBox instanceof TextElementBox) {\n            var count = elementBox.line.children.indexOf(elementBox);\n            for (var i = 0; i < count; i++) {\n                var element = elementBox.line.children[i];\n                if (element instanceof FieldElementBox || element instanceof ListTextElementBox) {\n                    continue;\n                }\n                indexInInline += element.length;\n            }\n        }\n        return indexInInline;\n    };\n    /**\n     * Return true if widget is first inline of paragraph\n     * @private\n     */\n    Selection.prototype.isParagraphFirstLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.previousSplitWidget) &&\n            widget === widget.paragraph.firstChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isParagraphLastLine = function (widget) {\n        if (isNullOrUndefined(widget.paragraph.nextSplitWidget)\n            && widget === widget.paragraph.lastChild) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * Return line widget width\n     * @private\n     */\n    Selection.prototype.getWidth = function (widget, includeParagraphMark) {\n        var width = 0;\n        if (this.isParagraphFirstLine(widget)) {\n            width += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        for (var i = 0; i < widget.children.length; i++) {\n            width += widget.children[i].margin.left + widget.children[i].width;\n        }\n        if (includeParagraphMark && widget.paragraph.childWidgets.indexOf(widget) === widget.paragraph.childWidgets.length - 1\n            && isNullOrUndefined(widget.paragraph.nextSplitWidget)) {\n            width += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n        }\n        return width;\n    };\n    /**\n     * Return line widget left\n     * @private\n     */\n    Selection.prototype.getLeftInternal = function (widget, elementBox, index) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            // tslint:disable-next-line:max-line-length\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        var count = widget.children.indexOf(elementBox);\n        if ((widget.children.length === 1 && widget.children[0] instanceof ListTextElementBox) || (widget.children.length === 2\n            && widget.children[0] instanceof ListTextElementBox && widget.children[1] instanceof ListTextElementBox)) {\n            count = widget.children.length;\n        }\n        for (var i = 0; i < count; i++) {\n            var widgetInternal = widget.children[i];\n            // if (widgetInternal instanceof FieldElementBox) {\n            //     continue;\n            // }\n            if (i === 1 && widget.children[i] instanceof ListTextElementBox) {\n                left += widget.children[i].width;\n            }\n            else {\n                left += widget.children[i].margin.left + widget.children[i].width;\n            }\n        }\n        if (!isNullOrUndefined(elementBox)) {\n            left += elementBox.margin.left;\n        }\n        if (elementBox instanceof TextElementBox) {\n            if (index === elementBox.length) {\n                left += elementBox.width;\n            }\n            else if (index > elementBox.length) {\n                // tslint:disable-next-line:max-line-length\n                left += elementBox.width + this.viewer.textHelper.getParagraphMarkWidth(elementBox.line.paragraph.characterFormat);\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                left += this.viewer.textHelper.getWidth(elementBox.text.substr(0, index), elementBox.characterFormat);\n            }\n        }\n        else if (index > 0) {\n            if (!isNullOrUndefined(elementBox) && !(elementBox instanceof ListTextElementBox)) {\n                left += elementBox.width;\n                if (index === 2) {\n                    var paragraph = elementBox.line.paragraph;\n                    left += this.viewer.textHelper.getParagraphMarkWidth(paragraph.characterFormat);\n                }\n            }\n            else {\n                left += this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            }\n        }\n        return left;\n    };\n    /**\n     * Return line widget start offset\n     * @private\n     */\n    Selection.prototype.getLineStartLeft = function (widget) {\n        var left = widget.paragraph.x;\n        if (this.isParagraphFirstLine(widget)) {\n            left += HelperMethods.convertPointToPixel(widget.paragraph.paragraphFormat.firstLineIndent);\n        }\n        if (widget.children.length > 0) {\n            left += widget.children[0].margin.left;\n        }\n        return left;\n    };\n    /**\n     * Update text position\n     * @private\n     */\n    Selection.prototype.updateTextPositionWidget = function (widget, point, textPosition, includeParagraphMark) {\n        var caretPosition = point;\n        var inline = undefined;\n        var index = 0;\n        var updatePositionObj;\n        updatePositionObj = this.updateTextPositionIn(widget, inline, index, caretPosition, includeParagraphMark);\n        inline = updatePositionObj.element;\n        index = updatePositionObj.index;\n        caretPosition = updatePositionObj.caretPosition;\n        textPosition.setPositionForSelection(widget, inline, index, caretPosition);\n    };\n    /**\n     * Clear selection highlight\n     * @private\n     */\n    Selection.prototype.clearSelectionHighlightLineWidget = function (widget) {\n        if (!isNullOrUndefined(this.owner) && this.selectedWidgets.length > 0) {\n            this.clearSelectionHighlight(this);\n        }\n    };\n    /**\n     * Return first element from line widget\n     * @private\n     */\n    Selection.prototype.getFirstElementInternal = function (widget) {\n        var element = undefined;\n        for (var i = 0; i < widget.children.length; i++) {\n            element = widget.children[i];\n            if (element instanceof ListTextElementBox) {\n                element = undefined;\n            }\n            else {\n                break;\n            }\n        }\n        return element;\n    };\n    //Selection API    \n    /**\n     * Select content between given range\n     * @private\n     */\n    Selection.prototype.selectRange = function (startPosition, endPosition) {\n        this.start.setPositionInternal(startPosition);\n        this.end.setPositionInternal(endPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Selects current paragraph\n     * @private\n     */\n    Selection.prototype.selectParagraph = function (paragraph, positionAtStart) {\n        var line = paragraph.firstChild;\n        if (positionAtStart) {\n            this.start.setPosition(line, positionAtStart);\n        }\n        else {\n            var endOffset = line.getEndOffset();\n            this.start.setPositionParagraph(line, endOffset);\n        }\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = this.start.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.setPositionForBlock = function (block, selectFirstBlock) {\n        var position;\n        if (block instanceof TableWidget) {\n            if (selectFirstBlock) {\n                block = this.getFirstParagraphInFirstCell(block);\n            }\n            else {\n                block = this.getLastParagraphInLastCell(block);\n            }\n        }\n        if (block instanceof ParagraphWidget) {\n            position = new TextPosition(this.owner);\n            if (selectFirstBlock) {\n                position.setPosition(block.firstChild, true);\n            }\n            else {\n                var line = block.lastChild;\n                position.setPositionParagraph(line, line.getEndOffset());\n            }\n        }\n        return position;\n    };\n    /**\n     * Select content in given text position\n     * @private\n     */\n    Selection.prototype.selectContent = function (textPosition, clearMultiSelection) {\n        if (isNullOrUndefined(textPosition)) {\n            throw new Error('textPosition is undefined.');\n        }\n        this.start.setPositionInternal(textPosition);\n        this.end.setPositionInternal(textPosition);\n        this.upDownSelectionLength = this.end.location.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * Select paragraph\n     * @private\n     */\n    Selection.prototype.selectInternal = function (lineWidget, element, index, physicalLocation) {\n        this.start.setPositionForSelection(lineWidget, element, index, physicalLocation);\n        this.end.setPositionInternal(this.start);\n        this.upDownSelectionLength = physicalLocation.x;\n        this.fireSelectionChanged(true);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.selects = function (lineWidget, offset, skipSelectionChange) {\n        this.viewer.clearSelectionHighlight();\n        this.start.setPositionForLineWidget(lineWidget, offset);\n        this.end.setPositionInternal(this.start);\n        if (!skipSelectionChange) {\n            this.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * Select content between start and end position\n     * @private\n     */\n    Selection.prototype.selectPosition = function (startPosition, endPosition) {\n        if (isNullOrUndefined(startPosition) || isNullOrUndefined(endPosition)) {\n            throw new Error('TextPosition cannot be undefined');\n        }\n        if (isNullOrUndefined(startPosition.paragraph)\n            || startPosition.offset > this.getParagraphLength(startPosition.paragraph) + 1) {\n            throw new Error('Start TextPosition is not valid.');\n        }\n        if (isNullOrUndefined(endPosition.paragraph)\n            || endPosition.offset > this.getParagraphLength(endPosition.paragraph) + 1) {\n            throw new Error('End TextPosition is not valid.');\n        }\n        if (startPosition.isAtSamePosition(endPosition)) {\n            // Select start position.\n            this.selectRange(startPosition, startPosition);\n        }\n        else {\n            // If both text position exists within same comment or outside comment, and not at same position.\n            if (startPosition.isExistBefore(endPosition)) {\n                // tslint:disable-next-line:max-line-length\n                endPosition.validateForwardFieldSelection(startPosition.getHierarchicalIndexInternal(), endPosition.getHierarchicalIndexInternal());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                startPosition.validateForwardFieldSelection(endPosition.getHierarchicalIndexInternal(), startPosition.getHierarchicalIndexInternal());\n            }\n            this.selectRange(startPosition, endPosition);\n        }\n    };\n    /**\n     * Notify selection change event\n     * @private\n     */\n    Selection.prototype.fireSelectionChanged = function (isSelectionChanged) {\n        if (!this.isEmpty) {\n            if (this.isForward) {\n                this.start.updatePhysicalPosition(true);\n                this.end.updatePhysicalPosition(false);\n            }\n            else {\n                this.start.updatePhysicalPosition(false);\n                this.end.updatePhysicalPosition(true);\n            }\n        }\n        if (!this.skipFormatRetrieval) {\n            this.retrieveCurrentFormatProperties();\n        }\n        this.viewer.clearSelectionHighlight();\n        this.hideToolTip();\n        if (this.owner.isLayoutEnabled && !this.owner.isShiftingEnabled) {\n            this.highlightSelection(true);\n        }\n        if (isSelectionChanged) {\n            if (this.start.paragraph.isInHeaderFooter && !this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = true;\n            }\n            else if (!this.start.paragraph.isInHeaderFooter && this.owner.enableHeaderAndFooter) {\n                this.owner.enableHeaderAndFooter = false;\n            }\n            this.owner.fireSelectionChange();\n        }\n        this.viewer.updateFocus();\n    };\n    //Formats Retrieval\n    /**\n     * Retrieve all current selection format\n     * @private\n     */\n    Selection.prototype.retrieveCurrentFormatProperties = function () {\n        this.isRetrieveFormatting = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        this.retrieveImageFormat(startPosition, endPosition);\n        this.retrieveCharacterFormat(startPosition, endPosition);\n        this.retrieveParagraphFormat(startPosition, endPosition);\n        this.retrieveSectionFormat(startPosition, endPosition);\n        this.retrieveTableFormat(startPosition, endPosition);\n        if (!this.isImageSelected) {\n            this.imageFormat.clearImageFormat();\n        }\n        this.isRetrieveFormatting = false;\n        this.setCurrentContextType();\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.retrieveImageFormat = function (start, end) {\n        var image;\n        if (start.currentWidget === end.currentWidget && start.offset + 1 === end.offset) {\n            var elementInfo = end.currentWidget.getInline(end.offset, 0);\n            image = elementInfo.element;\n            var index = elementInfo.index;\n            if (image instanceof ImageElementBox) {\n                var startOffset = start.currentWidget.getOffset(image, 0);\n                if (startOffset !== start.offset) {\n                    image = undefined;\n                }\n            }\n        }\n        if (image instanceof ImageElementBox) {\n            this.imageFormat.copyImageFormat(image);\n        }\n        else {\n            this.imageFormat.clearImageFormat();\n        }\n    };\n    Selection.prototype.setCurrentContextType = function () {\n        var contextIsinImage = this.imageFormat.image ? true : false;\n        var contextIsinTable = (isNullOrUndefined(this.tableFormat) || isNullOrUndefined(this.tableFormat.table)) ? false : true;\n        var style = this.start.paragraph.paragraphFormat.baseStyle;\n        if (style instanceof WParagraphStyle && style.name.toLowerCase().indexOf('toc') === 0) {\n            var tocField = this.getTocFieldInternal();\n            if (!isNullOrUndefined(tocField)) {\n                this.contextTypeInternal = 'TableOfContents';\n                return;\n            }\n        }\n        if (this.start.paragraph.isInHeaderFooter) {\n            var isInHeader = this.start.paragraph.bodyWidget.headerFooterType.indexOf('Header') !== -1;\n            if (contextIsinTable) {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableImage' : 'FooterTableImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderTableText' : 'FooterTableText';\n                }\n            }\n            else {\n                if (contextIsinImage) {\n                    this.contextTypeInternal = isInHeader ? 'HeaderImage' : 'FooterImage';\n                }\n                else {\n                    this.contextTypeInternal = isInHeader ? 'HeaderText' : 'FooterText';\n                }\n            }\n        }\n        else {\n            if (contextIsinTable) {\n                this.contextTypeInternal = contextIsinImage ? 'TableImage' : 'TableText';\n            }\n            else {\n                this.contextTypeInternal = contextIsinImage ? 'Image' : 'Text';\n            }\n        }\n    };\n    //Table Format retrieval starts\n    /**\n     * Retrieve selection table format\n     * @private\n     */\n    Selection.prototype.retrieveTableFormat = function (start, end) {\n        var tableAdv = this.getTable(start, end);\n        if (!isNullOrUndefined(tableAdv)) {\n            this.tableFormat.copyFormat(tableAdv.tableFormat);\n            this.tableFormat.table = tableAdv;\n            this.retrieveCellFormat(start, end);\n            this.retrieveRowFormat(start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.tableFormat.clearFormat();\n        }\n    };\n    /**\n     * Retrieve selection cell format\n     * @private\n     */\n    Selection.prototype.retrieveCellFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.cellFormat.copyFormat(start.paragraph.associatedCell.cellFormat);\n            this.getCellFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.cellFormat.clearCellFormat();\n        }\n    };\n    /**\n     * Retrieve selection row format\n     * @private\n     */\n    Selection.prototype.retrieveRowFormat = function (start, end) {\n        if (start.paragraph.isInsideTable && end.paragraph.isInsideTable) {\n            this.rowFormat.copyFormat(start.paragraph.associatedCell.ownerRow.rowFormat);\n            this.getRowFormat(start.paragraph.associatedCell.ownerTable, start, end);\n        }\n        else {\n            //When the selection is out of table\n            this.rowFormat.clearRowFormat();\n        }\n    };\n    /**\n     * Get selected cell format\n     * @private\n     */\n    Selection.prototype.getCellFormat = function (table, start, end) {\n        if (start.paragraph.associatedCell.equals(end.paragraph.associatedCell)) {\n            return;\n        }\n        var isStarted = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === start.paragraph.associatedCell.ownerRow) {\n                isStarted = true;\n            }\n            if (isStarted) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (this.isCellSelected(cell, start, end)) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                    }\n                    if (cell === end.paragraph.associatedCell) {\n                        this.cellFormat.combineFormat(cell.cellFormat);\n                        return;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get selected row format\n     * @private\n     */\n    Selection.prototype.getRowFormat = function (table, start, end) {\n        var tableRow = start.paragraph.associatedCell.ownerRow;\n        if (tableRow === end.paragraph.associatedCell.ownerRow) {\n            return;\n        }\n        for (var i = table.childWidgets.indexOf(tableRow) + 1; i < table.childWidgets.length; i++) {\n            var tempTableRow = table.childWidgets[i];\n            this.rowFormat.combineFormat(tempTableRow.rowFormat);\n            if (tempTableRow === end.paragraph.associatedCell.ownerRow) {\n                return;\n            }\n        }\n    };\n    /**\n     * Return table with given text position\n     * @private\n     */\n    Selection.prototype.getTable = function (startPosition, endPosition) {\n        if (!isNullOrUndefined(startPosition.paragraph.associatedCell) && !isNullOrUndefined(endPosition.paragraph.associatedCell)) {\n            var startTable = startPosition.paragraph.associatedCell.ownerTable;\n            var endTable = startPosition.paragraph.associatedCell.ownerTable;\n            if (startTable === endTable) {\n                return startTable;\n            }\n            else {\n                if (startTable.contains(startPosition.paragraph.associatedCell)) {\n                    return startTable;\n                }\n                else if (endTable.contains(startPosition.paragraph.associatedCell)) {\n                    return endTable;\n                }\n                else if (!startTable.isInsideTable || !endTable.isInsideTable) {\n                    return undefined;\n                }\n                else {\n                    do {\n                        startTable = startTable.associatedCell.ownerTable;\n                        if (startTable === endTable || startTable.contains(endTable.associatedCell)) {\n                            return startTable;\n                        }\n                        else if (endTable.contains(startTable.associatedCell)) {\n                            return endTable;\n                        }\n                    } while (!isNullOrUndefined(startTable.associatedCell));\n                }\n            }\n        }\n        return undefined;\n    };\n    Selection.prototype.getContainerWidget = function (block) {\n        var bodyWidget;\n        if (block.containerWidget instanceof BlockContainer) {\n            bodyWidget = block.containerWidget;\n        }\n        else {\n            bodyWidget = block.containerWidget;\n            while (!(bodyWidget instanceof BlockContainer)) {\n                bodyWidget = bodyWidget.containerWidget;\n            }\n        }\n        return bodyWidget;\n    };\n    //Table format retrieval ends\n    //Section format retrieval starts\n    /**\n     * Retrieve selection section format\n     * @private\n     */\n    Selection.prototype.retrieveSectionFormat = function (start, end) {\n        var startParaSection = this.getContainerWidget(start.paragraph);\n        var endParaSection = this.getContainerWidget(end.paragraph);\n        if (!isNullOrUndefined(startParaSection)) {\n            this.sectionFormat.copyFormat(startParaSection.sectionFormat);\n            var startPageIndex = this.viewer.pages.indexOf(startParaSection.page);\n            var endPageIndex = this.viewer.pages.indexOf(endParaSection.page);\n            for (var i = startPageIndex + 1; i <= endPageIndex; i++) {\n                this.sectionFormat.combineFormat(this.viewer.pages[i].bodyWidgets[0].sectionFormat);\n            }\n        }\n    };\n    //section format retrieval ends.\n    //Paragraph format retrieval implementation starts.\n    /**\n     * Retrieve selection paragraph format\n     * @private\n     */\n    Selection.prototype.retrieveParagraphFormat = function (start, end) {\n        this.getParagraphFormatForSelection(start.paragraph, this, start, end);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatForSelection = function (paragraph, selection, start, end) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || this.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            this.getParagraphFormatInternalInCell(start.paragraph.associatedCell, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInParagraph(paragraph, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getParagraphFormatInternalInParagraph = function (paragraph, start, end) {\n        if (start.paragraph === paragraph) {\n            this.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        }\n        else {\n            this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getParagraphFormatInternalInBlock(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInternalInParagraph(block, start, end);\n        }\n        else {\n            this.getParagraphFormatInternalInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(table);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInCell = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getParagraphFormatInBlock(cell.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.getParagraphFormatInParagraph(block);\n        }\n        else {\n            this.getParagraphFormatInTable(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInTable = function (tableAdv) {\n        for (var i = 0; i < tableAdv.childWidgets.length; i++) {\n            var tableRow = tableAdv.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(tableRow.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInParagraph = function (paragraph) {\n        this.paragraphFormat.combineFormat(paragraph.paragraphFormat);\n    };\n    /**\n     * Get paragraph format in cell\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInternalInCell = function (cellAdv, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(cellAdv, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(cellAdv, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getParagraphFormatInCell(containerCell);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getParagraphFormatInternalInParagraph(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getParagraphFormatInRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getParaFormatForCell(containerCell.ownerTable, containerCell, endCell);\n                }\n            }\n            else {\n                this.getParagraphFormatInRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(cellAdv);\n            this.getParagraphFormatInRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getParaFormatForCell = function (table, startCell, endCell) {\n        var startCellIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endCellIn = startCellIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startCellIn > endCellLeft) {\n            startCellIn = endCellLeft;\n        }\n        if (endCellIn < endCellRight) {\n            endCellIn = endCellRight;\n        }\n        if (startCellIn > this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        if (startCellIn < this.upDownSelectionLength) {\n            startCellIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var tableRow = table.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                var cell = tableRow.childWidgets[j];\n                var left = this.getCellLeft(tableRow, cell);\n                if (HelperMethods.round(startCellIn, 2) <= HelperMethods.round(left, 2)\n                    && HelperMethods.round(left, 2) < HelperMethods.round(endCellIn, 2)) {\n                    this.getParagraphFormatInCell(cell);\n                }\n            }\n        }\n    };\n    /**\n     * Get paragraph format ins row\n     * @private\n     */\n    Selection.prototype.getParagraphFormatInRow = function (tableRow, start, end) {\n        for (var i = tableRow.rowIndex; i < tableRow.ownerTable.childWidgets.length; i++) {\n            var row = tableRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getParagraphFormatInCell(row.childWidgets[j]);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRow.ownerTable);\n        //Goto the next block.\n        this.getParagraphFormatInternalInBlock(block, start, end);\n    };\n    // paragraph format retrieval implementation ends\n    // Character format retrieval implementation starts.\n    /**\n     * Retrieve Selection character format\n     * @private\n     */\n    Selection.prototype.retrieveCharacterFormat = function (start, end) {\n        this.characterFormat.copyFormat(start.paragraph.characterFormat);\n        if (start.paragraph === end.paragraph && start.currentWidget.isLastLine()\n            && start.offset === this.getLineLength(start.currentWidget) && start.offset + 1 === end.offset) {\n            return;\n        }\n        var para = start.paragraph;\n        if (start.offset === this.getParagraphLength(para) && !this.isEmpty) {\n            para = this.getNextParagraphBlock(para);\n        }\n        while (!isNullOrUndefined(para) && para !== end.paragraph && para.isEmpty()) {\n            para = this.getNextParagraphBlock(para);\n        }\n        var offset = para === start.paragraph ? start.offset : 0;\n        var indexInInline = 0;\n        if (!isNullOrUndefined(para) && !para.isEmpty()) {\n            var position = new TextPosition(this.owner);\n            var elemInfo = start.currentWidget.getInline(offset, indexInInline);\n            var physicalLocation = this.getPhysicalPositionInternal(start.currentWidget, offset, true);\n            position.setPositionForSelection(start.currentWidget, elemInfo.element, elemInfo.index, physicalLocation);\n            this.getCharacterFormatForSelection(para, this, position, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatForSelection = function (paragraph, selection, startPosition, endPosition) {\n        //Selection start in cell.\n        if (startPosition.paragraph instanceof ParagraphWidget && startPosition.paragraph.isInsideTable\n            && (!endPosition.paragraph.isInsideTable\n                || startPosition.paragraph.associatedCell !== endPosition.paragraph.associatedCell\n                || this.isCellSelected(startPosition.paragraph.associatedCell, startPosition, endPosition))) {\n            this.getCharacterFormatInTableCell(startPosition.paragraph.associatedCell, selection, startPosition, endPosition);\n        }\n        else {\n            this.getCharacterFormat(paragraph, startPosition, endPosition);\n        }\n    };\n    /**\n     * Get Character format\n     * @private\n     */\n    //Format Retrieval\n    Selection.prototype.getCharacterFormatForTableRow = function (tableRowAdv, start, end) {\n        for (var i = tableRowAdv.rowIndex; i < tableRowAdv.ownerTable.childWidgets.length; i++) {\n            var tableRow = tableRowAdv.ownerTable.childWidgets[i];\n            for (var j = 0; j < tableRow.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(tableRow.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(tableRow, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var block = this.getNextRenderedBlock(tableRowAdv.ownerTable);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(block, start, end);\n    };\n    /**\n     * Get Character format in table\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTableCell = function (tableCell, selection, start, end) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = this.getContainerCellOf(tableCell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = this.getSelectedCell(tableCell, containerCell);\n                var endCell = this.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (this.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (this.isCellSelected(containerCell, start, end)) {\n                        this.getCharacterFormatForSelectionCell(containerCell, start, end);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.getCharacterFormat(start.paragraph, start, end);\n                        }\n                        else {\n                            this.getCharacterFormatForTableRow(startCell.ownerRow, start, end);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.getCharacterFormatInternalInTable(containerCell.ownerTable, containerCell, endCell, start, end);\n                }\n            }\n            else {\n                this.getCharacterFormatForTableRow(containerCell.ownerRow, start, end);\n            }\n        }\n        else {\n            var cell = this.getContainerCell(tableCell);\n            this.getCharacterFormatForTableRow(cell.ownerRow, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Selection.prototype.getCharacterFormatInternalInTable = function (table, startCell, endCell, startPosition, endPosition) {\n        var startIn = this.getCellLeft(startCell.ownerRow, startCell);\n        var endIn = startIn + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        if (startIn > endCellLeft) {\n            startIn = endCellLeft;\n        }\n        if (endIn < endCellRight) {\n            endIn = endCellRight;\n        }\n        if (startIn > this.upDownSelectionLength) {\n            startIn = this.upDownSelectionLength;\n        }\n        if (endIn < this.upDownSelectionLength) {\n            endIn = this.upDownSelectionLength;\n        }\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var left = this.getCellLeft(row, cell);\n                if (HelperMethods.round(startIn, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(endIn, 2)) {\n                    this.getCharacterFormatForSelectionCell(cell, startPosition, endPosition);\n                }\n            }\n        }\n    };\n    /**\n     * Get character format with in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormat = function (paragraph, start, end) {\n        if (paragraph !== start.paragraph && paragraph !== end.paragraph) {\n            this.getCharacterFormatInternal(paragraph, this);\n            return;\n        }\n        if (end.paragraph === paragraph && start.paragraph !== paragraph && end.offset === 0) {\n            return;\n        }\n        var startOffset = 0;\n        var length = this.getParagraphLength(paragraph);\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            //Sets selection character format.            \n            var isUpdated = this.setCharacterFormat(paragraph, start, end, length);\n            if (isUpdated) {\n                return;\n            }\n        }\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        var endOffset = end.offset;\n        if (paragraph !== end.paragraph) {\n            endOffset = length;\n        }\n        var isFieldStartSelected = false;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = this.getStartLineOffset(lineWidget);\n            }\n            if (lineWidget === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = this.getLineLength(lineWidget);\n            }\n            var count = 0;\n            for (var j = 0; j < lineWidget.children.length; j++) {\n                var inline = lineWidget.children[j];\n                if (startOffset >= count + inline.length) {\n                    count += inline.length;\n                    continue;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 0\n                    && HelperMethods.isLinkedFieldCharacter(inline)) {\n                    var nextInline = isNullOrUndefined(inline.fieldSeparator) ?\n                        inline.fieldEnd : inline.fieldSeparator;\n                    do {\n                        count += inline.length;\n                        inline = inline.nextNode;\n                        i++;\n                    } while (!isNullOrUndefined(inline) && inline !== nextInline);\n                    isFieldStartSelected = true;\n                }\n                if (inline instanceof FieldElementBox && inline.fieldType === 1\n                    && HelperMethods.isLinkedFieldCharacter(inline) && isFieldStartSelected) {\n                    var fieldInline = inline.fieldBegin;\n                    do {\n                        this.characterFormat.combineFormat(fieldInline.characterFormat);\n                        fieldInline = fieldInline.nextNode;\n                    } while (!(fieldInline instanceof FieldElementBox));\n                }\n                if (inline instanceof TextElementBox) {\n                    this.characterFormat.combineFormat(inline.characterFormat);\n                }\n                if (isNullOrUndefined(inline) || endOffset <= count + inline.length) {\n                    break;\n                }\n                count += inline.length;\n            }\n        }\n        if (end.paragraph === paragraph) {\n            return;\n        }\n        var block = this.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            this.getCharacterFormatForBlock(block, start, end);\n        }\n    };\n    Selection.prototype.setCharacterFormat = function (para, startPos, endPos, length) {\n        var index = 0;\n        var startOffset = startPos.offset;\n        var inlineAndIndex = startPos.currentWidget.getInline(startOffset, index);\n        index = inlineAndIndex.index;\n        var inline = inlineAndIndex.element;\n        if (isNullOrUndefined(inline)) {\n            var currentLineIndex = startPos.paragraph.childWidgets.indexOf(startPos.currentWidget);\n            if (startPos.currentWidget.previousLine) {\n                inline = startPos.currentWidget.previousLine.children[startPos.currentWidget.previousLine.children.length - 1];\n                this.characterFormat.copyFormat(inline.characterFormat);\n                return true;\n            }\n        }\n        if (startOffset < length) {\n            if (this.isEmpty) {\n                if (inline instanceof TextElementBox || (inline instanceof FieldElementBox\n                    && (inline.fieldType === 0 || inline.fieldType === 1))) {\n                    var previousNode = this.getPreviousTextElement(inline);\n                    if (startOffset === 0 && previousNode) {\n                        inline = previousNode;\n                    }\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else {\n                    if (!isNullOrUndefined(this.getPreviousTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getPreviousTextElement(inline).characterFormat);\n                    }\n                    else if (!isNullOrUndefined(this.getNextTextElement(inline))) {\n                        this.characterFormat.copyFormat(this.getNextTextElement(inline).characterFormat);\n                    }\n                    else {\n                        this.characterFormat.copyFormat(para.characterFormat);\n                    }\n                }\n                return true;\n            }\n            else {\n                if (index === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormat(inline));\n                }\n                else if (inline instanceof TextElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(inline));\n                }\n            }\n        }\n        else {\n            if (length === endPos.offset) {\n                if (inline instanceof TextElementBox || inline instanceof FieldElementBox) {\n                    this.characterFormat.copyFormat(inline.characterFormat);\n                }\n                else if (!isNullOrUndefined(inline)) {\n                    inline = this.getPreviousTextElement(inline);\n                    if (!isNullOrUndefined(inline)) {\n                        this.characterFormat.copyFormat(inline.characterFormat);\n                    }\n                }\n                else {\n                    this.characterFormat.copyFormat(para.characterFormat);\n                }\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForBlock = function (block, start, end) {\n        if (block instanceof ParagraphWidget) {\n            this.getCharacterFormat(block, start, end);\n        }\n        else {\n            this.getCharacterFormatInTable(block, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInTable = function (table, start, end) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.getCharacterFormatForSelectionCell(row.childWidgets[j], start, end);\n            }\n            if (end.paragraph.isInsideTable && this.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        var blockAdv = this.getNextRenderedBlock(table);\n        // //Goto the next block.\n        this.getCharacterFormatForBlock(blockAdv, start, end);\n    };\n    /**\n     * Get character format in selection\n     * @private\n     */\n    Selection.prototype.getCharacterFormatForSelectionCell = function (cell, start, end) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            this.getCharacterFormatForBlock(cell.childWidgets[i], start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getCharacterFormatInternal = function (paragraph, selection) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var linewidget = paragraph.childWidgets[i];\n            for (var j = 0; j < linewidget.children.length; j++) {\n                var element = linewidget.children[j];\n                if (!(element instanceof ImageElementBox || element instanceof FieldElementBox)) {\n                    selection.characterFormat.combineFormat(element.characterFormat);\n                }\n            }\n        }\n    };\n    /**\n     * Get next valid character format from inline\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormat = function (inline) {\n        var startInline = this.getNextTextElement(inline);\n        if (isNullOrUndefined(startInline)) {\n            return inline.characterFormat;\n        }\n        var fieldBegin = undefined;\n        if (startInline instanceof FieldElementBox) {\n            if (fieldBegin.fieldType === 0) {\n                fieldBegin = startInline;\n            }\n        }\n        if (isNullOrUndefined(fieldBegin)) {\n            return startInline.characterFormat;\n        }\n        else {\n            return this.getNextValidCharacterFormatOfField(fieldBegin);\n        }\n    };\n    /**\n     * Get next valid paragraph format from field\n     * @private\n     */\n    Selection.prototype.getNextValidCharacterFormatOfField = function (fieldBegin) {\n        var startInline = fieldBegin;\n        if (HelperMethods.isLinkedFieldCharacter(fieldBegin)) {\n            if (isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                startInline = fieldBegin.fieldEnd;\n            }\n            else {\n                startInline = fieldBegin.fieldSeparator;\n            }\n        }\n        var nextValidInline = undefined;\n        if (!isNullOrUndefined(startInline.nextNode)) {\n            //Check the next node is a valid and returns inline.\n            nextValidInline = this.getNextValidElement(startInline.nextNode);\n        }\n        //If field separator/end exists at end of paragraph, then move to next paragraph.\n        if (isNullOrUndefined(nextValidInline)) {\n            return startInline.characterFormat;\n        }\n        return nextValidInline.characterFormat;\n    };\n    /**\n     * Return true if cursor point with in selection range\n     * @private\n     */\n    Selection.prototype.checkCursorIsInSelection = function (widget, point) {\n        if (isNullOrUndefined(this.start) || this.isEmpty || isNullOrUndefined(widget)) {\n            return false;\n        }\n        var isSelected = false;\n        do {\n            if (this.selectedWidgets.containsKey(widget)) {\n                var top_4 = void 0;\n                var left = void 0;\n                if (widget instanceof LineWidget) {\n                    top_4 = this.owner.selection.getTop(widget);\n                    left = this.owner.selection.getLeft(widget);\n                }\n                else {\n                    top_4 = widget.y;\n                    left = widget.x;\n                }\n                var widgetInfo = this.selectedWidgets.get(widget);\n                isSelected = widgetInfo.left <= point.x && top_4 <= point.y &&\n                    top_4 + widget.height >= point.y && widgetInfo.left + widgetInfo.width >= point.x;\n            }\n            widget = (widget instanceof LineWidget) ? widget.paragraph : widget.containerWidget;\n        } while (!isNullOrUndefined(widget) && !isSelected);\n        return isSelected;\n    };\n    /**\n     * Copy paragraph for to selection paragraph format\n     * @private\n     */\n    Selection.prototype.copySelectionParagraphFormat = function () {\n        var format = new WParagraphFormat();\n        this.paragraphFormat.copyToFormat(format);\n        return format;\n    };\n    /**\n     * Get hyperlink display text\n     * @private\n     */\n    // tslint:disable-next-line\n    Selection.prototype.getHyperlinkDisplayText = function (paragraph, fieldSeparator, fieldEnd, isNestedField, format) {\n        var para = paragraph;\n        if (para !== fieldEnd.line.paragraph) {\n            isNestedField = true;\n            return { displayText: '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n        }\n        var displayText = '';\n        var lineIndex = para.childWidgets.indexOf(fieldSeparator.line);\n        var index = para.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < para.childWidgets.length; j++) {\n            var lineWidget = para.childWidgets[j];\n            if (j !== lineIndex) {\n                index = -1;\n            }\n            for (var i = index + 1; i < lineWidget.children.length; i++) {\n                var inline = lineWidget.children[i];\n                if (inline === fieldEnd) {\n                    return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n                }\n                if (inline instanceof TextElementBox) {\n                    displayText += inline.text;\n                    format = inline.characterFormat;\n                }\n                else if (inline instanceof FieldElementBox) {\n                    if (inline instanceof FieldElementBox && inline.fieldType === 0\n                        && !isNullOrUndefined(inline.fieldEnd)) {\n                        if (isNullOrUndefined(inline.fieldSeparator)) {\n                            index = lineWidget.children.indexOf(inline.fieldEnd);\n                        }\n                        else {\n                            index = lineWidget.children.indexOf(inline.fieldSeparator);\n                        }\n                    }\n                }\n                else {\n                    isNestedField = true;\n                    return { 'displayText': '<<Selection in Document>>', 'isNestedField': isNestedField, 'format': format };\n                }\n            }\n        }\n        return { 'displayText': displayText, 'isNestedField': isNestedField, 'format': format };\n    };\n    /**\n     * Navigates hyperlink on mouse Event.\n     * @private\n     */\n    Selection.prototype.navigateHyperLinkOnEvent = function (cursorPoint, isTouchInput) {\n        var _this = this;\n        var widget = this.viewer.getLineWidget(cursorPoint);\n        if (!isNullOrUndefined(widget)) {\n            var hyperLinkField = this.getHyperLinkFieldInCurrentSelection(widget, cursorPoint);\n            //Invokes Hyperlink navigation events.\n            if (!isNullOrUndefined(hyperLinkField)) {\n                this.viewer.updateTextPositionForSelection(cursorPoint, 1);\n                this.fireRequestNavigate(hyperLinkField);\n                setTimeout(function () {\n                    if (_this.viewer) {\n                        _this.viewer.isTouchInput = isTouchInput;\n                        _this.viewer.updateFocus();\n                        _this.viewer.isTouchInput = false;\n                    }\n                });\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getLinkText = function (fieldBegin) {\n        var hyperlink = new Hyperlink(fieldBegin, this);\n        var link = hyperlink.navigationLink;\n        if (hyperlink.localReference.length > 0) {\n            if (hyperlink.localReference[0] === '_' && (isNullOrUndefined(link) || link.length === 0)) {\n                link = 'Current Document';\n            }\n            else {\n                link += '#' + hyperlink.localReference;\n            }\n        }\n        hyperlink.destroy();\n        return link;\n    };\n    /**\n     * Set Hyperlink content to tool tip element\n     * @private\n     */\n    Selection.prototype.setHyperlinkContentToToolTip = function (fieldBegin, widget, xPos) {\n        if (fieldBegin) {\n            if (this.owner.contextMenuModule &&\n                this.owner.contextMenuModule.contextMenuInstance.element.style.display === 'block') {\n                return;\n            }\n            if (!this.toolTipElement) {\n                this.toolTipElement = createElement('div', { className: 'e-de-tooltip' });\n                this.viewer.viewerContainer.appendChild(this.toolTipElement);\n            }\n            this.toolTipElement.style.display = 'block';\n            var l10n = new L10n('documenteditor', this.owner.defaultLocale);\n            l10n.setLocale(this.owner.locale);\n            var toolTipText = l10n.getConstant('Click to follow link');\n            if (this.owner.useCtrlClickToFollowHyperlink) {\n                toolTipText = 'Ctrl+' + toolTipText;\n            }\n            var linkText = this.getLinkText(fieldBegin);\n            this.toolTipElement.innerHTML = linkText + '</br><b>' + toolTipText + '</b>';\n            var widgetTop = this.getTop(widget) * this.viewer.zoomFactor;\n            var page = this.getPage(widget.paragraph);\n            var containerWidth = this.viewer.viewerContainer.getBoundingClientRect().width + this.viewer.viewerContainer.scrollLeft;\n            var left = page.boundingRectangle.x + xPos * this.viewer.zoomFactor;\n            if ((left + this.toolTipElement.clientWidth + 10) > containerWidth) {\n                left = left - ((this.toolTipElement.clientWidth - (containerWidth - left)) + 15);\n            }\n            var top_5 = this.getPageTop(page) + (widgetTop - this.toolTipElement.offsetHeight);\n            top_5 = top_5 > this.viewer.viewerContainer.scrollTop ? top_5 : top_5 + widget.height + this.toolTipElement.offsetHeight;\n            this.showToolTip(left, top_5);\n            if (!isNullOrUndefined(this.toolTipField) && fieldBegin !== this.toolTipField) {\n                this.toolTipObject.position = { X: left, Y: top_5 };\n            }\n            this.toolTipObject.show();\n            this.toolTipField = fieldBegin;\n        }\n        else {\n            this.hideToolTip();\n        }\n    };\n    /**\n     * Show hyperlink tooltip\n     * @private\n     */\n    Selection.prototype.showToolTip = function (x, y) {\n        if (!this.toolTipObject) {\n            this.toolTipObject = new Popup(this.toolTipElement, {\n                height: 'auto',\n                width: 'auto',\n                relateTo: this.viewer.viewerContainer.parentElement,\n                position: { X: x, Y: y }\n            });\n        }\n    };\n    /**\n     * Hide tooltip object\n     * @private\n     */\n    Selection.prototype.hideToolTip = function () {\n        this.toolTipField = undefined;\n        if (this.toolTipObject) {\n            this.toolTipObject.hide();\n            this.toolTipObject.destroy();\n            this.toolTipObject = undefined;\n            this.toolTipElement.style.display = 'none';\n        }\n    };\n    /**\n     * Return hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInCurrentSelection = function (widget, cursorPosition) {\n        var inline = undefined;\n        var top = this.getTop(widget);\n        var lineStartLeft = this.getLineStartLeft(widget);\n        if (cursorPosition.y < top || cursorPosition.y > top + widget.height\n            || cursorPosition.x < lineStartLeft || cursorPosition.x > lineStartLeft + widget.paragraph.width) {\n            return undefined;\n        }\n        var left = widget.paragraph.x;\n        var elementValues = this.getFirstElement(widget, left);\n        left = elementValues.left;\n        var element = elementValues.element;\n        if (isNullOrUndefined(element)) {\n            var width = this.viewer.textHelper.getParagraphMarkWidth(widget.paragraph.characterFormat);\n            if (cursorPosition.x <= lineStartLeft + width || cursorPosition.x >= lineStartLeft + width) {\n                //Check if paragraph is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFields(widget.paragraph, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        else {\n            if (cursorPosition.x > left + element.margin.left) {\n                for (var i = widget.children.indexOf(element); i < widget.children.length; i++) {\n                    element = widget.children[i];\n                    if (cursorPosition.x < left + element.margin.left + element.width || i === widget.children.length - 1) {\n                        break;\n                    }\n                    left += element.margin.left + element.width;\n                }\n            }\n            inline = element;\n            var width = element.margin.left + element.width;\n            if (isNullOrUndefined(inline.nextNode)) {\n                //Include width of Paragraph mark.\n                width += this.viewer.textHelper.getParagraphMarkWidth(inline.line.paragraph.characterFormat);\n            }\n            if (cursorPosition.x <= left + width) {\n                //Check if inline is within a field result.\n                var checkedFields = [];\n                var field = this.getHyperLinkFieldInternal(inline.line.paragraph, inline, checkedFields);\n                checkedFields = [];\n                checkedFields = undefined;\n                return field;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return field if paragraph contain hyperlink field\n     * @private\n     */\n    Selection.prototype.getHyperlinkField = function () {\n        if (isNullOrUndefined(this.end)) {\n            return undefined;\n        }\n        var index = 0;\n        var currentInline = this.end.currentWidget.getInline(this.end.offset, index);\n        index = currentInline.index;\n        var inline = currentInline.element;\n        var checkedFields = [];\n        var field = undefined;\n        if (isNullOrUndefined(inline)) {\n            field = this.getHyperLinkFields(this.end.paragraph, checkedFields);\n        }\n        else {\n            var paragraph = inline.line.paragraph;\n            field = this.getHyperLinkFieldInternal(paragraph, inline, checkedFields);\n        }\n        checkedFields = [];\n        return field;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFields = function (paragraph, checkedFields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (checkedFields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                checkedFields.push(this.viewer.fields[i]);\n            }\n            var field = this.getFieldCode(this.viewer.fields[i]);\n            field = field.trim().toLowerCase();\n            if (field.match('hyperlink ') && this.paragraphIsInFieldResult(this.viewer.fields[i], paragraph)) {\n                return this.viewer.fields[i];\n            }\n        }\n        // if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof WHeaderFooter)) {\n        //     return this.getHyperLinkFields((paragraph.con as WCompositeNode), checkedFields);\n        // }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getHyperLinkFieldInternal = function (paragraph, inline, fields) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            if (fields.indexOf(this.viewer.fields[i]) !== -1 || isNullOrUndefined(this.viewer.fields[i].fieldSeparator)) {\n                continue;\n            }\n            else {\n                fields.push(this.viewer.fields[i]);\n            }\n            var fieldCode = this.getFieldCode(this.viewer.fields[i]);\n            fieldCode = fieldCode.trim().toLowerCase();\n            if (fieldCode.match('hyperlink ') && (this.inlineIsInFieldResult(this.viewer.fields[i], inline) || this.isImageField())) {\n                return this.viewer.fields[i];\n            }\n        }\n        if (paragraph.containerWidget instanceof BodyWidget && !(paragraph instanceof HeaderFooterWidget)) {\n            return this.getHyperLinkFieldInternal(paragraph.containerWidget, inline, fields);\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getBlock = function (currentIndex) {\n        if (currentIndex === '' || isNullOrUndefined(currentIndex)) {\n            return undefined;\n        }\n        var index = { index: currentIndex };\n        var page = this.start.getPage(index);\n        var bodyIndex = index.index.indexOf(';');\n        var value = index.index.substring(0, bodyIndex);\n        index.index = index.index.substring(bodyIndex).replace(';', '');\n        var bodyWidget = page.bodyWidgets[parseInt(value, 10)];\n        return this.getBlockInternal(bodyWidget, index.index);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Selection.prototype.getBlockInternal = function (widget, position) {\n        if (position === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.indexOf(';');\n        var value = position.substring(0, index);\n        position = position.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof Widget && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headersFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        if (index >= 0 && index < widget.childWidgets.length) {\n            var child = widget.childWidgets[(index)];\n            if (position.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.indexOf(';') >= 0) {\n                        position = '0';\n                    }\n                    return child;\n                }\n                if (child instanceof BlockWidget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    return blockObj;\n                }\n            }\n            else {\n                return child;\n            }\n        }\n        else {\n            return node;\n        }\n        return node;\n    };\n    /**\n     * Return true if inline is in field result\n     * @private\n     */\n    Selection.prototype.inlineIsInFieldResult = function (fieldBegin, inline) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            if (this.isExistBeforeInline(fieldBegin.fieldSeparator, inline)) {\n                return this.isExistAfterInline(fieldBegin.fieldEnd, inline);\n            }\n        }\n        return false;\n    };\n    /**\n     * Retrieve true if paragraph is in field result\n     * @private\n     */\n    Selection.prototype.paragraphIsInFieldResult = function (fieldBegin, paragraph) {\n        if (!isNullOrUndefined(fieldBegin.fieldEnd) && !isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            var fieldParagraph = fieldBegin.fieldSeparator.line.paragraph;\n            if (fieldBegin.fieldSeparator.line.paragraph === paragraph\n                || this.isExistBefore(fieldParagraph, paragraph)) {\n                var currentParagraph = fieldBegin.fieldEnd.line.paragraph;\n                return (currentParagraph !== paragraph && this.isExistAfter(fieldParagraph, paragraph));\n            }\n        }\n        return false;\n    };\n    /**\n     * Return true if image is In field\n     * @private\n     */\n    Selection.prototype.isImageField = function () {\n        if (this.start.paragraph.isEmpty() || this.end.paragraph.isEmpty()) {\n            return false;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var indexInInline = 0;\n        var inlineInfo = startPosition.paragraph.getInline(startPosition.offset, indexInInline);\n        var inline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (indexInInline === inline.length) {\n            inline = this.getNextRenderedElementBox(inline, indexInInline);\n        }\n        inlineInfo = endPosition.paragraph.getInline(endPosition.offset, indexInInline);\n        var endInline = inlineInfo.element;\n        indexInInline = inlineInfo.index;\n        if (inline instanceof FieldElementBox && inline.fieldType === 0\n            && endInline instanceof FieldElementBox && endInline.fieldType === 1 && inline.fieldSeparator) {\n            var fieldValue = inline.fieldSeparator.nextNode;\n            if (fieldValue instanceof ImageElementBox && fieldValue.nextNode === endInline) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Select List Text\n     * @private\n     */\n    Selection.prototype.selectListText = function () {\n        var lineWidget = this.viewer.selectionLineWidget;\n        var endOffset = '0';\n        var selectionIndex = lineWidget.getHierarchicalIndex(endOffset);\n        var startPosition = this.getTextPosition(selectionIndex);\n        var endPosition = this.getTextPosition(selectionIndex);\n        this.selectRange(startPosition, endPosition);\n        this.highlightListText(this.viewer.selectionLineWidget);\n        this.contextTypeInternal = 'List';\n    };\n    /**\n     * Manually select the list text\n     * @private\n     */\n    Selection.prototype.highlightListText = function (linewidget) {\n        var width = linewidget.children[0].width;\n        var left = this.viewer.getLeftValue(linewidget);\n        var top = linewidget.paragraph.y;\n        this.createHighlightBorder(linewidget, width, left, top);\n        this.viewer.isListTextSelected = true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateImageSize = function (imageFormat) {\n        this.owner.isShiftingEnabled = true;\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        var inline = null;\n        var index = 0;\n        var paragraph = startPosition.paragraph;\n        if (paragraph === endPosition.paragraph\n            && startPosition.offset + 1 === endPosition.offset) {\n            var inlineObj = paragraph.getInline(endPosition.offset, index);\n            inline = inlineObj.element;\n            index = inlineObj.index;\n        }\n        if (inline instanceof ImageElementBox) {\n            var width = inline.width;\n            var height = inline.height;\n            inline.width = imageFormat.width;\n            inline.height = imageFormat.height;\n            imageFormat.width = width;\n            imageFormat.height = height;\n            if (paragraph != null && paragraph.containerWidget != null && this.owner.editorModule) {\n                var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n                var elementIndex = inline.line.children.indexOf(inline);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n                this.highlightSelection(false);\n            }\n        }\n    };\n    /**\n     * Gets selected table content\n     * @private\n     */\n    Selection.prototype.getSelectedCellsInTable = function (table, startCell, endCell) {\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowindex = startCell.ownerRow.index;\n        var endRowIndex = endCell.ownerRow.index;\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowindex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n            if (row.index > endRowIndex) {\n                break;\n            }\n        }\n        return cells;\n        // return html;\n    };\n    /**\n     * Copies the selected content to clipboard.\n     */\n    Selection.prototype.copy = function () {\n        if (this.isEmpty) {\n            return;\n        }\n        this.copySelectedContent(false);\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.copySelectedContent = function (isCut) {\n        if (isNullOrUndefined(this.owner.sfdtExportModule)) {\n            return;\n        }\n        var startPosition = this.start;\n        var endPosition = this.end;\n        if (!this.isForward) {\n            startPosition = this.end;\n            endPosition = this.start;\n        }\n        /* tslint:disable:no-any */\n        // tslint:disable-next-line:max-line-length\n        var document = this.owner.sfdtExportModule.write(startPosition.currentWidget, startPosition.offset, endPosition.currentWidget, endPosition.offset, true);\n        /* tslint:enable:no-any */\n        if (this.owner.editorModule) {\n            this.owner.editorModule.copiedData = JSON.stringify(document);\n        }\n        var html = this.htmlWriter.writeHtml(document);\n        this.copyToClipboard(html);\n        if (isCut && this.owner.editorModule) {\n            this.owner.editorModule.handleCut(this);\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Copy content to clipboard\n     * @private\n     */\n    Selection.prototype.copyToClipboard = function (htmlContent) {\n        window.getSelection().removeAllRanges();\n        var div = document.createElement('div');\n        div.style.left = '-10000px';\n        div.style.top = '-10000px';\n        div.innerHTML = htmlContent;\n        document.body.appendChild(div);\n        var range = document.createRange();\n        range.selectNodeContents(div);\n        window.getSelection().addRange(range);\n        var copySuccess = false;\n        try {\n            copySuccess = document.execCommand('copy');\n        }\n        catch (e) {\n            // Copying data to Clipboard can potentially fail - for example, if another application is holding Clipboard open.\n        }\n        finally {\n            window.getSelection().removeAllRanges();\n            div.parentNode.removeChild(div);\n            this.viewer.viewerContainer.focus();\n        }\n        return copySuccess;\n    };\n    // Caret implementation starts\n    /**\n     * Shows caret in current selection position.\n     * @private\n     */\n    Selection.prototype.showCaret = function () {\n        // tslint:disable-next-line:max-line-length\n        var page = !isNullOrUndefined(this.viewer.currentPage) ? this.viewer.currentPage : this.viewer.currentRenderingPage;\n        if (isNullOrUndefined(page) || this.viewer.isRowOrCellResizing || this.owner.enableImageResizerMode && this.owner.imageResizerModule.isImageResizerVisible) {\n            return;\n        }\n        var left = page.boundingRectangle.x;\n        var right = page.boundingRectangle.width * this.viewer.zoomFactor + left;\n        if (!this.owner.enableImageResizerMode || !this.owner.imageResizerModule.isImageResizerVisible) {\n            // tslint:disable-next-line:max-line-length\n            if (this.isEmpty && (!this.owner.isReadOnlyMode || this.owner.enableCursorOnReadOnly)) {\n                var caretLeft = parseInt(this.caret.style.left.replace('px', ''), 10);\n                if (caretLeft < left || caretLeft > right) {\n                    this.caret.style.display = 'none';\n                }\n                else {\n                    this.caret.style.display = 'block';\n                }\n            }\n            else if (this.isImageSelected && !this.owner.enableImageResizerMode) {\n                this.caret.style.display = 'block';\n            }\n            else {\n                if (this.caret.style.display === 'block' || isNullOrUndefined(this)) {\n                    if (!this.viewer.isComposingIME) {\n                        this.caret.style.display = 'none';\n                    }\n                }\n            }\n        }\n        if (!isNullOrUndefined(this) && this.viewer.isTouchInput && !this.owner.isReadOnlyMode) {\n            var caretStartLeft = parseInt(this.viewer.touchStart.style.left.replace('px', ''), 10) + 14;\n            var caretEndLeft = parseInt(this.viewer.touchEnd.style.left.replace('px', ''), 10) + 14;\n            var page_1 = this.getSelectionPage(this.start);\n            if (page_1) {\n                if (caretEndLeft < left || caretEndLeft > right) {\n                    this.viewer.touchEnd.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchEnd.style.display = 'block';\n                }\n                if (!this.isEmpty) {\n                    left = page_1.boundingRectangle.x;\n                    right = page_1.boundingRectangle.width * this.viewer.zoomFactor + left;\n                }\n                if (caretStartLeft < left || caretStartLeft > right) {\n                    this.viewer.touchStart.style.display = 'none';\n                }\n                else {\n                    this.viewer.touchStart.style.display = 'block';\n                }\n            }\n        }\n        else {\n            this.viewer.touchStart.style.display = 'none';\n            this.viewer.touchEnd.style.display = 'none';\n        }\n    };\n    /**\n     * To set the editable div caret position\n     * @private\n     */\n    Selection.prototype.setEditableDivCaretPosition = function (index) {\n        this.viewer.editableDiv.focus();\n        var child = this.viewer.editableDiv.childNodes[this.viewer.editableDiv.childNodes.length - 1];\n        if (child) {\n            var range = document.createRange();\n            range.setStart(child, index);\n            range.collapse(true);\n            window.getSelection().removeAllRanges();\n            window.getSelection().addRange(range);\n        }\n    };\n    /**\n     * Initializes caret.\n     * @private\n     */\n    Selection.prototype.initCaret = function () {\n        this.caret = createElement('div', {\n            styles: 'position:absolute',\n            className: 'e-de-blink-cursor e-de-cursor-animation'\n        });\n        this.viewer.viewerContainer.appendChild(this.caret);\n    };\n    /**\n     * Updates caret position.\n     * @private\n     */\n    Selection.prototype.updateCaretPosition = function () {\n        var caretPosition = this.end.location;\n        var page = this.getSelectionPage(this.end);\n        if (page) {\n            this.caret.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor) + 'px';\n            var caretInfo = this.updateCaretSize(this.owner.selection.end);\n            var topMargin = caretInfo.topMargin;\n            var caretHeight = caretInfo.height;\n            var viewer = this.viewer;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - viewer.pageGap * (this.viewer.pages.indexOf(page) + 1)) * this.viewer.zoomFactor + viewer.pageGap * (this.viewer.pages.indexOf(page) + 1);\n            this.caret.style.top = pageTop + (Math.round(caretPosition.y + topMargin) * this.viewer.zoomFactor) + 'px';\n            if (this.owner.selection.characterFormat.baselineAlignment === 'Subscript') {\n                this.caret.style.top = parseFloat(this.caret.style.top) + (parseFloat(this.caret.style.height) / 2) + 'px';\n            }\n            if (this.viewer.isTouchInput || this.viewer.touchStart.style.display !== 'none') {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchStart.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchStart.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n                // tslint:disable-next-line:max-line-length\n                this.viewer.touchEnd.style.left = page.boundingRectangle.x + (Math.round(caretPosition.x) * this.viewer.zoomFactor - 14) + 'px';\n                this.viewer.touchEnd.style.top = pageTop + ((caretPosition.y + caretInfo.height) * this.viewer.zoomFactor) + 'px';\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.getRect = function (position) {\n        var caretPosition = position.location;\n        var page = this.getSelectionPage(position);\n        if (page) {\n            var viewer = this.viewer;\n            var left = page.boundingRectangle.x + (Math.round(caretPosition.x) * viewer.zoomFactor);\n            var pageGap = viewer.pageGap;\n            // tslint:disable-next-line:max-line-length\n            var pageTop = (page.boundingRectangle.y - pageGap * (page.index + 1)) * viewer.zoomFactor + pageGap * (page.index + 1);\n            var top_6 = pageTop + (Math.round(caretPosition.y) * viewer.zoomFactor);\n            return new Point(left, top_6);\n        }\n        return new Point(0, 0);\n    };\n    /**\n     * Gets current selected page\n     * @private\n     */\n    Selection.prototype.getSelectionPage = function (position) {\n        var lineWidget = this.getLineWidgetInternal(position.currentWidget, position.offset, true);\n        if (lineWidget) {\n            return this.getPage(lineWidget.paragraph);\n        }\n        return undefined;\n    };\n    /**\n     * Updates caret size.\n     * @private\n     */\n    Selection.prototype.updateCaretSize = function (textPosition, skipUpdate) {\n        var topMargin = 0;\n        var isItalic = false;\n        var caret;\n        var index = 0;\n        var caretHeight = 0;\n        if (this.characterFormat.italic) {\n            isItalic = this.characterFormat.italic;\n        }\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var bottomMargin = 0;\n            var paragraphInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = paragraphInfo.topMargin;\n            bottomMargin = paragraphInfo.bottomMargin;\n            var height = paragraphInfo.height;\n            caretHeight = topMargin < 0 ? topMargin + height : height;\n            if (!skipUpdate) {\n                this.caret.style.height = caretHeight * this.viewer.zoomFactor + 'px';\n            }\n            topMargin = 0;\n        }\n        else {\n            var inlineInfo = textPosition.currentWidget.getInline(textPosition.offset, index);\n            index = inlineInfo.index;\n            var inline = inlineInfo.element;\n            if (!isNullOrUndefined(inline)) {\n                caret = this.getCaretHeight(inline, index, inline.characterFormat, true, topMargin, isItalic);\n                caretHeight = caret.height;\n                if (!skipUpdate) {\n                    this.caret.style.height = caret.height * this.viewer.zoomFactor + 'px';\n                }\n            }\n        }\n        if (!skipUpdate) {\n            if (isItalic) {\n                this.caret.style.transform = 'rotate(13deg)';\n            }\n            else {\n                this.caret.style.transform = '';\n            }\n        }\n        return {\n            'topMargin': topMargin,\n            'height': caretHeight\n        };\n    };\n    /**\n     * Updates caret to page.\n     * @private\n     */\n    Selection.prototype.updateCaretToPage = function (startPosition, endPage) {\n        if (!isNullOrUndefined(endPage)) {\n            this.viewer.selectionEndPage = endPage;\n            if (this.owner.selection.isEmpty) {\n                this.viewer.selectionStartPage = endPage;\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                var startLineWidget = this.getLineWidgetParagraph(startPosition.offset, startPosition.paragraph.childWidgets[0]);\n                //Gets start page.\n                var startPage = this.getPage(startLineWidget.paragraph);\n                if (!isNullOrUndefined(startPage)) {\n                    this.viewer.selectionStartPage = startPage;\n                }\n            }\n        }\n        this.checkForCursorVisibility();\n    };\n    /**\n     * Gets caret bottom position.\n     * @private\n     */\n    Selection.prototype.getCaretBottom = function (textPosition, isEmptySelection) {\n        var bottom = textPosition.location.y;\n        if (textPosition.paragraph.isEmpty()) {\n            var paragraph = textPosition.paragraph;\n            var topMargin = 0;\n            var bottomMargin = 0;\n            var sizeInfo = this.getParagraphMarkSize(paragraph, topMargin, bottomMargin);\n            topMargin = sizeInfo.topMargin;\n            bottomMargin = sizeInfo.bottomMargin;\n            bottom += sizeInfo.height;\n            bottom += topMargin;\n            if (!isEmptySelection) {\n                bottom += bottomMargin;\n            }\n        }\n        else {\n            var index = 0;\n            var inlineInfo = textPosition.paragraph.getInline(textPosition.offset, index);\n            var inline = inlineInfo.element;\n            index = inlineInfo.index;\n            var topMargin = 0;\n            var isItalic = false;\n            // tslint:disable-next-line:max-line-length\n            var caretHeightInfo = this.getCaretHeight(inline, index, inline.characterFormat, false, topMargin, isItalic);\n            topMargin = caretHeightInfo.topMargin;\n            isItalic = caretHeightInfo.isItalic;\n            bottom += caretHeightInfo.height;\n            if (isEmptySelection) {\n                bottom -= HelperMethods.convertPointToPixel(textPosition.paragraph.paragraphFormat.afterSpacing);\n            }\n        }\n        return bottom;\n    };\n    /**\n     * Checks for cursor visibility.\n     * @param isTouch\n     * @private\n     */\n    Selection.prototype.checkForCursorVisibility = function () {\n        this.showCaret();\n    };\n    // caret implementation ends\n    /**\n     * Keyboard shortcuts\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Selection.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.selection.handleTabKey(false, false);\n                //     }\n                //     break;\n                case 35:\n                    this.handleControlEndKey();\n                    break;\n                case 36:\n                    this.handleControlHomeKey();\n                    break;\n                case 37:\n                    this.handleControlLeftKey();\n                    break;\n                case 38:\n                    this.handleControlUpKey();\n                    break;\n                case 39:\n                    this.handleControlRightKey();\n                    break;\n                case 40:\n                    this.handleControlDownKey();\n                    break;\n                case 65:\n                    this.owner.selection.selectAll();\n                    break;\n                case 67:\n                    event.preventDefault();\n                    this.copy();\n                    break;\n                case 70:\n                    event.preventDefault();\n                    if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleShiftEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleShiftHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleShiftLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleShiftUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleShiftRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleShiftDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 35:\n                    this.handleControlShiftEndKey();\n                    break;\n                case 36:\n                    this.handleControlShiftHomeKey();\n                    break;\n                case 37:\n                    this.handleControlShiftLeftKey();\n                    break;\n                case 38:\n                    this.handleControlShiftUpKey();\n                    break;\n                case 39:\n                    this.handleControlShiftRightKey();\n                    break;\n                case 40:\n                    this.handleControlShiftDownKey();\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                // case 9:\n                //     event.preventDefault();\n                //     if (this.owner.acceptTab) {\n                //         this.handleTabKey(true, false);\n                //     }\n                //     break;             \n                case 33:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop -= this.viewer.visibleBounds.height;\n                    break;\n                case 34:\n                    event.preventDefault();\n                    this.viewer.viewerContainer.scrollTop += this.viewer.visibleBounds.height;\n                    break;\n                case 35:\n                    this.handleEndKey();\n                    event.preventDefault();\n                    break;\n                case 36:\n                    this.handleHomeKey();\n                    event.preventDefault();\n                    break;\n                case 37:\n                    this.handleLeftKey();\n                    event.preventDefault();\n                    break;\n                case 38:\n                    this.handleUpKey();\n                    event.preventDefault();\n                    break;\n                case 39:\n                    this.handleRightKey();\n                    event.preventDefault();\n                    break;\n                case 40:\n                    this.handleDownKey();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onKeyDownInternal(event, ctrl, shift, alt);\n        }\n        if (this.owner.searchModule) {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.owner.searchModule.searchHighlighters) && this.owner.searchModule.searchHighlighters.length > 0) {\n                this.owner.searchModule.searchResults.clear();\n            }\n        }\n        if (event.keyCode === 27 || event.which === 27) {\n            if (!isNullOrUndefined(this.owner.optionsPaneModule)) {\n                this.owner.optionsPaneModule.showHideOptionsPane(false);\n            }\n            if (this.owner.enableHeaderAndFooter) {\n                this.disableHeaderFooter();\n            }\n        }\n    };\n    //#region Enable or disable Header Footer\n    /**\n     * @private\n     */\n    Selection.prototype.checkAndEnableHeaderFooter = function (point, pagePoint) {\n        var page = this.viewer.currentPage;\n        if (this.isCursorInsidePageRect(point, page)) {\n            if (this.isCursorInHeaderRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.headerWidget);\n            }\n            if (this.isCursorInFooterRegion(point, page)) {\n                if (this.owner.enableHeaderAndFooter) {\n                    return false;\n                }\n                return this.enableHeadersFootersRegion(page.footerWidget);\n            }\n        }\n        if (this.owner.enableHeaderAndFooter) {\n            this.owner.enableHeaderAndFooter = false;\n            this.viewer.updateTextPositionForSelection(pagePoint, 1);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInsidePageRect = function (point, page) {\n        if ((this.viewer.containerLeft + point.x) >= page.boundingRectangle.x &&\n            (this.viewer.containerLeft + point.x) <= (page.boundingRectangle.x + (page.boundingRectangle.width * this.viewer.zoomFactor))) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInHeaderRegion = function (point, page) {\n        var pageTop = this.getPageTop(page);\n        var headerHeight = 0;\n        if (page.headerWidget) {\n            headerHeight = (page.headerWidget.y + page.headerWidget.height);\n        }\n        var height = Math.max(headerHeight, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.topMargin))\n            * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) >= pageTop && (this.viewer.containerTop + point.y) <= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.isCursorInFooterRegion = function (point, page) {\n        var pageRect = page.boundingRectangle;\n        var pageTop = this.getPageTop(page);\n        var pageBottom = pageTop + (pageRect.height * this.viewer.zoomFactor);\n        var footerDistance = HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.footerDistance);\n        var footerHeight = 0;\n        if (page.footerWidget) {\n            footerHeight = page.footerWidget.height;\n        }\n        // tslint:disable-next-line:max-line-length\n        var height = (pageRect.height -\n            Math.max(footerHeight + footerDistance, HelperMethods.convertPointToPixel(page.bodyWidgets[0].sectionFormat.bottomMargin))) * this.viewer.zoomFactor;\n        if ((this.viewer.containerTop + point.y) <= pageBottom && (this.viewer.containerTop + point.y) >= pageTop + height) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.enableHeadersFootersRegion = function (widget) {\n        this.owner.enableHeaderAndFooter = true;\n        this.updateTextPositionForBlockContainer(widget);\n        return true;\n    };\n    /**\n     * @private\n     */\n    Selection.prototype.updateTextPositionForBlockContainer = function (widget) {\n        var block = widget.firstChild;\n        if (block instanceof TableWidget) {\n            block = this.getFirstBlockInFirstCell(block);\n        }\n        this.selectParagraph(block, true);\n    };\n    /**\n     * Disable Header footer\n     * @private\n     */\n    Selection.prototype.disableHeaderFooter = function () {\n        var page = this.getPage(this.start.paragraph);\n        this.updateTextPositionForBlockContainer(page.bodyWidgets[0]);\n        this.owner.enableHeaderAndFooter = false;\n    };\n    //#endregion\n    /**\n     * @private\n     */\n    Selection.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.contextTypeInternal)) {\n            this.contextTypeInternal = undefined;\n        }\n        this.caret = undefined;\n        this.contextTypeInternal = undefined;\n        this.upDownSelectionLength = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    /**\n     * Navigates to the specified bookmark.\n     * @param name\n     * @param moveToStart\n     * @private\n     */\n    Selection.prototype.navigateBookmark = function (name, moveToStart) {\n        var bookmarks = this.viewer.bookmarks;\n        if (bookmarks.containsKey(name)) {\n            //bookmark start element\n            var bookmrkElmnt = bookmarks.get(name);\n            var offset = bookmrkElmnt.line.getOffset(bookmrkElmnt, 1);\n            var startPosition = new TextPosition(this.viewer.owner);\n            startPosition.setPositionParagraph(bookmrkElmnt.line, offset);\n            if (moveToStart) {\n                this.viewer.selection.selectRange(startPosition, startPosition);\n            }\n            else {\n                //bookmark end element\n                var bookmrkEnd = bookmrkElmnt.reference;\n                var endoffset = bookmrkEnd.line.getOffset(bookmrkEnd, 0);\n                var endPosition = new TextPosition(this.viewer.owner);\n                endPosition.setPositionParagraph(bookmrkEnd.line, endoffset);\n                //selects the bookmark range\n                this.viewer.selection.selectRange(startPosition, endPosition);\n            }\n        }\n    };\n    /**\n     * Selects the specified bookmark.\n     * @param name\n     */\n    Selection.prototype.selectBookmark = function (name) {\n        this.navigateBookmark(name);\n    };\n    /**\n     * Returns the toc field from the selection.\n     * @private\n     */\n    Selection.prototype.getTocField = function () {\n        var paragraph = this.start.paragraph;\n        var tocPara = undefined;\n        while ((paragraph !== undefined && this.isTocStyle(paragraph))) {\n            tocPara = paragraph;\n            paragraph = paragraph.previousRenderedWidget;\n        }\n        if (tocPara !== undefined) {\n            var lineWidget = tocPara.childWidgets[0];\n            if (lineWidget !== undefined) {\n                return lineWidget.children[0];\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Returns true if the paragraph has toc style.\n     */\n    Selection.prototype.isTocStyle = function (paragraph) {\n        var style = paragraph.paragraphFormat.baseStyle;\n        return (style !== undefined && (style.name.toLowerCase().indexOf('toc') !== -1));\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, ParagraphWidget, ListTextElementBox, FieldElementBox } from '../viewer/page';\n/**\n * @private\n */\nvar TextSearch = /** @class */ (function () {\n    function TextSearch(owner) {\n        this.wordBefore = '\\\\b';\n        this.wordAfter = '\\\\b';\n        this.isHeader = false;\n        this.isFooter = false;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearch.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearch.prototype.find = function (pattern, findOption) {\n        return this.findNext(pattern, findOption, '0;0;0');\n    };\n    // tslint:disable-next-line:max-line-length   \n    TextSearch.prototype.findNext = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, true, findOption, hierarchicalPosition);\n        return results.length > 0, results.currentSearchResult;\n    };\n    TextSearch.prototype.stringToRegex = function (textToFind, option) {\n        if (textToFind.indexOf('\\\\') > -1) {\n            textToFind = textToFind.split('\\\\').join('\\\\\\\\');\n        }\n        if (textToFind.indexOf('.') > -1) {\n            textToFind = '\\\\' + textToFind;\n        }\n        if (option === 'WholeWord' || option === 'CaseSensitiveWholeWord') {\n            textToFind = this.wordBefore + textToFind + this.wordAfter;\n        }\n        return new RegExp(textToFind, (option === 'CaseSensitive' || option === 'CaseSensitiveWholeWord') ? 'g' : 'ig');\n    };\n    TextSearch.prototype.isPatternEmpty = function (pattern) {\n        var wordEmpty = this.wordBefore + this.wordAfter;\n        var patternRegExp = pattern.toString();\n        return (patternRegExp.length === 0 || patternRegExp === wordEmpty);\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findAll = function (pattern, findOption, hierarchicalPosition) {\n        if (typeof pattern === 'string') {\n            pattern = this.stringToRegex(pattern, findOption);\n        }\n        if (hierarchicalPosition === undefined) {\n            hierarchicalPosition = '0;0;0';\n        }\n        this.owner.searchModule.textSearchResults.clearResults();\n        var results = this.owner.searchModule.textSearchResults;\n        this.findDocument(results, pattern, false, findOption, hierarchicalPosition);\n        if (results.length > 0 && results.currentIndex < 0) {\n            results.currentIndex = 0;\n        }\n        if (!isNullOrUndefined(results.currentSearchResult)) {\n            var eventArgs = { source: this.viewer.owner };\n            this.viewer.owner.trigger('searchResultsChange', eventArgs);\n            return results;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findDocument = function (results, pattern, isFirstMatch, findOption, hierachicalPosition) {\n        if (this.isPatternEmpty(pattern)) {\n            return;\n        }\n        if (findOption === undefined) {\n            findOption = 'None';\n        }\n        var inline = undefined;\n        var selectionEnd = undefined;\n        if (hierachicalPosition !== undefined) {\n            selectionEnd = this.owner.selection.end;\n        }\n        if (hierachicalPosition !== undefined && isFirstMatch && selectionEnd !== undefined && selectionEnd.paragraph !== undefined) {\n            if (selectionEnd.paragraph instanceof ParagraphWidget) {\n                var indexInInline = 0;\n                // tslint:disable-next-line:max-line-length \n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                var inlineElement = selectionEnd.currentWidget.getInline(this.owner.selection.start.offset, indexInInline);\n                inline = inlineElement.element;\n                indexInInline = inlineElement.index;\n                if (!isNullOrUndefined(inline)) {\n                    var nextParagraphWidget = undefined;\n                    // tslint:disable-next-line:max-line-length  \n                    nextParagraphWidget = this.findInline(inline, pattern, findOption, indexInInline, isFirstMatch, results, selectionEnd);\n                    while (results.length === 0 && !isNullOrUndefined(nextParagraphWidget)) {\n                        while (!isNullOrUndefined(nextParagraphWidget) && nextParagraphWidget.childWidgets.length === 0) {\n                            // tslint:disable-next-line:max-line-length \n                            nextParagraphWidget = this.owner.selection.getNextParagraph(nextParagraphWidget.containerWidget);\n                        }\n                        if (isNullOrUndefined(nextParagraphWidget)) {\n                            break;\n                        }\n                        var lineWidget = nextParagraphWidget.childWidgets[0];\n                        if (lineWidget.children[0] instanceof ListTextElementBox) {\n                            inline = (lineWidget.children[2] instanceof TextElementBox) ? lineWidget.children[2] : undefined;\n                        }\n                        else {\n                            inline = lineWidget.children[0];\n                        }\n                        if (isNullOrUndefined(inline)) {\n                            break;\n                        }\n                        // tslint:disable-next-line:max-line-length  \n                        nextParagraphWidget = this.findInline(inline, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n                    }\n                    if (results.length > 0) {\n                        return;\n                    }\n                }\n            }\n        }\n        var section;\n        section = this.viewer.pages[0].bodyWidgets[0];\n        while (!isNullOrUndefined(section) && section.childWidgets.length === 0) {\n            section = section.nextWidget;\n        }\n        if (isNullOrUndefined(section) || section.childWidgets.length === 0) {\n            return;\n        }\n        this.isHeader = false;\n        this.isFooter = false;\n        this.findInlineText(section, pattern, findOption, isFirstMatch, results, selectionEnd);\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var headerWidget = this.viewer.pages[i].headerWidget;\n            if (!isNullOrUndefined(headerWidget)) {\n                this.isHeader = true;\n                this.isFooter = false;\n                this.findInlineText(headerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var footerWidget = this.viewer.pages[i].footerWidget;\n            if (!isNullOrUndefined(footerWidget)) {\n                this.isHeader = false;\n                this.isFooter = true;\n                this.findInlineText(footerWidget, pattern, findOption, isFirstMatch, results, selectionEnd);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TextSearch.prototype.findInlineText = function (section, pattern, findOption, isFirstMatch, results, selectionEnd) {\n        var paragraphWidget = this.owner.selection.getFirstParagraphBlock(section.childWidgets[0]);\n        // tslint:disable-next-line:max-line-length \n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length === 1 && paragraphWidget.childWidgets[0].children.length === 0) {\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n        }\n        while (!isNullOrUndefined(paragraphWidget) && paragraphWidget.childWidgets.length > 0) {\n            var inlineElement = paragraphWidget.childWidgets[0];\n            var inlineEle = inlineElement.children[0];\n            if (isNullOrUndefined(inlineEle)) {\n                break;\n            }\n            this.findInline(inlineEle, pattern, findOption, 0, isFirstMatch, results, selectionEnd);\n            paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            // tslint:disable-next-line:max-line-length \n            while (!isNullOrUndefined(paragraphWidget) && (paragraphWidget.childWidgets.length === 1) && paragraphWidget.childWidgets[0].children.length === 0) {\n                paragraphWidget = this.owner.selection.getNextParagraphBlock(paragraphWidget);\n            }\n        }\n        if (isFirstMatch && !isNullOrUndefined(results) && results.length > 0) {\n            return;\n        }\n    };\n    // tslint:disable-next-line:max-line-length     \n    TextSearch.prototype.findInline = function (inlineElement, pattern, option, indexInInline, isFirstMatch, results, selectionEnd) {\n        var inlines = inlineElement;\n        var stringBuilder = '';\n        var spans = new Dictionary();\n        //tslint:disable no-constant-condition\n        do {\n            // tslint:disable-next-line:max-line-length \n            if (inlineElement instanceof TextElementBox && (!isNullOrUndefined(inlineElement.text) && inlineElement.text !== '')) {\n                spans.add(inlineElement, stringBuilder.length);\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (inlineElement === inlines) {\n                    stringBuilder = stringBuilder + (inlineElement.text.substring(indexInInline));\n                }\n                else {\n                    stringBuilder = stringBuilder + (inlineElement.text);\n                }\n            }\n            else if (inlineElement instanceof FieldElementBox) {\n                var fieldBegin = inlineElement;\n                if (!isNullOrUndefined(fieldBegin.fieldEnd)) {\n                    // tslint:disable-next-line:max-line-length \n                    inlineElement = isNullOrUndefined(fieldBegin.fieldSeparator) ? fieldBegin.fieldEnd : fieldBegin.fieldSeparator;\n                }\n            }\n            if (!isNullOrUndefined(inlineElement) && isNullOrUndefined(inlineElement.nextNode)) {\n                break;\n            }\n            if (!isNullOrUndefined(inlineElement)) {\n                inlineElement = inlineElement.nextNode;\n            }\n        } while (true);\n        var text = stringBuilder.toString();\n        var matches = [];\n        var matchObject;\n        //tslint:disable no-conditional-assignment\n        while (!isNullOrUndefined(matchObject = pattern.exec(text))) {\n            matches.push(matchObject);\n        }\n        for (var i = 0; i < matches.length; i++) {\n            var match = matches[i];\n            var result = results.addResult();\n            var spanKeys = spans.keys;\n            for (var i_1 = 0; i_1 < spanKeys.length; i_1++) {\n                var span = spanKeys[i_1];\n                var startIndex = spans.get(span);\n                var spanLength = span.length;\n                // IndexInInline Handled specifically for simple find operation to start from starting point\n                if (span === inlines) {\n                    spanLength -= indexInInline;\n                }\n                if (isNullOrUndefined(result.start) && match.index < startIndex + spanLength) {\n                    var index = match.index - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.start = this.getTextPosition(span.line, offset.toString());\n                    result.start.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.start.setPositionParagraph(span.line, offset);\n                }\n                if (match.index + match[0].length <= startIndex + spanLength) {\n                    var index = (match.index + match[0].length) - startIndex;\n                    // IndexInInline Handled specifically for simple find operation to start from starting point\n                    if (span === inlines) {\n                        index += indexInInline;\n                    }\n                    var offset = (span.line).getOffset(span, index);\n                    result.end = this.getTextPosition(span.line, offset.toString());\n                    result.end.location = this.owner.selection.getPhysicalPositionInternal(span.line, offset, true);\n                    result.end.setPositionParagraph(span.line, offset);\n                    break;\n                }\n            }\n            result.isHeader = this.isHeader;\n            result.isFooter = this.isFooter;\n            if (isFirstMatch) {\n                results.currentIndex = 0;\n                return undefined;\n            }\n            else if (results.currentIndex < 0 && selectionEnd.isExistBefore(result.start)) {\n                results.currentIndex = results.indexOf(result);\n            }\n        }\n        // tslint:disable-next-line:max-line-length\n        var paragraphWidget = this.owner.selection.getNextParagraphBlock(inlineElement.line.paragraph);\n        return paragraphWidget;\n    };\n    TextSearch.prototype.getTextPosition = function (lineWidget, hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var index = textPosition.getHierarchicalIndex(lineWidget, hierarchicalIndex);\n        textPosition.setPositionForCurrentIndex(index);\n        return textPosition;\n    };\n    return TextSearch;\n}());\nexport { TextSearch };\n/**\n * @private\n */\nvar SearchWidgetInfo = /** @class */ (function () {\n    function SearchWidgetInfo(left, width) {\n        this.leftInternal = 0;\n        this.widthInternal = 0;\n        this.leftInternal = left;\n        this.widthInternal = width;\n    }\n    Object.defineProperty(SearchWidgetInfo.prototype, \"left\", {\n        get: function () {\n            return this.leftInternal;\n        },\n        set: function (value) {\n            this.leftInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchWidgetInfo.prototype, \"width\", {\n        get: function () {\n            return this.widthInternal;\n        },\n        set: function (value) {\n            this.widthInternal = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SearchWidgetInfo;\n}());\nexport { SearchWidgetInfo };\n","/**\n * @private\n */\nvar TextSearchResult = /** @class */ (function () {\n    function TextSearchResult(owner) {\n        this.startIn = undefined;\n        this.endIn = undefined;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResult.prototype, \"viewer\", {\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"start\", {\n        get: function () {\n            return this.startIn;\n        },\n        set: function (value) {\n            this.startIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"end\", {\n        get: function () {\n            return this.endIn;\n        },\n        set: function (value) {\n            this.endIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResult.prototype, \"text\", {\n        get: function () {\n            return this.viewer.selection.getTextInternal(this.start, this.end, false);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResult.prototype.destroy = function () {\n        this.start = undefined;\n        this.end = undefined;\n    };\n    return TextSearchResult;\n}());\nexport { TextSearchResult };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextSearchResult } from './text-search-result';\n/**\n * @private\n */\nvar TextSearchResults = /** @class */ (function () {\n    function TextSearchResults(owner) {\n        this.currentIndex = -1;\n        this.owner = owner;\n    }\n    Object.defineProperty(TextSearchResults.prototype, \"length\", {\n        get: function () {\n            if (this.innerList === undefined) {\n                return 0;\n            }\n            return this.innerList.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TextSearchResults.prototype, \"currentSearchResult\", {\n        get: function () {\n            if (this.innerList === undefined || this.currentIndex < 0 || this.currentIndex >= this.length) {\n                return undefined;\n            }\n            return this.innerList[this.currentIndex];\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TextSearchResults.prototype.addResult = function () {\n        var textSearchResult = new TextSearchResult(this.owner);\n        if (isNullOrUndefined(this.innerList)) {\n            this.innerList = [];\n        }\n        this.innerList.push(textSearchResult);\n        return textSearchResult;\n    };\n    TextSearchResults.prototype.clearResults = function () {\n        this.currentIndex = -1;\n        if (!isNullOrUndefined(this.innerList)) {\n            for (var i = this.innerList.length - 1; i >= 0; i--) {\n                this.innerList[i].destroy();\n                this.innerList.splice(i, 1);\n            }\n        }\n    };\n    TextSearchResults.prototype.indexOf = function (result) {\n        if (isNullOrUndefined(this.innerList)) {\n            return -1;\n        }\n        return this.innerList.indexOf(result);\n    };\n    TextSearchResults.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.innerList)) {\n            this.clearResults();\n        }\n        this.innerList = undefined;\n    };\n    return TextSearchResults;\n}());\nexport { TextSearchResults };\n","/**\n * Search Result info\n */\nvar SearchResults = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SearchResults(search) {\n        this.searchModule = search;\n    }\n    Object.defineProperty(SearchResults.prototype, \"length\", {\n        /**\n         * Gets the length of search results.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.length;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SearchResults.prototype, \"index\", {\n        /**\n         * Gets the index of current search result.\n         */\n        get: function () {\n            return this.searchModule.textSearchResults.currentIndex;\n        },\n        /**\n         * Set the index of current search result.\n         */\n        set: function (value) {\n            if (this.length === 0 || value < 0 || value > this.searchModule.textSearchResults.length - 1) {\n                return;\n            }\n            this.searchModule.textSearchResults.currentIndex = value;\n            this.navigate(value);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Replace text in current search result.\n     * @param textToReplace text to replace\n     * @private\n     */\n    SearchResults.prototype.replace = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceInternal(textToReplace);\n    };\n    /**\n     * Replace all the instance of search result.\n     * @param textToReplace text to replace\n     */\n    SearchResults.prototype.replaceAll = function (textToReplace) {\n        if (this.index === -1) {\n            return;\n        }\n        this.searchModule.replaceAllInternal(textToReplace);\n    };\n    /**\n     * @private\n     */\n    SearchResults.prototype.navigate = function (index) {\n        this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult);\n        this.searchModule.highlight(this.searchModule.textSearchResults);\n    };\n    /**\n     * Clears all the instance of search result.\n     */\n    SearchResults.prototype.clear = function () {\n        this.searchModule.textSearchResults.clearResults();\n        this.searchModule.clearSearchHighlight();\n        this.searchModule.viewer.renderVisiblePages();\n    };\n    return SearchResults;\n}());\nexport { SearchResults };\n","import { Dictionary } from '../../base/dictionary';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { TextPosition } from '../selection/selection-helper';\nimport { TextElementBox, FieldElementBox } from '../viewer/page';\nimport { SearchWidgetInfo } from './text-search';\nimport { TextSearch } from '../search/text-search';\nimport { TextSearchResults } from '../search/text-search-results';\nimport { SearchResults } from './search-results';\n/**\n * Search module\n */\nvar Search = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function Search(owner) {\n        /**\n         * @private\n         */\n        this.searchHighlighters = undefined;\n        this.isHandledOddPageHeader = undefined;\n        this.isHandledEvenPageHeader = undefined;\n        this.isHandledOddPageFooter = undefined;\n        this.isHandledEvenPageFooter = undefined;\n        this.owner = owner;\n        this.searchHighlighters = new Dictionary();\n        this.textSearch = new TextSearch(this.owner);\n        this.textSearchResults = new TextSearchResults(this.owner);\n        this.searchResultsInternal = new SearchResults(this);\n    }\n    Object.defineProperty(Search.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Search.prototype, \"searchResults\", {\n        /**\n         * Gets the search results object.\n         */\n        get: function () {\n            return this.searchResultsInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Get the module name.\n     */\n    Search.prototype.getModuleName = function () {\n        return 'Search';\n    };\n    //#region Find & Find All\n    /**\n     * Finds the immediate occurrence of specified text from cursor position in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of â€˜findOptionsâ€™ parameter is 'None'.\n     * @private\n     */\n    Search.prototype.find = function (text, findOptions) {\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var result = this.textSearch.find(text, findOptions);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n        }\n    };\n    /**\n     * Finds all occurrence of specified text in the document.\n     * @param  {string} text\n     * @param  {FindOption} findOption? - Default value of â€˜findOptionsâ€™ parameter is 'None'.\n     */\n    Search.prototype.findAll = function (text, findOptions) {\n        if (isNullOrUndefined(text || text === '')) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var results = this.textSearch.findAll(text, findOptions);\n        if (!isNullOrUndefined(results) && results.length > 0) {\n            this.navigate(results.innerList[results.currentIndex]);\n            this.highlight(results);\n        }\n    };\n    //#endregion\n    //#region Replace and Replace All   \n    /**\n     * Replace the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResult} result\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replace = function (replaceText, result, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (!isNullOrUndefined(this.viewer)) {\n            this.clearSearchHighlight();\n        }\n        this.navigate(result);\n        var endPosition = this.viewer.selection.start;\n        var index = results.indexOf(result);\n        if (index < 0) {\n            return 0;\n        }\n        this.owner.editorModule.insertText(replaceText, true);\n        var endTextPosition = result.end;\n        var startPosition = new TextPosition(this.viewer.owner);\n        startPosition.setPositionParagraph(endTextPosition.currentWidget, endPosition.offset - replaceText.length);\n        this.viewer.selection.selectRange(endPosition, startPosition);\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n        return 1;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of â€˜findOptionsâ€™ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        var textToFind = this.textSearchResults.currentSearchResult.text;\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(textToFind, findOptions);\n        var index = this.owner.selection.end.getHierarchicalIndexInternal();\n        var result = this.viewer.owner.searchModule.textSearch.findNext(pattern, findOptions, index);\n        if (!isNullOrUndefined(result)) {\n            this.navigate(result);\n            this.textSearchResults.addResult();\n            this.textSearchResults.innerList[0] = result;\n            this.replace(textToReplace, result, this.textSearchResults);\n            index = this.owner.selection.end.getHierarchicalIndexInternal();\n            result = this.textSearch.findNext(textToFind, findOptions, index);\n            if (result) {\n                this.textSearchResults.addResult();\n                this.textSearchResults.innerList[0] = result;\n                this.navigate(result);\n            }\n        }\n    };\n    /**\n     * Replace all the searched string with specified string\n     * @param  {string} replaceText\n     * @param  {TextSearchResults} results\n     * @private\n     */\n    Search.prototype.replaceAll = function (replaceText, results) {\n        if (isNullOrUndefined(this.viewer.owner) || this.viewer.owner.isReadOnlyMode || isNullOrUndefined(results)) {\n            return 0;\n        }\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.initComplexHistory(this.owner.selection, 'ReplaceAll');\n        }\n        var count = results.length;\n        this.viewer.owner.isLayoutEnabled = false;\n        for (var i = count - 1; i >= 0; i--) {\n            var result = results.innerList[i];\n            this.navigate(results.innerList[i]);\n            this.owner.editorModule.insertText(replaceText, true);\n            if (result.isHeader || result.isFooter) {\n                this.viewer.layout.updateHeaderFooterToParent(this.viewer.selection.start.paragraph.bodyWidget);\n            }\n            results.innerList[i].destroy();\n        }\n        if (this.owner.editorHistory && !isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.owner.editorModule.updateComplexWithoutHistory(2);\n        }\n        this.searchResults.clear();\n        return count;\n    };\n    /**\n     * Find the textToFind string in current document and replace the specified string.\n     * @param  {string} textToFind\n     * @param  {string} textToReplace\n     * @param  {FindOption} findOptions? - Default value of â€˜findOptionsâ€™ parameter is FindOption.None.\n     * @private\n     */\n    Search.prototype.replaceAllInternal = function (textToReplace, findOptions) {\n        if ((textToReplace === '' || isNullOrUndefined(textToReplace))) {\n            return;\n        }\n        if (isNullOrUndefined(findOptions)) {\n            findOptions = 'None';\n        }\n        if (this.textSearchResults.length > 0) {\n            this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]);\n            this.highlight(this.textSearchResults);\n            this.replaceAll(textToReplace, this.textSearchResults);\n        }\n    };\n    //#endregion\n    //#region Highlight Search Result\n    /**\n     * @private\n     */\n    Search.prototype.navigate = function (textSearchResult) {\n        if (textSearchResult) {\n            var start = textSearchResult.start;\n            var end = textSearchResult.end;\n            if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.owner.selection) && !isNullOrUndefined(start) &&\n                !isNullOrUndefined(end) && !isNullOrUndefined(start.paragraph) && !isNullOrUndefined(end.paragraph)) {\n                this.owner.selection.selectRange(start, end);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlight = function (textSearchResults) {\n        this.searchHighlighters = new Dictionary();\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.highlightResult(result);\n        }\n        this.viewer.renderVisiblePages();\n    };\n    /**\n     * @private\n     */\n    Search.prototype.highlightResult = function (result) {\n        this.highlightSearchResult(result.start.paragraph, result.start, result.end);\n    };\n    /**\n     * Highlight search result\n     * @private\n     */\n    Search.prototype.highlightSearchResult = function (paragraph, start, end) {\n        var selectionStartIndex = 0;\n        var selectionEndIndex = 0;\n        var startElement = null;\n        var endElement = null;\n        // tslint:disable-next-line:max-line-length\n        var lineWidget = this.viewer.selection.getStartLineWidget(paragraph, start, startElement, selectionStartIndex);\n        selectionStartIndex = lineWidget.index;\n        startElement = lineWidget.element;\n        var startLineWidget = startElement ? startElement.line : paragraph.childWidgets[0];\n        var endLine = this.viewer.selection.getEndLineWidget(end, endElement, selectionEndIndex);\n        selectionEndIndex = endLine.index;\n        endElement = endLine.element;\n        var endLineWidget = endElement ? endElement.line :\n            end.paragraph.childWidgets[end.paragraph.childWidgets.length - 1];\n        var top = this.viewer.selection.getTop(startLineWidget);\n        var left = this.viewer.selection.getLeftInternal(startLineWidget, startElement, selectionStartIndex);\n        if (!isNullOrUndefined(startLineWidget) && startLineWidget === endLineWidget) {\n            //find result ends in current line.\n            var right = this.viewer.selection.getLeftInternal(endLineWidget, endElement, selectionEndIndex);\n            this.createHighlightBorder(startLineWidget, right - left, left, top);\n        }\n        else {\n            if (!isNullOrUndefined(startLineWidget)) {\n                if (paragraph !== startLineWidget.paragraph) {\n                    paragraph = startLineWidget.paragraph;\n                }\n                // tslint:disable-next-line:max-line-length\n                this.createHighlightBorder(startLineWidget, this.viewer.selection.getWidth(startLineWidget, true) - (left - startLineWidget.paragraph.x), left, top);\n                var lineIndex = startLineWidget.paragraph.childWidgets.indexOf(startLineWidget);\n                //Iterates to last item of paragraph or search result end.\n                var startParagraphWidget = void 0;\n                for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                    if (paragraph === startLineWidget.paragraph) {\n                        lineIndex += 1;\n                    }\n                    this.highlightSearchResultParaWidget(paragraph, lineIndex, endLineWidget, endElement, selectionEndIndex);\n                    if (paragraph === endLineWidget.paragraph) {\n                        return;\n                    }\n                    else {\n                        lineIndex = 0;\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Search.prototype.createHighlightBorder = function (lineWidget, width, left, top) {\n        var findHighLight = this.addSearchHighlightBorder(lineWidget);\n        var page = this.viewer.owner.selection.getPage(lineWidget.paragraph);\n        var pageTop = page.boundingRectangle.y;\n        var pageLeft = page.boundingRectangle.x;\n        findHighLight.left = Math.ceil(left);\n        top = Math.ceil(top);\n        findHighLight.width = Math.floor(width);\n        var height = Math.floor(lineWidget.height);\n        var context = this.viewer.containerContext;\n    };\n    /**\n     * Adds search highlight border.\n     * @private\n     */\n    Search.prototype.addSearchHighlightBorder = function (lineWidget) {\n        var highlighters = undefined;\n        if (this.searchHighlighters.containsKey(lineWidget)) {\n            highlighters = this.searchHighlighters.get(lineWidget);\n        }\n        else {\n            highlighters = [];\n            this.searchHighlighters.add(lineWidget, highlighters);\n        }\n        var searchHighlight = new SearchWidgetInfo(0, 0);\n        highlighters.push(searchHighlight);\n        return searchHighlight;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Search.prototype.highlightSearchResultParaWidget = function (widget, startIndex, endLine, endElement, endIndex) {\n        var top = 0;\n        for (var j = startIndex; j < widget.childWidgets.length; j++) {\n            var lineWidget = widget.childWidgets[j];\n            if (j === startIndex) {\n                top = this.viewer.selection.getTop(lineWidget);\n            }\n            var left = this.viewer.selection.getLeft(lineWidget);\n            if (lineWidget === endLine) {\n                //Search result ends in current line.\n                var right = this.viewer.selection.getLeftInternal(endLine, endElement, endIndex);\n                this.createHighlightBorder(lineWidget, right - left, left, top);\n                return;\n            }\n            this.createHighlightBorder(lineWidget, this.viewer.selection.getWidth(lineWidget, true) - (left - widget.x), left, top);\n            top += lineWidget.height;\n        }\n    };\n    //#endregion\n    //#region Get find result view\n    /**\n     * @private\n     */\n    Search.prototype.addSearchResultItems = function (result) {\n        if (isNullOrUndefined(result) || result === '') {\n            return;\n        }\n        if (isNullOrUndefined(this.owner.findResultsList)) {\n            this.owner.findResultsList = [];\n        }\n        this.owner.findResultsList.push(result);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.addFindResultView = function (textSearchResults) {\n        for (var i = 0; i < textSearchResults.innerList.length; i++) {\n            var result = textSearchResults.innerList[i];\n            this.addFindResultViewForSearch(result);\n        }\n        this.isHandledOddPageHeader = true;\n        this.isHandledOddPageFooter = true;\n        this.isHandledEvenPageHeader = true;\n        this.isHandledEvenPageFooter = true;\n    };\n    /**\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Search.prototype.addFindResultViewForSearch = function (result) {\n        if (result.start != null && result.end != null && result.start.paragraph != null && result.end.paragraph != null) {\n            var prefixText = void 0;\n            var suffixtext = void 0;\n            var currentText = void 0;\n            var startIndex = 0;\n            var inlineObj = result.start.currentWidget.getInline(result.start.offset, startIndex);\n            var inline = inlineObj.element;\n            startIndex = inlineObj.index;\n            var prefix = '';\n            var lastIndex = 0;\n            if (inline instanceof FieldElementBox) {\n                var elementInfo = this.owner.selection.getRenderedInline(inline, startIndex);\n                if (elementInfo.element.nextNode instanceof TextElementBox) {\n                    inline = elementInfo.element.nextNode;\n                    startIndex = elementInfo.index;\n                }\n                else {\n                    inline = elementInfo.element;\n                    startIndex = elementInfo.index;\n                }\n            }\n            var boxObj = this.owner.selection.getElementBoxInternal(inline, startIndex);\n            var box = boxObj.element;\n            startIndex = boxObj.index;\n            if (box != null) {\n                if (box instanceof TextElementBox && startIndex > 0) {\n                    prefix = box.text.substring(0, startIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                lastIndex = prefix.lastIndexOf(' ');\n                while (lastIndex < 0 && boxIndex > 0 && box.line.children[boxIndex - 1] instanceof TextElementBox) {\n                    prefix = box.line.children[boxIndex - 1].text + prefix;\n                    boxIndex--;\n                    lastIndex = prefix.lastIndexOf(' ');\n                }\n            }\n            var shiftIndex = prefix.lastIndexOf('\\v');\n            if (shiftIndex > 0) {\n                prefix = prefix.substring(0, shiftIndex);\n            }\n            else {\n                lastIndex = prefix.lastIndexOf(' ');\n                prefixText = lastIndex < 0 ? prefix : prefix.substring(lastIndex + 1);\n            }\n            currentText = result.text;\n            var endIndex = 0;\n            var endInlineObj = result.end.currentWidget.getInline(result.end.offset, endIndex);\n            var endInline = endInlineObj.element;\n            endIndex = endInlineObj.index;\n            suffixtext = '';\n            //Checks prefix element box is empty\n            if (boxObj != null) {\n                // Gets the element box using endIndex of the text and set as suffix\n                boxObj = this.owner.selection.getElementBoxInternal(endInline, endIndex);\n                box = boxObj.element;\n                endIndex = boxObj.index;\n            }\n            //Checks suffix element box is empty.\n            if (box != null) {\n                if (box instanceof TextElementBox && endIndex < box.length) {\n                    suffixtext = box.text.substring(endIndex);\n                }\n                var boxIndex = box.line.children.indexOf(box);\n                // tslint:disable-next-line:max-line-length\n                while (boxIndex + 1 < box.line.children.length && (box.line.children[boxIndex + 1] instanceof TextElementBox) || (box.line.children[boxIndex + 1] instanceof FieldElementBox)) {\n                    if (box.line.children[boxIndex + 1] instanceof FieldElementBox) {\n                        boxIndex = boxIndex + 2;\n                    }\n                    else {\n                        suffixtext = suffixtext + box.line.children[boxIndex + 1].text;\n                        boxIndex = boxIndex + 1;\n                    }\n                }\n            }\n            lastIndex = suffixtext.lastIndexOf(' ');\n            suffixtext = suffixtext === '\\v' ? suffixtext = '' : suffixtext;\n            var headerFooterString = '';\n            if (result.isHeader) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Header' + ': ' + '</span>';\n            }\n            else if (result.isFooter) {\n                headerFooterString = '<span class=\"e-de-header-footer-list\">' + 'Footer' + ': ' + '</span>';\n            }\n            else {\n                headerFooterString = '';\n                headerFooterString = '';\n                this.isHandledOddPageHeader = true;\n                this.isHandledEvenPageHeader = true;\n                this.isHandledOddPageFooter = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            var listElement = '';\n            var page = result.viewer.selection.getPage(result.start.paragraph);\n            if (isNullOrUndefined(this.isHandledEvenPageHeader) && isNullOrUndefined(this.isHandledEvenPageFooter)) {\n                this.isHandledEvenPageHeader = true;\n                this.isHandledEvenPageFooter = true;\n            }\n            else if (isNullOrUndefined(this.isHandledOddPageHeader) && isNullOrUndefined(this.isHandledOddPageFooter)) {\n                this.isHandledOddPageHeader = true;\n                this.isHandledOddPageFooter = true;\n            }\n            if (result.isHeader) {\n                if (page.headerWidget.headerFooterType === 'FirstPageHeader' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.headerWidget.headerFooterType === 'EvenHeader' && this.isHandledEvenPageHeader) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageHeader = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.headerWidget.headerFooterType === 'OddHeader' && this.isHandledOddPageHeader) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageHeader = false;\n                }\n            }\n            else if (result.isFooter) {\n                if (page.footerWidget.headerFooterType === 'FirstPageFooter' && page.bodyWidgets[0].sectionFormat.differentFirstPage) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                }\n                else if (page.footerWidget.headerFooterType === 'EvenFooter' && this.isHandledEvenPageFooter) {\n                    // tslint:disable-next-line:max-line-length\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledEvenPageFooter = false;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (page.footerWidget.headerFooterType === 'OddFooter' && this.isHandledOddPageFooter) {\n                    listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n                    this.isHandledOddPageFooter = false;\n                }\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (!result.isHeader && !result.isFooter) {\n                listElement = '<li tabindex=0 class=\"e-de-search-result-item e-de-op-search-txt\">' + headerFooterString + prefix + '<span class=\"e-de-op-search-word\" style=\"pointer-events:none\">' + result.text + '</span>' + suffixtext + '</li>';\n            }\n            this.addSearchResultItems(listElement);\n        }\n    };\n    //#endregion\n    /**\n     * Clears search highlight.\n     * @private\n     */\n    Search.prototype.clearSearchHighlight = function () {\n        if (!isNullOrUndefined(this.searchHighlighters)) {\n            this.searchHighlighters.clear();\n            this.searchHighlighters = undefined;\n        }\n        var eventArgs = { source: this.viewer.owner };\n        this.viewer.owner.trigger('searchResultsChange', eventArgs);\n    };\n    /**\n     * @private\n     */\n    Search.prototype.destroy = function () {\n        if (this.textSearchResults) {\n            this.textSearchResults.destroy();\n        }\n    };\n    return Search;\n}());\nexport { Search };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * Options Pane class.\n */\nvar OptionsPane = /** @class */ (function () {\n    /**\n     * Constructor for Options pane module\n     * @param {LayoutViewer} layoutViewer\n     * @private\n     */\n    function OptionsPane(layoutViewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.isOptionsPaneShow = false;\n        this.findOption = 'None';\n        this.matchCase = undefined;\n        this.wholeWord = undefined;\n        // private regular: CheckBox = undefined;\n        this.searchText = 'Navigation';\n        this.resultsText = 'Results';\n        this.messageDivText = 'No matches';\n        this.replaceButtonText = 'Replace';\n        this.replaceAllButtonText = 'Replace All';\n        this.focusedIndex = -1;\n        this.focusedElement = [];\n        this.isOptionsPane = true;\n        this.replacePaneText = 'Replace';\n        this.findPaneText = 'Find';\n        this.matchDivReplaceText = 'No matches';\n        /**\n         * @private\n         */\n        this.tabInstance = undefined;\n        /**\n         * @private\n         */\n        this.isReplace = false;\n        /**\n         * Gets selected tab item which tab is selected.\n         * @param {SelectEventArgs} args - Specifies which tab will be opened.\n         * @private\n         */\n        this.selectedTabItem = function (args) {\n            if (args.previousIndex !== args.selectedIndex) {\n                var previousTab = document.querySelector('#e-content_' + args.previousIndex);\n                var nextTab = document.querySelector('#e-content_' + args.selectedIndex);\n                nextTab.insertBefore(previousTab.firstElementChild, nextTab.firstChild);\n            }\n            if (args.selectedIndex === 0 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = true;\n                _this.onFindPane();\n            }\n            if (args.selectedIndex === 1 && !isNullOrUndefined(document.querySelector('#e-content_' + args.selectedIndex))) {\n                _this.isOptionsPane = false;\n                _this.onReplacePane();\n            }\n        };\n        this.searchOptionChange = function () {\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var inputText = _this.searchInput.value;\n            if (inputText === '') {\n                return;\n            }\n            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(inputText, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var selectionIndex = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, selectionIndex);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n            }\n            else {\n                _this.viewer.renderVisiblePages();\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Apply find option based on whole words value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.wholeWordsChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find option based on match value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        this.matchChange = function (args) {\n            if (_this.matchInput.checked && _this.wholeInput.checked) {\n                _this.findOption = 'CaseSensitiveWholeWord';\n            }\n            else if (!(_this.matchInput.checked) && _this.wholeInput.checked) {\n                _this.findOption = 'WholeWord';\n            }\n            else if (_this.matchInput.checked && !(_this.wholeInput.checked)) {\n                _this.findOption = 'CaseSensitive';\n            }\n            else {\n                _this.findOption = 'None';\n            }\n            _this.searchOptionChange();\n        };\n        /**\n         * Apply find options based on regular value.\n         * @param {ChangeEventArgs} args - Specifies the search options value.\n         * @private\n         */\n        // public regularChange = (args: ChangeEventArgs): void => {\n        //     if (args.checked) {\n        //         this.matchCase.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.add('e-checkbox-disabled');\n        //         this.matchCase.checked = false;\n        //         this.wholeWord.checked = false;\n        //         this.findOption = 'None';\n        //         this.onKeyDownInternal();\n        //     } else {\n        //         this.matchCase.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //         this.wholeWord.element.parentElement.parentElement.classList.remove('e-checkbox-disabled');\n        //     }\n        // }\n        // tslint:enable:no-any \n        /**\n         * Binding events from the element when optins pane creation.\n         * @private\n         */\n        this.onWireEvents = function () {\n            _this.searchIcon.addEventListener('click', _this.searchIconClickInternal);\n            _this.navigateToNextResult.addEventListener('click', _this.navigateNextResultButtonClick);\n            _this.navigateToPreviousResult.addEventListener('click', _this.navigatePreviousResultButtonClick);\n            _this.searchInput.addEventListener('keydown', _this.onKeyDown);\n            _this.searchInput.addEventListener('keyup', _this.onEnableDisableReplaceButton);\n            _this.resultsListBlock.addEventListener('click', _this.resultListBlockClick);\n            _this.closeButton.addEventListener('click', _this.close);\n            _this.replaceButton.addEventListener('click', _this.onReplaceButtonClick);\n            _this.replaceAllButton.addEventListener('click', _this.onReplaceAllButtonClick);\n        };\n        /**\n         * Enable find pane only.\n         * @private\n         */\n        this.onFindPane = function () {\n            _this.replaceDiv.style.display = 'none';\n            _this.occurrenceDiv.style.display = 'none';\n            if (!isNullOrUndefined(_this.results) && _this.results.length === 0) {\n                _this.resultsListBlock.innerHTML = '';\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n            }\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight + _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.replaceTabContentDiv.style.display = 'none';\n            _this.findDiv.style.display = 'block';\n            _this.messageDiv.style.display = 'block';\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput);\n            _this.focusedIndex = 3;\n            _this.searchInput.select();\n            _this.getMessageDivHeight();\n        };\n        this.onEnableDisableReplaceButton = function () {\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n        };\n        /**\n         * Enable replace pane only.\n         * @private\n         */\n        this.onReplacePane = function () {\n            _this.findDiv.style.display = 'block';\n            _this.replaceDiv.style.display = 'block';\n            _this.replaceTabContentDiv.style.display = 'block';\n            _this.resultsListBlock.style.height = _this.resultsListBlock.offsetHeight - _this.replaceTabContentDiv.offsetHeight + 'px';\n            _this.isOptionsPane = false;\n            if (_this.searchInput.value.length !== 0) {\n                _this.replaceButton.disabled = false;\n                _this.replaceAllButton.disabled = false;\n            }\n            else {\n                _this.replaceButton.disabled = true;\n                _this.replaceAllButton.disabled = true;\n            }\n            _this.focusedElement = [];\n            // tslint:disable-next-line:max-line-length\n            _this.focusedElement.push(_this.closeButton, _this.findTabButtonHeader, _this.replaceTabButtonHeader, _this.searchInput, _this.searchIcon, _this.navigateToPreviousResult, _this.navigateToNextResult, _this.matchInput, _this.wholeInput, _this.replaceWith, _this.replaceButton, _this.replaceAllButton);\n            _this.focusedIndex = 9;\n            if (_this.searchInput.value === '') {\n                _this.searchInput.select();\n            }\n            else {\n                _this.replaceWith.select();\n            }\n            _this.getMessageDivHeight();\n        };\n        /**\n         * Fires on key down on options pane.\n         * @param {KeyboardEvent} event - Specifies the focus of current element.\n         * @private\n         */\n        this.onKeyDownOnOptionPane = function (event) {\n            // if (event.keyCode === 70) {\n            //     event.preventDefault();\n            //     return;\n            // }\n            if (event.keyCode === 9) {\n                event.preventDefault();\n                var focusIndex = undefined;\n                if (event.shiftKey) {\n                    focusIndex = (_this.focusedIndex === 0 || isNullOrUndefined(_this.focusedIndex)) ?\n                        _this.focusedElement.length - 1 : _this.focusedIndex - 1;\n                }\n                else {\n                    focusIndex = (_this.focusedElement.length - 1 === _this.focusedIndex || isNullOrUndefined(_this.focusedIndex)) ?\n                        0 : _this.focusedIndex + 1;\n                }\n                var element = _this.focusedElement[focusIndex];\n                element.focus();\n                if (element instanceof HTMLInputElement) {\n                    element.select();\n                }\n                _this.focusedIndex = focusIndex;\n                if (element instanceof HTMLLIElement) {\n                    _this.scrollToPosition(element);\n                }\n            }\n            else if (event.keyCode === 13) {\n                // tslint:disable-next-line:max-line-length\n                if (event.target !== _this.searchInput && event.target !== _this.closeButton) {\n                    event.preventDefault();\n                    var index = _this.focusedElement.indexOf(event.target);\n                    if (index !== -1) {\n                        var list = _this.focusedElement[index];\n                        list.click();\n                        list.focus();\n                        _this.focusedIndex = index;\n                    }\n                }\n            }\n            else if (event.keyCode === 40 || event.keyCode === 38) {\n                if (_this.resultsListBlock.style.display !== 'none') {\n                    var index = void 0;\n                    var element = void 0;\n                    if (event.keyCode === 40) {\n                        if (_this.focusedIndex > 7) {\n                            if (_this.focusedIndex + 1 < _this.focusedElement.length) {\n                                element = _this.focusedElement[_this.focusedIndex + 1];\n                                element.focus();\n                                _this.focusedIndex = _this.focusedIndex + 1;\n                            }\n                        }\n                        else {\n                            index = (_this.focusedElement.length - _this.resultsListBlock.children.length) + _this.results.currentIndex + 1;\n                            if (index < _this.focusedElement.length) {\n                                element = _this.focusedElement[index];\n                                element.focus();\n                                _this.focusedIndex = index;\n                            }\n                        }\n                    }\n                    else {\n                        if (_this.focusedIndex > 8) {\n                            index = _this.focusedIndex - 1;\n                            element = _this.focusedElement[index];\n                            element.focus();\n                            _this.focusedIndex = index;\n                        }\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace.\n         * @private\n         */\n        this.onReplaceButtonClick = function () {\n            var optionsPane = _this.optionsPane;\n            var findText = _this.searchInput.value;\n            var replaceText = _this.replaceWith.value;\n            var results = _this.viewer.owner.searchModule.textSearchResults;\n            if (findText !== '' && !isNullOrUndefined(findText)) {\n                if (_this.viewer.owner.selection != null) {\n                    var selectionText = _this.viewer.owner.selection.text;\n                    if (!_this.viewer.owner.selection.isEmpty) {\n                        if (_this.viewer.owner.selection.isForward) {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.start, true);\n                        }\n                        else {\n                            _this.viewer.owner.selection.selectContent(_this.viewer.owner.selection.end, true);\n                        }\n                    }\n                    if (!isNullOrUndefined(results) && !isNullOrUndefined(results.currentSearchResult)) {\n                        var result = results.currentSearchResult;\n                        _this.viewer.owner.searchModule.navigate(result);\n                        if (result.text === selectionText) {\n                            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n                            _this.viewer.owner.searchModule.replace(replace, result, results);\n                            var pattern = _this.viewer.owner.searchModule.textSearch.stringToRegex(findText, _this.findOption);\n                            var endSelection = _this.viewer.selection.end;\n                            var index = endSelection.getHierarchicalIndexInternal();\n                            // tslint:disable-next-line:max-line-length\n                            _this.viewer.owner.searchModule.textSearchResults = _this.viewer.owner.searchModule.textSearch.findAll(pattern, _this.findOption, index);\n                            _this.results = _this.viewer.owner.searchModule.textSearchResults;\n                            if (!isNullOrUndefined(_this.results) && !isNullOrUndefined(_this.results.currentSearchResult)) {\n                                _this.viewer.owner.searchModule.navigate(_this.results.currentSearchResult);\n                            }\n                            else {\n                                _this.messageDiv.style.display = 'block';\n                                _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                            }\n                            _this.viewer.owner.findResultsList = [];\n                            if (!isNullOrUndefined(_this.results) && _this.results.innerList.length > 0) {\n                                _this.navigateSearchResult();\n                            }\n                            else {\n                                _this.resultsListBlock.innerHTML = '';\n                            }\n                        }\n                    }\n                    else {\n                        _this.messageDiv.style.display = 'block';\n                        _this.messageDiv.innerHTML = _this.localeValue.getConstant(_this.matchDivReplaceText);\n                    }\n                }\n            }\n        };\n        /**\n         * Fires on replace all.\n         * @private\n         */\n        this.onReplaceAllButtonClick = function () {\n            _this.replaceAll();\n            _this.resultsListBlock.style.display = 'none';\n            _this.messageDiv.innerHTML = '';\n        };\n        /**\n         * Fires on search icon.\n         * @private\n         */\n        this.searchIconClickInternal = function () {\n            // tslint:disable:no-any \n            var inputElement = document.getElementById(_this.viewer.owner.containerId + '_option_search_text_box');\n            // tslint:enable:no-any\n            var text = inputElement.value;\n            if (text === '') {\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                _this.searchIcon.classList.add('e-de-op-search-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                inputElement.value = '';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.matchDiv.style.display = 'none';\n                _this.occurrenceDiv.style.display = 'none';\n                _this.onEnableDisableReplaceButton();\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                _this.clearSearchResultItems();\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.viewer.renderVisiblePages();\n                return;\n            }\n            if (_this.searchIcon.classList.contains('e-de-op-search-icon') && text.length >= 1) {\n                _this.searchIcon.classList.add('e-de-op-search-close-icon');\n                _this.searchIcon.classList.remove('e-de-op-search-icon');\n                _this.onEnableDisableReplaceButton();\n            }\n            _this.clearSearchResultItems();\n            _this.viewer.owner.searchModule.clearSearchHighlight();\n            var patterns = _this.viewer.owner.searchModule.textSearch.stringToRegex(text, _this.findOption);\n            var endSelection = _this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            _this.results = _this.viewer.owner.searchModule.textSearch.findAll(patterns, _this.findOption, index);\n            if (_this.results != null && _this.results.length > 0) {\n                _this.navigateSearchResult();\n                _this.getMessageDivHeight();\n                var resultsContainerHeight = _this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n                _this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            }\n            else {\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'block';\n                _this.resultsListBlock.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n            }\n        };\n        /**\n         * Fires on getting next results.\n         * @private\n         */\n        this.navigateNextResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex < _this.results.length - 1) {\n                    _this.results.currentIndex = _this.results.currentIndex + 1;\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var i = 0; i < _this.resultsListBlock.children.length; i++) {\n                        var list = _this.resultsListBlock.children[i];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElement.classList.contains('e-de-search-result-item')) {\n                        listElement.classList.remove('e-de-search-result-item');\n                        listElement.classList.add('e-de-search-result-hglt');\n                        listElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElement);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    var currentelement = _this.results.innerList[0];\n                    _this.results.currentIndex = 0;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var lists = _this.resultsListBlock.children[j];\n                        if (lists.classList.contains('e-de-search-result-hglt')) {\n                            lists.classList.remove('e-de-search-result-hglt');\n                            lists.children[0].classList.remove('e-de-op-search-word-text');\n                            lists.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElementsDiv = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElementsDiv.classList.contains('e-de-search-result-item')) {\n                        listElementsDiv.classList.remove('e-de-search-result-item');\n                        listElementsDiv.classList.add('e-de-search-result-hglt');\n                        listElementsDiv.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElementsDiv);\n                    }\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToNextResult);\n            }\n        };\n        /**\n         * Fires on getting previous results.\n         * @private\n         */\n        this.navigatePreviousResultButtonClick = function () {\n            if (document.getElementById(_this.viewer.owner.containerId + '_list_box_container') != null &&\n                document.getElementById(_this.viewer.owner.containerId + '_list_box_container').style.display !== 'none') {\n                if (_this.results.currentIndex === 0) {\n                    _this.results.currentIndex = _this.results.length - 1;\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.length) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    for (var index = 0; index < _this.resultsListBlock.children.length; index++) {\n                        var list = _this.resultsListBlock.children[index];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var liElement = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (liElement.classList.contains('e-de-search-result-item')) {\n                        liElement.classList.remove('e-de-search-result-item');\n                        liElement.classList.add('e-de-search-result-hglt');\n                        liElement.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(liElement);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (_this.results.currentIndex) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n                    _this.results.currentIndex = _this.results.currentIndex - 1;\n                    for (var j = 0; j < _this.resultsListBlock.children.length; j++) {\n                        var list = _this.resultsListBlock.children[j];\n                        if (list.classList.contains('e-de-search-result-hglt')) {\n                            list.classList.remove('e-de-search-result-hglt');\n                            list.children[0].classList.remove('e-de-op-search-word-text');\n                            list.classList.add('e-de-search-result-item');\n                        }\n                    }\n                    var listElements = _this.resultsListBlock.children[_this.results.currentIndex];\n                    if (listElements.classList.contains('e-de-search-result-item')) {\n                        listElements.classList.remove('e-de-search-result-item');\n                        listElements.classList.add('e-de-search-result-hglt');\n                        listElements.children[0].classList.add('e-de-op-search-word-text');\n                        _this.scrollToPosition(listElements);\n                    }\n                    var currentelement = _this.results.innerList[_this.results.currentIndex];\n                    _this.viewer.owner.searchModule.navigate(currentelement);\n                    _this.viewer.owner.searchModule.highlight(_this.results);\n                }\n                _this.focusedIndex = _this.focusedElement.indexOf(_this.navigateToPreviousResult);\n            }\n        };\n        /**\n         * Fires on key down\n         * @param {KeyboardEvent} event - Speficies key down actions.\n         * @private\n         */\n        this.onKeyDown = function (event) {\n            var code = event.which || event.keyCode;\n            if (code === 13 && event.keyCode !== 9 && event.keyCode !== 40) {\n                event.preventDefault();\n                _this.findDiv.style.height = '';\n                _this.onKeyDownInternal();\n            }\n            else if (code === 8 && (_this.searchInput.value.length === 0)) {\n                _this.resultContainer.style.display = 'block';\n            }\n            else if (event.keyCode !== 9 && event.keyCode !== 40 && event.keyCode !== 27) {\n                _this.viewer.owner.searchModule.clearSearchHighlight();\n                _this.clearSearchResultItems();\n                _this.viewer.renderVisiblePages();\n                _this.resultsListBlock.style.display = 'none';\n                _this.messageDiv.innerHTML = _this.localeValue.getConstant('No matches');\n                _this.resultContainer.style.display = 'none';\n                _this.clearFocusElement();\n                _this.resultsListBlock.innerHTML = '';\n                if (_this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    _this.searchIcon.classList.add('e-de-op-search-icon');\n                    _this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n            }\n            else if (code === 27 && event.keyCode === 27) {\n                _this.showHideOptionsPane(false);\n            }\n        };\n        /**\n         * Close the optios pane.\n         * @private\n         */\n        this.close = function () {\n            _this.clearFocusElement();\n            _this.showHideOptionsPane(false);\n            _this.resultsListBlock.innerHTML = '';\n            _this.focusedIndex = 1;\n            _this.isOptionsPane = true;\n        };\n        /**\n         * Fires on results list block.\n         * @param {MouseEvent} args - Specifies which list was clicked.\n         * @private\n         */\n        this.resultListBlockClick = function (args) {\n            var currentlist = args.target;\n            var element = _this.resultsListBlock.children;\n            var index = 0;\n            for (var i = 0; i < element.length; i++) {\n                var list_1 = element[i];\n                if (list_1.classList.contains('e-de-search-result-hglt')) {\n                    list_1.classList.remove('e-de-search-result-hglt');\n                    list_1.children[0].classList.remove('e-de-op-search-word-text');\n                    list_1.classList.add('e-de-search-result-item');\n                }\n            }\n            var list;\n            for (var i = 0; i < element.length; i++) {\n                if (currentlist === element[i]) {\n                    index = i;\n                    list = element[i];\n                    if (list.classList.contains('e-de-search-result-item')) {\n                        list.classList.remove('e-de-search-result-item');\n                        list.classList.add('e-de-search-result-hglt');\n                        list.children[0].classList.add('e-de-op-search-word-text');\n                        _this.focusedIndex = _this.focusedElement.indexOf(list);\n                    }\n                }\n            }\n            var currentelement = _this.results.innerList[index];\n            _this.results.currentIndex = index;\n            // tslint:disable-next-line:max-line-length\n            _this.messageDiv.innerHTML = _this.localeValue.getConstant('Result') + ' ' + (index + 1) + ' ' + _this.localeValue.getConstant('of') + ' ' + _this.resultsListBlock.children.length;\n            _this.viewer.owner.searchModule.navigate(currentelement);\n            _this.viewer.owner.searchModule.highlight(_this.results);\n            list.focus();\n        };\n        this.viewer = layoutViewer;\n    }\n    /**\n     * Get the module name.\n     */\n    OptionsPane.prototype.getModuleName = function () {\n        return 'OptionsPane';\n    };\n    /**\n     * Initialize the options pane.\n     * @param {L10n} localeValue - Specifies the localization based on culture.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    OptionsPane.prototype.initOptionsPane = function (localeValue) {\n        var viewer = this.viewer;\n        this.localeValue = localeValue;\n        this.optionsPane = createElement('div', { className: 'e-de-op', styles: 'display:none;' });\n        this.optionsPane.addEventListener('keydown', this.onKeyDownOnOptionPane);\n        this.searchDiv = createElement('div', {\n            className: this.viewer.owner.containerId + '_searchDiv e-de-op-header',\n            innerHTML: localeValue.getConstant(this.searchText)\n        });\n        this.optionsPane.appendChild(this.searchDiv);\n        // tslint:disable-next-line:max-line-length\n        this.closeButton = createElement('button', { className: 'e-de-op-close-button e-de-op-icon-btn e-btn e-flat e-icon-btn', id: 'close' });\n        this.optionsPane.appendChild(this.closeButton);\n        var closeSpan = createElement('span', { className: 'e-de-op-close-icon e-btn-icon e-icons' });\n        this.closeButton.appendChild(closeSpan);\n        this.focusedElement.push(this.closeButton);\n        this.findTab = createElement('div', { id: this.viewer.owner.containerId + '_findTabDiv', className: 'e-de-op-tab' });\n        this.optionsPane.appendChild(this.findTab);\n        var tabHeader = createElement('div', { className: 'e-tab-header' });\n        this.findTab.appendChild(tabHeader);\n        this.findTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.findPaneText) });\n        this.focusedElement.push(this.findTabButtonHeader);\n        tabHeader.appendChild(this.findTabButton);\n        this.replaceTabButton = createElement('div', { innerHTML: localeValue.getConstant(this.replacePaneText) });\n        this.focusedElement.push(this.replaceTabButtonHeader);\n        tabHeader.appendChild(this.replaceTabButton);\n        var tabContent = createElement('div', { className: 'e-content' });\n        var findTabContent = createElement('div', { id: 'findTabContent' });\n        tabContent.appendChild(findTabContent);\n        this.findTabContentDiv = createElement('div', { className: 'e-de-search-tab-content' });\n        this.searchTextBoxContainer = createElement('div', { className: 'e-input-group e-de-op-input-group' });\n        this.findTabContentDiv.appendChild(this.searchTextBoxContainer);\n        // tslint:disable-next-line:max-line-length\n        this.searchInput = createElement('input', { className: 'e-input e-de-search-input', id: this.viewer.owner.containerId + '_option_search_text_box', attrs: { placeholder: 'Search for' }, styles: 'font-size:14px;' });\n        this.searchTextBoxContainer.appendChild(this.searchInput);\n        this.searchIcon = createElement('span', {\n            className: 'e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon',\n            id: this.viewer.owner.containerId + '_search-icon'\n        });\n        this.searchIcon.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.searchIcon);\n        this.focusedElement.push(this.searchIcon);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToPreviousResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToPreviousResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult);\n        this.focusedElement.push(this.navigateToPreviousResult);\n        // tslint:disable-next-line:max-line-length\n        this.navigateToNextResult = createElement('span', { className: 'e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon' });\n        this.navigateToNextResult.tabIndex = 0;\n        this.searchTextBoxContainer.appendChild(this.navigateToNextResult);\n        this.focusedElement.push(this.navigateToNextResult);\n        var div = createElement('div', { className: 'e-de-op-more-less' });\n        this.matchInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_matchCase'\n        });\n        div.appendChild(this.matchInput);\n        this.matchCase = new CheckBox({ label: 'Match case', checked: false, change: this.matchChange });\n        this.matchCase.appendTo(this.matchInput);\n        this.focusedElement.push(this.matchInput);\n        this.matchInput.tabIndex = 0;\n        this.wholeInput = createElement('input', {\n            attrs: { type: 'checkbox' },\n            id: this.viewer.owner.containerId + '_wholeWord',\n        });\n        div.appendChild(this.wholeInput);\n        this.wholeWord = new CheckBox({ label: 'Whole words', checked: false, change: this.wholeWordsChange });\n        this.wholeWord.appendTo(this.wholeInput);\n        this.focusedElement.push(this.wholeInput);\n        this.wholeInput.tabIndex = 0;\n        this.findTabContentDiv.appendChild(div);\n        var replaceTabContent = createElement('div');\n        tabContent.appendChild(replaceTabContent);\n        this.replaceTabContentDiv = createElement('div', { className: 'e-de-op-replacetabcontentdiv', styles: 'display:none;' });\n        tabContent.appendChild(this.replaceTabContentDiv);\n        this.findTabContentDiv.appendChild(this.replaceTabContentDiv);\n        this.createReplacePane();\n        this.findDiv = createElement('div', { className: 'findDiv', styles: 'height:250px;display:block;' });\n        findTabContent.appendChild(this.findTabContentDiv);\n        this.resultContainer = createElement('div', { styles: 'width:85%;display:block;', className: 'e-de-op-result-container' });\n        this.findDiv.appendChild(this.resultContainer);\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv = createElement('div', { className: this.viewer.owner.containerId + '_messageDiv e-de-op-msg', innerHTML: this.localeValue.getConstant(this.messageDivText), id: this.viewer.owner.containerId + '_search_status' });\n        this.resultContainer.appendChild(this.messageDiv);\n        // tslint:disable-next-line:max-line-length\n        this.resultsListBlock = createElement('div', { id: this.viewer.owner.containerId + '_list_box_container', styles: 'display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;', className: 'e-de-result-list-block' });\n        this.findDiv.appendChild(this.resultsListBlock);\n        this.findTabContentDiv.appendChild(this.findDiv);\n        this.findTab.appendChild(tabContent);\n        this.tabInstance = new Tab({ selected: this.selectedTabItem });\n        this.tabInstance.appendTo(this.findTab);\n        var findHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        this.findTabButtonHeader = findHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.findTabButtonHeader.classList.add('e-de-op-find-tab-header');\n        this.findTabButtonHeader.tabIndex = 0;\n        var replaceHeader = this.tabInstance.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        this.replaceTabButtonHeader = replaceHeader.getElementsByClassName('e-tab-wrap')[0];\n        this.replaceTabButtonHeader.classList.add('e-de-op-replace-tab-header');\n        this.replaceTabButtonHeader.tabIndex = 0;\n        this.onWireEvents();\n    };\n    /**\n     * Create replace pane instances.\n     */\n    OptionsPane.prototype.createReplacePane = function () {\n        this.replaceDiv = createElement('div');\n        this.replaceTabContentDiv.appendChild(this.replaceDiv);\n        this.replaceWith = createElement('input', {\n            className: 'e-de-op-replacewith e-input', styles: 'font-size:14px;',\n            attrs: { placeholder: 'Replace with' }\n        });\n        this.replaceDiv.appendChild(this.replaceWith);\n        var replaceButtonDiv = createElement('div', { styles: 'text-align:right;', className: 'e-de-op-dlg-footer' });\n        this.replaceDiv.appendChild(replaceButtonDiv);\n        this.replaceButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replace',\n            styles: 'font-size:12px;margin-right:10px;',\n            innerHTML: this.localeValue.getConstant(this.replaceButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceButton);\n        this.replaceAllButton = createElement('button', {\n            className: 'e-control e-btn e-flat e-replaceall',\n            styles: 'font-size:12px;',\n            innerHTML: this.localeValue.getConstant(this.replaceAllButtonText)\n        });\n        replaceButtonDiv.appendChild(this.replaceAllButton);\n        this.matchDiv = createElement('div', { styles: 'display:none;padding-top:10px;' });\n        this.replaceDiv.appendChild(this.matchDiv);\n        var emptyDiv6 = createElement('div', { className: 'e-de-op-search-replacediv' });\n        this.replaceDiv.appendChild(emptyDiv6);\n        this.occurrenceDiv = createElement('div', { styles: 'display:none;' });\n        this.replaceDiv.appendChild(this.occurrenceDiv);\n    };\n    OptionsPane.prototype.navigateSearchResult = function () {\n        this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n        this.viewer.owner.searchModule.highlight(this.results);\n        this.viewer.owner.searchModule.addFindResultView(this.results);\n        this.resultsListBlock.style.display = 'block';\n        this.resultContainer.style.display = 'block';\n        var lists = this.viewer.owner.findResultsList;\n        var text = '';\n        for (var i = 0; i < lists.length; i++) {\n            text += lists[i];\n        }\n        this.clearFocusElement();\n        this.resultsListBlock.innerHTML = text;\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            this.focusedElement.push(this.resultsListBlock.children[i]);\n        }\n        var currentIndexValue = this.results.currentIndex;\n        // tslint:disable-next-line:max-line-length\n        this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndexValue + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n        var listElement = this.resultsListBlock.children[currentIndexValue];\n        if (listElement.classList.contains('e-de-search-result-item')) {\n            listElement.classList.remove('e-de-search-result-item');\n            listElement.classList.add('e-de-search-result-hglt');\n            listElement.children[0].classList.add('e-de-op-search-word-text');\n            this.scrollToPosition(listElement);\n        }\n    };\n    /**\n     * Fires on key down actions done.\n     * @private\n     */\n    OptionsPane.prototype.onKeyDownInternal = function () {\n        // tslint:disable-next-line:max-line-length\n        var inputElement = document.getElementById(this.viewer.owner.containerId + '_option_search_text_box');\n        inputElement.blur();\n        var text = inputElement.value;\n        if (text === '') {\n            return;\n        }\n        if (text.length >= 1 && this.searchIcon.classList.contains('e-de-op-search-icon')) {\n            this.searchIcon.classList.add('e-de-op-search-close-icon');\n            this.searchIcon.classList.remove('e-de-op-search-icon');\n        }\n        var resultsContainerHeight = this.viewer.owner.getDocumentEditorElement().offsetHeight - 215;\n        this.clearSearchResultItems();\n        this.viewer.owner.searchModule.clearSearchHighlight();\n        var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(text, this.findOption);\n        var endSelection = this.viewer.selection.end;\n        var index = endSelection.getHierarchicalIndexInternal();\n        this.results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n        var results = this.results;\n        if (isNullOrUndefined(results)) {\n            this.viewer.renderVisiblePages();\n        }\n        if (results != null && results.length > 0) {\n            if ((this.focusedElement.indexOf(this.navigateToPreviousResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToPreviousResult);\n            }\n            if ((this.focusedElement.indexOf(this.navigateToNextResult) === -1) && this.isOptionsPane) {\n                this.focusedElement.push(this.navigateToNextResult);\n            }\n            this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]);\n            this.viewer.owner.searchModule.highlight(results);\n            this.viewer.owner.searchModule.addFindResultView(results);\n            // if (this.isOptionsPane) {\n            this.resultsListBlock.style.display = 'block';\n            this.resultsListBlock.style.height = resultsContainerHeight + 'px';\n            this.resultContainer.style.display = 'block';\n            var list = this.viewer.owner.findResultsList;\n            var text_1 = '';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n            for (var i = 0; i < list.length; i++) {\n                text_1 += list[i];\n            }\n            this.resultsListBlock.innerHTML = text_1;\n            for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n                this.focusedElement.push(this.resultsListBlock.children[i]);\n            }\n            var lists = this.resultsListBlock.children;\n            var currentIndex = this.results.currentIndex;\n            // tslint:disable-next-line:max-line-length\n            this.messageDiv.innerHTML = this.localeValue.getConstant('Result') + ' ' + (currentIndex + 1) + ' ' + this.localeValue.getConstant('of') + ' ' + this.resultsListBlock.children.length;\n            var listElement = this.resultsListBlock.children[currentIndex];\n            if (listElement.classList.contains('e-de-search-result-item')) {\n                listElement.classList.remove('e-de-search-result-item');\n                listElement.classList.add('e-de-search-result-hglt');\n                listElement.children[0].classList.add('e-de-op-search-word-text');\n            }\n            this.navigateToNextResult.focus();\n            this.focusedIndex = 6;\n            this.getMessageDivHeight();\n            // } else {\n            //this.focusedIndex = 4;\n            // }\n        }\n        else {\n            this.messageDiv.innerHTML = this.localeValue.getConstant('No matches');\n            this.resultContainer.style.display = 'block';\n            this.resultsListBlock.style.display = 'none';\n            this.clearFocusElement();\n            this.resultsListBlock.innerHTML = '';\n        }\n    };\n    OptionsPane.prototype.getMessageDivHeight = function () {\n        if (!this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-msg')) {\n            this.messageDiv.classList.add('e-de-op-replace-messagediv');\n            this.messageDiv.classList.remove('e-de-op-msg');\n        }\n        else if (this.isOptionsPane && this.messageDiv.classList.contains('e-de-op-replace-messagediv')) {\n            this.messageDiv.classList.add('e-de-op-msg');\n            this.messageDiv.classList.remove('e-de-op-replace-messagediv');\n        }\n    };\n    /**\n     * Replace all.\n     * @private\n     */\n    OptionsPane.prototype.replaceAll = function () {\n        var optionsPane = this.optionsPane;\n        var findText = this.searchInput.value;\n        var replaceText = this.replaceWith.value;\n        if (findText !== '' && !isNullOrUndefined(findText)) {\n            var pattern = this.viewer.owner.searchModule.textSearch.stringToRegex(findText, this.findOption);\n            var endSelection = this.viewer.selection.end;\n            var index = endSelection.getHierarchicalIndexInternal();\n            var results = this.viewer.owner.searchModule.textSearch.findAll(pattern, this.findOption, index);\n            var replace = isNullOrUndefined(replaceText) ? '' : replaceText;\n            var count = isNullOrUndefined(results) ? 0 : results.length;\n            this.viewer.owner.searchModule.replaceAll(replace, results);\n            this.matchDiv.style.display = 'block';\n            this.matchDiv.innerHTML = this.localeValue.getConstant('All Done') + '!';\n            this.occurrenceDiv.style.display = 'block';\n            // tslint:disable-next-line:max-line-length\n            this.occurrenceDiv.innerHTML = this.localeValue.getConstant('We replaced all') + ' ' + count + ' ' + this.localeValue.getConstant('instances') + ' ' + this.localeValue.getConstant('of') + ' \"' + findText + '\" ' + this.localeValue.getConstant('with') + ' \"' + replaceText + '\" ';\n        }\n    };\n    /**\n     * Scrolls to position.\n     * @param {HTMLElement} list - Specifies the list element.\n     * @private\n     */\n    OptionsPane.prototype.scrollToPosition = function (list) {\n        var rect = list.getBoundingClientRect();\n        var top;\n        if (rect.top > 0) {\n            top = rect.top - list.parentElement.getBoundingClientRect().top;\n            if ((list.parentElement.offsetHeight - top) <= list.offsetHeight) {\n                if (Math.ceil(top + list.offsetHeight) === list.parentElement.scrollHeight) {\n                    list.parentElement.scrollTop = top;\n                }\n                list.parentElement.scrollTop = list.parentElement.scrollTop + (list.parentElement.offsetHeight / 100) * 30;\n            }\n            else if (top < 0) {\n                list.parentElement.scrollTop = list.parentElement.scrollTop - (list.parentElement.offsetHeight / 100) * 30;\n            }\n        }\n        else {\n            list.parentElement.scrollTop = 0;\n        }\n    };\n    /**\n     * Clear the focus elements.\n     * @private\n     */\n    OptionsPane.prototype.clearFocusElement = function () {\n        for (var i = 0; i < this.resultsListBlock.children.length; i++) {\n            var index = this.focusedElement.indexOf(this.resultsListBlock.children[i]);\n            if (index !== -1) {\n                this.focusedElement.splice(index, 1);\n            }\n        }\n        this.focusedIndex = 0;\n    };\n    /**\n     * Show or hide option pane based on boolean value.\n     * @param {boolean} show - Specifies showing or hiding the options pane.\n     * @private\n     */\n    OptionsPane.prototype.showHideOptionsPane = function (show) {\n        if (!isNullOrUndefined(this.viewer.owner.selectionModule)) {\n            if (show) {\n                this.localeValue = new L10n('documenteditor', this.viewer.owner.defaultLocale);\n                this.localeValue.setLocale(this.viewer.owner.locale);\n                setCulture(this.viewer.owner.locale);\n                if (isNullOrUndefined(this.optionsPane)) {\n                    this.initOptionsPane(this.localeValue);\n                    //Add Option Pane\n                    this.viewer.optionsPaneContainer.setAttribute('style', 'display:inline-flex');\n                    // tslint:disable-next-line:max-line-length\n                    this.viewer.optionsPaneContainer.insertBefore(this.viewer.owner.optionsPaneModule.optionsPane, this.viewer.viewerContainer);\n                }\n                this.optionsPane.style.display = 'block';\n                if (this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.hideTab(1);\n                }\n                else {\n                    this.tabInstance.hideTab(1, false);\n                }\n                if (this.isReplace && !this.viewer.owner.isReadOnlyMode) {\n                    this.tabInstance.select(1);\n                    this.isReplace = false;\n                    this.isOptionsPane = false;\n                }\n                else {\n                    this.tabInstance.select(0);\n                }\n                this.searchDiv.innerHTML = this.localeValue.getConstant(this.searchText);\n                this.isOptionsPaneShow = true;\n                // tslint:disable-next-line:max-line-length\n                var textBox = document.getElementById(this.viewer.owner.getDocumentEditorElement().id + '_option_search_text_box');\n                var selectedText = this.viewer.owner.selection.text;\n                if (!isNullOrUndefined(selectedText)) {\n                    var char = ['\\v', '\\r'];\n                    var index = HelperMethods.indexOfAny(selectedText, char);\n                    selectedText = index < 0 ? selectedText : selectedText.substring(0, index);\n                }\n                textBox.value = selectedText;\n                textBox.select();\n                this.messageDiv.innerHTML = '';\n                if (this.searchIcon.classList.contains('e-de-op-search-close-icon')) {\n                    this.searchIcon.classList.add('e-de-op-search-icon');\n                    this.searchIcon.classList.remove('e-de-op-search-close-icon');\n                }\n                this.viewer.selection.caret.style.display = 'none';\n                this.focusedIndex = 3;\n                this.focusedElement = [];\n                if (this.isOptionsPane) {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput);\n                }\n                else {\n                    // tslint:disable-next-line:max-line-length\n                    this.focusedElement.push(this.closeButton, this.findTabButtonHeader, this.replaceTabButtonHeader, this.searchInput, this.searchIcon, this.navigateToPreviousResult, this.navigateToNextResult, this.matchInput, this.wholeInput, this.replaceWith, this.replaceButton, this.replaceAllButton);\n                }\n                this.viewer.updateViewerSize();\n            }\n            else {\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    this.clearSearchResultItems();\n                    this.viewer.owner.searchModule.clearSearchHighlight();\n                    this.isOptionsPaneShow = false;\n                    var resultListBox = document.getElementById(this.viewer.owner.containerId + '_list_box_container');\n                    var message = document.getElementById(this.viewer.owner.containerId + '_search_status');\n                    if (!isNullOrUndefined(resultListBox) && !isNullOrUndefined(message)) {\n                        resultListBox.style.display = 'none';\n                        this.clearFocusElement();\n                        resultListBox.innerHTML = '';\n                        message.innerHTML = this.localeValue.getConstant('No matches');\n                    }\n                }\n                this.viewer.updateViewerSize();\n                if (!isNullOrUndefined(this.optionsPane)) {\n                    if (this.optionsPane.style.display !== 'none') {\n                        this.viewer.selection.updateCaretPosition();\n                        this.optionsPane.style.display = 'none';\n                    }\n                }\n                this.viewer.updateFocus();\n                this.viewer.selection.caret.style.display = 'block';\n            }\n        }\n    };\n    /**\n     * Clears search results.\n     * @private\n     */\n    OptionsPane.prototype.clearSearchResultItems = function () {\n        if (!isNullOrUndefined(this.viewer.owner.findResultsList)) {\n            this.viewer.owner.findResultsList = [];\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    OptionsPane.prototype.destroy = function () {\n        if (this.optionsPane) {\n            this.optionsPane.innerHTML = '';\n            this.optionsPane = undefined;\n        }\n        if (this.resultsListBlock) {\n            this.resultsListBlock.innerHTML = '';\n            this.resultsListBlock = undefined;\n        }\n        if (this.messageDiv) {\n            this.messageDiv.innerHTML = '';\n            this.messageDiv = undefined;\n        }\n        if (this.resultContainer) {\n            this.resultContainer.innerHTML = '';\n        }\n        this.resultContainer = undefined;\n        if (this.searchInput) {\n            this.searchInput.value = '';\n            this.searchInput = undefined;\n        }\n        if (this.searchDiv) {\n            this.searchDiv.innerHTML = '';\n            this.searchDiv = undefined;\n        }\n        if (this.searchTextBoxContainer) {\n            this.searchTextBoxContainer.innerHTML = '';\n            this.searchTextBoxContainer = undefined;\n        }\n        if (this.replaceWith) {\n            this.replaceWith.innerHTML = '';\n            this.replaceWith = undefined;\n        }\n        if (this.findDiv) {\n            this.findDiv.innerHTML = '';\n            this.findDiv = undefined;\n        }\n        if (this.replaceButton) {\n            this.replaceButton.innerHTML = '';\n            this.replaceButton = undefined;\n        }\n        if (this.replaceAllButton) {\n            this.replaceAllButton.innerHTML = '';\n            this.replaceAllButton = undefined;\n        }\n        if (this.matchInput) {\n            this.matchInput.innerHTML = '';\n            this.matchCase = undefined;\n        }\n        if (this.wholeInput) {\n            this.wholeInput.innerHTML = '';\n            this.wholeWord = undefined;\n        }\n        // if (this.regularInput) {\n        //     this.regularInput.innerHTML = '';\n        //     this.regular = undefined;\n        // }\n        if (!isNullOrUndefined(this.results)) {\n            this.results.destroy();\n        }\n        if (this.focusedElement) {\n            this.focusedElement = [];\n        }\n        this.focusedElement = undefined;\n        this.destroyInternal();\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     */\n    OptionsPane.prototype.destroyInternal = function () {\n        if (this.searchText) {\n            this.searchText = undefined;\n        }\n        if (this.resultsText) {\n            this.resultsText = undefined;\n        }\n        if (this.messageDivText) {\n            this.messageDivText = undefined;\n        }\n        if (this.replaceButtonText) {\n            this.replaceButtonText = undefined;\n        }\n        if (this.replaceAllButtonText) {\n            this.replaceAllButtonText = undefined;\n        }\n    };\n    return OptionsPane;\n}());\nexport { OptionsPane };\n","import { TableWidget } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Point, HelperMethods } from './editor-helper';\n/**\n * @private\n */\nvar TableResizer = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableResizer(node) {\n        this.resizeNode = 0;\n        this.resizerPosition = 0;\n        this.currentResizingTable = undefined;\n        this.owner = node;\n        this.startingPoint = new Point(0, 0);\n    }\n    Object.defineProperty(TableResizer.prototype, \"viewer\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.owner.viewer;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    TableResizer.prototype.getModuleName = function () {\n        return 'TableResizer';\n    };\n    /**\n     * @private\n     */\n    TableResizer.prototype.updateResizingHistory = function (touchPoint) {\n        if (this.owner.editorHistory) {\n            this.owner.editorHistory.updateResizingHistory(touchPoint, this);\n        }\n        this.viewer.isRowOrCellResizing = false;\n        this.resizerPosition = -1;\n    };\n    TableResizer.prototype.handleResize = function (point) {\n        this.owner.viewer.isRowOrCellResizing = true;\n        this.startingPoint.x = point.x;\n        this.startingPoint.y = point.y;\n        //Initialize resizing history.\n        this.owner.editorHistory.initResizingHistory(point, this);\n    };\n    //Table Resizing implementation starts\n    /**\n     * @private\n     */\n    TableResizer.prototype.isInRowResizerArea = function (touchPoint) {\n        var position = this.getRowReSizerPosition(undefined, touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 1;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    TableResizer.prototype.isInCellResizerArea = function (touchPoint) {\n        var position = this.getCellReSizerPosition(touchPoint);\n        if (position === -1) {\n            return false;\n        }\n        else {\n            this.resizeNode = 0;\n            this.resizerPosition = position;\n            return true;\n        }\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {Point} point\n     * @private\n     */\n    TableResizer.prototype.getCellReSizerPosition = function (touchPoint) {\n        var position = -1;\n        var resizerBoundaryWidth = 2;\n        var tableWidget = this.getTableWidget(touchPoint);\n        var cellWidget = this.getTableCellWidget(touchPoint);\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(tableWidget.x - HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) - 0.25, tableWidget.y, HelperMethods.convertPointToPixel(tableWidget.leftBorderWidth) + 0.5, tableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = tableWidget.x;\n            for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n                var preferredWidth = HelperMethods.convertPointToPixel(tableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, tableWidget.y, tableWidget.leftBorderWidth + resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - resizerBoundaryWidth / 2, tableWidget.y, resizerBoundaryWidth, tableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(cellWidget)) {\n                this.currentResizingTable = cellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(cellWidget.x - cellWidget.margin.left - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = cellWidget.columnIndex;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (isNullOrUndefined(cellWidget.nextRenderedWidget)\n                    && this.viewer.isInsideRect(cellWidget.x + cellWidget.margin.right + cellWidget.width - resizerBoundaryWidth / 2, cellWidget.y - cellWidget.margin.top, resizerBoundaryWidth, cellWidget.height, touchPoint)) {\n                    return position = (cellWidget.columnIndex + cellWidget.cellFormat.columnSpan);\n                }\n                else if (cellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(cellWidget, touchPoint); // Gets the nested table resizer position.\n                }\n            }\n        }\n        return position;\n    };\n    /**\n     * Gets cell resizer position.\n     * @param {TableCellWidget} cellWidget\n     * @param {Point} touchPoint\n     */\n    TableResizer.prototype.getCellReSizerPositionInternal = function (cellWidget, touchPoint) {\n        var position = -1;\n        var childTableWidget = this.getTableWidgetFromWidget(touchPoint, cellWidget);\n        var childCellWidget = undefined;\n        if (!isNullOrUndefined(childTableWidget) && childTableWidget.tableFormat.cellSpacing > 0) {\n            this.currentResizingTable = childTableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.isInsideRect(childTableWidget.x - childTableWidget.leftBorderWidth - 0.25, childTableWidget.y, childTableWidget.leftBorderWidth + 0.5, childTableWidget.height, touchPoint)) {\n                return position = 0;\n            }\n            var startingPointX = childTableWidget.x;\n            for (var i = 0; i < childTableWidget.tableHolder.columns.length; i++) {\n                // tslint:disable-next-line:max-line-length\n                var preferredWidth = HelperMethods.convertPointToPixel(childTableWidget.tableHolder.columns[i].preferredWidth);\n                // tslint:disable-next-line:max-line-length\n                if ((this.viewer.isInsideRect(startingPointX - 1, childTableWidget.y, childTableWidget.leftBorderWidth + 2, childTableWidget.height, touchPoint))) {\n                    return position = i > 0 ? i : 0;\n                    // tslint:disable-next-line:max-line-length\n                }\n                else if (i > 0 && (this.viewer.isInsideRect(startingPointX + preferredWidth - 1, childTableWidget.y, 2, childTableWidget.height, touchPoint))) {\n                    return position = (i + 1);\n                }\n                startingPointX = startingPointX + preferredWidth;\n            }\n        }\n        else {\n            if (!isNullOrUndefined(childTableWidget)) {\n                childCellWidget = childTableWidget.getTableCellWidget(touchPoint);\n            }\n            if (!isNullOrUndefined(childCellWidget)) {\n                this.currentResizingTable = childCellWidget.ownerTable;\n                // tslint:disable-next-line:max-line-length\n                if (this.viewer.isInsideRect(childCellWidget.x - childCellWidget.margin.left - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = childCellWidget.columnIndex;\n                }\n                else if (isNullOrUndefined(childCellWidget.nextRenderedWidget)\n                    // tslint:disable-next-line:max-line-length\n                    && this.viewer.isInsideRect(childCellWidget.x + childCellWidget.margin.right + childCellWidget.width - 1, childCellWidget.y - childCellWidget.margin.top, 2, childCellWidget.height, touchPoint)) {\n                    return position = (childCellWidget.columnIndex + childCellWidget.cellFormat.columnSpan);\n                }\n                else if (childCellWidget.childWidgets.length > 0) {\n                    return this.getCellReSizerPositionInternal(childCellWidget, touchPoint);\n                }\n            }\n        }\n        return position;\n    };\n    TableResizer.prototype.getRowReSizerPosition = function (widget, touchPoint) {\n        var tableWidget = undefined;\n        var cellWidget = undefined;\n        if (isNullOrUndefined(widget)) {\n            tableWidget = this.getTableWidget(touchPoint);\n            cellWidget = this.getTableCellWidget(touchPoint);\n        }\n        else {\n            tableWidget = this.getTableWidgetFromWidget(touchPoint, widget);\n        }\n        var cellSpacing = isNullOrUndefined(tableWidget) ? 0 : tableWidget.tableFormat.cellSpacing;\n        if (tableWidget && cellSpacing > 0) {\n            this.currentResizingTable = tableWidget;\n            // tslint:disable-next-line:max-line-length\n            if (this.owner.viewer.isInsideRect(tableWidget.x, tableWidget.y + tableWidget.height - cellSpacing, this.getActualWidth(tableWidget.lastChild), (isNullOrUndefined(tableWidget.nextSplitWidget) ? tableWidget.bottomBorderWidth + cellSpacing : 0), touchPoint)) {\n                return tableWidget.lastChild.rowIndex;\n            }\n            for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n                //Need to consider for splitted widgets\n                var rowWidget = tableWidget.childWidgets[i];\n                if (tableWidget.childWidgets.indexOf(rowWidget) > -1\n                    // tslint:disable-next-line:max-line-length\n                    && (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height + cellSpacing / 2, this.getActualWidth(rowWidget), cellSpacing / 2, touchPoint))) {\n                    return rowWidget.rowIndex;\n                }\n            }\n        }\n        else {\n            if (tableWidget && cellWidget) {\n                cellWidget = this.getTableCellWidget(touchPoint);\n            }\n            if (cellWidget) {\n                var rowWidget = cellWidget.containerWidget;\n                var height = 0;\n                if (rowWidget.rowIndex === rowWidget.ownerTable.childWidgets.length - 1) {\n                    height = rowWidget.bottomBorderWidth + 2;\n                }\n                else {\n                    height = rowWidget.nextRenderedWidget.topBorderWidth + 2;\n                }\n                // tslint:disable-next-line:max-line-length\n                if (this.owner.viewer.isInsideRect(rowWidget.x, rowWidget.y + rowWidget.height - height, rowWidget.width, height * 2, touchPoint)) {\n                    this.currentResizingTable = rowWidget.ownerTable;\n                    return rowWidget.rowIndex;\n                }\n                else {\n                    if (cellWidget.childWidgets.length > 0) {\n                        return this.getRowReSizerPosition(cellWidget, touchPoint);\n                    }\n                }\n            }\n        }\n        return -1;\n    };\n    /**\n     * To handle Table Row and cell resize\n     * @param touchPoint\n     * @private\n     */\n    TableResizer.prototype.handleResizing = function (touchPoint) {\n        var dragValue = 0;\n        if (this.resizeNode === 0) {\n            dragValue = touchPoint.x - this.startingPoint.x;\n            this.resizeTableCellColumn(dragValue);\n        }\n        else {\n            dragValue = touchPoint.y - this.startingPoint.y;\n            this.resizeTableRow(dragValue);\n        }\n    };\n    TableResizer.prototype.resizeTableRow = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0) {\n            return;\n        }\n        var selection = this.owner.selection;\n        if (table.isInsideTable) {\n            this.owner.isLayoutEnabled = false; //Layouting is disabled to skip the child table layouting. \n        }\n        if (this.resizerPosition > -1) {\n            var row = table.childWidgets[this.resizerPosition];\n            this.updateRowHeight(row, dragValue);\n            selection.selectPosition(selection.start, selection.end);\n        }\n        if (table.isInsideTable) {\n            var parentTable = this.owner.viewer.layout.getParentTable(table);\n            this.owner.isLayoutEnabled = true; //layouting is enabled to layout the parent table of the nested table.\n            table = parentTable;\n        }\n        this.startingPoint.y += HelperMethods.convertPointToPixel(dragValue);\n        this.owner.viewer.layout.reLayoutTable(table);\n        this.owner.editorModule.reLayout(this.owner.selection);\n    };\n    /**\n     * Gets the table widget from given cursor point\n     * @param cursorPoint\n     */\n    TableResizer.prototype.getTableWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = this.getTableWidgetFromWidget(cursorPoint, bodyWidget);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.getTableWidgetFromWidget = function (point, widget) {\n        for (var j = 0; j < widget.childWidgets.length; j++) {\n            if (widget.childWidgets[j] instanceof TableWidget) {\n                var childWidget = widget.childWidgets[j];\n                if (childWidget.y <= point.y && (childWidget.y + childWidget.height) >= point.y) {\n                    return childWidget;\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * Return the table cell widget from the given cursor point\n     * @param cursorPoint\n     * @private\n     */\n    TableResizer.prototype.getTableCellWidget = function (cursorPoint) {\n        var widget = undefined;\n        var currentPage = this.owner.viewer.currentPage;\n        if (!isNullOrUndefined(currentPage)) {\n            for (var i = 0; i < currentPage.bodyWidgets.length; i++) {\n                var bodyWidget = currentPage.bodyWidgets[i];\n                widget = bodyWidget.getTableCellWidget(cursorPoint);\n                if (!isNullOrUndefined(widget)) {\n                    break;\n                }\n            }\n        }\n        return widget;\n    };\n    TableResizer.prototype.updateRowHeight = function (row, dragValue) {\n        var rowFormat = row.rowFormat;\n        if (rowFormat.heightType === 'Auto') {\n            rowFormat.heightType = 'AtLeast';\n            var row_1 = rowFormat.ownerBase;\n            var currentHeight = this.owner.viewer.layout.getRowHeight(row_1, [row_1]);\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (currentHeight + dragValue >= 2.7 && rowFormat.height !== currentHeight + dragValue) {\n                rowFormat.height = currentHeight + dragValue;\n            }\n        }\n        else {\n            //the minimum height of the Row in MS word is 2.7 points which is equal to 3.6 pixel.\n            if (rowFormat.height + dragValue >= 2.7 && rowFormat.height !== rowFormat.height + dragValue) {\n                rowFormat.height = rowFormat.height + dragValue;\n            }\n        }\n    };\n    //Resize Table cell\n    TableResizer.prototype.resizeTableCellColumn = function (dragValue) {\n        var table = this.currentResizingTable;\n        if (isNullOrUndefined(table) || dragValue === 0 || isNullOrUndefined(table.childWidgets)) {\n            return;\n        }\n        var selectionFlag = true;\n        var selection = this.owner.selection;\n        this.owner.editor.setOffsetValue(selection);\n        table = table.combineWidget(this.viewer);\n        this.owner.isLayoutEnabled = false;\n        // table.PreserveGrid = true;\n        this.setPreferredWidth(table);\n        var containerWidth = table.getOwnerWidth(true);\n        var newIndent = table.leftIndent;\n        var tableAlignment = table.tableFormat.tableAlignment;\n        if (!selection.isEmpty) {\n            selectionFlag = this.resizeColumnWithSelection(selection, table, dragValue);\n        }\n        if (!selectionFlag) {\n            this.owner.isLayoutEnabled = true;\n            return;\n        }\n        if (this.resizerPosition === 0) {\n            // Todo: need to handle the resizing of first column and table indent.\n            var columnIndex = this.resizerPosition;\n            var rightColumn = table.tableHolder.columns[columnIndex];\n            var width = rightColumn.preferredWidth;\n            if (dragValue > 0) {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth >= rightColumn.minWidth) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue += newWidth - rightColumn.minWidth;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            else {\n                var prevDragValue = dragValue;\n                do {\n                    var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                    if (newWidth <= 2112) {\n                        rightColumn.preferredWidth = newWidth;\n                        newIndent = table.leftIndent + dragValue;\n                        newIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        break;\n                    }\n                    else {\n                        prevDragValue = dragValue;\n                        dragValue -= newWidth - 2112;\n                    }\n                } while (dragValue !== prevDragValue);\n            }\n            var dragOffset = dragValue;\n            // tslint:disable-next-line:max-line-length\n            if (tableAlignment !== 'Left' && (table.tableHolder.getTotalWidth() > containerWidth) && table.tableFormat.preferredWidthType === 'Auto') {\n                if (table.tableHolder.isFitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto')) {\n                    // tslint:disable-next-line:max-line-length\n                    table.tableHolder.fitColumns(containerWidth, table.tableHolder.tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n                }\n                else {\n                    rightColumn.preferredWidth = width;\n                }\n                dragOffset = 0;\n            }\n            if (tableAlignment === 'Center'\n                && (table.tableHolder.getTotalWidth() < containerWidth || table.tableFormat.preferredWidthType !== 'Auto')) {\n                dragOffset = dragOffset / 2;\n            }\n            table.tableFormat.leftIndent = tableAlignment === 'Left' ? newIndent : 0;\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n            this.updateCellPreferredWidths(table);\n            this.updateGridValue(table, true, dragOffset);\n        }\n        else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n            // Todo: need to handle the resizing of last column and table width.\n            this.resizeColumnAtLastColumnIndex(table, dragValue, containerWidth);\n        }\n        else {\n            if (this.resizerPosition === -1) {\n                this.owner.isLayoutEnabled = true;\n                return;\n            }\n            this.resizeCellAtMiddle(table, dragValue);\n        }\n        // table.PreserveGrid = false;\n        this.owner.isLayoutEnabled = true;\n        selection.selectPosition(selection.start, selection.end);\n    };\n    /**\n     * Resize Selected Cells\n     */\n    TableResizer.prototype.resizeColumnWithSelection = function (selection, table, dragValue) {\n        var newIndent = table.leftIndent;\n        var cellwidget = this.getTableCellWidget(this.startingPoint);\n        if (cellwidget && (selection.selectedWidgets.containsKey(cellwidget) || (cellwidget.previousWidget\n            && selection.selectedWidgets.containsKey((cellwidget.previousWidget))))) {\n            var selectedCells = selection.getSelectedCells();\n            if (this.resizerPosition === 0) {\n                this.resizeColumnAtStart(table, dragValue, selectedCells);\n            }\n            else if (table !== null && this.resizerPosition === table.tableHolder.columns.length) {\n                var leftColumnCollection = this.getColumnCells(table, this.resizerPosition, true);\n                for (var i = 0; i < leftColumnCollection.length; i++) {\n                    var cell = leftColumnCollection[i];\n                    if (selectedCells.indexOf(cell) !== -1) {\n                        this.increaseOrDecreaseWidth(cell, dragValue, true);\n                    }\n                }\n                //Updates the grid after value for all the rows.\n                this.updateRowsGridAfterWidth(table);\n                table.updateWidth(dragValue);\n                this.updateGridValue(table, true, dragValue);\n            }\n            else {\n                if (this.resizerPosition === -1) {\n                    return false;\n                }\n                var columnIndex = this.resizerPosition;\n                var leftColumnCollection = this.getColumnCells(table, columnIndex, true);\n                var rightColumnCollection = this.getColumnCells(table, columnIndex, false);\n                var isColumnResizing = this.isColumnSelected(table, columnIndex);\n                if (leftColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(leftColumnCollection[i]) === -1) {\n                            leftColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                if (rightColumnCollection.length > 0 && !isColumnResizing) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        if (selectedCells.indexOf(rightColumnCollection[i]) === -1) {\n                            rightColumnCollection.splice(i, 1);\n                            i--;\n                        }\n                    }\n                }\n                //Getting the adjacent cell collections for left side selected cells in the right column collection.\n                if (leftColumnCollection.length === 0 && rightColumnCollection.length > 0) {\n                    for (var i = 0; i < rightColumnCollection.length; i++) {\n                        var cell = rightColumnCollection[i];\n                        if (cell.previousWidget) {\n                            leftColumnCollection.push(cell.previousWidget);\n                        }\n                    }\n                }\n                else if (rightColumnCollection.length === 0 && leftColumnCollection.length > 0) {\n                    for (var i = 0; i < leftColumnCollection.length; i++) {\n                        var cell = leftColumnCollection[i];\n                        if (cell.nextWidget) {\n                            rightColumnCollection.push(cell.nextWidget);\n                        }\n                    }\n                }\n                this.changeWidthOfCells(table, leftColumnCollection, rightColumnCollection, dragValue, true);\n                this.updateGridValue(table, true, dragValue);\n            }\n            selection.selectPosition(selection.start, selection.end);\n        }\n        return false;\n    };\n    /**\n     * Resize selected cells at resizer position 0\n     */\n    TableResizer.prototype.resizeColumnAtStart = function (table, dragValue, selectedCells) {\n        var newIndent = table.leftIndent;\n        var rightColumnCollection = this.getColumnCells(table, this.resizerPosition, false);\n        var offset = 0;\n        var selectedRow = selectedCells[0].ownerRow;\n        var rowFormat = selectedRow.rowFormat;\n        if (rowFormat.beforeWidth > 0) {\n            var newGridBefore = rowFormat.beforeWidth + dragValue;\n            if (newGridBefore > 0) {\n                this.updateGridBefore(selectedRow, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                if (newGridBefore < leastGridBefore && offset !== newGridBefore) {\n                    newIndent = table.leftIndent + newGridBefore;\n                    table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedRow !== tableRow) {\n                            this.updateGridBefore(tableRow, -newGridBefore);\n                        }\n                    }\n                }\n            }\n        }\n        else {\n            if (dragValue < 0) {\n                newIndent = table.leftIndent + dragValue;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                this.updateWidthForCells(table, selectedCells, dragValue);\n            }\n            else {\n                var leastGridBefore = this.getLeastGridBefore(table, selectedRow);\n                var currentTableIndent = table.tableFormat.leftIndent;\n                if (currentTableIndent === 0) {\n                    for (var i = 0; i < table.childWidgets.length; i++) {\n                        var tableRow = table.childWidgets[i];\n                        if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                            this.updateGridBefore(tableRow, dragValue);\n                            this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                        }\n                    }\n                }\n                else {\n                    var difference = leastGridBefore - dragValue;\n                    if (difference > 0) {\n                        newIndent = table.leftIndent + dragValue;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        this.updateWidthForCells(table, selectedCells, dragValue);\n                    }\n                    else {\n                        newIndent = table.leftIndent + leastGridBefore;\n                        table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n                                this.updateGridBefore(tableRow, dragValue - leastGridBefore);\n                            }\n                            else {\n                                this.updateGridBefore(tableRow, -leastGridBefore);\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        this.updateGridValue(table, true, dragValue);\n    };\n    TableResizer.prototype.updateWidthForCells = function (table, selectedCells, dragValue) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var tableRow = table.childWidgets[i];\n            if (selectedCells.indexOf(tableRow.childWidgets[0]) !== -1) {\n                this.increaseOrDecreaseWidth(tableRow.childWidgets[0], dragValue, false);\n            }\n            else {\n                this.updateGridBefore(tableRow, -dragValue);\n            }\n        }\n    };\n    /**\n     * Resize selected cells at last column\n     */\n    TableResizer.prototype.resizeColumnAtLastColumnIndex = function (table, dragValue, containerWidth) {\n        var tableAlignment = table.tableFormat.tableAlignment;\n        var preferredWidth = table.tableFormat.preferredWidth;\n        var hasTableWidth = preferredWidth;\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var prevDragValue = 0;\n        while (dragValue !== prevDragValue) {\n            var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n            if (newWidth >= leftColumn.minWidth) {\n                leftColumn.preferredWidth = newWidth;\n                prevDragValue = dragValue;\n            }\n            else {\n                prevDragValue = dragValue;\n                dragValue -= newWidth - leftColumn.minWidth;\n            }\n        }\n        this.updateCellPreferredWidths(table);\n        if (hasTableWidth || table.tableHolder.getTotalWidth() > containerWidth) {\n            table.updateWidth(dragValue);\n            table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        }\n        var dragOffset = dragValue;\n        if (tableAlignment === 'Right') {\n            dragOffset = 0;\n        }\n        else if (tableAlignment === 'Center') {\n            dragOffset = dragOffset / 2;\n        }\n        this.updateGridValue(table, true, dragOffset);\n    };\n    /**\n     *  Resize selected cells at middle column\n     */\n    TableResizer.prototype.resizeCellAtMiddle = function (table, dragValue) {\n        var columnIndex = this.resizerPosition;\n        var leftColumn = table.tableHolder.columns[columnIndex - 1];\n        var rightColumn = table.tableHolder.columns[columnIndex];\n        if (dragValue > 0) {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(rightColumn.preferredWidth - dragValue, 1);\n                if (newWidth >= rightColumn.minWidth) {\n                    rightColumn.preferredWidth = newWidth;\n                    leftColumn.preferredWidth = leftColumn.preferredWidth + dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue += newWidth - rightColumn.minWidth;\n                }\n            }\n        }\n        else {\n            var isContinue = true;\n            while (isContinue) {\n                var newWidth = HelperMethods.round(leftColumn.preferredWidth + dragValue, 1);\n                if (newWidth >= leftColumn.minWidth) {\n                    leftColumn.preferredWidth = newWidth;\n                    rightColumn.preferredWidth = rightColumn.preferredWidth - dragValue;\n                    isContinue = false;\n                }\n                else {\n                    dragValue -= newWidth - leftColumn.minWidth;\n                }\n            }\n        }\n        // Update the cell widths based on the columns preferred width\n        this.updateCellPreferredWidths(table);\n        // table.tableFormat.AllowAutoFit = false;\n        table.tableHolder.tableWidth = table.tableHolder.getTotalWidth();\n        this.updateGridValue(table, false, dragValue);\n    };\n    TableResizer.prototype.updateGridValue = function (table, isUpdate, dragValue) {\n        if (isUpdate) {\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.owner.isLayoutEnabled = true;\n        if (table.isInsideTable) {\n            var parentTable = this.viewer.layout.getParentTable(table);\n            this.viewer.layout.reLayoutTable(parentTable); // Need to optmize this.\n        }\n        else {\n            this.viewer.layout.reLayoutTable(table);\n        }\n        this.owner.editor.getOffsetValue(this.viewer.selection);\n        this.owner.editorModule.reLayout(this.owner.selection);\n        if (dragValue) {\n            this.startingPoint.x += HelperMethods.convertPointToPixel(dragValue);\n            this.resizerPosition = this.getCellReSizerPosition(this.startingPoint);\n        }\n    };\n    TableResizer.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    TableResizer.prototype.updateGridBefore = function (row, offset) {\n        if (row.rowFormat.beforeWidth + offset !== row.rowFormat.beforeWidth) {\n            row.rowFormat.beforeWidth = row.rowFormat.beforeWidth + offset;\n            row.rowFormat.gridBeforeWidth = row.rowFormat.beforeWidth;\n        }\n    };\n    TableResizer.prototype.getLeastGridBefore = function (table, ignoreRow) {\n        var gridBefore = 0;\n        var flag = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row !== ignoreRow) {\n                if (flag === 0) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                    flag++;\n                }\n                if (row.rowFormat.beforeWidth <= gridBefore) {\n                    gridBefore = row.rowFormat.beforeWidth;\n                }\n            }\n        }\n        return gridBefore;\n    };\n    TableResizer.prototype.increaseOrDecreaseWidth = function (cell, dragValue, isIncrease) {\n        var preferredWidth = cell.cellFormat.preferredWidth;\n        if (cell.cellFormat.preferredWidthType === 'Auto') {\n            preferredWidth = cell.cellFormat.cellWidth;\n            cell.cellFormat.preferredWidthType = 'Point';\n        }\n        var minimumWidth = cell.ownerColumn.minWidth;\n        if (cell.cellFormat.preferredWidthType === 'Percent') {\n            minimumWidth = cell.convertPointToPercent(minimumWidth);\n        }\n        // Margins properties usedd for internal purpose.\n        if (isIncrease) {\n            cell.cellFormat.preferredWidth = preferredWidth + dragValue > minimumWidth ? preferredWidth + dragValue : minimumWidth;\n        }\n        else {\n            cell.cellFormat.preferredWidth = preferredWidth - dragValue > minimumWidth ? preferredWidth - dragValue : minimumWidth;\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    TableResizer.prototype.changeWidthOfCells = function (table, leftColumnCollection, rightColumnCollection, dragValue, isSelection) {\n        if (leftColumnCollection.length > 0) {\n            var flag = false;\n            for (var i = 0; i < leftColumnCollection.length; i++) {\n                var cell = leftColumnCollection[i];\n                this.increaseOrDecreaseWidth(cell, dragValue, true);\n                if (cell.cellIndex === cell.ownerRow.childWidgets.length - 1) {\n                    flag = true;\n                }\n            }\n            if (flag) {\n                this.updateRowsGridAfterWidth(table);\n            }\n        }\n        if (rightColumnCollection.length > 0) {\n            var diff = 0;\n            for (var i = 0; i < rightColumnCollection.length; i++) {\n                var cell = rightColumnCollection[i];\n                if (cell.cellIndex === 0) {\n                    var newGridBefore = cell.ownerRow.rowFormat.beforeWidth + dragValue;\n                    if (newGridBefore >= 0) {\n                        this.updateGridBefore(cell.ownerRow, dragValue);\n                    }\n                    else {\n                        if (diff !== newGridBefore) {\n                            diff = newGridBefore;\n                        }\n                        cell.ownerRow.rowFormat.gridBeforeWidth = 0;\n                        cell.ownerRow.rowFormat.gridBeforeWidthType = 'Auto';\n                    }\n                }\n                this.increaseOrDecreaseWidth(cell, dragValue, false);\n            }\n            if (diff !== 0) {\n                var newIndent = table.leftIndent + diff;\n                table.tableFormat.leftIndent = newIndent >= -1440 ? (newIndent <= 1440 ? newIndent : 1440) : -1440;\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    if (rightColumnCollection.indexOf(row.childWidgets[0]) === -1) {\n                        this.updateGridBefore(row, diff > 0 ? diff : -diff);\n                    }\n                }\n            }\n        }\n    };\n    TableResizer.prototype.updateRowsGridAfterWidth = function (table) {\n        var maxRowWidth = this.getMaxRowWidth(table, true);\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var currentRowWidth = this.getRowWidth(row, true);\n            if (maxRowWidth >= currentRowWidth && row.rowFormat.afterWidth !== maxRowWidth - currentRowWidth) {\n                var value = maxRowWidth - currentRowWidth;\n                row.rowFormat.gridAfterWidth = value;\n                row.rowFormat.afterWidth = value;\n            }\n        }\n    };\n    TableResizer.prototype.getRowWidth = function (row, toUpdateGridAfter) {\n        var rowWidth = 0;\n        if (toUpdateGridAfter) {\n            rowWidth = rowWidth + row.rowFormat.beforeWidth;\n        }\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            rowWidth += cell.cellFormat.cellWidth;\n        }\n        return rowWidth;\n    };\n    TableResizer.prototype.getMaxRowWidth = function (table, toUpdateGridAfter) {\n        var width = 0;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowWidth = 0;\n            if (toUpdateGridAfter) {\n                rowWidth = rowWidth + row.rowFormat.beforeWidth;\n            }\n            for (var i_1 = 0; i_1 < row.childWidgets.length; i_1++) {\n                var cell = row.childWidgets[i_1];\n                rowWidth += cell.cellFormat.cellWidth;\n            }\n            if (width < rowWidth) {\n                width = rowWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.isColumnSelected = function (table, columnIndex) {\n        var selection = this.owner.selection;\n        var selectedCells = selection.getSelectedCells();\n        var leftColumnCells = this.getColumnCells(table, columnIndex, true);\n        var rightColumnCells = this.getColumnCells(table, columnIndex, false);\n        var isColumnSelected = false;\n        for (var i = 0; i < leftColumnCells.length; i++) {\n            var columnCell = leftColumnCells[i];\n            isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n        }\n        if (!isColumnSelected) {\n            for (var i = 0; i < rightColumnCells.length; i++) {\n                var columnCell = rightColumnCells[i];\n                isColumnSelected = selectedCells.indexOf(columnCell) !== -1 ? true : false;\n            }\n        }\n        return isColumnSelected;\n    };\n    TableResizer.prototype.applyProperties = function (table, tableHistoryInfo) {\n        if (isNullOrUndefined(tableHistoryInfo)) {\n            return;\n        }\n        table = table;\n        // PreserveGrid = true;\n        if (tableHistoryInfo.tableHolder) {\n            table.tableHolder = tableHistoryInfo.tableHolder.clone();\n        }\n        if (tableHistoryInfo.tableFormat !== null) {\n            table.tableFormat.leftIndent = tableHistoryInfo.tableFormat.leftIndent;\n            table.tableFormat.preferredWidth = tableHistoryInfo.tableFormat.preferredWidth;\n            table.tableFormat.preferredWidthType = tableHistoryInfo.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = tableHistoryInfo.rows[i];\n            row.rowFormat.gridBefore = rowFormat.gridBefore;\n            row.rowFormat.gridBeforeWidth = rowFormat.gridBeforeWidth;\n            row.rowFormat.gridBeforeWidthType = rowFormat.gridBeforeWidthType;\n            row.rowFormat.gridAfter = rowFormat.gridAfter;\n            row.rowFormat.gridAfterWidth = rowFormat.gridAfterWidth;\n            row.rowFormat.gridAfterWidthType = rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = rowFormat.cells[j];\n                cell.columnIndex = cellFormat.columnIndex;\n                cell.cellFormat.columnSpan = cellFormat.columnSpan;\n                cell.cellFormat.preferredWidth = cellFormat.preferredWidth;\n                cell.cellFormat.preferredWidthType = cellFormat.preferredWidthType;\n            }\n        }\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        //Sets the width to cells\n        table.setWidthToCells(tableWidth, table.tableFormat.preferredWidthType === 'Auto');\n        // PreserveGrid = false;\n    };\n    /**\n     * Return table row width\n     */\n    TableResizer.prototype.getActualWidth = function (row) {\n        var width = 0;\n        if (row.childWidgets.length > 0) {\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                width += row.childWidgets[i].cellFormat.cellWidth;\n            }\n        }\n        return width;\n    };\n    TableResizer.prototype.setPreferredWidth = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var rw = table.childWidgets[i];\n            var rowFormat = rw.rowFormat;\n            if (rowFormat.gridBefore > 0) {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            for (var j = 0; j < rw.childWidgets.length; j++) {\n                var cell = rw.childWidgets[j];\n                cell.cellFormat.preferredWidth = cell.cellFormat.cellWidth;\n                cell.cellFormat.preferredWidthType = 'Point';\n            }\n            if (rowFormat.gridAfter > 0) {\n                rowFormat.gridAfterWidth = rowFormat.afterWidth;\n                rowFormat.gridAfterWidthType = 'Point';\n            }\n        }\n    };\n    TableResizer.prototype.updateCellPreferredWidths = function (table) {\n        var tableWidth = table.tableHolder.tableWidth;\n        var isAutoFit = table.tableFormat.preferredWidthType === 'Auto';\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.rowFormat.gridBefore > 0) {\n                var width = table.tableHolder.getCellWidth(0, row.rowFormat.gridBefore, tableWidth, isAutoFit);\n                this.updateGridBeforeWidth(width, row);\n            }\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                cell.updateWidth(table.tableHolder.getCellWidth(cell.columnIndex, cell.cellFormat.columnSpan, tableWidth, isAutoFit));\n            }\n            if (row.rowFormat.gridAfter > 0) {\n                // tslint:disable-next-line:max-line-length\n                this.updateGridAfterWidth(table.tableHolder.getCellWidth(row.childWidgets.length, row.rowFormat.gridAfter, tableWidth, isAutoFit), row);\n            }\n        }\n    };\n    /**\n     * Update grid before width value\n     */\n    TableResizer.prototype.updateGridBeforeWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.beforeWidth) {\n            rowFormat.beforeWidth = width;\n            if (rowFormat.gridBeforeWidthType === 'Auto') {\n                rowFormat.gridBeforeWidthType = 'Point';\n            }\n            if (rowFormat.gridBeforeWidthType === 'Point') {\n                rowFormat.gridBeforeWidth = rowFormat.beforeWidth;\n            }\n            else {\n                // The value is calculated from the pixel values hence, its converted to percent using method. \n                var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n                var value = row.ownerTable.convertPointToPercent(rowFormat.beforeWidth, ownerWidth);\n                rowFormat.gridBeforeWidth = value;\n            }\n        }\n    };\n    /**\n     * Update grid after width value\n     */\n    TableResizer.prototype.updateGridAfterWidth = function (width, row) {\n        var rowFormat = row.rowFormat;\n        if (width !== rowFormat.afterWidth) {\n            rowFormat.afterWidth = width;\n        }\n        if (rowFormat.gridAfterWidthType === 'Auto') {\n            rowFormat.gridAfterWidthType = 'Point';\n        }\n        if (rowFormat.gridAfterWidthType === 'Point') {\n            rowFormat.gridAfterWidth = rowFormat.afterWidth;\n        }\n        else {\n            // The value is calculated from the pixel values hence, its converted to percent using method. \n            var ownerWidth = row.ownerTable.getTableClientWidth(row.ownerTable.getOwnerWidth(true));\n            var value = row.ownerTable.convertPointToPercent(rowFormat.afterWidth, ownerWidth);\n            rowFormat.gridAfterWidth = value;\n        }\n    };\n    return TableResizer;\n}());\nexport { TableResizer };\n","import { TextPosition, ImageFormat } from '../selection/selection-helper';\nimport { ParagraphWidget, LineWidget, ElementBox, TextElementBox, Margin, ImageElementBox, BlockWidget, BlockContainer, BodyWidget, TableWidget, TableCellWidget, TableRowWidget, Widget, ListTextElementBox, BookmarkElementBox, HeaderFooterWidget, FieldTextElementBox, TabElementBox } from '../viewer/page';\nimport { WCharacterFormat } from '../format/character-format';\nimport { HelperMethods } from './editor-helper';\nimport { isNullOrUndefined, Browser, classList } from '@syncfusion/ej2-base';\nimport { WParagraphFormat, WSectionFormat, WListFormat, WTableFormat, WRowFormat, WCellFormat, WBorder, WBorders, WTabStop } from '../index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WLevelOverride } from '../list/level-override';\nimport { FieldElementBox } from '../viewer/page';\nimport { WCharacterStyle } from '../format/style';\nimport { TableResizer } from './table-resizer';\nimport { WParagraphStyle } from '../format/style';\n/**\n * Editor module\n */\nvar Editor = /** @class */ (function () {\n    /**\n     * Initialize the editor module\n     * @param  {LayoutViewer} viewer\n     * @private\n     */\n    function Editor(viewer) {\n        var _this = this;\n        this.nodes = [];\n        this.editHyperlinkInternal = false;\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        /**\n         * @private\n         */\n        this.isHandledComplex = false;\n        /**\n         * @private\n         */\n        this.tableResize = undefined;\n        /**\n         * @private\n         */\n        this.tocStyles = {};\n        this.refListNumber = undefined;\n        this.incrementListNumber = -1;\n        this.removedBookmarkElements = [];\n        /**\n         * @private\n         */\n        this.tocBookmarkId = 0;\n        /**\n         * @private\n         */\n        this.copiedData = undefined;\n        this.pageRefFields = {};\n        /**\n         * @private\n         */\n        this.isInsertingTOC = false;\n        /**\n         * @private\n         */\n        this.isBordersAndShadingDialog = false;\n        /**\n         * @private\n         */\n        this.onTextInputInternal = function (event) {\n            if (Browser.isDevice) {\n                var viewer = _this.viewer;\n                var nbsp = new RegExp(String.fromCharCode(160), 'g');\n                var lineFeed = new RegExp(String.fromCharCode(10), 'g');\n                viewer.prefix = viewer.prefix.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var text = viewer.editableDiv.textContent.replace(nbsp, ' ').replace(lineFeed, ' ');\n                var textBoxText = text.substring(2);\n                if (viewer.isCompositionStart && viewer.isCompositionUpdated) {\n                    viewer.isCompositionUpdated = false;\n                    if (!viewer.owner.isReadOnlyMode && viewer.owner.isDocumentLoaded) {\n                        if (viewer.prefix.substring(2) !== textBoxText) {\n                            if (_this.selection.isEmpty) {\n                                // tslint:disable-next-line:max-line-length\n                                _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                            else {\n                                _this.handleTextInput(textBoxText);\n                                viewer.prefix = '@' + String.fromCharCode(160) + textBoxText;\n                            }\n                        }\n                    }\n                    return;\n                }\n                else if (viewer.isCompositionStart && viewer.isCompositionEnd && viewer.suffix === '') {\n                    if (viewer.prefix.substring(2) !== textBoxText) {\n                        if (_this.selection.isEmpty && viewer.isCompositionStart) {\n                            viewer.isCompositionStart = false;\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - viewer.prefix.substring(2).length);\n                            _this.selection.retrieveCurrentFormatProperties();\n                            if (viewer.suffix === '' || textBoxText === '') {\n                                _this.handleTextInput(textBoxText);\n                            }\n                        }\n                        else if (!_this.selection.isEmpty) {\n                            viewer.isCompositionStart = false;\n                            _this.handleTextInput(textBoxText);\n                        }\n                    }\n                    else if (textBoxText === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleBackKey();\n                    }\n                    else if (viewer.prefix.substring(2) === textBoxText && viewer.suffix === '') {\n                        viewer.isCompositionStart = false;\n                        _this.handleTextInput(' ');\n                    }\n                    viewer.isCompositionEnd = false;\n                    return;\n                }\n                else if (viewer.isCompositionEnd || viewer.isCompositionStart && !viewer.isCompositionUpdated) {\n                    if (textBoxText.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1) || viewer.editableDiv.innerText.length < 2) {\n                        _this.handleBackKey();\n                        return;\n                    }\n                    else if (viewer.suffix !== '' &&\n                        viewer.editableDiv.innerText[viewer.editableDiv.innerText.length - 1] !== String.fromCharCode(160)) {\n                        viewer.isCompositionStart = false;\n                        //When cursor is placed in between a word and chosen a word from predicted words.\n                        // tslint:disable-next-line:max-line-length\n                        _this.selection.start.setPositionForLineWidget(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        _this.selection.end.setPositionForLineWidget(viewer.selection.end.currentWidget, _this.selection.end.offset + viewer.suffix.length);\n                        //Retrieve the character format properties. Since the selection was changed manually.\n                        _this.selection.retrieveCurrentFormatProperties();\n                        _this.handleTextInput(textBoxText);\n                        return;\n                    }\n                }\n                // tslint:disable-next-line:max-line-length\n                if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !viewer.owner.isReadOnlyMode && viewer.isControlPressed === false) {\n                    if (text === '@' || text[0] !== '@' || text === '' || text.length < viewer.prefix.length &&\n                        textBoxText === viewer.prefix.substring(2, viewer.prefix.length - 1)) {\n                        _this.handleBackKey();\n                        if (viewer.editableDiv.innerText.length < 2) {\n                            _this.predictText();\n                        }\n                    }\n                    else if (text.indexOf(viewer.prefix) === 0 && text.length > viewer.prefix.length) {\n                        _this.handleTextInput(text.substring(viewer.prefix.length));\n                    }\n                    else if (text.indexOf(viewer.prefix) === -1 && text[text.length - 1] !== String.fromCharCode(160)\n                        && text[text.length - 1] !== ' ') {\n                        if ((textBoxText.charAt(0).toLowerCase() + textBoxText.slice(1)) === viewer.prefix.substring(2)) {\n                            // tslint:disable-next-line:max-line-length\n                            _this.selection.start.setPositionParagraph(viewer.selection.start.currentWidget, _this.selection.start.offset - (viewer.prefix.length - 2));\n                        }\n                        _this.handleTextInput(textBoxText);\n                    }\n                    else if (text.length !== 2) {\n                        _this.handleTextInput(' ');\n                    }\n                }\n            }\n            else {\n                var text = _this.viewer.editableDiv.innerText;\n                if (text !== String.fromCharCode(160)) {\n                    // tslint:disable-next-line:max-line-length\n                    if (text !== '\\r' && text !== '\\b' && text !== '\\u001B' && !_this.owner.isReadOnlyMode && _this.viewer.isControlPressed === false) {\n                        _this.handleTextInput(text);\n                    }\n                }\n                else {\n                    _this.handleTextInput(' ');\n                }\n                _this.viewer.editableDiv.innerText = '';\n            }\n        };\n        /**\n         * Fired on paste.\n         * @param {ClipboardEvent} event\n         * @private\n         */\n        this.onPaste = function (event) {\n            if (!_this.owner.isReadOnlyMode) {\n                _this.pasteInternal(event);\n            }\n            event.preventDefault();\n        };\n        this.viewer = viewer;\n        this.tableResize = new TableResizer(this.viewer.owner);\n    }\n    Object.defineProperty(Editor.prototype, \"editorHistory\", {\n        get: function () {\n            return this.viewer.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"selection\", {\n        get: function () {\n            if (this.viewer) {\n                return this.viewer.selection;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Editor.prototype, \"owner\", {\n        get: function () {\n            return this.viewer.owner;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Editor.prototype.getModuleName = function () {\n        return 'Editor';\n    };\n    Editor.prototype.insertField = function (code, result) {\n        var fieldCode = code;\n        if (isNullOrUndefined(result)) {\n            fieldCode = HelperMethods.trimStart(fieldCode);\n            if (fieldCode.substring(0, 10) === 'MERGEFIELD') {\n                fieldCode = fieldCode.substring(10).trim();\n                var index = fieldCode.indexOf('\\\\*');\n                result = 'Â«' + fieldCode.substring(0, index).trim() + 'Â»';\n            }\n        }\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldCodeSpan = new TextElementBox();\n        fieldCodeSpan.text = code;\n        line.children.push(fieldCodeSpan);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        var fieldResultSpan = new TextElementBox();\n        fieldResultSpan.text = result;\n        line.children.push(fieldResultSpan);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldBegin.fieldEnd = fieldEnd;\n        fieldSeparator.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        this.viewer.fields.push(fieldBegin);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * To update style for paragraph\n     * @param style - style name\n     * @param clearDirectFormatting - Removes manual formatting (formatting not applied using a style)\n     * from the selected text, to match the formatting of the applied style. Default value is false.\n     */\n    Editor.prototype.applyStyle = function (style, clearDirectFormatting) {\n        clearDirectFormatting = isNullOrUndefined(clearDirectFormatting) ? false : clearDirectFormatting;\n        if (clearDirectFormatting) {\n            this.initComplexHistory('ApplyStyle');\n            this.clearFormatting();\n        }\n        var styleObj = this.viewer.styles.findByName(style);\n        if (styleObj !== undefined) {\n            this.onApplyParagraphFormat('styleName', styleObj, false, true);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(style)), this.viewer.styles);\n            this.applyStyle(style);\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo && this.editorHistory.currentHistoryInfo.action === 'ApplyStyle') {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    // Public Implementation Starts\n    /**\n     * Moves the selected content in the document editor control to clipboard.\n     */\n    Editor.prototype.cut = function () {\n        if (this.owner.isReadOnlyMode || this.selection.isEmpty) {\n            return;\n        }\n        this.selection.copySelectedContent(true);\n    };\n    /**\n     * Notify content change event\n     * @private\n     */\n    Editor.prototype.fireContentChange = function () {\n        if (this.viewer.owner.isLayoutEnabled && !this.viewer.owner.isShiftingEnabled) {\n            this.viewer.owner.fireContentChange();\n        }\n    };\n    /**\n     * Update physical location for text position\n     * @private\n     */\n    Editor.prototype.updateSelectionTextPosition = function (isSelectionChanged) {\n        this.getOffsetValue(this.selection);\n        this.selection.start.updatePhysicalPosition(true);\n        if (this.selection.isEmpty) {\n            this.selection.end.setPositionInternal(this.selection.start);\n        }\n        else {\n            this.selection.end.updatePhysicalPosition(true);\n        }\n        this.selection.upDownSelectionLength = this.selection.end.location.x;\n        this.selection.fireSelectionChanged(isSelectionChanged);\n    };\n    /**\n     * Predict text\n     * @private\n     */\n    Editor.prototype.predictText = function () {\n        this.viewer.suffix = '';\n        if (this.selection.start.paragraph.isEmpty() || this.selection.start.offset === 0 &&\n            this.selection.start.currentWidget.isFirstLine() || this.selection.end.offset === 0 &&\n            this.selection.end.currentWidget.isFirstLine()) {\n            this.viewer.prefix = '';\n        }\n        else {\n            this.getPrefixAndSuffix();\n        }\n        this.viewer.prefix = '@' + String.fromCharCode(160) + this.viewer.prefix; // &nbsp;\n        this.viewer.editableDiv.innerText = this.viewer.prefix;\n        this.viewer.selection.setEditableDivCaretPosition(this.viewer.prefix.length);\n    };\n    /**\n     * Gets prefix and suffix.\n     * @private\n     */\n    /* tslint:disable:max-func-body-length */\n    Editor.prototype.getPrefixAndSuffix = function () {\n        var viewer = this.viewer;\n        if (this.selection.text !== '') {\n            viewer.prefix = '';\n            return;\n        }\n        else {\n            var startIndex = 0;\n            var inlineInfo = this.selection.start.currentWidget.getInline(this.selection.start.offset, startIndex);\n            var inline = inlineInfo.element;\n            startIndex = inlineInfo.index;\n            if (inline !== undefined) {\n                var boxInfo = this.selection.getElementBoxInternal(inline, startIndex);\n                var box = boxInfo.element;\n                startIndex = boxInfo.index;\n                var spaceIndex = 0;\n                if (!isNullOrUndefined(box)) {\n                    var prefixAdded = false;\n                    if (box instanceof TextElementBox && startIndex > 0 && box.line.isFirstLine()) {\n                        viewer.prefix = '';\n                    }\n                    if (!(inline instanceof TextElementBox)) {\n                        inline = this.selection.getPreviousTextElement(inline);\n                    }\n                    /* tslint:disable:no-conditional-assignment */\n                    while ((spaceIndex = viewer.prefix.lastIndexOf(' ')) < 0 && inline instanceof TextElementBox) {\n                        if (inline.previousNode instanceof TextElementBox && viewer.prefix.indexOf(' ') === -1) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            inline = inline.previousNode;\n                            // If the line has no elements then break the loop to avoid the exception.\n                            if (inline instanceof ListTextElementBox) {\n                                break;\n                            }\n                            if (!(inline instanceof TextElementBox)) {\n                                inline = this.selection.getPreviousTextElement(inline);\n                            }\n                        }\n                        else if (!(inline.previousNode instanceof TextElementBox)) {\n                            if (!prefixAdded) {\n                                viewer.prefix = inline.text.substring(0, startIndex);\n                                prefixAdded = true;\n                            }\n                            else {\n                                viewer.prefix = inline.text + viewer.prefix;\n                            }\n                            break;\n                        }\n                    }\n                    if (!(viewer.prefix.length > 1 && viewer.prefix[viewer.prefix.length - 1] === ' ' &&\n                        viewer.prefix[viewer.prefix.length - 2] === '.')) {\n                        spaceIndex = viewer.prefix.lastIndexOf(' ');\n                    }\n                    else {\n                        spaceIndex = -1;\n                        viewer.prefix = '';\n                    }\n                    viewer.prefix = spaceIndex < 0 ? viewer.prefix : viewer.prefix.substring(spaceIndex);\n                    if (viewer.prefix.indexOf(' ') === 0 && viewer.prefix.length >= 1) {\n                        viewer.prefix = viewer.prefix.substring(1);\n                    }\n                    // suffix text prediction\n                    var endIndex = 0;\n                    var endInlineInfo = this.selection.end.currentWidget.getInline(this.selection.end.offset, endIndex);\n                    var endInline = endInlineInfo.element;\n                    endIndex = endInlineInfo.index;\n                    boxInfo = this.selection.getElementBoxInternal(endInline, endIndex);\n                    box = boxInfo.element;\n                    endIndex = boxInfo.index;\n                    if (box) {\n                        var suffixAdded = false;\n                        if (box instanceof TextElementBox && endIndex < box.length) {\n                            viewer.suffix = '';\n                        }\n                        // boxIndex = renderedElements.get(endInline).indexOf(box);\n                        while ((spaceIndex = viewer.suffix.indexOf(' ')) < 0 && endInline instanceof TextElementBox) {\n                            if (endInline.nextNode instanceof TextElementBox && viewer.suffix.indexOf(' ') === -1) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                endInline = endInline.nextNode;\n                            }\n                            else if (!(endInline.nextNode instanceof TextElementBox)) {\n                                if (!suffixAdded) {\n                                    viewer.suffix = box.text.substring(endIndex);\n                                    suffixAdded = true;\n                                }\n                                else {\n                                    viewer.suffix = viewer.suffix + endInline.text;\n                                }\n                                break;\n                            }\n                        }\n                        spaceIndex = viewer.suffix.indexOf(' ');\n                        viewer.suffix = spaceIndex < 0 ? viewer.suffix : viewer.suffix.substring(0, spaceIndex);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * key action\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    Editor.prototype.onKeyDownInternal = function (event, ctrl, shift, alt) {\n        var key = event.which || event.keyCode;\n        if (ctrl && !shift && !alt) {\n            this.viewer.isControlPressed = true;\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.insertPageBreak();\n                    break;\n                case 48:\n                    event.preventDefault();\n                    this.onApplyParagraphFormat('beforeSpacing', 0, false, false);\n                    break;\n                case 49:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1, false, false);\n                    }\n                    break;\n                case 50:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 2, false, false);\n                    }\n                    break;\n                case 53:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyParagraphFormat('lineSpacing', 1.5, false, false);\n                    }\n                    break;\n                case 66:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBold();\n                    }\n                    break;\n                case 68:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.fontDialogModule) {\n                        this.owner.fontDialogModule.showFontDialog();\n                    }\n                    break;\n                case 69:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Center');\n                    }\n                    event.preventDefault();\n                    break;\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnly && this.owner.optionsPaneModule) {\n                        this.owner.optionsPaneModule.isReplace = true;\n                        this.owner.optionsPaneModule.showHideOptionsPane(true);\n                    }\n                    break;\n                case 73:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleItalic();\n                    }\n                    break;\n                case 74:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Justify');\n                    }\n                    event.preventDefault();\n                    break;\n                case 75:\n                    event.preventDefault();\n                    if (this.owner.hyperlinkDialogModule && !this.owner.isReadOnlyMode) {\n                        this.owner.hyperlinkDialogModule.show();\n                    }\n                    break;\n                case 76:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Left');\n                    }\n                    event.preventDefault();\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.increaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 78:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.openBlank();\n                    }\n                    break;\n                case 82:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleTextAlignment('Right');\n                    }\n                    event.preventDefault();\n                    break;\n                case 85:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Single');\n                    }\n                    break;\n                case 88:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.editor.cut();\n                    }\n                    break;\n                case 89:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.redo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 90:\n                    if (this.owner.enableEditorHistory) {\n                        this.editorHistory.undo();\n                        event.preventDefault();\n                    }\n                    break;\n                case 219:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 221:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Subscript');\n                    }\n                    break;\n            }\n        }\n        else if (shift && !ctrl && !alt) {\n            switch (key) {\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(false, true);\n                    }\n                    break;\n                case 13:\n                    this.handleShiftEnter();\n                    event.preventDefault();\n                    break;\n            }\n        }\n        else if (shift && ctrl && !alt) {\n            switch (key) {\n                case 68:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.toggleUnderline('Double');\n                    }\n                    break;\n                case 77:\n                    if (!this.owner.isReadOnlyMode) {\n                        this.owner.selection.decreaseIndent();\n                    }\n                    event.preventDefault();\n                    break;\n                case 188:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'decrement', true);\n                    }\n                    break;\n                case 190:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.onApplyCharacterFormat('fontSize', 'increment', true);\n                    }\n                    break;\n                case 187:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode) {\n                        this.toggleBaselineAlignment('Superscript');\n                    }\n            }\n        }\n        else if (!shift && ctrl && alt) {\n            switch (key) {\n                case 72:\n                    event.preventDefault();\n                    if (!this.owner.isReadOnlyMode && this.owner.isDocumentLoaded) {\n                        this.toggleHighlightColor();\n                    }\n                    break;\n            }\n        }\n        else {\n            switch (key) {\n                case 8:\n                    event.preventDefault();\n                    this.handleBackKey();\n                    break;\n                case 9:\n                    event.preventDefault();\n                    if (this.owner.acceptTab) {\n                        this.selection.handleTabKey(true, false);\n                    }\n                    break;\n                case 13:\n                    event.preventDefault();\n                    this.handleEnterKey();\n                    break;\n                case 46:\n                    this.handleDelete();\n                    event.preventDefault();\n                    break;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleShiftEnter = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.handleTextInput('\\v');\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles back key.\n     * @private\n     */\n    Editor.prototype.handleBackKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onBackSpace();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles delete\n     * @private\n     */\n    Editor.prototype.handleDelete = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.owner.editorModule.onDelete();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Handles enter key.\n     * @private\n     */\n    Editor.prototype.handleEnterKey = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (Browser.isDevice) {\n                this.viewer.isCompositionStart = false;\n            }\n            this.owner.editorModule.onEnter();\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.handleTextInput = function (text) {\n        var _this = this;\n        if (!this.owner.isReadOnlyMode) {\n            if (this.animationTimer) {\n                clearTimeout(this.animationTimer);\n            }\n            classList(this.selection.caret, [], ['e-de-cursor-animation']);\n            this.owner.editorModule.insertText(text, false);\n            /* tslint:disable:align */\n            this.animationTimer = setTimeout(function () {\n                if (_this.animationTimer) {\n                    clearTimeout(_this.animationTimer);\n                }\n                if (_this.selection && _this.selection.caret) {\n                    classList(_this.selection.caret, ['e-de-cursor-animation'], []);\n                }\n            }, 600);\n        }\n        this.selection.checkForCursorVisibility();\n    };\n    /**\n     * Copies to format.\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    Editor.prototype.copyInsertFormat = function (format, copy) {\n        var insertFormat = new WCharacterFormat();\n        var sFormat = this.selection.characterFormat;\n        if (copy) {\n            insertFormat.copyFormat(format);\n        }\n        if (!isNullOrUndefined(sFormat.bold) && format.bold !== sFormat.bold) {\n            insertFormat.bold = sFormat.bold;\n        }\n        if (!isNullOrUndefined(sFormat.italic) && format.italic !== sFormat.italic) {\n            insertFormat.italic = sFormat.italic;\n        }\n        if (sFormat.fontSize > 0 && format.fontSize !== sFormat.fontSize) {\n            insertFormat.fontSize = sFormat.fontSize;\n        }\n        if (!isNullOrUndefined(sFormat.fontFamily) && format.fontFamily !== sFormat.fontFamily) {\n            insertFormat.fontFamily = sFormat.fontFamily;\n        }\n        if (!isNullOrUndefined(sFormat.highlightColor) && format.highlightColor !== sFormat.highlightColor) {\n            insertFormat.highlightColor = sFormat.highlightColor;\n        }\n        if (!isNullOrUndefined(sFormat.baselineAlignment) && format.baselineAlignment !== sFormat.baselineAlignment) {\n            insertFormat.baselineAlignment = sFormat.baselineAlignment;\n        }\n        if (!isNullOrUndefined(sFormat.fontColor) && format.fontColor !== sFormat.fontColor) {\n            insertFormat.fontColor = sFormat.fontColor;\n        }\n        if (!isNullOrUndefined(sFormat.underline) && format.underline !== sFormat.underline) {\n            insertFormat.underline = sFormat.underline;\n        }\n        if (!isNullOrUndefined(sFormat.strikethrough) && format.strikethrough !== sFormat.strikethrough) {\n            insertFormat.strikethrough = sFormat.strikethrough;\n        }\n        return insertFormat;\n    };\n    /**\n     * Inserts the specified text at cursor position\n     * @param  {string} text\n     * @param  {boolean} isReplace\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    Editor.prototype.insertText = function (text, isReplace) {\n        var selection = this.viewer.selection;\n        var insertPosition;\n        var isRemoved = true;\n        this.isListTextSelected();\n        this.initHistory('Insert');\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        this.viewer.selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        if ((!selection.isEmpty && !this.viewer.selection.isImageSelected) ||\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            selection.isSkipLayouting = true;\n            selection.skipFormatRetrieval = true;\n            isRemoved = this.removeSelectedContents(selection);\n            selection.skipFormatRetrieval = false;\n            selection.isSkipLayouting = false;\n        }\n        paragraphInfo = this.getParagraphInfo(selection.start);\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            insertPosition = selection.start;\n            if (insertPosition.paragraph.isEmpty()) {\n                var span = new TextElementBox();\n                var insertFormat = this.copyInsertFormat(insertPosition.paragraph.characterFormat, true);\n                span.characterFormat.copyFormat(insertFormat);\n                span.text = text;\n                span.line = insertPosition.paragraph.childWidgets[0];\n                span.margin = new Margin(0, 0, 0, 0);\n                span.line.children.push(span);\n                if ((insertPosition.paragraph.paragraphFormat.textAlignment === 'Center'\n                    || insertPosition.paragraph.paragraphFormat.textAlignment === 'Right') &&\n                    insertPosition.paragraph.paragraphFormat.listFormat.listId === -1) {\n                    insertPosition.paragraph.x = this.viewer.clientActiveArea.x;\n                }\n                this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, 0, 0);\n            }\n            else {\n                var indexInInline = 0;\n                var inlineObj = insertPosition.currentWidget.getInline(insertPosition.offset, indexInInline);\n                var inline = inlineObj.element;\n                indexInInline = inlineObj.index;\n                // Todo: compare selection format\n                var insertFormat = this.copyInsertFormat(inline.characterFormat, true);\n                if (insertFormat.isSameFormat(inline.characterFormat)) {\n                    this.insertTextInline(inline, selection, text, indexInInline);\n                }\n                else {\n                    var tempSpan = new TextElementBox();\n                    tempSpan.text = text;\n                    tempSpan.line = inline.line;\n                    tempSpan.characterFormat.copyFormat(insertFormat);\n                    var insertIndex = inline.indexInOwner;\n                    if (indexInInline === inline.length) {\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    else if (indexInInline === 0) {\n                        inline.line.children.splice(insertIndex, 0, tempSpan);\n                    }\n                    else {\n                        if (inline instanceof TextElementBox) {\n                            var splittedSpan = new TextElementBox();\n                            splittedSpan.line = inline.line;\n                            splittedSpan.characterFormat.copyFormat(inline.characterFormat);\n                            splittedSpan.text = inline.text.substring(indexInInline);\n                            inline.text = inline.text.slice(0, indexInInline);\n                            inline.line.children.splice(insertIndex + 1, 0, splittedSpan);\n                        }\n                        inline.line.children.splice(insertIndex + 1, 0, tempSpan);\n                    }\n                    this.viewer.layout.reLayoutParagraph(insertPosition.paragraph, inline.line.indexInOwner, 0);\n                }\n            }\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + text.length, true);\n            this.updateEndPosition();\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(this.editorHistory) && !isNullOrUndefined(this.editorHistory.currentHistoryInfo) && (this.editorHistory.currentHistoryInfo.action === 'ListSelect') &&\n                this.viewer.isListTextSelected) {\n                this.editorHistory.updateHistory();\n                this.editorHistory.updateComplexHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo) && (selection.currentHistoryInfo.action === 'MultiSelection')) {\n            //     this.updateComplexHistory();\n            // } else {           \n            this.reLayout(selection);\n            // }\n        }\n        else {\n            // selection.selectContent(selection.start, true);\n        }\n        // insertFormat.destroy();\n        if (!isReplace && isRemoved && (text === ' ' || text === '\\t' || text === '\\v')) {\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            var isList = false;\n            if (!(text === '\\v')) {\n                isList = this.checkAndConvertList(selection, text === '\\t');\n            }\n            if (isSelectionOnHyperlink) {\n                return;\n            }\n            if (!isList) {\n                //Checks if the previous text is URL, then it is auto formatted to hyperlink.\n                this.checkAndConvertToHyperlink(selection, false);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertIMEText = function (text, isUpdate) {\n        if (this.viewer.lastComposedText === text && isUpdate) {\n            return;\n        }\n        // Clone selection start position\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        var startPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        // Insert IME text in current selection\n        this.insertText(text, false);\n        this.viewer.lastComposedText = text;\n        // update selection start\n        var start = this.selection.start;\n        this.setPositionForCurrentIndex(start, startPosition);\n        // Update selection end\n        var endPosition = new TextPosition(this.owner);\n        endPosition.setPositionForLineWidget(start.currentWidget, start.offset + text.length);\n        this.selection.selectPosition(isUpdate ? start : endPosition, endPosition);\n    };\n    /**\n     * Insert Section break at cursor position\n     */\n    Editor.prototype.insertSectionBreak = function () {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(selection) || this.owner.isReadOnlyMode || selection.start.paragraph.isInHeaderFooter) {\n            return;\n        }\n        this.initHistory('SectionBreak');\n        if (!selection.isEmpty) {\n            selection.selectContent(selection.isForward ? selection.start : selection.end, true);\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.insertSection(selection, true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertSection = function (selection, selectFirstBlock) {\n        var newSectionFormat = this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();\n        var lastBlock;\n        var firstBlock;\n        if (selection.start.paragraph.isInsideTable) {\n            var table = this.viewer.layout.getParentTable(selection.start.paragraph);\n            table = table.combineWidget(this.viewer);\n            var insertBefore = false;\n            if (selection.start.paragraph.associatedCell.rowIndex === 0) {\n                insertBefore = true;\n            }\n            var newParagraph = new ParagraphWidget();\n            var previousBlock = table.previousRenderedWidget;\n            if (!insertBefore) {\n                lastBlock = this.splitTable(table, selection.start.paragraph.associatedCell.ownerRow);\n                this.viewer.layout.layoutBodyWidgetCollection(lastBlock.index, lastBlock.containerWidget, lastBlock, false);\n                lastBlock = lastBlock.getSplitWidgets().pop();\n            }\n            else {\n                lastBlock = table;\n            }\n            var insertIndex = 0;\n            if ((isNullOrUndefined(previousBlock) || !previousBlock.bodyWidget.equals(lastBlock.bodyWidget)) && insertBefore) {\n                insertIndex = 0;\n                newParagraph.index = 0;\n            }\n            else {\n                insertIndex = lastBlock.indexInOwner + 1;\n                newParagraph.index = lastBlock.index + 1;\n            }\n            lastBlock.containerWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n            newParagraph.containerWidget = lastBlock.containerWidget;\n            this.updateNextBlocksIndex(newParagraph, true);\n            this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.containerWidget, newParagraph, false);\n            lastBlock = newParagraph;\n        }\n        else {\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var selectionStart = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n            //Split Paragraph\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, selectionStart);\n            lastBlock = selection.start.paragraph.getSplitWidgets().pop();\n        }\n        //Split body widget\n        firstBlock = this.splitBodyWidget(lastBlock.bodyWidget, newSectionFormat, lastBlock).firstChild;\n        if (firstBlock instanceof TableWidget) {\n            firstBlock.updateRowIndex(0);\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(firstBlock.index, firstBlock.containerWidget, firstBlock, false);\n        if (firstBlock instanceof TableWidget) {\n            firstBlock = selection.getFirstParagraphInFirstCell(firstBlock);\n        }\n        if (selectFirstBlock) {\n            selection.selectParagraph(firstBlock, true);\n        }\n        return firstBlock;\n    };\n    Editor.prototype.splitBodyWidget = function (bodyWidget, sectionFormat, startBlock) {\n        var sectionIndex;\n        //Move blocks after the start block to next body widget\n        var newBodyWidget = this.viewer.layout.moveBlocksToNextPage(startBlock);\n        //Update SectionIndex for splitted body widget\n        this.updateSectionIndex(sectionFormat, newBodyWidget, true);\n        // insert New header footer widget in to section index \n        this.insertRemoveHeaderFooter(newBodyWidget.sectionIndex, true);\n        //update header and footer for splitted widget\n        this.viewer.layout.layoutHeaderFooter(newBodyWidget, this.viewer, newBodyWidget.page);\n        //Update Child item index from 0 for new Section\n        this.updateBlockIndex(0, newBodyWidget.firstChild);\n        // Start sinfting from first block\n        this.viewer.updateClientArea(newBodyWidget.sectionFormat, newBodyWidget.page);\n        return newBodyWidget;\n    };\n    Editor.prototype.insertRemoveHeaderFooter = function (sectionIndex, insert) {\n        if (this.viewer.headersFooters[sectionIndex]) {\n            // Need to handle further\n        }\n        else {\n            this.viewer.headersFooters[sectionIndex] = {};\n        }\n    };\n    Editor.prototype.updateBlockIndex = function (blockIndex, block) {\n        var blocks;\n        var sectionIndex = block.bodyWidget.sectionIndex;\n        do {\n            blocks = block.getSplitWidgets();\n            for (var i = 0; i < blocks.length; i++) {\n                blocks[i].index = blockIndex;\n            }\n            blockIndex++;\n            block = blocks.pop().nextRenderedWidget;\n        } while (!isNullOrUndefined(block) && block.bodyWidget.sectionIndex === sectionIndex);\n    };\n    Editor.prototype.updateSectionIndex = function (sectionFormat, startBodyWidget, increaseIndex) {\n        var currentSectionIndex = startBodyWidget.sectionIndex;\n        var blockIndex = 0;\n        var bodyWidget = startBodyWidget;\n        do {\n            if (bodyWidget.index === currentSectionIndex && sectionFormat) {\n                bodyWidget.sectionFormat = sectionFormat;\n            }\n            if (increaseIndex) {\n                bodyWidget.index++;\n            }\n            else {\n                bodyWidget.index--;\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n        } while (bodyWidget);\n    };\n    //Auto convert List\n    Editor.prototype.checkAndConvertList = function (selection, isTab) {\n        var list = selection.paragraphFormat.getList();\n        if (!isNullOrUndefined(list)) {\n            return false;\n        }\n        var convertList = false;\n        var isLeadingZero = false;\n        var indexInInline = 0;\n        var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (!(inline instanceof TextElementBox)) {\n            return false;\n        }\n        var span = inline;\n        var text = span.text.substring(0, indexInInline);\n        var tabValue = 0;\n        var length = 0;\n        while (!isNullOrUndefined(span.previousNode)) {\n            // tslint:disable-next-line:max-line-length\n            if (span.previousNode instanceof TextElementBox && (span.previousNode.text === '\\t' || span.previousNode.text.trim().length === 0)) {\n                (span.previousNode.text === '\\t') ? tabValue += 36 : length = span.previousNode.text.length * 2.5;\n                span = span.previousNode;\n                continue;\n            }\n            return false;\n        }\n        span = inline;\n        var index = 0;\n        var tabIndex = text.lastIndexOf('\\t');\n        index = (tabIndex >= 0) ? tabIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabIndex = previousText.lastIndexOf('\\t');\n            index = (tabIndex >= 0) ? tabIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n            text = text.substring(index);\n        }\n        text = HelperMethods.trimStart(text);\n        var numberFormat = text.substring(1, 2);\n        var listLevelPattern = this.getListLevelPattern(text.substring(0, 1));\n        if (listLevelPattern !== 'None' && this.checkNumberFormat(numberFormat, listLevelPattern === 'Bullet', text)) {\n            convertList = true;\n        }\n        else if (this.checkLeadingZero(text)) {\n            isLeadingZero = true;\n            convertList = true;\n        }\n        if (convertList) {\n            this.initComplexHistory('AutoList');\n            var paragraph = inline.paragraph;\n            // tslint:disable-next-line:max-line-length\n            selection.start.setPositionParagraph(paragraph.childWidgets[0], paragraph.childWidgets[0].getOffset(inline, indexInInline + 1));\n            selection.end.setPositionParagraph(paragraph.childWidgets[0], 0);\n            this.initHistory('Delete');\n            this.deleteSelectedContents(selection, false);\n            this.reLayout(selection, false);\n            var followCharacter = isTab ? 'Tab' : 'Space';\n            numberFormat = !isLeadingZero ? '%1' + numberFormat : '%1' + text.substring(text.length - 1, text.length);\n            var leadingZeroText = text.substring(text.length - 3, text.length - 1);\n            listLevelPattern = !isLeadingZero ? listLevelPattern : this.getListLevelPattern(leadingZeroText);\n            var listLevel = new WListLevel(undefined);\n            listLevel.listLevelPattern = listLevelPattern;\n            if (listLevelPattern === 'Bullet') {\n                if (text === '*') {\n                    listLevel.numberFormat = '\\uf0b7';\n                    listLevel.characterFormat.fontFamily = 'Symbol';\n                }\n                else if (text === '-') {\n                    listLevel.numberFormat = '-';\n                }\n            }\n            else {\n                listLevel.numberFormat = numberFormat;\n            }\n            listLevel.followCharacter = followCharacter;\n            var leftIndent = selection.paragraphFormat.leftIndent;\n            if (tabValue !== 0 || length !== 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18 + tabValue + length;\n            }\n            else if (indexInInline > 2) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + (indexInInline - 2) * 2.5 + 18;\n            }\n            else if (leftIndent > 0) {\n                listLevel.paragraphFormat.leftIndent = leftIndent + 18;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            if ((!isLeadingZero && text.substring(0, 1) === '0') || leadingZeroText === '00') {\n                listLevel.startAt = 0;\n            }\n            else {\n                listLevel.startAt = 1;\n            }\n            this.autoConvertList(selection, listLevel);\n            if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.reLayout(selection);\n            }\n        }\n        return convertList;\n    };\n    Editor.prototype.getListLevelPattern = function (value) {\n        switch (value) {\n            case '0':\n            case '1':\n                return 'Arabic';\n            case 'I':\n                return 'UpRoman';\n            case 'i':\n                return 'LowRoman';\n            case 'A':\n                return 'UpLetter';\n            case 'a':\n                return 'LowLetter';\n            case '*':\n            case '-':\n                return 'Bullet';\n            case '00':\n            case '01':\n                return 'LeadingZero';\n            default:\n                return 'None';\n        }\n    };\n    Editor.prototype.autoConvertList = function (selection, listLevel) {\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var newList = new WList();\n        if (this.viewer.lists.length > 0) {\n            newList.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n        }\n        else {\n            newList.listId = 0;\n        }\n        var newAbstractList = new WAbstractList();\n        var layout = this.viewer;\n        if (layout.abstractLists.length > 0) {\n            newAbstractList.abstractListId = layout.abstractLists[layout.abstractLists.length - 1].abstractListId + 1;\n        }\n        else {\n            newAbstractList.abstractListId = 0;\n        }\n        newList.abstractListId = newAbstractList.abstractListId;\n        newList.abstractList = newAbstractList;\n        layout.abstractLists.push(newAbstractList);\n        newAbstractList.levels.push(listLevel);\n        listLevel.ownerBase = newAbstractList;\n        selection.paragraphFormat.setList(newList);\n        selection.paragraphFormat.listLevelNumber = 0;\n    };\n    Editor.prototype.checkNumberFormat = function (numberFormat, isBullet, text) {\n        if (isBullet) {\n            return numberFormat === '';\n        }\n        else {\n            var index = text.indexOf(numberFormat);\n            return (numberFormat === '.' || numberFormat === ')'\n                || numberFormat === '>' || numberFormat === '-') && text.substring(index, text.length - 1) === '';\n        }\n    };\n    Editor.prototype.checkLeadingZero = function (text) {\n        var j;\n        var isZero = false;\n        for (var i = 0; i <= text.length - 1; i++) {\n            if (text.charAt(i) === '0') {\n                isZero = true;\n                continue;\n            }\n            j = i;\n            break;\n        }\n        var numberFormat = undefined;\n        if (text.charAt(j) === '1') {\n            numberFormat = text.charAt(j + 1);\n        }\n        else {\n            numberFormat = text.charAt(j);\n        }\n        return isZero && this.checkNumberFormat(numberFormat, false, text);\n    };\n    Editor.prototype.getPageFromBlockWidget = function (block) {\n        var page = undefined;\n        if (block.containerWidget instanceof BodyWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            page = block.containerWidget.page;\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            page = block.containerWidget.bodyWidget.page;\n        }\n        return page;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertTextInline = function (element, selection, text, index) {\n        if (element instanceof TextElementBox) {\n            element.text = HelperMethods.insert(element.text, index, text);\n            var paragraph = element.line.paragraph;\n            var lineIndex = paragraph.childWidgets.indexOf(element.line);\n            var elementIndex = element.line.children.indexOf(element);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n        }\n        else if (element instanceof ImageElementBox) {\n            this.insertImageText(element, selection, text, index);\n        }\n        else if (element instanceof FieldElementBox) {\n            if (element.fieldType === 0) {\n                this.insertFieldBeginText(element, selection, text, index);\n            }\n            else if (element.fieldType === 2) {\n                this.insertFieldSeparatorText(element, selection, text, index);\n            }\n            else {\n                this.insertFieldEndText(element, selection, text, index);\n            }\n        }\n        else if (element instanceof BookmarkElementBox) {\n            this.insertBookMarkText(element, selection, text, index);\n        }\n    };\n    Editor.prototype.insertFieldBeginText = function (fieldBegin, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = fieldBegin.line.paragraph.childWidgets.indexOf(fieldBegin.line);\n        var spanIndex = fieldBegin.line.children.indexOf(fieldBegin);\n        spanObj.characterFormat.copyFormat(fieldBegin.characterFormat);\n        fieldBegin.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = fieldBegin.line;\n        this.viewer.layout.reLayoutParagraph(fieldBegin.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertBookMarkText = function (element, selection, text, index) {\n        var spanObj = new TextElementBox();\n        spanObj.text = text;\n        var lineIndex = element.line.paragraph.childWidgets.indexOf(element.line);\n        var spanIndex = element.line.children.indexOf(element);\n        spanObj.characterFormat.copyFormat(element.characterFormat);\n        element.line.children.splice(spanIndex, 0, spanObj);\n        spanObj.line = element.line;\n        this.viewer.layout.reLayoutParagraph(element.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldSeparatorText = function (fieldSeparator, selection, text, index) {\n        var previousInline = selection.getPreviousTextInline(fieldSeparator);\n        var nextInline = selection.getNextTextInline(fieldSeparator);\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldSeparator.line.children.indexOf(fieldSeparator);\n        if (index === fieldSeparator.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInline) && isNullOrUndefined(nextInline)) {\n            span.characterFormat.copyFormat(fieldSeparator.line.paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInline)) {\n            span.characterFormat.copyFormat(nextInline.characterFormat);\n        }\n        else {\n            span.characterFormat.copyFormat(previousInline.characterFormat);\n        }\n        fieldSeparator.line.children.splice(spanIndex, 0, span);\n        span.line = fieldSeparator.line;\n        var lineIndex = fieldSeparator.line.paragraph.childWidgets.indexOf(fieldSeparator.line);\n        this.viewer.layout.reLayoutParagraph(fieldSeparator.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertFieldEndText = function (fieldEnd, selection, text, index) {\n        var span = new TextElementBox();\n        span.text = text;\n        var spanIndex = fieldEnd.line.children.indexOf(fieldEnd);\n        span.characterFormat.copyFormat(fieldEnd.characterFormat);\n        fieldEnd.line.children.splice(spanIndex + 1, 0, span);\n        span.line = fieldEnd.line;\n        var lineIndex = fieldEnd.line.paragraph.childWidgets.indexOf(fieldEnd.line);\n        this.viewer.layout.reLayoutParagraph(fieldEnd.line.paragraph, lineIndex, spanIndex);\n    };\n    Editor.prototype.insertImageText = function (image, selection, text, index) {\n        var previousInlineObj = selection.getPreviousTextInline(image);\n        var nextInlineObj = selection.getNextTextInline(image);\n        var line = image.line;\n        var element = new TextElementBox();\n        var paragraph = line.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(line);\n        element.text = text;\n        var spanIndex = line.children.indexOf(image);\n        if (index === image.length) {\n            spanIndex++;\n        }\n        if (isNullOrUndefined(previousInlineObj) && isNullOrUndefined(nextInlineObj)) {\n            element.characterFormat.copyFormat(paragraph.characterFormat);\n        }\n        else if (isNullOrUndefined(previousInlineObj)) {\n            element.characterFormat.copyFormat(nextInlineObj.characterFormat);\n        }\n        else {\n            element.characterFormat.copyFormat(previousInlineObj.characterFormat);\n        }\n        line.children.splice(spanIndex, 0, element);\n        element.line = line;\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, spanIndex);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.isListTextSelected = function () {\n        if (this.viewer.isListTextSelected) {\n            this.initComplexHistory('ListSelect');\n            // tslint:disable-next-line:max-line-length\n            if (this.viewer.selection.start.paragraph.paragraphFormat.listFormat && this.viewer.selection.start.paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n    };\n    //Auto Format and insert Hyperlink Implementation starts\n    Editor.prototype.checkAndConvertToHyperlink = function (selection, isEnter, paragraph) {\n        var text;\n        var span;\n        if (isEnter) {\n            span = paragraph.lastChild.children[paragraph.lastChild.children.length - 1];\n            text = span.text;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset - 1, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!(inline instanceof TextElementBox)) {\n                return;\n            }\n            span = inline;\n            text = span.text.substring(0, indexInInline);\n        }\n        var index = 0;\n        var tabCharIndex = text.lastIndexOf('\\t');\n        index = (tabCharIndex >= 0) ? tabCharIndex + 1 : text.lastIndexOf(' ') + 1;\n        while (span.previousNode instanceof TextElementBox && index === 0) {\n            span = span.previousNode;\n            var previousText = span.text;\n            tabCharIndex = previousText.lastIndexOf('\\t');\n            index = (tabCharIndex >= 0) ? tabCharIndex + 1 : previousText.lastIndexOf(' ') + 1;\n            text = span.text + text;\n        }\n        text = text.substring(index);\n        var lowerCaseText = text.toLowerCase();\n        var containsURL = false;\n        if (lowerCaseText.substring(0, 8) === 'file:///'\n            || (lowerCaseText.substring(0, 7) === 'http://' && lowerCaseText.length > 7)\n            || (lowerCaseText.substring(0, 8) === 'https://' && lowerCaseText.length > 8)\n            || (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4)\n            || (lowerCaseText.substring(0, 3) === '\\\\' && lowerCaseText.length > 3)\n            || (lowerCaseText.substring(0, 7) === 'mailto:' && lowerCaseText.length > 7)) {\n            containsURL = true;\n            if (lowerCaseText.substring(0, 4) === 'www.' && lowerCaseText.length > 4) {\n                text = 'http://' + text;\n            }\n        }\n        else {\n            var atIndex = text.indexOf('@');\n            var dotIndex = text.indexOf('.');\n            if (atIndex > 0 && atIndex < dotIndex && dotIndex < text.length - 1) {\n                containsURL = true;\n                text = 'mailto:' + text;\n            }\n        }\n        if (containsURL) {\n            var startPos = new TextPosition(this.viewer.owner);\n            startPos.setPositionParagraph(span.line, span.line.getOffset(span, index));\n            var endPos = new TextPosition(this.viewer.owner);\n            if (isEnter) {\n                endPos.setPositionParagraph(span.line, span.line.getEndOffset());\n            }\n            else {\n                if (selection.end.currentWidget.children.length === 0 && selection.end.offset === 0) {\n                    var prevLine = selection.end.currentWidget.previousLine;\n                    endPos.setPositionParagraph(prevLine, prevLine.getEndOffset());\n                }\n                else {\n                    endPos.setPositionParagraph(selection.end.currentWidget, selection.end.offset - 1);\n                }\n            }\n            this.autoFormatHyperlink(selection, text, startPos, endPos);\n        }\n    };\n    Editor.prototype.autoFormatHyperlink = function (selection, url, startPosition, endPosition) {\n        this.initComplexHistory('AutoFormatHyperlink');\n        var blockInfo = this.getParagraphInfo(startPosition);\n        var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.insertPosition = start;\n        }\n        // Moves the selection to URL text start and end position.\n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(endPosition);\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldEnd = this.createHyperlinkElement(url, startPosition, endPosition, format);\n        // Moves the selection to the end of field end position.\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 1));\n        // Moves to next text position. (To achieve common behavior for space and enter).\n        selection.start.moveNextPosition();\n        selection.end.setPositionInternal(selection.start);\n        blockInfo = this.getParagraphInfo(selection.end);\n        var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.currentHistoryInfo.endPosition = end;\n            this.editorHistory.updateComplexHistory();\n            this.reLayout(selection);\n        }\n        else {\n            this.updateComplexWithoutHistory(0, start, end);\n        }\n    };\n    Editor.prototype.appylingHyperlinkFormat = function (selection) {\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'Single', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', '#0563c1', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createHyperlinkElement = function (url, startPosition, endPosition, format) {\n        var selection = this.selection;\n        this.viewer.layout.allowLayout = false;\n        this.appylingHyperlinkFormat(selection);\n        this.viewer.layout.allowLayout = true;\n        // Adds the field end at the URL text end position.\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.characterFormat.copyFormat(format);\n        fieldEnd.line = selection.end.currentWidget;\n        selection.start.setPositionInternal(selection.end);\n        // this.insertElementInCurrentLine(selection, fieldEnd, true);\n        this.initInsertInline(fieldEnd);\n        // Moves the selection to URL text start position.        \n        selection.start.setPositionInternal(startPosition);\n        selection.end.setPositionInternal(selection.start);\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = this.insertHyperlinkfield(selection, format, url);\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n        var index = begin.line.children.indexOf(begin);\n        fieldEnd.linkFieldCharacter(this.viewer);\n        this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n        return fieldEnd;\n    };\n    Editor.prototype.insertHyperlinkfield = function (selection, format, url, isBookmark) {\n        // Adds field begin, field code and field separator at the URL text start position.\n        var begin = new FieldElementBox(0);\n        begin.characterFormat.copyFormat(format);\n        begin.line = selection.start.currentWidget;\n        this.initInsertInline(begin);\n        var span = new TextElementBox();\n        span.characterFormat.copyFormat(format);\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        span.line = selection.start.currentWidget;\n        this.initInsertInline(span);\n        var separator = new FieldElementBox(2);\n        separator.characterFormat.copyFormat(format);\n        separator.line = selection.start.currentWidget;\n        this.initInsertInline(separator);\n        return begin;\n    };\n    Editor.prototype.unLinkFieldCharacter = function (inline) {\n        if (inline instanceof FieldElementBox && inline.fieldType === 0) {\n            if (inline.fieldEnd) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                // inline.line.paragraph.addFieldCharacter(inline.fieldEnd);\n                inline.fieldEnd = undefined;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (!isNullOrUndefined(inline.fieldEnd)) {\n                if (this.viewer) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                inline.fieldBegin.fieldSeparator = undefined;\n                inline.fieldEnd.fieldSeparator = undefined;\n            }\n        }\n        else if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            if (inline.fieldBegin) {\n                if (!isNullOrUndefined(this.viewer)) {\n                    this.viewer.fieldToLayout = inline.fieldBegin;\n                    this.viewer.fieldEndParagraph = inline.line.paragraph;\n                }\n                var fieldIndex = this.viewer.fields.indexOf(inline.fieldBegin);\n                if (fieldIndex !== -1) {\n                    this.viewer.fields.splice(fieldIndex, 1);\n                }\n                inline.fieldBegin = undefined;\n            }\n        }\n    };\n    Editor.prototype.getCharacterFormat = function (selection) {\n        if (selection.start.paragraph.isEmpty()) {\n            return selection.start.paragraph.characterFormat;\n        }\n        else {\n            var info = selection.start.currentWidget.getInline(selection.start.offset, 0);\n            return info.element.characterFormat;\n        }\n    };\n    /**\n     * Insert Hyperlink\n     * @param  {string} url\n     * @param  {string} displayText\n     * @param  {boolean} remove\n     * @private\n     */\n    Editor.prototype.insertHyperlink = function (url, displayText, remove, isBookmark) {\n        var selection = this.viewer.selection;\n        if (selection.start.paragraph.associatedCell !== selection.end.paragraph.associatedCell) {\n            return;\n        }\n        if (remove) {\n            //Empty selection Hyperlink insert\n            this.insertHyperlinkInternal(selection, url, displayText, isBookmark);\n        }\n        else {\n            //Non-Empty Selection- change the selected text to Field       \n            // this.preservedFontCol = this.getFontColor();\n            var startPosition = selection.start;\n            var endPosition = selection.end;\n            if (!selection.isForward) {\n                startPosition = selection.end;\n                endPosition = selection.start;\n            }\n            var fieldStartPosition = new TextPosition(this.viewer.owner);\n            fieldStartPosition.setPositionInternal(startPosition);\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat(undefined);\n            format.copyFormat(temp);\n            this.initComplexHistory('InsertHyperlink');\n            var blockInfo = this.getParagraphInfo(startPosition);\n            var start = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.insertPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            this.appylingHyperlinkFormat(selection);\n            this.viewer.layout.allowLayout = true;\n            startPosition.setPositionInternal(endPosition);\n            // Adds the field end at the URL text end position.\n            var fieldEnd = new FieldElementBox(1);\n            fieldEnd.characterFormat.copyFormat(format);\n            fieldEnd.line = selection.end.currentWidget;\n            startPosition.setPositionInternal(endPosition);\n            // this.insertElementInCurrentLine(selection, fieldEnd, true);\n            this.initInsertInline(fieldEnd);\n            // Moves the selection to URL text start position.        \n            startPosition.setPositionInternal(fieldStartPosition);\n            endPosition.setPositionInternal(startPosition);\n            // Adds field begin, field code and field separator at the URL text start position.\n            var begin = this.insertHyperlinkfield(selection, format, url, isBookmark);\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var lineIndex = selection.start.paragraph.childWidgets.indexOf(begin.line);\n            var index = begin.line.children.indexOf(begin);\n            this.viewer.layout.reLayoutParagraph(selection.start.paragraph, lineIndex, index);\n            var lineWidget = fieldEnd.line;\n            selection.selects(lineWidget, lineWidget.getOffset(fieldEnd, fieldEnd.length), true);\n            blockInfo = this.getParagraphInfo(endPosition);\n            var end = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n                // tslint:disable-next-line:max-line-length\n                this.editorHistory.currentHistoryInfo.endPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n                this.editorHistory.updateComplexHistory();\n            }\n            else {\n                this.updateComplexWithoutHistory(1, start, end);\n            }\n        }\n    };\n    Editor.prototype.insertHyperlinkInternal = function (selection, url, displayText, isBookmark) {\n        if (isNullOrUndefined(selection.start)) {\n            return;\n        }\n        if (this.editHyperlink(selection, url, displayText)) {\n            return;\n        }\n        this.initHistory('InsertHyperlink');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            // Preserves the character format for hyperlink field.\n            var temp = this.getCharacterFormat(selection);\n            var format = new WCharacterFormat();\n            format.copyFormat(temp);\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        //else\n        //    this.Select(Start, true);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertHyperlinkByFormat = function (selection, url, displayText, format, isBookmark) {\n        this.updateInsertPosition();\n        selection.owner.isShiftingEnabled = true;\n        var indexInInline = 0;\n        var initial = indexInInline;\n        var element = [];\n        var fieldBegin = new FieldElementBox(0);\n        element.push(fieldBegin);\n        var span = new TextElementBox();\n        if (isBookmark) {\n            span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n        }\n        else {\n            span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n        }\n        element.push(span);\n        var fieldSeparator = new FieldElementBox(2);\n        element.push(fieldSeparator);\n        if (!isNullOrUndefined(displayText) && displayText !== '') {\n            span = new TextElementBox();\n            span.characterFormat.underline = 'Single';\n            span.characterFormat.fontColor = '#0563c1';\n            span.text = displayText;\n            element.push(span);\n        }\n        var fieldEnd = new FieldElementBox(1);\n        element.push(fieldEnd);\n        this.insertElement(element);\n        var paragraph = selection.start.paragraph;\n        fieldEnd.linkFieldCharacter(this.viewer);\n        if (this.viewer.fields.indexOf(fieldBegin) === -1) {\n            this.viewer.fields.push(fieldBegin);\n        }\n        var offset = fieldEnd.line.getOffset(fieldEnd, 1);\n        selection.selects(fieldEnd.line, fieldEnd.line.getOffset(fieldEnd, fieldEnd.length), true);\n        this.updateEndPosition();\n        this.reLayout(selection, true);\n    };\n    Editor.prototype.initInsertInline = function (element, insertHyperlink) {\n        this.initHistory('InsertInline');\n        this.insertInlineInSelection(this.viewer.selection, element);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementInCurrentLine = function (selection, inline, isReLayout) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertElement([inline]);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Edit Hyperlink\n     * @param  {Selection} selection\n     * @param  {string} url\n     * @param  {string} displayText\n     * @private\n     */\n    Editor.prototype.editHyperlink = function (selection, url, displayText, isBookmark) {\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return false;\n        }\n        this.initHistory('InsertHyperlink');\n        this.editHyperlinkInternal = isNullOrUndefined(this.editorHistory)\n            || (this.editorHistory && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo));\n        var fieldResult = '';\n        var isNestedField = false;\n        // Preserves the character format for hyperlink field.\n        var temp = this.getCharacterFormat(selection);\n        var format = new WCharacterFormat();\n        format.copyFormat(temp);\n        var fieldSeparator = undefined;\n        if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n            fieldSeparator = fieldBegin.fieldSeparator;\n            // tslint:disable-next-line:max-line-length\n            var fieldObj = selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, isNestedField, format);\n            fieldResult = fieldObj.displayText;\n            isNestedField = fieldObj.isNestedField;\n            format = fieldObj.format;\n        }\n        var offset = fieldBegin.line.getOffset(fieldBegin, 0);\n        selection.start.setPositionParagraph(fieldBegin.line, offset);\n        offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n        selection.end.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n        this.deleteSelectedContents(selection, false);\n        if (!isNestedField && fieldResult !== displayText || isNullOrUndefined(fieldSeparator)) {\n            this.insertHyperlinkByFormat(selection, url, displayText, format, isBookmark);\n        }\n        else {\n            //Modify the new hyperlink url. Inserts field begin, url and field separator.\n            this.updateInsertPosition();\n            var newFieldBegin = new FieldElementBox(0);\n            newFieldBegin.characterFormat.copyFormat(fieldBegin.characterFormat);\n            newFieldBegin.line = selection.start.currentWidget;\n            this.insertInlineInternal(newFieldBegin);\n            var span = new TextElementBox();\n            span.characterFormat.copyFormat(fieldBegin.characterFormat);\n            if (isBookmark) {\n                span.text = ' HYPERLINK \\\\l \\\"' + url + '\\\" ';\n            }\n            else {\n                span.text = ' HYPERLINK \\\"' + url + '\\\" ';\n            }\n            span.line = selection.start.currentWidget;\n            this.insertInlineInternal(span);\n            var nodes = this.editorHistory && this.editorHistory.currentBaseHistoryInfo ?\n                this.editorHistory.currentBaseHistoryInfo.removedNodes : this.nodes;\n            this.insertClonedFieldResult(selection, nodes, fieldSeparator);\n            var fieldEnd = selection.end.currentWidget.getInline(selection.end.offset, 0).element;\n            fieldEnd.linkFieldCharacter(this.viewer);\n            var paragraph = newFieldBegin.line.paragraph;\n            var lineIndex = newFieldBegin.line.paragraph.childWidgets.indexOf(newFieldBegin.line);\n            var elementIndex = newFieldBegin.line.children.indexOf(newFieldBegin);\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            selection.selects(newFieldBegin.fieldEnd.line, offset, true);\n            this.updateEndPosition();\n            this.reLayout(selection, true);\n        }\n        this.editHyperlinkInternal = false;\n        this.nodes = [];\n        return true;\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.insertClonedFieldResult = function (selection, nodes, fieldSeparator) {\n        var fieldEnd;\n        var isStarted = false;\n        for (var i = nodes.length - 1; i > -1; i--) {\n            var node = nodes[i];\n            /* tslint:enable:no-any */\n            if (!isStarted) {\n                if (fieldSeparator === node) {\n                    isStarted = true;\n                }\n                else {\n                    if (node instanceof ParagraphWidget && node === fieldSeparator.line.paragraph) {\n                        isStarted = true;\n                        var paragraph = undefined;\n                        if (i === nodes.length - 1) {\n                            paragraph = selection.start.paragraph;\n                            var fieldParagraph = fieldSeparator.line.paragraph;\n                            this.getClonedFieldResultWithSel(fieldParagraph, selection, fieldSeparator);\n                        }\n                        else {\n                            paragraph = this.getClonedFieldResult(fieldSeparator.line.paragraph, fieldSeparator);\n                            this.insertParagraph(paragraph, true);\n                        }\n                        selection.selectParagraph(selection.getNextParagraphBlock(paragraph), true);\n                    }\n                    continue;\n                }\n            }\n            if (node instanceof ElementBox) {\n                this.insertInlineInternal(node.clone());\n            }\n            else if (node instanceof BlockWidget) {\n                this.insertBlock(node.clone());\n            }\n            // else if (node instanceof WSection)\n            //     editor.insertSection((node as WSection)._Clone());\n        }\n    };\n    Editor.prototype.getClonedFieldResultWithSel = function (paragraph, selection, fieldSeparator) {\n        var lineIndex = paragraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = paragraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < paragraph.childWidgets.length; j++) {\n            var lineWidget = paragraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                this.insertInlineInternal(lineWidget.children[i].clone());\n            }\n        }\n    };\n    Editor.prototype.getClonedFieldResult = function (curParagraph, fieldSeparator) {\n        var paragraph = new ParagraphWidget();\n        paragraph.characterFormat.copyFormat(curParagraph.characterFormat);\n        paragraph.paragraphFormat.copyFormat(curParagraph.paragraphFormat);\n        var lineIndex = curParagraph.childWidgets.indexOf(fieldSeparator.line);\n        var elementIndex = curParagraph.childWidgets[lineIndex].children.indexOf(fieldSeparator);\n        for (var j = lineIndex; j < curParagraph.childWidgets.length; j++) {\n            var lineWidget = curParagraph.childWidgets[j];\n            if (j !== lineIndex) {\n                elementIndex = 0;\n            }\n            for (var i = elementIndex; i < lineWidget.children.length; i++) {\n                paragraph.childWidgets[0].children.push(lineWidget.children[i]);\n            }\n        }\n        return paragraph;\n    };\n    /**\n     * Removes the hyperlink if selection is within hyperlink.\n     */\n    Editor.prototype.removeHyperlink = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var selection = this.selection;\n        var fieldBegin = selection.getHyperlinkField();\n        if (isNullOrUndefined(fieldBegin)) {\n            return;\n        }\n        var fieldEnd = fieldBegin.fieldEnd;\n        var fieldSeparator = fieldBegin.fieldSeparator;\n        var fieldStartPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldStartPosition.setPositionParagraph(fieldBegin.line, (fieldBegin.line).getOffset(fieldBegin, 0));\n        var fieldSeparatorPosition = new TextPosition(selection.owner);\n        // tslint:disable-next-line:max-line-length\n        fieldSeparatorPosition.setPositionParagraph(fieldSeparator.line, (fieldSeparator.line).getOffset(fieldSeparator, fieldSeparator.length));\n        this.initComplexHistory('RemoveHyperlink');\n        selection.start.setPositionParagraph(fieldEnd.line, (fieldEnd.line).getOffset(fieldEnd, 0));\n        selection.end.setPositionInternal(selection.start);\n        this.onDelete();\n        selection.start.setPositionInternal(fieldSeparatorPosition);\n        this.initHistory('Underline');\n        this.updateCharacterFormatWithUpdate(selection, 'underline', 'None', false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        // Applies font color for field result.\n        this.initHistory('FontColor');\n        this.updateCharacterFormatWithUpdate(selection, 'fontColor', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.reLayout(selection, false);\n        selection.end.setPositionInternal(selection.start);\n        selection.start.setPositionInternal(fieldStartPosition);\n        this.initHistory('Delete');\n        this.deleteSelectedContents(selection, false);\n        this.reLayout(selection, true);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n    };\n    //Paste Implementation starts\n    /**\n     * Paste copied clipboard content on Paste event\n     * @param  {ClipboardEvent} event\n     * @param  {any} pasteWindow?\n     * @private\n     */\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteInternal = function (event, pasteWindow) {\n        if (this.viewer.owner.enableLocalPaste) {\n            this.pasteLocal();\n        }\n        else {\n            if (isNullOrUndefined(pasteWindow)) {\n                pasteWindow = window;\n            }\n            /* tslint:enable:no-any */\n            var textContent = '';\n            var clipbordData = pasteWindow.clipboardData ? pasteWindow.clipboardData : event.clipboardData;\n            textContent = clipbordData.getData('Text');\n            if (textContent !== '') {\n                this.pasteContents(textContent);\n                this.viewer.editableDiv.innerHTML = '';\n            }\n        }\n        this.viewer.updateFocus();\n    };\n    /**\n     * Pastes the data present in local clipboard if any.\n     */\n    Editor.prototype.pasteLocal = function () {\n        /* tslint:disable:no-any */\n        if (this.copiedData && this.owner.enableLocalPaste) {\n            var document_1 = JSON.parse(this.copiedData);\n            this.pasteContents(document_1);\n        }\n    };\n    Editor.prototype.getBlocks = function (pasteContent) {\n        var widgets = [];\n        if (typeof (pasteContent) === 'string') {\n            var startParagraph = this.selection.start.paragraph;\n            if (!this.selection.isForward) {\n                startParagraph = this.selection.end.paragraph;\n            }\n            var arr = [];\n            var txt = pasteContent;\n            txt = txt.replace(/\\r\\n/g, '\\r');\n            arr = txt.split('\\r');\n            for (var i = 0; i < arr.length; i++) {\n                var insertFormat = this.copyInsertFormat(startParagraph.characterFormat, false);\n                var insertParaFormat = this.viewer.selection.copySelectionParagraphFormat();\n                var paragraph = new ParagraphWidget();\n                paragraph.paragraphFormat.copyFormat(insertParaFormat);\n                var line = new LineWidget(paragraph);\n                if (arr[i].length > 0) {\n                    var textElement = new TextElementBox();\n                    textElement.characterFormat.copyFormat(insertFormat);\n                    textElement.text = arr[i];\n                    line.children.push(textElement);\n                    textElement.line = line;\n                }\n                paragraph.childWidgets.push(line);\n                widgets.push(paragraph);\n            }\n        }\n        else {\n            for (var i = 0; i < pasteContent.sections.length; i++) {\n                this.viewer.owner.parser.parseBody(pasteContent.sections[i].blocks, widgets);\n            }\n        }\n        return widgets;\n    };\n    Editor.prototype.pasteContents = function (content) {\n        this.pasteContentsInternal(this.getBlocks(content));\n    };\n    Editor.prototype.pasteContentsInternal = function (widgets) {\n        /* tslint:enable:no-any */\n        var selection = this.viewer.selection;\n        var isRemoved = true;\n        this.initComplexHistory('Paste');\n        if (this.viewer.isListTextSelected) {\n            var paragraph = selection.start.paragraph;\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n            }\n        }\n        this.initHistory('Paste');\n        if (!selection.isEmpty || this.viewer.isListTextSelected) {\n            isRemoved = this.removeSelectedContentInternal(selection, selection.start, selection.end);\n        }\n        if (isRemoved) {\n            this.pasteContent(widgets);\n        }\n        else if (this.editorHistory) {\n            this.editorHistory.currentBaseHistoryInfo = undefined;\n        }\n        if (this.editorHistory && this.editorHistory.currentHistoryInfo) {\n            this.editorHistory.updateHistory();\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.reLayout(selection, selection.isEmpty);\n        }\n    };\n    /* tslint:disable:no-any */\n    Editor.prototype.pasteContent = function (widgets) {\n        /* tslint:enable:no-any */\n        this.viewer.owner.isShiftingEnabled = true;\n        this.updateInsertPosition();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.owner.isPastingContent = true;\n        this.pasteCopiedData(widgets);\n        this.updateEndPosition();\n        this.viewer.owner.isPastingContent = false;\n        this.viewer.selection.fireSelectionChanged(true);\n    };\n    Editor.prototype.pasteCopiedData = function (widgets) {\n        for (var j = 0; j < widgets.length; j++) {\n            var widget = widgets[j];\n            if (widget instanceof ParagraphWidget && widget.childWidgets.length === 0) {\n                widget.childWidgets[0] = new LineWidget(widget);\n            }\n            if (j === widgets.length - 1 && widget instanceof ParagraphWidget) {\n                var newParagraph = widget;\n                if (newParagraph.childWidgets.length > 0\n                    && newParagraph.childWidgets[0].children.length > 0) {\n                    this.insertElement(newParagraph.childWidgets[0].children);\n                }\n            }\n            else if (widget instanceof BlockWidget) {\n                var startParagraph = this.selection.start.paragraph;\n                if (widget instanceof TableWidget && startParagraph.isInsideTable) {\n                    var table = widget;\n                    //Handled to resize table based on parent cell width.\n                    var clientWidth = startParagraph.getContainerWidth();\n                    table.fitCellsToClientArea(clientWidth);\n                }\n                if (widget instanceof TableWidget && startParagraph.isEmpty()\n                    && startParagraph.previousWidget instanceof TableWidget) {\n                    this.insertTableRows(widget, startParagraph.previousWidget);\n                }\n                else {\n                    this.insertBlockInternal(widget);\n                }\n            }\n        }\n    };\n    /**\n     * Insert Table on undo\n     * @param  {WTable} table\n     * @param  {WTable} newTable\n     * @param  {boolean} moveRows\n     * @private\n     */\n    Editor.prototype.insertTableInternal = function (table, newTable, moveRows) {\n        //Gets the index of current table.\n        var insertIndex = table.getIndex();\n        if (moveRows) {\n            //Moves the rows to table.\n            for (var i = 0, index = 0; i < table.childWidgets.length; i++, index++) {\n                var row = table.childWidgets[i];\n                newTable.childWidgets.splice(index, 0, row);\n                row.containerWidget = newTable;\n                table.childWidgets.splice(i, 1);\n                i--;\n            }\n        }\n        var owner = table.containerWidget;\n        this.removeBlock(table);\n        //Inserts table in the current table position.        \n        var blockAdvCollection = owner.childWidgets;\n        blockAdvCollection.splice(insertIndex, 0, newTable);\n        newTable.index = table.index;\n        table.containerWidget = undefined;\n        newTable.containerWidget = owner;\n        newTable.isGridUpdated = false;\n        newTable.buildTableColumns();\n        newTable.isGridUpdated = true;\n        this.viewer.layout.clearTableWidget(newTable, true, true);\n        this.updateNextBlocksIndex(newTable, true);\n        this.viewer.layout.linkFieldInTable(newTable);\n        this.viewer.layout.layoutBodyWidgetCollection(newTable.index, owner, newTable, false);\n    };\n    /**\n     * Insert Table on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @param  {WTable} table\n     * @private\n     */\n    Editor.prototype.insertBlockTable = function (selection, block, table) {\n        var offset = selection.start.offset;\n        var lineIndex = selection.start.paragraph.childWidgets.indexOf(selection.start.currentWidget);\n        if (block instanceof ParagraphWidget && offset > 0) {\n            //Moves the inline items before selection start to the inserted paragraph.\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(selection.start.paragraph, block, 0, 0, selection.start.paragraph.firstChild, offset, selection.start.currentWidget);\n            selection.selectParagraph(selection.start.paragraph, true);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(block, offset.toString()), true);\n            }\n        }\n        if (offset > 0 && this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n        }\n        var index = table.indexInOwner;\n        table.containerWidget.childWidgets.splice(index, 0, block);\n        block.containerWidget = table.containerWidget;\n        block.index = table.index;\n        this.updateNextBlocksIndex(block, true);\n        this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            if (block instanceof TableWidget) {\n                paragraph = selection.getFirstParagraphInFirstCell(block);\n            }\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n    };\n    /**\n     * On cut handle selected content remove and relayout\n     * @param  {Selection} selection\n     * @param  {TextPosition} startPosition\n     * @param  {TextPosition} endPosition\n     * @private\n     */\n    Editor.prototype.handleCut = function (selection) {\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.owner.isShiftingEnabled = true;\n        var blockInfo = this.getParagraphInfo(startPosition);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var image = undefined;\n        if (startPosition.paragraph === endPosition.paragraph && startPosition.offset + 1 === endPosition.offset) {\n            //Gets selected image and copy image to clipboard.\n            var index = 0;\n            var currentInline = startPosition.paragraph.getInline(endPosition.offset, index);\n            var inline = currentInline.element;\n            image = inline;\n        }\n        this.initHistory('Cut');\n        selection.owner.isShiftingEnabled = true;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(selection.editPosition, true);\n            }\n        }\n        this.deleteSelectedContent(endPosition.paragraph, selection, startPosition, endPosition, 3);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            if (this.checkEndPosition(selection)) {\n                this.updateHistoryPosition(selection.end, false);\n            }\n        }\n        this.reLayout(selection);\n    };\n    Editor.prototype.insertInlineInternal = function (element) {\n        var selection = this.selection;\n        var length = element.length;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            var paragraph = selection.start.paragraph;\n            if ((paragraph.paragraphFormat.textAlignment === 'Center' || paragraph.paragraphFormat.textAlignment === 'Right')\n                && paragraph.paragraphFormat.listFormat.listId === -1) {\n                paragraph.x = this.viewer.clientActiveArea.x;\n            }\n            paragraph.childWidgets[0].children.push(element);\n            element.line = paragraph.childWidgets[0];\n            element.linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            this.insertElementInternal(curInline, element, indexInInline, true);\n        }\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElement = function (element) {\n        var selection = this.selection;\n        var length = 0;\n        var paragraph = undefined;\n        var lineIndex = -1;\n        var lineWidget = undefined;\n        var insertIndex = 0;\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        if (selection.start.paragraph.isEmpty()) {\n            paragraph = selection.start.paragraph;\n            lineWidget = paragraph.childWidgets[0];\n            lineIndex = 0;\n        }\n        else {\n            var indexInInline = 0;\n            var inlineObj = selection.start.currentWidget.getInline(selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            paragraph = curInline.line.paragraph;\n            lineIndex = paragraph.childWidgets.indexOf(curInline.line);\n            insertIndex = curInline.indexInOwner;\n            lineWidget = curInline.line;\n            if (indexInInline === curInline.length) { // Add new Element in current \n                insertIndex++;\n            }\n            else if (indexInInline === 0) {\n                if (isNullOrUndefined(curInline.previousNode)) {\n                    insertIndex = 0;\n                }\n            }\n            else {\n                insertIndex++;\n                var prevElement = new TextElementBox();\n                prevElement.characterFormat.copyFormat(curInline.characterFormat);\n                prevElement.text = curInline.text.substring(indexInInline);\n                curInline.text = curInline.text.substr(0, indexInInline);\n                lineWidget.children.splice(insertIndex, 0, prevElement);\n                prevElement.line = curInline.line;\n            }\n        }\n        for (var i = 0; i < element.length; i++) {\n            length += element[i].length;\n            lineWidget.children.splice(insertIndex, 0, element[i]);\n            element[i].line = lineWidget;\n            element[i].linkFieldCharacter(this.viewer);\n            insertIndex++;\n        }\n        this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, 0);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n    };\n    Editor.prototype.insertElementInternal = function (element, newElement, index, relayout) {\n        var line = element.line;\n        var paragraph = line.paragraph;\n        var lineIndex = line.indexInOwner;\n        var insertIndex = element.indexInOwner;\n        if (index === element.length) { // Add new Element in current \n            insertIndex++;\n            line.children.splice(insertIndex, 0, newElement);\n        }\n        else if (index === 0) {\n            if (isNullOrUndefined(element.previousNode)) {\n                element.line.children.splice(0, 0, newElement);\n                insertIndex = 0;\n            }\n            else {\n                element.line.children.splice(insertIndex, 0, newElement);\n            }\n        }\n        else {\n            insertIndex++;\n            var textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(element.characterFormat);\n            textElement.text = element.text.substring(index);\n            element.text = element.text.substr(0, index);\n            line.children.splice(insertIndex, 0, textElement);\n            textElement.line = element.line;\n            //Inserts the new inline.\n            line.children.splice(insertIndex, 0, newElement);\n            insertIndex -= 1;\n        }\n        newElement.line = element.line;\n        newElement.linkFieldCharacter(this.viewer);\n        if (relayout) {\n            this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, insertIndex);\n        }\n    };\n    /**\n     * Insert Block on undo\n     * @param  {Selection} selection\n     * @param  {WBlock} block\n     * @private\n     */\n    Editor.prototype.insertBlock = function (block) {\n        var isRemoved = true;\n        var selection = this.selection;\n        if (!selection.isEmpty) {\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (!isRemoved) {\n            selection.selectContent(selection.start, false);\n        }\n        this.insertBlockInternal(block);\n        if (this.checkInsertPosition(selection)) {\n            var paragraph = undefined;\n            if (block instanceof ParagraphWidget) {\n                paragraph = block;\n            }\n            else {\n                paragraph = this.selection.getFirstParagraphInFirstCell(block);\n            }\n            // tslint:disable-next-line:max-line-length\n            this.updateHistoryPosition(this.getHierarchicalIndex(paragraph, '0'), true);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * Insert new Block on specific index\n     * @param  {Selection} selection\n     * @param  {BlockWidget} block\n     * @private\n     */\n    Editor.prototype.insertBlockInternal = function (block) {\n        var selection = this.selection;\n        var isRemoved = true;\n        var startPara = this.selection.start.paragraph;\n        if (!selection.start.isAtParagraphStart) {\n            if (block instanceof ParagraphWidget) {\n                this.insertNewParagraphWidget(block, false);\n                return;\n            }\n            this.updateInsertPosition();\n            startPara = startPara.combineWidget(this.viewer);\n            // tslint:disable-next-line:max-line-length\n            this.splitParagraph(startPara, startPara.firstChild, 0, selection.start.currentWidget, selection.start.offset, false);\n            selection.selectParagraph(this.selection.start.paragraph, true);\n        }\n        var bodyWidget = selection.start.paragraph.containerWidget;\n        var blockIndex = selection.start.paragraph.index;\n        var insertIndex = bodyWidget.childWidgets.indexOf(selection.start.paragraph);\n        if (!isNullOrUndefined(bodyWidget)) {\n            bodyWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = bodyWidget;\n            block.index = blockIndex;\n            block.height = 0;\n            if (block instanceof TableWidget) {\n                block.isGridUpdated = false;\n                block.buildTableColumns();\n                block.isGridUpdated = true;\n            }\n            this.updateNextBlocksIndex(block, true);\n            this.viewer.layout.layoutBodyWidgetCollection(blockIndex, bodyWidget, block, false);\n        }\n    };\n    /**\n     * Inserts the image with specified size at cursor position in the document editor.\n     * @param {string} imageString  Base64 string, web URL or file URL.\n     * @param {number} width? Image width\n     * @param {number} height? Image height\n     */\n    Editor.prototype.insertImage = function (imageString, width, height) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        if (isNullOrUndefined(width)) {\n            width = 100;\n        }\n        if (isNullOrUndefined(height)) {\n            height = 100;\n        }\n        this.insertPicture(imageString, width, height);\n    };\n    /**\n     * Inserts a table of specified size at cursor position\n     *  in the document editor.\n     * @param {number} rows Default value of â€˜rowsâ€™ parameter is 1.\n     * @param {number} columns Default value of â€˜columnsâ€™ parameter is 1.\n     */\n    Editor.prototype.insertTable = function (rows, columns) {\n        var startPos = this.selection.start;\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        rows = rows || 1;\n        columns = columns || 1;\n        var table = this.createTable(rows, columns);\n        var clientWidth = startPos.paragraph.getContainerWidth();\n        table.splitWidthToTableCells(clientWidth);\n        var prevBlock = startPos.paragraph.previousWidget;\n        if (startPos.currentWidget.isFirstLine() && startPos.offset === 0 && prevBlock instanceof TableWidget) {\n            this.insertTableRows(table, prevBlock);\n            table.destroy();\n            return;\n        }\n        else {\n            this.initHistory('InsertTable');\n            this.viewer.owner.isShiftingEnabled = true;\n            this.insertBlock(table);\n        }\n        var startLine = this.selection.getFirstParagraphInFirstCell(table).childWidgets[0];\n        startPos.setPosition(startLine, true);\n        this.selection.end.setPositionInternal(startPos);\n        var lastParagraph = this.selection.getLastParagraphInLastCell(table);\n        var endOffset = lastParagraph.getLength() + 1;\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            // tslint:disable-next-line:max-line-length\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(lastParagraph, endOffset.toString());\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of rows to the table above or below to the row at cursor position.\n     * @param {boolean} above The above parameter is optional and if omitted,\n     * it takes the value as false and inserts below the row at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertRow = function (above, count) {\n        var rowPlacement = above ? 'Above' : 'Below';\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(rowPlacement === 'Above' ? 'InsertRowAbove' : 'InsertRowBelow');\n            }\n            this.viewer.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0];\n            var endCell = this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0];\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = rowPlacement === 'Below' ? endCell.ownerRow : startCell.ownerRow;\n            if (this.editorHistory) {\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            var rowCount = count ? count : this.getRowCountToInsert();\n            var rows = [];\n            var index = row.rowIndex;\n            if (rowPlacement === 'Below') {\n                index++;\n                var isAffectedByRowSpannedCell = isNullOrUndefined(endCell.previousWidget)\n                    || endCell.columnIndex === endCell.previousWidget.columnIndex + 1;\n                var isRowSpanEnd = endCell.cellIndex !== endCell.columnIndex && isAffectedByRowSpannedCell\n                    && row.rowIndex + startCell.cellFormat.rowSpan - 1 === endCell.ownerRow.rowIndex;\n                if (!isRowSpanEnd) {\n                    if (endCell.cellFormat.rowSpan > 1) {\n                        if (!isNullOrUndefined(row.nextWidget) && row.nextWidget instanceof TableRowWidget) {\n                            endCell.cellFormat.rowSpan += rowCount;\n                            row = row.nextWidget;\n                        }\n                    }\n                }\n            }\n            for (var i = 0; i < rowCount; i++) {\n                var cellCountInfo = this.updateRowspan(row, rowPlacement === 'Below' ? endCell : startCell, rowPlacement);\n                var newRow = this.createRowAndColumn(cellCountInfo.count, i);\n                newRow.rowFormat.copyFormat(row.rowFormat);\n                this.updateCellFormatForInsertedRow(newRow, cellCountInfo.cellFormats);\n                rows.push(newRow);\n            }\n            table.insertTableRowsInternal(rows, index);\n            var cell = undefined;\n            var paragraph = undefined;\n            if ((table.childWidgets[index] instanceof TableRowWidget)) {\n                cell = table.childWidgets[index].firstChild;\n                paragraph = this.selection.getFirstParagraph(cell);\n            }\n            else {\n                var widget = undefined;\n                while (!(widget instanceof TableWidget)) {\n                    widget = table.nextRenderedWidget;\n                }\n                paragraph = this.selection.getFirstParagraphInFirstCell(widget);\n            }\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.selectParagraph(paragraph, true);\n        }\n        this.reLayout(this.selection, true);\n    };\n    Editor.prototype.updateCellFormatForInsertedRow = function (newRow, cellFormats) {\n        for (var i = 0; i < newRow.childWidgets.length; i++) {\n            newRow.childWidgets[i].cellFormat.copyFormat(cellFormats[i]);\n            newRow.childWidgets[i].cellFormat.rowSpan = 1;\n        }\n    };\n    Editor.prototype.updateRowspan = function (row, startCell, rowPlacement) {\n        var spannedCells = row.getPreviousRowSpannedCells(true);\n        var count = 0;\n        var cellFormats = [];\n        for (var i = 0; i < row.childWidgets.length; i++) {\n            var cell = row.childWidgets[i];\n            var isCellIncluded = false;\n            // Need to check with all the row spanned cells. if the start cell contains rowspan greater than 1, \n            // and when inserting below, need to increment rowspan for all row spanned cells by 1 except\n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            // and when inserting above, if cloned cell placed in the same row of start cell or\n            // if the cloned cell has equal column index, need to skip updating rowspan value of cloned cell.\n            // else update row span value for spanned cell except \n            // if the spanned cells is placed in the same column or cell to be cloned has the same row index of cloned cell row index.\n            var isRowSpanned = (isNullOrUndefined(cell.previousWidget)\n                || cell.columnIndex !== cell.previousWidget.columnIndex + 1);\n            for (var j = 0; j < spannedCells.length; j++) {\n                if (isRowSpanned) {\n                    var spannedCell = spannedCells[j];\n                    var clonedRowIndex = spannedCell.ownerRow.rowIndex + spannedCell.cellFormat.rowSpan - 1;\n                    if (cell.columnIndex < spannedCell.columnIndex && cell.cellIndex !== cell.columnIndex) {\n                        isCellIncluded = true;\n                        count++;\n                        cellFormats.push(cell.cellFormat);\n                    }\n                    if (startCell.cellFormat.rowSpan === 1) {\n                        // Need to check whether cell is affected by a row spanned cell. if cell is placed on the row where it is affected \n                        // by row spanned cell, then if we are inserting row below, need to add new cell with spanned cell width\n                        // or if we are inserting above, need to update row span value of the spanned cell.\n                        // if cell is placed inbetween the spanned cell , \n                        // then if we are inserting below, need to update row span value of spanned cell or\n                        // if we are inserting above, need to skip updating row span value except\n                        // if start cell is placed on the same row of spanned cell or if start cell placed in the same column.\n                        if (clonedRowIndex > cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above'\n                                && spannedCell.ownerRow === startCell.ownerRow) {\n                                continue;\n                            }\n                            else {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                        else if (cell.cellIndex !== cell.columnIndex && isRowSpanned && clonedRowIndex === cell.ownerRow.rowIndex) {\n                            if (rowPlacement === 'Above') {\n                                spannedCell.cellFormat.rowSpan += 1;\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                            else {\n                                count++;\n                                cellFormats.push(spannedCell.cellFormat);\n                                spannedCells.splice(j, 1);\n                                j--;\n                            }\n                        }\n                    }\n                    else {\n                        if (spannedCell !== startCell) {\n                            if (rowPlacement === 'Above'\n                                && (spannedCell.ownerRow === startCell.ownerRow || spannedCell.columnIndex === startCell.columnIndex)) {\n                                continue;\n                            }\n                            else {\n                                if (spannedCell.columnIndex !== startCell.columnIndex\n                                    && spannedCell.ownerRow.rowIndex !== cell.ownerRow.rowIndex\n                                    && (clonedRowIndex > startCell.ownerRow.rowIndex\n                                        || (rowPlacement === 'Above' && clonedRowIndex === startCell.ownerRow.rowIndex))) {\n                                    spannedCell.cellFormat.rowSpan += 1;\n                                    spannedCells.splice(j, 1);\n                                    j--;\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            if (spannedCells.indexOf(cell) === -1 && cell.cellFormat.rowSpan > 1) {\n                isCellIncluded = true;\n            }\n            if (!isCellIncluded) {\n                count++;\n                cellFormats.push(cell.cellFormat);\n            }\n        }\n        return { count: count, cellFormats: cellFormats };\n    };\n    Editor.prototype.insertTableRows = function (table, prevBlock) {\n        this.initHistory('InsertRowBelow');\n        table.containerWidget = prevBlock.containerWidget;\n        prevBlock = prevBlock.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(prevBlock);\n        }\n        var row = prevBlock.childWidgets[prevBlock.childWidgets.length - 1];\n        prevBlock.insertTableRowsInternal(table.childWidgets, prevBlock.childWidgets.length);\n        var paragraph = this.selection.getFirstParagraph(row.nextWidget.childWidgets[0]);\n        this.viewer.layout.reLayoutTable(prevBlock);\n        this.selection.selectParagraph(paragraph, true);\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n            this.updateHistoryPosition(this.selection.start, true);\n            this.updateHistoryPosition(this.selection.end, false);\n        }\n        this.reLayout(this.selection);\n    };\n    /**\n     * Inserts the specified number of columns to the table left or right to the column at cursor position.\n     * @param {number} left The left parameter is optional and if omitted, it takes the value as false and\n     * inserts to the right of column at cursor position.\n     * @param {number} count The count parameter is optional and if omitted, it takes the value as 1.\n     */\n    Editor.prototype.insertColumn = function (left, count) {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var columnPlacement = left ? 'Left' : 'Right';\n        if (this.selection.start.paragraph.isInsideTable) {\n            if (this.checkIsNotRedoing()) {\n                this.initHistory(columnPlacement === 'Left' ? 'InsertColumnLeft' : 'InsertColumnRight');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerRow.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory) {\n                //Clones the entire table to preserve in history.\n                var clonedTable = this.cloneTableToHistoryInfo(table);\n            }\n            this.selection.owner.isLayoutEnabled = false;\n            var cellIndex = startCell.columnIndex;\n            if (columnPlacement === 'Right') {\n                cellIndex = endCell.columnIndex + endCell.cellFormat.columnSpan;\n            }\n            var startParagraph = undefined;\n            var newCell = undefined;\n            var columnCount = count ? count : this.getColumnCountToInsert();\n            var rowSpannedCells = [];\n            var rowSpanCellIndex = cellIndex;\n            for (var i = 0; i < columnCount; i++) {\n                for (var j = 0; j < table.childWidgets.length; j++) {\n                    var row = table.childWidgets[j];\n                    newCell = this.createColumn(this.selection.getLastParagraph(startCell));\n                    newCell.index = j;\n                    newCell.rowIndex = row.rowIndex;\n                    newCell.containerWidget = row;\n                    newCell.cellFormat.copyFormat(startCell.cellFormat);\n                    newCell.cellFormat.rowSpan = 1;\n                    if (isNullOrUndefined(startParagraph)) {\n                        startParagraph = this.selection.getFirstParagraph(newCell);\n                    }\n                    if (cellIndex === 0) {\n                        row.childWidgets.splice(cellIndex, 0, newCell);\n                    }\n                    else {\n                        var isCellInserted = false;\n                        for (var j_1 = 0; j_1 < row.childWidgets.length; j_1++) {\n                            var rowCell = row.childWidgets[j_1];\n                            // Add the row spanned cells to colection for adding column before / after row spnned cells.\n                            if (rowCell.cellFormat.rowSpan > 1) {\n                                rowSpannedCells.push(rowCell);\n                            }\n                            if (rowCell.columnIndex + rowCell.cellFormat.columnSpan === cellIndex) {\n                                row.childWidgets.splice(rowCell.cellIndex + 1, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            else if (cellIndex > rowCell.columnIndex && rowCell.columnIndex + rowCell.cellFormat.columnSpan > cellIndex\n                                && cellIndex < rowCell.columnIndex + rowCell.cellFormat.columnSpan) {\n                                row.childWidgets.splice(rowCell.cellIndex, 0, newCell);\n                                isCellInserted = true;\n                            }\n                            if (isCellInserted) {\n                                break;\n                            }\n                        }\n                        // If the cell is not inserted for row, then check for row spanned cells.\n                        if (!isCellInserted) {\n                            if (rowSpannedCells.length > 0) {\n                                for (var k = 0; k < rowSpannedCells.length; k++) {\n                                    var rowSpannedCell = rowSpannedCells[k];\n                                    if (rowSpannedCell.ownerRow !== row\n                                        && row.rowIndex <= rowSpannedCell.ownerRow.rowIndex + rowSpannedCell.cellFormat.rowSpan - 1) {\n                                        if (rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan === cellIndex) {\n                                            if (rowSpannedCell.cellIndex > row.childWidgets.length) {\n                                                row.childWidgets.push(newCell);\n                                            }\n                                            else {\n                                                row.childWidgets.splice(rowSpannedCell.cellIndex, 0, newCell);\n                                            }\n                                            isCellInserted = true;\n                                        }\n                                        else if (cellIndex > rowSpannedCell.columnIndex &&\n                                            rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan > cellIndex\n                                            && cellIndex < rowSpannedCell.columnIndex + rowSpannedCell.cellFormat.columnSpan) {\n                                            row.childWidgets.splice(rowSpannedCell.columnIndex, 0, newCell);\n                                            isCellInserted = true;\n                                        }\n                                    }\n                                    if (isCellInserted) {\n                                        break;\n                                    }\n                                }\n                            }\n                        }\n                    }\n                }\n            }\n            table.updateRowIndex(0);\n            var parentTable = this.viewer.layout.getParentTable(table);\n            if (parentTable) {\n                parentTable.fitChildToClientArea();\n            }\n            else {\n                table.fitChildToClientArea();\n            }\n            this.selection.owner.isLayoutEnabled = true;\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n            this.selection.start.setPosition(startParagraph.firstChild, true);\n            this.selection.end.setPosition(this.selection.getLastParagraph(newCell).firstChild, false);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Creates table with specified rows and columns.\n     * @private\n     */\n    Editor.prototype.createTable = function (rows, columns) {\n        var startPara = this.selection.start.paragraph;\n        var table = new TableWidget();\n        table.tableFormat = new WTableFormat(table);\n        table.tableFormat.preferredWidthType = 'Auto';\n        table.tableFormat.initializeTableBorders();\n        var index = 0;\n        while (index < rows) {\n            var tableRow = this.createRowAndColumn(columns, index);\n            tableRow.rowFormat.heightType = 'Auto';\n            tableRow.containerWidget = table;\n            table.childWidgets.push(tableRow);\n            index++;\n        }\n        return table;\n    };\n    Editor.prototype.createRowAndColumn = function (columns, rowIndex) {\n        var startPara = this.selection.start.paragraph;\n        var tableRow = new TableRowWidget();\n        tableRow.rowFormat = new WRowFormat(tableRow);\n        tableRow.index = rowIndex;\n        for (var i = 0; i < columns; i++) {\n            var tableCell = this.createColumn(startPara);\n            tableCell.index = i;\n            tableCell.rowIndex = rowIndex;\n            tableCell.containerWidget = tableRow;\n            tableRow.childWidgets.push(tableCell);\n        }\n        return tableRow;\n    };\n    Editor.prototype.createColumn = function (paragraph) {\n        var tableCell = new TableCellWidget();\n        var para = new ParagraphWidget();\n        para.paragraphFormat.copyFormat(paragraph.paragraphFormat);\n        para.characterFormat.copyFormat(paragraph.characterFormat);\n        para.containerWidget = tableCell;\n        tableCell.childWidgets.push(para);\n        tableCell.cellFormat = new WCellFormat(tableCell);\n        return tableCell;\n    };\n    Editor.prototype.getColumnCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (start && end && this.selection.getTable(start, end)) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell) {\n                return count = 1;\n            }\n            if (start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = count + end.paragraph.associatedCell.cellIndex - start.paragraph.associatedCell.cellIndex;\n            }\n            else {\n                count = 0;\n                // tslint:disable-next-line:max-line-length\n                var selectedCells = start.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(start.paragraph.associatedCell, end.paragraph.associatedCell);\n                for (var i = 0; i < selectedCells.length; i++) {\n                    if (start.paragraph.associatedCell.ownerRow === selectedCells[i].ownerRow) {\n                        count++;\n                    }\n                }\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getRowCountToInsert = function () {\n        var count = 1;\n        var start = this.selection.start;\n        var end = this.selection.end;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        if (!isNullOrUndefined(start) && !isNullOrUndefined(end) && !isNullOrUndefined(this.selection.getTable(start, end))) {\n            if (start.paragraph.associatedCell === end.paragraph.associatedCell ||\n                start.paragraph.associatedCell.ownerRow === end.paragraph.associatedCell.ownerRow) {\n                return count = 1;\n            }\n            else {\n                return count = count +\n                    this.getOwnerRow(!this.selection.isForward).rowIndex - this.getOwnerRow(this.selection.isForward).rowIndex;\n            }\n        }\n        return count === 0 ? 1 : count;\n    };\n    Editor.prototype.getOwnerCell = function (isStart) {\n        var cell = undefined;\n        var startCell = isStart ? this.selection.start.paragraph.associatedCell\n            : this.selection.end.paragraph.associatedCell;\n        var endCell = isStart ? this.selection.end.paragraph.associatedCell\n            : this.selection.start.paragraph.associatedCell;\n        cell = startCell;\n        var owner = cell.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endCell.ownerTable) {\n            cell = owner.containerWidget;\n            owner = cell.ownerTable;\n        }\n        return cell;\n    };\n    Editor.prototype.getOwnerRow = function (isStart) {\n        var row;\n        var startRow = isStart ? this.selection.start.paragraph.associatedCell.ownerRow\n            : this.selection.end.paragraph.associatedCell.ownerRow;\n        var endRow = isStart ? this.selection.end.paragraph.associatedCell.ownerRow\n            : this.selection.start.paragraph.associatedCell.ownerRow;\n        row = startRow;\n        var owner = row.ownerTable;\n        while (!isNullOrUndefined(owner) && owner.containerWidget instanceof TableCellWidget && owner !== endRow.ownerTable) {\n            row = owner.containerWidget.ownerRow;\n            owner = row.ownerTable;\n        }\n        return row;\n    };\n    Editor.prototype.getOwnerTable = function (isStart) {\n        var table = undefined;\n        var startTable = this.selection.start.paragraph.associatedCell.ownerTable;\n        var endTable = this.selection.end.paragraph.associatedCell.ownerTable;\n        table = isStart ? startTable : endTable;\n        while (table.containerWidget instanceof TableCellWidget && table !== (isStart ? endTable : startTable)) {\n            table = table.containerWidget.ownerTable;\n        }\n        return table;\n    };\n    /**\n     * Merge Selected cells\n     * @private\n     */\n    Editor.prototype.mergeSelectedCellsInTable = function () {\n        if (!this.canMergeCells()) {\n            return;\n        }\n        if (this.checkIsNotRedoing()) {\n            this.initHistory('MergeCells');\n        }\n        this.selection.owner.isShiftingEnabled = true;\n        var startPosition = this.selection.start;\n        var endPosition = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosition = this.selection.end;\n            endPosition = this.selection.start;\n        }\n        var startOwnerCell = this.getOwnerCell(this.selection.isForward);\n        var endOwnerCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startOwnerCell, endOwnerCell);\n        if (containerCell.ownerTable.contains(endOwnerCell)) {\n            if (!this.selection.containsCell(containerCell, endOwnerCell)) {\n                //Start and End are in different cells.               \n                var table = startOwnerCell.ownerTable.combineWidget(this.viewer);\n                startOwnerCell = this.selection.getSelectedCell(startOwnerCell, containerCell);\n                endOwnerCell = this.selection.getSelectedCell(endOwnerCell, containerCell);\n                //Merges the selected cells.               \n                var mergedCell = this.mergeSelectedCells(table, startOwnerCell, endOwnerCell);\n                var lastParagraph = this.selection.getLastParagraph(mergedCell);\n                endPosition.setPosition(lastParagraph.lastChild, false);\n            }\n        }\n        if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n            this.reLayout(this.selection, false);\n        }\n    };\n    Editor.prototype.mergeSelectedCells = function (table, startCell, endCell) {\n        //Clones the entire table to preserve in history.\n        var clonedTable = this.cloneTableToHistoryInfo(table);\n        this.selection.owner.isLayoutEnabled = false;\n        //Merges the selected cells.\n        var start = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var end = start + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(start, end, endCellLeft, endCellRight);\n        start = cellInfo.start;\n        end = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var mergedCell = undefined;\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (HelperMethods.round(start, 2) <= HelperMethods.round(cellStart, 2)\n                    && HelperMethods.round(cellStart, 2) < HelperMethods.round(end, 2)) {\n                    if (isNullOrUndefined(mergedCell)) {\n                        mergedCell = cell;\n                    }\n                    else {\n                        if (i === rowStartIndex) {\n                            mergedCell.cellFormat.preferredWidth += cell.cellFormat.preferredWidth;\n                            mergedCell.cellFormat.columnSpan += cell.cellFormat.columnSpan;\n                            this.mergeBorders(mergedCell, cell);\n                        }\n                        for (var k = 0; k < cell.childWidgets.length; k++) {\n                            var block = cell.childWidgets[k];\n                            if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget\n                                && block.childWidgets.length === 0) {\n                                break;\n                            }\n                            mergedCell.childWidgets.push(block.clone());\n                        }\n                        row.childWidgets.splice(j, 1);\n                        cell.destroy();\n                        j--;\n                    }\n                }\n            }\n            if (row.childWidgets.length === 0) {\n                var rowIndex = table.childWidgets.indexOf(row);\n                row.updateRowBySpannedCells();\n                table.childWidgets.splice(rowIndex, 1);\n                row.destroy();\n                count--;\n                i--;\n            }\n        }\n        if (!isNullOrUndefined(mergedCell) && rowStartIndex < count) {\n            mergedCell.cellFormat.rowSpan = count - rowStartIndex + 1;\n        }\n        this.updateBlockIndexAfterMerge(mergedCell);\n        table.updateRowIndex(0);\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n        //Layouts the table after merging cells.\n        this.selection.owner.isLayoutEnabled = true;\n        return mergedCell;\n    };\n    Editor.prototype.mergeBorders = function (mergedCell, tableCell) {\n        var mergedCellborders = undefined;\n        var cellBorders = null;\n        if (!isNullOrUndefined(mergedCell.cellFormat.borders)) {\n            mergedCellborders = mergedCell.cellFormat.borders;\n        }\n        if (!isNullOrUndefined(tableCell.cellFormat.borders)) {\n            cellBorders = tableCell.cellFormat.borders;\n        }\n        if (isNullOrUndefined(mergedCellborders) && isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        if (isNullOrUndefined(mergedCellborders)) {\n            mergedCellborders = new WBorders(mergedCell.cellFormat);\n            mergedCellborders.copyFormat(cellBorders);\n        }\n        else if (isNullOrUndefined(cellBorders)) {\n            return;\n        }\n        else {\n            if (mergedCell.ownerRow.rowIndex === tableCell.ownerRow.rowIndex) {\n                mergedCellborders.top = mergedCell.getBorderBasedOnPriority(mergedCellborders.top, cellBorders.bottom);\n                mergedCellborders.bottom = mergedCell.getBorderBasedOnPriority(mergedCellborders.bottom, cellBorders.bottom);\n            }\n        }\n    };\n    Editor.prototype.updateBlockIndexAfterMerge = function (cell) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            cell.childWidgets[i].index = i;\n        }\n    };\n    /**\n     * Determines whether merge cell operation can be done.\n     */\n    Editor.prototype.canMergeCells = function () {\n        if (this.selection.isEmpty || !this.selection.start.paragraph.isInsideTable || !this.selection.end.paragraph.isInsideTable) {\n            return false;\n        }\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var startCell = this.getOwnerCell(this.selection.isForward);\n        var endCell = this.getOwnerCell(!this.selection.isForward);\n        var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n        if (containerCell.ownerTable.contains(endCell)) {\n            if (!this.selection.containsCell(containerCell, endCell)) {\n                startCell = this.selection.getSelectedCell(startCell, containerCell);\n                endCell = this.selection.getSelectedCell(endCell, containerCell);\n                var rowSpan = 1;\n                if (startCell.ownerRow === endCell.ownerRow) {\n                    var startCellIndex = startCell.ownerRow.childWidgets.indexOf(startCell);\n                    for (var i = startCellIndex; i <= startCell.ownerRow.childWidgets.indexOf(endCell); i++) {\n                        var cell = startCell.ownerRow.childWidgets[i];\n                        var prevCell = cell.previousWidget;\n                        if (i !== startCellIndex) {\n                            if (cell.cellFormat.rowSpan !== rowSpan) {\n                                return false;\n                            }\n                            if (!isNullOrUndefined(prevCell)\n                                && cell.columnIndex !== (prevCell.cellFormat.columnSpan + prevCell.columnIndex)) {\n                                return false;\n                            }\n                        }\n                        rowSpan = cell.cellFormat.rowSpan;\n                    }\n                    return true;\n                }\n                return this.canMergeSelectedCellsInTable(startCell.ownerTable, startCell, endCell);\n            }\n        }\n        return false;\n    };\n    Editor.prototype.canMergeSelectedCellsInTable = function (table, startCell, endCell) {\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var rowStartIndex = table.childWidgets.indexOf(startCell.ownerRow);\n        var startLeft = this.selection.getCellLeft(startCell.ownerRow, startCell);\n        var endLeft = startLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = this.selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startLeft, endLeft, endCellLeft, endCellRight);\n        startLeft = cellInfo.start;\n        endLeft = cellInfo.end;\n        var selectionLeft = 0;\n        var selectionRight = 0;\n        var isRowLeftWithinSel = false;\n        var isRowRightWithinSel = false;\n        var rowSpannedCells = [];\n        for (var i = rowStartIndex; i <= count; i++) {\n            var row = table.childWidgets[i];\n            var rowLeft = 0;\n            var rowRight = 0;\n            var isStarted = false;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellStart = this.selection.getCellLeft(row, cell);\n                if (this.checkCellWithInSelection(startLeft, endLeft, cellStart)) {\n                    isRowLeftWithinSel = false;\n                    isRowRightWithinSel = false;\n                    if (cell.cellFormat.rowSpan > 1) {\n                        rowSpannedCells.push(cell);\n                    }\n                    if (!isStarted) {\n                        rowLeft = cellStart;\n                        rowRight = cellStart;\n                        isStarted = true;\n                    }\n                    var prevCell = cell.previousWidget;\n                    if (rowRight !== 0 && HelperMethods.round(rowRight, 0) !== HelperMethods.round(cellStart, 0)) {\n                        rowRight = cellStart;\n                    }\n                    rowRight += HelperMethods.convertPointToPixel(cell.cellFormat.cellWidth);\n                    var isPrevCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, true);\n                    var isNextCellWithinSel = this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false);\n                    // When selected cell not having row spanned cells and column index is not having immediate cell index value,\n                    // then returned false.\n                    var isNoRowSpan = rowSpannedCells.length === 0 || rowSpannedCells.length === 1 && rowSpannedCells[0] === cell;\n                    // checks whether current cell is with in selection.\n                    var isCellWithInSel = this.checkCurrentCell(rowSpannedCells, cell, isPrevCellWithinSel, isNextCellWithinSel);\n                    // when last selected row not having equal row span then returned false.\n                    if (i === count && !isNullOrUndefined(prevCell) && cell.cellFormat.rowSpan > prevCell.cellFormat.rowSpan\n                        && !isCellWithInSel) {\n                        return false;\n                    }\n                    if (i !== rowStartIndex) {\n                        for (var m = 0; m < rowSpannedCells.length; m++) {\n                            {\n                                var rowSpan = (rowSpannedCells[m].ownerRow.rowIndex + rowSpannedCells[m].cellFormat.rowSpan) - 1;\n                                if (rowSpan >= row.rowIndex) {\n                                    if (rowSpannedCells[m].columnIndex > cell.columnIndex) {\n                                        isRowRightWithinSel = true;\n                                    }\n                                    else {\n                                        isRowLeftWithinSel = true;\n                                    }\n                                    if (i === count && rowSpannedCells[m] !== cell\n                                        && rowSpan > (cell.ownerRow.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                                        return false;\n                                    }\n                                    if (rowSpan === row.rowIndex && !this.checkPrevOrNextCellIsWithinSel(startLeft, endLeft, cell, false)) {\n                                        rowSpannedCells.splice(rowSpannedCells.indexOf(rowSpannedCells[m]), 1);\n                                    }\n                                }\n                            }\n                        }\n                    }\n                    if (isPrevCellWithinSel && !isNullOrUndefined(prevCell)\n                        && isNoRowSpan\n                        && (cell.columnIndex !== prevCell.columnIndex + 1 && this.checkCellWidth(cell))) {\n                        return false;\n                    }\n                }\n            }\n            if (i === rowStartIndex) {\n                selectionLeft = rowLeft;\n                selectionRight = rowRight;\n            }\n            else {\n                if (rowRight > 0 && rowLeft > 0) {\n                    if (!((isRowLeftWithinSel || Math.round(selectionLeft) === Math.round(rowLeft))\n                        && (isRowRightWithinSel || Math.round(selectionRight) === Math.round(rowRight)))) {\n                        return false;\n                    }\n                }\n                if (i === count) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkCellWidth = function (cell) {\n        var prevCell = cell.previousWidget;\n        var cellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, cell);\n        var prevCellLeft = this.viewer.selection.getCellLeft(cell.ownerRow, prevCell);\n        var left = prevCellLeft + HelperMethods.convertPointToPixel(prevCell.cellFormat.cellWidth);\n        if (HelperMethods.round(left, 2) !== HelperMethods.round(cellLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkCellWithInSelection = function (startLeft, endLeft, cellStart) {\n        if (HelperMethods.round(startLeft, 2) <= HelperMethods.round(cellStart, 2)\n            && HelperMethods.round(cellStart, 2) < HelperMethods.round(endLeft, 2)) {\n            return true;\n        }\n        return false;\n    };\n    ;\n    Editor.prototype.checkPrevOrNextCellIsWithinSel = function (startLeft, endLeft, cell, isPrev) {\n        var prevOrNextCell = isPrev ? cell.previousWidget : cell.nextWidget;\n        var cellStart = 0;\n        if (isNullOrUndefined(prevOrNextCell)) {\n            return false;\n        }\n        cellStart = this.viewer.selection.getCellLeft(prevOrNextCell.ownerRow, prevOrNextCell);\n        return this.checkCellWithInSelection(startLeft, endLeft, cellStart);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.checkCurrentCell = function (rowSpannedCells, cell, isPrevCellWithInSel, isNextCellWithinSel) {\n        var cellOwner = cell.ownerRow;\n        if (rowSpannedCells.length > 0) {\n            for (var i = 0; i < rowSpannedCells.length; i++) {\n                var spannedCellOwner = rowSpannedCells[i].ownerRow;\n                var rowSpan = (spannedCellOwner.rowIndex + rowSpannedCells[i].cellFormat.rowSpan) - 1;\n                if (rowSpannedCells[i] === cell && (rowSpannedCells.length === 1 || this.checkRowSpannedCells(rowSpannedCells, cell))\n                    && !(isNextCellWithinSel || isPrevCellWithInSel)) {\n                    return true;\n                }\n                if (rowSpannedCells[i] !== cell && spannedCellOwner.rowIndex < cellOwner.rowIndex\n                    && rowSpan === (cellOwner.rowIndex + cell.cellFormat.rowSpan - 1)) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.checkRowSpannedCells = function (rowSpannedCells, cell) {\n        for (var i = 0; i < rowSpannedCells.length; i++) {\n            if (rowSpannedCells[i] !== cell && rowSpannedCells[i].columnIndex === cell.columnIndex) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertNewParagraphWidget = function (newParagraph, insertAfter) {\n        this.updateInsertPosition();\n        this.insertParagraph(newParagraph, insertAfter);\n        if (!insertAfter) {\n            var nextParagraph = void 0;\n            var currentParagraph = newParagraph;\n            do {\n                nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n                currentParagraph = nextParagraph;\n            } while (nextParagraph && nextParagraph.equals(newParagraph));\n            if (!isNullOrUndefined(nextParagraph)) {\n                this.selection.selectParagraph(nextParagraph, true);\n            }\n            else {\n                this.selection.selectParagraph(newParagraph, true);\n            }\n        }\n        this.fireContentChange();\n    };\n    Editor.prototype.insertParagraph = function (newParagraph, insertAfter) {\n        var lineWidget = this.selection.start.currentWidget;\n        var offset = this.selection.start.offset;\n        var currentParagraph = this.selection.start.paragraph;\n        currentParagraph = currentParagraph.combineWidget(this.viewer);\n        if (insertAfter) {\n            // tslint:disable-next-line:max-line-length\n            var length_1 = this.selection.getLineLength(currentParagraph.lastChild);\n            var insertIndex_1 = newParagraph.firstChild ? newParagraph.firstChild.children.length : 0;\n            // tslint:disable-next-line:max-line-length\n            this.moveInlines(currentParagraph, newParagraph, insertIndex_1, offset, lineWidget, length_1, currentParagraph.lastChild);\n        }\n        else if (offset > 0) {\n            this.moveInlines(currentParagraph, newParagraph, 0, 0, currentParagraph.firstChild, offset, lineWidget);\n        }\n        var splittedWidget = currentParagraph.getSplitWidgets();\n        currentParagraph = insertAfter ? splittedWidget[splittedWidget.length - 1] : splittedWidget[0];\n        var insertIndex = currentParagraph.containerWidget.childWidgets.indexOf(currentParagraph);\n        if (insertAfter) {\n            insertIndex++;\n        }\n        var bodyWidget = currentParagraph.containerWidget;\n        newParagraph.index = currentParagraph.index;\n        newParagraph.containerWidget = bodyWidget;\n        bodyWidget.childWidgets.splice(insertIndex, 0, newParagraph);\n        this.updateNextBlocksIndex(insertAfter ? currentParagraph : newParagraph, true);\n        newParagraph.height = 0;\n        this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, bodyWidget, newParagraph, false);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.moveInlines = function (currentParagraph, newParagraph, insertIndex, startOffset, startLine, endOffset, endLine) {\n        if (newParagraph.childWidgets.length === 0) {\n            var line = new LineWidget(newParagraph);\n            newParagraph.childWidgets.push(line);\n        }\n        var isMoved = false;\n        this.viewer.layout.clearListElementBox(currentParagraph);\n        this.viewer.layout.clearListElementBox(newParagraph);\n        for (var j = 0; j < currentParagraph.childWidgets.length; j++) {\n            var lineWidget = currentParagraph.childWidgets[j];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, startOffset, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            if (endLine === lineWidget) {\n                insertIndex = this.moveContent(lineWidget, 0, endOffset, insertIndex, newParagraph);\n                break;\n            }\n            else if (startLine === lineWidget) {\n                isMoved = true;\n                // tslint:disable-next-line:max-line-length\n                insertIndex = this.moveContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n            else if (isMoved) {\n                insertIndex = this.moveContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget), insertIndex, newParagraph);\n            }\n        }\n        this.removeEmptyLine(currentParagraph);\n        if (!currentParagraph.isInsideTable) {\n            this.viewer.layout.reLayoutParagraph(currentParagraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    //tslint:disable-next-line:max-line-length\n    Editor.prototype.moveContent = function (lineWidget, startOffset, endOffset, insertIndex, paragraph) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (startOffset >= count + inline.length || inline instanceof ListTextElementBox) {\n                if (!(inline instanceof ListTextElementBox)) {\n                    count += inline.length;\n                }\n                continue;\n            }\n            var startIndex = 0;\n            if (startOffset > count) {\n                startIndex = startOffset - count;\n            }\n            var endIndex = endOffset - count;\n            if (endIndex > inline.length) {\n                endIndex = inline.length;\n            }\n            if (startIndex > 0) {\n                count += startIndex;\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                paragraph.firstChild.children.splice(insertIndex, 0, inline);\n                inline.line = paragraph.firstChild;\n                insertIndex++;\n                // if (editAction < 4) {\n                // this.unLinkFieldCharacter(inline);\n                lineWidget.children.splice(i, 1);\n                i--;\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                paragraph.firstChild.children.splice(insertIndex, 0, span);\n                span.line = paragraph.firstChild;\n                insertIndex++;\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (endOffset <= count + endIndex - startIndex) {\n                break;\n            }\n            count += endIndex - startIndex;\n        }\n        return insertIndex;\n    };\n    /**\n     * update complex changes when history is not preserved\n     * @param  {number} action?\n     * @param  {string} start?\n     * @param  {string} end?\n     * @private\n     */\n    Editor.prototype.updateComplexWithoutHistory = function (action, start, end) {\n        var selection = this.viewer.selection;\n        if (action === 0) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            this.setPositionForCurrentIndex(selection.start, end);\n            this.setPositionForCurrentIndex(selection.end, end);\n        }\n        if (action === 1) {\n            var startPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(startPosition, start);\n            var endPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(endPosition, end);\n            this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n            if (endPosition.paragraph !== startPosition.paragraph) {\n                this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n            }\n        }\n        if (selection.owner.isShiftingEnabled) {\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.viewer.updateScrollBars();\n        this.fireContentChange();\n        this.isHandledComplex = true;\n    };\n    /**\n     * reLayout\n     * @param selection\n     * @param isSelectionChanged\n     * @private\n     */\n    Editor.prototype.reLayout = function (selection, isSelectionChanged) {\n        if (!this.viewer.isComposingIME && this.editorHistory && this.editorHistory.isHandledComplexHistory()) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n                || (this.editorHistory.currentBaseHistoryInfo\n                    && !(this.editorHistory.currentBaseHistoryInfo.action === 'ClearCharacterFormat'\n                        || this.editorHistory.currentBaseHistoryInfo.action === 'ClearParagraphFormat'))) {\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n            this.isHandledComplex = false;\n            return;\n        }\n        if (isNullOrUndefined(this.viewer.blockToShift)) {\n            this.viewer.removeEmptyPages();\n            this.viewer.layout.updateFieldElements();\n            this.viewer.updateScrollBars();\n            if (!selection.owner.isShiftingEnabled) {\n                selection.fireSelectionChanged(true);\n                this.startParagraph = undefined;\n                this.endParagraph = undefined;\n            }\n        }\n        if (isNullOrUndefined(isSelectionChanged)) {\n            isSelectionChanged = selection.isEmpty;\n        }\n        if (selection.owner.isShiftingEnabled) {\n            selection.owner.isShiftingEnabled = false;\n            selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.shiftLayoutedItems();\n            if (this.viewer.owner.enableHeaderAndFooter) {\n                this.updateHeaderFooterWidget();\n            }\n            this.getOffsetValue(selection);\n            selection.upDownSelectionLength = selection.end.location.x;\n            selection.fireSelectionChanged(true);\n            this.viewer.updateFocus();\n            this.startParagraph = undefined;\n            this.endParagraph = undefined;\n            this.viewer.layout.allowLayout = true;\n        }\n        if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo &&\n            ((this.editorHistory.currentBaseHistoryInfo.action !== 'RowResizing'\n                && this.editorHistory.currentBaseHistoryInfo.action !== 'CellResizing')\n                || (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n            if (this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                this.editorHistory.currentBaseHistoryInfo.updateSelection();\n            }\n            this.editorHistory.updateHistory();\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidget = function () {\n        this.updateHeaderFooterWidgetToPage(this.selection.start.paragraph.bodyWidget);\n        this.shiftPageContent(this.selection.start.paragraph.bodyWidget);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPage = function (node) {\n        var currentPage = node.page;\n        node = this.viewer.layout.updateHeaderFooterToParent(node);\n        var isEvenPage = (node.headerFooterType === 'EvenHeader' || node.headerFooterType === 'EvenFooter');\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var page = this.viewer.pages[i];\n            if ((i + 1 === 1) && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') !== -1) {\n                return;\n            }\n            if (page.index === 0 && page.bodyWidgets[0].sectionFormat.differentFirstPage &&\n                node.headerFooterType.indexOf('FirstPage') === -1) {\n                continue;\n            }\n            if (currentPage !== page) {\n                if (page.bodyWidgets[0].sectionFormat.differentOddAndEvenPages) {\n                    if (isEvenPage && (i + 1) % 2 === 0) {\n                        this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                    }\n                    else if ((!isEvenPage && (i + 1) % 2 !== 0)) {\n                        if (page.bodyWidgets[0].sectionFormat.differentFirstPage && (i + 1 !== 1)) {\n                            this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                        }\n                    }\n                }\n                else {\n                    this.updateHeaderFooterWidgetToPageInternal(page, node, node.headerFooterType.indexOf('Header') !== -1);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHeaderFooterWidgetToPageInternal = function (page, widget, isHeader) {\n        if (widget.page !== page) {\n            var hfWidget = widget.clone();\n            hfWidget.page = page;\n            this.viewer.updateHFClientArea(hfWidget.sectionFormat, isHeader);\n            hfWidget = this.viewer.layout.layoutHeaderFooterItems(this.viewer, hfWidget);\n            var headerOrFooter = void 0;\n            if (isHeader) {\n                headerOrFooter = page.headerWidget;\n                page.headerWidget = hfWidget;\n            }\n            else {\n                headerOrFooter = page.footerWidget;\n                page.footerWidget = hfWidget;\n            }\n            this.removeFieldInWidget(headerOrFooter);\n            headerOrFooter.destroy();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInWidget = function (widget) {\n        for (var i = 0; i < widget.childWidgets.length; i++) {\n            this.removeFieldInBlock(widget.childWidgets[i]);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldInBlock = function (block) {\n        if (block instanceof TableWidget) {\n            this.removeFieldTable(block);\n        }\n        else {\n            this.removeField(block);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeFieldTable = function (table) {\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.removeFieldInWidget(row.childWidgets[j]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.shiftPageContent = function (headerFooter) {\n        var type = headerFooter.headerFooterType;\n        var pageIndex;\n        if (type === 'FirstPageHeader' || type === 'FirstPageFooter') {\n            pageIndex = 0;\n        }\n        else if (headerFooter.sectionFormat.differentOddAndEvenPages) {\n            if (headerFooter.sectionFormat.differentFirstPage) {\n                pageIndex = (type === 'EvenHeader' || type === 'EvenFooter') ? 1 : 2;\n            }\n            else {\n                pageIndex = (type.indexOf('Even') === -1) ? 0 : 1;\n            }\n        }\n        else {\n            pageIndex = headerFooter.sectionFormat.differentFirstPage ? 1 : 0;\n            if (pageIndex === 1 && this.viewer.pages.length === 1) {\n                pageIndex = 0;\n            }\n        }\n        var page = this.viewer.pages[pageIndex];\n        if (type.indexOf('Header') !== -1) {\n            var firstBlock = page.bodyWidgets[0].firstChild;\n            var top_1 = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.topMargin);\n            var headerDistance = HelperMethods.convertPointToPixel(headerFooter.sectionFormat.headerDistance);\n            top_1 = Math.max(headerDistance + page.headerWidget.height, top_1);\n            if (firstBlock.y !== top_1) {\n                this.viewer.updateClientArea(page.bodyWidgets[0].sectionFormat, page);\n                firstBlock = firstBlock.combineWidget(this.viewer);\n                var prevWidget = firstBlock.previousRenderedWidget;\n                if (prevWidget) {\n                    this.viewer.cutFromTop(prevWidget.y + prevWidget.height);\n                    if (firstBlock.containerWidget !== prevWidget.containerWidget) {\n                        // tslint:disable-next-line:max-line-length\n                        this.viewer.layout.updateContainerWidget(firstBlock, prevWidget.containerWidget, prevWidget.indexInOwner + 1, false);\n                    }\n                }\n                this.viewer.blockToShift = firstBlock;\n            }\n        }\n        else {\n            this.checkAndShiftFromBottom(page, headerFooter);\n        }\n        if (this.viewer.blockToShift) {\n            this.viewer.renderedLists.clear();\n            this.viewer.layout.shiftLayoutedItems();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndShiftFromBottom = function (page, footerWidget) {\n        var bodyWidget = page.bodyWidgets[0];\n        var blockToShift;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets[i];\n            if (block.y + block.height > footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n            if (bodyWidget.childWidgets.length - 1 === i && block.y + block.height < footerWidget.y) {\n                blockToShift = block;\n                break;\n            }\n        }\n        this.viewer.updateClientArea(bodyWidget.sectionFormat, page);\n        this.viewer.cutFromTop(blockToShift.y);\n        this.viewer.blockToShift = blockToShift;\n    };\n    //Paste Implementation ends\n    //Character Format apply implementation starts\n    /**\n     * Change HighlightColor\n     * @param  {HighlightColor} highlightColor\n     * Applies character format for selection.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @private\n     */\n    Editor.prototype.onApplyCharacterFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        update = isNullOrUndefined(update) ? false : update;\n        var action = (property[0].toUpperCase() + property.slice(1));\n        var paragraph = selection.start.paragraph;\n        var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n        if (selection.isEmpty && selection.contextType !== 'List') {\n            selection.skipFormatRetrieval = true;\n            if (selection.end.isAtParagraphEnd) {\n                this.initHistory(action);\n                this.viewer.owner.isShiftingEnabled = true;\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n                this.reLayout(this.viewer.selection);\n                this.viewer.updateFocus();\n            }\n            else {\n                selection.fireSelectionChanged(true);\n            }\n            selection.skipFormatRetrieval = false;\n            return;\n        }\n        this.setOffsetValue(selection);\n        this.initHistory(action);\n        // Todo: Complete Microsoft Word behavior on apply formatting in empty selection\n        // if (selection.isEmpty) {\n        //     this.viewer.owner.isShiftingEnabled = true;\n        //     this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n        //     this.reLayout(this.viewer.selection);\n        //     this.viewer.updateFocus();\n        //     return;\n        // }\n        if (selection.contextType === 'List') {\n            // this.updateCharacterFormatForListText(selection, action, value, update);\n            this.applyCharacterFormatForListText(selection, property, value, update);\n        }\n        else {\n            //Iterate and update format.\n            this.updateSelectionCharacterFormatting(property, value, update);\n        }\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharacterFormatForListText = function (selection, property, values, update) {\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        if (isNullOrUndefined(listLevel)) {\n            return;\n        }\n        var characterFormat = listLevel.characterFormat;\n        switch (property) {\n            case 'bold':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'bold', !(characterFormat.bold));\n                break;\n            case 'italic':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'italic', !(characterFormat.italic));\n                break;\n            case 'fontColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontColor', values);\n                break;\n            case 'fontFamily':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontFamily', values);\n                break;\n            case 'fontSize':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'fontSize', values);\n                break;\n            case 'highlightColor':\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                if (characterFormat.baselineAlignment === values) {\n                    values = 'Normal';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                if (characterFormat.strikethrough === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'strikethrough', values);\n                break;\n            case 'underline':\n                if (characterFormat.underline === values) {\n                    values = 'None';\n                }\n                this.applyListCharacterFormatByValue(selection, characterFormat, 'underline', values);\n                break;\n            case 'characterFormat':\n                this.applyListCharacterFormatByValue(selection, characterFormat, undefined, values);\n                break;\n        }\n    };\n    Editor.prototype.applyListCharacterFormatByValue = function (selection, format, property, value) {\n        this.initHistory('ListCharacterFormat');\n        this.applyCharFormatValue(format, property, value, false);\n        this.editorHistory.updateHistory();\n        this.reLayout(selection);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListCharacterFormat = function (selection, property, value) {\n        this.updateListTextSelRange(selection, property, value, false);\n    };\n    Editor.prototype.updateListTextSelRange = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPositionInternal = selection.start;\n        var endPositionInternal = selection.end;\n        if (!selection.isForward) {\n            startPositionInternal = selection.end;\n            endPositionInternal = selection.start;\n        }\n        this.initHistoryPosition(selection, startPositionInternal);\n        var listLevel = this.getListLevel(selection.start.paragraph);\n        this.applyCharFormatValue(listLevel.characterFormat, property, value, update);\n        this.startSelectionReLayouting(startPositionInternal.paragraph, selection, startPositionInternal, endPositionInternal);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getListLevel = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        if (!isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n            // && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels.getItem(listLevelNumber))) {\n            && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels)) {\n            return this.viewer.layout.getListLevel(currentList, listLevelNumber);\n        }\n        return undefined;\n    };\n    Editor.prototype.updateInsertPosition = function () {\n        var selection = this.viewer.selection;\n        var position = selection.start;\n        if (!selection.isForward) {\n            position = selection.end;\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && !isNullOrUndefined(position)) {\n            if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.updateHistoryPosition(position, true);\n            }\n        }\n    };\n    /**\n     * preserve paragraph and offset value for selection\n     * @private\n     */\n    Editor.prototype.setOffsetValue = function (selection) {\n        var info = this.getParagraphInfo(selection.start);\n        this.startParagraph = info.paragraph;\n        this.startOffset = info.offset;\n        info = this.getParagraphInfo(selection.end);\n        this.endParagraph = info.paragraph;\n        this.endOffset = info.offset;\n    };\n    /**\n     * Toggles the highlight color property of selected contents.\n     * @param {HighlightColor} highlightColor Default value of â€˜underlineâ€™ parameter is Yellow.\n     */\n    Editor.prototype.toggleHighlightColor = function (highlightColor) {\n        var selection = this.viewer.selection;\n        if (isNullOrUndefined(highlightColor) || highlightColor === 'NoColor') {\n            highlightColor = 'Yellow';\n        }\n        //In Ms Word the highlight color is took from the ribbon. So we Have given yellow as constant.\n        if (selection.characterFormat.highlightColor === highlightColor) {\n            highlightColor = 'NoColor';\n        }\n        this.selection.characterFormat.highlightColor = highlightColor;\n    };\n    /**\n     * Toggles the subscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSubscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Subscript' ? 'Normal' : 'Subscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the superscript formatting of selected contents.\n     */\n    Editor.prototype.toggleSuperscript = function () {\n        if (!this.owner.isReadOnlyMode) {\n            var value = this.selection.characterFormat.baselineAlignment === 'Superscript' ? 'Normal' : 'Superscript';\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    /**\n     * Toggles the text alignment property of selected contents.\n     * @param {TextAlignment} textAlignment Default value of â€˜textAlignment parameter is TextAlignment.Left.\n     */\n    /**\n     * Increases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.increaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Decreases the left indent of selected paragraphs to a factor of 36 points.\n     */\n    Editor.prototype.decreaseIndent = function () {\n        if (!this.owner.isReadOnlyMode) {\n            this.onApplyParagraphFormat('leftIndent', -this.viewer.defaultTabWidth, true, false);\n        }\n    };\n    /**\n     * Clears the list format for selected paragraphs.\n     */\n    Editor.prototype.clearList = function () {\n        this.selection.owner.editorModule.onApplyList(undefined);\n    };\n    /**\n     * Applies the bullet list to selected paragraphs.\n     * @param {string} bullet Bullet character\n     * @param {string} fontFamily Bullet font family\n     */\n    Editor.prototype.applyBullet = function (bullet, fontFamily) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(bullet, 'Bullet', fontFamily);\n        }\n    };\n    /**\n     * Applies the numbering list to selected paragraphs.\n     * @param numberFormat  â€œ%nâ€ representations in â€˜numberFormatâ€™ parameter will be replaced by respective list levelâ€™s value.\n     * `â€œ%1)â€ will be displayed as â€œ1)â€ `\n     * @param listLevelPattern  Default value of â€˜listLevelPatternâ€™ parameter is ListLevelPattern.Arabic\n     */\n    Editor.prototype.applyNumbering = function (numberFormat, listLevelPattern) {\n        if (!this.owner.isReadOnlyMode) {\n            this.applyBulletOrNumbering(numberFormat, listLevelPattern, 'Verdana');\n        }\n    };\n    /**\n     * Toggles the baseline alignment property of selected contents.\n     * @param  {Selection} selection\n     * @param  {BaselineAlignment} baseAlignment\n     */\n    Editor.prototype.toggleBaselineAlignment = function (baseAlignment) {\n        this.updateProperty(2, baseAlignment);\n    };\n    /**\n     * Clears the formatting.\n     */\n    Editor.prototype.clearFormatting = function () {\n        var selection = this.viewer.selection;\n        this.initComplexHistory('ClearFormat');\n        // let startIndex: string = selection.start.getHierarchicalIndexInternal();\n        // let endIndex: string = selection.end.getHierarchicalIndexInternal();\n        if (selection.isEmpty) {\n            selection.start.moveToParagraphStartInternal(selection, false);\n            selection.end.moveToParagraphEndInternal(selection, false);\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearCharacterFormat');\n        }\n        this.updateSelectionCharacterFormatting('ClearCharacterFormat', undefined, false);\n        this.getOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.setOffsetValue(selection);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ClearParagraphFormat');\n        }\n        this.updateParagraphFormatInternal('ClearParagraphFormat', undefined, false);\n        if (this.editorHistory) {\n            this.editorHistory.updateHistory();\n        }\n        this.getOffsetValue(selection);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            this.editorHistory.updateComplexHistory();\n        }\n        this.startParagraph = undefined;\n        this.endParagraph = undefined;\n        // else {\n        //     this.checkAndUpdatedSelection(startIndex, endIndex);\n        // }\n    };\n    /**\n     * Toggles the specified property. If property is assigned already. Then property will be changed\n     * @param  {Selection} selection\n     * @param  {number} type\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateProperty = function (type, value) {\n        var selection = this.selection;\n        if (selection.owner.isReadOnlyMode || !selection.owner.isDocumentLoaded) {\n            return;\n        }\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var indexInInline = 0;\n        var inlineObj = startPosition.currentWidget.getInline(startPosition.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var paragraph = startPosition.paragraph;\n        if (!isNullOrUndefined(inline) && inline.length === indexInInline && !this.selection.isEmpty) {\n            inline = inline.nextNode;\n        }\n        if (type === 1) {\n            var currentUnderline = 'None';\n            if (!isNullOrUndefined(inline)) {\n                currentUnderline = inline.characterFormat.underline;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                currentUnderline = paragraph.characterFormat.underline;\n            }\n            this.selection.characterFormat.underline = value === currentUnderline ? 'None' : value;\n        }\n        else {\n            var script = 'Normal';\n            if (!isNullOrUndefined(inline)) {\n                script = inline.characterFormat.baselineAlignment;\n            }\n            else if (!isNullOrUndefined(paragraph)) {\n                script = paragraph.characterFormat.baselineAlignment;\n            }\n            if (script === value) {\n                value = 'Normal';\n            }\n            this.selection.characterFormat.baselineAlignment = value;\n        }\n    };\n    Editor.prototype.getCompleteStyles = function () {\n        var completeStylesString = '{\"styles\":[';\n        for (var _i = 0, _a = this.viewer.preDefinedStyles.getItem(); _i < _a.length; _i++) {\n            var name_1 = _a[_i];\n            completeStylesString += (this.viewer.preDefinedStyles.get(name_1) + ',');\n        }\n        return completeStylesString.slice(0, -1) + ']}';\n    };\n    /**\n     * Initialize default styles\n     * @private\n     */\n    Editor.prototype.intializeDefaultStyles = function () {\n        var existingStyles = this.owner.getStyleNames('Paragraph');\n        var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n        var styleNames = defaultStyleNames.filter(function (val) {\n            return existingStyles.indexOf(val) === -1;\n        });\n        for (var _i = 0, styleNames_1 = styleNames; _i < styleNames_1.length; _i++) {\n            var name_2 = styleNames_1[_i];\n            this.createStyle(this.viewer.preDefinedStyles.get(name_2));\n        }\n    };\n    /**\n     * Creates a new instance of Style.\n     */\n    Editor.prototype.createStyle = function (styleString) {\n        this.createStyleIn(styleString);\n    };\n    /**\n     * Create a Style.\n     * @private\n     */\n    Editor.prototype.createStyleIn = function (styleString) {\n        /* tslint:disable:no-any */\n        var style = JSON.parse(styleString);\n        var styleObj = this.viewer.styles.findByName(style.name);\n        if (styleObj !== undefined) {\n            //Create a new style with new name and add it to collection.\n            style.name = this.getUniqueStyleName(style.name);\n        }\n        this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), style, this.viewer.styles);\n        return this.viewer.styles.findByName(style.name);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getUniqueStyleName = function (name) {\n        var uniqueName = this.getUniqueName(name);\n        var style = this.viewer.styles.findByName(uniqueName);\n        while (!isNullOrUndefined(style)) {\n            uniqueName = this.getUniqueStyleName(style.name);\n            style = this.viewer.styles.findByName(uniqueName);\n        }\n        return uniqueName;\n    };\n    Editor.prototype.getUniqueName = function (name) {\n        var matchArray = name.match(/\\d+$/);\n        var returnName;\n        if (!isNullOrUndefined(matchArray) && matchArray.length > 0) {\n            return name.replace(matchArray[0], (parseInt(matchArray[0], 10) + 1).toString());\n        }\n        else {\n            return name + '_1';\n        }\n    };\n    /**\n     * Update Character format for selection\n     * @private\n     */\n    Editor.prototype.updateSelectionCharacterFormatting = function (property, values, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'CharacterFormat';\n        }\n        switch (property) {\n            case 'bold':\n                this.updateCharacterFormat('bold', values);\n                break;\n            case 'italic':\n                this.updateCharacterFormat('italic', values);\n                break;\n            case 'fontColor':\n                this.updateCharacterFormat('fontColor', values);\n                break;\n            case 'fontFamily':\n                this.updateCharacterFormat('fontFamily', values);\n                break;\n            case 'fontSize':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'fontSize', values, update);\n                break;\n            case 'highlightColor':\n                this.updateCharacterFormat('highlightColor', values);\n                break;\n            case 'baselineAlignment':\n                this.updateCharacterFormat('baselineAlignment', values);\n                break;\n            case 'strikethrough':\n                this.updateCharacterFormat('strikethrough', values);\n                break;\n            case 'underline':\n                this.updateCharacterFormat('underline', values);\n                break;\n            case 'styleName':\n                this.updateCharacterFormatWithUpdate(this.viewer.selection, 'styleName', values, true);\n                break;\n            case 'CharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n            case 'ClearCharacterFormat':\n                this.updateCharacterFormat(undefined, values);\n                break;\n        }\n        this.reLayout(this.viewer.selection);\n    };\n    /**\n     * Update character format for selection range\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns void\n     * @private\n     */\n    Editor.prototype.updateCharacterFormat = function (property, value) {\n        this.updateCharacterFormatWithUpdate(this.viewer.selection, property, value, false);\n    };\n    Editor.prototype.updateCharacterFormatWithUpdate = function (selection, property, value, update) {\n        this.viewer.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        this.applyCharFormatSelectedContent(startPosition.paragraph, selection, startPosition, endPosition, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatSelectedContent = function (paragraph, selection, start, end, property, value, update) {\n        //Selection start in cell.\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyCharFormatCell(cell, selection, start, end, property, value, update);\n            var table = cell.ownerTable;\n            // tslint:disable-next-line:max-line-length\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            this.applyCharFormat(paragraph, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedPara = function (paragraph, selection, property, value, update) {\n        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n            var line = paragraph.childWidgets[i];\n            for (var j = 0; j < line.children.length; j++) {\n                var element = line.children[j];\n                this.applyCharFormatValue(element.characterFormat, property, value, update);\n            }\n        }\n        this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n    };\n    Editor.prototype.splittedLastParagraph = function (paragraph) {\n        var splittedWidets = paragraph.getSplitWidgets();\n        return splittedWidets[splittedWidets.length - 1];\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForCharacterFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) { //Goto the next block.\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormat(block, this.viewer.selection, start, end, property, value, update);\n            }\n            else {\n                this.applyCharFormatForTable(0, block, this.viewer.selection, start, end, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormat = function (paragraph, selection, start, end, property, value, update) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var startOffset = 0;\n        var length = selection.getParagraphLength(paragraph);\n        var startLineWidget = paragraph.childWidgets.indexOf(start.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(start.currentWidget) : 0;\n        var endOffset = end.offset;\n        var endLineWidget = paragraph.childWidgets.indexOf(end.currentWidget) !== -1 ?\n            paragraph.childWidgets.indexOf(end.currentWidget) : paragraph.childWidgets.length - 1;\n        if (!isNullOrUndefined(selection)) {\n            if (paragraph === start.paragraph) {\n                startOffset = start.offset;\n            }\n        }\n        if (!paragraph.equals(end.paragraph)) {\n            this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            endOffset = length;\n        }\n        else {\n            var lastLine = paragraph.childWidgets[paragraph.childWidgets.length - 1];\n            if (selection.isParagraphLastLine(lastLine) && end.currentWidget === lastLine\n                && ((endOffset === selection.getLineLength(lastLine) + 1) || (selection.isEmpty && selection.end.isAtParagraphEnd))) {\n                this.applyCharFormatValue(paragraph.characterFormat, property, value, update);\n            }\n        }\n        // let count: number = 0;\n        for (var i = startLineWidget; i <= endLineWidget; i++) {\n            var line = paragraph.childWidgets[i];\n            if (i !== startLineWidget) {\n                startOffset = selection.getStartLineOffset(line);\n            }\n            if (line === end.currentWidget) {\n                endOffset = end.offset;\n            }\n            else {\n                endOffset = selection.getLineLength(line);\n            }\n            var count = 0;\n            for (var j = 0; j < line.children.length; j++) {\n                var inlineObj = line.children[j];\n                if (inlineObj instanceof ListTextElementBox) {\n                    continue;\n                }\n                if (startOffset >= count + inlineObj.length) {\n                    count += inlineObj.length;\n                    continue;\n                }\n                var startIndex = 0;\n                if (startOffset > count) {\n                    startIndex = startOffset - count;\n                }\n                var endIndex = endOffset - count;\n                var inlineLength = inlineObj.length;\n                if (endIndex > inlineLength) {\n                    endIndex = inlineLength;\n                }\n                j += this.applyCharFormatInline(inlineObj, selection, startIndex, endIndex, property, value, update);\n                if (endOffset <= count + inlineLength) {\n                    break;\n                }\n                count += inlineLength;\n            }\n        }\n        var endParagraph = end.paragraph;\n        this.viewer.layout.reLayoutParagraph(paragraph, startLineWidget, 0);\n        if (paragraph.equals(endParagraph)) {\n            return;\n        }\n        this.getNextParagraphForCharacterFormatting(paragraph, start, end, property, value, update);\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleBold = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('bold');\n        this.selection.characterFormat.bold = value;\n    };\n    /**\n     * Toggles the bold property of selected contents.\n     */\n    Editor.prototype.toggleItalic = function () {\n        if (this.viewer.owner.isReadOnlyMode) {\n            return;\n        }\n        var value = this.getCurrentSelectionValue('italic');\n        this.selection.characterFormat.italic = value;\n    };\n    Editor.prototype.getCurrentSelectionValue = function (property) {\n        var value = false;\n        if ((property === 'bold' || property === 'italic')) {\n            var index = 0;\n            var start = this.selection.start;\n            if (!this.selection.isForward) {\n                start = this.selection.end;\n            }\n            var lineWidget = start.currentWidget;\n            var inlineObj = lineWidget.getInline(start.offset, index);\n            var inline = inlineObj.element;\n            // inline.ownerBase\n            index = inlineObj.index;\n            var characterFormat = lineWidget.paragraph.characterFormat;\n            if (!isNullOrUndefined(inline)) {\n                if (!this.selection.isEmpty && index === inline.length) {\n                    characterFormat = isNullOrUndefined(inline.nextNode) ? lineWidget.paragraph.characterFormat\n                        : inline.nextNode.characterFormat;\n                }\n                else {\n                    characterFormat = inline.characterFormat;\n                }\n            }\n            if (property === 'bold') {\n                value = !(characterFormat.bold);\n            }\n            if (property === 'italic') {\n                value = !(characterFormat.italic);\n            }\n        }\n        return value;\n    };\n    /**\n     * Toggles the underline property of selected contents.\n     * @param underline Default value of â€˜underlineâ€™ parameter is Single.\n     */\n    Editor.prototype.toggleUnderline = function (underline) {\n        if (!this.owner.isReadOnlyMode) {\n            this.updateProperty(1, underline);\n        }\n    };\n    /**\n     * Toggles the strike through property of selected contents.\n     * @param {Strikethrough} strikethrough Default value of strikethrough parameter is SingleStrike.\n     */\n    Editor.prototype.toggleStrikethrough = function (strikethrough) {\n        if (!this.owner.isReadOnlyMode) {\n            var value = void 0;\n            if (isNullOrUndefined(strikethrough)) {\n                value = this.selection.characterFormat.strikethrough === 'SingleStrike' ? 'None' : 'SingleStrike';\n            }\n            else {\n                value = strikethrough;\n            }\n            this.selection.characterFormat.strikethrough = value;\n        }\n    };\n    Editor.prototype.updateFontSize = function (format, value) {\n        if (typeof (value) === 'number' && !(value < 0 && format.fontSize === 1)) {\n            return format.fontSize + value;\n        }\n        var fontsizeCollection = [8, 9, 10, 11, 12, 14, 16, 18, 20, 24, 26, 28, 36, 48, 72];\n        if (typeof (value) === 'string' && value === 'increment') {\n            if (format.fontSize < 8) {\n                return format.fontSize + 1;\n            }\n            else if (format.fontSize >= 72 && format.fontSize < 80) {\n                return 80;\n            }\n            else if (format.fontSize >= 80) {\n                return format.fontSize + 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize < fontsizeCollection[i]) {\n                        return fontsizeCollection[i];\n                    }\n                }\n            }\n        }\n        else if (typeof (value) === 'string' && value === 'decrement' && format.fontSize > 1) {\n            if (format.fontSize <= 8) {\n                return format.fontSize - 1;\n            }\n            else if (format.fontSize > 72 && format.fontSize <= 80) {\n                return 72;\n            }\n            else if (format.fontSize > 80) {\n                return format.fontSize - 10;\n            }\n            else {\n                for (var i = 0; i < fontsizeCollection.length; i++) {\n                    if (format.fontSize <= fontsizeCollection[i]) {\n                        return fontsizeCollection[i - 1];\n                    }\n                }\n            }\n        }\n        return format.fontSize;\n    };\n    // Inline\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        if (startIndex === 0 && endIndex === inline.length) {\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n            return 0;\n        }\n        else if (inline instanceof TextElementBox) {\n            return this.formatInline(inline, selection, startIndex, endIndex, property, value, update);\n        }\n        return 0;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.formatInline = function (inline, selection, startIndex, endIndex, property, value, update) {\n        var x = 0;\n        var node = inline;\n        var index = inline.line.children.indexOf(node);\n        var paragraph = inline.paragraph;\n        var lineIndex = paragraph.childWidgets.indexOf(inline.line);\n        var textElement;\n        if (startIndex > 0) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.line = inline.line;\n            textElement.text = inline.text.substr(startIndex, endIndex - startIndex);\n            this.applyCharFormatValue(textElement.characterFormat, property, value, update);\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                      \n        }\n        if (endIndex < node.length) {\n            textElement = new TextElementBox();\n            textElement.characterFormat.copyFormat(inline.characterFormat);\n            textElement.text = node.text.substring(endIndex);\n            textElement.line = inline.line;\n            index++;\n            node.line.children.splice(index, 0, textElement);\n            x++;\n            // this.addToLinkedFields(span);                       \n        }\n        if (startIndex === 0) {\n            inline.text = inline.text.substr(0, endIndex);\n            this.applyCharFormatValue(inline.characterFormat, property, value, update);\n        }\n        else {\n            inline.text = inline.text.substr(0, startIndex);\n        }\n        return x;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatCell = function (cell, selection, start, end, property, value, update) {\n        if (end.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, containerCell);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        value = this.getCharacterFormatValueOfCell(cell, selection, value, property);\n                        this.applyCharFormatForSelectedCell(containerCell, selection, property, value, update);\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.applyCharFormat(start.paragraph, selection, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyCharFormatRow(startCell.ownerRow, selection, start, end, property, value, update);\n                        }\n                    }\n                }\n                else { //Format other selected cells in current table.\n                    this.applyCharFormatForTableCell(containerCell.ownerTable, selection, containerCell, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyCharFormatRow(containerCell.ownerRow, selection, start, end, property, value, update);\n            }\n        }\n        else {\n            var tableCell = selection.getContainerCell(cell);\n            this.applyCharFormatRow(tableCell.ownerRow, selection, start, end, property, value, update);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelectedCell = function (cell, selection, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyCharFormatForSelectedPara(block, selection, property, value, update);\n            }\n            else {\n                this.applyCharFormatForSelTable(block, selection, property, value, update);\n            }\n        }\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatRow = function (row, selection, start, end, property, value, update) {\n        value = this.getCharacterFormatValueOfCell(row.childWidgets[0], selection, value, property);\n        this.applyCharFormatForTable(row.rowIndex, row.ownerTable, selection, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTable = function (index, table, selection, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        for (var i = index; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForCharacterFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForSelTable = function (tableWidget, selection, property, value, update) {\n        for (var i = 0; i < tableWidget.childWidgets.length; i++) {\n            var row = tableWidget.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyCharFormatForTableCell = function (table, selection, startCell, endCell, property, value, update) {\n        var startCellLeft = selection.getCellLeft(startCell.ownerRow, startCell);\n        var startCellRight = startCellLeft + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startCellLeft, startCellRight, endCellLeft, endCellRight);\n        startCellLeft = cellInfo.start;\n        startCellRight = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var i = table.childWidgets.indexOf(startCell.ownerRow); i <= count; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (HelperMethods.round(startCellLeft, 2) <= HelperMethods.round(left, 2) &&\n                    HelperMethods.round(left, 2) < HelperMethods.round(startCellRight, 2)) {\n                    if (!isStarted) {\n                        value = this.getCharacterFormatValueOfCell(row.childWidgets[j], selection, value, property);\n                        isStarted = true;\n                    }\n                    this.applyCharFormatForSelectedCell(row.childWidgets[j], selection, property, value, update);\n                }\n            }\n        }\n    };\n    Editor.prototype.updateSelectedCellsInTable = function (start, end, endCellLeft, endCellRight) {\n        var selection = this.viewer.selection;\n        if (start > endCellLeft) {\n            start = endCellLeft;\n        }\n        if (end < endCellRight) {\n            end = endCellRight;\n        }\n        if (start > selection.upDownSelectionLength) {\n            start = selection.upDownSelectionLength;\n        }\n        if (end < selection.upDownSelectionLength) {\n            end = selection.upDownSelectionLength;\n        }\n        return { start: start, end: end };\n    };\n    Editor.prototype.getCharacterFormatValueOfCell = function (cell, selection, value, property) {\n        if (typeof (value) === 'boolean' || (value === undefined && (property === 'bold' || property === 'italic'))) {\n            var firstParagraph = selection.getFirstParagraph(cell);\n            var format = firstParagraph.characterFormat;\n            if (firstParagraph.childWidgets.length > 0 && firstParagraph.childWidgets[0].children.length > 0) {\n                format = firstParagraph.childWidgets[0].children[0].characterFormat;\n            }\n            value = !format.getPropertyValue(property);\n        }\n        return value;\n    };\n    /**\n     * Apply Character format for selection\n     * @private\n     */\n    Editor.prototype.applyCharFormatValueInternal = function (selection, format, property, value) {\n        this.applyCharFormatValue(format, property, value, false);\n    };\n    Editor.prototype.copyInlineCharacterFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueCharacterFormat = sourceFormat.uniqueCharacterFormat;\n        destFormat.baseCharStyle = sourceFormat.baseCharStyle;\n    };\n    Editor.prototype.applyCharFormatValue = function (format, property, value, update) {\n        if (update && property === 'fontSize') {\n            value = this.updateFontSize(format, value);\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(format, property, value);\n        }\n        if (value instanceof WCharacterFormat) {\n            if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                this.copyInlineCharacterFormat(value, format);\n            }\n            else {\n                format.copyFormat(value);\n            }\n            return;\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            return;\n        }\n        if (property === 'bold') {\n            format.bold = value;\n        }\n        else if (property === 'italic') {\n            format.italic = value;\n        }\n        else if (property === 'fontColor') {\n            format.fontColor = value;\n        }\n        else if (property === 'fontFamily') {\n            format.fontFamily = value;\n        }\n        else if (property === 'fontSize') {\n            format.fontSize = value;\n        }\n        else if (property === 'highlightColor') {\n            format.highlightColor = value;\n        }\n        else if (property === 'baselineAlignment') {\n            format.baselineAlignment = value;\n        }\n        else if (property === 'strikethrough') {\n            format.strikethrough = value;\n        }\n        else if (property === 'underline') {\n            format.underline = value;\n        }\n        else if (property === 'styleName') {\n            format.baseCharStyle = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onImageFormat = function (elementBox, width, height) {\n        var modifiedFormat = new ImageFormat(elementBox);\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ImageResizing');\n            this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(modifiedFormat);\n        }\n        this.setOffsetValue(this.selection);\n        elementBox.width = width;\n        elementBox.height = height;\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.reLayoutParagraph(elementBox.line.paragraph, elementBox.line.indexInOwner, 0);\n        this.reLayout(this.selection, false);\n        if (this.viewer.owner.imageResizerModule) {\n            this.viewer.owner.imageResizerModule.positionImageResizer(elementBox);\n        }\n    };\n    /**\n     * Toggles the text alignment of selected paragraphs.\n     * @param  {TextAlignment} textAlignment\n     */\n    Editor.prototype.toggleTextAlignment = function (textAlignment) {\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        // Toggle performed based on current selection format similar to MS word behavior.\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.viewer.selection.paragraphFormat.textAlignment) && this.viewer.selection.paragraphFormat.textAlignment === textAlignment) {\n            if (textAlignment === 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Justify', false, true);\n            }\n            else {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n            }\n        }\n        else {\n            this.onApplyParagraphFormat('textAlignment', textAlignment, false, true);\n        }\n    };\n    /**\n     * Applies paragraph format for the selection ranges.\n     * @param {string} property\n     * @param {Object} value\n     * @param {boolean} update\n     * @param {boolean} isSelectionChanged\n     * @private\n     */\n    Editor.prototype.onApplyParagraphFormat = function (property, value, update, isSelectionChanged) {\n        var action = (property[0].toUpperCase() + property.slice(1));\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        this.initHistory(action);\n        if (this.viewer.owner.isReadOnlyMode || !this.viewer.owner.isDocumentLoaded) {\n            return;\n        }\n        if (property === 'leftIndent') {\n            if (selection.paragraphFormat.listId !== -1 && update) {\n                this.updateListLevel(value > 0);\n                return;\n            }\n        }\n        if (selection.isEmpty) {\n            this.setOffsetValue(selection);\n            if (update && property === 'leftIndent') {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            var para = selection.start.paragraph.combineWidget(this.viewer);\n            this.applyParaFormatProperty(para, property, value, update);\n            this.layoutItemBlock(para, false);\n        }\n        else {\n            //Iterate and update formatting's.      \n            this.setOffsetValue(selection);\n            this.updateSelectionParagraphFormatting(property, value, update);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Update the list level\n     * @param  {boolean} increaseLevel\n     * @private\n     */\n    Editor.prototype.updateListLevel = function (increaseLevel) {\n        // Increment or Decrement list level for Multilevel lists.\n        var viewer = this.viewer;\n        var listFormat = this.viewer.selection.start.paragraph.paragraphFormat.listFormat;\n        var paragraphFormat = this.viewer.selection.start.paragraph.paragraphFormat;\n        var list = viewer.getListById(paragraphFormat.listFormat.listId);\n        var listLevel = viewer.layout.getListLevel(list, paragraphFormat.listFormat.listLevelNumber);\n        var levelNumber;\n        if (increaseLevel) {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber + 1;\n        }\n        else {\n            levelNumber = paragraphFormat.listFormat.listLevelNumber - 1;\n        }\n        var nextListLevel = viewer.layout.getListLevel(list, levelNumber);\n        if (!isNullOrUndefined(nextListLevel)) {\n            this.onApplyListInternal(list, levelNumber);\n            viewer.selection.start.updatePhysicalPosition(true);\n            viewer.selection.end.updatePhysicalPosition(true);\n            viewer.selection.updateCaretPosition();\n        }\n    };\n    /**\n     * Applies list\n     * @param  {WList} list\n     * @param  {number} listLevelNumber\n     * @private\n     */\n    Editor.prototype.onApplyListInternal = function (list, listLevelNumber) {\n        var selection = this.viewer.selection;\n        var listFormat = new WListFormat();\n        if (!isNullOrUndefined(list) && listLevelNumber >= 0 && listLevelNumber < 9) {\n            listFormat.listId = list.listId;\n            listFormat.listLevelNumber = listLevelNumber;\n        }\n        this.onApplyParagraphFormat('listFormat', listFormat, false, false);\n    };\n    /**\n     * Apply paragraph format to selection range\n     * @private\n     */\n    Editor.prototype.updateSelectionParagraphFormatting = function (property, value, update) {\n        var selection = this.viewer.selection;\n        if (property === 'leftIndent' && update) {\n            if (!isNullOrUndefined(selection.start) && selection.start.isExistBefore(selection.end)) {\n                value = this.getIndentIncrementValue(selection.start.paragraph, value);\n            }\n            else {\n                value = this.getIndentIncrementValue(selection.end.paragraph, value);\n            }\n        }\n        this.updateParagraphFormatInternal(property, value, update);\n    };\n    Editor.prototype.getIndentIncrementValue = function (currentParagraph, incrementFactor) {\n        var currentParagraphIndent = currentParagraph.paragraphFormat.leftIndent;\n        if (currentParagraphIndent < 0) {\n            // In MS Word, if the current paragraph left indent is lesser that or equal to 0\n            // then performing decrement indent will set left indent to 0. \n            if (incrementFactor < 0 || currentParagraphIndent + incrementFactor >= 0) {\n                return -currentParagraphIndent;\n            }\n            else {\n                var incrementValue = -this.getIndentIncrementValueInternal(-currentParagraphIndent, -incrementFactor);\n                return incrementValue % incrementFactor === 0 ? incrementValue : incrementValue + incrementFactor;\n            }\n        }\n        else {\n            return this.getIndentIncrementValueInternal(currentParagraphIndent, incrementFactor);\n        }\n    };\n    Editor.prototype.getIndentIncrementValueInternal = function (position, incrementFactor) {\n        var tabValue = Math.abs(incrementFactor);\n        if (position === 0 || tabValue === 0) {\n            return incrementFactor > 0 ? tabValue : 0;\n        }\n        else {\n            var diff = ((Math.round(position) * 100) % (Math.round(tabValue) * 100)) / 100;\n            var cnt = (Math.round(position) - diff) / Math.round(tabValue);\n            var fPosition = cnt * tabValue;\n            if (incrementFactor > 0) {\n                fPosition += tabValue;\n            }\n            return (fPosition - position) === 0 ? incrementFactor : fPosition - position;\n        }\n    };\n    Editor.prototype.updateParagraphFormatInternal = function (property, value, update) {\n        if (isNullOrUndefined(property)) {\n            property = 'ParagraphFormat';\n        }\n        switch (property) {\n            case 'afterSpacing':\n                this.updateParagraphFormat('afterSpacing', value, false);\n                break;\n            case 'beforeSpacing':\n                this.updateParagraphFormat('beforeSpacing', value, false);\n                break;\n            case 'rightIndent':\n                this.updateParagraphFormat('rightIndent', value, false);\n                break;\n            case 'leftIndent':\n                this.updateParagraphFormat('leftIndent', value, update);\n                break;\n            case 'firstLineIndent':\n                this.updateParagraphFormat('firstLineIndent', value, false);\n                break;\n            case 'lineSpacing':\n                this.updateParagraphFormat('lineSpacing', value, false);\n                break;\n            case 'lineSpacingType':\n                this.updateParagraphFormat('lineSpacingType', value, false);\n                break;\n            case 'textAlignment':\n                this.updateParagraphFormat('textAlignment', value, false);\n                break;\n            case 'listFormat':\n                this.updateParagraphFormat('listFormat', value, false);\n                break;\n            case 'ParagraphFormat':\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n            case 'styleName':\n                this.updateParagraphFormat('styleName', value, false);\n                break;\n            case 'ClearParagraphFormat':\n                // this.initializeHistory('ClearParagraphFormat', selectionRange);\n                this.updateParagraphFormat(undefined, value, false);\n                break;\n        }\n    };\n    /**\n     * Update paragraph format on undo\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @param  {boolean} update\n     * @private\n     */\n    Editor.prototype.updateParagraphFormat = function (property, value, update) {\n        var selection = this.viewer.selection;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        // this.updateInsertPosition(selection, startPosition);\n        this.applyParaFormatSelectedContent(startPosition, endPosition, property, value, update);\n        // this.startSelectionReLayouting(startPosition.paragraph, selection, startPosition, endPosition);\n    };\n    Editor.prototype.applyParaFormatSelectedContent = function (start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (start.paragraph.isInsideTable && (!end.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(start.paragraph.associatedCell, start, end))) {\n            var cell = void 0;\n            start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            if (this.checkInsertPosition(selection)) {\n                this.updateHistoryPosition(start, true);\n            }\n            cell = start.paragraph.associatedCell;\n            this.applyParaFormatInCell(cell, start, end, property, value, update);\n            var table = cell.ownerTable;\n            this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(value) && !this.selection.isEmpty && property === 'styleName' && this.applyCharacterStyle(start.paragraph, start, end, property, value, update)) {\n                return;\n            }\n            else {\n                this.applyParaFormat(start.paragraph, start, end, property, value, update);\n            }\n        }\n    };\n    /**\n     * Apply Paragraph format\n     * @private\n     */\n    Editor.prototype.applyParaFormatProperty = function (paragraph, property, value, update) {\n        var format = paragraph.paragraphFormat;\n        if (update && property === 'leftIndent') {\n            value = format.leftIndent + value;\n        }\n        if (property === 'listFormat' && value instanceof WListFormat) {\n            var listFormat = value;\n            if (!listFormat.hasValue('listLevelNumber')) {\n                listFormat.listLevelNumber = format.listFormat.listLevelNumber;\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(format, property, value);\n        }\n        if (value instanceof WParagraphFormat) {\n            if (isNullOrUndefined(property)) {\n                if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n                    this.copyParagraphFormat(value, format);\n                }\n                else {\n                    format.copyFormat(value);\n                }\n            }\n            else if (property === 'listFormat') {\n                format.listFormat = value.listFormat;\n                // this.handleListFormat(format, value as WParagraphFormat);\n            }\n        }\n        if (isNullOrUndefined(value)) {\n            format.clearFormat();\n            this.viewer.layout.reLayoutParagraph(format.ownerBase, 0, 0);\n            return;\n        }\n        if (property === 'afterSpacing') {\n            format.afterSpacing = value;\n        }\n        else if (property === 'beforeSpacing') {\n            format.beforeSpacing = value;\n        }\n        else if (property === 'leftIndent') {\n            format.leftIndent = value;\n        }\n        else if (property === 'lineSpacingType') {\n            format.lineSpacingType = value;\n        }\n        else if (property === 'lineSpacing') {\n            format.lineSpacing = value;\n        }\n        else if (property === 'rightIndent') {\n            format.rightIndent = value;\n        }\n        else if (property === 'firstLineIndent') {\n            format.firstLineIndent = value;\n        }\n        else if (property === 'textAlignment') {\n            format.textAlignment = value;\n            this.viewer.layout.allowLayout = false;\n        }\n        else if (property === 'styleName') {\n            if (typeof (value) === 'string') {\n                value = this.viewer.styles.findByName(value);\n            }\n            format.ApplyStyle(value);\n        }\n        else if (property === 'listFormat') {\n            if (value instanceof WParagraphFormat) {\n                this.copyFromListLevelParagraphFormat(format, value);\n                value = value.listFormat;\n            }\n            format.listFormat.copyFormat(value);\n            this.viewer.layout.clearListElementBox(format.ownerBase);\n            this.onListFormatChange(format.ownerBase, value, format);\n            this.layoutItemBlock(format.ownerBase, false);\n            return;\n        }\n    };\n    Editor.prototype.copyParagraphFormat = function (sourceFormat, destFormat) {\n        destFormat.uniqueParagraphFormat = sourceFormat.uniqueParagraphFormat;\n        destFormat.listFormat = sourceFormat.listFormat;\n        destFormat.baseStyle = sourceFormat.baseStyle;\n    };\n    Editor.prototype.onListFormatChange = function (paragraph, listFormat, paraFormat) {\n        if (listFormat instanceof WListFormat) {\n            var currentFormat = listFormat;\n            // currentFormat.setOwnerBase(paraFormat);\n            this.updateListParagraphFormat(paragraph, listFormat);\n        }\n    };\n    Editor.prototype.updateListParagraphFormat = function (paragraph, listFormat) {\n        var list = this.viewer.getListById(listFormat.listId);\n        var listlevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            listlevel = this.viewer.layout.getListLevel(list, listFormat.listLevelNumber);\n        }\n        var isUpdateIndent = !this.editorHistory || (this.editorHistory && !this.editorHistory.isUndoing);\n        if (isUpdateIndent) {\n            if (paragraph instanceof ParagraphWidget && !isNullOrUndefined(listlevel)\n                && !isNullOrUndefined(listlevel.paragraphFormat) && !isNullOrUndefined(paragraph.containerWidget)) {\n                this.copyFromListLevelParagraphFormat(paragraph.paragraphFormat, listlevel.paragraphFormat);\n            }\n            else if (isNullOrUndefined(list)) {\n                paragraph.paragraphFormat.leftIndent = undefined;\n                paragraph.paragraphFormat.firstLineIndent = undefined;\n            }\n        }\n    };\n    /**\n     * Copies list level paragraph format\n     * @param  {WParagraphFormat} oldFormat\n     * @param  {WParagraphFormat} newFormat\n     * @private\n     */\n    Editor.prototype.copyFromListLevelParagraphFormat = function (oldFormat, newFormat) {\n        if (!isNullOrUndefined(newFormat.leftIndent)) {\n            oldFormat.leftIndent = newFormat.leftIndent;\n        }\n        if (!isNullOrUndefined(newFormat.firstLineIndent)) {\n            oldFormat.firstLineIndent = newFormat.firstLineIndent;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumbering = function (selection) {\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('ContinueNumbering');\n        }\n        this.applyContinueNumberingInternal(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyContinueNumberingInternal = function (selection) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        var paraFormat = this.getParagraphFormat(paragraph, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.changeListId(numberingInfo.currentList, paragraph, paraFormat, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        this.viewer.updateFocus();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getContinueNumberingInfo = function (paragraph) {\n        var currentList = undefined;\n        var listLevelNumber = 0;\n        var listPattern = 'None';\n        if (!isNullOrUndefined(paragraph.paragraphFormat)\n            && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n            currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n        }\n        var viewer = this.viewer;\n        if (listLevelNumber !== 0 && !isNullOrUndefined(currentList) &&\n            !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId))\n            && !isNullOrUndefined(viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n            var listLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n            if (!isNullOrUndefined(listLevel)) {\n                listPattern = listLevel.listLevelPattern;\n            }\n        }\n        return {\n            currentList: currentList,\n            listLevelNumber: listLevelNumber,\n            listPattern: listPattern\n        };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.revertContinueNumbering = function (selection, format) {\n        var paragraph = selection.start.paragraph;\n        var numberingInfo = this.getContinueNumberingInfo(paragraph);\n        this.changeListId(numberingInfo.currentList, paragraph, format, numberingInfo.listLevelNumber, numberingInfo.listPattern);\n        this.reLayout(selection, false);\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.updateHistory();\n        }\n    };\n    Editor.prototype.changeListId = function (list, block, format, levelNum, listType) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId\n                && levelNum === block.paragraphFormat.listFormat.listLevelNumber) {\n                if (this.editorHistory) {\n                    var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                    if (!isNullOrUndefined(baseHistoryInfo)) {\n                        format = baseHistoryInfo.addModifiedPropertiesForContinueNumbering(block.paragraphFormat, format);\n                    }\n                }\n                block.paragraphFormat.copyFormat(format);\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeListId(list, block.nextRenderedWidget, format, levelNum, listType);\n    };\n    Editor.prototype.getParagraphFormat = function (paragraph, levelNumber, listType) {\n        if (!isNullOrUndefined(paragraph.previousRenderedWidget)) {\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                if (!isNullOrUndefined(paragraph.previousRenderedWidget.paragraphFormat.listFormat)\n                    && paragraph.previousRenderedWidget.paragraphFormat.listFormat.listId !== -1) {\n                    var listLevel = this.getListLevel(paragraph.previousRenderedWidget);\n                    if (levelNumber === 0) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else if (listType === listLevel.listLevelPattern\n                        || this.checkNumberArabic(listType, listLevel.listLevelPattern)) {\n                        return paragraph.previousRenderedWidget.paragraphFormat;\n                    }\n                    else {\n                        return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                    }\n                }\n                else {\n                    return this.getParagraphFormat(paragraph.previousRenderedWidget, levelNumber, listType);\n                }\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.checkNumberArabic = function (listType, levelPattern) {\n        if ((listType === 'Number' && levelPattern === 'Arabic')\n            || (levelPattern === 'Number' && listType === 'Arabic')) {\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyRestartNumbering = function (selection) {\n        if (this.editorHistory) {\n            this.editorHistory.initializeHistory('RestartNumbering');\n        }\n        this.restartListAt(selection);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAt = function (selection) {\n        var currentListLevel = this.getListLevel(selection.start.paragraph);\n        var list = new WList();\n        list.listId = this.viewer.lists[(this.viewer.lists.length - 1)].listId + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.viewer.abstractLists[(this.viewer.abstractLists.length - 1)].abstractListId + 1;\n        list.abstractListId = abstractList.abstractListId;\n        list.abstractList = abstractList;\n        this.viewer.abstractLists.push(abstractList);\n        this.createListLevels(abstractList, currentListLevel, list);\n        this.viewer.lists.push(list);\n        this.restartListAtInternal(selection, list.listId);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.restartListAtInternal = function (selection, listId) {\n        var numberingInfo = this.getContinueNumberingInfo(selection.start.paragraph);\n        this.changeRestartNumbering(numberingInfo.currentList, selection.start.paragraph, listId);\n        this.reLayout(selection, false);\n        this.incrementListNumber = -1;\n        this.refListNumber = undefined;\n        this.viewer.updateFocus();\n    };\n    Editor.prototype.changeRestartNumbering = function (list, block, listId) {\n        if (isNullOrUndefined(block)) {\n            return;\n        }\n        if (block instanceof ParagraphWidget) {\n            if (list.listId === block.paragraphFormat.listFormat.listId) {\n                if (this.editorHistory) {\n                    var baseHistoryInfo = this.editorHistory.currentBaseHistoryInfo;\n                    if (!isNullOrUndefined(baseHistoryInfo)) {\n                        listId = baseHistoryInfo.addModifiedPropertiesForRestartNumbering(block.paragraphFormat.listFormat, listId);\n                    }\n                }\n                block.paragraphFormat.listFormat.listId = listId;\n                if (this.refListNumber !== block.paragraphFormat.listFormat.listLevelNumber) {\n                    this.incrementListNumber += 1;\n                    this.refListNumber = block.paragraphFormat.listFormat.listLevelNumber;\n                }\n                block.paragraphFormat.listFormat.listLevelNumber = this.incrementListNumber;\n                this.viewer.layout.reLayoutParagraph(block, 0, 0);\n            }\n        }\n        return this.changeRestartNumbering(list, block.nextRenderedWidget, listId);\n    };\n    Editor.prototype.createListLevels = function (abstractList, currentListLevel, list) {\n        var levelPattern = currentListLevel.listLevelPattern;\n        var levelPatterns = [];\n        var currentAbstractList = currentListLevel.ownerBase;\n        for (var i = 0; i < 3; i++) {\n            var listLevel = currentAbstractList.levels[i];\n            if (!isNullOrUndefined(listLevel)) {\n                levelPatterns.push(listLevel.listLevelPattern);\n            }\n        }\n        var indexOfLevelPattern = levelPatterns.indexOf(levelPattern) === -1 ? 0 : levelPatterns.indexOf(levelPattern);\n        var numberFormat = currentListLevel.numberFormat.charAt(currentListLevel.numberFormat.length - 1);\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var listLevel = new WListLevel(abstractList);\n            if (i === 0) {\n                listLevel.listLevelPattern = levelPattern;\n            }\n            else {\n                if (indexOfLevelPattern === 0 || indexOfLevelPattern < levelPatterns.length - 1) {\n                    indexOfLevelPattern++;\n                }\n                else {\n                    indexOfLevelPattern = 0;\n                }\n                listLevel.listLevelPattern = levelPatterns[indexOfLevelPattern];\n            }\n            listLevel.numberFormat = '%' + (i + 1) + numberFormat;\n            listLevel.startAt = 1;\n            listLevel.characterFormat.copyFormat(currentListLevel.characterFormat);\n            listLevel.paragraphFormat.copyFormat(currentListLevel.paragraphFormat);\n            listLevel.restartLevel = i;\n            abstractList.levels.push(listLevel);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormat = function (paragraph, start, end, property, value, update) {\n        this.setOffsetValue(this.selection);\n        paragraph = paragraph.combineWidget(this.viewer);\n        //Apply Paragraph Format for spitted paragraph\n        this.applyParaFormatProperty(paragraph, property, value, update);\n        this.layoutItemBlock(paragraph, false);\n        this.getOffsetValue(this.selection);\n        if (paragraph.equals(end.paragraph)) {\n            return;\n        }\n        this.getNextParagraphForFormatting(paragraph, start, end, property, value, update);\n    };\n    /* tslint:disable-next-line:max-line-length */\n    Editor.prototype.applyCharacterStyle = function (paragraph, start, end, property, value, update) {\n        var paragraphWidget = paragraph.getSplitWidgets();\n        if ((end.paragraph === paragraph || paragraphWidget.indexOf(end.paragraph) !== -1)) {\n            if (((value.type === 'Paragraph') && ((value.link) instanceof WCharacterStyle)) || (value.type === 'Character')) {\n                var obj = (value.type === 'Character') ? value : value.link;\n                this.updateSelectionCharacterFormatting(property, obj, update);\n                return true;\n            }\n        }\n        return false;\n    };\n    // Cell\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatInCell = function (cell, start, end, property, value, update) {\n        var selection = this.viewer.selection;\n        if (end.paragraph.isInsideTable) {\n            var cellContainer = selection.getContainerCellOf(cell, end.paragraph.associatedCell);\n            if (cellContainer.ownerTable.contains(end.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cell, cellContainer);\n                var endCell = selection.getSelectedCell(end.paragraph.associatedCell, cellContainer);\n                if (selection.containsCell(cellContainer, end.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(cellContainer, start, end)) {\n                        value = this.getParaFormatValueInCell(cellContainer, property, value);\n                        this.applyParaFormatCellInternal(cellContainer, property, value, update);\n                    }\n                    else {\n                        if (startCell === cellContainer) {\n                            this.applyParaFormat(start.paragraph, start, end, property, value, update);\n                        }\n                        else {\n                            this.applyParagraphFormatRow(startCell.ownerRow, start, end, property, value, update);\n                        }\n                    }\n                }\n                else {\n                    //Format other selected cells in current table.\n                    this.applyParaFormatTableCell(cellContainer.ownerTable, cellContainer, endCell, property, value, update);\n                }\n            }\n            else {\n                this.applyParagraphFormatRow(cellContainer.ownerRow, start, end, property, value, update);\n            }\n        }\n        else {\n            var wCell = selection.getContainerCell(cell);\n            this.applyParagraphFormatRow(wCell.ownerRow, start, end, property, value, update);\n        }\n    };\n    Editor.prototype.applyParaFormatCellInternal = function (cell, property, value, update) {\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            var block = cell.childWidgets[i];\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormatProperty(block, property, value, update);\n            }\n            else {\n                this.applyParagraphFormatTableInternal(block, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.getParaFormatValueInCell = function (cell, property, value) {\n        if (typeof value === 'boolean') {\n            var firstPara = this.viewer.selection.getFirstParagraph(cell);\n            value = !firstPara.paragraphFormat.getPropertyValue(property);\n        }\n        return value;\n    };\n    // Row\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParagraphFormatRow = function (wRow, start, end, property, value, update) {\n        value = this.getParaFormatValueInCell(wRow.childWidgets[0], property, value);\n        for (var i = wRow.rowIndex; i < wRow.ownerTable.childWidgets.length; i++) {\n            var row = wRow.ownerTable.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && this.viewer.selection.containsRow(row, end.paragraph.associatedCell)) {\n                return;\n            }\n        }\n        this.getNextParagraphForFormatting(wRow.ownerTable, start, end, property, value, update);\n    };\n    // Table\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTableCell = function (table, startCell, endCell, property, value, update) {\n        var selection = this.viewer.selection;\n        var startValue = selection.getCellLeft(startCell.ownerRow, startCell);\n        var endValue = startValue + startCell.cellFormat.cellWidth;\n        var endCellLeft = selection.getCellLeft(endCell.ownerRow, endCell);\n        var endCellRight = endCellLeft + endCell.cellFormat.cellWidth;\n        var cellInfo = this.updateSelectedCellsInTable(startValue, endValue, endCellLeft, endCellRight);\n        startValue = cellInfo.start;\n        endValue = cellInfo.end;\n        var count = table.childWidgets.indexOf(endCell.ownerRow);\n        var isStarted = false;\n        for (var m = table.childWidgets.indexOf(startCell.ownerRow); m <= count; m++) {\n            var row = table.childWidgets[m];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var left = selection.getCellLeft(row, row.childWidgets[j]);\n                if (Math.round(startValue) <= Math.round(left) && Math.round(left) < Math.round(endValue)) {\n                    if (!isStarted) {\n                        value = this.getParaFormatValueInCell(row.childWidgets[j], property, value);\n                        isStarted = true;\n                    }\n                    this.applyParaFormatCellInternal(row.childWidgets[j], property, value, update);\n                }\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyParaFormatTable = function (table, start, end, property, value, update) {\n        table = table.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        for (var m = 0; m < table.childWidgets.length; m++) {\n            var tableRow = table.childWidgets[m];\n            for (var k = 0; k < tableRow.childWidgets.length; k++) {\n                this.applyParaFormatCellInternal(tableRow.childWidgets[k], property, value, update);\n            }\n            if (end.paragraph.isInsideTable && selection.containsRow(tableRow, end.paragraph.associatedCell)) {\n                this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n                return;\n            }\n        }\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        this.getNextParagraphForFormatting(table, start, end, property, value, update);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.getNextParagraphForFormatting = function (block, start, end, property, value, update) {\n        var widgetCollection = block.getSplitWidgets();\n        block = widgetCollection[widgetCollection.length - 1];\n        block = this.viewer.selection.getNextRenderedBlock(block);\n        if (!isNullOrUndefined(block)) { //Goto the next block.\n            if (block instanceof ParagraphWidget) {\n                this.applyParaFormat(block, start, end, property, value, update);\n            }\n            else {\n                this.applyParaFormatTable(block, start, end, property, value, update);\n            }\n        }\n    };\n    Editor.prototype.applyParagraphFormatTableInternal = function (table, property, value, update) {\n        for (var x = 0; x < table.childWidgets.length; x++) {\n            var row = table.childWidgets[x];\n            for (var y = 0; y < row.childWidgets.length; y++) {\n                this.applyParaFormatCellInternal(row.childWidgets[y], property, value, update);\n            }\n        }\n    };\n    //Paragraph Format apply implementation Ends\n    // Apply Selection Section Format Option Implementation Starts\n    /**\n     * Apply section format selection changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplySectionFormat = function (property, value) {\n        if (!isNullOrUndefined(property)) {\n            var action = (property[0].toUpperCase() + property.slice(1));\n            this.initHistory(action);\n        }\n        else {\n            this.initHistory('SectionFormat');\n        }\n        this.updateSectionFormat(property, value);\n    };\n    /**\n     * Update section format\n     * @param  {string} property\n     * @param  {Object} value\n     * @returns TextPosition\n     * @private\n     */\n    Editor.prototype.updateSectionFormat = function (property, value) {\n        var selection = this.viewer.selection;\n        selection.owner.isShiftingEnabled = true;\n        var startPosition = selection.start;\n        var endPosition = selection.end;\n        if (!selection.isForward) {\n            startPosition = selection.end;\n            endPosition = selection.start;\n        }\n        var startPageIndex;\n        var endPageIndex;\n        this.viewer.clearContent();\n        var startSectionIndex = startPosition.paragraph.containerWidget.index;\n        var endSectionIndex = endPosition.paragraph.containerWidget.index;\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            if (this.viewer.pages[i].bodyWidgets[0].index === startSectionIndex) {\n                startPageIndex = i;\n                break;\n            }\n        }\n        for (var i = startPageIndex; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            endPageIndex = i;\n            if ((bodyWidget.index === startSectionIndex)) {\n                continue;\n            }\n            else if ((bodyWidget.index >= startSectionIndex) && bodyWidget.index <= endSectionIndex) {\n                continue;\n            }\n            else {\n                endPageIndex = i - 1;\n                break;\n            }\n        }\n        // let startPageIndex: number = this.viewer.pages.indexOf((selection.start.paragraph.containerWidget as BodyWidget).page);\n        // let endPageIndex: number = this.viewer.pages.indexOf((selection.end.paragraph.containerWidget as BodyWidget).page);\n        var update = true;\n        var index = 0;\n        for (var i = startPageIndex; i <= endPageIndex; i++) {\n            if (index !== this.viewer.pages[i].bodyWidgets[0].index && !update) {\n                update = true;\n            }\n            this.applyPropertyValueForSection(this.viewer.pages[i].bodyWidgets[0].sectionFormat, property, value, update);\n            index = this.viewer.pages[i].bodyWidgets[0].index;\n            update = false;\n        }\n        this.layoutWholeDocument();\n        this.fireContentChange();\n    };\n    //Apply Selection Table Format option implementation starts\n    /**\n     * Apply table format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableFormat = function (property, value) {\n        var action = this.getTableFormatAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyTablePropertyValue(selection, property, value, table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        table.calculateGrid();\n        this.selection.owner.isLayoutEnabled = true;\n        this.viewer.layout.reLayoutTable(table);\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableFormatAction = function (property) {\n        switch (property) {\n            case 'tableAlignment':\n                return 'TableAlignment';\n            case 'leftIndent':\n                return 'TableLeftIndent';\n            case 'leftMargin':\n                return 'DefaultCellLeftMargin';\n            case 'rightMargin':\n                return 'DefaultCellRightMargin';\n            case 'bottomMargin':\n                return 'DefaultCellBottomMargin';\n            case 'topMargin':\n                return 'DefaultCellTopMargin';\n            case 'preferredWidth':\n                return 'TablePreferredWidth';\n            case 'preferredWidthType':\n                return 'TablePreferredWidthType';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'DefaultCellSpacing';\n        }\n    };\n    // Apply Selection Row Format Option Implementation Starts\n    /**\n     * Apply table row format property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableRowFormat = function (property, value) {\n        var action = this.getRowAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            var table = selection.start.paragraph.associatedCell.ownerRow.ownerTable;\n            this.applyRowPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.ownerRow);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getRowAction = function (property) {\n        switch (property) {\n            case 'height':\n                return 'RowHeight';\n            case 'heightType':\n                return 'RowHeightType';\n            case 'isHeader':\n                return 'RowHeader';\n            default:\n                return 'AllowBreakAcrossPages';\n        }\n    };\n    /**\n     * Apply table cell property changes\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.onApplyTableCellFormat = function (property, value) {\n        var action = this.getTableCellAction(property);\n        this.viewer.owner.isShiftingEnabled = true;\n        var selection = this.viewer.selection;\n        var table = selection.start.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (selection.isEmpty) {\n            this.initHistory(action);\n            this.applyCellPropertyValue(selection, property, value, selection.start.paragraph.associatedCell.cellFormat);\n            table.calculateGrid();\n            this.selection.owner.isLayoutEnabled = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n        else {\n            this.updateSelectionTableFormat(this.selection, action, value);\n        }\n        this.reLayout(selection, false);\n    };\n    Editor.prototype.getTableCellAction = function (property) {\n        switch (property) {\n            case 'verticalAlignment':\n                return 'CellContentVerticalAlignment';\n            case 'leftMargin':\n                return 'CellLeftMargin';\n            case 'rightMargin':\n                return 'CellRightMargin';\n            case 'bottomMargin':\n                return 'CellBottomMargin';\n            case 'topMargin':\n                return 'CellTopMargin';\n            case 'preferredWidth':\n                return 'CellPreferredWidth';\n            case 'shading':\n                return 'Shading';\n            default:\n                return 'CellPreferredWidthType';\n        }\n    };\n    Editor.prototype.applyPropertyValueForSection = function (sectionFormat, property, value, update) {\n        var selection = this.viewer.selection;\n        if (update && this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(sectionFormat, property, value);\n        }\n        if (isNullOrUndefined(value)) {\n            return;\n        }\n        if (value instanceof WSectionFormat) {\n            if (isNullOrUndefined(property)) {\n                sectionFormat.copyFormat(value, this.editorHistory);\n            }\n            return;\n        }\n        if (property === 'pageHeight') {\n            sectionFormat.pageHeight = value;\n        }\n        else if (property === 'pageWidth') {\n            sectionFormat.pageWidth = value;\n        }\n        else if (property === 'leftMargin') {\n            sectionFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sectionFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sectionFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sectionFormat.bottomMargin = value;\n        }\n        else if (property === 'differentFirstPage') {\n            sectionFormat.differentFirstPage = value;\n        }\n        else if (property === 'differentOddAndEvenPages') {\n            sectionFormat.differentOddAndEvenPages = value;\n        }\n        else if (property === 'headerDistance') {\n            sectionFormat.headerDistance = value;\n        }\n        else if (property === 'footerDistance') {\n            sectionFormat.footerDistance = value;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutWholeDocument = function () {\n        var startPosition = this.viewer.selection.start;\n        var endPosition = this.viewer.selection.end;\n        if (startPosition.isExistAfter(endPosition)) {\n            startPosition = this.viewer.selection.end;\n            endPosition = this.viewer.selection.start;\n        }\n        var startInfo = this.getParagraphInfo(startPosition);\n        var endInfo = this.getParagraphInfo(startPosition);\n        var startIndex = this.getHierarchicalIndex(startInfo.paragraph, startInfo.offset.toString());\n        var endIndex = this.getHierarchicalIndex(endInfo.paragraph, endInfo.offset.toString());\n        this.viewer.renderedLists.clear();\n        // this.viewer.owner.isLayoutEnabled = true;\n        var sections = this.combineSection();\n        this.viewer.clearContent();\n        this.viewer.layout.layoutItems(sections);\n        this.viewer.owner.isShiftingEnabled = false;\n        this.setPositionForCurrentIndex(startPosition, startIndex);\n        this.setPositionForCurrentIndex(endPosition, endIndex);\n        this.viewer.selection.selectPosition(startPosition, endPosition);\n        this.reLayout(this.viewer.selection);\n    };\n    Editor.prototype.combineSection = function () {\n        var sections = [];\n        var nextSection = this.viewer.pages[0].bodyWidgets[0];\n        do {\n            nextSection = this.combineSectionChild(nextSection, sections);\n        } while (nextSection);\n        return sections;\n    };\n    Editor.prototype.combineSectionChild = function (bodyWidget, sections) {\n        var previousBodyWidget = bodyWidget;\n        var temp = new BodyWidget();\n        temp.sectionFormat = bodyWidget.sectionFormat;\n        temp.index = previousBodyWidget.index;\n        do {\n            previousBodyWidget = bodyWidget;\n            if (bodyWidget.lastChild) {\n                bodyWidget.lastChild.combineWidget(this.viewer);\n            }\n            bodyWidget = bodyWidget.nextRenderedWidget;\n            for (var j = 0; j < previousBodyWidget.childWidgets.length; j++) {\n                var block = previousBodyWidget.childWidgets[j];\n                if (block instanceof TableWidget) {\n                    this.viewer.layout.clearTableWidget(block, true, true);\n                }\n                else {\n                    block.x = 0;\n                    block.y = 0;\n                    block.width = 0;\n                    block.height = 0;\n                }\n                temp.childWidgets.push(block);\n                previousBodyWidget.childWidgets.splice(j, 1);\n                j--;\n                block.containerWidget = temp;\n            }\n            previousBodyWidget.page.destroy();\n            // this.viewer.pages.splice(previousBodyWidget.page.index, 1);\n        } while (bodyWidget && previousBodyWidget.equals(bodyWidget));\n        sections.push(temp);\n        return bodyWidget;\n    };\n    Editor.prototype.updateSelectionTableFormat = function (selection, action, value) {\n        switch (action) {\n            case 'TableAlignment':\n                this.editorHistory.initializeHistory('TableAlignment');\n                this.updateTableFormat(selection, 'tableAlignment', value);\n                break;\n            case 'TableLeftIndent':\n                this.editorHistory.initializeHistory('TableLeftIndent');\n                this.updateTableFormat(selection, 'leftIndent', value);\n                break;\n            case 'DefaultCellSpacing':\n                this.editorHistory.initializeHistory('DefaultCellSpacing');\n                this.updateTableFormat(selection, 'cellSpacing', value);\n                break;\n            case 'DefaultCellLeftMargin':\n                this.editorHistory.initializeHistory('DefaultCellLeftMargin');\n                this.updateTableFormat(selection, 'leftMargin', value);\n                break;\n            case 'DefaultCellRightMargin':\n                this.editorHistory.initializeHistory('DefaultCellRightMargin');\n                this.updateTableFormat(selection, 'rightMargin', value);\n                break;\n            case 'DefaultCellTopMargin':\n                this.editorHistory.initializeHistory('DefaultCellTopMargin');\n                this.updateTableFormat(selection, 'topMargin', value);\n                break;\n            case 'TablePreferredWidth':\n                this.editorHistory.initializeHistory('TablePreferredWidth');\n                this.updateTableFormat(selection, 'preferredWidth', value);\n                break;\n            case 'TablePreferredWidthType':\n                this.editorHistory.initializeHistory('TablePreferredWidthType');\n                this.updateTableFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'DefaultCellBottomMargin':\n                this.editorHistory.initializeHistory('DefaultCellBottomMargin');\n                this.updateTableFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellContentVerticalAlignment':\n                this.editorHistory.initializeHistory('CellContentVerticalAlignment');\n                this.updateCellFormat(selection, 'verticalAlignment', value);\n                break;\n            case 'CellLeftMargin':\n                this.editorHistory.initializeHistory('CellLeftMargin');\n                this.updateCellFormat(selection, 'leftMargin', value);\n                break;\n            case 'CellRightMargin':\n                this.editorHistory.initializeHistory('CellRightMargin');\n                this.updateCellFormat(selection, 'rightMargin', value);\n                break;\n            case 'CellTopMargin':\n                this.editorHistory.initializeHistory('CellTopMargin');\n                this.updateCellFormat(selection, 'topMargin', value);\n                break;\n            case 'CellBottomMargin':\n                this.editorHistory.initializeHistory('CellBottomMargin');\n                this.updateCellFormat(selection, 'bottomMargin', value);\n                break;\n            case 'CellPreferredWidth':\n                this.editorHistory.initializeHistory('CellPreferredWidth');\n                this.updateCellFormat(selection, 'preferredWidth', value);\n                break;\n            case 'CellPreferredWidthType':\n                this.editorHistory.initializeHistory('CellPreferredWidthType');\n                this.updateCellFormat(selection, 'preferredWidthType', value);\n                break;\n            case 'Shading':\n                this.editorHistory.initializeHistory('Shading');\n                this.updateCellFormat(selection, 'shading', value);\n                break;\n            case 'RowHeight':\n                this.editorHistory.initializeHistory('RowHeight');\n                this.updateRowFormat(selection, 'height', value);\n                break;\n            case 'RowHeightType':\n                this.editorHistory.initializeHistory('RowHeightType');\n                this.updateRowFormat(selection, 'heightType', value);\n                break;\n            case 'RowHeader':\n                this.editorHistory.initializeHistory('RowHeader');\n                this.updateRowFormat(selection, 'isHeader', value);\n                break;\n            case 'AllowBreakAcrossPages':\n                this.editorHistory.initializeHistory('AllowBreakAcrossPages');\n                this.updateRowFormat(selection, 'allowBreakAcrossPages', value);\n                break;\n        }\n    };\n    // Update Table Properties\n    /**\n     * Update Table Format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {object} value\n     * @private\n     */\n    Editor.prototype.updateTableFormat = function (selection, property, value) {\n        var tableStartPosition = selection.start;\n        var tableEndPosition = selection.end;\n        if (!selection.isForward) {\n            tableStartPosition = selection.end;\n            tableEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, tableStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyTablePropertyValue(selection, property, value, tableStartPosition.paragraph.associatedCell.ownerTable);\n    };\n    /**\n     * update cell format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateCellFormat = function (selection, property, value) {\n        selection.owner.isShiftingEnabled = true;\n        var newStartPosition = selection.start;\n        var newEndPosition = selection.end;\n        if (!selection.isForward) {\n            newStartPosition = selection.end;\n            newEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, newStartPosition);\n        this.updateFormatForCell(selection, property, value);\n    };\n    /**\n     * update row format on undo\n     * @param  {Selection} selection\n     * @param  {SelectionRange} selectionRange\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    Editor.prototype.updateRowFormat = function (selection, property, value) {\n        var rowStartPosition = selection.start;\n        var rowEndPosition = selection.end;\n        if (!selection.isForward) {\n            rowStartPosition = selection.end;\n            rowEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, rowStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.applyRowFormat(rowStartPosition.paragraph.associatedCell.ownerRow, rowStartPosition, rowEndPosition, property, value);\n    };\n    Editor.prototype.initHistoryPosition = function (selection, position) {\n        if (this.viewer.owner.editorHistoryModule && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (!isNullOrUndefined(position)) {\n                if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                    this.editorHistory.currentBaseHistoryInfo.insertPosition = position.getHierarchicalIndexInternal();\n                }\n            }\n            else if (isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.start.getHierarchicalIndexInternal();\n            }\n        }\n    };\n    Editor.prototype.startSelectionReLayouting = function (paragraph, selection, start, end) {\n        selection.owner.isLayoutEnabled = true;\n        if (start.paragraph.isInsideTable) {\n            var table = start.paragraph.associatedCell.ownerTable;\n            while (table.isInsideTable) {\n                table = table.associatedCell.ownerTable;\n            }\n            this.reLayoutSelectionOfTable(table, selection, start, end);\n        }\n        else {\n            this.reLayoutSelection(paragraph, selection, start, end);\n        }\n    };\n    Editor.prototype.reLayoutSelectionOfTable = function (table, selection, start, end) {\n        var isEnded = false;\n        this.viewer.layout.layoutBodyWidgetCollection(table.index, table.containerWidget, table, false);\n        // If the selection ends in the current table, need to stop relayouting.\n        if (!isNullOrUndefined(end.paragraph.associatedCell) && table.contains(end.paragraph.associatedCell)) {\n            return true;\n        }\n        var block = selection.getNextRenderedBlock(table);\n        // Relayout the next block.\n        if (!isNullOrUndefined(block)) {\n            isEnded = this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return isEnded;\n    };\n    Editor.prototype.reLayoutSelection = function (paragraph, selection, start, end) {\n        if (start.paragraph === paragraph) {\n            var startOffset = start.offset;\n            var length_2 = selection.getParagraphLength(paragraph);\n            var indexInInline = 0;\n            var index = 0;\n            var inlineObj = paragraph.getInline(start.offset, indexInInline);\n            var inline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            if (!isNullOrUndefined(inline)) {\n                if (indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n                    inline = inline.nextNode;\n                }\n                index = inline.line.children.indexOf(inline);\n            }\n            var lineIndex = 0;\n            if (start.currentWidget.paragraph === paragraph) {\n                lineIndex = paragraph.childWidgets.indexOf(start.currentWidget);\n                index = start.currentWidget.children.indexOf(inline);\n            }\n            // If selection start inline is at new inline, need to relayout from the previous inline.\n            if (inline instanceof TextElementBox && !inline.line && index > 0) {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index - 1);\n            }\n            else {\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, index);\n            }\n        }\n        else {\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n        // If the selection ends at the current paragraph, need to stop relayouting.\n        if (end.paragraph === paragraph) {\n            return true;\n        }\n        // _Relayout the next block.\n        var block = selection.getNextRenderedBlock(paragraph);\n        if (!isNullOrUndefined(block)) {\n            return this.reLayoutSelectionOfBlock(block, selection, start, end);\n        }\n        return false;\n    };\n    //Relayouting Start    \n    Editor.prototype.reLayoutSelectionOfBlock = function (block, selection, start, end) {\n        if (block instanceof ParagraphWidget) {\n            return this.reLayoutSelection(block, selection, start, end);\n        }\n        else {\n            return undefined;\n            // return this.reLayoutSelectionOfTable(block as TableWidget, selection, start, end);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.layoutItemBlock = function (block, shiftNextWidget) {\n        var section = undefined;\n        if (block.containerWidget instanceof BlockContainer) {\n            section = block.containerWidget;\n            var index = section.childWidgets.indexOf(block);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.layout.layoutBodyWidgetCollection(block.index, section, block, false);\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cell = block.containerWidget;\n            cell = this.viewer.selection.getContainerCell(cell);\n            if (!isNullOrUndefined(this.viewer.owner)\n                && this.viewer.owner.isLayoutEnabled) {\n                this.viewer.layout.reLayoutTable(block);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeSelectedContents = function (selection) {\n        return this.removeSelectedContentInternal(selection, selection.start, selection.end);\n    };\n    Editor.prototype.removeSelectedContentInternal = function (selection, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        // tslint:disable-next-line:max-line-length\n        if (startPos.paragraph === endPos.paragraph && startPos.paragraph.childWidgets.indexOf(startPos.currentWidget) === startPos.paragraph.childWidgets.length - 1 &&\n            startPos.offset === selection.getParagraphLength(startPos.paragraph) && startPos.offset + 1 === endPos.offset) {\n            selection.owner.isShiftingEnabled = true;\n            selection.selectContent(startPos, true);\n            return true;\n        }\n        var paragraphInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(paragraphInfo.paragraph, paragraphInfo.offset.toString());\n        var isRemoved = this.removeSelectedContent(endPos.paragraph, selection, startPos, endPos);\n        var textPosition = new TextPosition(selection.owner);\n        this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n        selection.selectContent(textPosition, true);\n        return isRemoved;\n    };\n    Editor.prototype.removeSelectedContent = function (paragraph, selection, start, end) {\n        //If end is not table end and start is outside the table, then skip removing the contents and move caret to start position.\n        if (end.paragraph.isInsideTable\n            && end.paragraph !== selection.getLastParagraphInLastCell(end.paragraph.associatedCell.ownerTable)\n            && (!start.paragraph.isInsideTable || start.paragraph.associatedCell.ownerTable !== end.paragraph.associatedCell.ownerTable)) {\n            return false;\n        }\n        selection.owner.isShiftingEnabled = true;\n        this.deleteSelectedContent(paragraph, selection, start, end, 2);\n        return true;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContent = function (paragraph, selection, start, end, editAction) {\n        var indexInInline = 0;\n        var inlineObj = start.currentWidget.getInline(start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldBegin && !isNullOrUndefined((inline as WFieldBegin).fieldEnd)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldEndOffset: number = ((inline as WFieldBegin).fieldEnd.owner as WParagraph).getOffset((inline as WFieldBegin).fieldEnd, 1);\n        //     let fieldEndIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldBegin).fieldEnd.owner as WParagraph, fieldEndOffset.toString());\n        //     let selectionEndIndex: string = end.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(fieldEndIndex, selectionEndIndex)) {\n        //         //If selection end is after field begin, moves selection start to field separator.\n        //         start.moveToInline((inline as WFieldBegin).fieldSeparator, 1);\n        //         selection.editPosition = start.getHierarchicalIndexInternal();\n        //         if (!isNullOrUndefined(selection.currentBaseHistoryInfo)) {\n        //             selection.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n        //         }\n        //     }\n        // }\n        indexInInline = 0;\n        inlineObj = end.currentWidget.getInline(end.offset, indexInInline);\n        inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        // if (!isNullOrUndefined(inline)) {\n        //     inline = selection.getNextRenderedInline(inline, indexInInline);\n        // }\n        // if (inline instanceof WFieldEnd && !isNullOrUndefined((inline as WFieldEnd).fieldBegin)) {\n        // tslint:disable-next-line:max-line-length\n        //     let fieldBeginOffset: number = ((inline as WFieldEnd).fieldBegin.owner as WParagraph).getOffset((inline as WFieldEnd).fieldBegin, 0);\n        //     let fieldBeginIndex: string = WordDocument.getHierarchicalIndexOf((inline as WFieldEnd).fieldBegin.owner as WParagraph, fieldBeginOffset.toString());\n        //     let selectionStartIndex: string = start.getHierarchicalIndexInternal();\n        //     if (!TextPosition.isForwardSelection(selectionStartIndex, fieldBeginIndex)) {\n        //         //If field begin is before selection start, move selection end to inline item before field end.\n        //         let prevInline: WInline = selection.getPreviousTextInline(inline);\n        //         if (isNullOrUndefined(prevInline)) {\n        //             end.moveBackward();\n        //         } else {\n        //             end.moveToInline(prevInline, prevInline.length);\n        //         }\n        //     }\n        // }\n        if (end.paragraph !== paragraph) {\n            this.deleteSelectedContent(end.paragraph, selection, start, end, editAction);\n            return;\n        }\n        //  Selection start in cell.\n        if (end.paragraph.isInsideTable && (!start.paragraph.isInsideTable\n            || start.paragraph.associatedCell !== end.paragraph.associatedCell\n            || selection.isCellSelected(end.paragraph.associatedCell, start, end))) {\n            end.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.deleteTableCell(end.paragraph.associatedCell, selection, start, end, editAction);\n        }\n        else {\n            this.deletePara(paragraph, start, end, editAction);\n        }\n    };\n    /**\n     * Merge the selected cells.\n     */\n    Editor.prototype.mergeCells = function () {\n        if (this.owner.isReadOnlyMode || !this.owner.isDocumentLoaded) {\n            return;\n        }\n        if (!isNullOrUndefined(this.viewer) && !this.selection.isEmpty) {\n            this.mergeSelectedCellsInTable();\n        }\n    };\n    /**\n     * Deletes the entire table at selection.\n     */\n    Editor.prototype.deleteTable = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var table = this.getOwnerTable(this.selection.isForward).combineWidget(this.viewer);\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteTable');\n                //Sets the insert position in history info as current table.    \n                this.updateHistoryPosition(startPos, true);\n            }\n            var paragraph = this.getParagraphForSelection(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.removedNodes.push(table.clone());\n            }\n            this.removeBlock(table);\n            this.selection.selectParagraph(paragraph, true);\n            if (this.checkIsNotRedoing() || isNullOrUndefined(this.editorHistory)) {\n                this.reLayout(this.selection);\n            }\n        }\n    };\n    /**\n     * Deletes the selected column(s).\n     */\n    Editor.prototype.deleteColumn = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        if (startPos.paragraph.isInsideTable) {\n            this.selection.owner.isShiftingEnabled = true;\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteColumn');\n            }\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (endCell.nextWidget) {\n                var nextCell = endCell.nextWidget;\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            else if (startCell.previousWidget) {\n                var previousCell = startCell.previousWidget;\n                paragraph = this.selection.getFirstParagraph(previousCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            //retrieve the cell collection based on start and end cell to remove. \n            var deleteCells = table.getColumnCellsForSelection(startCell, endCell);\n            for (var i = 0; i < table.childWidgets.length; i++) {\n                var row = table.childWidgets[i];\n                if (row.childWidgets.length === 1) {\n                    if (deleteCells.indexOf(row.childWidgets[0]) >= 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n                else {\n                    for (var j = 0; j < row.childWidgets.length; j++) {\n                        var tableCell = row.childWidgets[j];\n                        if (deleteCells.indexOf(tableCell) >= 0) {\n                            row.childWidgets.splice(j, 1);\n                            tableCell.destroy();\n                            j--;\n                        }\n                    }\n                    if (row.childWidgets.length === 0) {\n                        table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n                        row.destroy();\n                        i--;\n                    }\n                }\n            }\n            if (table.childWidgets.length === 0) {\n                // Before disposing table reset the paragrph.\n                paragraph = this.getParagraphForSelection(table);\n                this.removeBlock(table);\n                if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                    this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                }\n                table.destroy();\n            }\n            else {\n                table.isGridUpdated = false;\n                table.buildTableColumns();\n                table.isGridUpdated = true;\n                this.viewer.layout.reLayoutTable(table);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    /**\n     * Deletes the selected row(s).\n     */\n    Editor.prototype.deleteRow = function () {\n        if (this.owner.isReadOnlyMode) {\n            return;\n        }\n        var startPos = !this.selection.isForward ? this.selection.end : this.selection.start;\n        var endPos = !this.selection.isForward ? this.selection.start : this.selection.end;\n        if (startPos.paragraph.isInsideTable) {\n            var startCell = this.getOwnerCell(this.selection.isForward);\n            var endCell = this.getOwnerCell(!this.selection.isForward);\n            if (this.checkIsNotRedoing()) {\n                this.initHistory('DeleteRow');\n            }\n            this.selection.owner.isShiftingEnabled = true;\n            var table = startCell.ownerTable.combineWidget(this.viewer);\n            var row = this.getOwnerRow(true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.cloneTableToHistoryInfo(table);\n            }\n            var paragraph = undefined;\n            if (row.nextWidget) {\n                var nextCell = row.nextWidget.childWidgets[0];\n                paragraph = this.selection.getFirstParagraph(nextCell);\n            }\n            if (isNullOrUndefined(paragraph)) {\n                paragraph = this.getParagraphForSelection(table);\n            }\n            if (!this.selection.isEmpty) {\n                //tslint:disable-next-line:max-line-length\n                var containerCell = this.selection.getContainerCellOf(startCell, endCell);\n                if (containerCell.ownerTable.contains(endCell)) {\n                    startCell = this.selection.getSelectedCell(startCell, containerCell);\n                    endCell = this.selection.getSelectedCell(endCell, containerCell);\n                    if (this.selection.containsCell(containerCell, endCell)) {\n                        row = startCell.ownerRow;\n                        this.removeRow(row);\n                    }\n                    else {\n                        row = startCell.ownerRow;\n                        var endRow = endCell.ownerRow;\n                        //Update the selection paragraph.\n                        paragraph = undefined;\n                        if (endRow.nextWidget) {\n                            var nextCell = endRow.nextWidget.childWidgets[0];\n                            paragraph = this.selection.getFirstParagraph(nextCell);\n                        }\n                        if (isNullOrUndefined(paragraph)) {\n                            paragraph = this.getParagraphForSelection(table);\n                        }\n                        for (var i = 0; i < table.childWidgets.length; i++) {\n                            var tableRow = table.childWidgets[i];\n                            if (tableRow.rowIndex >= row.rowIndex && tableRow.rowIndex <= endRow.rowIndex) {\n                                table.childWidgets.splice(i, 1);\n                                tableRow.destroy();\n                                i--;\n                            }\n                        }\n                        if (table.childWidgets.length === 0) {\n                            this.removeBlock(table);\n                            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                                this.editorHistory.currentBaseHistoryInfo.action = 'DeleteTable';\n                            }\n                            table.destroy();\n                        }\n                        else {\n                            this.updateTable(table);\n                        }\n                    }\n                }\n            }\n            else {\n                this.removeRow(row);\n            }\n            this.selection.selectParagraph(paragraph, true);\n            if (isNullOrUndefined(this.editorHistory) || this.checkIsNotRedoing()) {\n                this.reLayout(this.selection, true);\n            }\n        }\n    };\n    Editor.prototype.removeRow = function (row) {\n        var table = row.ownerTable;\n        if (table.childWidgets.length === 1) {\n            this.removeBlock(table);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                this.editorHistory.currentBaseHistoryInfo.action = 'Delete';\n            }\n            table.destroy();\n        }\n        else {\n            table.childWidgets.splice(table.childWidgets.indexOf(row), 1);\n            row.destroy();\n            this.updateTable(table);\n        }\n    };\n    Editor.prototype.updateTable = function (table) {\n        table.updateRowIndex(0);\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.viewer.layout.reLayoutTable(table);\n    };\n    Editor.prototype.getParagraphForSelection = function (table) {\n        var paragraph = undefined;\n        var nextWidget = table.nextWidget ? table.nextWidget : table.nextRenderedWidget;\n        var previousWidget = table.previousWidget ? table.previousWidget : table.previousRenderedWidget;\n        if (nextWidget) {\n            paragraph = nextWidget instanceof ParagraphWidget ? nextWidget\n                : this.selection.getFirstParagraphInFirstCell(nextWidget);\n        }\n        else if (previousWidget) {\n            paragraph = previousWidget instanceof ParagraphWidget ? previousWidget\n                : this.selection.getLastParagraphInLastCell(previousWidget);\n        }\n        return paragraph;\n    };\n    Editor.prototype.deletePara = function (paragraph, start, end, editAction) {\n        paragraph = paragraph.combineWidget(this.viewer);\n        var selection = this.viewer.selection;\n        var paragraphStart = selection.getStartOffset(paragraph);\n        var endParagraphStartOffset = selection.getStartOffset(end.paragraph);\n        var startOffset = paragraphStart;\n        var endOffset = 0;\n        var isCombineNextParagraph = false;\n        var lastLinelength = this.selection.getLineLength(paragraph.lastChild);\n        var currentParagraph = paragraph;\n        var section = paragraph.bodyWidget instanceof BodyWidget ? paragraph.bodyWidget : undefined;\n        var startLine = undefined;\n        var endLineWidget = undefined;\n        if (paragraph === start.paragraph) {\n            startOffset = start.offset;\n            startLine = start.currentWidget;\n            if (end.paragraph.isInsideTable) {\n                isCombineNextParagraph = this.isEndInAdjacentTable(paragraph, end.paragraph);\n            }\n        }\n        else {\n            startLine = paragraph.firstChild;\n        }\n        if (paragraph !== start.paragraph && selection.isSkipLayouting) {\n            selection.isSkipLayouting = false;\n        }\n        if (paragraph === end.paragraph) {\n            endLineWidget = end.currentWidget;\n            endOffset = end.offset;\n        }\n        else {\n            endLineWidget = paragraph.lastChild;\n            endOffset = this.viewer.selection.getLineLength(paragraph.lastChild);\n        }\n        var block = paragraph.previousRenderedWidget;\n        if (startOffset > paragraphStart && start.currentWidget === paragraph.lastChild &&\n            startOffset === lastLinelength && (paragraph === end.paragraph && end.offset === startOffset + 1 ||\n            paragraph.nextRenderedWidget === end.paragraph && end.offset === endParagraphStartOffset) ||\n            (this.editorHistory && this.editorHistory.isUndoing && this.editorHistory.currentHistoryInfo &&\n                this.editorHistory.currentHistoryInfo.action === 'PageBreak' && block && block.isPageBreak()\n                && (startOffset === 0 && !start.currentWidget.isFirstLine || startOffset > 0))) {\n            isCombineNextParagraph = true;\n        }\n        if (end.paragraph === paragraph && end.currentWidget !== paragraph.lastChild ||\n            (end.currentWidget === paragraph.lastChild && end.offset <= selection.getLineLength(paragraph.lastChild))) {\n            var isStartParagraph = start.paragraph === paragraph;\n            if (end.currentWidget.isFirstLine() && end.offset > paragraphStart || !end.currentWidget.isFirstLine()) {\n                //If selection end with this paragraph and selection doesnot include paragraph mark.               \n                this.removeInlines(paragraph, startLine, startOffset, endLineWidget, endOffset, editAction);\n                //Removes the splitted paragraph.\n            }\n            if (!isNullOrUndefined(block) && !isStartParagraph) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                if (nextSection && !section.equals(nextSection) && section.index !== nextSection.index) {\n                    this.deleteSection(selection, nextSection, section, editAction);\n                }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        else if (start.paragraph === paragraph && (start.currentWidget !== paragraph.firstChild ||\n            (start.currentWidget === paragraph.firstChild && startOffset > paragraphStart))) {\n            // If selection start is after paragraph start\n            //And selection does not end with this paragraph Or selection include paragraph mark.\n            if (editAction === 4) {\n                return;\n            }\n            else {\n                currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, startLine, startOffset, true);\n                this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n                this.addRemovedNodes(paragraph);\n                return;\n            }\n        }\n        else {\n            var newParagraph = undefined;\n            var previousBlock = paragraph.previousWidget;\n            var prevParagraph = (previousBlock instanceof ParagraphWidget) ? previousBlock : undefined;\n            var nextWidget = paragraph.nextRenderedWidget;\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner text body and previousBlock is not paragraph.\n                newParagraph = this.checkAndInsertBlock(paragraph, start, end, editAction, prevParagraph);\n                this.removeBlock(paragraph);\n                if (this.viewer.blockToShift === paragraph) {\n                    this.viewer.blockToShift = undefined;\n                }\n                this.addRemovedNodes(paragraph);\n                if (!isNullOrUndefined(newParagraph)) {\n                    selection.editPosition = this.getHierarchicalIndex(newParagraph, '0');\n                    var offset = selection.getParagraphLength(newParagraph) + 1;\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        //tslint:disable-next-line:max-line-length\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, offset.toString());\n                    }\n                }\n                else if (paragraph === start.paragraph && isNullOrUndefined(nextWidget) && !isNullOrUndefined(prevParagraph)) {\n                    var offset = this.selection.getParagraphLength(prevParagraph);\n                    // if (isNullOrUndefined(block)) {\n                    selection.editPosition = this.getHierarchicalIndex(prevParagraph, offset.toString());\n                    if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                        this.updateHistoryPosition(selection.editPosition, true);\n                        this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                    }\n                    // } else {\n                    //     let offset: number = selection.getParagraphLength(paragraph) + 1;\n                    //     if (block instanceof ParagraphWidget) {\n                    //         prevParagraph = block as ParagraphWidget;\n                    //     }\n                    //     // if (block instanceof WTable) {\n                    //     //     prevParagraph = (block as WTable).getFirstParagraphInFirstCell();\n                    //     // }\n                    //     selection.editPosition = prevLineWidget.getHierarchicalIndex('0');\n                    // }\n                }\n            }\n            if (start.paragraph !== paragraph && !isNullOrUndefined(block)) {\n                var nextSection = block.bodyWidget instanceof BodyWidget ? block.bodyWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.deleteSection(selection, section, nextSection, editAction);\n                // }\n                this.deleteBlock(block, selection, start, end, editAction);\n            }\n        }\n        this.insertParagraphPaste(paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction);\n    };\n    Editor.prototype.deleteSection = function (selection, section, nextSection, editAction) {\n        if (editAction < 4) {\n            this.combineSectionInternal(selection, section, nextSection);\n        }\n        //Copies the section properties, if this is last paragraph of section.\n        if (editAction > 2) {\n            section.sectionFormat.copyFormat(nextSection.sectionFormat);\n        }\n    };\n    Editor.prototype.combineSectionInternal = function (selection, section, nextSection) {\n        // if (section.sectionFormat.isEqualFormat(nextSection.sectionFormat)) {\n        // } else {\n        var bodyWidget = section.getSplitWidgets()[0];\n        var currentSection = [];\n        this.combineSectionChild(bodyWidget, currentSection);\n        bodyWidget = currentSection[0];\n        var lastBlockIndex = bodyWidget.lastChild.index;\n        this.updateBlockIndex(lastBlockIndex + 1, nextSection.firstChild);\n        var insertIndex = 0;\n        var containerWidget = nextSection;\n        for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n            var block = bodyWidget.childWidgets.splice(i, 1)[0];\n            containerWidget.childWidgets.splice(insertIndex, 0, block);\n            block.containerWidget = containerWidget;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.bodyWidget, block, false);\n            block = block.getSplitWidgets().pop();\n            containerWidget = block.containerWidget;\n            insertIndex = block.indexInOwner + 1;\n            i--;\n        }\n        this.updateSectionIndex(undefined, nextSection, false);\n        this.addRemovedNodes(bodyWidget);\n        // this.insert\n        // }\n    };\n    //tslint:disable:max-line-length\n    /**\n     * @private\n     */\n    Editor.prototype.checkAndInsertBlock = function (block, start, end, editAction, previousParagraph) {\n        if (block instanceof ParagraphWidget && block === start.paragraph || block instanceof TableWidget) {\n            var newParagraph = void 0; //Adds an empty paragraph, to ensure minimal content.\n            if (isNullOrUndefined(block.nextWidget) && (isNullOrUndefined(previousParagraph) || previousParagraph.nextRenderedWidget instanceof TableWidget)) {\n                newParagraph = new ParagraphWidget();\n                if (editAction === 1 && block instanceof ParagraphWidget) {\n                    newParagraph.characterFormat.copyFormat(block.characterFormat);\n                    newParagraph.paragraphFormat.copyFormat(block.paragraphFormat);\n                }\n                newParagraph.index = block.index + 1;\n                newParagraph.containerWidget = block.containerWidget;\n                this.viewer.layout.layoutBodyWidgetCollection(newParagraph.index, newParagraph.bodyWidget, newParagraph, false);\n                if (block.containerWidget instanceof Widget) {\n                    block.containerWidget.childWidgets.push(newParagraph);\n                }\n            }\n            return newParagraph;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.splitParagraph = function (paragraphAdv, startLine, startOffset, endLine, endOffset, removeBlock) {\n        var paragraph = new ParagraphWidget();\n        paragraph.paragraphFormat = new WParagraphFormat(paragraph);\n        paragraph.characterFormat = new WCharacterFormat(paragraph);\n        paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n        paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        var blockIndex = paragraphAdv.index;\n        var insertIndex = paragraphAdv.indexInOwner;\n        this.moveInlines(paragraphAdv, paragraph, 0, startOffset, startLine, endOffset, endLine);\n        //Inserts new paragraph in the current text position.\n        paragraphAdv.containerWidget.childWidgets.splice(insertIndex, 0, paragraph);\n        paragraph.index = blockIndex;\n        paragraph.containerWidget = paragraphAdv.containerWidget;\n        this.updateNextBlocksIndex(paragraph, true);\n        if (removeBlock) {\n            this.removeBlock(paragraphAdv);\n        }\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, paragraph.containerWidget, paragraph, false);\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeBlock = function (block) {\n        var index;\n        var blockCollection;\n        var containerWidget;\n        this.removeFieldInBlock(block);\n        if (block.isInsideTable) {\n            containerWidget = block.associatedCell;\n            index = block.associatedCell.childWidgets.indexOf(block);\n            blockCollection = block.associatedCell.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            block.associatedCell.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n        else {\n            containerWidget = block.containerWidget;\n            index = containerWidget.childWidgets.indexOf(block);\n            blockCollection = containerWidget.childWidgets;\n            this.updateNextBlocksIndex(block, false);\n            containerWidget.childWidgets.splice(index, 1);\n            block.containerWidget = undefined;\n            containerWidget.height -= block.height;\n            this.viewer.layout.layoutBodyWidgetCollection(block.index, containerWidget, block, false);\n        }\n    };\n    Editor.prototype.removeField = function (block) {\n        for (var i = 0; i < this.viewer.fields.length; i++) {\n            var field = this.viewer.fields[i];\n            if (field.line.paragraph === block) {\n                this.viewer.fields.splice(i, 1);\n                i--;\n            }\n        }\n    };\n    Editor.prototype.addRemovedNodes = function (node) {\n        if (node instanceof FieldElementBox && node.fieldType === 0) {\n            if (this.viewer.fields.indexOf(node) !== -1) {\n                this.viewer.fields.splice(this.viewer.fields.indexOf(node), 1);\n            }\n        }\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(node);\n        }\n        else if (this.editHyperlinkInternal) {\n            this.nodes.push(node);\n        }\n    };\n    Editor.prototype.deleteBlock = function (block, selection, start, end, editAction) {\n        if (block instanceof ParagraphWidget) {\n            this.deletePara(block, start, end, editAction);\n        }\n        else {\n            this.deleteTableBlock(block, selection, start, end, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteTableCell = function (cellAdv, selection, start, end, editAction) {\n        var deletePreviousBlock = !(start.paragraph.isInsideTable && cellAdv.ownerTable.contains(start.paragraph.associatedCell));\n        var previousBlock = cellAdv.ownerTable.previousRenderedWidget;\n        if (start.paragraph.isInsideTable) {\n            var containerCell = selection.getContainerCellOf(cellAdv, start.paragraph.associatedCell);\n            if (containerCell.ownerTable.contains(start.paragraph.associatedCell)) {\n                var startCell = selection.getSelectedCell(cellAdv, containerCell);\n                var endCell = selection.getSelectedCell(start.paragraph.associatedCell, containerCell);\n                if (selection.containsCell(containerCell, start.paragraph.associatedCell)) {\n                    //Selection end is in container cell.\n                    if (selection.isCellSelected(containerCell, start, end)) {\n                        //Container cell is completely selected.\n                        this.updateEditPosition(containerCell, selection);\n                        if (editAction === 1) {\n                            //Specifically handled for backspace. Delete selected cell in current table.\n                            this.deleteCellsInTable(cellAdv.ownerRow.ownerTable, selection, start, end, editAction);\n                        }\n                        else {\n                            //Delete contents within table cell or Copy contents within table cell to clipboard.\n                            var isCellCleared = this.deleteCell(containerCell, selection, editAction, true);\n                            if (!isCellCleared && editAction !== 2 && this.editorHistory) {\n                                this.editorHistory.currentBaseHistoryInfo = undefined;\n                            }\n                        }\n                    }\n                    else {\n                        if (startCell === containerCell) {\n                            this.deletePara(end.paragraph, start, end, editAction);\n                        }\n                        else {\n                            this.deleteContainer(startCell, selection, start, end, editAction);\n                        }\n                    }\n                }\n                else {\n                    if (editAction === 2) {\n                        //Delete contents within table cell.\n                        this.deleteCell(cellAdv, selection, 2, false);\n                    }\n                    else {\n                        //Delete other selected cells in current table.\n                        this.deleteCellsInTable(containerCell.ownerTable, selection, start, end, editAction);\n                    }\n                }\n            }\n            else {\n                //Selection end is different table.\n                this.deleteContainer(containerCell, selection, start, end, editAction);\n            }\n        }\n        else {\n            //Selection end is outside table.\n            var cell = selection.getContainerCell(cellAdv);\n            this.deleteContainer(cell, selection, start, end, editAction);\n        }\n        if (deletePreviousBlock) {\n            var sectionAdv = previousBlock.bodyWidget instanceof BodyWidget ? previousBlock.bodyWidget : undefined;\n            // this.deleteContent(cellAdv.ownerTable, selection, editAction);\n            if (!isNullOrUndefined(previousBlock)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(previousBlock, selection, start, end, editAction);\n            }\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteCellsInTable = function (table, selection, start, end, editAction) {\n        var clonedTable = undefined;\n        var isDeleteCells = false;\n        var action = 'Delete';\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            action = this.editorHistory.currentBaseHistoryInfo.action;\n            //tslint:disable-next-line:max-line-length\n            isDeleteCells = this.editorHistory.currentBaseHistoryInfo.action === 'BackSpace' || this.editorHistory.currentBaseHistoryInfo.action === 'DeleteCells'\n                || this.editorHistory.currentBaseHistoryInfo.action === 'InsertTable' || (isNullOrUndefined(startCell.ownerRow.previousWidget)\n                && isNullOrUndefined(endCell.ownerRow.nextWidget) && this.editorHistory.currentBaseHistoryInfo.action === 'Cut');\n            this.editorHistory.currentBaseHistoryInfo.action = isDeleteCells ? 'DeleteCells' : 'ClearCells';\n            clonedTable = this.cloneTableToHistoryInfo(table);\n            selection.owner.isLayoutEnabled = false;\n        }\n        var startColumnIndex = startCell.columnIndex;\n        var endColumnIndex = endCell.columnIndex + endCell.cellFormat.columnSpan - 1;\n        var startRowIndex = startCell.rowIndex;\n        var endRowIndex = endCell.rowIndex;\n        var cells = [];\n        var isStarted = false;\n        var isCellCleared = false;\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row.index >= startRowIndex && row.index <= endRowIndex) {\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    var cell = row.childWidgets[j];\n                    if (cell.columnIndex >= startColumnIndex && cell.columnIndex <= endColumnIndex) {\n                        if (!isStarted) {\n                            this.updateEditPosition(cell, selection);\n                            isStarted = true;\n                        }\n                        if (isDeleteCells) {\n                            //Specific for Backspace and Cut if selection includes all rows.\n                            var cell_1 = row.childWidgets[j];\n                            this.updateNextBlocksIndex(cell_1, false);\n                            row.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                        else if (editAction < 4) {\n                            isCellCleared = this.deleteCell(cell, selection, editAction, false);\n                        }\n                    }\n                }\n                if (row.childWidgets.length === 0) {\n                    this.updateNextBlocksIndex(table.childWidgets[i], false);\n                    table.childWidgets.splice(i, 1);\n                    i--;\n                    endRowIndex--;\n                }\n            }\n        }\n        //Layouts the table after delete cells.\n        selection.owner.isLayoutEnabled = true;\n        if (table.childWidgets.length === 0) {\n            selection.editPosition = this.getHierarchicalIndex(table, '0');\n            this.setActionInternal(selection, action);\n            this.removeBlock(table);\n        }\n        else {\n            // Before lay outing need to update table grid.\n            table.isGridUpdated = false;\n            table.buildTableColumns();\n            table.isGridUpdated = true;\n            this.viewer.layout.reLayoutTable(table);\n        }\n    };\n    Editor.prototype.deleteCell = function (cell, selection, editAction, copyChildToClipboard) {\n        //Checks whether this is last paragraph of owner textbody.\n        var block = cell.childWidgets[0];\n        if (cell.childWidgets.length === 1 && block instanceof ParagraphWidget && block.isEmpty()) {\n            return false;\n        }\n        for (var i = 0; i < cell.childWidgets.length; i++) {\n            block = cell.childWidgets[i];\n            if (editAction < 4) {\n                //Checks whether this is last paragraph of owner textbody.\n                if (block instanceof ParagraphWidget && cell.childWidgets.length === 1) {\n                    //Preserves empty paragraph, to ensure minimal content.\n                    var paragraph = block;\n                    //Removes all the inlines in the paragraph.\n                    for (var j = 0; j < paragraph.childWidgets.length; j++) {\n                        var inline = paragraph.childWidgets[j];\n                        for (var k = 0; k < inline.children.length; k++) {\n                            var element = inline.children[k];\n                            this.unLinkFieldCharacter(element);\n                            inline.children.splice(k, 1);\n                            // this.layoutInlineCollection(true, paragraph.inlines.indexOf(inline), paragraph.inlines, inline);\n                            k--;\n                            if (this.checkClearCells(selection)) {\n                                this.addRemovedNodes(element);\n                            }\n                        }\n                        if (paragraph.childWidgets.length > 1) {\n                            paragraph.childWidgets.splice(j, 1);\n                            j--;\n                        }\n                    }\n                    if (this.checkClearCells(selection)) {\n                        //Add Index for line Widget\n                        selection.editPosition = this.getHierarchicalIndex(paragraph, '0');\n                        this.updateHistoryPosition(selection.editPosition, true);\n                    }\n                    break;\n                }\n                this.removeBlock(block);\n                i--;\n                if (this.checkClearCells(selection)) {\n                    this.addRemovedNodes(block);\n                }\n            }\n        }\n        return true;\n    };\n    Editor.prototype.deleteContainer = function (cell, selection, start, end, editAction) {\n        var ownerTable = cell.ownerTable;\n        if (selection.containsRow(ownerTable.lastChild, end.paragraph.associatedCell)) {\n            this.deleteContent(ownerTable, selection, editAction);\n        }\n        else {\n            for (var i = 0; i < ownerTable.childWidgets.length; i++) {\n                var row = ownerTable.childWidgets[i];\n                if (editAction < 4) {\n                    this.updateNextBlocksIndex(row, false);\n                    ownerTable.childWidgets.splice(i, 1);\n                    this.addRemovedNodes(row);\n                    i--;\n                }\n                if (end.paragraph.isInsideTable && selection.containsRow(row, end.paragraph.associatedCell)) {\n                    this.viewer.layout.reLayoutTable(ownerTable);\n                    return;\n                }\n            }\n        }\n    };\n    Editor.prototype.deleteTableBlock = function (table, selection, start, end, editAction) {\n        table = table.combineWidget(this.viewer);\n        if (start.paragraph.isInsideTable && table.contains(start.paragraph.associatedCell)) {\n            var block = table.previousRenderedWidget;\n            // tslint:disable-next-line:max-line-length\n            var previousBlock = this.checkAndInsertBlock(table, start, end, editAction, block instanceof ParagraphWidget ? block : undefined);\n            if (selection.containsRow(table.firstChild, start.paragraph.associatedCell)) {\n                this.deleteContent(table, selection, editAction);\n            }\n            else {\n                var newTable = this.splitTable(table, start.paragraph.associatedCell.ownerRow);\n                this.deleteContent(table, selection, editAction);\n                this.viewer.layout.layoutBodyWidgetCollection(newTable.index, newTable.containerWidget, newTable, false);\n            }\n            if (!isNullOrUndefined(previousBlock)) {\n                selection.editPosition = this.getHierarchicalIndex(previousBlock, '0');\n                if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                    this.editorHistory.currentBaseHistoryInfo.endPosition = selection.editPosition;\n                }\n            }\n        }\n        else {\n            var blockAdv = table.previousRenderedWidget;\n            var sectionAdv = table.bodyWidget instanceof BodyWidget ? table.bodyWidget : undefined;\n            this.deleteContent(table, selection, editAction);\n            if (!isNullOrUndefined(blockAdv)) {\n                // let nextSection: WSection = blockAdv.section instanceof WSection ? blockAdv.section as WSection : undefined;\n                // if (sectionAdv !== nextSection) {\n                //     this.deleteSection(selection, sectionAdv, nextSection, editAction);\n                // }\n                //Goto the next block.\n                this.deleteBlock(blockAdv, selection, start, end, editAction);\n            }\n        }\n    };\n    Editor.prototype.splitTable = function (table, splitEndRow) {\n        var newTable = new TableWidget();\n        newTable.tableFormat.copyFormat(table.tableFormat);\n        newTable.index = table.index;\n        //Moves the rows to new table.\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            if (row === splitEndRow) {\n                break;\n            }\n            newTable.childWidgets.push(row);\n            row.containerWidget = newTable;\n            table.childWidgets.splice(i, 1);\n            i--;\n        }\n        //Inserts new table in the current text position.\n        var insertIndex = table.getIndex();\n        table.containerWidget.childWidgets.splice(insertIndex, 0, newTable);\n        newTable.containerWidget = table.containerWidget;\n        this.updateNextBlocksIndex(newTable, true);\n        return newTable;\n    };\n    Editor.prototype.updateEditPosition = function (cell, selection) {\n        var firstParagraph = selection.getFirstParagraphInCell(cell);\n        selection.editPosition = this.getHierarchicalIndex(firstParagraph, '0');\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteContent = function (table, selection, editAction) {\n        if (editAction < 4) {\n            this.removeBlock(table);\n            this.addRemovedNodes(table);\n        }\n    };\n    Editor.prototype.setActionInternal = function (selection, action) {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.editorHistory.currentBaseHistoryInfo.action = action;\n        }\n    };\n    Editor.prototype.checkClearCells = function (selection) {\n        // tslint:disable-next-line:max-line-length\n        return this.editorHistory && this.editorHistory.currentBaseHistoryInfo && this.editorHistory.currentBaseHistoryInfo.action !== 'ClearCells';\n    };\n    Editor.prototype.isEndInAdjacentTable = function (paragraph, endParagraph) {\n        var start = this.getHierarchicalIndex(paragraph, '');\n        var end = this.getHierarchicalIndex(endParagraph, '');\n        var selectionStart = start.split(';');\n        var selectionEnd = end.split(';');\n        return selectionStart.length < selectionEnd.length;\n    };\n    Editor.prototype.cloneTableToHistoryInfo = function (table) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            //Clones the entire table to preserve in history.\n            var clonedTable = table.clone();\n            //Preserves the cloned table in history info, for future undo operation.\n            this.editorHistory.currentBaseHistoryInfo.removedNodes.push(clonedTable);\n            //Sets the insert position in history info as current table.\n            if (this.viewer.selection.start.paragraph.isInsideTable &&\n                this.viewer.selection.start.paragraph.associatedCell.ownerTable === table) {\n                this.updateHistoryPosition(this.getHierarchicalIndex(table, '0'), true);\n            }\n            return clonedTable;\n        }\n        return undefined;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertParagraphPaste = function (paragraph, currentParagraph, start, end, isCombineNextParagraph, editAction) {\n        if (this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing) && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n            var nextParagraph = this.selection.getNextParagraphBlock(currentParagraph);\n            if (nextParagraph) {\n                if (start.offset > 0 && nextParagraph === end.paragraph && paragraph === start.paragraph\n                    && this.editorHistory.currentBaseHistoryInfo.action === 'Paste') {\n                    //Combines the current paragraph with end paragraph specific for undo/redo paste action.\n                    var insertIndex = 0;\n                    this.removeBlock(currentParagraph);\n                    this.viewer.layout.clearListElementBox(nextParagraph);\n                    this.viewer.layout.clearListElementBox(currentParagraph);\n                    for (var i = 0; i < currentParagraph.childWidgets.length; i++) {\n                        var line = currentParagraph.childWidgets[i];\n                        nextParagraph.childWidgets.splice(insertIndex, 0, line);\n                        currentParagraph.childWidgets.splice(i, 1);\n                        i--;\n                        insertIndex++;\n                        line.paragraph = nextParagraph;\n                    }\n                    this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                    isCombineNextParagraph = false;\n                    var offset = this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(';') + 1);\n                    this.selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset);\n                }\n            }\n        }\n        if (isCombineNextParagraph) {\n            this.deleteParagraphMark(currentParagraph, this.selection, editAction);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.removeInlines = function (paragraph, startLine, startOffset, endLine, endOffset, editAction) {\n        var isRemoved = false;\n        this.viewer.layout.clearListElementBox(paragraph);\n        var startIndex = paragraph.childWidgets.indexOf(startLine);\n        for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n            var lineWidget = paragraph.childWidgets[i];\n            if (startLine === lineWidget && endLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, endOffset);\n                isRemoved = true;\n                break;\n            }\n            if (endLine === lineWidget) {\n                isRemoved = true;\n                this.removeContent(lineWidget, 0, endOffset);\n            }\n            else if (startLine === lineWidget) {\n                this.removeContent(lineWidget, startOffset, this.viewer.selection.getLineLength(lineWidget));\n                break;\n            }\n            else if (isRemoved) {\n                this.removeContent(lineWidget, 0, this.viewer.selection.getLineLength(lineWidget));\n            }\n        }\n        if (isRemoved) {\n            this.removeEmptyLine(paragraph);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeContent = function (lineWidget, startOffset, endOffset) {\n        var count = this.selection.getLineLength(lineWidget);\n        for (var i = lineWidget.children.length - 1; i >= 0; i--) {\n            var inline = lineWidget.children[i];\n            if (endOffset <= count - inline.length) {\n                count -= inline.length;\n                continue;\n            }\n            var endIndex = inline.length;\n            if (count > endOffset && (count - endIndex < endOffset)) {\n                endIndex = endOffset - (count - inline.length);\n            }\n            var startIndex = 0;\n            if (count - inline.length < startOffset) {\n                startIndex = startOffset - (count - inline.length);\n            }\n            if (count > endOffset) {\n                count -= (inline.length - endIndex);\n            }\n            if (startIndex === 0 && endIndex === inline.length) {\n                if (!(this.editorHistory && (this.editorHistory.isUndoing || this.editorHistory.isRedoing))) {\n                    if (inline instanceof BookmarkElementBox) {\n                        this.removedBookmarkElements.push(inline);\n                    }\n                }\n                // if (editAction < 4) {\n                this.unLinkFieldCharacter(inline);\n                this.addRemovedNodes(lineWidget.children[i]);\n                lineWidget.children.splice(i, 1);\n                // }\n            }\n            else if (inline instanceof TextElementBox) {\n                // if (editAction < 4) {\n                var span = new TextElementBox();\n                span.characterFormat.copyFormat(inline.characterFormat);\n                span.text = inline.text.substr(startIndex, endIndex - startIndex);\n                this.addRemovedNodes(span);\n                inline.text = inline.text.slice(0, startIndex) + inline.text.slice(endIndex);\n            }\n            if (startOffset >= count - (endIndex - startIndex)) {\n                break;\n            }\n            count -= (endIndex - startIndex);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.removeEmptyLine = function (paragraph) {\n        if (paragraph.childWidgets.length > 1) {\n            for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                var lineWidget = paragraph.childWidgets[i];\n                if (lineWidget.children.length === 0 && paragraph.childWidgets.length > 1) {\n                    paragraph.childWidgets.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n    };\n    //#endregion\n    /**\n     * clone the list level\n     * @param  {WListLevel} source\n     * @private\n     */\n    Editor.prototype.cloneListLevel = function (source) {\n        var listLevel = new WListLevel(undefined);\n        this.copyListLevel(listLevel, source);\n        return listLevel;\n    };\n    /**\n     * Copies the list level\n     * @param  {WListLevel} destination\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    Editor.prototype.copyListLevel = function (destination, listLevel) {\n        if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n            destination.paragraphFormat = new WParagraphFormat(destination);\n            destination.paragraphFormat.copyFormat(listLevel.paragraphFormat);\n        }\n        if (!isNullOrUndefined(listLevel.characterFormat)) {\n            destination.characterFormat = new WCharacterFormat(destination);\n            destination.characterFormat.copyFormat(listLevel.characterFormat);\n        }\n        if (!isNullOrUndefined(listLevel.followCharacter)) {\n            destination.followCharacter = listLevel.followCharacter;\n        }\n        if (!isNullOrUndefined(listLevel.listLevelPattern)) {\n            destination.listLevelPattern = listLevel.listLevelPattern;\n        }\n        if (!isNullOrUndefined(listLevel.numberFormat)) {\n            destination.numberFormat = listLevel.numberFormat;\n        }\n        if (!isNullOrUndefined(listLevel.restartLevel)) {\n            destination.restartLevel = listLevel.restartLevel;\n        }\n        if (!isNullOrUndefined(listLevel.startAt)) {\n            destination.startAt = listLevel.startAt;\n        }\n    };\n    /**\n     * Clone level override\n     * @param  {WLevelOverride} source\n     * @private\n     */\n    Editor.prototype.cloneLevelOverride = function (source) {\n        var levelOverride = new WLevelOverride();\n        if (!isNullOrUndefined(source.startAt)) {\n            levelOverride.startAt = source.startAt;\n        }\n        if (!isNullOrUndefined(source.overrideListLevel)) {\n            levelOverride.overrideListLevel = source.overrideListLevel;\n        }\n        if (!isNullOrUndefined(source.levelNumber)) {\n            levelOverride.levelNumber = source.levelNumber;\n        }\n        return levelOverride;\n    };\n    /**\n     * Update List Paragraph\n     * @private\n     */\n    Editor.prototype.updateListParagraphs = function () {\n        this.viewer.listParagraphs = [];\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var bodyWidget = this.viewer.pages[j].bodyWidgets[0];\n            for (var i = 0; i < bodyWidget.childWidgets.length; i++) {\n                this.updateListParagraphsInBlock(bodyWidget.childWidgets[i]);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateListParagraphsInBlock = function (block) {\n        if (block instanceof ParagraphWidget) {\n            if (!isNullOrUndefined(block.paragraphFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat)\n                && !isNullOrUndefined(block.paragraphFormat.listFormat.listId)) {\n                if (isNullOrUndefined(this.viewer.listParagraphs)) {\n                    this.viewer.listParagraphs = [];\n                }\n                this.viewer.listParagraphs.push(block);\n            }\n        }\n        else if (block instanceof TableWidget) {\n            for (var i = 0; i < block.childWidgets.length; i++) {\n                for (var j = 0; j < block.childWidgets[i].childWidgets.length; j++) {\n                    var cell = block.childWidgets[i].childWidgets[j];\n                    for (var k = 0; k < cell.childWidgets.length; k++) {\n                        this.updateListParagraphsInBlock(cell.childWidgets[k]);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Applies list format\n     * @param  {WList} list\n     * @private\n     */\n    Editor.prototype.onApplyList = function (list) {\n        var selection = this.viewer.selection;\n        this.setOffsetValue(this.viewer.selection);\n        this.initHistory('ListFormat');\n        var format = new WListFormat();\n        if (!isNullOrUndefined(list)) {\n            format.listId = list.listId;\n        }\n        this.viewer.owner.isShiftingEnabled = true;\n        if (selection.isEmpty) {\n            this.applyParaFormatProperty(selection.start.paragraph, 'listFormat', format, false);\n            this.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.updateSelectionParagraphFormatting('listFormat', format, false);\n        }\n        this.reLayout(selection);\n    };\n    /**\n     * Applies bullets or numbering list\n     * @param  {string} format\n     * @param  {ListLevelPattern} listLevelPattern\n     * @param  {string} fontFamily\n     * @private\n     */\n    Editor.prototype.applyBulletOrNumbering = function (format, listLevelPattern, fontFamily) {\n        var selection = this.viewer.selection;\n        var list = selection.paragraphFormat.getList();\n        var isUpdate = false;\n        var start = selection.start;\n        if (!selection.isForward) {\n            start = selection.end;\n        }\n        var currentParagraph = start.paragraph;\n        if (isNullOrUndefined(list)) {\n            while (!isNullOrUndefined(currentParagraph.previousWidget) && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.isEmpty() && currentParagraph.previousWidget.paragraphFormat.listFormat.listId === -1) {\n                currentParagraph = currentParagraph.previousWidget;\n            }\n            if (currentParagraph.previousWidget && currentParagraph.previousWidget instanceof ParagraphWidget\n                && currentParagraph.previousWidget.paragraphFormat.listFormat.listId !== -1) {\n                currentParagraph = currentParagraph.previousWidget;\n                list = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n                isUpdate = true;\n            }\n        }\n        var startListLevel = undefined;\n        if (!isNullOrUndefined(list)) {\n            var tempList = this.viewer.getListById(currentParagraph.paragraphFormat.listFormat.listId);\n            startListLevel = this.viewer.layout.getListLevel(tempList, currentParagraph.paragraphFormat.listFormat.listLevelNumber);\n        }\n        if (isNullOrUndefined(list) || (!isNullOrUndefined(list) && ((startListLevel.listLevelPattern !== listLevelPattern) ||\n            startListLevel.numberFormat !== format || (startListLevel.characterFormat.fontFamily !== fontFamily\n            && startListLevel.listLevelPattern === 'Bullet')))) {\n            isUpdate = false;\n            list = new WList();\n            if (this.viewer.lists.length > 0) {\n                list.listId = this.viewer.lists[this.viewer.lists.length - 1].listId + 1;\n            }\n            else {\n                list.listId = 0;\n            }\n            var abstractList = new WAbstractList();\n            if (this.viewer.abstractLists.length > 0) {\n                abstractList.abstractListId = this.viewer.abstractLists[this.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                abstractList.abstractListId = 0;\n            }\n            list.abstractListId = abstractList.abstractListId;\n            list.abstractList = abstractList;\n            this.viewer.abstractLists.push(abstractList);\n            if (format === 'bullet' || format === 'multiLevel' || format === 'numbering') {\n                this.addListLevels(abstractList, format, selection);\n            }\n            else {\n                var listLevel = new WListLevel(abstractList);\n                listLevel.listLevelPattern = listLevelPattern;\n                listLevel.numberFormat = format;\n                if (listLevelPattern !== 'Bullet') {\n                    listLevel.startAt = 1;\n                }\n                else {\n                    listLevel.characterFormat.fontFamily = fontFamily;\n                }\n                listLevel.paragraphFormat.leftIndent = 36;\n                listLevel.paragraphFormat.firstLineIndent = -18;\n                abstractList.levels.push(listLevel);\n                selection.paragraphFormat.listLevelNumber = 0;\n            }\n            selection.paragraphFormat.setList(list);\n        }\n        else if (!isNullOrUndefined(list) && isUpdate) {\n            selection.paragraphFormat.setList(list);\n        }\n        else {\n            selection.paragraphFormat.setList(undefined);\n        }\n    };\n    Editor.prototype.addListLevels = function (abstractListAdv, listName, selection) {\n        var bulletCharacters = ['\\uf076', '\\uf0d8', '\\uf0a7', '\\uf0b7', '\\uf0a8'];\n        for (var i = abstractListAdv.levels.length; i < 9; i++) {\n            var listLevel = new WListLevel(abstractListAdv);\n            if (listName.match('bullet')) {\n                listLevel.listLevelPattern = 'Bullet';\n                listLevel.numberFormat = bulletCharacters[i < 5 ? i % 5 : i % 5 + 1];\n                listLevel.characterFormat.fontFamily = i < 3 || i === 5 ? 'Wingdings' : 'Symbol';\n            }\n            else {\n                if (listName.match('multiLevel')) {\n                    for (var j = 0; j < i + 1; j++) {\n                        listLevel.numberFormat += '%' + (j + 1).toString() + '.';\n                    }\n                    listLevel.listLevelPattern = 'Number';\n                }\n                else {\n                    listLevel.numberFormat = '%' + (i + 1).toString() + ')';\n                    listLevel.listLevelPattern = i % 3 === 0 ? 'Number'\n                        : i % 3 === 1 ? 'LowLetter' : 'LowRoman';\n                }\n                listLevel.startAt = 1;\n                listLevel.restartLevel = i;\n            }\n            if (i === 0) {\n                listLevel.paragraphFormat.leftIndent = 36;\n            }\n            else {\n                listLevel.paragraphFormat.leftIndent = 36 * i;\n            }\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            abstractListAdv.levels.push(listLevel);\n            selection.paragraphFormat.listLevelNumber = i;\n        }\n    };\n    /**\n     * Insert page break at cursor position\n     */\n    Editor.prototype.insertPageBreak = function () {\n        if (!this.owner.isReadOnlyMode) {\n            if (this.viewer.selection.start.paragraph.isInsideTable ||\n                this.viewer.selection.start.paragraph.isInHeaderFooter) {\n                return;\n            }\n            this.initComplexHistory('PageBreak');\n            this.onEnter(true);\n            if (this.editorHistory && this.editorHistory.currentHistoryInfo != null) {\n                this.editorHistory.updateComplexHistory();\n            }\n            this.selection.checkForCursorVisibility();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onEnter = function (isInsertPageBreak) {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            //ToDo: Need to handle the CTRL + Enter (Page Break) and SHIFT + Enter (Line Break) behavior.\n            var hyperlinkField = selection.getHyperlinkField();\n            var isSelectionOnHyperlink = !isNullOrUndefined(hyperlinkField);\n            if (isSelectionOnHyperlink) {\n                selection.fireRequestNavigate(hyperlinkField);\n                return;\n            }\n            var paragraph = selection.start.paragraph;\n            if (paragraph.isEmpty() && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                // tslint:disable-next-line:max-line-length\n                this.onApplyListInternal(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId), paragraph.paragraphFormat.listFormat.listLevelNumber - 1);\n                return;\n            }\n        }\n        this.initHistory('Enter');\n        var isRemoved = true;\n        if (!selection.isEmpty) {\n            // this.initHistoryWithSelection(selection, 'Enter');\n            isRemoved = this.removeSelectedContents(selection);\n        }\n        if (isRemoved) {\n            selection.owner.isShiftingEnabled = true;\n            this.updateInsertPosition();\n            var blockInfo = this.getParagraphInfo(selection.start);\n            var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            this.splitParagraphInternal(selection, selection.start.paragraph, selection.start.currentWidget, selection.start.offset);\n            this.setPositionForCurrentIndex(selection.start, initialStart);\n            if (isInsertPageBreak) {\n                var currentParagraph = selection.start.paragraph;\n                var breakParagraph = new ParagraphWidget();\n                breakParagraph.characterFormat.copyFormat(currentParagraph.characterFormat);\n                breakParagraph.paragraphFormat.copyFormat(currentParagraph.paragraphFormat);\n                var pageBreak = new TextElementBox();\n                pageBreak.text = '\\f';\n                var line = new LineWidget(breakParagraph);\n                line.children.push(pageBreak);\n                pageBreak.line = line;\n                breakParagraph.childWidgets.push(line);\n                this.insertParagraph(breakParagraph, true);\n                selection.selectParagraph(breakParagraph, true);\n            }\n            var nextNode = selection.start.paragraph.nextWidget;\n            if (isNullOrUndefined(nextNode)) {\n                nextNode = selection.getNextRenderedBlock(selection.start.paragraph);\n            }\n            selection.selectParagraph(nextNode, true);\n            this.updateEndPosition();\n            if (isInsertPageBreak && this.editorHistory) {\n                this.owner.editorHistory.updateHistory();\n            }\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            this.reLayout(selection);\n            // }\n            var paragraph = selection.start.paragraph.previousWidget;\n            if (!isNullOrUndefined(paragraph) && !paragraph.isEmpty() &&\n                // tslint:disable-next-line:max-line-length\n                paragraph.lastChild.children[paragraph.lastChild.children.length - 1] instanceof TextElementBox) {\n                this.checkAndConvertToHyperlink(selection, true, paragraph);\n            }\n        }\n    };\n    Editor.prototype.splitParagraphInternal = function (selection, paragraphAdv, currentLine, offset) {\n        var insertIndex = 0;\n        var blockIndex = paragraphAdv.index;\n        var paragraph = new ParagraphWidget();\n        var lineWidget = new LineWidget(paragraph);\n        paragraph.childWidgets.push(lineWidget);\n        //Copies the format to new paragraph.\n        paragraph.paragraphFormat.ownerBase = paragraph;\n        if (currentLine === paragraphAdv.lastChild && offset === selection.getLineLength(currentLine)) {\n            // tslint:disable-next-line:max-line-length\n            if (paragraphAdv.paragraphFormat.baseStyle\n                && paragraphAdv.paragraphFormat.baseStyle.name !== 'Normal' && paragraphAdv.paragraphFormat.baseStyle.next instanceof WParagraphStyle) {\n                if (paragraphAdv.paragraphFormat.baseStyle.name === paragraphAdv.paragraphFormat.baseStyle.next.name) {\n                    paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                    paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n                }\n                else {\n                    paragraph.paragraphFormat.baseStyle = paragraphAdv.paragraphFormat.baseStyle.next;\n                }\n                this.selection.skipFormatRetrieval = false;\n            }\n            else {\n                paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n                paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            }\n            //ToDo in future: Need to skip copying formattings to new paragraph, if the style for following paragraph is same style.\n            insertIndex++;\n            blockIndex++;\n        }\n        else {\n            paragraph.paragraphFormat.copyFormat(paragraphAdv.paragraphFormat);\n            paragraph.characterFormat.copyFormat(paragraphAdv.characterFormat);\n            if (offset > 0 || !currentLine.isFirstLine()) {\n                paragraphAdv = paragraphAdv.combineWidget(this.viewer);\n                this.moveInlines(paragraphAdv, paragraph, 0, 0, paragraphAdv.firstChild, offset, currentLine);\n            }\n            paragraphAdv = paragraphAdv.getSplitWidgets()[0];\n        }\n        insertIndex += paragraphAdv.getIndex();\n        var container = paragraphAdv.containerWidget;\n        var childNodes = container.childWidgets;\n        childNodes.splice(insertIndex, 0, paragraph);\n        paragraph.containerWidget = container;\n        paragraph.index = blockIndex;\n        this.updateNextBlocksIndex(paragraph, true);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.layout.layoutBodyWidgetCollection(blockIndex, container, paragraph, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateNextBlocksIndex = function (block, increaseIndex) {\n        var nextIndex = block.containerWidget.childWidgets.indexOf(block) + 1;\n        if (block.containerWidget instanceof BodyWidget) {\n            var currentSectionIndex = block.containerWidget.index;\n            for (var j = this.viewer.pages.indexOf(block.containerWidget.page); j < this.viewer.pages.length; j++) {\n                var page = this.viewer.pages[j];\n                if (page.bodyWidgets[0].index === currentSectionIndex) {\n                    for (var k = nextIndex; k < page.bodyWidgets[0].childWidgets.length; k++) {\n                        var childWidget = page.bodyWidgets[0].childWidgets[k];\n                        this.updateIndex(childWidget, increaseIndex);\n                    }\n                    nextIndex = 0;\n                }\n                else {\n                    return;\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableCellWidget) {\n            var cells = block.containerWidget.getSplitWidgets();\n            var currentCellIndex = cells.indexOf(block.containerWidget);\n            for (var x = currentCellIndex; x < cells.length; x++) {\n                var blocks = cells[x].childWidgets;\n                for (var y = nextIndex; y < blocks.length; y++) {\n                    this.updateIndex(blocks[y], increaseIndex);\n                }\n                currentCellIndex = 0;\n                nextIndex = 0;\n            }\n        }\n        else if (block.containerWidget instanceof TableRowWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var cell = block.containerWidget.childWidgets[i];\n                if (cell.rowIndex === block.containerWidget.index) {\n                    this.updateIndex(cell, increaseIndex);\n                }\n            }\n        }\n        else if (block.containerWidget instanceof TableWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var row = block.containerWidget.childWidgets[i];\n                this.updateIndex(row, increaseIndex);\n                for (var j = 0; j < row.childWidgets.length; j++) {\n                    row.childWidgets[j].rowIndex = row.index;\n                }\n            }\n            //update Row index of all the cell\n        }\n        else if (block.containerWidget instanceof HeaderFooterWidget) {\n            for (var i = nextIndex; i < block.containerWidget.childWidgets.length; i++) {\n                var nextBlock = block.containerWidget.childWidgets[i];\n                this.updateIndex(nextBlock, increaseIndex);\n            }\n        }\n    };\n    Editor.prototype.updateIndex = function (widget, increment) {\n        if (increment) {\n            widget.index++;\n        }\n        else {\n            widget.index--;\n        }\n    };\n    Editor.prototype.updateEndPosition = function () {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onBackSpace = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleBackspace(selection, false);\n        }\n        else {\n            this.initHistory('BackSpace');\n            var skipBackSpace = this.deleteSelectedContents(selection, true);\n            if (this.editorHistory && this.editorHistory.currentBaseHistoryInfo) {\n                if (skipBackSpace) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n                else {\n                    if (this.checkEndPosition(selection)) {\n                        this.updateHistoryPosition(selection.end, false);\n                    }\n                    this.reLayout(selection);\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertRemoveBookMarkElements = function () {\n        var isHandledComplexHistory = false;\n        for (var i = 0; i < this.removedBookmarkElements.length; i++) {\n            var bookMark = this.removedBookmarkElements[i];\n            if (bookMark.bookmarkType === 0) {\n                var bookMarkStart = bookMark;\n                if (bookMarkStart && bookMarkStart.reference && this.removedBookmarkElements.indexOf(bookMarkStart.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkStart.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkStart);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkStart.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n            else {\n                var bookMarkEnd = bookMark;\n                if (bookMarkEnd && bookMarkEnd.reference && this.removedBookmarkElements.indexOf(bookMarkEnd.reference) !== -1) {\n                    var endIndex = this.removedBookmarkElements.indexOf(bookMarkEnd.reference);\n                    var startIndex = this.removedBookmarkElements.indexOf(bookMarkEnd);\n                    this.removedBookmarkElements.splice(endIndex, 1);\n                    this.removedBookmarkElements.splice(startIndex, 1);\n                }\n                else {\n                    this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action);\n                    this.editorHistory.updateHistory();\n                    this.initInsertInline(bookMarkEnd.clone());\n                    this.editorHistory.updateComplexHistory();\n                    isHandledComplexHistory = true;\n                }\n            }\n        }\n        this.removedBookmarkElements = [];\n        return isHandledComplexHistory;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteSelectedContents = function (selection, isBackSpace) {\n        var skipBackSpace = this.deleteSelectedContentInternal(selection, isBackSpace, selection.start, selection.end);\n        var textPosition = new TextPosition(selection.owner);\n        var blockInfo = this.getParagraph({ index: selection.editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        selection.selectContent(textPosition, true);\n        return skipBackSpace;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.singleBackspace = function (selection, isRedoing) {\n        var history = this.editorHistory;\n        // If backspace is pressed after auto format to hyperlink is done, need to undo auto format.\n        if (history && !isRedoing && !history.canRedo() && history.canUndo()) {\n            var historyInfo = history.undoStack[history.undoStack.length - 1];\n            var startBlockInfo = this.getParagraphInfo(selection.start);\n            var endBlockInfo = this.getParagraphInfo(selection.end);\n            // tslint:disable-next-line:max-line-length\n            if (historyInfo.action === 'AutoFormatHyperlink' && historyInfo.insertPosition === this.getHierarchicalIndex(startBlockInfo.paragraph, startBlockInfo.offset.toString()) &&\n                historyInfo.endPosition === this.getHierarchicalIndex(endBlockInfo.paragraph, endBlockInfo.offset.toString())) {\n                history.undo();\n                return;\n            }\n        }\n        var paragraph = selection.start.paragraph;\n        var currentLineWidget = selection.start.currentWidget;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = currentLineWidget.getInline(offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        var previousInline = inline;\n        if (inline instanceof FieldElementBox && inline.fieldType === 2) {\n            if (HelperMethods.isLinkedFieldCharacter(inline)) {\n                var begin = inline.fieldBegin;\n                var end = inline.fieldEnd;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n        }\n        if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n            var prevInline = selection.getPreviousValidElement(inline);\n            if (prevInline instanceof FieldElementBox) {\n                inline = prevInline.fieldBegin;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                selection.end.setPositionParagraph(inline.line, offset); //Selects the entire field.\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (prevInline !== inline) {\n                inline = prevInline; //Updates the offset to delete next content.\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 1\n            || inline.previousNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.previousNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, inline.length);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox && inline.previousNode instanceof BookmarkElementBox) {\n                var begin = inline.previousNode;\n                var end = inline.nextNode;\n                selection.start.setPositionParagraph(begin.line, begin.line.getOffset(begin, 0));\n                selection.end.setPositionParagraph(end.line, end.line.getOffset(end, 0) + 1);\n                this.initHistory('BackSpace');\n                this.deleteSelectedContents(selection, true);\n                if (this.checkEndPosition(selection)) {\n                    this.updateHistoryPosition(selection.end, false);\n                }\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (!isRedoing) {\n            this.initHistory('BackSpace');\n        }\n        if (offset === selection.getStartOffset(paragraph) && selection.start.currentWidget.isFirstLine()) {\n            if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1) {\n                this.onApplyList(undefined);\n                return;\n            }\n            if (paragraph.paragraphFormat.firstLineIndent !== 0) {\n                this.onApplyParagraphFormat('firstLineIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.leftIndent !== 0) {\n                this.onApplyParagraphFormat('leftIndent', 0, false, false);\n                return;\n            }\n            if (paragraph.paragraphFormat.textAlignment !== 'Left') {\n                this.onApplyParagraphFormat('textAlignment', 'Left', false, true);\n                return;\n            }\n            if (paragraph.previousRenderedWidget instanceof ParagraphWidget) {\n                selection.owner.isShiftingEnabled = true;\n                var previousParagraph = paragraph.previousRenderedWidget;\n                // if (isNullOrUndefined(previousParagraph)) {\n                //     previousParagraph = this.viewer.selection.getPreviousBlock(paragraph) as ParagraphWidget;\n                // }\n                if (previousParagraph.isEmpty()) {\n                    this.removeBlock(previousParagraph);\n                    this.addRemovedNodes(previousParagraph);\n                }\n                else {\n                    this.removeBlock(paragraph);\n                    var endOffset = this.viewer.selection.getLineLength(previousParagraph.lastChild);\n                    var previousIndex = previousParagraph.childWidgets.length - 1;\n                    var lineWidget = void 0;\n                    if (!paragraph.isEmpty()) {\n                        for (var i = 0; i < paragraph.childWidgets.length; i++) {\n                            lineWidget = paragraph.childWidgets[i];\n                            previousParagraph.childWidgets.push(lineWidget);\n                            paragraph.childWidgets.splice(i, 1);\n                            i--;\n                            lineWidget.paragraph = previousParagraph;\n                        }\n                    }\n                    this.viewer.layout.reLayoutParagraph(previousParagraph, previousIndex, 0);\n                    selection.selects(previousParagraph.childWidgets[previousIndex], endOffset, true);\n                    this.addRemovedNodes(paragraph);\n                }\n                this.setPositionForHistory();\n                // if (!isRedoing) {\n                this.reLayout(selection);\n                // }\n            }\n            else {\n                if (this.editorHistory) {\n                    this.editorHistory.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isRedoing) {\n                selection.owner.isShiftingEnabled = true;\n            }\n            var paragraphInfo = this.getParagraphInfo(selection.start);\n            var lineWidget = selection.start.currentWidget;\n            var removeOffset = offset - 1;\n            if (removeOffset < 0) {\n                lineWidget = lineWidget.previousLine;\n                removeOffset = this.viewer.selection.getLineLength(lineWidget) + removeOffset;\n            }\n            this.removeAtOffset(lineWidget, selection, removeOffset);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset - 1, false);\n            this.setPositionForHistory();\n            if (!isRedoing) {\n                this.reLayout(selection);\n            }\n            else {\n                this.fireContentChange();\n            }\n        }\n    };\n    Editor.prototype.setPositionForHistory = function (editPosition) {\n        var selection = this.viewer.selection;\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            if (isNullOrUndefined(editPosition)) {\n                this.updateHistoryPosition(selection.start, true);\n                this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = editPosition;\n                this.editorHistory.currentBaseHistoryInfo.endPosition = editPosition;\n            }\n        }\n    };\n    Editor.prototype.removeAtOffset = function (lineWidget, selection, offset) {\n        var count = 0;\n        var lineIndex = lineWidget.paragraph.childWidgets.indexOf(lineWidget);\n        for (var i = 0; i < lineWidget.children.length; i++) {\n            var inline = lineWidget.children[i];\n            if (inline instanceof ListTextElementBox) {\n                continue;\n            }\n            if (offset < count + inline.length) {\n                var indexInInline = offset - count;\n                if (offset === count && inline.length === 1) {\n                    this.unLinkFieldCharacter(inline);\n                    lineWidget.children.splice(i, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(inline);\n                }\n                else {\n                    var span = new TextElementBox();\n                    span.characterFormat.copyFormat(inline.characterFormat);\n                    span.text = inline.text.substr(indexInInline, 1);\n                    inline.text = HelperMethods.remove(inline.text, indexInInline, 1);\n                    this.viewer.layout.reLayoutParagraph(lineWidget.paragraph, lineIndex, i);\n                    this.addRemovedNodes(span);\n                }\n                break;\n            }\n            count += inline.length;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onDelete = function () {\n        var selection = this.viewer.selection;\n        if (selection.isEmpty) {\n            this.singleDelete(selection, false);\n        }\n        else {\n            // this.initComplexHistory('MultiSelection');\n            // for (let i: number = 0; i < selection.selectionRanges.length; i++) {\n            // let selectionRange: SelectionRange = selection.selectionRanges.getRange(i);\n            this.initHistory('Delete');\n            this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n            var textPosition = new TextPosition(selection.owner);\n            this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n            selection.selectContent(textPosition, true);\n            // if (this.viewer.owner.enableEditorHistory) {\n            this.reLayout(selection);\n            // }\n            // this.updateSelectionRangeOffSet(selection.start, selection.end);\n            // }\n            // let textPosition: TextPosition = new TextPosition(selection.owner, this.viewer);\n            // this.setPositionForCurrentIndex(textPosition,selection.editPosition);\n            // selection.selectContent(textPosition, true);\n            // if (!isNullOrUndefined(selection.currentHistoryInfo)) {\n            //     this.updateComplexHistory();\n            // } else {\n            //     this.updateComplexWithoutHistory();\n            // }\n        }\n    };\n    /**\n     * Remove single character on right of cursor position\n     * @param  {Selection} selection\n     * @param  {boolean} isRedoing\n     * @private\n     */\n    Editor.prototype.singleDelete = function (selection, isRedoing) {\n        // tslint:disable-next-line:max-line-length\n        var paragraph = selection.start.paragraph;\n        var offset = selection.start.offset;\n        var indexInInline = 0;\n        var inlineObj = paragraph.getInline(selection.start.offset, indexInInline);\n        var inline = inlineObj.element;\n        indexInInline = inlineObj.index;\n        if (paragraph.paragraphFormat.listFormat && paragraph.paragraphFormat.listFormat.listId !== -1 &&\n            this.viewer.isListTextSelected && selection.contextType === 'List') {\n            this.onApplyList(undefined);\n            return;\n        }\n        if (!isNullOrUndefined(inline) && indexInInline === inline.length && !isNullOrUndefined(inline.nextNode)) {\n            inline = inline.nextNode;\n            indexInInline = 0;\n        }\n        if (!isNullOrUndefined(inline)) {\n            var nextRenderedInline = undefined;\n            var nextInline = selection.getNextValidElement(inline);\n            if (nextInline instanceof ElementBox) {\n                nextRenderedInline = nextInline;\n            }\n            if (!isNullOrUndefined(nextRenderedInline) && nextRenderedInline instanceof FieldElementBox\n                && nextRenderedInline.fieldType === 0) { //Selects the entire field.\n                inline = nextRenderedInline.fieldEnd;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 1);\n                selection.end.setPositionParagraph(inline.line, offset);\n                selection.fireSelectionChanged(true);\n                return;\n            }\n            else if (inline !== nextRenderedInline) { //Updates the offset to delete next content.               \n                inline = nextRenderedInline;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n                if (inline instanceof FieldElementBox && inline.fieldType === 1) {\n                    offset++;\n                }\n            }\n        }\n        if (inline && (inline instanceof BookmarkElementBox && inline.bookmarkType === 0\n            || inline.nextNode instanceof BookmarkElementBox)) {\n            if (inline instanceof BookmarkElementBox) {\n                inline = inline.nextNode;\n                paragraph = inline.line.paragraph;\n                offset = inline.line.getOffset(inline, 0);\n            }\n            if (inline.length === 1 && inline.nextNode instanceof BookmarkElementBox\n                && inline.previousNode instanceof BookmarkElementBox) {\n                var bookMarkBegin = inline.previousNode;\n                var bookMarkEnd = inline.nextNode;\n                selection.start.setPositionParagraph(bookMarkBegin.line, bookMarkBegin.line.getOffset(bookMarkBegin, 0));\n                selection.end.setPositionParagraph(bookMarkEnd.line, bookMarkEnd.line.getOffset(bookMarkEnd, 0) + 1);\n                this.initHistory('Delete');\n                this.deleteSelectedContentInternal(selection, false, selection.start, selection.end);\n                var textPosition = new TextPosition(selection.owner);\n                this.setPositionForCurrentIndex(textPosition, selection.editPosition);\n                selection.selectContent(textPosition, true);\n                this.reLayout(selection);\n                return;\n            }\n        }\n        if (selection.start.currentWidget.isLastLine() && offset === this.viewer.selection.getLineLength(selection.start.currentWidget)) {\n            if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget)) {\n                return;\n            }\n            var previousParagraph = undefined;\n            var newParagraph = undefined;\n            var nextParagraph = selection.getNextParagraphBlock(paragraph);\n            if (isNullOrUndefined(nextParagraph)) {\n                if (offset > 0) {\n                    return;\n                }\n                else {\n                    if (paragraph.previousWidget instanceof ParagraphWidget) {\n                        previousParagraph = paragraph.previousWidget;\n                    }\n                    if (paragraph.previousWidget instanceof TableWidget) {\n                        return;\n                    }\n                    if (isNullOrUndefined(previousParagraph)) {\n                        return;\n                        //Adds an empty paragraph, to ensure minimal content.\n                    }\n                }\n            }\n            if (!isRedoing) {\n                this.initHistory('Delete');\n            }\n            var blockInfo = this.getParagraphInfo(selection.start);\n            selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            if (this.checkInsertPosition(selection)) {\n                this.setPositionForHistory(selection.editPosition);\n            }\n            selection.owner.isShiftingEnabled = true;\n            if (paragraph.isEmpty()) {\n                this.removeBlock(paragraph);\n                this.addRemovedNodes(paragraph);\n                if (isNullOrUndefined(nextParagraph)) {\n                    if (isNullOrUndefined(previousParagraph)) {\n                        // selection.selectParagraph(newParagraph, true, true);\n                        var paraEndOffset = selection.getParagraphLength(newParagraph) + 1;\n                        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n                            this.updateHistoryPosition(selection.start, true);\n                            //tslint:disable-next-line:max-line-length\n                            this.editorHistory.currentBaseHistoryInfo.endPosition = this.getHierarchicalIndex(newParagraph, paraEndOffset.toString());\n                        }\n                    }\n                    else {\n                        selection.selectParagraph(previousParagraph, false);\n                        this.setPositionForHistory();\n                    }\n                }\n                else {\n                    selection.selectParagraph(nextParagraph, true);\n                }\n            }\n            else {\n                paragraph = paragraph.combineWidget(this.viewer);\n                // tslint:disable-next-line:max-line-length\n                var currentParagraph = this.splitParagraph(paragraph, paragraph.firstChild, 0, selection.start.currentWidget, selection.start.offset, true);\n                this.deleteParagraphMark(currentParagraph, selection, 0);\n                this.addRemovedNodes(paragraph);\n                this.setPositionForCurrentIndex(selection.start, selection.editPosition);\n                selection.selectContent(selection.start, true);\n            }\n            // if (!isRedoing) {\n            this.reLayout(selection);\n            // }\n        }\n        else {\n            this.singleDeleteInternal(selection, isRedoing, paragraph);\n        }\n    };\n    Editor.prototype.singleDeleteInternal = function (selection, isRedoing, paragraph) {\n        if (!isRedoing) {\n            selection.owner.isShiftingEnabled = true;\n            this.initHistory('Delete');\n        }\n        if (this.checkInsertPosition(selection)) {\n            this.updateHistoryPosition(selection.start, true);\n            this.editorHistory.currentBaseHistoryInfo.endPosition = this.editorHistory.currentBaseHistoryInfo.insertPosition;\n        }\n        var paragraphInfo = this.getParagraphInfo(selection.start);\n        var lineWidget = selection.start.currentWidget;\n        var removeOffset = selection.start.offset;\n        var lineLength = selection.getLineLength(selection.start.currentWidget);\n        if (removeOffset >= lineLength) {\n            lineWidget = lineWidget.nextLine;\n            removeOffset = removeOffset - lineLength;\n        }\n        this.removeAtOffset(lineWidget, selection, removeOffset);\n        this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset, false);\n        if (!isRedoing) {\n            this.reLayout(selection);\n        }\n        else {\n            this.fireContentChange();\n        }\n    };\n    Editor.prototype.deleteParagraphMark = function (paragraph, selection, editAction) {\n        if (isNullOrUndefined(paragraph.containerWidget)) {\n            return;\n        }\n        paragraph = paragraph.combineWidget(this.viewer);\n        var nextParagraph = selection.getNextParagraphBlock(paragraph);\n        if (paragraph.isInsideTable && isNullOrUndefined(paragraph.nextWidget) || isNullOrUndefined(nextParagraph)) {\n            return;\n        }\n        //BodyWidget\n        var section = paragraph.containerWidget instanceof BodyWidget ? paragraph.containerWidget : undefined;\n        var table = undefined;\n        if (selection.getNextRenderedBlock(paragraph) instanceof TableWidget) {\n            table = selection.getNextRenderedBlock(paragraph);\n        }\n        else {\n            table = undefined;\n        }\n        if (nextParagraph.isInsideTable && !isNullOrUndefined(table) && table.contains(nextParagraph.associatedCell)) {\n            if (editAction < 4) {\n                // let nextSection: BodyWidget = table.containerWidget instanceof BodyWidget ? table.containerWidget : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var offset = 0;\n                this.removeBlock(paragraph);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                for (var i = paragraph.childWidgets.length - 1; i >= 0; i--) {\n                    var line = paragraph.childWidgets[i];\n                    for (var j = line.children.length - 1; j >= 0; j--) {\n                        var element = line.children[j];\n                        offset += element.length;\n                        nextParagraph.firstChild.children.unshift(element);\n                        element.line = nextParagraph.firstChild;\n                        // this.layoutInlineCollection(false, 0, nextParagraph.inlines, inline);\n                    }\n                }\n                this.viewer.layout.reLayoutParagraph(nextParagraph, 0, 0);\n                if (offset > 0) {\n                    selection.editPosition = this.getHierarchicalIndex(nextParagraph, offset.toString());\n                }\n            }\n        }\n        else {\n            if (editAction < 4) {\n                // let nextSection: WSection = nextParagraph.section instanceof WSection ? nextParagraph.section as WSection : undefined;\n                // if (section !== nextSection) {\n                //     this.combineSection(section, selection, nextSection);\n                // }\n                var prevLength = paragraph.childWidgets.length - 1;\n                var nextPara = nextParagraph.getSplitWidgets();\n                nextParagraph = nextParagraph.combineWidget(this.viewer);\n                this.viewer.layout.clearListElementBox(nextParagraph);\n                this.viewer.layout.clearListElementBox(paragraph);\n                this.updateEditPositionOnMerge(paragraph, nextParagraph);\n                for (var i = 0; i < nextParagraph.childWidgets.length; i++) {\n                    var inline = nextParagraph.childWidgets[i];\n                    nextParagraph.childWidgets.splice(i, 1);\n                    paragraph.childWidgets.push(inline);\n                    inline.paragraph = paragraph;\n                    i--;\n                }\n                if (nextParagraph.childWidgets.length === 0) {\n                    nextParagraph.childWidgets.push(new LineWidget(nextParagraph));\n                }\n                this.removeBlock(nextParagraph);\n                this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n                this.addRemovedNodes(nextParagraph);\n            }\n        }\n    };\n    Editor.prototype.updateEditPositionOnMerge = function (currentParagraph, nextParagraph) {\n        if (this.viewer.selection.editPosition === this.getHierarchicalIndex(nextParagraph, '0') &&\n            nextParagraph.nextRenderedWidget === undefined) {\n            // tslint:disable-next-line:max-line-length\n            this.viewer.selection.editPosition = this.getHierarchicalIndex(currentParagraph, this.viewer.selection.getLineLength(currentParagraph.lastChild).toString());\n        }\n    };\n    Editor.prototype.checkEndPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition));\n    };\n    Editor.prototype.checkInsertPosition = function (selection) {\n        return (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)\n            && isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition));\n    };\n    Editor.prototype.checkIsNotRedoing = function () {\n        return this.viewer.owner.enableHistoryMode && !this.editorHistory.isRedoing;\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.deleteSelectedContentInternal = function (selection, isBackSpace, startPosition, endPosition) {\n        var startPos = startPosition;\n        var endPos = endPosition;\n        if (!startPosition.isExistBefore(endPosition)) {\n            startPos = endPosition;\n            endPos = startPosition;\n        }\n        var blockInfo = this.getParagraphInfo(startPos);\n        selection.editPosition = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        var skipBackSpace = false;\n        if (isBackSpace && startPos.isInSameParagraph(endPos)) {\n            //Handled specifically to skip removal of contents, if selection is only paragraph mark and next rendered block is table.\n            if (startPos.offset < endPos.offset && startPos.offset === selection.getParagraphLength(endPos.paragraph)) {\n                var nextBlock = selection.getNextRenderedBlock(startPos.paragraph);\n                skipBackSpace = nextBlock instanceof TableWidget;\n            }\n            //Handled specifically to remove paragraph completely (Delete behavior), if the selected paragraph is empty.\n            if (endPos.offset === 1 && endPos.offset > selection.getParagraphLength(endPos.paragraph)\n                && !(endPos.paragraph.isInsideTable && isNullOrUndefined(endPos.paragraph.nextWidget))) {\n                isBackSpace = false;\n            }\n        }\n        if (!skipBackSpace) {\n            selection.owner.isShiftingEnabled = true;\n            if (this.checkInsertPosition(selection)) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = selection.editPosition;\n            }\n            var editAction = (isBackSpace ? 1 : 0);\n            this.deleteSelectedContent(endPos.paragraph, selection, startPos, endPos, editAction);\n        }\n        return skipBackSpace;\n    };\n    /**\n     * Init EditorHistory\n     * @private\n     */\n    Editor.prototype.initHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initializeHistory(action);\n        }\n    };\n    /**\n     * Init Complex EditorHistory\n     * @private\n     */\n    Editor.prototype.initComplexHistory = function (action) {\n        if (this.viewer.owner.enableHistoryMode) {\n            this.editorHistory.initComplexHistory(this.viewer.selection, action);\n        }\n    };\n    //Insert Picture implementation starts\n    /**\n     * Insert image\n     * @param  {string} base64String\n     * @param  {number} width\n     * @param  {number} height\n     * @private\n     */\n    Editor.prototype.insertPicture = function (base64String, width, height) {\n        var imageElementBox = new ImageElementBox(true);\n        imageElementBox.imageString = base64String;\n        imageElementBox.width = width;\n        imageElementBox.height = height;\n        this.insertPictureInternal(imageElementBox);\n    };\n    Editor.prototype.insertPictureInternal = function (imageElementBox) {\n        var selection = this.viewer.selection;\n        this.initHistory('InsertInline');\n        this.fitImageToPage(selection, imageElementBox);\n        this.insertInlineInSelection(selection, imageElementBox);\n        this.reLayout(selection);\n    };\n    Editor.prototype.fitImageToPage = function (selection, imageElementBox) {\n        var section = selection.start.paragraph.bodyWidget;\n        var pageWidth = section.sectionFormat.pageWidth - section.sectionFormat.leftMargin - section.sectionFormat.rightMargin;\n        var pageHeight = section.sectionFormat.pageHeight - section.sectionFormat.topMargin - section.sectionFormat.topMargin;\n        //Resizes image to page size.\n        if (imageElementBox.width > pageWidth) {\n            imageElementBox.height = imageElementBox.height * pageWidth / imageElementBox.width;\n            imageElementBox.width = pageWidth;\n        }\n        if (imageElementBox.height > pageHeight) {\n            imageElementBox.width = imageElementBox.width * pageHeight / imageElementBox.height;\n            imageElementBox.height = pageHeight;\n        }\n    };\n    //Insert Picture implementation ends\n    /**\n     * @private\n     */\n    Editor.prototype.insertInlineInSelection = function (selection, elementBox) {\n        if (this.checkIsNotRedoing()) {\n            selection.owner.isShiftingEnabled = true;\n        }\n        if (!selection.isEmpty) {\n            this.removeSelectedContents(selection);\n        }\n        this.updateInsertPosition();\n        this.insertInlineInternal(elementBox);\n        if (this.checkEndPosition(selection)) {\n            this.updateHistoryPosition(selection.start, false);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPortrait = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width > height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onLandscape = function () {\n        var sectionFormat = new WSectionFormat();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (width < height) {\n            sectionFormat.pageWidth = height;\n            sectionFormat.pageHeight = width;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    Editor.prototype.copyValues = function () {\n        var format = new WSectionFormat();\n        format.bottomMargin = this.viewer.selection.sectionFormat.bottomMargin;\n        format.topMargin = this.viewer.selection.sectionFormat.topMargin;\n        format.leftMargin = this.viewer.selection.sectionFormat.leftMargin;\n        format.rightMargin = this.viewer.selection.sectionFormat.rightMargin;\n        format.pageHeight = this.viewer.selection.sectionFormat.pageHeight;\n        format.pageWidth = this.viewer.selection.sectionFormat.pageWidth;\n        format.footerDistance = this.viewer.selection.sectionFormat.footerDistance;\n        format.headerDistance = this.viewer.selection.sectionFormat.headerDistance;\n        return format;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.changeMarginValue = function (property) {\n        var sectionFormat = this.copyValues();\n        if (property === 'lastCustomSetting' || property === 'normal') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 72;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'narrow') {\n            sectionFormat.topMargin = 36;\n            sectionFormat.bottomMargin = 36;\n            sectionFormat.leftMargin = 36;\n            sectionFormat.rightMargin = 36;\n        }\n        else if (property === 'moderate') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 54;\n            sectionFormat.rightMargin = 54;\n        }\n        else if (property === 'wide') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 144;\n            sectionFormat.rightMargin = 144;\n        }\n        else if (property === 'mirrored') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 72;\n        }\n        else if (property === 'office2003Default') {\n            sectionFormat.topMargin = 72;\n            sectionFormat.bottomMargin = 72;\n            sectionFormat.leftMargin = 90;\n            sectionFormat.rightMargin = 90;\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.onPaperSize = function (property) {\n        var sectionFormat = this.copyValues();\n        var width = this.viewer.selection.sectionFormat.pageWidth;\n        var height = this.viewer.selection.sectionFormat.pageHeight;\n        if (property === 'letter') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n            else {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'tabloid') {\n            if (width < height) {\n                sectionFormat.pageWidth = 791.9;\n                sectionFormat.pageHeight = 1223.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1223.9;\n                sectionFormat.pageHeight = 791.9;\n            }\n        }\n        else if (property === 'legal') {\n            if (width < height) {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 1007.9;\n            }\n            else {\n                sectionFormat.pageWidth = 1007.9;\n                sectionFormat.pageHeight = 611.9;\n            }\n        }\n        else if (property === 'statement') {\n            if (width < height) {\n                sectionFormat.pageWidth = 396;\n                sectionFormat.pageHeight = 611.9;\n            }\n            else {\n                sectionFormat.pageWidth = 611.9;\n                sectionFormat.pageHeight = 396;\n            }\n        }\n        else if (property === 'executive') {\n            if (width < height) {\n                sectionFormat.pageWidth = 521.9;\n                sectionFormat.pageHeight = 755.9;\n            }\n            else {\n                sectionFormat.pageWidth = 755.9;\n                sectionFormat.pageHeight = 521.9;\n            }\n        }\n        else if (property === 'a3') {\n            if (width < height) {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 1190.4;\n            }\n            else {\n                sectionFormat.pageWidth = 1190.4;\n                sectionFormat.pageHeight = 841.8;\n            }\n        }\n        else if (property === 'a4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 841.8;\n            }\n            else {\n                sectionFormat.pageWidth = 841.8;\n                sectionFormat.pageHeight = 595.2;\n            }\n        }\n        else if (property === 'a5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 419.5;\n                sectionFormat.pageHeight = 595.2;\n            }\n            else {\n                sectionFormat.pageWidth = 595.2;\n                sectionFormat.pageHeight = 419.5;\n            }\n        }\n        else if (property === 'b4') {\n            if (width < height) {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 1031.7;\n            }\n            else {\n                sectionFormat.pageWidth = 1031.7;\n                sectionFormat.pageHeight = 728.4;\n            }\n        }\n        else if (property === 'b5') {\n            if (width < height) {\n                sectionFormat.pageWidth = 515.8;\n                sectionFormat.pageHeight = 728.4;\n            }\n            else {\n                sectionFormat.pageWidth = 728.4;\n                sectionFormat.pageHeight = 515.8;\n            }\n        }\n        this.onApplySectionFormat(undefined, sectionFormat);\n    };\n    //Update List Items\n    /**\n     * @private\n     */\n    Editor.prototype.updateListItemsTillEnd = function (blockAdv, updateNextBlockList) {\n        var block = updateNextBlockList ? this.viewer.selection.getNextRenderedBlock(blockAdv) : blockAdv;\n        while (!isNullOrUndefined(block)) {\n            //Updates the list value of the rendered paragraph. \n            this.updateRenderedListItems(block);\n            block = block.getSplitWidgets().pop().nextRenderedWidget;\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateWholeListItems = function (block) {\n        this.viewer.renderedLists.clear();\n        var sectionIndex = block.bodyWidget.index;\n        var currentBlock;\n        for (var j = 0; j < this.viewer.pages.length; j++) {\n            var page = this.viewer.pages[j];\n            if (page.bodyWidgets[0].index === sectionIndex) {\n                currentBlock = page.bodyWidgets[0].firstChild;\n                break;\n            }\n        }\n        var isListUpdated = false;\n        do {\n            isListUpdated = this.updateListItems(currentBlock, block);\n            if (isListUpdated) {\n                break;\n            }\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItems = function (blockAdv, block) {\n        var isListUpdated = false;\n        if (blockAdv instanceof ParagraphWidget) {\n            isListUpdated = this.updateListItemsForPara(blockAdv, block);\n        }\n        else {\n            isListUpdated = this.updateListItemsForTable(blockAdv, block);\n        }\n        return isListUpdated;\n    };\n    Editor.prototype.updateListItemsForTable = function (table, block) {\n        if (block instanceof TableWidget && table.equals(block)) {\n            return true;\n        }\n        var row = table.firstChild;\n        do {\n            var isListUpdated = this.updateListItemsForRow(row, block);\n            if (isListUpdated) {\n                return true;\n            }\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n        return false;\n    };\n    Editor.prototype.updateListItemsForRow = function (row, block) {\n        if (block.isInsideTable && row.childWidgets.indexOf(this.viewer.selection.getContainerCell(block.associatedCell)) !== -1) {\n            //Returns as list updated, inorder to start list numbering from first list paragraph of this row.\n            return true;\n        }\n        var cell = row.firstChild;\n        do {\n            this.updateListItemsForCell(cell, block);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n        return false;\n    };\n    Editor.prototype.updateListItemsForCell = function (cell, block) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateListItems(currentBlock, block);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    // public abstract updateListParagraphs(): void;\n    /**\n     * @private\n     */\n    Editor.prototype.updateRenderedListItems = function (block) {\n        if (block instanceof ParagraphWidget) {\n            this.updateRenderedListItemsForPara(block);\n        }\n        else {\n            this.updateRenderedListItemsForTable(block);\n        }\n    };\n    Editor.prototype.updateRenderedListItemsForTable = function (table) {\n        var row = table.firstChild;\n        do {\n            this.updateRenderedListItemsForRow(row);\n            row = row.getSplitWidgets().pop().nextRenderedWidget;\n        } while (row);\n    };\n    Editor.prototype.updateRenderedListItemsForRow = function (row) {\n        var cell = row.firstChild;\n        do {\n            this.updateRenderedListItemsForCell(cell);\n            cell = cell.nextRenderedWidget;\n        } while (cell);\n    };\n    Editor.prototype.updateRenderedListItemsForCell = function (cell) {\n        if (cell.childWidgets.length === 0) {\n            return;\n        }\n        var currentBlock = cell.firstChild;\n        do {\n            this.updateRenderedListItems(currentBlock);\n            currentBlock = currentBlock.getSplitWidgets().pop().nextRenderedWidget;\n        } while (currentBlock);\n    };\n    Editor.prototype.updateListItemsForPara = function (paragraph, block) {\n        if (paragraph.equals(block)) {\n            return true;\n        }\n        else {\n            var currentList = undefined;\n            var listLevelNumber = 0;\n            if (!isNullOrUndefined(paragraph.paragraphFormat) && !isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n                currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n                listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            }\n            // tslint:disable-next-line:max-line-length\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                }\n            }\n        }\n        return false;\n    };\n    Editor.prototype.updateRenderedListItemsForPara = function (paragraph) {\n        if (!isNullOrUndefined(this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId))) {\n            var currentList = this.viewer.getListById(paragraph.paragraphFormat.listFormat.listId);\n            var listLevelNumber = paragraph.paragraphFormat.listFormat.listLevelNumber;\n            if (!isNullOrUndefined(currentList) && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId))\n                // tslint:disable-next-line:max-line-length\n                && !isNullOrUndefined(this.viewer.getAbstractListById(currentList.abstractListId).levels[paragraph.paragraphFormat.listFormat.listLevelNumber])) {\n                var currentListLevel = this.viewer.layout.getListLevel(currentList, listLevelNumber);\n                //Updates the list numbering from document start for reLayouting.\n                if (currentListLevel.listLevelPattern !== 'Bullet') {\n                    var element = undefined;\n                    if (paragraph.childWidgets.length > 0) {\n                        var lineWidget = paragraph.childWidgets[0];\n                        if (lineWidget.children.length > 0) {\n                            element = lineWidget.children[0];\n                        }\n                    }\n                    if (!isNullOrUndefined(element)) {\n                        element.text = this.viewer.layout.getListNumber(paragraph.paragraphFormat.listFormat);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * Get logical offset of paragraph.\n     * @private\n     */\n    Editor.prototype.getParagraphInfo = function (position) {\n        return this.getParagraphInfoInternal(position.currentWidget, position.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraphInfoInternal = function (line, lineOffset) {\n        var paragraph = line.paragraph;\n        var offset = this.selection.getParagraphLength(paragraph, line) + lineOffset;\n        var previous = paragraph.previousSplitWidget;\n        while (previous instanceof ParagraphWidget) {\n            paragraph = previous;\n            offset += this.viewer.selection.getParagraphLength(paragraph);\n            previous = paragraph.previousSplitWidget;\n        }\n        return { 'paragraph': paragraph, 'offset': offset };\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getOffsetValue = function (selection) {\n        if (this.startParagraph) {\n            var lineInfo = this.getLineInfo(this.startParagraph, this.startOffset);\n            selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        }\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            if (this.endParagraph) {\n                var lineInfo = this.getLineInfo(this.endParagraph, this.endOffset);\n                selection.end.setPositionFromLine(lineInfo.line, lineInfo.offset);\n            }\n            selection.end.updatePhysicalPosition(true);\n        }\n    };\n    /**\n     * Get offset value to update in selection\n     * @private\n     */\n    Editor.prototype.getLineInfo = function (paragraph, offset) {\n        var position = undefined;\n        var element = undefined;\n        var length = this.selection.getParagraphLength(paragraph);\n        var next = paragraph.nextSplitWidget;\n        if (offset > length + 1 && isNullOrUndefined(next)) {\n            offset = length;\n        }\n        while (offset > length && next instanceof ParagraphWidget) {\n            offset -= length;\n            paragraph = next;\n            length = this.selection.getParagraphLength(paragraph);\n            next = paragraph.nextSplitWidget;\n        }\n        return this.selection.getLineInfo(paragraph, offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionParagraph = function (paragraph, offset, skipSelectionChange) {\n        var selection = this.viewer.selection;\n        var lineInfo = this.getLineInfo(paragraph, offset);\n        selection.start.setPositionFromLine(lineInfo.line, lineInfo.offset);\n        selection.end.setPositionInternal(selection.start);\n        if (!skipSelectionChange) {\n            selection.fireSelectionChanged(true);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.setPositionForCurrentIndex = function (textPosition, editPosition) {\n        var blockInfo = this.getParagraph({ index: editPosition });\n        var lineInfo = this.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageNumber = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\\\*' + numberFormat;\n        }\n        var fieldCode = 'PAGE ' + numberFormat + ' \\\\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertPageCount = function (numberFormat) {\n        if (isNullOrUndefined(numberFormat)) {\n            numberFormat = '';\n        }\n        else {\n            numberFormat = ' \\*' + numberFormat;\n        }\n        var fieldCode = 'NUMPAGES ' + numberFormat + ' \\* MERGEFORMAT';\n        this.createFields(fieldCode);\n    };\n    Editor.prototype.createFields = function (fieldCode) {\n        var paragraph = new ParagraphWidget();\n        var line = new LineWidget(paragraph);\n        var fieldBegin = new FieldElementBox(0);\n        line.children.push(fieldBegin);\n        var fieldtext = new FieldTextElementBox();\n        fieldtext.fieldBegin = fieldBegin;\n        fieldtext.text = '1';\n        var text = new TextElementBox();\n        text.text = fieldCode;\n        line.children.push(text);\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldBegin.fieldSeparator = fieldSeparator;\n        line.children.push(fieldSeparator);\n        line.children.push(fieldtext);\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldSeparator = fieldSeparator;\n        fieldSeparator.fieldEnd = fieldEnd;\n        fieldBegin.fieldEnd = fieldEnd;\n        line.children.push(fieldEnd);\n        fieldBegin.line = line;\n        paragraph.childWidgets.push(line);\n        var widgets = [];\n        widgets.push(paragraph);\n        this.viewer.fields.push(fieldBegin);\n        this.pasteContentsInternal(widgets);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertBookmark = function (name) {\n        var bookmark = new BookmarkElementBox(0);\n        bookmark.name = name;\n        var bookmarkEnd = new BookmarkElementBox(1);\n        bookmarkEnd.name = name;\n        bookmark.reference = bookmarkEnd;\n        bookmarkEnd.reference = bookmark;\n        this.viewer.bookmarks.add(name, bookmark);\n        this.initComplexHistory('InsertBookmark');\n        this.insertElements([bookmarkEnd], [bookmark]);\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n        this.selection.start.setPositionForSelection(bookmark.line, bookmark, 1, this.selection.start.location);\n        this.selection.end.setPositionForSelection(bookmarkEnd.line, bookmarkEnd, 0, this.selection.end.location);\n        this.selection.fireSelectionChanged(true);\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmark = function (bookmarkName) {\n        var bookmarks = this.viewer.bookmarks;\n        var bookmark = bookmarks.get(bookmarkName);\n        if (bookmark instanceof BookmarkElementBox) {\n            var bookmarkEnd = bookmark.reference;\n            this.initHistory('DeleteBookmark');\n            if (this.editorHistory) {\n                this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(bookmark);\n                this.editorHistory.updateHistory();\n            }\n            this.deleteBookmarkInternal(bookmark);\n        }\n        this.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.deleteBookmarkInternal = function (bookmark) {\n        this.viewer.bookmarks.remove(bookmark.name);\n        bookmark.line.children.splice(bookmark.indexInOwner, 1);\n        bookmark.reference.line.children.splice(bookmark.reference.indexInOwner, 1);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectionInfo = function () {\n        var start = this.selection.start;\n        var end = this.selection.end;\n        var isEmpty = this.selection.isEmpty;\n        if (!this.selection.isForward) {\n            start = this.selection.end;\n            end = this.selection.start;\n        }\n        var startElementInfo = start.currentWidget.getInline(start.offset, 0);\n        var endElementInfo = end.currentWidget.getInline(end.offset, 0);\n        // tslint:disable-next-line:max-line-length\n        return { 'start': start.clone(), 'end': end.clone(), 'startElementInfo': startElementInfo, 'endElementInfo': endElementInfo, 'isEmpty': isEmpty };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElements = function (endElements, startElements) {\n        var info = this.getSelectionInfo();\n        if (!isNullOrUndefined(startElements)) {\n            this.insertElementsInternal(info.start, startElements);\n        }\n        if (!isNullOrUndefined(endElements)) {\n            this.insertElementsInternal(info.end, endElements);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.insertElementsInternal = function (position, elements) {\n        this.selection.selectPosition(position, position);\n        this.initHistory('InsertElements');\n        this.updateInsertPosition();\n        var indexInInline = 0;\n        var paragraphInfo = this.getParagraphInfo(this.selection.start);\n        if (this.selection.start.paragraph.isEmpty()) {\n            var paragraph = this.selection.start.paragraph;\n            paragraph.childWidgets[0].children.push(elements[0]);\n            elements[0].line = paragraph.childWidgets[0];\n            elements[0].linkFieldCharacter(this.viewer);\n            this.viewer.layout.reLayoutParagraph(paragraph, 0, 0);\n            this.setPositionParagraph(paragraphInfo.paragraph, paragraphInfo.offset + length, true);\n            position.setPositionForSelection(elements[0].line, elements[0], elements[0].length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        else {\n            var inlineObj = this.selection.start.currentWidget.getInline(this.viewer.selection.start.offset, indexInInline);\n            var curInline = inlineObj.element;\n            indexInInline = inlineObj.index;\n            var firstElement = elements[0];\n            this.insertElementInternal(curInline, firstElement, indexInInline, true);\n            var index = firstElement.indexInOwner;\n            var lastElement = firstElement;\n            for (var i = 1; i < elements.length; i++) {\n                lastElement = elements[i];\n                firstElement.line.children.splice(index + i, 0, lastElement);\n            }\n            position.setPositionForSelection(lastElement.line, lastElement, lastElement.length, this.selection.start.location);\n            this.selection.selectPosition(position, position);\n        }\n        if (this.editorHistory) {\n            if (this.checkEndPosition()) {\n                this.updateHistoryPosition(this.selection.start, false);\n            }\n            this.editorHistory.updateHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getHierarchicalIndex = function (block, offset) {\n        var index;\n        if (block) {\n            if (block instanceof HeaderFooterWidget) {\n                var hfString = block.headerFooterType.indexOf('Header') !== -1 ? 'H' : 'F';\n                var pageIndex = block.page.index.toString();\n                var headerFooterIndex = this.viewer.getHeaderFooter(block.headerFooterType).toString();\n                var sectionIndex = block.page.sectionIndex;\n                index = sectionIndex + ';' + hfString + ';' + pageIndex + ';' + offset;\n            }\n            else {\n                index = block.index + ';' + offset;\n            }\n            if (block.containerWidget) {\n                if (block instanceof TableCellWidget && block.rowIndex !== block.containerWidget.index) {\n                    index = block.rowIndex + ';' + index;\n                    block = block.containerWidget;\n                }\n                return this.getHierarchicalIndex(block.containerWidget, index);\n            }\n        }\n        return index;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlock = function (position) {\n        var bodyWidget = this.getBodyWidget(position);\n        return this.getBlockInternal(bodyWidget, position);\n    };\n    /**\n     * Return Block relative to position\n     * @private\n     */\n    Editor.prototype.getBlockInternal = function (widget, position) {\n        if (position.index === '' || isNullOrUndefined(position)) {\n            return undefined;\n        }\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var node = widget;\n        // if (node instanceof WSection && value === 'HF') {\n        //     //Gets the block in Header footers.\n        //     let blockObj: BlockInfo = this.getBlock((node as WSection).headerFooters, position);\n        // tslint:disable-next-line:max-line-length\n        //     return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n        // }\n        index = parseInt(value, 10);\n        var childWidget = this.getBlockByIndex(widget, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (position.index.indexOf(';') >= 0) {\n                if (child instanceof ParagraphWidget) {\n                    if (position.index.indexOf(';') >= 0) {\n                        position.index = '0';\n                    }\n                    return { 'node': child, 'position': position };\n                }\n                if (child instanceof Widget) {\n                    var blockObj = this.getBlockInternal(child, position);\n                    // tslint:disable-next-line:max-line-length\n                    return { 'node': (!isNullOrUndefined(blockObj)) ? blockObj.node : undefined, 'position': (!isNullOrUndefined(blockObj)) ? blockObj.position : undefined };\n                }\n            }\n            else {\n                return { 'node': child, 'position': position };\n            }\n        }\n        else {\n            return { 'node': node, 'position': position };\n        }\n        return { 'node': node, 'position': position };\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getParagraph = function (position) {\n        var paragraph = this.getParagraphInternal(this.getBodyWidget(position), position);\n        return { paragraph: paragraph, offset: parseInt(position.index, 10) };\n    };\n    /**\n     * Get paragraph relative to position\n     * @private\n     */\n    Editor.prototype.getParagraphInternal = function (container, position) {\n        if (isNullOrUndefined(position.index)) {\n            return undefined;\n        }\n        // let ins: Widget = container;\n        var index = position.index.indexOf(';');\n        var value = '0';\n        if (index >= 0) {\n            value = position.index.substring(0, index);\n            position.index = position.index.substring(index).replace(';', '');\n        }\n        // if (container instanceof BodyWidget && value === 'HF') {\n        //     return this.getParagraph(container.headerFooters, position);\n        // }\n        index = parseInt(value, 10);\n        if (container instanceof TableRowWidget && index >= container.childWidgets.length) {\n            position.index = '0;0';\n            index = container.childWidgets.length - 1;\n        }\n        var childWidget = this.getBlockByIndex(container, index);\n        if (childWidget) {\n            var child = childWidget;\n            if (child instanceof ParagraphWidget) {\n                if (position.index.indexOf(';') > 0) {\n                    position.index = '0';\n                }\n                return child;\n            }\n            if (child instanceof Widget) {\n                if (position.index.indexOf(';') > 0) {\n                    return this.getParagraphInternal(child, position);\n                }\n                else {\n                    //If table is shifted to previous text position then return the first paragraph within table.\n                    if (child instanceof TableWidget) {\n                        return this.viewer.selection.getFirstParagraphInFirstCell(child);\n                    }\n                    return undefined;\n                }\n            }\n        }\n        else if (container) {\n            var nextWidget = container.getSplitWidgets().pop().nextRenderedWidget;\n            if (nextWidget instanceof Widget) {\n                position.index = '0';\n                if (nextWidget instanceof TableWidget) {\n                    return this.viewer.selection.getFirstParagraphInFirstCell(nextWidget);\n                }\n                return nextWidget;\n            }\n        }\n        return undefined;\n    };\n    Editor.prototype.getBodyWidget = function (position) {\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var sectionIndex = parseInt(value, 10);\n        index = parseInt(value, 10);\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        // position = position.substring(index).replace(';', '');\n        if (value === 'H' || value === 'F') {\n            return this.getHeaderFooterWidget(position);\n        }\n        index = parseInt(value, 10);\n        return this.getBodyWidgetInternal(sectionIndex, index);\n    };\n    Editor.prototype.getHeaderFooterWidget = function (position) {\n        //HEADER OR FOOTER WIDGET\n        var index = position.index.indexOf(';');\n        var value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        var isHeader = value === 'H';\n        index = position.index.indexOf(';');\n        value = position.index.substring(0, index);\n        position.index = position.index.substring(index).replace(';', '');\n        index = parseInt(value, 10);\n        var page = this.viewer.pages[index];\n        if (isHeader) {\n            return page.headerWidget;\n        }\n        else {\n            return page.footerWidget;\n        }\n    };\n    Editor.prototype.getBodyWidgetInternal = function (sectionIndex, blockIndex) {\n        for (var i = 0; i < this.viewer.pages.length; i++) {\n            var bodyWidget = this.viewer.pages[i].bodyWidgets[0];\n            if (bodyWidget.index === sectionIndex) {\n                if (bodyWidget.firstChild.index <= blockIndex && bodyWidget.lastChild.index >= blockIndex) {\n                    return bodyWidget;\n                }\n            }\n            if (bodyWidget.index > sectionIndex) {\n                break;\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBlockByIndex = function (container, blockIndex) {\n        var childWidget;\n        if (container) {\n            for (var j = 0; j < container.childWidgets.length; j++) {\n                if (container.childWidgets[j].index === blockIndex) {\n                    childWidget = container.childWidgets[j];\n                    break;\n                }\n            }\n            if (!childWidget && !(container instanceof HeaderFooterWidget)) {\n                return this.getBlockByIndex(container.nextSplitWidget, blockIndex);\n            }\n        }\n        return childWidget;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateHistoryPosition = function (position, isInsertPosition) {\n        if (this.editorHistory && !isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            var hierarchicalIndex = void 0;\n            if (position instanceof TextPosition) {\n                var blockInfo = this.getParagraphInfo(position);\n                hierarchicalIndex = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n            }\n            else {\n                hierarchicalIndex = position;\n            }\n            if (isInsertPosition) {\n                this.editorHistory.currentBaseHistoryInfo.insertPosition = hierarchicalIndex;\n            }\n            else {\n                this.editorHistory.currentBaseHistoryInfo.endPosition = hierarchicalIndex;\n            }\n        }\n    };\n    /**\n     * Applies the borders based on given settings.\n     * @param {BorderSettings} settings\n     */\n    Editor.prototype.applyBorders = function (settings) {\n        this.initHistory('Borders');\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        if (this.editorHistory) {\n            var clonedTable = this.cloneTableToHistoryInfo(table);\n        }\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells;\n        var border = this.getBorder(settings.borderColor, settings.lineWidth, settings.borderStyle);\n        if (this.selection.isEmpty) {\n            //Apply borders for current selected cell initially.                    \n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'LeftBorder') {\n                endCell.cellFormat.borders.left.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'TopBorder') {\n                endCell.cellFormat.borders.top.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'RightBorder') {\n                endCell.cellFormat.borders.right.copyFormat(border);\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'AllBorders' ||\n                settings.type === 'BottomBorder') {\n                endCell.cellFormat.borders.bottom.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideVerticalBorder') {\n                endCell.cellFormat.borders.vertical.copyFormat(border);\n            }\n            if (settings.type === 'AllBorders' || settings.type === 'InsideBorders'\n                || settings.type === 'InsideHorizontalBorder') {\n                endCell.cellFormat.borders.horizontal.copyFormat(border);\n            }\n            if (settings.type === 'NoBorder') {\n                this.clearAllBorderValues(endCell.cellFormat.borders);\n            }\n        }\n        else {\n            if (settings.type === 'OutsideBorders' || settings.type === 'TopBorder') {\n                var selectedCell = this.getTopBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.top.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'LeftBorder') {\n                var selectedCell = this.getLeftBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.left.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'RightBorder') {\n                var selectedCell = this.getRightBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.right.copyFormat(border);\n                }\n            }\n            if (settings.type === 'OutsideBorders' || settings.type === 'BottomBorder') {\n                var selectedCell = this.getBottomBorderCellsOnSelection();\n                for (var i = 0; i < selectedCell.length; i++) {\n                    selectedCell[i].cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n        }\n        //Apply Only borders property to selected cells      \n        if (settings.type === 'BottomBorder' || settings.type === 'AllBorders' || settings.type === 'OutsideBorders'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyBottomBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.top.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.top.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'OutsideBorders' || settings.type === 'RightBorder'\n            || settings.type === 'NoBorder') {\n            cells = this.getAdjacentCellToApplyRightBorder();\n            for (var i = 0; i < cells.length; i++) {\n                var cell = cells[i];\n                if (settings.type === 'NoBorder') {\n                    cell.cellFormat.borders.left.copyFormat(this.clearBorder());\n                }\n                else {\n                    cell.cellFormat.borders.left.copyFormat(border);\n                }\n            }\n        }\n        if (settings.type === 'AllBorders' || settings.type === 'NoBorder') {\n            this.applyAllBorders(border, settings.type);\n        }\n        if (settings.type === 'InsideBorders' || settings.type === 'InsideVerticalBorder'\n            || settings.type === 'InsideHorizontalBorder' || settings.type === 'NoBorder') {\n            this.applyInsideBorders(border, settings.type, table);\n        }\n        this.updateGridForTableDialog(table, false);\n        this.reLayout(this.selection, false);\n        this.editorHistory.updateHistory();\n    };\n    Editor.prototype.applyAllBorders = function (border, borderType) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (borderType === 'NoBorder') {\n                cells[i].cellFormat.borders.left.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.right.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.top.copyFormat(this.clearBorder());\n                cells[i].cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                cells[i].cellFormat.borders.left.copyFormat(border);\n                cells[i].cellFormat.borders.right.copyFormat(border);\n                cells[i].cellFormat.borders.top.copyFormat(border);\n                cells[i].cellFormat.borders.bottom.copyFormat(border);\n            }\n        }\n    };\n    Editor.prototype.applyInsideBorders = function (border, borderType, table) {\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i];\n            var isLastSelectedRow = cell.ownerRow === cells[cells.length - 1].ownerRow;\n            var isLastRightCell = (cell.columnIndex + cell.cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex;\n            if (borderType === 'NoBorder') {\n                cell.cellFormat.borders.right.copyFormat(this.clearBorder());\n                cell.cellFormat.borders.bottom.copyFormat(this.clearBorder());\n            }\n            else {\n                if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                    cell.cellFormat.borders.right.copyFormat(border);\n                }\n                if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                    cell.cellFormat.borders.bottom.copyFormat(border);\n                }\n            }\n            if (!isLastSelectedRow && borderType !== 'InsideVerticalBorder') {\n                // Apply adjacent bottom borders.\n                var nextRowIndex = cell.ownerRow.rowIndex + cell.cellFormat.rowSpan;\n                var nextRow = table.childWidgets[nextRowIndex];\n                if (nextRow) {\n                    var selectedCells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, cell, true);\n                    for (var j = 0; j < selectedCells.length; j++) {\n                        if (borderType === 'NoBorder') {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(this.clearBorder());\n                        }\n                        else {\n                            selectedCells[j].cellFormat.borders.top.copyFormat(border);\n                        }\n                    }\n                }\n            }\n            if (!isLastRightCell && borderType !== 'InsideHorizontalBorder') {\n                // Apply adjacent right borders.\n                var rightBorderCells = this.getSelectedCellsNextWidgets(cell, table);\n                for (var k = 0; k < rightBorderCells.length; k++) {\n                    if (borderType === 'NoBorder') {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(this.clearBorder());\n                    }\n                    else {\n                        rightBorderCells[k].cellFormat.borders.left.copyFormat(border);\n                    }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTopBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var topBorderCells = [];\n        var cells = this.selection.getSelectedCells();\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === startCell.ownerRow) {\n                topBorderCells.push(cells[i]);\n            }\n        }\n        return topBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getLeftBorderCellsOnSelection = function () {\n        var startPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var startCell = startPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var leftBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].columnIndex === startCell.columnIndex) {\n                leftBorderCells.push(cells[i]);\n            }\n        }\n        return leftBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getRightBorderCellsOnSelection = function () {\n        var cells = this.selection.getSelectedCells();\n        var rightBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if ((cells[i].columnIndex + cells[i].cellFormat.columnSpan - 1) === cells[cells.length - 1].columnIndex) {\n                rightBorderCells.push(cells[i]);\n            }\n        }\n        return rightBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBottomBorderCellsOnSelection = function () {\n        var endPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var endCell = endPos.paragraph.associatedCell;\n        var cells = this.selection.getSelectedCells();\n        var bottomBorderCells = [];\n        for (var i = 0; i < cells.length; i++) {\n            if (cells[i].ownerRow === endCell.ownerRow) {\n                bottomBorderCells.push(cells[i]);\n            }\n        }\n        return bottomBorderCells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.clearAllBorderValues = function (borders) {\n        var border = this.clearBorder();\n        borders.bottom.copyFormat(border);\n        borders.left.copyFormat(border);\n        borders.right.copyFormat(border);\n        borders.top.copyFormat(border);\n        borders.vertical.copyFormat(border);\n        borders.horizontal.copyFormat(border);\n    };\n    Editor.prototype.clearBorder = function () {\n        var border = new WBorder();\n        border.lineStyle = 'Cleared';\n        return border;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyBottomBorder = function () {\n        var cells = [];\n        var startPos = this.selection.start;\n        var endPos = this.selection.end;\n        if (!this.selection.isForward) {\n            startPos = this.selection.end;\n            endPos = this.selection.start;\n        }\n        var table = startPos.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPos.paragraph.associatedCell;\n        var endCell = endPos.paragraph.associatedCell;\n        var nextRowIndex = endCell.ownerRow.rowIndex + endCell.cellFormat.rowSpan;\n        var nextRow = table.childWidgets[nextRowIndex];\n        if (nextRow) {\n            if (endCell.cellFormat.columnSpan > 1) {\n                for (var i = endCell.columnIndex; i < endCell.columnIndex + endCell.cellFormat.columnSpan; i++) {\n                    cells.push(nextRow.childWidgets[i]);\n                }\n            }\n            else {\n                cells = this.getAdjacentBottomBorderOnEmptyCells(nextRow, endCell);\n                if (!this.selection.isEmpty) {\n                    for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                        var nextCellColIndex = nextRow.childWidgets[i].columnIndex;\n                        if (nextCellColIndex >= startCell.columnIndex && nextCellColIndex <= endCell.columnIndex) {\n                            cells.push(nextRow.childWidgets[i]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getAdjacentBottomBorderOnEmptyCells = function (nextRow, cell, isSingleCell) {\n        var cells = [];\n        if (cell.cellFormat.columnSpan > 1) {\n            for (var i = cell.columnIndex; i < cell.columnIndex + cell.cellFormat.columnSpan; i++) {\n                cells.push(nextRow.childWidgets[i]);\n            }\n        }\n        else {\n            if (this.selection.isEmpty || isSingleCell) {\n                for (var i = 0; i < nextRow.childWidgets.length; i++) {\n                    if (nextRow.childWidgets[i].columnIndex === cell.columnIndex) {\n                        cells.push(nextRow.childWidgets[i]);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getAdjacentCellToApplyRightBorder = function () {\n        var cells = [];\n        var startPosIn = this.selection.start;\n        var endPosIn = this.selection.end;\n        if (!this.selection.isForward) {\n            startPosIn = this.selection.end;\n            endPosIn = this.selection.start;\n        }\n        var table = startPosIn.paragraph.associatedCell.ownerTable;\n        table = table.combineWidget(this.viewer);\n        var startCell = startPosIn.paragraph.associatedCell;\n        var endCell = endPosIn.paragraph.associatedCell;\n        if (this.selection.isEmpty) {\n            var selectedCell = startPosIn.paragraph.associatedCell;\n            cells = this.getSelectedCellsNextWidgets(selectedCell, table);\n        }\n        else {\n            // tslint:disable-next-line:max-line-length\n            var selectedCells = this.getRightBorderCellsOnSelection();\n            for (var i = 0; i < selectedCells.length; i++) {\n                var cell = selectedCells[i];\n                cells = cells.concat(this.getSelectedCellsNextWidgets(cell, table));\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getSelectedCellsNextWidgets = function (selectedCell, table) {\n        var cells = [];\n        if (selectedCell.nextWidget) {\n            cells.push(selectedCell.nextWidget);\n        }\n        if (selectedCell.cellFormat.rowSpan > 1) {\n            var nextRowIndex = selectedCell.ownerRow.rowIndex + selectedCell.cellFormat.rowSpan;\n            for (var i = selectedCell.ownerRow.rowIndex + 1; i < nextRowIndex; i++) {\n                var nextRow = table.childWidgets[i];\n                if (nextRow) {\n                    for (var j = 0; j < nextRow.childWidgets.length; j++) {\n                        if (nextRow.childWidgets[j].columnIndex ===\n                            selectedCell.nextWidget.columnIndex) {\n                            cells.push(nextRow.childWidgets[j]);\n                        }\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getBorder = function (borderColor, lineWidth, borderStyle) {\n        var border = new WBorder();\n        border.color = borderColor || '#000000';\n        border.lineWidth = lineWidth || 1;\n        border.lineStyle = borderStyle || 'Single';\n        return border;\n    };\n    /**\n     * Applies borders\n     * @param  {WBorders} sourceBorders\n     * @param  {WBorders} applyBorders\n     * @private\n     */\n    Editor.prototype.applyBordersInternal = function (sourceBorders, applyBorders) {\n        if (!isNullOrUndefined(sourceBorders) && !isNullOrUndefined(sourceBorders)) {\n            if (!isNullOrUndefined(sourceBorders.top)) {\n                this.applyBorder(sourceBorders.top, applyBorders.top);\n            }\n            if (!isNullOrUndefined(sourceBorders.bottom)) {\n                this.applyBorder(sourceBorders.bottom, applyBorders.bottom);\n            }\n            if (!isNullOrUndefined(sourceBorders.left)) {\n                this.applyBorder(sourceBorders.left, applyBorders.left);\n            }\n            if (!isNullOrUndefined(sourceBorders.right)) {\n                this.applyBorder(sourceBorders.right, applyBorders.right);\n            }\n            if (!isNullOrUndefined(sourceBorders.horizontal)) {\n                this.applyBorder(sourceBorders.horizontal, applyBorders.horizontal);\n            }\n            if (!isNullOrUndefined(sourceBorders.vertical)) {\n                this.applyBorder(sourceBorders.vertical, applyBorders.vertical);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalUp)) {\n                this.applyBorder(sourceBorders.diagonalUp, applyBorders.diagonalUp);\n            }\n            if (!isNullOrUndefined(sourceBorders.diagonalDown)) {\n                this.applyBorder(sourceBorders.diagonalDown, applyBorders.diagonalDown);\n            }\n        }\n    };\n    /**\n     * Apply shading to table\n     * @param  {WShading} sourceShading\n     * @param  {WShading} applyShading\n     * @private\n     */\n    Editor.prototype.applyShading = function (sourceShading, applyShading) {\n        if (!isNullOrUndefined(applyShading) && !isNullOrUndefined(sourceShading)) {\n            if (!isNullOrUndefined(applyShading.backgroundColor)\n                && sourceShading.backgroundColor !== applyShading.backgroundColor) {\n                sourceShading.backgroundColor = applyShading.backgroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.foregroundColor)\n                && sourceShading.foregroundColor !== applyShading.foregroundColor) {\n                sourceShading.foregroundColor = applyShading.foregroundColor;\n            }\n            if (!isNullOrUndefined(applyShading.textureStyle)\n                && sourceShading.textureStyle !== applyShading.textureStyle) {\n                sourceShading.textureStyle = applyShading.textureStyle;\n            }\n        }\n    };\n    Editor.prototype.applyBorder = function (sourceBorder, applyBorder) {\n        if (!isNullOrUndefined(sourceBorder) && !isNullOrUndefined(applyBorder)) {\n            if (!isNullOrUndefined(applyBorder.color)\n                && sourceBorder.color !== applyBorder.color) {\n                sourceBorder.color = applyBorder.color;\n            }\n            if (!isNullOrUndefined(applyBorder.lineStyle)\n                && sourceBorder.lineStyle !== applyBorder.lineStyle) {\n                sourceBorder.lineStyle = applyBorder.lineStyle;\n            }\n            if (!isNullOrUndefined(applyBorder.lineWidth)\n                && sourceBorder.lineWidth !== applyBorder.lineWidth) {\n                sourceBorder.lineWidth = applyBorder.lineWidth;\n            }\n            if (!isNullOrUndefined(applyBorder.shadow)\n                && sourceBorder.shadow !== applyBorder.shadow) {\n                sourceBorder.shadow = applyBorder.shadow;\n            }\n            if (!isNullOrUndefined(applyBorder.space)\n                && sourceBorder.space !== applyBorder.space) {\n                sourceBorder.space = applyBorder.space;\n            }\n        }\n    };\n    /**\n     * Apply Table Format changes\n     * @param  {Selection} selection\n     * @param  {WTableFormat} format\n     * @private\n     */\n    Editor.prototype.onTableFormat = function (format) {\n        if (!isNullOrUndefined(this.selection.tableFormat)) {\n            this.viewer.owner.isShiftingEnabled = true;\n            this.editorHistory.initializeHistory('TableFormat');\n            var table = this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n            this.applyTableFormat(table, undefined, format);\n            this.reLayout(this.selection, false);\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.applyTableFormat = function (table, property, value) {\n        this.applyTablePropertyValue(this.viewer.selection, undefined, value, table);\n    };\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.applyTablePropertyValue = function (selection, property, value, table) {\n        var sourceFormat = table.tableFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(sourceFormat, property, value);\n        }\n        if (value instanceof WTableFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleTableFormat(sourceFormat, value);\n            }\n            return;\n        }\n        if (property === 'preferredWidth') {\n            sourceFormat.preferredWidth = value;\n        }\n        else if (property === 'leftIndent') {\n            sourceFormat.leftIndent = value;\n        }\n        else if (property === 'tableAlignment') {\n            sourceFormat.tableAlignment = value;\n        }\n        else if (property === 'cellSpacing') {\n            sourceFormat.cellSpacing = value;\n        }\n        else if (property === 'leftMargin') {\n            sourceFormat.leftMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            sourceFormat.rightMargin = value;\n        }\n        else if (property === 'topMargin') {\n            sourceFormat.topMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            sourceFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidthType') {\n            sourceFormat.preferredWidthType = value;\n        }\n        if (property === 'shading') {\n            sourceFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            sourceFormat.borders = value;\n        }\n        // if (!isNullOrUndefined(table)) {\n        //     this.layoutItemBlock(table, true);\n        // }\n    };\n    Editor.prototype.handleTableFormat = function (tableFormat, applyFormat) {\n        if (this.isBordersAndShadingDialog || this.editorHistory.isUndoing\n            || this.editorHistory.isRedoing) {\n            if (!isNullOrUndefined(tableFormat.borders)) {\n                this.applyBordersInternal(tableFormat.borders, applyFormat.borders);\n            }\n            if (!isNullOrUndefined(tableFormat.shading)) {\n                this.applyShading(tableFormat.shading, applyFormat.shading);\n            }\n        }\n        if (!this.isBordersAndShadingDialog) {\n            if (applyFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== tableFormat.preferredWidth) {\n                tableFormat.preferredWidth = applyFormat.preferredWidth;\n            }\n            if (applyFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== tableFormat.preferredWidthType) {\n                tableFormat.preferredWidthType = applyFormat.preferredWidthType;\n            }\n            if (applyFormat.hasValue('tableAlignment') && applyFormat.tableAlignment !== tableFormat.tableAlignment) {\n                tableFormat.tableAlignment = applyFormat.tableAlignment;\n            }\n            if (applyFormat.hasValue('leftIndent') && applyFormat.leftIndent !== tableFormat.leftIndent) {\n                tableFormat.leftIndent = applyFormat.leftIndent;\n            }\n        }\n        this.updateGridForTableDialog(tableFormat.ownerBase, false);\n    };\n    Editor.prototype.updateGridForTableDialog = function (table, shiftNextItem) {\n        if (table.tableHolder) {\n            table.updateRowIndex(0);\n            table.calculateGrid();\n            table.isGridUpdated = false;\n        }\n        this.viewer.layout.reLayoutTable(table);\n    };\n    /**\n     * Applies Row Format Changes\n     * @param  {Selection} selection\n     * @param  {WRowFormat} format\n     * @param  {WRow} row\n     * @private\n     */\n    Editor.prototype.onRowFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('RowFormat');\n        this.viewer.owner.isShiftingEnabled = true;\n        var rowStartPos = this.selection.isForward ? this.selection.start : this.selection.end;\n        var rowEndPos = this.selection.isForward ? this.selection.end : this.selection.start;\n        var table = rowStartPos.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);\n        this.applyRowFormat(rowStartPos.paragraph.associatedCell.ownerRow, rowStartPos, rowEndPos, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    Editor.prototype.applyRowFormat = function (row, start, end, property, value) {\n        this.applyRowPropertyValue(this.viewer.selection, property, value, row);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyRowFormat(newRow, start, end, property, value);\n        }\n    };\n    Editor.prototype.applyRowPropertyValue = function (selection, property, value, row) {\n        var applyFormat = row.rowFormat;\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(applyFormat, property, value);\n        }\n        if (value instanceof WRowFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleRowFormat(value, applyFormat);\n            }\n            return;\n        }\n        if (property === 'heightType') {\n            applyFormat.heightType = value;\n        }\n        else if (property === 'height') {\n            applyFormat.height = value;\n        }\n        else if (property === 'isHeader') {\n            applyFormat.isHeader = value;\n        }\n        else if (property === 'allowBreakAcrossPages') {\n            applyFormat.allowBreakAcrossPages = value;\n        }\n        if (!isNullOrUndefined(row.ownerTable)) {\n            this.layoutItemBlock(row.ownerTable, true);\n        }\n    };\n    Editor.prototype.handleRowFormat = function (format, applyFormat) {\n        if (format.hasValue('allowBreakAcrossPages') && format.allowBreakAcrossPages !== applyFormat.allowBreakAcrossPages) {\n            applyFormat.allowBreakAcrossPages = format.allowBreakAcrossPages;\n        }\n        if (format.hasValue('isHeader') && format.isHeader !== applyFormat.isHeader) {\n            applyFormat.isHeader = format.isHeader;\n        }\n        if (format.hasValue('heightType') && format.heightType !== applyFormat.heightType) {\n            applyFormat.heightType = format.heightType;\n        }\n        if (format.hasValue('height') && format.height !== applyFormat.height) {\n            applyFormat.height = format.height;\n        }\n        this.updateGridForTableDialog(applyFormat.ownerBase.ownerTable, true);\n    };\n    /**\n     * Applies Cell Format changes\n     * @param  {Selection} selection\n     * @param  {WCellFormat} format\n     * @param  {WCell} cell\n     * @private\n     */\n    Editor.prototype.onCellFormat = function (format) {\n        if (isNullOrUndefined(this.selection) || isNullOrUndefined(format)) {\n            return;\n        }\n        this.editorHistory.initializeHistory('CellFormat');\n        this.updateFormatForCell(this.selection, undefined, format);\n        this.reLayout(this.selection, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateCellMargins = function (selection, value) {\n        var cellStartPosition = selection.start;\n        var cellEndPosition = selection.end;\n        if (!selection.isForward) {\n            cellStartPosition = selection.end;\n            cellEndPosition = selection.start;\n        }\n        this.initHistoryPosition(selection, cellStartPosition);\n        // tslint:disable-next-line:max-line-length\n        this.viewer.owner.cellOptionsDialogModule.applyCellmarginsValue(cellStartPosition.paragraph.associatedCell.ownerRow, cellStartPosition, cellEndPosition, value);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.updateFormatForCell = function (selection, property, value) {\n        var start = selection.start;\n        var end = selection.end;\n        if (!selection.isForward) {\n            start = selection.end;\n            end = selection.start;\n        }\n        var startCell = start.paragraph.associatedCell;\n        var endCell = end.paragraph.associatedCell;\n        var cells;\n        var table = startCell.ownerTable.combineWidget(this.viewer);\n        var appliedFormat;\n        for (var k = startCell.columnIndex; k <= endCell.columnIndex; k++) {\n            cells = this.getSelectedCellInColumn(startCell.ownerTable, startCell.ownerRow.rowIndex, k, endCell.ownerRow.rowIndex);\n            for (var i = 0; i < cells.length; i++) {\n                appliedFormat = this.applyCellPropertyValue(this.viewer.selection, property, value, cells[i].cellFormat);\n            }\n        }\n        this.updateGridForTableDialog(table, false);\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getSelectedCellInColumn = function (table, rowStartIndex, columnIndex, rowEndIndex) {\n        var cells = [];\n        for (var i = rowStartIndex; i <= rowEndIndex; i++) {\n            var row = table.childWidgets[i];\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                if (row.childWidgets[j].columnIndex === columnIndex) {\n                    cells.push(row.childWidgets[j]);\n                }\n            }\n        }\n        return cells;\n    };\n    Editor.prototype.getColumnCells = function (table, columnIndex, isLeftSideCollection) {\n        var cells = [];\n        for (var k = 0; k < table.childWidgets.length; k++) {\n            var row = table.childWidgets[k];\n            for (var i = 0; i < row.childWidgets.length; i++) {\n                var cell = row.childWidgets[i];\n                if (isLeftSideCollection) {\n                    if (cell.columnIndex + cell.cellFormat.columnSpan === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n                else {\n                    if (cell.columnIndex === columnIndex) {\n                        cells.push(cell);\n                    }\n                }\n            }\n        }\n        return cells;\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.getTableWidth = function (table) {\n        if (table.tableFormat.preferredWidth !== 0 || table.tableFormat.preferredWidthType === 'Percent') {\n            if (table.tableFormat.preferredWidthType === 'Auto' || table.tableFormat.preferredWidthType === 'Point') {\n                return table.tableFormat.preferredWidth;\n            }\n            else {\n                if (table.tableFormat.preferredWidth === 0) {\n                    return 0;\n                }\n                else {\n                    return HelperMethods.convertPixelToPoint(this.viewer.clientArea.width) / 100 * table.tableFormat.preferredWidth;\n                }\n            }\n        }\n        return HelperMethods.convertPixelToPoint(this.viewer.layout.getTableWidth(table));\n    };\n    Editor.prototype.applyCellPropertyValue = function (selection, property, value, applyFormat) {\n        if (!isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)) {\n            value = this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(applyFormat, property, value);\n        }\n        if (value instanceof WCellFormat) {\n            if (isNullOrUndefined(property)) {\n                this.handleCellFormat(value, applyFormat);\n            }\n            return value;\n        }\n        if (property === 'leftMargin') {\n            applyFormat.leftMargin = value;\n        }\n        else if (property === 'topMargin') {\n            applyFormat.topMargin = value;\n        }\n        else if (property === 'rightMargin') {\n            applyFormat.rightMargin = value;\n        }\n        else if (property === 'bottomMargin') {\n            applyFormat.bottomMargin = value;\n        }\n        else if (property === 'preferredWidth') {\n            applyFormat.preferredWidth = value;\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'cellWidth') {\n            applyFormat.cellWidth = value;\n        }\n        else if (property === 'columnSpan') {\n            applyFormat.columnSpan = value;\n        }\n        else if (property === 'rowSpan') {\n            applyFormat.rowSpan = value;\n        }\n        else if (property === 'preferredWidthType') {\n            applyFormat.preferredWidthType = value;\n        }\n        else if (property === 'verticalAlignment') {\n            applyFormat.verticalAlignment = value;\n        }\n        if (property === 'shading') {\n            applyFormat.shading = value;\n        }\n        else if (property === 'borders') {\n            applyFormat.borders = value;\n        }\n        return undefined;\n    };\n    Editor.prototype.handleCellFormat = function (cellFormat, applyFormat) {\n        if (!isNullOrUndefined(cellFormat) && !isNullOrUndefined(applyFormat)) {\n            if (this.isBordersAndShadingDialog) {\n                if (!isNullOrUndefined(cellFormat.borders)) {\n                    this.applyBordersInternal(applyFormat.borders, cellFormat.borders);\n                }\n                if (!isNullOrUndefined(cellFormat.shading)) {\n                    this.applyShading(applyFormat.shading, cellFormat.shading);\n                }\n                // this.layoutRow((applyFormat.ownerBase as TableCellWidget).ownerRow, this.viewer, false);\n            }\n            else {\n                if (cellFormat.hasValue('preferredWidth') && applyFormat.preferredWidth !== cellFormat.preferredWidth) {\n                    applyFormat.preferredWidth = cellFormat.preferredWidth;\n                }\n                if (cellFormat.hasValue('preferredWidthType') && applyFormat.preferredWidthType !== cellFormat.preferredWidthType) {\n                    applyFormat.preferredWidthType = cellFormat.preferredWidthType;\n                }\n                if (cellFormat.hasValue('verticalAlignment') && applyFormat.verticalAlignment !== cellFormat.verticalAlignment) {\n                    applyFormat.verticalAlignment = cellFormat.verticalAlignment;\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    Editor.prototype.destroy = function () {\n        this.viewer = undefined;\n        this.nodes = [];\n    };\n    Editor.prototype.isTocField = function (element) {\n        if (element instanceof FieldElementBox) {\n            var nextElement = element.nextNode;\n            if (element instanceof FieldElementBox && element.fieldType === 0 && nextElement instanceof TextElementBox\n                && nextElement.text.trim().toLowerCase().indexOf('toc') === 0) {\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * Updates the table of contents.\n     * @private\n     */\n    Editor.prototype.updateToc = function (tocField) {\n        if (isNullOrUndefined(tocField)) {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (!this.isTocField(tocField)) {\n            return;\n        }\n        // Decode field code to get parameters\n        var code = this.selection.getFieldCode(tocField);\n        if (code.toLocaleLowerCase().indexOf('toc') !== -1) {\n            this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(code, tocField)));\n        }\n    };\n    Editor.prototype.getTocSettings = function (code, tocField) {\n        var tocSettings = {};\n        tocSettings.includePageNumber = true;\n        tocSettings.rightAlign = true;\n        // Decode field code to get parameters\n        if (code.toLowerCase() === 'toc \\\\mergeformat') {\n            tocSettings.startLevel = 1;\n            tocSettings.endLevel = 3;\n        }\n        else {\n            var swtiches = code.split('\\\\');\n            for (var i = 0; i < swtiches.length; i++) {\n                var swtch = swtiches[i];\n                if (swtch.length === 0) {\n                    continue;\n                }\n                switch (swtch[0]) {\n                    case 'o':\n                        if (!isNullOrUndefined(swtch.match(/\\d+/g))) {\n                            var levels = swtch.match(/\\d+/g).map(Number);\n                            tocSettings.startLevel = levels[0];\n                            tocSettings.endLevel = levels[1];\n                        }\n                        else {\n                            tocSettings.startLevel = 1;\n                            tocSettings.endLevel = 9;\n                        }\n                        break;\n                    case 'h':\n                        tocSettings.includeHyperlink = true;\n                        break;\n                    case 'n':\n                        tocSettings.includePageNumber = false;\n                        break;\n                    case 'p':\n                        tocSettings.rightAlign = false;\n                        break;\n                    case 'u':\n                        tocSettings.includeOutlineLevels = true;\n                        break;\n                    case 't':\n                        this.decodeTSwitch(tocSettings, swtch);\n                        break;\n                }\n            }\n        }\n        //assigns tab leader.\n        var tabs = tocField.paragraph.paragraphFormat.getUpdatedTabs();\n        if (tabs.length > 0) {\n            tocSettings.tabLeader = tabs[tabs.length - 1].tabLeader;\n        }\n        if (tocSettings.rightAlign && isNullOrUndefined(tocSettings.tabLeader)) {\n            tocSettings.tabLeader = 'Dot';\n        }\n        return tocSettings;\n    };\n    Editor.prototype.decodeTSwitch = function (tocSettings, tSwitch) {\n        tocSettings.levelSettings = {};\n        tSwitch = tSwitch.replace('t', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.replace('\"', '');\n        tSwitch = tSwitch.trim();\n        var levels = tSwitch.split(',');\n        for (var index = 0; index < levels.length; index++) {\n            tocSettings.levelSettings[levels[index]] = parseInt(levels[index + 1], 10);\n            index++;\n        }\n    };\n    /**\n     * Inserts, modifies or updates the table of contents based on given settings.\n     * @param {TableOfContentsSettings} tableOfContentsSettings\n     */\n    Editor.prototype.insertTableOfContents = function (tableOfContentsSettings) {\n        this.isInsertingTOC = true;\n        this.initComplexHistory('TOC');\n        if (isNullOrUndefined(tableOfContentsSettings)) {\n            //Initializes with default value.\n            tableOfContentsSettings = {};\n            tableOfContentsSettings.startLevel = 1;\n            tableOfContentsSettings.endLevel = 3;\n            tableOfContentsSettings.includeHyperlink = true;\n            tableOfContentsSettings.includeOutlineLevels = true;\n            tableOfContentsSettings.includePageNumber = true;\n            tableOfContentsSettings.rightAlign = true;\n            tableOfContentsSettings.tabLeader = 'Dot';\n        }\n        var tocField = undefined;\n        var code = undefined;\n        if (this.selection.contextType === 'TableOfContents') {\n            tocField = this.selection.getTocFieldInternal();\n        }\n        if (tocField instanceof FieldElementBox) {\n            this.selection.start.setPositionForSelection(tocField.line, tocField, 0, this.selection.start.location);\n            this.selection.end.setPositionForSelection(tocField.fieldEnd.line, tocField.fieldEnd, 2, this.selection.end.location);\n            this.onDelete();\n        }\n        // Build TOC field code based on parameter\n        code = this.constructTocFieldCode(tableOfContentsSettings);\n        var isStartParagraph = this.selection.start.isAtParagraphStart;\n        var blockInfo = this.getParagraphInfo(this.selection.start);\n        var initialStart = this.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        // Build TOC fields\n        // tslint:disable-next-line:max-line-length\n        var widgets = this.buildToc(this.validateTocSettings(tableOfContentsSettings), code, true, isStartParagraph);\n        if (widgets.length > 0) {\n            var tocLastPara = new ParagraphWidget();\n            var tocLastLine = new LineWidget(tocLastPara);\n            tocLastPara.childWidgets.push(tocLastLine);\n            var index = 0;\n            if (!isStartParagraph) {\n                index = 1;\n            }\n            var line = widgets[index].childWidgets[0];\n            var fieldBegin = line.children[0];\n            this.appendEndField(fieldBegin, tocLastLine);\n            widgets.push(tocLastPara);\n            this.appendEmptyPara(widgets);\n        }\n        this.setPositionForCurrentIndex(this.selection.start, initialStart);\n        this.selection.end.setPositionInternal(this.selection.start);\n        this.pasteContentsInternal(widgets);\n        this.isInsertingTOC = false;\n        this.updatePageRef();\n        if (this.editorHistory) {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    Editor.prototype.appendEmptyPara = function (widgets) {\n        var emptyPara = new ParagraphWidget();\n        var emptyLine = new LineWidget(emptyPara);\n        emptyPara.childWidgets.push(emptyLine);\n        widgets.push(emptyPara);\n    };\n    Editor.prototype.constructTocFieldCode = function (tocSettings) {\n        var tocFieldCode = 'TOC';\n        //appends styles level\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(tocSettings.startLevel) && tocSettings.startLevel !== 0 && !isNullOrUndefined(tocSettings.endLevel) && tocSettings.endLevel !== 0) {\n            tocFieldCode = tocFieldCode + ' \\\\o \"' + tocSettings.startLevel + '-' + tocSettings.endLevel + '\"';\n        }\n        if (tocSettings.includePageNumber && !tocSettings.rightAlign) {\n            tocFieldCode = tocFieldCode + ' \\\\p \" \"';\n        }\n        if (!tocSettings.includePageNumber) {\n            tocFieldCode = tocFieldCode + ' \\\\n';\n        }\n        if (tocSettings.includeHyperlink) {\n            tocFieldCode = tocFieldCode + ' \\\\h \\\\z';\n        }\n        if (tocSettings.includeOutlineLevels) {\n            tocFieldCode = tocFieldCode + ' \\\\u';\n        }\n        var tSwitch = this.constructTSwitch(tocSettings);\n        if (tSwitch.length > 6) {\n            tocFieldCode = tocFieldCode + tSwitch;\n        }\n        return tocFieldCode;\n    };\n    Editor.prototype.constructTSwitch = function (tocSettings) {\n        var tSwitch = '';\n        var prefix = ' \\\\t ';\n        if (!isNullOrUndefined(tocSettings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(tocSettings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                tSwitch = tSwitch + key + ',' + tocSettings.levelSettings[key].toString() + ',';\n            }\n        }\n        tSwitch = tSwitch.slice(0, -1);\n        tSwitch = prefix + '\"' + tSwitch + '\"';\n        return tSwitch;\n    };\n    /**\n     * Appends the end filed to the given line.\n     */\n    Editor.prototype.appendEndField = function (fieldBegin, lineWidget) {\n        var fieldEnd = new FieldElementBox(1);\n        fieldEnd.fieldSeparator = fieldBegin.fieldSeparator;\n        fieldBegin.fieldSeparator.fieldEnd = fieldEnd;\n        fieldEnd.fieldBegin = fieldBegin;\n        fieldEnd.fieldBegin.fieldEnd = fieldEnd;\n        fieldEnd.line = lineWidget;\n        lineWidget.children.push(fieldEnd);\n    };\n    Editor.prototype.validateTocSettings = function (tocSettings) {\n        if (isNullOrUndefined(tocSettings.startLevel) || tocSettings.startLevel < 1) {\n            tocSettings.startLevel = 1;\n        }\n        if (isNullOrUndefined(tocSettings.endLevel) || tocSettings.endLevel < tocSettings.endLevel) {\n            tocSettings.endLevel = tocSettings.startLevel > 3 ? tocSettings.startLevel : 3;\n        }\n        if (isNullOrUndefined(tocSettings.includeHyperlink)) {\n            tocSettings.includeHyperlink = false;\n        }\n        if (isNullOrUndefined(tocSettings.includePageNumber)) {\n            tocSettings.includePageNumber = false;\n        }\n        if (isNullOrUndefined(tocSettings.rightAlign)) {\n            tocSettings.rightAlign = false;\n        }\n        if (isNullOrUndefined(tocSettings.levelSettings)) {\n            tocSettings.levelSettings = {};\n        }\n        return tocSettings;\n    };\n    /**\n     * Builds the TOC\n     * @private\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.buildToc = function (tocSettings, fieldCode, isFirstPara, isStartParagraph) {\n        var tocDomBody = this.viewer.pages[0].bodyWidgets[0];\n        var widgets = [];\n        this.createHeadingLevels(tocSettings);\n        if (tocSettings.includeOutlineLevels) {\n            this.createOutlineLevels(tocSettings);\n        }\n        var widget = tocDomBody.childWidgets[0];\n        while (widget !== undefined) {\n            // tslint:disable-next-line:max-line-length\n            if (widget instanceof ParagraphWidget && (this.isHeadingStyle(widget) || (tocSettings.includeOutlineLevels && this.isOutlineLevelStyle(widget)))) {\n                var bookmarkName = this.insertTocBookmark(widget);\n                // tslint:disable-next-line:max-line-length\n                this.createTOCWidgets(widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph);\n                isFirstPara = false;\n            }\n            widget = this.selection.getNextParagraphBlock(widget);\n        }\n        this.tocStyles = {};\n        return widgets;\n    };\n    Editor.prototype.createOutlineLevels = function (settings) {\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var levelStyle = 'Level' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[levelStyle])) {\n                this.tocStyles[levelStyle] = i;\n            }\n        }\n    };\n    /**\n     * Creates TOC heading styles\n     * @param start - lower heading level\n     * @param end - higher heading level\n     */\n    Editor.prototype.createHeadingLevels = function (settings) {\n        var normalStyle = 'Normal';\n        for (var i = settings.startLevel; i <= settings.endLevel; i++) {\n            var headingStyle = 'Heading ' + i.toString();\n            if (isNullOrUndefined(this.tocStyles[headingStyle])) {\n                this.tocStyles[headingStyle] = i;\n            }\n        }\n        if (!isNullOrUndefined(settings.levelSettings)) {\n            for (var _i = 0, _a = Object.keys(settings.levelSettings); _i < _a.length; _i++) {\n                var key = _a[_i];\n                this.tocStyles[key] = settings.levelSettings[key];\n            }\n        }\n    };\n    /**\n     * Checks the current style is heading style.\n     */\n    Editor.prototype.isHeadingStyle = function (para) {\n        var style = para.paragraphFormat.baseStyle;\n        if (style !== undefined) {\n            return isNullOrUndefined(this.tocStyles[style.name]) ? false : true;\n        }\n        return false;\n    };\n    Editor.prototype.isOutlineLevelStyle = function (para) {\n        var styleName = para.paragraphFormat.outlineLevel;\n        return isNullOrUndefined(this.tocStyles[styleName]) ? false : true;\n    };\n    /**\n     * Creates TOC field element.\n     */\n    Editor.prototype.createTocFieldElement = function (lineWidget, fieldCode) {\n        //begin\n        var fieldBegin = new FieldElementBox(0);\n        fieldBegin.hasFieldEnd = true;\n        fieldBegin.line = lineWidget;\n        lineWidget.children.push(fieldBegin);\n        //format toc\n        var textElement = new TextElementBox();\n        textElement.text = fieldCode;\n        textElement.line = lineWidget;\n        lineWidget.children.push(textElement);\n        //field separator\n        var fieldSeparator = new FieldElementBox(2);\n        fieldSeparator.fieldBegin = fieldBegin;\n        fieldSeparator.fieldBegin.fieldSeparator = fieldSeparator;\n        fieldSeparator.line = lineWidget;\n        lineWidget.children.push(fieldSeparator);\n        return fieldBegin;\n    };\n    /**\n     * Updates TOC para\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.createTOCWidgets = function (widget, widgets, fieldCode, bookmarkName, tocSettings, isFirstPara, isStartParagraph) {\n        var fieldBegin = undefined;\n        var tocPara = undefined;\n        var tocLine = undefined;\n        // tslint:disable-next-line:max-line-length\n        if (widgets.length === 1 && widgets[0].childWidgets[0].children.length === 3 && !isNullOrUndefined(isFirstPara) && !isFirstPara) {\n            tocLine = widgets[0].childWidgets[0];\n        }\n        else {\n            tocPara = new ParagraphWidget();\n            var styleName = undefined;\n            //Adds toc syles into paragraph\n            var headingStyleName = widget.paragraphFormat.baseStyle.name;\n            if (tocSettings.includeOutlineLevels && isNullOrUndefined(this.tocStyles[headingStyleName])) {\n                styleName = widget.paragraphFormat.outlineLevel;\n            }\n            else {\n                styleName = headingStyleName;\n            }\n            var tocStyleName = 'Toc' + this.tocStyles[styleName];\n            var paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            if (isNullOrUndefined(paraStyle)) {\n                // tslint:disable-next-line:max-line-length\n                this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()), JSON.parse(this.viewer.preDefinedStyles.get(tocStyleName)), this.viewer.styles);\n                paraStyle = this.viewer.styles.findByName(tocStyleName, 'Paragraph');\n            }\n            tocPara.paragraphFormat.ApplyStyle(paraStyle);\n            //Creates right tab for page number.\n            if (tocSettings.rightAlign && tocSettings.includePageNumber) {\n                var tabStop = new WTabStop();\n                tabStop.position = HelperMethods.convertPixelToPoint(this.viewer.clientArea.width);\n                tabStop.tabLeader = tocSettings.tabLeader;\n                tabStop.deletePosition = 0;\n                tabStop.tabJustification = 'Right';\n                tocPara.paragraphFormat.tabs.push(tabStop);\n            }\n            tocLine = new LineWidget(tocPara);\n            tocPara.childWidgets.push(tocLine);\n        }\n        //creates toc field element if it is insert\n        if ((isFirstPara !== undefined) && isFirstPara) {\n            if (!isNullOrUndefined(isStartParagraph) && !isStartParagraph) {\n                this.appendEmptyPara(widgets);\n            }\n            this.createTocFieldElement(tocLine, fieldCode);\n        }\n        var text = '';\n        for (var lineIndex = 0; lineIndex < widget.childWidgets.length; lineIndex++) {\n            var lineWidget = widget.childWidgets[lineIndex];\n            for (var elementIndex = 0; elementIndex < lineWidget.children.length; elementIndex++) {\n                var element = lineWidget.children[elementIndex];\n                if (element instanceof TextElementBox || element instanceof ListTextElementBox) {\n                    var temp = element.text;\n                    var tabChar = '\\t';\n                    if (temp.indexOf(tabChar) !== -1) {\n                        temp = temp.replace(new RegExp(tabChar, 'g'), ' ');\n                    }\n                    text = text + temp;\n                }\n            }\n        }\n        if (text !== '') {\n            // inserts hyperlink\n            if (tocSettings.includeHyperlink && (bookmarkName !== undefined)) {\n                fieldBegin = this.insertTocHyperlink(tocLine, bookmarkName, text);\n            }\n            else {\n                var span = new TextElementBox();\n                span.text = text;\n                span.line = tocLine;\n                tocLine.children.push(span);\n            }\n            //inserts page number\n            if (tocSettings.includePageNumber && (bookmarkName !== undefined)) {\n                if (tocSettings.rightAlign) {\n                    var tabText = new TabElementBox();\n                    tabText.text = '\\t';\n                    tabText.line = tocLine;\n                    tocLine.children.push(tabText);\n                }\n                var pageField = this.insertTocPageNumber(bookmarkName, tocLine, tocSettings.rightAlign, widget);\n                this.appendEndField(pageField, tocLine);\n            }\n            if (tocSettings.includeHyperlink && fieldBegin !== undefined) {\n                this.appendEndField(fieldBegin, tocLine);\n            }\n        }\n        if (!isNullOrUndefined(tocPara) && (text !== '' || isFirstPara)) {\n            widgets.push(tocPara);\n        }\n    };\n    /**\n     * Inserts toc hyperlink.\n     */\n    Editor.prototype.insertTocHyperlink = function (lineWidget, bookmarkName, text) {\n        var fieldCode = ' HYPERLINK \\\\l \\\"' + bookmarkName + '\\\" ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        //text element.\n        var span = new TextElementBox();\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        return fieldBegin;\n    };\n    /**\n     * Inserts toc page number.\n     */\n    // tslint:disable-next-line:max-line-length\n    Editor.prototype.insertTocPageNumber = function (bookMarkname, lineWidget, isRightAlign, widget) {\n        var fieldCode = ' PAGEREF' + bookMarkname + ' \\\\h ';\n        var fieldBegin = this.createTocFieldElement(lineWidget, fieldCode);\n        var text = (this.viewer.pages.indexOf(widget.bodyWidget.page) + 1).toString();\n        //text element.\n        var span = new FieldTextElementBox();\n        span.fieldBegin = fieldBegin;\n        if (!isRightAlign) {\n            text = ' ' + text;\n        }\n        span.text = text;\n        span.line = lineWidget;\n        lineWidget.children.push(span);\n        this.pageRefFields[bookMarkname] = span;\n        return fieldBegin;\n    };\n    Editor.prototype.updatePageRef = function () {\n        for (var _i = 0, _a = Object.keys(this.pageRefFields); _i < _a.length; _i++) {\n            var key = _a[_i];\n            var bookmark = this.viewer.bookmarks.get(key);\n            var pageRef = (bookmark.paragraph.bodyWidget.page.index + 1).toString();\n            var span = this.pageRefFields[key];\n            if (pageRef !== span.text) {\n                span.text = pageRef;\n                var paragraph = span.paragraph;\n                var lineIndex = paragraph.childWidgets.indexOf(span.line);\n                var elementIndex = span.line.children.indexOf(span);\n                this.viewer.layout.reLayoutParagraph(paragraph, lineIndex, elementIndex);\n            }\n        }\n    };\n    /**\n     * Inserts toc bookmark.\n     */\n    Editor.prototype.insertTocBookmark = function (widget) {\n        var bookmarkName = undefined;\n        var lineLength = widget.childWidgets.length;\n        if (lineLength > 0) {\n            var startLine = widget.childWidgets[0];\n            var endLine = widget.childWidgets[lineLength - 1];\n            if ((startLine !== undefined) && (endLine !== undefined)) {\n                var startElement = startLine.children[0];\n                //Returns the bookmark if already present for paragraph.\n                // tslint:disable-next-line:max-line-length\n                if (!isNullOrUndefined(startElement) && startElement instanceof BookmarkElementBox && startElement.bookmarkType === 0 && (startElement.name.toLowerCase().match('^_toc'))) {\n                    return startElement.name;\n                }\n                var endElement = endLine.children[endLine.children.length - 1];\n                if ((startElement !== undefined) && (endElement !== undefined)) {\n                    this.selection.start.setPositionForSelection(startLine, startElement, 0, this.selection.start.location);\n                    this.selection.end.setPositionForSelection(endLine, endElement, endElement.length, this.selection.end.location);\n                    bookmarkName = this.generateBookmarkName();\n                    this.insertBookmark(bookmarkName);\n                }\n            }\n        }\n        return bookmarkName;\n    };\n    /**\n     * Generates bookmark id.\n     */\n    Editor.prototype.generateBookmarkName = function () {\n        this.tocBookmarkId++;\n        var count = 10 - this.tocBookmarkId.toString().length;\n        var formatString = '';\n        while (count - 1 > 0) {\n            formatString = '0' + formatString;\n            count--;\n        }\n        var bookmarkName = '_Toc' + formatString + this.tocBookmarkId;\n        return bookmarkName;\n    };\n    /**\n     * Change cell content alignment\n     * @private\n     */\n    Editor.prototype.onCellContentAlignment = function (verticalAlignment, textAlignment) {\n        this.owner.isShiftingEnabled = true;\n        var selection = this.owner.selection;\n        if (selection.isEmpty && selection.start.paragraph.isInsideTable) {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            //Selecting the table cell to update the all the paragraph format.\n            selection.selectTableCell();\n            this.initHistory('CellContentVerticalAlignment');\n            var cellFormat = selection.start.paragraph.associatedCell.cellFormat;\n            this.applyCellPropertyValue(selection, 'verticalAlignment', verticalAlignment, cellFormat);\n            this.reLayout(selection, false);\n            this.initHistory('TextAlignment');\n            this.updateParagraphFormat('textAlignment', textAlignment, false);\n            this.reLayout(this.owner.selection, false);\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n        else {\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.initComplexHistory(selection, 'MultiSelection');\n            }\n            if (!isNullOrUndefined(selection.getTable(selection.start, selection.end))) {\n                //Table cell vertical alignment.\n                this.updateSelectionTableFormat(selection, 'CellContentVerticalAlignment', verticalAlignment);\n                this.reLayout(this.owner.selection, false);\n                this.initHistory('TextAlignment');\n                //Paragraph text alignment.\n                this.updateSelectionParagraphFormatting('textAlignment', textAlignment, false);\n                this.reLayout(selection, false);\n            }\n            if (this.owner.editorHistory) {\n                this.owner.editorHistory.updateComplexHistory();\n            }\n        }\n    };\n    return Editor;\n}());\nexport { Editor };\n","import { WTableHolder } from '../viewer/page';\n/**\n * @private\n */\nvar ModifiedLevel = /** @class */ (function () {\n    function ModifiedLevel(owner, modified) {\n        this.ownerListLevelIn = undefined;\n        this.modifiedListLevelIn = undefined;\n        this.ownerListLevel = owner;\n        this.modifiedListLevel = modified;\n    }\n    Object.defineProperty(ModifiedLevel.prototype, \"ownerListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedLevel.prototype, \"modifiedListLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.modifiedListLevelIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedListLevelIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedLevel.prototype.destroy = function () {\n        this.ownerListLevel = undefined;\n        this.modifiedListLevel = undefined;\n    };\n    return ModifiedLevel;\n}());\nexport { ModifiedLevel };\n/**\n * @private\n */\nvar ModifiedParagraphFormat = /** @class */ (function () {\n    function ModifiedParagraphFormat(ownerFormat, modifiedFormat) {\n        this.ownerFormatIn = undefined;\n        this.modifiedFormatIn = undefined;\n        this.ownerFormat = ownerFormat;\n        this.modifiedFormat = modifiedFormat;\n    }\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"ownerFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.ownerFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.ownerFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ModifiedParagraphFormat.prototype, \"modifiedFormat\", {\n        /**\n         * hidden\n         */\n        get: function () {\n            return this.modifiedFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.modifiedFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ModifiedParagraphFormat.prototype.destroy = function () {\n        this.ownerFormat = undefined;\n        this.modifiedFormat.destroy();\n        this.modifiedFormat = undefined;\n    };\n    return ModifiedParagraphFormat;\n}());\nexport { ModifiedParagraphFormat };\n/**\n * @private\n */\nvar RowHistoryFormat = /** @class */ (function () {\n    function RowHistoryFormat(startingPoint, rowFormat) {\n        this.startingPoint = startingPoint;\n        this.rowFormat = rowFormat;\n        this.rowHeightType = rowFormat.heightType;\n    }\n    RowHistoryFormat.prototype.revertChanges = function (isRedo, owner) {\n        //backup current format values.\n        var currentRowHeightType = this.rowFormat.heightType;\n        //Restore old values.\n        owner.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase, isRedo ? this.displacement : (-this.displacement));\n        owner.viewer.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable);\n        if (this.rowFormat.heightType !== this.rowHeightType) {\n            this.rowFormat.heightType = this.rowHeightType;\n        }\n        //backup the current format values for redo.\n        this.rowHeightType = currentRowHeightType;\n    };\n    return RowHistoryFormat;\n}());\nexport { RowHistoryFormat };\n/**\n * @private\n */\nvar TableHistoryInfo = /** @class */ (function () {\n    function TableHistoryInfo(table, owner) {\n        this.tableHolder = new WTableHolder();\n        this.tableFormat = new TableFormatHistoryInfo();\n        this.rows = [];\n        this.owner = owner;\n        this.copyProperties(table);\n    }\n    TableHistoryInfo.prototype.copyProperties = function (table) {\n        if (table.tableHolder) {\n            this.tableHolder = table.tableHolder.clone();\n        }\n        if (table.tableFormat) {\n            this.tableFormat.leftIndent = table.tableFormat.leftIndent;\n            this.tableFormat.preferredWidth = table.tableFormat.preferredWidth;\n            this.tableFormat.preferredWidthType = table.tableFormat.preferredWidthType;\n        }\n        for (var i = 0; i < table.childWidgets.length; i++) {\n            var row = table.childWidgets[i];\n            var rowFormat = new RowFormatHistoryInfo();\n            rowFormat.gridBefore = row.rowFormat.gridBefore;\n            rowFormat.gridBeforeWidth = row.rowFormat.gridBeforeWidth;\n            rowFormat.gridBeforeWidthType = row.rowFormat.gridBeforeWidthType;\n            rowFormat.gridAfter = row.rowFormat.gridAfter;\n            rowFormat.gridAfterWidth = row.rowFormat.gridAfterWidth;\n            rowFormat.gridAfterWidthType = row.rowFormat.gridAfterWidthType;\n            for (var j = 0; j < row.childWidgets.length; j++) {\n                var cell = row.childWidgets[j];\n                var cellFormat = new CellFormatHistoryInfo();\n                cellFormat.columnIndex = cell.columnIndex;\n                cellFormat.columnSpan = cell.cellFormat.columnSpan;\n                cellFormat.preferredWidth = cell.cellFormat.preferredWidth;\n                cellFormat.preferredWidthType = cell.cellFormat.preferredWidthType;\n                rowFormat.cells.push(cellFormat);\n            }\n            this.rows.push(rowFormat);\n        }\n        this.tableHierarchicalIndex = this.owner.editorModule.getHierarchicalIndex(table, '0');\n    };\n    TableHistoryInfo.prototype.destroy = function () {\n        this.tableHierarchicalIndex = undefined;\n        if (this.tableHolder) {\n            this.tableHolder.destroy();\n            this.tableHolder = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat = null;\n        }\n        if (this.rows) {\n            this.rows = [];\n            this.rows = undefined;\n        }\n    };\n    return TableHistoryInfo;\n}());\nexport { TableHistoryInfo };\n/**\n * @private\n */\nvar TableFormatHistoryInfo = /** @class */ (function () {\n    function TableFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return TableFormatHistoryInfo;\n}());\nexport { TableFormatHistoryInfo };\n/**\n * @private\n */\nvar RowFormatHistoryInfo = /** @class */ (function () {\n    function RowFormatHistoryInfo() {\n        this.cells = [];\n    }\n    return RowFormatHistoryInfo;\n}());\nexport { RowFormatHistoryInfo };\n/**\n * @private\n */\nvar CellFormatHistoryInfo = /** @class */ (function () {\n    function CellFormatHistoryInfo() {\n        /* tslint:disable:no-empty */\n    }\n    return CellFormatHistoryInfo;\n}());\nexport { CellFormatHistoryInfo };\n/**\n * @private\n */\nvar CellHistoryFormat = /** @class */ (function () {\n    function CellHistoryFormat(point) {\n        this.startingPoint = point; // starting point preserved to calculate the displacement on after cell resizing finished.\n    }\n    return CellHistoryFormat;\n}());\nexport { CellHistoryFormat };\n","import { WParagraphFormat } from '../format/paragraph-format';\nimport { WSectionFormat } from '../format/section-format';\nimport { WCharacterFormat } from '../format/character-format';\nimport { WListFormat } from '../format/list-format';\nimport { ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { BlockWidget, ParagraphWidget, BodyWidget, TableCellWidget, TableWidget, TableRowWidget, HeaderFooterWidget } from '../viewer/page';\nimport { Dictionary } from '../../base/dictionary';\nimport { TextPosition, ImageFormat } from '../index';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ElementBox } from '../viewer/page';\nimport { WTableFormat, WRowFormat, WCellFormat, WParagraphStyle } from '../format/index';\n/**\n * @private\n */\nvar BaseHistoryInfo = /** @class */ (function () {\n    function BaseHistoryInfo(node) {\n        this.ownerIn = node;\n        this.viewer = node.viewer;\n        this.modifiedPropertiesIn = [];\n        this.modifiedNodeLength = [];\n        this.removedNodesIn = [];\n    }\n    Object.defineProperty(BaseHistoryInfo.prototype, \"owner\", {\n        //Properties\n        //gets owner control\n        /**\n         * gets the owner control\n         * @private\n         */\n        get: function () { return this.ownerIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"editorHistory\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () {\n            return this.owner.editorHistory;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"action\", {\n        /**\n         * gets or sets action\n         * @private\n         */\n        get: function () { return this.actionIn; },\n        set: function (value) { this.actionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"modifiedProperties\", {\n        /**\n         * gets modified properties\n         * @returns Object\n         * @private\n         */\n        get: function () { return this.modifiedPropertiesIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"removedNodes\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.removedNodesIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionStart\", {\n        /**\n         * Gets or Sets the selection start\n         * @private\n         */\n        //gets or sets selection start\n        get: function () { return this.selectionStartIn; },\n        set: function (value) { this.selectionStartIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"selectionEnd\", {\n        /**\n         * Gets or Sets the selection end\n         * @private\n         */\n        get: function () { return this.selectionEndIn; },\n        set: function (value) { this.selectionEndIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"insertPosition\", {\n        /**\n         * Gets or sets the insert position\n         * @private\n         */\n        get: function () { return this.insertPositionIn; },\n        set: function (value) { this.insertPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(BaseHistoryInfo.prototype, \"endPosition\", {\n        /**\n         * Gets or sets end position\n         * @private\n         */\n        get: function () { return this.endPositionIn; },\n        set: function (value) { this.endPositionIn = value; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Update the selection\n     * @param selection\n     * @private\n     */\n    BaseHistoryInfo.prototype.updateSelection = function () {\n        var blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.start);\n        this.selectionStart = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n        blockInfo = this.owner.editorModule.getParagraphInfo(this.owner.selection.end);\n        this.selectionEnd = this.owner.editorModule.getHierarchicalIndex(blockInfo.paragraph, blockInfo.offset.toString());\n    };\n    BaseHistoryInfo.prototype.setBookmarkInfo = function (bookmark) {\n        this.removedNodes.push({ 'bookmark': bookmark, 'startIndex': bookmark.indexInOwner, 'endIndex': bookmark.reference.indexInOwner });\n    };\n    BaseHistoryInfo.prototype.revertBookmark = function () {\n        var bookmarkInfo = this.removedNodes[0];\n        var bookmark = bookmarkInfo.bookmark;\n        if (this.editorHistory.isUndoing) {\n            this.viewer.bookmarks.add(bookmark.name, bookmark);\n            bookmark.line.children.splice(bookmarkInfo.startIndex, 0, bookmark);\n            bookmark.reference.line.children.splice(bookmarkInfo.endIndex, 0, bookmark.reference);\n            this.editorHistory.recordChanges(this);\n        }\n        else {\n            this.owner.editorModule.deleteBookmarkInternal(bookmark);\n            this.editorHistory.undoStack.push(this);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    // tslint:disable: max-func-body-length\n    BaseHistoryInfo.prototype.revert = function () {\n        if (this.action === 'DeleteBookmark') {\n            this.revertBookmark();\n            return;\n        }\n        this.owner.isShiftingEnabled = true;\n        var selectionStartTextPosition = undefined;\n        var selectionEndTextPosition = undefined;\n        var start = this.selectionStart;\n        var end = this.selectionEnd;\n        var isForwardSelection = TextPosition.isForwardSelection(start, end);\n        if (this.modifiedProperties.length > 0 || this.action === 'Selection' || this.action === 'ClearCharacterFormat'\n            || this.action === 'ClearParagraphFormat') {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.revertModifiedProperties(selectionStartTextPosition, selectionEndTextPosition);\n        }\n        else {\n            var deletedNodes = this.removedNodes;\n            this.removedNodesIn = [];\n            var isForward = TextPosition.isForwardSelection(this.insertPosition, this.endPosition);\n            var insertTextPosition = this.getTextPosition(isForward ? this.insertPosition : this.endPosition);\n            var endTextPosition = this.getTextPosition(isForward ? this.endPosition : this.insertPosition);\n            if (insertTextPosition.isAtSamePosition(endTextPosition)) {\n                this.owner.selection.selectContent(insertTextPosition, true);\n            }\n            else {\n                this.owner.selection.selectPosition(insertTextPosition, endTextPosition);\n            }\n            if (this.action === 'InsertHyperlink' && this.editorHistory.isRedoing) {\n                var fieldBegin = this.owner.selection.getHyperlinkField();\n                if (!isNullOrUndefined(fieldBegin)) {\n                    var offset = (fieldBegin.line).getOffset(fieldBegin, 0);\n                    insertTextPosition.setPositionParagraph(fieldBegin.line, offset);\n                    this.owner.selection.start.setPositionInternal(insertTextPosition);\n                    offset = fieldBegin.fieldEnd.line.getOffset(fieldBegin.fieldEnd, 1);\n                    endTextPosition.setPositionParagraph(fieldBegin.fieldEnd.line, offset);\n                }\n            }\n            this.editorHistory.currentBaseHistoryInfo = this;\n            this.selectionStart = this.insertPosition;\n            this.insertPosition = undefined;\n            this.selectionEnd = this.endPosition;\n            this.endPosition = undefined;\n            var isRemoveContent = false;\n            if (!insertTextPosition.isAtSamePosition(endTextPosition)) {\n                isRemoveContent = this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'ClearCells'\n                    || this.action === 'DeleteCells';\n                if (!(isRemoveContent) && this.action !== 'MergeCells' && this.action !== 'InsertRowAbove'\n                    && this.action !== 'InsertRowBelow' && this.action !== 'InsertColumnLeft'\n                    && this.action !== 'InsertColumnRight' && this.action !== 'Borders'\n                    && this.action !== 'DeleteTable' && this.action !== 'DeleteColumn' && this.action !== 'DeleteRow') {\n                    this.owner.selection.end.setPositionInternal(endTextPosition);\n                    if (!this.owner.selection.isEmpty) {\n                        if (this.editorHistory.isRedoing) {\n                            this.owner.editorModule.removeSelectedContents(this.owner.selection);\n                        }\n                        else {\n                            this.owner.editorModule.deleteSelectedContents(this.owner.selection, true);\n                        }\n                        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak' && this.viewer.blockToShift) {\n                            this.viewer.layout.shiftLayoutedItems();\n                        }\n                    }\n                }\n            }\n            var isRedoAction = this.editorHistory.isRedoing && !isRemoveContent;\n            this.revertModifiedNodes(deletedNodes, isRedoAction, isForwardSelection ? start : end, start === end);\n            if (isRemoveContent) {\n                this.removeContent(insertTextPosition, endTextPosition);\n            }\n            //this.owner.editorModule.reLayout(this.viewer.selection);\n        }\n        var isSelectionChanged = false;\n        if ((this.editorHistory.isUndoing && isNullOrUndefined(this.editorHistory.currentHistoryInfo)) ||\n            ((this.action === 'InsertRowAbove' || this.action === 'Borders' || this.action === 'InsertRowBelow'\n                || this.action === 'InsertColumnLeft'\n                || this.action === 'InsertColumnRight') && (this.editorHistory.isRedoing\n                || this.editorHistory.currentHistoryInfo.action === 'Paste'))) {\n            selectionStartTextPosition = this.getTextPosition(start);\n            selectionEndTextPosition = this.getTextPosition(end);\n            this.owner.selection.selectRange(selectionStartTextPosition, selectionEndTextPosition);\n            isSelectionChanged = true;\n        }\n        // Updates insert position of history info instance.\n        this.insertPosition = start;\n        this.endPosition = end;\n        this.owner.editorModule.reLayout(this.owner.selection, this.owner.selection.isEmpty);\n        if (isSelectionChanged) {\n            this.viewer.scrollToPosition(this.owner.selection.start, this.owner.selection.end);\n        }\n        this.highlightListText();\n    };\n    BaseHistoryInfo.prototype.highlightListText = function () {\n        if (!isNullOrUndefined(this.editorHistory.currentHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            if (this.action === 'ListCharacterFormat' || (this.editorHistory.currentHistoryInfo.action === 'ListSelect' && this.action === 'ListFormat')) {\n                var selectionStartTextPosition = this.getTextPosition(this.selectionStart);\n                var widget = selectionStartTextPosition.currentWidget;\n                this.viewer.selection.highlightListText(widget);\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.removeContent = function (insertTextPosition, endTextPosition) {\n        //If the base parent of the insert text position and end text position is null \n        //then the paragraphs already removed.\n        //Example scenario: In table editing that is delete cells operation \n        // we will backed up the entire table ad it will be replaced on undo operation.\n        //At that time if the positions are in table \n        //which is already replaced in undo (revert modified nodes method) then the base parent of the paragraph will be null.\n        //So again, selecting the content and deleting is unnecessary\n        // and it will cause improper position updates and null reference exceptions. \n        if ((!isNullOrUndefined(insertTextPosition.paragraph.containerWidget) &&\n            insertTextPosition.paragraph.containerWidget instanceof BodyWidget &&\n            (!isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && endTextPosition.paragraph.containerWidget instanceof BodyWidget))\n            || (!isNullOrUndefined(insertTextPosition.paragraph.containerWidget)\n                && !isNullOrUndefined(endTextPosition.paragraph.containerWidget)\n                && insertTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && endTextPosition.paragraph.containerWidget instanceof TableCellWidget\n                && !isNullOrUndefined(insertTextPosition.paragraph.bodyWidget))) {\n            //Removes if any empty paragraph is added while delete.\n            this.owner.selection.selectRange(insertTextPosition, endTextPosition);\n            var isDelete = (this.action === 'BackSpace') ? true : false;\n            this.owner.editorModule.deleteSelectedContents(this.owner.selection, isDelete);\n        }\n    };\n    BaseHistoryInfo.prototype.revertModifiedProperties = function (start, end) {\n        if (this.action === 'CellFormat' || this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.owner.isShiftingEnabled = false;\n        }\n        this.owner.selection.selectRange(start, end);\n        if (this.action === 'RowResizing' || this.action === 'CellResizing') {\n            this.revertResizing();\n        }\n        else if (this.action === 'CellOptions' || this.action === 'TableOptions') {\n            this.revertTableDialogProperties(this.action);\n        }\n        else if (this.action !== 'Selection') {\n            this.revertProperties();\n        }\n    };\n    // Redoes the Action\n    BaseHistoryInfo.prototype.redoAction = function () {\n        var editor = this.owner.editorModule;\n        switch (this.action) {\n            case 'BackSpace':\n                editor.singleBackspace(this.owner.selection, true);\n                break;\n            case 'Delete':\n                editor.singleDelete(this.owner.selection, true);\n                break;\n            case 'DeleteTable':\n                editor.deleteTable();\n                break;\n            case 'DeleteColumn':\n                editor.deleteColumn();\n                break;\n            case 'DeleteRow':\n                editor.deleteRow();\n                break;\n            case 'MergeCells':\n                editor.mergeSelectedCellsInTable();\n                break;\n            case 'InsertRowAbove':\n                editor.insertRow(true);\n                break;\n            case 'InsertRowBelow':\n                editor.insertRow(false);\n                break;\n            case 'InsertColumnLeft':\n                editor.insertColumn(true);\n                break;\n            case 'InsertColumnRight':\n                editor.insertColumn(true);\n                break;\n            case 'SectionBreak':\n                editor.insertSection(this.owner.selection, true);\n                break;\n        }\n    };\n    /**\n     * Revert the modified nodes\n     * @param  {WNode[]} deletedNodes\n     * @param  {boolean} isRedoAction\n     * @param  {string} start\n     * @param  {boolean} isEmptySelection\n     */\n    BaseHistoryInfo.prototype.revertModifiedNodes = function (deletedNodes, isRedoAction, start, isEmptySelection) {\n        if (isRedoAction && (this.action === 'BackSpace' || this.action === 'Delete' || this.action === 'DeleteTable'\n            || this.action === 'DeleteColumn' || this.action === 'DeleteRow' || this.action === 'InsertRowAbove' ||\n            this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft' || this.action === 'InsertColumnRight'\n            || this.action === 'MergeCells' || this.action === 'SectionBreak')) {\n            this.redoAction();\n            if (this.action === 'SectionBreak') {\n                return;\n            }\n        }\n        if (deletedNodes.length > 0) {\n            if ((this.editorHistory.isUndoing && (this.action === 'DeleteCells' || this.action === 'DeleteColumn'\n                || this.action === 'DeleteRow' || this.action === 'MergeCells'))\n                || (this.action === 'InsertRowAbove' || this.action === 'InsertRowBelow' || this.action === 'InsertColumnLeft'\n                    || this.action === 'ClearCells' || this.action === 'InsertColumnRight' || this.action === 'Borders')) {\n                var insertIndex = this.selectionStart;\n                var block = this.owner.editorModule.getBlock({ index: insertIndex }).node;\n                var lastNode = deletedNodes[deletedNodes.length - 1];\n                if ((block instanceof TableWidget || block.previousRenderedWidget instanceof TableWidget || block.isInsideTable)\n                    && lastNode instanceof TableWidget) {\n                    if (block instanceof ParagraphWidget && !block.isInsideTable) {\n                        block = block.previousRenderedWidget;\n                    }\n                    block = block.combineWidget(this.viewer);\n                    this.owner.editorModule.insertTableInternal(block, lastNode, false);\n                    deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                }\n                else if (lastNode instanceof TableWidget) {\n                    this.owner.editorModule.insertBlock(lastNode);\n                }\n            }\n            else {\n                var initialStart = start;\n                var block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                // initialStart = blockObj.position;\n                if (deletedNodes.length > 0 && (this.action === 'BackSpace' && isEmptySelection\n                    || (!(block instanceof TableWidget) && !(block instanceof HeaderFooterWidget)))) {\n                    var lastNode = deletedNodes[0];\n                    if (this.action === 'SectionBreak' && lastNode instanceof BodyWidget ||\n                        !isNullOrUndefined(this.editorHistory.currentHistoryInfo) &&\n                            this.editorHistory.currentHistoryInfo.action === 'PageBreak') {\n                        lastNode = deletedNodes[1];\n                    }\n                    if (lastNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0) {\n                        this.owner.editorModule.insertNewParagraphWidget(lastNode, true);\n                        deletedNodes.splice(deletedNodes.indexOf(lastNode), 1);\n                        if (isNullOrUndefined(block)) {\n                            // tslint:disable-next-line:max-line-length\n                            var nextBlock = this.viewer.selection.getNextParagraphBlock(lastNode.getSplitWidgets().pop());\n                            this.owner.selection.getNextRenderedBlock(lastNode);\n                            if (isNullOrUndefined(nextBlock)) {\n                                //Sets the selection as starting of last paragraph.\n                                this.owner.selection.selectParagraph(lastNode, true);\n                            }\n                        }\n                    }\n                    if (lastNode instanceof TableWidget && this.owner.selection.start.offset > 0) {\n                        var firstBlock = deletedNodes[deletedNodes.length - 1];\n                        if (firstBlock instanceof ParagraphWidget) {\n                            this.owner.editorModule.insertNewParagraphWidget(firstBlock, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstBlock), 1);\n                            if (isNullOrUndefined(block)) {\n                                // tslint:disable-next-line:max-line-length\n                                var nextBlock = this.viewer.selection.getNextParagraphBlock(firstBlock.getSplitWidgets().pop());\n                                if (isNullOrUndefined(nextBlock)) {\n                                    //Sets the selection as starting of last paragraph.\n                                    this.owner.selection.selectParagraph(firstBlock, true);\n                                }\n                            }\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    var firstNode = deletedNodes[deletedNodes.length - 1];\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                        if (firstNode instanceof TableWidget) {\n                            this.owner.editorModule.insertTableInternal(block, firstNode, true);\n                            deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                            this.insertPosition = start;\n                            var nextWidget = firstNode.getSplitWidgets().pop();\n                            if (nextWidget.nextRenderedWidget instanceof TableWidget) {\n                                block = nextWidget.nextRenderedWidget;\n                            }\n                            else {\n                                initialStart = start;\n                                block = this.owner.editorModule.getBlock({ index: initialStart }).node;\n                            }\n                        }\n                    }\n                    //Checks if first node is paragraph and current insert position is paragraph end.\n                    // tslint:disable-next-line:max-line-length\n                    if (firstNode instanceof ParagraphWidget && this.owner.selection.start.offset > 0\n                        && this.owner.selection.start.offset === this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)) {\n                        var editor = this.owner.editorModule;\n                        editor.insertNewParagraphWidget(firstNode, false);\n                        deletedNodes.splice(deletedNodes.indexOf(firstNode), 1);\n                        //Removes the intermediate empty paragraph instance.\n                        if (this.action !== 'Paste') {\n                            editor.removeBlock(this.owner.selection.start.paragraph);\n                        }\n                        // tslint:disable-next-line:max-line-length\n                        var paragraph = this.viewer.selection.getNextParagraphBlock(firstNode.getSplitWidgets().pop());\n                        if (!isNullOrUndefined(paragraph)) {\n                            this.owner.selection.selectParagraph(paragraph, true);\n                        }\n                    }\n                    else if (deletedNodes[0] instanceof TableWidget && deletedNodes.length !== 1) {\n                        var nextNode = deletedNodes[1];\n                        if (nextNode instanceof ParagraphWidget && nextNode.isEmpty()) {\n                            deletedNodes.splice(deletedNodes.indexOf(nextNode), 1);\n                        }\n                    }\n                }\n                if (deletedNodes.length > 0) {\n                    if (block instanceof TableWidget) {\n                        block = block.combineWidget(this.viewer);\n                    }\n                    this.insertRemovedNodes(deletedNodes, block);\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.insertRemovedNodes = function (deletedNodes, block) {\n        for (var i = deletedNodes.length - 1, index = 0; i > -1; i--) {\n            var node = deletedNodes[i];\n            if (node instanceof ElementBox) {\n                this.owner.editorModule.insertInlineInSelection(this.owner.selection, node);\n            }\n            else if (node instanceof BlockWidget) {\n                if (node instanceof TableRowWidget) {\n                    if (block instanceof TableWidget) {\n                        block.childWidgets.splice(index, 0, node);\n                        this.owner.editorModule.updateNextBlocksIndex(node, true);\n                        if (i === 0 || !(deletedNodes[i - 1] instanceof TableRowWidget)) {\n                            // tslint:disable-next-line:max-line-length\n                            this.viewer.layout.layoutBodyWidgetCollection(block.index, block.containerWidget, block, false);\n                        }\n                    }\n                }\n                else if (block instanceof TableWidget) {\n                    this.owner.editorModule.insertBlockTable(this.owner.selection, node, block);\n                }\n                else {\n                    this.owner.editorModule.insertBlock(node);\n                }\n            }\n            else if (node instanceof BodyWidget) {\n                this.owner.editorModule.insertSection(this.owner.selection, false);\n            }\n        }\n        deletedNodes = [];\n    };\n    BaseHistoryInfo.prototype.revertResizing = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        if (this.action === 'RowResizing') {\n            if (this.modifiedProperties[0] instanceof RowHistoryFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing, this.owner);\n            }\n        }\n        else {\n            if (this.modifiedProperties[0] instanceof TableHistoryInfo) {\n                //selected cell resizing the condition checks done based on the selected widgets only. so need to highlight the selection.\n                if (this.owner.selection.selectedWidgets.length === 0) {\n                    this.owner.selection.highlightSelection(true);\n                }\n                var prevTableHistoryInfo = this.modifiedProperties[0];\n                var position = prevTableHistoryInfo.tableHierarchicalIndex;\n                var block = this.owner.editorModule.getBlock({ index: position }).node;\n                if (block instanceof TableWidget) {\n                    var tableResize = this.owner.editorModule.tableResize;\n                    this.owner.editor.setOffsetValue(this.owner.selection);\n                    block = block.combineWidget(this.owner.viewer);\n                    tableResize.currentResizingTable = block;\n                    this.modifiedProperties.splice(0, 1);\n                    if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n                        var tableHistoryInfoCurrent = new TableHistoryInfo(block, this.owner);\n                        this.modifiedProperties.splice(0, 0, tableHistoryInfoCurrent);\n                        this.owner.isLayoutEnabled = false;\n                        tableResize.applyProperties(tableResize.currentResizingTable, prevTableHistoryInfo);\n                        tableResize.currentResizingTable.isGridUpdated = true;\n                        this.owner.isLayoutEnabled = true;\n                        tableResize.updateGridValue(tableResize.currentResizingTable, false);\n                        prevTableHistoryInfo.destroy();\n                        prevTableHistoryInfo = undefined;\n                    }\n                }\n            }\n        }\n    };\n    BaseHistoryInfo.prototype.revertTableDialogProperties = function (action) {\n        this.owner.isShiftingEnabled = false;\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        if (action === 'CellOptions') {\n            var selection = this.owner.selection;\n            var cellFormat = this.modifiedProperties[0];\n            this.owner.editorModule.updateCellMargins(selection, cellFormat);\n        }\n        else if (action === 'TableOptions') {\n            this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);\n        }\n        this.currentPropertyIndex = 0;\n        this.owner.isShiftingEnabled = true;\n    };\n    BaseHistoryInfo.prototype.getTextPosition = function (hierarchicalIndex) {\n        var textPosition = new TextPosition(this.owner);\n        var blockInfo = this.owner.editorModule.getParagraph({ index: hierarchicalIndex });\n        var lineInfo = this.owner.editorModule.getLineInfo(blockInfo.paragraph, blockInfo.offset);\n        textPosition.setPositionForLineWidget(lineInfo.line, lineInfo.offset);\n        return textPosition;\n    };\n    /**\n     * Add modified properties for section format\n     * @param  {WSectionFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForSection = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            var modifiedProperties = this.modifiedProperties;\n            var previousFormat = (this.currentPropertyIndex < modifiedProperties.length ?\n                modifiedProperties[this.currentPropertyIndex] : modifiedProperties[modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n                previousFormat.copyFormat(format);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WSectionFormat();\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for character format\n     * @param  {WCharacterFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            var skipRemove = false;\n            if (format.ownerBase instanceof ElementBox) {\n                var prevLength = this.modifiedNodeLength[this.currentPropertyIndex];\n                if (format.ownerBase.length < prevLength) {\n                    skipRemove = true;\n                    this.modifiedNodeLength[this.currentPropertyIndex] = format.ownerBase.length;\n                    this.modifiedNodeLength.splice(this.currentPropertyIndex + 1, 0, prevLength - format.ownerBase.length);\n                    //Adds a copy of character format at next position for splitted inline.\n                    var nextFormat = new WCharacterFormat(undefined);\n                    nextFormat.copyFormat(previousFormat);\n                    this.modifiedProperties.splice(this.currentPropertyIndex + 1, 0, nextFormat);\n                }\n            }\n            if (this.action === 'ClearCharacterFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    if (!skipRemove) {\n                        this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                        this.currentPropertyIndex--;\n                    }\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n            }\n            else {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WCharacterFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n            if (format.ownerBase instanceof ElementBox) {\n                this.modifiedNodeLength.push(format.ownerBase.length);\n            }\n            else {\n                this.modifiedNodeLength.push(0);\n            }\n        }\n        return value;\n    };\n    /**\n     * Add the modified properties for paragraph format\n     * @param  {WParagraphFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForParagraphFormat = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.action === 'ClearParagraphFormat') {\n                if (this.editorHistory.isUndoing) {\n                    value = previousFormat;\n                    this.modifiedProperties.splice(this.currentPropertyIndex, 1);\n                    this.currentPropertyIndex--;\n                }\n                else {\n                    this.modifiedProperties.push(format.cloneFormat());\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'listFormat') {\n                value = new WParagraphFormat(undefined);\n                value.copyFormat(previousFormat);\n                previousFormat.listFormat = new WListFormat();\n                previousFormat.listFormat.copyFormat(format.listFormat);\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'styleName') {\n                if (!isNullOrUndefined(previousFormat.baseStyle)) {\n                    value = new WParagraphStyle();\n                    value.copyStyle(previousFormat.baseStyle);\n                    this.currentPropertyIndex++;\n                    return value;\n                }\n                else {\n                    return undefined;\n                }\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            if (isNullOrUndefined(property)) {\n                this.modifiedProperties.push(format.cloneFormat());\n            }\n            else {\n                var currentFormat = new WParagraphFormat(undefined);\n                currentFormat.copyFormat(format);\n                this.modifiedProperties.push(currentFormat);\n            }\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForContinueNumbering = function (paragraphFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = paragraphFormat.cloneFormat();\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = paragraphFormat.cloneFormat();\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            var currentFormat = new WParagraphFormat();\n            currentFormat.copyFormat(paragraphFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @param listFormat\n     * @param value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForRestartNumbering = function (listFormat, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var listId = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = listId;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = listFormat.listId;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = listFormat.listId;\n            }\n            this.currentPropertyIndex++;\n            return value;\n        }\n        else {\n            this.modifiedProperties.push(listFormat.listId);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for list format\n     * @param  {WListLevel} listLevel\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedPropertiesForList = function (listLevel) {\n        var value;\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousLevel = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            value = previousLevel;\n            previousLevel = new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel));\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = previousLevel;\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = previousLevel;\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(new ModifiedLevel(listLevel, this.owner.editorModule.cloneListLevel(listLevel)));\n            value = listLevel;\n        }\n        return value;\n    };\n    /**\n     * Revert the properties\n     * @param  {SelectionRange} selectionRange\n     */\n    BaseHistoryInfo.prototype.revertProperties = function () {\n        this.editorHistory.currentBaseHistoryInfo = this;\n        this.currentPropertyIndex = 0;\n        var property = this.getProperty();\n        this.viewer.owner.editorModule.setOffsetValue(this.viewer.selection);\n        if (this.action === 'ClearCharacterFormat' || this.modifiedProperties[0] instanceof WCharacterFormat) {\n            if (this.action === 'ListCharacterFormat') {\n                this.owner.editorModule.updateListCharacterFormat(this.viewer.selection, property, undefined);\n                return;\n            }\n            this.owner.editorModule.updateSelectionCharacterFormatting(property, undefined, false);\n        }\n        else if (this.action === 'ClearParagraphFormat' || this.modifiedProperties[0] instanceof WParagraphFormat) {\n            if (this.action === 'ContinueNumbering') {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.revertContinueNumbering(this.owner.selection, this.modifiedProperties[0]);\n                return;\n            }\n            if (this.action === 'StyleName' && this.modifiedProperties[0] instanceof WParagraphFormat) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.editorModule.updateSelectionParagraphFormatting(property, this.modifiedProperties[0].baseStyle, false);\n                return;\n            }\n            this.owner.editorModule.updateSelectionParagraphFormatting(property, undefined, false);\n        }\n        else if (this.modifiedProperties[0] instanceof WSectionFormat) {\n            this.owner.editorModule.updateSectionFormat(property, undefined);\n        }\n        else if (this.action === 'RestartNumbering') {\n            this.owner.editorModule.restartListAtInternal(this.owner.selection, this.modifiedProperties[0]);\n            return;\n        }\n        else if (this.modifiedProperties[0] instanceof ImageFormat) {\n            this.owner.selection.updateImageSize(this.modifiedProperties[0]);\n        }\n        else if (this.modifiedProperties[0] instanceof ModifiedLevel) {\n            var modified = new Dictionary();\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var modifiedLevel = this.modifiedProperties[i];\n                // modified.modifiedLevels.add(modifiedLevel.ownerListLevel.levelNumber, modifiedLevel);\n                modified.add(i, modifiedLevel);\n            }\n            this.editorHistory.updateListChanges(modified);\n            modified.destroy();\n            modified = undefined;\n        }\n        else if (this.modifiedProperties[0] instanceof WTableFormat) {\n            this.owner.editorModule.updateTableFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WCellFormat) {\n            this.owner.isShiftingEnabled = true;\n            this.owner.editorModule.updateCellFormat(this.owner.selection, property, undefined);\n        }\n        else if (this.modifiedProperties[0] instanceof WRowFormat) {\n            this.owner.editorModule.updateRowFormat(this.owner.selection, property, undefined);\n        }\n        this.currentPropertyIndex = 0;\n        if (this.action === 'ClearCharacterFormat' || this.action === 'ClearParagraphFormat') {\n            this.owner.editorModule.getOffsetValue(this.viewer.selection);\n        }\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WCellFormat} format\n     * @param  {WTable} table\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellOptions = function (applyFormat, format, table) {\n        var currentFormat;\n        if (isNullOrUndefined(applyFormat.bottomMargin) && isNullOrUndefined(applyFormat.topMargin)\n            && isNullOrUndefined(applyFormat.rightMargin) && isNullOrUndefined(applyFormat.leftMargin)) {\n            currentFormat = this.copyCellOptions(table.tableFormat);\n        }\n        else {\n            currentFormat = this.copyCellOptions(applyFormat);\n        }\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            format = previousFormat;\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties[this.currentPropertyIndex] = this.copyCellOptions(applyFormat);\n            }\n            else {\n                this.modifiedProperties[this.modifiedProperties.length - 1] = this.copyCellOptions(applyFormat);\n            }\n            this.currentPropertyIndex++;\n            return format;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n        return format;\n    };\n    BaseHistoryInfo.prototype.copyCellOptions = function (format) {\n        var cellFormat = new WCellFormat();\n        cellFormat.topMargin = format.topMargin;\n        cellFormat.rightMargin = format.rightMargin;\n        cellFormat.bottomMargin = format.bottomMargin;\n        cellFormat.leftMargin = format.leftMargin;\n        return cellFormat;\n    };\n    /**\n     * Add modified properties for cell options dialog\n     * @param  {WTableFormat} format\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableOptions = function (format) {\n        var currentFormat = this.copyTableOptions(format);\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length           \n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                this.modifiedProperties.splice(this.currentPropertyIndex, 1, currentFormat);\n            }\n            else {\n                this.modifiedProperties.splice(this.modifiedProperties.length - 1, 1, currentFormat);\n            }\n            this.currentPropertyIndex++;\n        }\n        else {\n            this.modifiedProperties.push(currentFormat);\n        }\n    };\n    BaseHistoryInfo.prototype.copyTableOptions = function (format) {\n        var tableFormat = new WTableFormat();\n        tableFormat.topMargin = format.topMargin;\n        tableFormat.rightMargin = format.rightMargin;\n        tableFormat.bottomMargin = format.bottomMargin;\n        tableFormat.leftMargin = format.leftMargin;\n        tableFormat.cellSpacing = format.cellSpacing;\n        return tableFormat;\n    };\n    BaseHistoryInfo.prototype.getProperty = function () {\n        switch (this.action) {\n            case 'Bold':\n                return 'bold';\n            case 'Italic':\n                return 'italic';\n            case 'FontColor':\n                return 'fontColor';\n            case 'FontFamily':\n                return 'fontFamily';\n            case 'FontSize':\n                return 'fontSize';\n            case 'HighlightColor':\n                return 'highlightColor';\n            case 'BaselineAlignment':\n                return 'baselineAlignment';\n            case 'Strikethrough':\n                return 'strikethrough';\n            case 'Underline':\n                return 'underline';\n            case 'AfterSpacing':\n                return 'afterSpacing';\n            case 'BeforeSpacing':\n                return 'beforeSpacing';\n            case 'LeftIndent':\n                return 'leftIndent';\n            case 'RightIndent':\n                return 'rightIndent';\n            case 'FirstLineIndent':\n                return 'firstLineIndent';\n            case 'LineSpacingType':\n                return 'lineSpacingType';\n            case 'LineSpacing':\n                return 'lineSpacing';\n            case 'TextAlignment':\n                return 'textAlignment';\n            case 'ListFormat':\n                return 'listFormat';\n            case 'PageHeight':\n                return 'pageHeight';\n            case 'PageWidth':\n                return 'pageWidth';\n            case 'TableAlignment':\n                return 'tableAlignment';\n            case 'TableLeftIndent':\n                return 'leftIndent';\n            case 'DefaultCellSpacing':\n                return 'cellSpacing';\n            case 'LeftMargin':\n            case 'CellLeftMargin':\n            case 'DefaultCellLeftMargin':\n                return 'leftMargin';\n            case 'RightMargin':\n            case 'CellRightMargin':\n            case 'DefaultCellRightMargin':\n                return 'rightMargin';\n            case 'TopMargin':\n            case 'CellTopMargin':\n            case 'DefaultCellTopMargin':\n                return 'topMargin';\n            case 'BottomMargin':\n            case 'CellBottomMargin':\n            case 'DefaultCellBottomMargin':\n                return 'bottomMargin';\n            case 'CellContentVerticalAlignment':\n                return 'verticalAlignment';\n            case 'RowHeight':\n                return 'height';\n            case 'RowHeightType':\n                return 'heightType';\n            case 'RowHeader':\n                return 'isHeader';\n            case 'AllowBreakAcrossPages':\n                return 'allowBreakAcrossPages';\n            case 'TablePreferredWidth':\n            case 'CellPreferredWidth':\n                return 'preferredWidth';\n            case 'TablePreferredWidthType':\n            case 'CellPreferredWidthType':\n                return 'preferredWidthType';\n            case 'Shading':\n                return 'shading';\n            case 'StyleName':\n                return 'styleName';\n        }\n        return undefined;\n    };\n    BaseHistoryInfo.prototype.getCharacterPropertyValue = function (property, modifiedProperty) {\n        var value;\n        if (property === 'bold') {\n            value = modifiedProperty.bold;\n        }\n        else if (property === 'italic') {\n            value = modifiedProperty.italic;\n        }\n        else if (property === 'fontColor') {\n            value = modifiedProperty.fontColor;\n        }\n        else if (property === 'fontFamily') {\n            value = modifiedProperty.fontFamily;\n        }\n        else if (property === 'fontSize') {\n            value = modifiedProperty.fontSize;\n        }\n        else if (property === 'highlightColor') {\n            value = modifiedProperty.highlightColor;\n        }\n        else if (property === 'baselineAlignment') {\n            value = modifiedProperty.baselineAlignment;\n        }\n        else if (property === 'strikethrough') {\n            value = modifiedProperty.strikethrough;\n        }\n        else if (property === 'underline') {\n            value = modifiedProperty.underline;\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for table format\n     * @param  {WTableFormat} format\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedTableProperties = function (format, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousTableFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousTableFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = format.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = format.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousTableFormat.shading;\n            }\n            else {\n                value = previousTableFormat.getPropertyValue(property);\n            }\n            previousTableFormat.copyFormat(format);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WTableFormat();\n            currentFormat.copyFormat(format);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for row format\n     * @param  {WRowFormat} rowFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedRowProperties = function (rowFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = rowFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = rowFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            value = previousFormat.getPropertyValue(property);\n            previousFormat.copyFormat(rowFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WRowFormat();\n            currentFormat.copyFormat(rowFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * Add modified properties for cell format\n     * @param  {WCellFormat} cellFormat\n     * @param  {string} property\n     * @param  {Object} value\n     * @private\n     */\n    BaseHistoryInfo.prototype.addModifiedCellProperties = function (cellFormat, property, value) {\n        if (this.editorHistory.isUndoing || this.editorHistory.isRedoing) {\n            // tslint:disable-next-line:max-line-length\n            var previousFormat = (this.currentPropertyIndex < this.modifiedProperties.length ? this.modifiedProperties[this.currentPropertyIndex] : this.modifiedProperties[this.modifiedProperties.length - 1]);\n            if (isNullOrUndefined(property)) {\n                value = previousFormat;\n                if (this.currentPropertyIndex < this.modifiedProperties.length) {\n                    this.modifiedProperties[this.currentPropertyIndex] = cellFormat.cloneFormat();\n                }\n                else {\n                    this.modifiedProperties[this.modifiedProperties.length - 1] = cellFormat.cloneFormat();\n                }\n                this.currentPropertyIndex++;\n                return value;\n            }\n            if (property === 'shading') {\n                value = previousFormat.shading;\n            }\n            else {\n                value = previousFormat.getPropertyValue(property);\n            }\n            previousFormat.copyFormat(cellFormat);\n            this.currentPropertyIndex++;\n        }\n        else {\n            var currentFormat = new WCellFormat();\n            currentFormat.copyFormat(cellFormat);\n            this.modifiedProperties.push(currentFormat);\n        }\n        return value;\n    };\n    /**\n     * @private\n     */\n    BaseHistoryInfo.prototype.destroy = function () {\n        this.selectionStart = undefined;\n        this.selectionEnd = undefined;\n        this.insertPosition = undefined;\n        this.endPosition = undefined;\n        if (!isNullOrUndefined(this.modifiedNodeLength)) {\n            this.modifiedNodeLength = [];\n            this.modifiedNodeLength = undefined;\n        }\n        if (!isNullOrUndefined(this.modifiedProperties)) {\n            for (var i = 0; i < this.modifiedProperties.length; i++) {\n                var property = this.modifiedProperties[i];\n                if (property instanceof WCharacterFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WParagraphFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof WSectionFormat) {\n                    property.destroy();\n                }\n                else if (property instanceof ModifiedLevel) {\n                    property.destroy();\n                }\n                this.modifiedProperties.splice(this.modifiedProperties.indexOf(property), 1);\n                i--;\n            }\n            this.modifiedPropertiesIn = undefined;\n        }\n        if (!isNullOrUndefined(this.removedNodes)) {\n            for (var i = 0; i < this.removedNodes.length; i++) {\n                var node = this.removedNodes[i];\n                if (node instanceof ParagraphWidget) {\n                    node.destroyInternal(this.viewer);\n                }\n                else if (node instanceof ElementBox) {\n                    node.destroy();\n                }\n                this.removedNodes.splice(this.removedNodes.indexOf(node), 1);\n                i--;\n            }\n            this.removedNodesIn = undefined;\n        }\n        this.ownerIn = undefined;\n    };\n    return BaseHistoryInfo;\n}());\nexport { BaseHistoryInfo };\n","import { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { PageLayoutViewer } from '../index';\nimport { Dictionary } from '../../base/dictionary';\nimport { ImageFormat } from '../selection/selection-helper';\nimport { Point, HelperMethods } from './editor-helper';\nimport { BaseHistoryInfo } from '../editor-history/base-history-info';\n/**\n * Image resizer implementation.\n */\nvar ImageResizer = /** @class */ (function () {\n    /**\n     * Constructor for image resizer module.\n     * @param {DocumentEditor} node\n     * @param {LayoutViewer} viewer\n     * @private\n     */\n    function ImageResizer(node, viewer) {\n        /**\n         * @private\n         */\n        this.resizeContainerDiv = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topRightRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRect = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRect = undefined;\n        /**\n         * @private\n         */\n        this.topLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.topRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = undefined;\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = undefined;\n        /**\n         * @private\n         */\n        this.resizeMarkSizeIn = 7;\n        /**\n         * @private\n         */\n        this.selectedImageWidget = undefined;\n        /**\n         * @private\n         */\n        this.baseHistoryInfo = undefined;\n        /**\n         * @private\n         */\n        this.isImageResizing = false;\n        /**\n         * @private\n         */\n        this.isImageResizerVisible = false;\n        /**\n         * @private\n         */\n        this.isImageMoveToNextPage = false;\n        /**\n         * @private\n         */\n        this.selectedResizeElement = undefined;\n        /**\n         * @private\n         */\n        this.topValue = undefined;\n        /**\n         * @private\n         */\n        this.leftValue = undefined;\n        this.owner = node;\n        this.selectedImageWidget = new Dictionary();\n        this.viewer = viewer;\n        this.imageResizerPoints = new ImageResizingPoints();\n        if (isNullOrUndefined(this.imageResizerDiv) && this.viewer && this.viewer.pageContainer) {\n            this.initializeImageResizer();\n        }\n    }\n    Object.defineProperty(ImageResizer.prototype, \"currentImageElementBox\", {\n        /**\n         * Gets or Sets the current image element box.\n         * @private\n         */\n        get: function () {\n            return this.currentImageElementBoxIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.currentImageElementBoxIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ImageResizer.prototype, \"resizeMarkSize\", {\n        /**\n         * Gets or Sets the resize mark size.\n         * @private\n         */\n        get: function () {\n            return this.resizeMarkSizeIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.resizeMarkSizeIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Gets module name.\n     */\n    ImageResizer.prototype.getModuleName = function () {\n        return 'ImageResizer';\n    };\n    //Image Resizing Methods\n    /**\n     * Sets image resizer position.\n     * @param {number} x - Specifies for image resizer left value.\n     * @param {number} y - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPositions = function (x, y, width, height) {\n        this.imageResizerDivElement.style.top = y.toString() + 'px';\n        this.imageResizerDivElement.style.left = x.toString() + 'px';\n        this.imageResizerDivElement.style.borderWidth = '0px';\n        this.imageResizerDivElement.style.height = height + 'px';\n        this.imageResizerDivElement.style.width = width + 'px';\n        this.imageResizerDivElement.style.backgroundColor = 'transparent';\n        this.imageResizerDivElement.style.overflow = 'hidden';\n        this.imageResizerDivElement.style.position = 'absolute';\n    };\n    /**\n     * Creates image resizer DOM element.\n     * @private\n     */\n    ImageResizer.prototype.initializeImageResizer = function () {\n        this.imageResizerDivElement = document.createElement('div');\n        this.imageResizerDivElement.style.zIndex = '1';\n        this.imageResizerDivElement.style.display = 'none';\n        this.viewer.pageContainer.appendChild(this.imageResizerDivElement);\n    };\n    /**\n     * Position an image resizer\n     * @param {ImageElementBox} elementBox - Specifies the image position.\n     * @private\n     */\n    ImageResizer.prototype.positionImageResizer = function (elementBox) {\n        this.selectedImageWidget.clear();\n        // Initializes the image resizer on demand, i.e at the time of selecting an image for the first time.\n        var resizeDiv;\n        if (!isNullOrUndefined(this.viewer.currentPage)) {\n            resizeDiv = this.imageResizerDivElement;\n        }\n        if (!isNullOrUndefined(resizeDiv) && !resizeDiv.contains(this.imageResizerDiv)) {\n            this.imageResizerDiv = this.initResizeMarks(resizeDiv, this);\n        }\n        this.imageResizerDiv.style.width = (elementBox.width) + 'px';\n        this.imageResizerDiv.style.height = (elementBox.height) + 'px';\n        this.currentImageElementBox = elementBox;\n        var lineWidget = elementBox.line;\n        var top = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n        var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n        var page = this.viewer.selection.getPage(lineWidget.paragraph);\n        this.currentPage = page;\n        var x = 0;\n        var y = 0;\n        if (!isNullOrUndefined(resizeDiv)) {\n            this.imageResizerDivElement.style.display = 'block';\n            resizeDiv.style.width = page.boundingRectangle.width + 'px';\n            resizeDiv.style.height = page.boundingRectangle.height + 'px';\n            resizeDiv.style.left = page.boundingRectangle.x + 'px';\n            resizeDiv.style.top = page.boundingRectangle.y + 'px';\n            resizeDiv.style.borderWidth = '0px';\n            resizeDiv.style.backgroundColor = 'transparent';\n            resizeDiv.style.overflow = 'hidden';\n            resizeDiv.style.position = 'absolute';\n        }\n        var horizontalWidth = 0;\n        var pageWidth = this.viewer.getPageWidth(page);\n        var pagelayout = this.viewer;\n        // tslint:disable-next-line:max-line-length\n        horizontalWidth = parseFloat(this.imageResizerDivElement.style.width);\n        x = (this.viewer.visibleBounds.width - horizontalWidth * this.viewer.zoomFactor) / 2;\n        if (x < 30) {\n            x = 30;\n        }\n        if (pageWidth < horizontalWidth) {\n            x += (horizontalWidth - pageWidth) * this.viewer.zoomFactor / 2;\n        }\n        // tslint:disable-next-line:max-line-length           \n        y = page.boundingRectangle.y * this.viewer.zoomFactor + (this.viewer.pages.indexOf(page) + 1) * 20 * (1 - this.viewer.zoomFactor);\n        var currentPageDiv = this.imageResizerDivElement;\n        var currentPageDivWidth = parseFloat(currentPageDiv.style.width);\n        var currentPageDivHeight = parseFloat(currentPageDiv.style.height);\n        var imageResizerDivWidth = parseFloat(this.imageResizerDiv.style.width);\n        var imageResizerDivHeight = parseFloat(this.imageResizerDiv.style.height);\n        var margin = (this.resizeMarkSize - 1) / 2;\n        var width = imageResizerDivWidth + 2 * margin;\n        var height = imageResizerDivHeight + 2 * margin;\n        if (width > (currentPageDivWidth - left) * this.viewer.zoomFactor + margin) {\n            width = (currentPageDivWidth - left) * this.viewer.zoomFactor;\n        }\n        if (height > (currentPageDivHeight - top) * this.viewer.zoomFactor + margin) {\n            height = (currentPageDivHeight - top) * this.viewer.zoomFactor;\n        }\n        // if (width < imageResizerDivHeight + margin || height < imageResizerDivHeight + margin) {\n        // }\n        // tslint:disable-next-line:max-line-length\n        this.imageResizerDivElement.style.width = parseInt(this.imageResizerDivElement.style.width.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        this.imageResizerDivElement.style.height = parseInt(this.imageResizerDivElement.style.height.replace('px', ''), 10) * this.viewer.zoomFactor + 'px';\n        height = this.viewer.render.getScaledValue(elementBox.height);\n        width = this.viewer.render.getScaledValue(elementBox.width);\n        left = this.viewer.render.getScaledValue(left);\n        top = this.viewer.render.getScaledValue(top);\n        this.setImageResizerPosition(left, top, width, height, this);\n        if (!this.selectedImageWidget.containsKey(lineWidget)) {\n            var selectedImageInfo = new SelectedImageInfo(elementBox.height, elementBox.width);\n            this.selectedImageWidget.add(lineWidget, selectedImageInfo);\n        }\n    };\n    /**\n     * Shows the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.showImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = '';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = '';\n            this.bottomLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = '';\n            this.bottomRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = '';\n            this.bottomMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = '';\n            this.rightMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = '';\n            this.topRightRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = '';\n            this.topLeftRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = '';\n            this.leftMiddleRectParent.style.display = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = '';\n            this.topMiddleRectParent.style.display = '';\n        }\n        this.isImageResizerVisible = true;\n    };\n    /**\n     * Hides the image resizer.\n     * @private\n     */\n    ImageResizer.prototype.hideImageResizer = function () {\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.style.display = 'none';\n            this.bottomLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.style.display = 'none';\n            this.bottomRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.style.display = 'none';\n            this.bottomMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.style.display = 'none';\n            this.rightMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.style.display = 'none';\n            this.topRightRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.style.display = 'none';\n            this.topLeftRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.style.display = 'none';\n            this.leftMiddleRectParent.style.display = 'none';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.style.display = 'none';\n            this.topMiddleRectParent.style.display = 'none';\n        }\n        this.isImageResizerVisible = false;\n        this.currentPage = undefined;\n    };\n    /**\n     * Initialize the resize marks.\n     * @param {HTMLElement} resizeDiv - Specifies to appending resizer container div element.\n     * @param {ImageResizer} imageResizer - Specifies to creating div element of each position.\n     * @private\n     */\n    // tslint:disable:max-func-body-length\n    ImageResizer.prototype.initResizeMarks = function (resizeDiv, imageResizer) {\n        this.initResizeContainerDiv(imageResizer);\n        resizeDiv.appendChild(imageResizer.resizeContainerDiv);\n        imageResizer.topRightRectParent = document.createElement('div');\n        imageResizer.topRightRectParent.style.cursor = 'ne-resize';\n        imageResizer.topRightRectParent.id = this.viewer.owner.containerId + '_TopRightRectParent';\n        this.applyProperties(imageResizer.topRightRectParent);\n        imageResizer.topRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topRightRectParent);\n        imageResizer.topRightRect = document.createElement('div');\n        imageResizer.topRightRect.id = this.viewer.owner.containerId + '_TopRightRect';\n        imageResizer.topRightRect.style.cursor = 'ne-resize';\n        this.applyProperties(imageResizer.topRightRect);\n        resizeDiv.appendChild(imageResizer.topRightRect);\n        imageResizer.topLeftRectParent = document.createElement('div');\n        imageResizer.topLeftRectParent.style.cursor = 'nw-resize';\n        imageResizer.topLeftRectParent.id = this.viewer.owner.containerId + '_TopLeftRectParent';\n        this.applyProperties(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topLeftRectParent);\n        imageResizer.topLeftRect = document.createElement('div');\n        imageResizer.topLeftRect.id = this.viewer.owner.containerId + '_TopLeftRect';\n        imageResizer.topLeftRect.style.cursor = 'nw-resize';\n        this.applyProperties(imageResizer.topLeftRect);\n        resizeDiv.appendChild(imageResizer.topLeftRect);\n        imageResizer.topMiddleRectParent = document.createElement('div');\n        imageResizer.topMiddleRectParent.style.cursor = 'n-resize';\n        imageResizer.topMiddleRectParent.id = this.viewer.owner.containerId + '_TopMiddleRectParent';\n        this.applyProperties(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.topMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.topMiddleRectParent);\n        imageResizer.topMiddleRect = document.createElement('div');\n        imageResizer.topMiddleRect.id = this.viewer.owner.containerId + '_TopMiddleRect';\n        imageResizer.topMiddleRect.style.cursor = 'n-resize';\n        this.applyProperties(imageResizer.topMiddleRect);\n        resizeDiv.appendChild(imageResizer.topMiddleRect);\n        imageResizer.bottomRightRectParent = document.createElement('div');\n        imageResizer.bottomRightRectParent.style.cursor = 'se-resize';\n        imageResizer.bottomRightRectParent.id = this.viewer.owner.containerId + '_BottomRightRectParent';\n        this.applyProperties(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomRightRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomRightRectParent);\n        imageResizer.bottomRightRect = document.createElement('div');\n        imageResizer.bottomRightRect.id = this.viewer.owner.containerId + '_BottomRightRect';\n        imageResizer.bottomRightRect.style.cursor = 'se-resize';\n        this.applyProperties(imageResizer.bottomRightRect);\n        resizeDiv.appendChild(imageResizer.bottomRightRect);\n        imageResizer.bottomLeftRectParent = document.createElement('div');\n        imageResizer.bottomLeftRectParent.style.cursor = 'sw-resize';\n        imageResizer.bottomLeftRectParent.id = this.viewer.owner.containerId + '_BottomLeftRectParent';\n        this.applyProperties(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomLeftRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomLeftRectParent);\n        imageResizer.bottomLeftRect = document.createElement('div');\n        imageResizer.bottomLeftRect.id = this.viewer.owner.containerId + '_BottomLeftRect';\n        imageResizer.bottomLeftRect.style.cursor = 'sw-resize';\n        this.applyProperties(imageResizer.bottomLeftRect);\n        resizeDiv.appendChild(imageResizer.bottomLeftRect);\n        imageResizer.bottomMiddleRectParent = document.createElement('div');\n        imageResizer.bottomMiddleRectParent.style.cursor = 's-resize';\n        imageResizer.bottomMiddleRectParent.id = this.viewer.owner.containerId + '_BottomMiddleRectParent';\n        this.applyProperties(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.bottomMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.bottomMiddleRectParent);\n        imageResizer.bottomMiddleRect = document.createElement('div');\n        imageResizer.bottomMiddleRect.id = this.viewer.owner.containerId + '_BottomMiddleRect';\n        imageResizer.bottomMiddleRect.style.cursor = 's-resize';\n        this.applyProperties(imageResizer.bottomMiddleRect);\n        resizeDiv.appendChild(imageResizer.bottomMiddleRect);\n        imageResizer.rightMiddleRectParent = document.createElement('div');\n        imageResizer.rightMiddleRectParent.style.cursor = 'e-resize';\n        imageResizer.rightMiddleRectParent.id = this.viewer.owner.containerId + '_RightMiddleRectParent';\n        this.applyProperties(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.rightMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.rightMiddleRectParent);\n        imageResizer.rightMiddleRect = document.createElement('div');\n        imageResizer.rightMiddleRect.id = this.viewer.owner.containerId + '_RightMiddleRect';\n        imageResizer.rightMiddleRect.style.cursor = 'e-resize';\n        this.applyProperties(imageResizer.rightMiddleRect);\n        resizeDiv.appendChild(imageResizer.rightMiddleRect);\n        imageResizer.leftMiddleRectParent = document.createElement('div');\n        imageResizer.leftMiddleRectParent.style.cursor = 'w-resize';\n        imageResizer.leftMiddleRectParent.id = this.viewer.owner.containerId + '_LeftMiddleRectParent';\n        this.applyProperties(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRectParent.style.width = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.height = !this.viewer.isTouchInput ? '14px' : '30px';\n        imageResizer.leftMiddleRectParent.style.opacity = '-1';\n        resizeDiv.appendChild(imageResizer.leftMiddleRectParent);\n        imageResizer.leftMiddleRect = document.createElement('div');\n        imageResizer.leftMiddleRect.id = this.viewer.owner.containerId + '_LeftMiddleRect';\n        imageResizer.leftMiddleRect.style.cursor = 'w-resize';\n        this.applyProperties(imageResizer.leftMiddleRect);\n        resizeDiv.appendChild(imageResizer.leftMiddleRect);\n        return imageResizer.resizeContainerDiv;\n    };\n    /**\n     * Sets the image resizer position.\n     * @param {number} left - Specifies for image resizer left value.\n     * @param {number} top - Specifies for image resizer top value.\n     * @param {number} width - Specifies for image resizer width value.\n     * @param {number} height - Specifies for image resizer height value.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizerPosition = function (left, top, width, height, imageResizer) {\n        //Positions Updating For Image Resize Div\n        imageResizer.resizeContainerDiv.style.width = width + 'px';\n        imageResizer.resizeContainerDiv.style.height = height + 'px';\n        imageResizer.resizeContainerDiv.style.left = left - 1 + 'px';\n        imageResizer.resizeContainerDiv.style.top = top + 'px';\n        //Positions Updating For Image Resizing Points\n        imageResizer.topRightRect.style.left = ((left + width) - 5) + 'px';\n        imageResizer.topRightRect.style.top = (top - 4) + 'px';\n        imageResizer.topLeftRect.style.left = (left - 5) + 'px';\n        imageResizer.topLeftRect.style.top = (top - 4) + 'px';\n        imageResizer.topMiddleRect.style.left = ((parseFloat(imageResizer.topLeftRect.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRect.style.top = (top - 4) + 'px';\n        imageResizer.bottomRightRect.style.left = imageResizer.topRightRect.style.left;\n        imageResizer.bottomRightRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + height) + 'px';\n        imageResizer.bottomLeftRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.bottomLeftRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRect.style.left = imageResizer.topMiddleRect.style.left;\n        imageResizer.bottomMiddleRect.style.top = (parseFloat(imageResizer.topMiddleRect.style.top) + height) + 'px';\n        imageResizer.rightMiddleRect.style.left = ((left + width) - 4) + 'px';\n        imageResizer.rightMiddleRect.style.top = (parseFloat(imageResizer.topRightRect.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRect.style.left = imageResizer.topLeftRect.style.left;\n        imageResizer.leftMiddleRect.style.top = (parseFloat(imageResizer.topLeftRect.style.top) + (height / 2)) + 'px';\n        imageResizer.topRightRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 8) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.topRightRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topLeftRectParent.style.left = !this.viewer.isTouchInput ? (left - 8) + 'px' : (left - 15) + 'px';\n        imageResizer.topLeftRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.topMiddleRectParent.style.left = ((parseFloat(imageResizer.topLeftRectParent.style.left) + (width / 2)) - 4) + 'px';\n        imageResizer.topMiddleRectParent.style.top = !this.viewer.isTouchInput ? (top - 7) + 'px' : (top - 15) + 'px';\n        imageResizer.bottomRightRectParent.style.left = imageResizer.topRightRectParent.style.left;\n        imageResizer.bottomRightRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + height) + 'px';\n        imageResizer.bottomLeftRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.bottomLeftRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + height) + 'px';\n        imageResizer.bottomMiddleRectParent.style.left = imageResizer.topMiddleRectParent.style.left;\n        imageResizer.bottomMiddleRectParent.style.top = (parseFloat(imageResizer.topMiddleRectParent.style.top) + height) + 'px';\n        // tslint:disable-next-line:max-line-length \n        imageResizer.rightMiddleRectParent.style.left = !this.viewer.isTouchInput ? ((left + width) - 7) + 'px' : ((left + width) - 15) + 'px';\n        imageResizer.rightMiddleRectParent.style.top = (parseFloat(imageResizer.topRightRectParent.style.top) + (height / 2)) + 'px';\n        imageResizer.leftMiddleRectParent.style.left = imageResizer.topLeftRectParent.style.left;\n        imageResizer.leftMiddleRectParent.style.top = (parseFloat(imageResizer.topLeftRectParent.style.top) + (height / 2)) + 'px';\n        this.setImageResizingPoints(imageResizer);\n        if (this.viewer.isTouchInput) {\n            this.applyPropertiesForTouch();\n        }\n        else {\n            this.applyPropertiesForMouse();\n        }\n    };\n    /**\n     * Sets the image resizing points.\n     * @param {ImageResizer} imageResizer - Specifies for position of each resizing elements.\n     * @private\n     */\n    ImageResizer.prototype.setImageResizingPoints = function (imageResizer) {\n        this.imageResizerPoints.resizeContainerDiv.x = parseFloat(imageResizer.resizeContainerDiv.style.left);\n        this.imageResizerPoints.resizeContainerDiv.y = parseFloat(imageResizer.resizeContainerDiv.style.top);\n        this.imageResizerPoints.bottomLeftRectParent.x = parseFloat(imageResizer.bottomLeftRectParent.style.left);\n        this.imageResizerPoints.bottomLeftRectParent.y = parseFloat(imageResizer.bottomLeftRectParent.style.top);\n        this.imageResizerPoints.bottomRightRectParent.x = parseFloat(imageResizer.bottomRightRectParent.style.left);\n        this.imageResizerPoints.bottomRightRectParent.y = parseFloat(imageResizer.bottomRightRectParent.style.top);\n        this.imageResizerPoints.bottomMiddleRectParent.x = parseFloat(imageResizer.bottomMiddleRectParent.style.left);\n        this.imageResizerPoints.bottomMiddleRectParent.y = parseFloat(imageResizer.bottomMiddleRectParent.style.top);\n        this.imageResizerPoints.topLeftRectParent.x = parseFloat(imageResizer.topLeftRectParent.style.left);\n        this.imageResizerPoints.topLeftRectParent.y = parseFloat(imageResizer.topLeftRectParent.style.top);\n        this.imageResizerPoints.topRightRectParent.x = parseFloat(imageResizer.topRightRectParent.style.left);\n        this.imageResizerPoints.topRightRectParent.y = parseFloat(imageResizer.topRightRectParent.style.top);\n        this.imageResizerPoints.topMiddleRectParent.x = parseFloat(imageResizer.topMiddleRectParent.style.left);\n        this.imageResizerPoints.topMiddleRectParent.y = parseFloat(imageResizer.topMiddleRectParent.style.top);\n        this.imageResizerPoints.leftMiddleRectParent.x = parseFloat(imageResizer.leftMiddleRectParent.style.left);\n        this.imageResizerPoints.leftMiddleRectParent.y = parseFloat(imageResizer.leftMiddleRectParent.style.top);\n        this.imageResizerPoints.rightMiddleRectParent.x = parseFloat(imageResizer.rightMiddleRectParent.style.left);\n        this.imageResizerPoints.rightMiddleRectParent.y = parseFloat(imageResizer.rightMiddleRectParent.style.top);\n    };\n    /**\n     * Initialize the resize container div element.\n     * @param {ImageResizer} imageResizer - Specifies for creating resize container div element.\n     * @private\n     */\n    ImageResizer.prototype.initResizeContainerDiv = function (imageResizer) {\n        imageResizer.resizeContainerDiv = document.createElement('div');\n        imageResizer.resizeContainerDiv.id = this.viewer.owner.containerId + '_ResizeDivElement';\n        imageResizer.resizeContainerDiv.style.position = 'absolute';\n        imageResizer.resizeContainerDiv.style.border = '1px solid #bfbfbf';\n        imageResizer.resizeContainerDiv.style.zIndex = '30';\n        imageResizer.resizeContainerDiv.style.backgroundColor = 'transparent';\n        imageResizer.resizeContainerDiv.style.display = 'block';\n    };\n    /**\n     * Apply the properties of each resize rectangle element.\n     * @param {HTMLDivElement} resizeRectElement - Specifies for applying properties to resize rectangle element.\n     * @private\n     */\n    ImageResizer.prototype.applyProperties = function (resizeRectElement) {\n        resizeRectElement.style.position = 'absolute';\n        resizeRectElement.style.width = '8px';\n        resizeRectElement.style.height = '8px';\n        resizeRectElement.style.fontSize = '0px';\n        resizeRectElement.style.zIndex = ' 551';\n        resizeRectElement.style.backgroundColor = '#ffffff';\n        resizeRectElement.style.border = '1px solid #bfbfbf';\n        resizeRectElement.style.boxShadow = '0 1px 2px 0 #bfbfbf 0.35';\n        resizeRectElement.style.color = '#000000';\n    };\n    /**\n     * Handles an image resizing.\n     * @param {number} x  - Specifies for left value while resizing.\n     * @param {number} y - Specifies for top value while resizing.\n     */\n    ImageResizer.prototype.handleImageResizing = function (touchPoint, prevX, prevY) {\n        prevX = prevX / this.viewer.zoomFactor;\n        prevY = prevY / this.viewer.zoomFactor;\n        this.leftValue = isNullOrUndefined(this.leftValue) ? prevX : this.leftValue;\n        this.topValue = isNullOrUndefined(this.topValue) ? prevY : this.topValue;\n        var points;\n        switch (this.selectedResizeElement.id.split('_')[1]) {\n            case 'TopRightRectParent':\n                points = this.topRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'TopLeftRectParent':\n                points = this.topLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'TopMiddleRectParent':\n                prevX = 0;\n                prevY = this.topMiddleResizing(touchPoint);\n                break;\n            case 'BottomRightRectParent':\n                points = this.bottomRightResizing(touchPoint);\n                prevX = points.left;\n                prevY = points.top;\n                break;\n            case 'BottomLeftRectParent':\n                points = this.bottomLeftResizing(touchPoint);\n                prevX = -points.left;\n                prevY = -points.top;\n                break;\n            case 'BottomMiddleRectParent':\n                prevY = touchPoint.y - prevY;\n                prevX = 0;\n                break;\n            case 'RightMiddleRectParent':\n                prevX = touchPoint.x - prevX;\n                prevY = 0;\n                break;\n            case 'LeftMiddleRectParent':\n                prevX = this.leftMiddleResizing(touchPoint);\n                prevY = 0;\n                break;\n            default:\n                break;\n        }\n        if (prevX !== 0 || prevY !== 0) {\n            var widget = this.currentImageElementBox.line.paragraph;\n            var image = this.currentImageElementBox;\n            if (!isNullOrUndefined(widget) && widget.isInsideTable) {\n                var cellWidget = widget.containerWidget;\n                if (!isNullOrUndefined(cellWidget)) {\n                    var rowWidget = cellWidget.containerWidget;\n                    var imageHeight = HelperMethods.convertPointToPixel(image.height);\n                    var widgetHeight = rowWidget.height - imageHeight;\n                    if (prevY > 0 && rowWidget.y + widgetHeight + imageHeight + prevY > this.viewer.clientArea.bottom) {\n                        this.isImageMoveToNextPage = true;\n                    }\n                }\n            }\n            // tslint:disable-next-line:max-line-length \n            if (this.owner.enableHistoryMode) {\n                this.initHistoryForImageResizer(this.currentImageElementBox);\n            }\n            if (!isNullOrUndefined(this.currentImageElementBox)) {\n                // tslint:disable-next-line:max-line-length   \n                var width = this.currentImageElementBox.width + prevX > 10 ? this.currentImageElementBox.width + prevX : 10;\n                // tslint:disable-next-line:max-line-length \n                var height = this.currentImageElementBox.height + prevY > 10 ? this.currentImageElementBox.height + prevY : 10;\n                if (this.selectedResizeElement.id.split('_')[1] === 'BottomRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopRightRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'BottomLeftRectParent'\n                    || this.selectedResizeElement.id.split('_')[1] === 'TopLeftRectParent') {\n                    height = this.currentImageElementBox.height / this.currentImageElementBox.width * width;\n                    width = this.currentImageElementBox.width / this.currentImageElementBox.height * height;\n                }\n                this.currentImageElementBox.width = width;\n                this.currentImageElementBox.height = height;\n                var owner = this.currentImageElementBox.line.paragraph;\n                this.positionImageResizer(this.currentImageElementBox);\n            }\n            this.isImageResizing = true;\n        }\n    };\n    /**\n     * Handles image resizing on mouse.\n     * @param {MouseEvent} event - Specifies for image resizing using mouse event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnMouse = function (event) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left);\n            var prevY = parseFloat(this.selectedResizeElement.style.top);\n            var cursorPoint = new Point(event.offsetX, event.offsetY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    ImageResizer.prototype.topMiddleResizing = function (touchPoint) {\n        var prevY;\n        if (this.topValue >= touchPoint.y) {\n            prevY = this.topValue / touchPoint.y;\n            this.topValue = touchPoint.y;\n            if (this.viewer instanceof PageLayoutViewer) {\n                if (this.topValue <= this.viewer.pageGap) {\n                    prevY = 1;\n                }\n            }\n        }\n        else {\n            prevY = -(touchPoint.y / this.topValue);\n            this.topValue = touchPoint.y;\n            if (this.topValue === 0) {\n                prevY = -1;\n            }\n        }\n        return prevY;\n    };\n    ImageResizer.prototype.leftMiddleResizing = function (touchPoint) {\n        var prevX;\n        if (this.leftValue >= touchPoint.x) {\n            prevX = this.leftValue / touchPoint.x;\n            this.leftValue = touchPoint.x;\n            if (this.leftValue === 0) {\n                prevX = 1;\n                this.leftValue = parseFloat(this.selectedResizeElement.style.left);\n            }\n        }\n        else {\n            prevX = -(touchPoint.x / this.leftValue);\n            this.leftValue = touchPoint.x;\n        }\n        return prevX;\n    };\n    ImageResizer.prototype.topRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.topLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue >= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomRightResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue <= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.bottomLeftResizing = function (touchPoint) {\n        var points;\n        if (this.leftValue >= touchPoint.x && this.topValue <= touchPoint.y) {\n            points = this.getOuterResizingPoint(touchPoint);\n        }\n        else {\n            points = this.getInnerResizingPoint(touchPoint);\n        }\n        return points;\n    };\n    ImageResizer.prototype.getOuterResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = touchPoint.x - this.leftValue;\n        this.leftValue = touchPoint.x;\n        prevY = touchPoint.y - this.topValue;\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    ImageResizer.prototype.getInnerResizingPoint = function (touchPoint) {\n        var prevX;\n        var prevY;\n        prevX = -(this.leftValue - touchPoint.x);\n        this.leftValue = touchPoint.x;\n        prevY = -(this.topValue - touchPoint.y);\n        this.topValue = touchPoint.y;\n        return { left: prevX, top: prevY };\n    };\n    /**\n     * Handles image resizing on touch.\n     * @param {TouchEvent} touchEvent - Specifies for image resizing using touch event.\n     * @private\n     */\n    ImageResizer.prototype.handleImageResizingOnTouch = function (touchEvent) {\n        if (!isNullOrUndefined(this.selectedResizeElement)) {\n            var prevX = parseFloat(this.selectedResizeElement.style.left) + 24;\n            var prevY = parseFloat(this.selectedResizeElement.style.top) + 24;\n            var touch = touchEvent.touches;\n            var cursorPoint = new Point(touch[0].clientX, touch[0].clientY);\n            var touchPoint = this.viewer.findFocusedPage(cursorPoint, true);\n            if (isNullOrUndefined(this.currentImageElementBox) || isNullOrUndefined(this.currentImageElementBox)) {\n                return;\n            }\n            this.handleImageResizing(touchPoint, prevX, prevY);\n        }\n    };\n    /**\n     * Gets the image point of mouse.\n     * @param {Point} touchPoint - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePoint = function (touchPoint) {\n        var x = this.viewer.render.getScaledValue(touchPoint.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoint.y, 2);\n        touchPoint = new Point(x, y);\n        var imageResizingPoints = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElement = undefined;\n        var bottomMiddle = imageResizingPoints.bottomMiddleRectParent;\n        var bottomRight = imageResizingPoints.bottomRightRectParent;\n        var bottomLeft = imageResizingPoints.bottomLeftRectParent;\n        var topMiddle = imageResizingPoints.topMiddleRectParent;\n        var topRight = imageResizingPoints.topRightRectParent;\n        var topLeft = imageResizingPoints.topLeftRectParent;\n        var rightMiddle = imageResizingPoints.rightMiddleRectParent;\n        var leftMiddle = imageResizingPoints.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoint.x > bottomMiddle.x && touchPoint.x <= bottomMiddle.x + 15) && (touchPoint.y > bottomMiddle.y && touchPoint.y <= bottomMiddle.y + 15)) {\n                selectedElement = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomRight.x && touchPoint.x <= bottomRight.x + 15) && (touchPoint.y > bottomRight.y && touchPoint.y <= bottomRight.y + 15)) {\n                selectedElement = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > bottomLeft.x && touchPoint.x <= bottomLeft.x + 15) && (touchPoint.y > bottomLeft.y && touchPoint.y <= bottomLeft.y + 15)) {\n                selectedElement = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topMiddle.x && touchPoint.x <= topMiddle.x + 15) && (touchPoint.y > topMiddle.y && touchPoint.y <= topMiddle.y + 15)) {\n                selectedElement = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topRight.x && touchPoint.x <= topRight.x + 15) && (touchPoint.y > topRight.y && touchPoint.y <= topRight.y + 15)) {\n                selectedElement = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > topLeft.x && touchPoint.x <= topLeft.x + 15) && (touchPoint.y > topLeft.y && touchPoint.y <= topLeft.y + 15)) {\n                selectedElement = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > leftMiddle.x && touchPoint.x <= leftMiddle.x + 15) && (touchPoint.y > leftMiddle.y && touchPoint.y <= leftMiddle.y + 15)) {\n                selectedElement = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoint.x > rightMiddle.x && touchPoint.x <= rightMiddle.x + 15) && (touchPoint.y > rightMiddle.y && touchPoint.y <= rightMiddle.y + 15)) {\n                selectedElement = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoint.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoint.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoint.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoint.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElement, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForMouse = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '14px';\n            this.bottomMiddleRectParent.style.height = '14px';\n            this.bottomRightRectParent.style.width = '14px';\n            this.bottomRightRectParent.style.height = '14px';\n            this.bottomLeftRectParent.style.width = '14px';\n            this.bottomLeftRectParent.style.height = '14px';\n            this.topMiddleRectParent.style.width = '14px';\n            this.topMiddleRectParent.style.height = '14px';\n            this.topRightRectParent.style.width = '14px';\n            this.topRightRectParent.style.height = '14px';\n            this.topLeftRectParent.style.width = '14px';\n            this.topLeftRectParent.style.height = '14px';\n            this.leftMiddleRectParent.style.width = '14px';\n            this.leftMiddleRectParent.style.height = '14px';\n            this.rightMiddleRectParent.style.width = '14px';\n            this.rightMiddleRectParent.style.height = '14px';\n        }\n    };\n    /**\n     * Gets the image point of touch.\n     * @param {Point} touchPoints - Specifies for resizer cursor position.\n     * @private\n     */\n    ImageResizer.prototype.getImagePointOnTouch = function (touchPoints) {\n        var x = this.viewer.render.getScaledValue(touchPoints.x, 1);\n        var y = this.viewer.render.getScaledValue(touchPoints.y, 2);\n        touchPoints = new Point(x, y);\n        var imageResizingPointsOnTouch = this.imageResizerPoints;\n        var resizePosition = '';\n        var selectedElements = undefined;\n        var bottomMiddle = imageResizingPointsOnTouch.bottomMiddleRectParent;\n        var bottomRight = imageResizingPointsOnTouch.bottomRightRectParent;\n        var bottomLeft = imageResizingPointsOnTouch.bottomLeftRectParent;\n        var topMiddle = imageResizingPointsOnTouch.topMiddleRectParent;\n        var topRight = imageResizingPointsOnTouch.topRightRectParent;\n        var topLeft = imageResizingPointsOnTouch.topLeftRectParent;\n        var rightMiddle = imageResizingPointsOnTouch.rightMiddleRectParent;\n        var leftMiddle = imageResizingPointsOnTouch.leftMiddleRectParent;\n        if (!isNullOrUndefined(this.bottomMiddleRectParent) && this.bottomMiddleRectParent.style.display !== 'none') {\n            // tslint:disable-next-line:max-line-length   \n            if ((touchPoints.x > bottomMiddle.x && touchPoints.x <= bottomMiddle.x + 25) && (touchPoints.y > bottomMiddle.y && touchPoints.y <= bottomMiddle.y + 25)) {\n                selectedElements = this.bottomMiddleRectParent;\n                resizePosition = 's-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomRight.x && touchPoints.x <= bottomRight.x + 25) && (touchPoints.y > bottomRight.y && touchPoints.y <= bottomRight.y + 25)) {\n                selectedElements = this.bottomRightRectParent;\n                resizePosition = 'se-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > bottomLeft.x && touchPoints.x <= bottomLeft.x + 25) && (touchPoints.y > bottomLeft.y && touchPoints.y <= bottomLeft.y + 25)) {\n                selectedElements = this.bottomLeftRectParent;\n                resizePosition = 'sw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topMiddle.x && touchPoints.x <= topMiddle.x + 25) && (touchPoints.y > topMiddle.y && touchPoints.y <= topMiddle.y + 25)) {\n                selectedElements = this.topMiddleRectParent;\n                resizePosition = 'n-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topRight.x && touchPoints.x <= topRight.x + 25) && (touchPoints.y > topRight.y && touchPoints.y <= topRight.y + 25)) {\n                selectedElements = this.topRightRectParent;\n                resizePosition = 'ne-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > topLeft.x && touchPoints.x <= topLeft.x + 25) && (touchPoints.y > topLeft.y && touchPoints.y <= topLeft.y + 25)) {\n                selectedElements = this.topLeftRectParent;\n                resizePosition = 'nw-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > leftMiddle.x && touchPoints.x <= leftMiddle.x + 25) && (touchPoints.y > leftMiddle.y && touchPoints.y <= leftMiddle.y + 25)) {\n                selectedElements = this.leftMiddleRectParent;\n                resizePosition = 'w-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if ((touchPoints.x > rightMiddle.x && touchPoints.x <= rightMiddle.x + 25) && (touchPoints.y > rightMiddle.y && touchPoints.y <= rightMiddle.y + 25)) {\n                selectedElements = this.rightMiddleRectParent;\n                resizePosition = 'e-resize';\n                // tslint:disable-next-line:max-line-length   \n            }\n            else if (!isNullOrUndefined(this.resizeContainerDiv) && (touchPoints.x > parseFloat(this.resizeContainerDiv.style.left)\n                && touchPoints.x <= (parseFloat(this.resizeContainerDiv.style.left) + parseFloat(this.resizeContainerDiv.style.width)))\n                && (touchPoints.y > parseFloat(this.resizeContainerDiv.style.top)\n                    // tslint:disable-next-line:max-line-length \n                    && touchPoints.y <= (parseFloat(this.resizeContainerDiv.style.top) + parseFloat(this.resizeContainerDiv.style.height)))) {\n                resizePosition = 'move';\n            }\n        }\n        return { 'selectedElement': selectedElements, 'resizePosition': resizePosition };\n    };\n    ImageResizer.prototype.applyPropertiesForTouch = function () {\n        if (!isNullOrUndefined(this.bottomLeftRectParent)) {\n            this.bottomMiddleRectParent.style.width = '30px';\n            this.bottomMiddleRectParent.style.height = '30px';\n            this.bottomRightRectParent.style.width = '30px';\n            this.bottomRightRectParent.style.height = '30px';\n            this.bottomLeftRectParent.style.width = '30px';\n            this.bottomLeftRectParent.style.height = '30px';\n            this.topMiddleRectParent.style.width = '30px';\n            this.topMiddleRectParent.style.height = '30px';\n            this.topRightRectParent.style.width = '30px';\n            this.topRightRectParent.style.height = '30px';\n            this.topLeftRectParent.style.width = '30px';\n            this.topLeftRectParent.style.height = '30px';\n            this.leftMiddleRectParent.style.width = '30px';\n            this.leftMiddleRectParent.style.height = '30px';\n            this.rightMiddleRectParent.style.width = '30px';\n            this.rightMiddleRectParent.style.height = '30px';\n        }\n    };\n    /**\n     * @private\n     */\n    ImageResizer.prototype.mouseUpInternal = function () {\n        this.currentImageElementBox.width = parseFloat(this.imageResizerDiv.style.width) / this.viewer.zoomFactor;\n        this.currentImageElementBox.height = parseFloat(this.imageResizerDiv.style.height) / this.viewer.zoomFactor;\n        this.owner.isShiftingEnabled = true;\n        this.owner.editorModule.setOffsetValue(this.owner.selection);\n        this.viewer.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph, 0, 0);\n        this.owner.editorModule.reLayout(this.owner.selection, true);\n        this.viewer.updateScrollBars();\n    };\n    /**\n     * Initialize history for image resizer.\n     * @param {ImageResizer} imageResizer - Specifies for image resizer.\n     * @param {WImage} imageContainer - Specifies for an image.\n     * @private\n     */\n    ImageResizer.prototype.initHistoryForImageResizer = function (imageContainer) {\n        if (!isNullOrUndefined(this.owner) && isNullOrUndefined(this.baseHistoryInfo)) {\n            this.baseHistoryInfo = new BaseHistoryInfo(this.owner);\n            this.baseHistoryInfo.action = 'ImageResizing';\n            this.baseHistoryInfo.updateSelection();\n            this.baseHistoryInfo.modifiedProperties.push(new ImageFormat(imageContainer));\n        }\n    };\n    /**\n     * Updates histroy for image resizer.\n     * @private\n     */\n    ImageResizer.prototype.updateHistoryForImageResizer = function () {\n        if (!isNullOrUndefined(this.owner) && !isNullOrUndefined(this.baseHistoryInfo)) {\n            var imageFormat = this.baseHistoryInfo.modifiedProperties[0];\n            if (this.currentImageElementBox.width === imageFormat.width\n                && this.currentImageElementBox.height === imageFormat.height) {\n                this.baseHistoryInfo.modifiedProperties.pop();\n            }\n            else {\n                //Records the image size modifications\n                this.owner.editorHistory.recordChanges(this.baseHistoryInfo);\n            }\n            //Fires the content changed event for the image size modifications\n            this.baseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * Updates image resize container when applying zooming\n     * @private\n     */\n    ImageResizer.prototype.updateImageResizerPosition = function () {\n        if (!isNullOrUndefined(this.currentImageElementBox)) {\n            var elementBox = this.currentImageElementBox;\n            var lineWidget = elementBox.line;\n            var top_1 = this.viewer.selection.getTop(lineWidget) + elementBox.margin.top;\n            var left = this.viewer.selection.getLeftInternal(lineWidget, elementBox, 0);\n            var topValue = top_1 * this.viewer.zoomFactor;\n            var leftValue = left * this.viewer.zoomFactor;\n            var height = this.viewer.render.getScaledValue(elementBox.height, 2);\n            var width = this.viewer.render.getScaledValue(elementBox.width, 1);\n            this.setImageResizerPosition(leftValue, topValue, width, height, this);\n        }\n    };\n    /**\n     * Dispose the internal objects which are maintained.\n     * @private\n     */\n    ImageResizer.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.resizeContainerDiv)) {\n            this.resizeContainerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topLeftRect)) {\n            this.topLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topMiddleRect)) {\n            this.topMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.topRightRect)) {\n            this.topRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomLeftRect)) {\n            this.bottomLeftRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomMiddleRect)) {\n            this.bottomMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.bottomRightRect)) {\n            this.bottomRightRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.leftMiddleRect)) {\n            this.leftMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.rightMiddleRect)) {\n            this.rightMiddleRect.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.imageResizerDiv)) {\n            this.imageResizerDiv.innerHTML = '';\n        }\n        if (!isNullOrUndefined(this.selectedImageWidget)) {\n            this.selectedImageWidget.destroy();\n        }\n        if (!isNullOrUndefined(this.imageResizerDivElement)) {\n            this.imageResizerDivElement.innerHTML = '';\n        }\n        this.imageResizerDivElement = undefined;\n        this.resizeContainerDiv = undefined;\n        this.topLeftRect = undefined;\n        this.topMiddleRect = undefined;\n        this.topRightRect = undefined;\n        this.bottomLeftRect = undefined;\n        this.bottomMiddleRect = undefined;\n        this.bottomRightRect = undefined;\n        this.leftMiddleRect = undefined;\n        this.rightMiddleRect = undefined;\n        this.imageResizerDiv = undefined;\n        this.selectedImageWidget = undefined;\n        this.isImageResizing = false;\n        this.isImageResizerVisible = false;\n        this.currentImageElementBoxIn = undefined;\n        //this.baseHistoryInfo = undefined;\n        this.resizeMarkSizeIn = undefined;\n        this.viewer = undefined;\n        this.owner = undefined;\n    };\n    return ImageResizer;\n}());\nexport { ImageResizer };\n/**\n * @private\n */\nvar ImageResizingPoints = /** @class */ (function () {\n    /**\n     * Constructor for image resizing points class.\n     */\n    function ImageResizingPoints() {\n        /**\n         * @private\n         */ this.resizeContainerDiv = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.topRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomLeftRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.bottomRightRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.leftMiddleRectParent = new Point(0, 0);\n        /**\n         * @private\n         */\n        this.rightMiddleRectParent = new Point(0, 0);\n        var text = 'DocumentEditor';\n    }\n    return ImageResizingPoints;\n}());\nexport { ImageResizingPoints };\n/**\n * @private\n */\nvar SelectedImageInfo = /** @class */ (function () {\n    /**\n     * Constructor for selected image info class.\n     * @param {number} height - Specifies for height value.\n     * @param {number} width - Specifies for width value.\n     */\n    function SelectedImageInfo(height, width) {\n        this.heightIn = 0;\n        this.widthIn = 0;\n        this.heightIn = height;\n        this.widthIn = width;\n    }\n    Object.defineProperty(SelectedImageInfo.prototype, \"height\", {\n        /**\n         * Gets or Sets the height value.\n         * @private\n         */\n        get: function () {\n            return this.heightIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.heightIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(SelectedImageInfo.prototype, \"width\", {\n        /**\n         * Gets or Sets the width value.\n         * @private\n         */\n        get: function () {\n            return this.widthIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.widthIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return SelectedImageInfo;\n}());\nexport { SelectedImageInfo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo } from './base-history-info';\n/**\n * EditorHistory preservation class\n */\n/**\n * @private\n */\nvar HistoryInfo = /** @class */ (function (_super) {\n    __extends(HistoryInfo, _super);\n    function HistoryInfo(node, isChild) {\n        var _this = _super.call(this, node) || this;\n        _this.isChildHistoryInfo = false;\n        _this.isChildHistoryInfo = isChild;\n        return _this;\n    }\n    Object.defineProperty(HistoryInfo.prototype, \"hasAction\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return !isNullOrUndefined(this.modifiedActions);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * Adds the modified actions\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    HistoryInfo.prototype.addModifiedAction = function (baseHistoryInfo) {\n        // For complex actions such as Replace text, Insert/Remove Hyperlink etc.\n        if (!(this.editorHistory.isUndoing || this.editorHistory.isRedoing)) {\n            if (isNullOrUndefined(this.modifiedActions)) {\n                this.modifiedActions = [];\n            }\n            this.modifiedActions.push(baseHistoryInfo);\n        }\n    };\n    /**\n     * Reverts this instance\n     * @private\n     */\n    HistoryInfo.prototype.revert = function () {\n        this.editorHistory.currentHistoryInfo = this;\n        if (this.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            if (this.editorHistory.isUndoing) {\n                var i = this.modifiedActions.length;\n                while (i > 0) {\n                    var baseHistoryInfo = this.modifiedActions[i - 1];\n                    baseHistoryInfo.revert();\n                    i = i - 1;\n                }\n            }\n            else {\n                var i = 0;\n                while (i < this.modifiedActions.length) {\n                    var baseHistoryInfo = this.modifiedActions[i];\n                    baseHistoryInfo.revert();\n                    i = i + 1;\n                }\n            }\n        }\n        if (!this.isChildHistoryInfo) {\n            this.editorHistory.updateComplexHistory();\n        }\n        else {\n            this.editorHistory.updateComplexHistoryInternal();\n        }\n    };\n    /**\n     * @private\n     */\n    HistoryInfo.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.modifiedActions)) {\n            while (this.modifiedActions.length > 0) {\n                var baseHistoryInfo = this.modifiedActions[this.modifiedActions.length - 1];\n                baseHistoryInfo.destroy();\n                this.modifiedActions.splice(this.modifiedActions.indexOf(baseHistoryInfo), 1);\n            }\n            this.modifiedActions = undefined;\n        }\n        _super.prototype.destroy.call(this);\n    };\n    return HistoryInfo;\n}(BaseHistoryInfo));\nexport { HistoryInfo };\n","import { Dictionary } from '../../base/dictionary';\nimport { TextPosition } from '../selection/selection-helper';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { BaseHistoryInfo, } from './base-history-info';\nimport { ModifiedParagraphFormat, ModifiedLevel, RowHistoryFormat, TableHistoryInfo } from './history-helper';\nimport { HistoryInfo } from './history-info';\nimport { WParagraphFormat } from '../format/paragraph-format';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n *  `EditorHistory` Module class is used to handle history preservation\n */\nvar EditorHistory = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function EditorHistory(node) {\n        //Fields\n        this.undoStackIn = [];\n        this.redoStackIn = [];\n        this.historyInfoStack = [];\n        /**\n         * @private\n         */\n        this.isUndoing = false;\n        /**\n         * @private\n         */\n        this.isRedoing = false;\n        this.owner = node;\n        this.viewer = node.viewer;\n        this.modifiedParaFormats = new Dictionary();\n        this.undoLimitIn = 500;\n        this.redoLimitIn = 500;\n    }\n    Object.defineProperty(EditorHistory.prototype, \"currentHistoryInfo\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.historyInfoStack && this.historyInfoStack.length > 0 ?\n                this.historyInfoStack[this.historyInfoStack.length - 1] : undefined;\n        },\n        set: function (value) {\n            if (value instanceof HistoryInfo) {\n                this.historyInfoStack.push(value);\n            }\n            else {\n                this.historyInfoStack.pop();\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoStack\", {\n        //Properties\n        /**\n         * gets undo stack\n         * @private\n         */\n        get: function () { return this.undoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoStack\", {\n        /**\n         * gets redo stack\n         * @private\n         */\n        get: function () { return this.redoStackIn; },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"undoLimit\", {\n        /**\n         * Gets or Sets the limit of undo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.undoLimitIn) ? 0 : this.undoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.undoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(EditorHistory.prototype, \"redoLimit\", {\n        /**\n         * Gets or Sets the limit of redo operations can be done.\n         */\n        get: function () {\n            return isNullOrUndefined(this.redoLimitIn) ? 0 : this.redoLimitIn;\n        },\n        set: function (value) {\n            if (value < 0) {\n                throw new Error('The limit should be greater than or equal to zero.');\n            }\n            this.redoLimitIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    EditorHistory.prototype.getModuleName = function () {\n        return 'EditorHistory';\n    };\n    /**\n     * Determines whether undo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canUndo = function () {\n        return !isNullOrUndefined(this.undoStack) && this.undoStack.length > 0;\n    };\n    /**\n     * Determines whether redo operation can be done.\n     * @returns boolean\n     */\n    EditorHistory.prototype.canRedo = function () {\n        return !isNullOrUndefined(this.redoStack) && this.redoStack.length > 0;\n    };\n    //EditorHistory Initialization    \n    /**\n     * initialize EditorHistory\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @param  {SelectionRange} selectionRange\n     * @private\n     */\n    EditorHistory.prototype.initializeHistory = function (action) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.owner);\n        this.currentBaseHistoryInfo.action = action;\n        this.currentBaseHistoryInfo.updateSelection();\n    };\n    /**\n     * Initialize complex history\n     * @param  {Selection} selection\n     * @param  {Action} action\n     * @private\n     */\n    EditorHistory.prototype.initComplexHistory = function (selection, action) {\n        this.currentHistoryInfo = new HistoryInfo(selection.owner, !isNullOrUndefined(this.currentHistoryInfo));\n        this.currentHistoryInfo.action = action;\n        this.currentHistoryInfo.updateSelection();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.initResizingHistory = function (startingPoint, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            this.initializeHistory('RowResizing');\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                this.currentBaseHistoryInfo.modifiedProperties.push(new RowHistoryFormat(startingPoint, tableResize.currentResizingTable.childWidgets[tableResize.resizerPosition].rowFormat));\n            }\n        }\n        else {\n            this.initializeHistory('CellResizing');\n            if (this.currentBaseHistoryInfo) {\n                tableResize.currentResizingTable = tableResize.currentResizingTable.combineWidget(this.viewer);\n                var tableHistoryInfo = new TableHistoryInfo(tableResize.currentResizingTable, this.owner);\n                tableHistoryInfo.startingPoint = startingPoint;\n                this.currentBaseHistoryInfo.modifiedProperties.push(tableHistoryInfo);\n            }\n        }\n    };\n    /**\n     * Update resizing history\n     * @param  {Point} point\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateResizingHistory = function (point, tableResize) {\n        if (tableResize.resizeNode === 1) {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var rowHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (rowHistoryFormat.startingPoint.y === point.y) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    rowHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.y - rowHistoryFormat.startingPoint.y);\n                    this.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n        else {\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                var cellHistoryFormat = this.currentBaseHistoryInfo.modifiedProperties[0];\n                if (cellHistoryFormat.startingPoint.x === point.x) {\n                    this.currentBaseHistoryInfo.modifiedProperties.length = 0;\n                }\n                else {\n                    cellHistoryFormat.displacement = HelperMethods.convertPixelToPoint(point.x - cellHistoryFormat.startingPoint.x);\n                    cellHistoryFormat.endIndex = tableResize.getCellReSizerPosition(point);\n                    this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo);\n                    this.currentBaseHistoryInfo = undefined;\n                }\n            }\n        }\n    };\n    /**\n     * Record the changes\n     * @param  {BaseHistoryInfo} baseHistoryInfo\n     * @private\n     */\n    EditorHistory.prototype.recordChanges = function (baseHistoryInfo) {\n        if (!this.owner.enableHistoryMode) {\n            return;\n        }\n        if (this.isUndoing) {\n            if (isNullOrUndefined(this.redoStack)) {\n                this.redoStackIn = [];\n            }\n            if (this.redoStack.length === this.redoLimit && this.redoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.redoStackIn.splice(0, count);\n            }\n            if (this.redoStack.length < this.redoLimit) {\n                this.redoStack.push(baseHistoryInfo);\n            }\n        }\n        else {\n            if (!this.isRedoing) {\n                this.clearRedoStack();\n            }\n            if (isNullOrUndefined(this.undoStack)) {\n                this.undoStackIn = [];\n            }\n            if (this.undoStack.length === this.undoLimit && this.undoLimit > 0) {\n                var count = this.undoLimit > 20 ? 10 : 1;\n                this.undoStackIn.splice(0, count);\n            }\n            if (this.undoStack.length < this.undoLimit) {\n                this.undoStackIn.push(baseHistoryInfo);\n            }\n        }\n    };\n    /**\n     * update EditorHistory\n     * @private\n     */\n    EditorHistory.prototype.updateHistory = function () {\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentBaseHistoryInfo)) {\n            //Updates the current end position\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n                && isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)) {\n                this.currentBaseHistoryInfo.endPosition = this.currentBaseHistoryInfo.insertPosition;\n            }\n            if (!isNullOrUndefined(this.currentHistoryInfo)) {\n                this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentBaseHistoryInfo);\n            }\n            this.currentBaseHistoryInfo = undefined;\n        }\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.isHandledComplexHistory = function () {\n        var isHandledComplexHistory = false;\n        if (!(this.isUndoing || this.isRedoing)) {\n            isHandledComplexHistory = this.owner.editorModule.insertRemoveBookMarkElements();\n        }\n        if (this.viewer.owner.enableHistoryMode && !isNullOrUndefined(this.currentHistoryInfo)) {\n            this.updateHistory();\n            isHandledComplexHistory = true;\n        }\n        else if (this.owner.editorModule.isHandledComplex) {\n            isHandledComplexHistory = true;\n        }\n        return isHandledComplexHistory;\n    };\n    /**\n     * Update complex history\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistory = function () {\n        var selection = this.viewer.selection;\n        if (this.currentHistoryInfo.hasAction) {\n            if (this.currentHistoryInfo.action === 'AutoFormatHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                // this.reLayoutParagraph(startPosition.paragraph, 0);\n                if (selection.owner.editorHistory.isUndoing) {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.selectionStart);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.selectionEnd);\n                }\n                else {\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.start, this.currentHistoryInfo.endPosition);\n                    this.owner.editorModule.setPositionForCurrentIndex(selection.end, this.currentHistoryInfo.endPosition);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'InsertHyperlink') {\n                var startPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(startPosition, this.currentHistoryInfo.insertPosition);\n                var endPosition = new TextPosition(selection.owner);\n                this.owner.editorModule.setPositionForCurrentIndex(endPosition, this.currentHistoryInfo.endPosition);\n                this.viewer.layout.reLayoutParagraph(startPosition.paragraph, 0, 0);\n                if (endPosition.paragraph !== startPosition.paragraph) {\n                    this.viewer.layout.reLayoutParagraph(endPosition.paragraph, 0, 0);\n                }\n            }\n            if (this.currentHistoryInfo.action === 'ReplaceAll') {\n                this.owner.editorModule.layoutWholeDocument();\n            }\n            else if (selection.owner.isShiftingEnabled) {\n                this.viewer.layout.shiftLayoutedItems();\n                if (this.owner.enableHeaderAndFooter) {\n                    this.owner.editorModule.updateHeaderFooterWidget();\n                }\n                this.viewer.removeEmptyPages();\n            }\n        }\n        selection.owner.isShiftingEnabled = false;\n        selection.owner.isLayoutEnabled = true;\n        // // selection.addMultipleSelectionRanges();\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        this.viewer.updateScrollBars();\n        selection.fireSelectionChanged(true);\n        this.viewer.updateFocus();\n        this.updateComplexHistoryInternal();\n        this.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.updateComplexHistoryInternal = function () {\n        if (!isNullOrUndefined(this.currentHistoryInfo)) {\n            //Updates the current end position\n            if (isNullOrUndefined(this.currentHistoryInfo.endPosition)) {\n                this.currentHistoryInfo.endPosition = this.currentHistoryInfo.insertPosition;\n            }\n            if (this.historyInfoStack.length > 1) {\n                var historyInfo = this.historyInfoStack[this.historyInfoStack.length - 2];\n                historyInfo.addModifiedAction(this.currentHistoryInfo);\n            }\n            else {\n                this.recordChanges(this.currentHistoryInfo);\n            }\n            this.currentHistoryInfo = undefined;\n        }\n    };\n    //List history preservation undo API\n    /**\n     * update list changes for history preservation\n     * @param  {Selection} selection\n     * @param  {WAbstractList} currentAbstractList\n     * @param  {WList} list\n     * @private\n     */\n    EditorHistory.prototype.updateListChangesInHistory = function (currentAbstractList, list) {\n        this.currentBaseHistoryInfo = new BaseHistoryInfo(this.viewer.owner);\n        this.currentBaseHistoryInfo.action = 'List';\n        this.currentBaseHistoryInfo.updateSelection();\n        var collection = new Dictionary();\n        for (var i = 0; i < currentAbstractList.levels.length; i++) {\n            var levels = this.viewer.getAbstractListById(list.abstractListId).levels[i];\n            var value = this.currentBaseHistoryInfo.addModifiedPropertiesForList(levels);\n            var modifiedLevel = new ModifiedLevel(levels, currentAbstractList.levels[i]);\n            if (!isNullOrUndefined(levels)) {\n                this.viewer.owner.editorModule.copyListLevel(levels, currentAbstractList.levels[i]);\n            }\n            collection.add(i, modifiedLevel);\n        }\n        return collection;\n    };\n    /**\n     * Apply list changes\n     * @param  {Selection} selection\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedLevelsInternal\n     * @private\n     */\n    EditorHistory.prototype.applyListChanges = function (selection, modifiedLevelsInternal) {\n        if (isNullOrUndefined(this.modifiedParaFormats)) {\n            this.modifiedParaFormats = new Dictionary();\n        }\n        var collection = [];\n        for (var i = 0; i < this.viewer.listParagraphs.length; i++) {\n            var paragraph = this.viewer.listParagraphs[i];\n            var paraFormat = paragraph.paragraphFormat;\n            var currentList = this.viewer.getListById(paraFormat.listFormat.listId);\n            var listLevel = this.viewer.layout.getListLevel(currentList, paraFormat.listFormat.listLevelNumber);\n            // tslint:disable-next-line:max-line-length\n            if (modifiedLevelsInternal.containsKey(paraFormat.listFormat.listLevelNumber)\n                && modifiedLevelsInternal.get(paraFormat.listFormat.listLevelNumber).ownerListLevel === listLevel) {\n                var modifiedFormat = new WParagraphFormat(null);\n                modifiedFormat.leftIndent = paraFormat.leftIndent;\n                modifiedFormat.firstLineIndent = paraFormat.firstLineIndent;\n                var modified = new ModifiedParagraphFormat(paraFormat, modifiedFormat);\n                collection.push(modified);\n                this.owner.editorModule.copyFromListLevelParagraphFormat(paraFormat, listLevel.paragraphFormat);\n            }\n        }\n        this.modifiedParaFormats.add(this.currentBaseHistoryInfo, collection);\n    };\n    /**\n     * Update list changes\n     * @param  {Dictionary<number, ModifiedLevel>} modifiedCollection\n     * @param  {Selection} selection\n     * @private\n     */\n    EditorHistory.prototype.updateListChanges = function (modifiedCollection) {\n        this.viewer.owner.isLayoutEnabled = false;\n        this.owner.editorModule.updateListParagraphs();\n        for (var i = 0; i < modifiedCollection.keys.length; i++) {\n            var levelNumber = modifiedCollection.keys[0];\n            var modifiedLevel = modifiedCollection.get(levelNumber);\n            if (!isNullOrUndefined(this.currentBaseHistoryInfo)) {\n                // tslint:disable-next-line:max-line-length\n                modifiedLevel = this.currentBaseHistoryInfo.addModifiedPropertiesForList(modifiedLevel.ownerListLevel);\n            }\n            this.owner.editorModule.copyListLevel(modifiedLevel.ownerListLevel, modifiedLevel.modifiedListLevel);\n        }\n        this.revertListChanges();\n        this.viewer.owner.isLayoutEnabled = true;\n        this.viewer.renderedLists.clear();\n        this.viewer.pages = [];\n        this.viewer.layout.layout();\n        var selection = this.viewer.selection;\n        selection.start.updatePhysicalPosition(true);\n        if (selection.isEmpty) {\n            selection.end.setPositionInternal(selection.start);\n        }\n        else {\n            selection.end.updatePhysicalPosition(true);\n        }\n        selection.upDownSelectionLength = selection.end.location.x;\n        selection.fireSelectionChanged(false);\n        this.updateHistory();\n    };\n    /**\n     * Revert list changes\n     * @param  {Selection} selection\n     */\n    EditorHistory.prototype.revertListChanges = function () {\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(this.currentBaseHistoryInfo)\n            && this.viewer.owner.editorHistory.modifiedParaFormats.containsKey(this.currentBaseHistoryInfo)) {\n            // tslint:disable-next-line:max-line-length\n            var collection = this.modifiedParaFormats.get(this.currentBaseHistoryInfo);\n            for (var i = 0; i < collection.length; i++) {\n                var modified = new WParagraphFormat(null);\n                modified.leftIndent = collection[i].ownerFormat.leftIndent;\n                modified.firstLineIndent = collection[i].ownerFormat.firstLineIndent;\n                collection[i].ownerFormat.copyFormat(collection[i].modifiedFormat);\n                collection[i].modifiedFormat.leftIndent = modified.leftIndent;\n                collection[i].modifiedFormat.firstLineIndent = modified.firstLineIndent;\n            }\n        }\n    };\n    /**\n     * Reverts the last editing action.\n     */\n    EditorHistory.prototype.undo = function () {\n        if (this.owner.isReadOnlyMode || !this.canUndo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.undoStack.pop();\n        this.isUndoing = true;\n        historyInfo.revert();\n        this.isUndoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * Performs the last reverted action.\n     */\n    EditorHistory.prototype.redo = function () {\n        if (this.owner.isReadOnlyMode || !this.canRedo() || !this.owner.enableHistoryMode) {\n            return;\n        }\n        //this.owner.ClearTextSearchResults();\n        var historyInfo = this.redoStack.pop();\n        if (historyInfo.action === 'BordersAndShading') {\n            this.owner.editorModule.isBordersAndShadingDialog = true;\n        }\n        this.isRedoing = true;\n        historyInfo.revert();\n        this.isRedoing = false;\n        this.owner.selection.checkForCursorVisibility();\n        this.owner.editorModule.isBordersAndShadingDialog = false;\n    };\n    /**\n     * @private\n     */\n    EditorHistory.prototype.destroy = function () {\n        this.clearHistory();\n        this.undoStackIn = undefined;\n        this.redoStackIn = undefined;\n    };\n    EditorHistory.prototype.clearHistory = function () {\n        this.clearUndoStack();\n        this.clearRedoStack();\n    };\n    EditorHistory.prototype.clearUndoStack = function () {\n        if (this.canUndo()) {\n            while (this.undoStack.length > 0) {\n                var historyInfo = this.undoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    EditorHistory.prototype.clearRedoStack = function () {\n        if (this.canRedo()) {\n            while (this.redoStack.length > 0) {\n                var historyInfo = this.redoStack.pop();\n                historyInfo.destroy();\n                historyInfo = undefined;\n            }\n        }\n    };\n    return EditorHistory;\n}());\nexport { EditorHistory };\n","import { ZipArchive, ZipArchiveItem } from '@syncfusion/ej2-compression';\nimport { XmlWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Dictionary } from '../../index';\n/**\n * Exports the document to Word format.\n */\nvar WordExport = /** @class */ (function () {\n    function WordExport() {\n        //Part path\n        this.documentPath = 'word/document.xml';\n        this.stylePath = 'word/styles.xml';\n        this.numberingPath = 'word/numbering.xml';\n        this.settingsPath = 'word/settings.xml';\n        this.headerPath = 'word/header';\n        this.footerPath = 'word/footer';\n        //private commentsPath: string = 'word/comments.xml';\n        this.imagePath = 'word/media/image';\n        // private footnotesPath: string = 'word/footnotes.xml';\n        // private endnotesPath: string = 'word/endnotes.xml';\n        this.appPath = 'docProps/app.xml';\n        this.corePath = 'docProps/core.xml';\n        // private CustomPath: string = 'docProps/custom.xml';\n        // private FontTablePath: string = 'word/fontTable.xml';\n        this.contentTypesPath = '[Content_Types].xml';\n        // private ChartsPath: string = 'word/charts/';\n        // private DefaultEmbeddingPath: string = 'word/embeddings/';\n        // private EmbeddingPath:string = 'word\\embeddings\\';\n        // private DrawingPath:string = 'word\\drawings\\';\n        // private ThemePath: string = 'word/theme/theme1.xml';\n        // private FontsPath:string = 'word\\fonts\\';\n        // private DiagramPath:string = \"word/diagrams/';\n        // private ControlPath:string = \"word/activeX/';\n        // private VbaProject: string = 'vbaProject.bin';\n        // private VbaData: string = 'vbaData.xml';\n        // private VbaProjectPath: string = 'word/vbaProject.bin';\n        // private VbaDataPath: string = 'word/vbaData.xml';\n        // private CustomXMLPath:string = 'customXml\\';\n        //Relationship path\n        this.generalRelationPath = '_rels/.rels';\n        this.wordRelationPath = 'word/_rels/document.xml.rels';\n        // private FontRelationPath: string = 'word/_rels/fontTable.xml.rels';\n        // private CommentsRelationPath: string = 'word/_rels/comments.xml.rels';\n        // private FootnotesRelationPath: string = 'word/_rels/footnotes.xml.rels';\n        // private EndnotesRelationPath: string = 'word/_rels/endnotes.xml.rels';\n        // private NumberingRelationPath: string = 'word/_rels/numbering.xml.rels';\n        this.headerRelationPath = 'word/_rels/header';\n        this.footerRelationPath = 'word/_rels/footer';\n        // private SettingsRelationpath: string = 'word/_rels/settings.xml.rels';\n        // private VbaProjectRelsPath: string = 'word/_rels/vbaProject.bin.rels';\n        //Content type of the parts\n        this.xmlContentType = 'application/xml';\n        this.fontContentType = 'application/vnd.openxmlformats-officedocument.obfuscatedFont';\n        this.documentContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml';\n        // private TemplateContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml';\n        // private CommentsContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml';\n        this.settingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml';\n        // private EndnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml';\n        // private FontTableContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml';\n        this.footerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml';\n        // private FootnoteContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml';\n        // private GlossaryDocumentContentType: string = 'application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml';\n        this.headerContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml';\n        this.numberingContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml';\n        this.stylesContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml';\n        this.webSettingsContentType = 'application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml';\n        this.appContentType = 'application/vnd.openxmlformats-officedocument.extended-properties+xml';\n        this.coreContentType = 'application/vnd.openxmlformats-package.core-properties+xml';\n        this.customContentType = 'application/vnd.openxmlformats-officedocument.custom-properties+xml';\n        this.customXmlContentType = 'application/vnd.openxmlformats-officedocument.customXmlProperties+xml';\n        this.relationContentType = 'application/vnd.openxmlformats-package.relationships+xml';\n        // private DiagramColor: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml';\n        // private DiagramData: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml';\n        // private DiagramLayout: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml';\n        // private DiagramStyle: string = 'application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml';\n        // private ChartsContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chart+xml';\n        // private ThemeContentType: string = 'application/vnd.openxmlformats-officedocument.theme+xml';\n        // private ChartDrawingContentType: string = 'application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml';\n        // private ActiveXContentType: string = 'application/vnd.ms-office.activeX+xml';\n        // private ActiveXBinContentType: string = 'application/vnd.ms-office.activeX';\n        this.tableStyleContentType = 'application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml';\n        // private ChartStyleContentType: string = 'application/vnd.ms-office.chartstyle+xml';\n        // private ChartColorStyleContentType: string = 'application/vnd.ms-office.chartcolorstyle+xml';\n        // private VbaProjectContentType: string = 'application/vnd.ms-office.vbaProject';\n        // private VbaDataContentType: string = 'application/vnd.ms-word.vbaData+xml';\n        // private MacroDocumentContentType: string = 'application/vnd.ms-word.document.macroEnabled.main+xml';\n        // private MacroTemplateContentType: string = 'application/vnd.ms-word.template.macroEnabledTemplate.main+xml';\n        // private OleObjectContentType: string = 'application/vnd.openxmlformats-officedocument.oleObject';\n        // Relationship types of document parts\n        // private AltChunkRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk';\n        // private CommentsRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments';\n        this.settingsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings';\n        // private EndnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/endnotes';\n        // private FontTableRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/fontTable';\n        this.footerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer';\n        // private FootnoteRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes';\n        this.headerRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/header';\n        this.documentRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument';\n        this.numberingRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering';\n        this.stylesRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles';\n        // private OleObjectRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/oleObject';\n        // private ChartRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart';\n        // private ThemeRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme';\n        this.fontRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/font';\n        this.tableStyleRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles';\n        this.coreRelType = 'http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties';\n        this.appRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties';\n        this.customRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties';\n        this.imageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/image';\n        this.hyperlinkRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink';\n        this.controlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/control';\n        this.packageRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // private VbaProjectRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/vbaProject';\n        // private VbaDataRelType: string = 'http://schemas.microsoft.com/office/2006/relationships/wordVbaData';\n        this.customXmlRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml';\n        this.customUIRelType = 'http://schemas.microsoft.com/office/2006/relationships/ui/extensibility';\n        this.attachedTemplateRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate';\n        // private ChartColorStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartColorStyle';\n        // private ChartStyleRelType: string = 'http://schemas.microsoft.com/office/2011/relationships/chartStyle';\n        // private ChartUserShapesRelType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartUserShapes';\n        // private ChartContentType: string = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/package';\n        // Namespaces\n        // private PKG_namespace: string = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.wNamespace = 'http://schemas.openxmlformats.org/wordprocessingml/2006/main';\n        this.wpNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing';\n        this.pictureNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/picture';\n        this.aNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/main';\n        this.a14Namespace = 'http://schemas.microsoft.com/office/drawing/2010/main';\n        // private SVG_namespace: string = 'http://schemas.microsoft.com/office/drawing/2016/SVG/main';\n        this.rNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships';\n        this.rpNamespace = 'http://schemas.openxmlformats.org/package/2006/relationships';\n        this.vNamespace = 'urn:schemas-microsoft-com:vml';\n        this.oNamespace = 'urn:schemas-microsoft-com:office:office';\n        this.xmlNamespace = 'http://www.w3.org/XML/1998/namespace';\n        this.w10Namespace = 'urn:schemas-microsoft-com:office:word';\n        this.cpNamespace = 'http://schemas.openxmlformats.org/package/2006/metadata/core-properties';\n        this.dcNamespace = 'http://purl.org/dc/elements/1.1/';\n        // private DCTERMS_namespace: string = 'http://purl.org/dc/terms/';\n        // private XSI_namespace: string = 'http://www.w3.org/2001/XMLSchema-instance';\n        this.docPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/extended-properties';\n        this.veNamespace = 'http://schemas.openxmlformats.org/markup-compatibility/2006';\n        this.mNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/math';\n        this.wneNamespace = 'http://schemas.microsoft.com/office/word/2006/wordml';\n        // private DCMI_namespace: string = 'http://purl.org/dc/dcmitype/';\n        this.customPropsNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/custom-properties';\n        this.vtNamespace = 'http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes';\n        this.chartNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/chart';\n        this.slNamespace = 'http://schemas.openxmlformats.org/schemaLibrary/2006/main';\n        //2003WML namespace\n        // private amlNamespace: string = 'http://schemas.microsoft.com/aml/2001/core';\n        this.dtNamespace = 'uuid:C2F41010-65B3-11d1-A29F-00AA00C14882';\n        this.wmlNamespace = 'http://schemas.microsoft.com/office/word/2003/wordml';\n        //2010 namespaces\n        this.w14Namespace = 'http://schemas.microsoft.com/office/word/2010/wordml';\n        this.wpCanvasNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas';\n        this.wpDrawingNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing';\n        this.wpGroupNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingGroup';\n        this.wpInkNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingInk';\n        this.wpShapeNamespace = 'http://schemas.microsoft.com/office/word/2010/wordprocessingShape';\n        //2013 namespaces\n        this.w15Namespace = 'http://schemas.microsoft.com/office/word/2012/wordml';\n        this.diagramNamespace = 'http://schemas.openxmlformats.org/drawingml/2006/diagram';\n        //Encryption namespaces\n        this.eNamespace = 'http://schemas.microsoft.com/office/2006/encryption';\n        this.pNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/password';\n        this.certNamespace = 'http://schemas.microsoft.com/office/2006/keyEncryptor/certificate';\n        // Dls xml tags\n        this.cRelationshipsTag = 'Relationships';\n        this.cRelationshipTag = 'Relationship';\n        this.cIdTag = 'Id';\n        this.cTypeTag = 'Type';\n        this.cTargetTag = 'Target';\n        this.cUserShapesTag = 'userShapes';\n        this.cExternalData = 'externalData';\n        this.twipsInOnePoint = 20;\n        this.twentiethOfPoint = 20;\n        this.borderMultiplier = 8;\n        this.percentageFactor = 50;\n        this.emusPerPoint = 12700;\n        // private const TOC_SYMBOL:string = (char)0x01;\n        // private const FOOTNOTE_SYMBOL:string = (char)0x02;\n        // private const PAGENUMBER_SYMBOL:string = (char)0xB;\n        // private DEF_FIT_TEXT_TO_SHAPE: string = 'mso-fit-shape-to-text:t';\n        // Document tags\n        this.cConditionalTableStyleTag = 'tblStylePr';\n        this.cTableFormatTag = 'tblPr';\n        this.cTowFormatTag = 'trPr';\n        this.cCellFormatTag = 'tcPr';\n        this.cParagraphFormatTag = 'pPr';\n        this.cCharacterFormatTag = 'rPr';\n        this.packageType = 'http://schemas.microsoft.com/office/2006/xmlPackage';\n        this.relsPartPath = '/_rels/.rels';\n        this.documentRelsPartPath = '/word/_rels/document.xml.rels';\n        this.webSettingsPath = '/word/webSettings.xml';\n        this.wordMLDocumentPath = '/word/document.xml';\n        this.wordMLStylePath = '/word/styles.xml';\n        this.wordMLNumberingPath = '/word/numbering.xml';\n        this.wordMLSettingsPath = '/word/settings.xml';\n        this.wordMLHeaderPath = '/word/header';\n        this.wordMLFooterPath = '/word/footer';\n        this.wordMLCommentsPath = '/word/comments.xml';\n        this.wordMLImagePath = '/word/media/image';\n        this.wordMLFootnotesPath = '/word/footnotes.xml';\n        this.wordMLEndnotesPath = '/word/endnotes.xml';\n        this.wordMLAppPath = '/docProps/app.xml';\n        this.wordMLCorePath = '/docProps/core.xml';\n        this.wordMLCustomPath = '/docProps/custom.xml';\n        this.wordMLFontTablePath = '/word/fontTable.xml';\n        this.wordMLChartsPath = '/word/charts/';\n        this.wordMLDefaultEmbeddingPath = '/word/embeddings/';\n        this.wordMLEmbeddingPath = '/word/embeddings/';\n        this.wordMLDrawingPath = '/word/drawings/';\n        this.wordMLThemePath = '/word/theme/theme1.xml';\n        this.wordMLFontsPath = '/word/fonts/';\n        this.wordMLDiagramPath = '/word/diagrams/';\n        this.wordMLControlPath = '/word/activeX/';\n        this.wordMLVbaProject = '/vbaProject.bin';\n        this.wordMLVbaData = '/vbaData.xml';\n        this.wordMLVbaProjectPath = '/word/vbaProject.bin';\n        this.wordMLVbaDataPath = '/word/vbaData.xml';\n        // private WordMLCustomXMLPath: string = '/customXml/';\n        this.wordMLWebSettingsPath = '/word/webSettings.xml';\n        this.wordMLCustomItemProp1Path = '/customXml/itemProps1.xml';\n        // private WordMLCustomXMLRelPath: string = '/customXml/_rels/item1.xml.rels';\n        this.wordMLFootnoteRelPath = '/word/_rels/footnotes.xml.rels';\n        this.wordMLEndnoteRelPath = '/word/_rels/endnotes.xml.rels';\n        this.wordMLSettingsRelPath = '/word/_rels/settings.xml.rels';\n        this.wordMLNumberingRelPath = '/word/_rels/numbering.xml.rels';\n        this.wordMLFontTableRelPath = '/word/_rels/fontTable.xml.rels';\n        this.wordMLCustomXmlPropsRelType = 'http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps';\n        this.wordMLControlRelType = 'http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary';\n        this.wordMLDiagramContentType = 'application/vnd.ms-office.drawingml.diagramDrawing+xml';\n        this.lastSection = false;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        this.mBookmarks = undefined;\n        /* tslint:enable:no-any */\n    }\n    WordExport.prototype.getModuleName = function () {\n        return 'WordExport';\n    };\n    Object.defineProperty(WordExport.prototype, \"bookmarks\", {\n        // Gets the bookmark name\n        get: function () {\n            if (isNullOrUndefined(this.mBookmarks)) {\n                this.mBookmarks = [];\n            }\n            return this.mBookmarks;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"documentImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mDocumentImages === undefined) {\n                this.mDocumentImages = new Dictionary();\n            }\n            return this.mDocumentImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"externalImages\", {\n        // Gets the collection of images present in the document body\n        get: function () {\n            if (this.mExternalLinkImages === undefined) {\n                this.mExternalLinkImages = new Dictionary();\n            }\n            return this.mExternalLinkImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headerFooterImages\", {\n        // Gets the collections of images present in the HeaderFooters\n        get: function () {\n            if (this.mHeaderFooterImages === undefined) {\n                this.mHeaderFooterImages = new Dictionary();\n            }\n            return this.mHeaderFooterImages;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(WordExport.prototype, \"headersFooters\", {\n        /// Gets the HeaderFooter Collection\n        get: function () {\n            if (this.mHeaderFooterColl === undefined) {\n                this.mHeaderFooterColl = new Dictionary();\n            }\n            return this.mHeaderFooterColl;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    WordExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        this.mArchive.save(fileName + '.docx').then(function (mArchive) {\n            mArchive.destroy();\n        });\n        this.close();\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.saveAsBlob = function (viewer) {\n        var _this = this;\n        this.serialize(viewer);\n        return new Promise(function (resolve, reject) {\n            _this.mArchive.saveAsBlob().then(function (blob) {\n                _this.mArchive.destroy();\n                blob = new Blob([blob], { type: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' });\n                resolve(blob);\n            });\n        });\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.destroy = function () {\n        this.clearDocument();\n        this.mRelationShipID = undefined;\n        this.mDocPrID = undefined;\n        this.mDifferentFirstPage = undefined;\n        if (this.mArchive) {\n            this.mArchive.destroy();\n            this.mArchive = undefined;\n        }\n    };\n    // Saves the word document in the stream\n    WordExport.prototype.serialize = function (viewer) {\n        /* tslint:disable:no-any */\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n        this.mArchive = new ZipArchive();\n        this.mArchive.compressionLevel = 'Normal';\n        this.mVerticalMerge = new Dictionary();\n        this.mGridSpans = new Dictionary();\n        var contenttype;\n        //document.xml\n        this.serializeDocument();\n        //Styles.xml\n        this.serializeStyles();\n        //numbering.xml\n        this.serializeNumberings();\n        //theme.xml\n        // if (m_document.DocHasThemes && !isNullOrUndefined(m_document.Themes))\n        //     SerializeThemes();\n        // else\n        // this.serializeDefaultThemes();\n        //settings.xml\n        this.serializeSettings();\n        //core.xml\n        this.serializeCoreProperties();\n        //app.xml\n        this.serializeAppProperties();\n        //fontTable.xml\n        this.serializeFontTable(contenttype);\n        //custom.xml\n        // if (!isNullOrUndefined(this.wordDocument.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0) {\n        //     SerializeCustomProperties();\n        // }\n        //Settings Relations\n        this.serializeSettingsRelation();\n        //Numbering relation if the document has picture bullet\n        // if (PictureBullets.length > 0) {\n        //     SerializeNumberingsRelation();\n        // }\n        this.serializeHeaderFooters();\n        //document relations\n        this.serializeDocumentRelations();\n        // // Add controls to archieve.\n        // if (ControlsPathNames.length > 0) {\n        //     AddControlsToZip(m_document.DocxPackage);\n        // }\n        // if (!isNullOrUndefined(m_document.CustomUIPartContainer))\n        //     AddPartContainerToArchive(m_document.CustomUIPartContainer);\n        // if (!isNullOrUndefined(m_document.CustomXMLContainer))\n        //     AddPartContainerToArchive(m_document.CustomXMLContainer);\n        //general relations\n        this.serializeGeneralRelations();\n        //[ContentTypes].xml\n        this.serializeContentTypes(contenttype);\n        // Clears the internal fields maintained for serializing.\n        this.clearDocument();\n    };\n    // Sets the document\n    WordExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n        this.mLists = document.lists;\n        this.mAbstractLists = document.abstractLists;\n        this.defCharacterFormat = document.characterFormat;\n        this.defParagraphFormat = document.paragraphFormat;\n        this.defaultTabWidthValue = document.defaultTabWidth;\n        this.mStyles = document.styles;\n    };\n    // Clears the document\n    WordExport.prototype.clearDocument = function () {\n        // Owner Nodes\n        this.section = undefined;\n        this.lastSection = undefined;\n        this.blockOwner = undefined;\n        this.paragraph = undefined;\n        this.table = undefined;\n        this.row = undefined;\n        this.headerFooter = undefined;\n        this.document = undefined;\n        this.mSections = undefined;\n        this.mLists = undefined;\n        this.mAbstractLists = undefined;\n        this.defCharacterFormat = undefined;\n        this.defParagraphFormat = undefined;\n        this.defaultTabWidthValue = undefined;\n        this.mRelationShipID = 0;\n        this.mDocPrID = 0;\n        this.mDifferentFirstPage = false;\n        if (this.mHeaderFooterColl) {\n            this.mHeaderFooterColl.destroy();\n            this.mHeaderFooterColl = undefined;\n        }\n        if (this.mVerticalMerge) {\n            this.mVerticalMerge.destroy();\n            this.mVerticalMerge = undefined;\n        }\n        if (this.mGridSpans) {\n            this.mGridSpans.destroy();\n            this.mGridSpans = undefined;\n        }\n        if (this.mDocumentImages) {\n            this.mDocumentImages.destroy();\n            this.mDocumentImages = undefined;\n        }\n        if (this.mExternalLinkImages) {\n            this.mExternalLinkImages.destroy();\n            this.mExternalLinkImages = undefined;\n        }\n        if (this.mHeaderFooterImages) {\n            this.mHeaderFooterImages.destroy();\n            this.mHeaderFooterImages = undefined;\n        }\n    };\n    // Serializes the document elements (document.xml)\n    WordExport.prototype.serializeDocument = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'document', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        this.serializeDocumentBody(writer);\n        writer.writeEndElement(); //end of document tag\n        var archiveItem = new ZipArchiveItem(writer.buffer, this.documentPath);\n        this.mArchive.addItem(archiveItem);\n    };\n    WordExport.prototype.writeCommonAttributeStrings = function (writer) {\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        this.writeCustom(writer);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    WordExport.prototype.writeDup = function (writer) {\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'wpg', undefined, this.wpGroupNamespace);\n        writer.writeAttributeString('xmlns', 'wpi', undefined, this.wpInkNamespace);\n    };\n    WordExport.prototype.writeCustom = function (writer) {\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n    };\n    // Serializes the document body\n    WordExport.prototype.serializeDocumentBody = function (writer) {\n        writer.writeStartElement(undefined, 'body', this.wNamespace);\n        var count = this.document.sections.length;\n        for (var i = 0; i < count; i++) {\n            this.section = this.document.sections[i];\n            this.lastSection = i === count - 1;\n            this.serializeSection(writer, this.section, i === count - 1);\n            this.section = undefined;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the Section.\n    WordExport.prototype.serializeSection = function (writer, section, last) {\n        this.blockOwner = section;\n        this.serializeBodyItems(writer, section.blocks, last);\n        if (last) {\n            this.serializeSectionProperties(writer, section);\n        }\n        this.blockOwner = undefined;\n    };\n    // Serialize the section properties.\n    WordExport.prototype.serializeSectionProperties = function (writer, section) {\n        writer.writeStartElement('w', 'sectPr', this.wNamespace);\n        if (section.headersFooters) {\n            this.serializeHFReference(writer, section.headersFooters);\n        }\n        // if (IsNeedToSerializeSectionFootNoteProperties(section))\n        //     SerializeFootnoteProperties(section);\n        // if (IsNeedToSerializeSectionEndNoteProperties(section))\n        //     SerializeEndnoteProperties(section);\n        this.serializeSectionType(writer, 'nextPage');\n        this.serializePageSetup(writer, section.sectionFormat);\n        this.serializeColumns(writer, section);\n        // this.serializeSectionProtection(section);\n        // if (section.PageSetup.VerticalAlignment !== PageAlignment.Top) {\n        //     writer.writeStartElement('vAlign', this.wNamespace);\n        //     switch (section.PageSetup.VerticalAlignment) {\n        //         case PageAlignment.Top:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'top');\n        //             break;\n        //         case PageAlignment.Middle:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'center');\n        //             break;\n        //         case PageAlignment.Justified:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'both');\n        //             break;\n        //         case PageAlignment.Bottom:\n        //             writer.WriteAttributeString('val', this.wNamespace, 'bottom');\n        //             break;\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        if (section.sectionFormat !== undefined && section.sectionFormat.differentFirstPage) {\n            writer.writeStartElement(undefined, 'titlePg', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // SerializeTextDirection(section);\n        // if (section.PageSetup.Bidi) {\n        //     writer.WriteStartElement('bidi', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        //rtlGutter\n        // SerializeDocGrid(section);\n        //printerSettings\n        writer.writeEndElement(); //end of sectPr tag\n    };\n    // Serialize the column properties of section.\n    WordExport.prototype.serializeColumns = function (writer, section) {\n        writer.writeStartElement(undefined, 'cols', this.wNamespace);\n        writer.writeAttributeString(undefined, 'equalWidth', this.wNamespace, '1');\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, '0');\n        writer.writeEndElement();\n        // ColumnCollection columns = section.Columns;\n        // writer.WriteStartElement('cols', this.wNamespace);\n        // if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('num', this.wNamespace, columns.length.ToString());\n        // }\n        // if (section.PageSetup.DrawLinesBetweenCols)\n        //     writer.WriteAttributeString('sep', this.wNamespace, '1');\n        // if (columns.OwnerSection.PageSetup.EqualColumnWidth)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '1');\n        //     //When the column count is negative, MS word just reset the column's count to zero\n        //     //To avoid index out of exception, checked the columns count\n        // tslint:disable-next-line:max-line-length\n        //     writer.WriteAttributeString('space', this.wNamespace, ToString(columns.length > 0 ? columns[0].Space * this.TwentiethOfPoint : 0));\n        // }\n        // else if (columns.length > 0)\n        // {\n        //     writer.WriteAttributeString('equalWidth', this.wNamespace, '0');\n        //     foreach (Column column in columns)\n        //     {\n        //         writer.WriteStartElement('col', this.wNamespace);\n        //         writer.WriteAttributeString('w', this.wNamespace, ToString(column.Width * this.TwentiethOfPoint));\n        // tslint:disable-next-line:max-line-length\n        //         writer.WriteAttributeString('space', this.wNamespace, ToString(column.Space * this.TwentiethOfPoint));\n        //         writer.WriteEndElement();\n        //     }\n        // }\n        // writer.WriteEndElement();\n    };\n    // Serialize the page setup properties.\n    WordExport.prototype.serializePageSetup = function (writer, pageSetup) {\n        if (pageSetup !== undefined) {\n            this.serializePageSize(writer, pageSetup);\n            this.serializePageMargins(writer, pageSetup);\n        }\n        // // StartElement paperSrc (if any)\n        // if (pageSetup.FirstPageTray > 0 || pageSetup.OtherPagesTray > 0) {\n        //     writer.WriteStartElement('paperSrc', this.wNamespace);\n        //     if (pageSetup.FirstPageTray > 0) {\n        //         writer.WriteAttributeString('first', this.wNamespace, pageSetup.FirstPageTray.ToString());\n        //     }\n        //     if (pageSetup.OtherPagesTray > 0) {\n        //         writer.WriteAttributeString('other', this.wNamespace, pageSetup.OtherPagesTray.ToString());\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pgBorders', this.wNamespace);\n        // //zOrder\n        // if (pageSetup.PageBordersApplyType === PageBordersApplyType.FirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'firstPage');\n        // else if (pageSetup.PageBordersApplyType === PageBordersApplyType.AllExceptFirstPage)\n        //     writer.WriteAttributeString('display', this.wNamespace, 'notFirstPage');\n        // if (pageSetup.PageBorderOffsetFrom === PageBorderOffsetFrom.PageEdge) {\n        //     writer.WriteAttributeString('offsetFrom', this.wNamespace, 'page');\n        // }\n        // //Serializing zOrder of the front page border\n        // if (!pageSetup.IsFrontPageBorder) {\n        //     writer.WriteAttributeString('zOrder', this.wNamespace, 'back');\n        // }\n        // SerializePageBorders(pageSetup.Borders);\n        writer.writeEndElement();\n        // this.serializeLineNumberType(writer, pageSetup);\n        //this.serializePageNumberType(writer, pageSetup);\n    };\n    // serialize the page size\n    WordExport.prototype.serializePageSize = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgSz', this.wNamespace);\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageWidth * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'h', this.wNamespace, this.roundToTwoDecimal(pageSetup.pageHeight * this.twentiethOfPoint).toString());\n        // if (pageSetup.Orientation === PageOrientation.Landscape)\n        // {\n        //     writer.WriteAttributeString('orient', this.wNamespace, 'landscape');\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the border.\n    WordExport.prototype.serializePageMargins = function (writer, pageSetup) {\n        writer.writeStartElement(undefined, 'pgMar', this.wNamespace);\n        var marginValue = Math.round(pageSetup.topMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'top', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.rightMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'right', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.bottomMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'bottom', this.wNamespace, marginValue.toString());\n        marginValue = Math.round(pageSetup.leftMargin * this.twentiethOfPoint);\n        writer.writeAttributeString(undefined, 'left', this.wNamespace, marginValue.toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'header', this.wNamespace, this.roundToTwoDecimal(pageSetup.headerDistance * this.twentiethOfPoint).toString());\n        // tslint:disable-next-line:max-line-length\n        writer.writeAttributeString(undefined, 'footer', this.wNamespace, this.roundToTwoDecimal(pageSetup.footerDistance * this.twentiethOfPoint).toString());\n        writer.writeAttributeString(undefined, 'gutter', this.wNamespace, '0');\n        writer.writeEndElement();\n    };\n    // Serialize the section type.\n    WordExport.prototype.serializeSectionType = function (writer, sectionBreakCode) {\n        writer.writeStartElement('w', 'type', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, sectionBreakCode); //GetSectionBreakCode(sectionBreakCode));\n        writer.writeEndElement();\n    };\n    // Serialize the heeader/footer reference.\n    WordExport.prototype.serializeHFReference = function (writer, headersFooters) {\n        var hfId = '';\n        if (headersFooters !== undefined) {\n            this.mDifferentFirstPage = this.section.sectionFormat.differentOddAndEvenPages;\n            var hf = headersFooters.firstPageHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.firstPageFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'first');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'FirstPageFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenHeader;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.evenFooter;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'even');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'EvenFooter', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.header;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'headerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddHeader', hfId);\n                writer.writeEndElement();\n            }\n            hf = headersFooters.footer;\n            if (hf && hf.blocks && hf.blocks.length > 0) {\n                writer.writeStartElement(undefined, 'footerReference', this.wNamespace);\n                writer.writeAttributeString(undefined, 'type', this.wNamespace, 'default');\n                hfId = this.getNextRelationShipID();\n                writer.writeAttributeString(undefined, 'id', this.rNamespace, hfId);\n                this.addHeaderFooter(hf, 'OddFooter', hfId);\n                writer.writeEndElement();\n            }\n        }\n    };\n    // Adds the header footer details to the collection.\n    WordExport.prototype.addHeaderFooter = function (hf, hfType, id) {\n        var hfColl = new Dictionary();\n        this.headersFooters.add(hfType, hfColl);\n        this.headersFooters.get(hfType).add(id, hf);\n    };\n    // Serializes the bodyItems\n    WordExport.prototype.serializeBodyItems = function (writer, blockCollection, isLastSection) {\n        for (var i = 0; i < blockCollection.length; i++) {\n            this.serializeBodyItem(writer, blockCollection[i], isLastSection);\n        }\n    };\n    // Serialize the TextBody item\n    WordExport.prototype.serializeBodyItem = function (writer, item, isLastSection) {\n        if (isNullOrUndefined(item)) {\n            throw new Error('BodyItem should not be undefined');\n        }\n        if (item.hasOwnProperty('inlines')) {\n            this.paragraph = item;\n            this.serializeParagraph(writer, item, isLastSection);\n            this.paragraph = undefined;\n        }\n        else {\n            var table = item;\n            for (var i = 0; i < table.rows.length; i++) {\n                if (table.rows[i].cells.length > 0) {\n                    this.serializeTable(writer, table);\n                    break;\n                }\n            }\n        }\n    };\n    // Serialize the paragraph\n    WordExport.prototype.serializeParagraph = function (writer, paragraph, isLastSection) {\n        if (isNullOrUndefined(paragraph)) {\n            throw new Error('Paragraph should not be undefined');\n        }\n        var sec = this.blockOwner;\n        //Need to write the Section Properties if the Paragraph is last item in the section\n        if (!isLastSection && sec.hasOwnProperty('sectionFormat')\n            && sec.blocks.indexOf(paragraph) === sec.blocks.length - 1) {\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeSectionProperties(writer, sec);\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n        // if (paragraph.ParagraphFormat.PageBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.PageBreak);\n        // if (paragraph.ParagraphFormat.ColumnBreakAfter && !IsPageBreakNeedToBeSkipped(paragraph as Entity))\n        //     paragraph.InsertBreak(BreakType.ColumnBreak);\n        //Splits the paragraph based on the newline character\n        // paragraph.SplitTextRange();\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, paragraph.paragraphFormat, paragraph);\n        writer.writeEndElement(); //end of pPr\n        // Serialize watermark if paragraph is the first item of Header document.\n        // EnsureWatermark(paragraph);\n        this.serializeParagraphItems(writer, paragraph.inlines);\n        writer.writeEndElement(); //end of paragraph tag.\n    };\n    // Serialize the paragraph items\n    WordExport.prototype.serializeParagraphItems = function (writer, paraItems) {\n        var previousNode = undefined;\n        for (var i = 0; i < paraItems.length; i++) {\n            var item = paraItems[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.serializeFieldCharacter(writer, item);\n            }\n            else if (item.hasOwnProperty('imageString')) {\n                this.serializePicture(writer, item);\n            }\n            else if (item.hasOwnProperty('bookmarkType')) {\n                this.serializeBookMark(writer, item);\n            }\n            else {\n                this.serializeTextRange(writer, item, previousNode);\n            }\n            previousNode = item;\n        }\n    };\n    // Serialize the book mark\n    WordExport.prototype.serializeBookMark = function (writer, bookmark) {\n        var bookmarkId = this.getBookmarkId(bookmark.name);\n        var bookmarkName = bookmark.name;\n        if (bookmark.bookmarkType === 0) {\n            writer.writeStartElement('w', 'bookmarkStart', this.wNamespace);\n            writer.writeAttributeString('w', 'name', this.wNamespace, bookmarkName);\n        }\n        else if (bookmark.bookmarkType === 1) {\n            writer.writeStartElement('w', 'bookmarkEnd', this.wNamespace);\n        }\n        writer.writeAttributeString('w', 'id', this.wNamespace, bookmarkId.toString());\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getBookmarkId = function (name) {\n        var index = this.bookmarks.indexOf(name);\n        if (index < 0) {\n            index = this.bookmarks.length;\n            this.bookmarks.push(name);\n        }\n        return index;\n    };\n    // Serialize the picture.\n    WordExport.prototype.serializePicture = function (writer, image) {\n        if (image.width >= 0 && image.height >= 0) {\n            writer.writeStartElement(undefined, 'r', this.wNamespace);\n            this.serializeCharacterFormat(writer, image.characterFormat);\n            this.serializeDrawing(writer, image);\n            writer.writeEndElement(); //end of run element\n        }\n    };\n    // Serialize the drawing element.\n    WordExport.prototype.serializeDrawing = function (writer, image) {\n        writer.writeStartElement(undefined, 'drawing', this.wNamespace);\n        this.serializeInlinePicture(writer, image);\n        writer.writeEndElement();\n    };\n    // Serialize the inline picture.\n    WordExport.prototype.serializeInlinePicture = function (writer, image) {\n        writer.writeStartElement(undefined, 'inline', this.wpNamespace);\n        writer.writeStartElement(undefined, 'extent', this.wpNamespace);\n        var cx = Math.round(image.width * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round(image.height * this.emusPerPoint);\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        // double borderWidth = (double)picture.PictureShape.PictureDescriptor.BorderLeft.LineWidth / DLSConstants.BorderLineFactor;\n        // if (borderWidth > 0 && picture.DocxProps.length === 0) {\n        //     long leftTop = 0, rightBottom = 0;\n        //     picture.PictureShape.GetEffectExtent(borderWidth, ref leftTop, ref rightBottom);\n        //     m_writer.WriteStartElement('effectExtent', WP_namespace);\n        //     m_writer.WriteAttributeString('l', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('t', leftTop.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('r', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteAttributeString('b', rightBottom.ToString(CultureInfo.InvariantCulture));\n        //     m_writer.WriteEndElement();\n        // }\n        //this.serializePicProperties(writer, image);\n        this.serializeDrawingGraphics(writer, image);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.startsWith = function (sourceString, startString) {\n        return startString.length > 0 && sourceString.substring(0, startString.length) === startString;\n    };\n    // Serialize the graphics element for pictures.\n    WordExport.prototype.serializeDrawingGraphics = function (writer, picture) {\n        var id = '';\n        id = this.updateShapeId(picture);\n        // picture.ShapeId = this.getNextDocPrID();\n        // Processing picture\n        writer.writeStartElement('wp', 'docPr', this.wpNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, (this.mDocPrID++).toString());\n        // if (!isNullOrUndefined(picture.AlternativeText))\n        //     m_writer.WriteAttributeString('descr', picture.AlternativeText);\n        writer.writeAttributeString(undefined, 'name', undefined, '1'.toString());\n        // if (!string.IsNullOrEmpty(picture.Title))\n        //     m_writer.WriteAttributeString('title', picture.Title);\n        // else\n        writer.writeAttributeString(undefined, 'title', undefined, '');\n        // if (!picture.Visible)\n        //     m_writer.WriteAttributeString('hidden', '1');\n        // SerializePictureHyperlink(picture);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'graphic', this.aNamespace);\n        writer.writeStartElement('a', 'graphicData', this.aNamespace);\n        writer.writeAttributeString(undefined, 'uri', undefined, this.pictureNamespace);\n        writer.writeStartElement('pic', 'pic', this.pictureNamespace);\n        writer.writeStartElement('pic', 'nvPicPr', this.pictureNamespace);\n        writer.writeStartElement('pic', 'cNvPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'id', undefined, '0');\n        writer.writeAttributeString(undefined, 'name', undefined, '');\n        writer.writeAttributeString(undefined, 'descr', undefined, '');\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'cNvPicPr', this.pictureNamespace);\n        writer.writeStartElement('a', 'picLocks', this.aNamespace);\n        writer.writeAttributeString(undefined, 'noChangeAspect', undefined, '1');\n        writer.writeAttributeString(undefined, 'noChangeArrowheads', undefined, '1');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'blipFill', this.pictureNamespace);\n        writer.writeStartElement('a', 'blip', this.aNamespace);\n        if (this.startsWith(picture.imageString, 'data:image')) {\n            writer.writeAttributeString('r', 'embed', this.rNamespace, id);\n        }\n        else {\n            if (this.documentImages.containsKey(id)) {\n                //Remove the image document images collection for this particular key\n                //If the picture image data has href means MS Word contains the image in media folder as well as \n                //it is having external relationship id\n                // if (!this.startsWith(picture.imageString, 'data:image')) {\n                this.documentImages.remove(id);\n                this.externalImages.add(id, picture.imageString);\n                writer.writeAttributeString(undefined, 'link', this.rNamespace, id);\n            }\n        }\n        //End Element Blip\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'srcRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'stretch', this.aNamespace);\n        writer.writeStartElement('a', 'fillRect', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('pic', 'spPr', this.pictureNamespace);\n        writer.writeAttributeString(undefined, 'bwMode', undefined, 'auto');\n        writer.writeStartElement('a', 'xfrm', this.aNamespace);\n        // if (picture.Rotation !== 0)\n        //     m_writer.WriteAttributeString('rot', picture.Rotation.ToString());\n        writer.writeStartElement('a', 'off', this.aNamespace);\n        writer.writeAttributeString(undefined, 'x', undefined, '0');\n        writer.writeAttributeString(undefined, 'y', undefined, '0');\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'ext', this.aNamespace);\n        var cx = Math.round((picture.width * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cx', undefined, cx.toString());\n        var cy = Math.round((picture.height * this.emusPerPoint));\n        writer.writeAttributeString(undefined, 'cy', undefined, cy.toString());\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeStartElement('a', 'prstGeom', this.aNamespace);\n        writer.writeAttributeString(undefined, 'prst', undefined, 'rect');\n        writer.writeStartElement('a', 'avLst', this.aNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement();\n        //When the picture border has been added next to effect list\n        //if not, Picture border has not been preserved\n        // if (picture.HasBorder)\n        // {\n        //     if (picture.TextWrappingStyle === TextWrappingStyle.Inline && picture.IsShape)\n        //         SerializeInlineShapeLine(picture.PictureShape);\n        //     else\n        //         SerializeShapeLine(picture.PictureShape);\n        // }\n        // if (picture.DocxProps.length > 0)\n        //     SerializeDocxProps(picture.DocxProps, 'effectLst');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    /// Update the shape id.\n    WordExport.prototype.updateShapeId = function (picture) {\n        var id = '';\n        var tOwner = this.paragraph;\n        // Adding picture byte data to the corresponding picture collection \n        // depending on its owner subdocument\n        if (this.headerFooter) {\n            id = this.updateHFImageRels(this.headerFooter, picture);\n        }\n        else {\n            if (id === '') {\n                if (tOwner.hasOwnProperty('sectionFormat') || tOwner.hasOwnProperty('inlines')) {\n                    id = this.addImageRelation(this.documentImages, picture);\n                    // if (owner is WFootnote)\n                    // {\n                    //     if ((owner as WFootnote).FootnoteType === FootnoteType.Footnote)\n                    //         id = AddImageRelation(FootnoteImages, picture.ImageRecord);\n                    //     else\n                    //         id = AddImageRelation(EndnoteImages, picture.ImageRecord);\n                    // }\n                    // if (owner is WComment)\n                    //     id = AddImageRelation(CommentImages, picture.ImageRecord);\n                }\n            }\n        }\n        return id;\n    };\n    // Adds the image relation.\n    WordExport.prototype.addImageRelation = function (imageCollection, image) {\n        var relationId = '';\n        // if (imageCollection.ContainsValue(imageRecord)) {\n        //     foreach(string key in imageCollection.keys)\n        //     {\n        //         if (imageRecord === imageCollection[key]) {\n        //             relationId = key;\n        //             break;\n        //         }\n        //     }\n        // }\n        // else {\n        relationId = this.getNextRelationShipID();\n        imageCollection.add(relationId, image);\n        // }\n        return relationId;\n    };\n    // Update the HeaderFooter image relations.\n    WordExport.prototype.updateHFImageRels = function (hf, image) {\n        var id = '';\n        // UpdateImages(image);\n        var headerId = '';\n        var types = this.headersFooters.keys;\n        for (var i = 0; i < types.length; i++) {\n            var hfColl = this.headersFooters.get(types[i]);\n            var hfKeys = hfColl.keys;\n            for (var j = 0; j < hfKeys.length; j++) {\n                if (hfColl.get(hfKeys[j]) === hf) {\n                    headerId = hfKeys[j];\n                    var headerImages = void 0;\n                    if (this.headerFooterImages.containsKey(headerId)) {\n                        headerImages = this.headerFooterImages.get(headerId);\n                        id = this.addImageRelation(headerImages, image);\n                    }\n                    else {\n                        headerImages = new Dictionary();\n                        id = this.addImageRelation(headerImages, image);\n                        this.headerFooterImages.add(headerId, headerImages);\n                    }\n                }\n            }\n        }\n        return id;\n    };\n    // Serialize the table\n    WordExport.prototype.serializeTable = function (writer, table) {\n        if (table.rows.length <= 0) {\n            return;\n        }\n        var owner = this.table;\n        this.table = table;\n        writer.writeStartElement(undefined, 'tbl', this.wNamespace);\n        var tableFormat = table.rows[0].rowFormat;\n        this.serializeTableFormat(writer, tableFormat, table);\n        this.serializeTableGrid(writer, table);\n        this.serializeTableRows(writer, table.rows);\n        writer.writeEndElement();\n        this.table = owner;\n    };\n    // Serialize the table grid\n    WordExport.prototype.serializeTableGrid = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblGrid', this.wNamespace);\n        if (table.grid.length !== 0) {\n            this.serializeGridColumns(writer, table.grid);\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table rows\n    WordExport.prototype.serializeTableRows = function (writer, rows) {\n        if (rows.length > 0) {\n            for (var i = 0; i < rows.length; i++) {\n                var row = rows[i];\n                if (row.cells.length > 0) {\n                    this.serializeRow(writer, row);\n                }\n            }\n        }\n    };\n    // Serialize the table row\n    WordExport.prototype.serializeRow = function (writer, row) {\n        var owner = this.row;\n        this.row = row;\n        writer.writeStartElement(undefined, 'tr', this.wNamespace);\n        this.serializeRowFormat(writer, row);\n        this.serializeCells(writer, row.cells);\n        writer.writeEndElement(); //end od table row 'tr'\n        this.row = owner;\n    };\n    // Serialize the row format\n    WordExport.prototype.serializeRowFormat = function (writer, row) {\n        writer.writeStartElement(undefined, 'trPr', this.wNamespace);\n        //Serialize Row Height\n        if (row.rowFormat.height > 0) {\n            writer.writeStartElement(undefined, 'trHeight', this.wNamespace);\n            if (row.rowFormat.heightType === 'Exactly') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'exact');\n            }\n            else if (row.rowFormat.heightType === 'AtLeast') {\n                writer.writeAttributeString('w', 'hRule', this.wNamespace, 'atLeast');\n            }\n            var height = this.roundToTwoDecimal(row.rowFormat.height * this.twentiethOfPoint).toString();\n            writer.writeAttributeString('w', 'val', this.wNamespace, height);\n            writer.writeEndElement();\n        }\n        var rowFormat = row.rowFormat;\n        // //Serialize 'gridBefore' element\n        var gridBefore = rowFormat.gridBefore;\n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'gridBefore', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridBefore.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'gridAfter' element\n        var gridAfter = rowFormat.gridAfter;\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'gridAfter', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, gridAfter.toString());\n            writer.writeEndElement();\n        }\n        // //Serialize 'wBefore' element \n        if (gridBefore > 0) {\n            writer.writeStartElement(undefined, 'wBefore', this.wNamespace);\n            switch (rowFormat.gridBeforeWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridBeforeWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'wAfter' element\n        if (gridAfter > 0) {\n            writer.writeStartElement(undefined, 'wAfter', this.wNamespace);\n            switch (rowFormat.gridAfterWidthType) {\n                case 'Percent':\n                    var width = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.percentageFactor).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, width);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'pct');\n                    break;\n                case 'Point':\n                    var pointWidth = this.roundToTwoDecimal(rowFormat.gridAfterWidth * this.twipsInOnePoint).toString();\n                    writer.writeAttributeString('w', 'val', this.wNamespace, pointWidth);\n                    writer.writeAttributeString('w', 'type', this.wNamespace, 'dxa');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        //Serialize 'cantSplit' element \n        if (!rowFormat.allowBreakAcrossPages) {\n            writer.writeStartElement(undefined, 'cantSplit', this.wNamespace);\n            writer.writeEndElement();\n        }\n        // //Serialize 'tblHeader' element \n        if (rowFormat.isHeader) {\n            writer.writeStartElement(undefined, 'tblHeader', this.wNamespace);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // serialize the table cells\n    WordExport.prototype.serializeCells = function (writer, cells) {\n        for (var i = 0; i < cells.length; i++) {\n            this.serializeCell(writer, cells[i]);\n        }\n    };\n    // Serialize the table cell\n    WordExport.prototype.serializeCell = function (writer, cell) {\n        var owner = this.blockOwner;\n        this.blockOwner = cell;\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        this.serializeCellFormat(writer, cell.cellFormat);\n        if (cell.blocks.length > 0) {\n            var itemIndex = 0;\n            var item = undefined;\n            while (itemIndex < cell.blocks.length) {\n                item = cell.blocks[itemIndex];\n                this.serializeBodyItem(writer, item, false);\n                itemIndex += 1;\n            }\n        }\n        else {\n            writer.writeStartElement(undefined, 'p', this.wNamespace);\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'Normal');\n            writer.writeEndElement(); //end of pStyle\n            writer.writeEndElement(); //end of pPr\n            writer.writeEndElement(); //end of P\n        }\n        writer.writeEndElement(); //end of table cell 'tc'        \n        this.blockOwner = owner;\n    };\n    // Serialize the cell formatting\n    WordExport.prototype.serializeCellFormat = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        //Get the table fomat\n        var tf = this.table.tableFormat;\n        //Get the row format\n        var rf = this.row.rowFormat;\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        //w:cnfStyle -   Table Cell Conditional Formatting\n        // SerializeCnfStyleElement(cell);\n        //w:tcW -    Preferred Table Cell Width\n        this.serializeCellWidth(writer, cell);\n        //w:hMerge -    Horizontally Merged Cell and w:vMerge -    Vertically Merged Cell\n        this.serializeCellMerge(writer, cellFormat);\n        //w:gridSpan -   Grid Columns Spanned by Current Table Cell\n        this.serializeGridSpan(writer, cell);\n        //w:tcBorders -    Table Cell Borders\n        writer.writeStartElement(undefined, 'tcBorders', this.wNamespace);\n        this.serializeBorders(writer, cellFormat.borders, 8);\n        writer.writeEndElement();\n        //w:shd -  Table Cell Shading\n        this.serializeShading(writer, cell.cellFormat.shading);\n        // //w:noWrap -   Don't Wrap Cell Content\n        // if (cellFormat.HasValue(CellFormat.TextWrapKey)) {\n        //     m_writer.WriteStartElement('noWrap', W_namespace);\n        //     if (cellFormat.TextWrap)\n        //         m_writer.WriteAttributeString('w', 'val', W_namespace, 'false');\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:tcMar -  Single Table Cell Margins\n        // if (!cellFormat.SamePaddingsAsTable) {\n        //     m_writer.WriteStartElement('tcMar', W_namespace);\n        //     SerializePaddings(cellFormat.Paddings);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:textDirection -   Table Cell Text Flow Direction\n        this.serializeTableCellDirection(writer, cellFormat);\n        // //w:tcFitText -  Fit Text Within Cell\n        // if (cellFormat.FitText) {\n        //     m_writer.WriteStartElement('tcFitText', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        // //w:hideMark \n        // if (cellFormat.HideMark) {\n        //     m_writer.WriteStartElement('hideMark', W_namespace);\n        //     m_writer.WriteEndElement();\n        // }\n        //w:vAlign -  Table Cell Vertical Alignment\n        // if (cellFormat.HasValue(CellFormat.VrAlignmentKey))\n        this.serializeCellVerticalAlign(writer, cellFormat.verticalAlignment);\n        // //w:hideMark -   Ignore End Of Cell Marker In Row Height Calculation\n        // SerializeDocxProps(tempDocxProps, 'hideMark');\n        // //w:cellIns -    Table Cell Insertion\n        // SerializeDocxProps(tempDocxProps, 'cellIns');\n        // //w:cellDel -    Table Cell Deletion\n        // SerializeDocxProps(tempDocxProps, 'cellDel');\n        // //w:cellMerge -   Vertically Merged/Split Table Cells\n        // SerializeDocxProps(tempDocxProps, 'cellMerge');\n        // if (cellFormat.OldPropertiesHash.length > 0 && !m_isAlternativeCellFormat) {\n        //     m_isAlternativeCellFormat = true;\n        //     SerializeTrackChangeProps('tcPrChange', cellFormat.FormatChangeAuthorName, cellFormat.FormatChangeDateTime);\n        //     Dictionary < int, object > oldPropertyHash = new Dictionary<int, object>(cellFormat.OldPropertiesHash);\n        //     Dictionary < int, object > propertyHash = new Dictionary<int, object>(cellFormat.PropertiesHash);\n        //     cellFormat.PropertiesHash.Clear();\n        //     cellFormat.OldPropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     SerializeCellFormat(cellFormat);\n        //     cellFormat.PropertiesHash.Clear();\n        //     foreach(KeyValuePair < int, object > keyValue in propertyHash)\n        //     cellFormat.PropertiesHash[keyValue.Key] = keyValue.Value;\n        //     foreach(KeyValuePair < int, object > keyValue in oldPropertyHash)\n        //     cellFormat.OldPropertiesHash[keyValue.Key] = keyValue.Value;\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeCellFormat = false;\n        // }\n        writer.writeEndElement();\n    };\n    // Serialize the cell width\n    WordExport.prototype.serializeCellWidth = function (writer, cell) {\n        var cf = cell.cellFormat;\n        writer.writeStartElement(undefined, 'tcW', this.wNamespace);\n        if (cf.preferredWidthType === 'Percent') {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.percentageFactor).toString());\n        }\n        else if (cf.preferredWidthType === 'Point') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(cf.preferredWidth * this.twipsInOnePoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize cell merge\n    WordExport.prototype.serializeCellMerge = function (writer, cellFormat) {\n        var cell = this.blockOwner;\n        var isserialized = false;\n        var collKey;\n        var currentIndex = cell.columnIndex;\n        var cellIndex = this.row.cells.indexOf(cell);\n        var prevIndex = cellIndex > 0 ? this.row.cells[cellIndex - 1].columnIndex : cell.columnIndex;\n        if (cell.columnIndex === cellIndex) {\n            collKey = cell.columnIndex;\n            isserialized = true;\n        }\n        else {\n            isserialized = false;\n        }\n        if (!isserialized) {\n            if (cellIndex === 0) {\n                currentIndex = cell.columnIndex;\n                prevIndex = -1;\n            }\n            for (var i = prevIndex; i < currentIndex; i++) {\n                collKey = prevIndex + 1;\n                prevIndex += 1;\n                if (this.mVerticalMerge.containsKey(collKey)) {\n                    this.createMerge(writer, collKey, cell);\n                }\n            }\n        }\n        if (cellFormat.rowSpan > 1) {\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            this.mVerticalMerge.add(collKey, cellFormat.rowSpan - 1);\n            if (cellFormat.columnSpan > 1) {\n                this.mGridSpans.add(collKey, cellFormat.columnSpan);\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'restart');\n            writer.writeEndElement();\n        }\n        else if (this.mVerticalMerge.containsKey(collKey) && isserialized) {\n            this.createMerge(writer, collKey, cell);\n        }\n        else if (this.mVerticalMerge.containsKey(cellIndex + 1) && isserialized && cell.nextNode === undefined) {\n            collKey = cell.columnIndex + 1;\n            writer.writeEndElement();\n            writer.writeStartElement('w', 'p', this.wNamespace);\n            writer.writeEndElement();\n            writer.writeEndElement();\n            writer.writeStartElement(undefined, 'tc', this.wNamespace);\n            writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n            this.serializeColumnSpan(collKey, writer);\n            writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n            writer.writeEndElement();\n            this.checkMergeCell(collKey);\n        }\n    };\n    WordExport.prototype.createMerge = function (writer, collKey, cell) {\n        this.serializeColumnSpan(collKey, writer);\n        writer.writeStartElement(undefined, 'vMerge', this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'continue');\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tcPr\n        writer.writeStartElement('w', 'p', this.wNamespace);\n        writer.writeEndElement();\n        writer.writeEndElement(); //end tc\n        writer.writeStartElement(undefined, 'tc', this.wNamespace);\n        writer.writeStartElement(undefined, 'tcPr', this.wNamespace);\n        this.serializeCellWidth(writer, cell);\n        this.checkMergeCell(collKey);\n    };\n    WordExport.prototype.serializeColumnSpan = function (collKey, writer) {\n        if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.mGridSpans.get(collKey).toString());\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.checkMergeCell = function (collKey) {\n        if ((this.mVerticalMerge.get(collKey) - 1) === 0) {\n            this.mVerticalMerge.remove(collKey);\n            if (this.mGridSpans.keys.length > 0 && this.mGridSpans.containsKey(collKey)) {\n                this.mGridSpans.remove(collKey);\n            }\n        }\n        else {\n            this.mVerticalMerge.set(collKey, this.mVerticalMerge.get(collKey) - 1);\n        }\n    };\n    // Serialize the grid span element of cell.\n    WordExport.prototype.serializeGridSpan = function (writer, cell) {\n        // int gridSpan = cell.cellFormat.GridSpan;\n        if (cell.cellFormat.columnSpan > 1) {\n            var num = cell.cellFormat.columnSpan;\n            writer.writeStartElement(undefined, 'gridSpan', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, num.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table cell direction\n    WordExport.prototype.serializeTableCellDirection = function (writer, cellFormat) {\n        // if (cellFormat..textDirection !== TextDirection.Horizontal)\n        // {\n        //     m_writer.WriteStartElement('textDirection', W_namespace);\n        //     switch (cellFormat.TextDirection)\n        //     {\n        //         case TextDirection.Horizontal:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTb');\n        //             break;\n        //         case TextDirection.VerticalBottomToTop:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'btLr');\n        //             break;\n        //         case TextDirection.VerticalTopToBottom:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRl');\n        //             break;\n        //         case TextDirection.HorizontalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'lrTbV');\n        //             break;\n        //         case TextDirection.Vertical:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbLrV');\n        //             break;\n        //         case TextDirection.VerticalFarEast:\n        //             m_writer.WriteAttributeString('w', 'val', W_namespace, 'tbRlV');\n        //             break;\n        //     }\n        //     m_writer.WriteEndElement();\n        // }\n    };\n    // Serialize the cell vertical alignment\n    WordExport.prototype.serializeCellVerticalAlign = function (writer, alignment) {\n        writer.writeStartElement(undefined, 'vAlign', this.wNamespace);\n        switch (alignment) {\n            case 'Top':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'top');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'bottom');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table grid columns.\n    WordExport.prototype.serializeGridColumns = function (writer, grid) {\n        for (var i = 1, count = grid.length; i < count; i++) {\n            var gridValue = Math.round(grid[i] * 20);\n            writer.writeStartElement(undefined, 'gridCol', this.wNamespace);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, gridValue.toString());\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the row formattings.\n    // Table parameter is passed for serializing table format and undefined for serializing row format.\n    WordExport.prototype.serializeTableFormat = function (writer, format, table) {\n        // if (!isNullOrUndefined(table))\n        // {\n        //     List<Stream> tempDocxProps = new List<Stream>();\n        //     for (int i = 0, cnt = table.DocxTableFormat.NodeArray.length; i < cnt; i++)\n        //         tempDocxProps.Add(table.DocxTableFormat.NodeArray[i]);\n        writer.writeStartElement(undefined, 'tblPr', this.wNamespace);\n        //     SerializeTableStlye(format);\n        //     if (format.WrapTextAround &&!((table.OwnerTextBody.Owner is WTextBox) || \n        //(table.OwnerTextBody.Owner is WComment) || (table.OwnerTextBody.Owner is WFootnote)))\n        //     {\n        //         SerializeTablePositioning(format.Positioning);\n        //         if (!format.Positioning.AllowOverlap)\n        //         {\n        //             m_writer.WriteStartElement('tblOverlap', W_namespace);\n        //             m_writer.WriteAttributeString('val', W_namespace, 'never');\n        //             m_writer.WriteEndElement();\n        //         }\n        //     }\n        //     if (format.Bidi)\n        //     {\n        //         m_writer.WriteStartElement('bidiVisual', W_namespace);\n        //         m_writer.WriteEndElement();\n        //     }\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleRowBandSize');\n        //     SerializeDocxProps(tempDocxProps, 'tblStyleColBandSize');\n        this.serializeTableWidth(writer, table);\n        this.serializeTableAlignment(writer, table.tableFormat);\n        this.serializeCellSpacing(writer, table.tableFormat);\n        this.serializeTableIndentation(writer, table.tableFormat);\n        this.serializeTableBorders(writer, table.tableFormat);\n        this.serializeShading(writer, table.tableFormat.shading);\n        this.serializeTblLayout(writer, table.tableFormat);\n        // this.serializeTableCellMargin(writer, table.tableFormat);\n        //     SerializeTableLook(table);\n        //         if (!isNullOrUndefined(table.Title))\n        //             SerializeTableTitle(table);\n        //         if (!isNullOrUndefined(table.Description))\n        //             SerializeTableDescription(table);\n        // }\n        // else\n        // {\n        //     SerializeCellSpacing(format);\n        //     SerializeTableIndentation(format);\n        //     SerializeTableBorders(format);\n        //     SerializeTableShading(format);\n        //     SerializeTblLayout(format);\n        //     SerializeTableCellMargin(format);\n        // }\n        // if (!isNullOrUndefined(format.OwnerBase) && format.OwnerBase is WTable\n        //   && format.OldPropertiesHash.length > 0 && !m_isAlternativeTableFormat)\n        // {\n        //     m_isAlternativeTableFormat = true;\n        //     SerializeTrackChangeProps('tblPrChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, format.OwnerBase as WTable);\n        //     m_writer.WriteEndElement();\n        //     m_isAlternativeTableFormat = false;\n        // }\n        // if (!isNullOrUndefined(format.OwnerRow) && format.OldPropertiesHash.length > 0)\n        // {\n        //     SerializeTrackChangeProps('tblPrExChange', format.FormatChangeAuthorName, format.FormatChangeDateTime);\n        //     SerializeTableTrackChanges(format, undefined);\n        //     m_writer.WriteEndElement();\n        // }\n        // SerializeTblTrackChanges(format);\n        if (!isNullOrUndefined(table)) {\n            writer.writeEndElement(); //end of tblPr\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeShading = function (writer, format) {\n        // if (format.textureStyle !== 'TextureNone') {\n        writer.writeStartElement(undefined, 'shd', this.wNamespace);\n        writer.writeAttributeString(undefined, 'fill', this.wNamespace, this.getColor(format.backgroundColor));\n        if (format.foregroundColor === 'empty') {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(format.foregroundColor));\n        }\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getTextureStyle(format.textureStyle));\n        writer.writeEndElement();\n        // }\n    };\n    WordExport.prototype.getTextureStyle = function (textureStyle) {\n        switch (textureStyle) {\n            case 'Texture5Percent':\n            case 'Texture2Pt5Percent':\n            case 'Texture7Pt5Percent':\n                return 'pct5';\n            case 'Texture10Percent':\n                return 'pct10';\n            case 'Texture12Pt5Percent':\n                return 'pct12';\n            case 'Texture15Percent':\n            case 'Texture17Pt5Percent':\n                return 'pct15';\n            case 'Texture20Percent':\n            case 'Texture22Pt5Percent':\n                return 'pct20';\n            case 'Texture25Percent':\n            case 'Texture27Pt5Percent':\n                return 'pct25';\n            case 'Texture30Percent':\n            case 'Texture32Pt5Percent':\n                return 'pct30';\n            case 'Texture35Percent':\n                return 'pct35';\n            case 'Texture37Pt5Percent':\n                return 'pct37';\n            case 'Texture40Percent':\n            case 'Texture42Pt5Percent':\n                return 'pct40';\n            case 'Texture45Percent':\n            case 'Texture47Pt5Percent':\n                return 'pct45';\n            case 'Texture50Percent':\n            case 'Texture52Pt5Percent':\n                return 'pct50';\n            case 'Texture55Percent':\n            case 'Texture57Pt5Percent':\n                return 'pct55';\n            case 'Texture60Percent':\n                return 'pct60';\n            case 'Texture62Pt5Percent':\n                return 'pct62';\n            case 'Texture65Percent':\n            case 'Texture67Pt5Percent':\n                return 'pct65';\n            case 'Texture70Percent':\n            case 'Texture72Pt5Percent':\n                return 'pct70';\n            case 'Texture75Percent':\n            case 'Texture77Pt5Percent':\n                return 'pct75';\n            case 'Texture80Percent':\n            case 'Texture82Pt5Percent':\n                return 'pct80';\n            case 'Texture85Percent':\n                return 'pct85';\n            case 'Texture87Pt5Percent':\n                return 'pct87';\n            case 'Texture90Percent':\n            case 'Texture92Pt5Percent':\n                return 'pct90';\n            case 'Texture95Percent':\n            case 'Texture97Pt5Percent':\n                return 'pct95';\n            case 'TextureCross':\n                return 'thinHorzCross';\n            case 'TextureDarkCross':\n                return 'horzCross';\n            case 'TextureDarkDiagonalCross':\n                return 'diagCross';\n            case 'TextureDarkDiagonalDown':\n                return 'reverseDiagStripe';\n            case 'TextureDarkDiagonalUp':\n                return 'diagStripe';\n            case 'TextureDarkHorizontal':\n                return 'horzStripe';\n            case 'TextureDarkVertical':\n                return 'vertStripe';\n            case 'TextureDiagonalCross':\n                return 'thinDiagCross';\n            case 'TextureDiagonalDown':\n                return 'thinReverseDiagStripe';\n            case 'TextureDiagonalUp':\n                return 'thinDiagStripe';\n            case 'TextureHorizontal':\n                return 'thinHorzStripe';\n            case 'TextureSolid':\n                return 'solid';\n            case 'TextureVertical':\n                return 'thinVertStripe';\n            default:\n                return 'clear';\n        }\n    };\n    // Serialize the table borders\n    WordExport.prototype.serializeTableBorders = function (writer, format) {\n        var borders = format.borders;\n        // if (IsNoneBorder(borders))\n        //     return;\n        writer.writeStartElement(undefined, 'tblBorders', this.wNamespace);\n        this.serializeBorders(writer, format.borders, 8);\n        writer.writeEndElement();\n    };\n    // Serialize the borders.\n    WordExport.prototype.serializeBorders = function (writer, borders, multipler) {\n        this.serializeBorder(writer, borders.top, 'top', multipler);\n        this.serializeBorder(writer, borders.left, 'left', multipler);\n        this.serializeBorder(writer, borders.bottom, 'bottom', multipler);\n        this.serializeBorder(writer, borders.right, 'right', multipler);\n        this.serializeBorder(writer, borders.horizontal, 'insideH', multipler);\n        this.serializeBorder(writer, borders.vertical, 'insideV', multipler);\n        this.serializeBorder(writer, borders.diagonalDown, 'tl2br', multipler);\n        this.serializeBorder(writer, borders.diagonalUp, 'tr2bl', multipler);\n    };\n    // Serialize the table layout element\n    WordExport.prototype.serializeTblLayout = function (writer, format) {\n        //TODO: AUTO size property is not mapped yet\n        // if (!format.IsAutoResized)\n        // {\n        //     writer.writeStartElement(undefined, 'tblLayout', this.wNamespace);\n        //     writer.writeAttributeString(undefined, 'type', this.wNamespace, 'fixed');\n        //     writer.writeEndElement();\n        // }\n    };\n    // Serializes the Border\n    WordExport.prototype.serializeBorder = function (writer, border, tagName, multiplier) {\n        var borderStyle = border.lineStyle;\n        var sz = (border.lineWidth * multiplier);\n        var space = border.space;\n        if (borderStyle === 'Cleared') {\n            writer.writeStartElement(undefined, tagName, this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'nil');\n            writer.writeEndElement();\n            return;\n        }\n        else if ((borderStyle === 'None' && !border.hasNoneStyle) || sz <= 0) {\n            return;\n        }\n        writer.writeStartElement(undefined, tagName, this.wNamespace);\n        writer.writeAttributeString('w', 'val', this.wNamespace, this.getBorderStyle(borderStyle));\n        // if (border.color === '#000000')\n        // {\n        //     writer.writeAttributeString(undefined, 'color', this.wNamespace, 'auto');\n        // }\n        // else\n        // {\n        writer.writeAttributeString(undefined, 'color', this.wNamespace, this.getColor(border.color));\n        // }\n        writer.writeAttributeString(undefined, 'sz', this.wNamespace, this.roundToTwoDecimal(sz).toString());\n        writer.writeAttributeString(undefined, 'space', this.wNamespace, space.toString());\n        if (border.shadow) {\n            writer.writeAttributeString(undefined, 'shadow', this.wNamespace, 'on');\n        }\n        writer.writeEndElement();\n    };\n    // Get the border style as string\n    WordExport.prototype.getBorderStyle = function (borderStyle) {\n        switch (borderStyle) {\n            case 'Cleared':\n                return 'cleared';\n            case 'DashSmallGap':\n                return 'dashSmallGap';\n            case 'Triple':\n                return 'triple';\n            case 'Dot':\n                return 'dotted';\n            case 'DashDot':\n                return 'dotDash';\n            case 'DashLargeGap':\n                return 'dashed';\n            case 'DashDotDot':\n                return 'dotDotDash';\n            case 'Double':\n                return 'double';\n            case 'ThinThickSmallGap':\n                return 'thinThickSmallGap';\n            case 'ThickThinSmallGap':\n                return 'thickThinSmallGap';\n            case 'ThinThickThinSmallGap':\n                return 'thinThickThinSmallGap';\n            case 'ThickThinMediumGap':\n                return 'thickThinMediumGap';\n            case 'ThinThickMediumGap':\n                return 'thinThickMediumGap';\n            case 'ThinThickThinMediumGap':\n                return 'thinThickThinMediumGap';\n            case 'ThickThinLargeGap':\n                return 'thickThinLargeGap';\n            case 'ThinThickLargeGap':\n                return 'thinThickLargeGap';\n            case 'ThinThickThinLargeGap':\n                return 'thinThickThinLargeGap';\n            case 'Thick':\n                return 'thick';\n            case 'SingleWavy':\n                return 'wave';\n            case 'DoubleWavy':\n                return 'doubleWave';\n            case 'DashDotStroked':\n                return 'dashDotStroked';\n            case 'Engrave3D':\n                return 'threeDEngrave';\n            case 'Emboss3D':\n                return 'threeDEmboss';\n            case 'Outset':\n                return 'outset';\n            case 'Inset':\n                return 'inset';\n            // case 'None':\n            //     return 'none';\n            default:\n                return 'single';\n        }\n    };\n    // Serialize the table indentation.\n    WordExport.prototype.serializeTableIndentation = function (writer, format) {\n        writer.writeStartElement(undefined, 'tblInd', this.wNamespace);\n        var tableIndent = Math.round(format.leftIndent * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'w', this.wNamespace, tableIndent.toString());\n        writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        writer.writeEndElement();\n    };\n    // Serialize the cell spacing.\n    WordExport.prototype.serializeCellSpacing = function (writer, format) {\n        if (!isNullOrUndefined(format.cellSpacing) && format.cellSpacing >= 0) {\n            writer.writeStartElement(undefined, 'tblCellSpacing', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, this.roundToTwoDecimal(format.cellSpacing * this.twentiethOfPoint).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n            writer.writeEndElement();\n        }\n    };\n    // Serialize the table width\n    WordExport.prototype.serializeTableWidth = function (writer, table) {\n        writer.writeStartElement(undefined, 'tblW', this.wNamespace);\n        if (table.tableFormat.preferredWidthType === 'Percent') {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, (table.tableFormat.preferredWidth * this.percentageFactor).toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'pct');\n        }\n        else if (table.tableFormat.preferredWidthType === 'Point') {\n            var tableWidth = Math.round(table.tableFormat.preferredWidth * this.twipsInOnePoint);\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, tableWidth.toString());\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'dxa');\n        }\n        else {\n            writer.writeAttributeString(undefined, 'w', this.wNamespace, '0');\n            writer.writeAttributeString(undefined, 'type', this.wNamespace, 'auto');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the table alignment\n    WordExport.prototype.serializeTableAlignment = function (writer, format) {\n        writer.writeStartElement(undefined, 'jc', this.wNamespace);\n        switch (format.tableAlignment) {\n            case 'Right':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'right');\n                break;\n            case 'Center':\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'center');\n                break;\n            default:\n                writer.writeAttributeString('w', 'val', this.wNamespace, 'left');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the field\n    WordExport.prototype.serializeFieldCharacter = function (writer, field) {\n        writer.writeStartElement(undefined, 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, field.characterFormat);\n        writer.writeStartElement(undefined, 'fldChar', this.wNamespace);\n        var type = field.fieldType === 0 ? 'begin'\n            : field.fieldType === 1 ? 'end' : 'separate';\n        writer.writeAttributeString(undefined, 'fldCharType', this.wNamespace, type);\n        writer.writeEndElement();\n        writer.writeEndElement();\n    };\n    // Serialize the text range.\n    WordExport.prototype.serializeTextRange = function (writer, span, previousNode) {\n        writer.writeStartElement('w', 'r', this.wNamespace);\n        this.serializeCharacterFormat(writer, span.characterFormat);\n        if (span.text === '\\t') {\n            writer.writeElementString(undefined, 'tab', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\v') {\n            writer.writeElementString(undefined, 'br', this.wNamespace, undefined);\n        }\n        else if (span.text === '\\f') {\n            writer.writeStartElement(undefined, 'br', this.wNamespace);\n            writer.writeAttributeString('w', 'type', this.wNamespace, 'page');\n            writer.writeEndElement();\n        }\n        else {\n            var isField = !isNullOrUndefined(previousNode)\n                && previousNode.hasOwnProperty('fieldType') && previousNode.fieldType !== 2;\n            writer.writeStartElement(undefined, isField ? 'instrText' : 't', this.wNamespace);\n            writer.writeAttributeString('xml', 'space', this.xmlNamespace, 'preserve');\n            writer.writeString(span.text);\n            writer.writeEndElement();\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph format\n    WordExport.prototype.serializeParagraphFormat = function (writer, paragraphFormat, paragraph) {\n        if (!isNullOrUndefined(paragraphFormat.styleName)) {\n            writer.writeStartElement(undefined, 'pStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, paragraphFormat.styleName);\n            writer.writeEndElement(); //end of pStyle\n        }\n        if (!isNullOrUndefined(paragraph)) {\n            this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n        }\n        else {\n            this.serializeListFormat(writer, paragraphFormat.listFormat);\n        }\n        this.serializeParagraphSpacing(writer, paragraphFormat);\n        this.serializeIndentation(writer, paragraphFormat);\n        this.serializeParagraphAlignment(writer, paragraphFormat.textAlignment);\n        if (!isNullOrUndefined(paragraphFormat.tabs) && paragraphFormat.tabs.length > 0) {\n            this.serializeTabs(writer, paragraphFormat.tabs);\n        }\n    };\n    // Serialize Tabs\n    WordExport.prototype.serializeTabs = function (writer, tabStops) {\n        writer.writeStartElement('w', 'tabs', this.wNamespace);\n        for (var i = 0; i < tabStops.length; i++) {\n            this.serializeTab(writer, tabStops[i]);\n        }\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeTab = function (writer, tabStop) {\n        var position = 0;\n        writer.writeStartElement('w', 'tab', this.wNamespace);\n        if (tabStop.position === 0 && tabStop.deletePosition !== 0) {\n            position = tabStop.deletePosition * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, 'clear');\n        }\n        else {\n            position = tabStop.position * this.twentiethOfPoint;\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getTabJustification(tabStop.tabJustification));\n        }\n        if (!isNullOrUndefined(tabStop.tabLeader) && (tabStop.tabLeader !== 'None')) {\n            writer.writeAttributeString('w', 'leader', this.wNamespace, this.getTabLeader(tabStop.tabLeader));\n        }\n        writer.writeAttributeString('w', 'pos', this.wNamespace, position.toString() + '');\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getTabLeader = function (tabLeader) {\n        switch (tabLeader) {\n            case 'Dot':\n                return 'dot';\n            case 'Hyphen':\n                return 'hyphen';\n            case 'Underscore':\n                return 'underscore';\n            default:\n                return 'none';\n        }\n    };\n    WordExport.prototype.getTabJustification = function (tabJustification) {\n        switch (tabJustification) {\n            case 'Bar':\n                return 'bar';\n            case 'Center':\n                return 'center';\n            case 'Decimal':\n                return 'decimal';\n            case 'Left':\n                return 'left';\n            case 'List':\n                return 'num';\n            case 'Right':\n                return 'right';\n            default:\n                return 'clear';\n        }\n    };\n    // // Seraializes the pargraph list format\n    // private serializeListParagraph(writer: XmlWriter, paragraph: any): void {\n    //     if (!isNullOrUndefined(paragraph.paragraphFormat.listFormat)) {\n    //         this.serializeListFormat(writer, paragraph.paragraphFormat.listFormat);\n    //     }\n    // }\n    // Serialize the list format\n    WordExport.prototype.serializeListFormat = function (writer, lf) {\n        // let pStyleName = undefined;\n        // if (lf.CurrentListStyle.IsBuiltInStyle && !isNullOrUndefined(lf.OwnerParagraph))\n        // {\n        //     pStyleName = lf.OwnerParagraph.StyleName;\n        // }\n        // int listId = GetListId(lf);\n        // if (!isNullOrUndefined(pStyleName) && string.IsNullOrEmpty(lf.LFOStyleName)) \n        // {\n        //     WordDocument doc = lf.OwnerParagraph.Document;\n        //     WParagraphStyle style = doc.Styles.FindByName(pStyleName, StyleType.ParagraphStyle) as WParagraphStyle;\n        //     if (style.ListIndex === -1)\n        //     {\n        //         ListStyle lstStyle = lf.OwnerParagraph.Document.ListStyles.FindByName(lf.CustomStyleName);\n        //         style.ListIndex = listId;\n        //         if (lstStyle.Levels.length > 1)\n        //         {\n        //             style.ListLevel = lf.ListLevelNumber;\n        //         }\n        //         pStyleName = pStyleName.Replace(' ', '');\n        //         lstStyle.Levels[lf.ListLevelNumber].ParaStyleName = pStyleName;\n        //     }\n        // }\n        // else\n        // {\n        // if (!isNullOrUndefined(lf.listId) && !isNullOrUndefined(lf.listLevelNumber)) {\n        //     this.serializeNumPr(writer, lf.listId, lf.listLevelNumber);\n        // }\n        // }\n        if (!isNullOrUndefined(lf.listId) || !isNullOrUndefined(lf.listLevelNumber)) {\n            writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n            if (!isNullOrUndefined(lf.listLevelNumber) && lf.listLevelNumber !== -1) {\n                writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, lf.listLevelNumber.toString());\n                writer.writeEndElement();\n            }\n            if (!isNullOrUndefined(lf.listId) && lf.listId !== -1) {\n                writer.writeStartElement(undefined, 'numId', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, (lf.listId + 1).toString());\n                writer.writeEndElement();\n            }\n            writer.writeEndElement();\n        }\n    };\n    // // Serializes the numbering properties to the paragraph\n    // private serializeNumPr(writer: XmlWriter, listId: number, listLevel: number): void {\n    //     writer.writeStartElement(undefined, 'numPr', this.wNamespace);\n    //     if (listLevel !== -1) {\n    //         writer.writeStartElement(undefined, 'ilvl', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listLevel.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     if (listId !== -1) {\n    //         writer.writeStartElement(undefined, 'numId', this.wNamespace);\n    //         writer.writeAttributeString('w', 'val', this.wNamespace, listId.toString());\n    //         writer.writeEndElement();\n    //     }\n    //     writer.writeEndElement();\n    // }\n    WordExport.prototype.serializeParagraphAlignment = function (writer, txtAlignment) {\n        if (!isNullOrUndefined(txtAlignment)) {\n            writer.writeStartElement(undefined, 'jc', this.wNamespace);\n            var alignment = void 0;\n            switch (txtAlignment) {\n                case 'Center':\n                    alignment = 'center';\n                    break;\n                case 'Right':\n                    alignment = 'right';\n                    break;\n                case 'Justify':\n                    alignment = 'both';\n                    break;\n                default:\n                    alignment = 'left';\n                    break;\n            }\n            writer.writeAttributeString('w', 'val', this.wNamespace, alignment);\n            writer.writeEndElement();\n        }\n    };\n    // Serializes the paragraph spacings\n    WordExport.prototype.serializeParagraphSpacing = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'spacing', this.wNamespace);\n        // if (paragraphFormat.HasValue(WParagraphFormat.BeforeLinesKey))\n        // {\n        //     short beforeLines = (short)Math.Round(paragraphFormat.BeforeLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('beforeLines', this.wNamespace, ToString((float)beforeLines));               \n        // }\n        // if (paragraphFormat.HasValue(WParagraphFormat.AfterLinesKey))\n        // {\n        //     short afterLines = (short)Math.Round(paragraphFormat.AfterLines * DLSConstants.HundredthsUnit);\n        //     writer.WriteAttributeString('afterLines', this.wNamespace, ToString((float)afterLines));                 \n        // }\n        // tslint:disable-next-line:max-line-length\n        if (!isNullOrUndefined(paragraphFormat.beforeSpacing)) {\n            writer.writeAttributeString(undefined, 'before', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.beforeSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingBeforeAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceBeforeAuto)\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('beforeAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        if (!isNullOrUndefined(paragraphFormat.afterSpacing)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'after', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        }\n        //TODO:ISSUEFIX(paragraphFormat.afterSpacing * this.twentiethOfPoint).toString());\n        // if (paragraphFormat.HasValue(WParagraphFormat.SpacingAfterAutoKey))\n        // {\n        //     if (paragraphFormat.SpaceAfterAuto)\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '1');\n        //     }\n        //     else\n        //     {\n        //         writer.WriteAttributeString('afterAutospacing', this.wNamespace, '0');\n        //     }\n        // }\n        writer.writeAttributeString(undefined, 'line', this.wNamespace, '240');\n        //TODO:ISSUEFIX((paragraphFormat.lineSpacing) * this.twentiethOfPoint).toString());\n        switch (paragraphFormat.lineSpacingType) {\n            case 'AtLeast':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'atLeast');\n                break;\n            case 'Exactly':\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'exact');\n                break;\n            default:\n                writer.writeAttributeString(undefined, 'lineRule', this.wNamespace, 'auto');\n                break;\n        }\n        writer.writeEndElement();\n    };\n    // Serializes the paragraph indentation\n    WordExport.prototype.serializeIndentation = function (writer, paragraphFormat) {\n        writer.writeStartElement(undefined, 'ind', this.wNamespace);\n        if (!isNullOrUndefined(paragraphFormat.leftIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'left', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.leftIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.rightIndent)) {\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString(undefined, 'right', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.rightIndent * this.twipsInOnePoint).toString());\n        }\n        if (!isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n            if (paragraphFormat.firstLineIndent < 0) {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'hanging', this.wNamespace, this.roundToTwoDecimal(-1 * paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n            else {\n                // tslint:disable-next-line:max-line-length\n                writer.writeAttributeString(undefined, 'firstLine', this.wNamespace, this.roundToTwoDecimal(paragraphFormat.firstLineIndent * this.twipsInOnePoint).toString());\n            }\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the styles (styles.xml)\n    WordExport.prototype.serializeStyles = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'styles', this.wNamespace);\n        writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'w', undefined, this.wNamespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        //writes the document defaults, latent styles and default styles.\n        this.serializeDefaultStyles(writer);\n        //writes the document styles\n        this.serializeDocumentStyles(writer);\n        writer.writeEndElement(); //end of styles tag\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.stylePath);\n        this.mArchive.addItem(zipArchiveItem); //this.stylePath, styleStream, false, FileAttributes.Archive);\n    };\n    // Serializes the default styles (document default paragraph and character format)\n    WordExport.prototype.serializeDefaultStyles = function (writer) {\n        writer.writeStartElement(undefined, 'docDefaults', this.wNamespace);\n        //if (HasDefaultCharFormat())\n        //{\n        writer.writeStartElement(undefined, 'rPrDefault', this.wNamespace);\n        // if (!isNullOrUndefined(this.mDocument.characterFormat)) {\n        this.serializeCharacterFormat(writer, this.defCharacterFormat);\n        writer.writeEndElement(); // end of rPrDefault\n        // }\n        // else {\n        //     writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        //     writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n        //     if (!string.IsNullOrEmpty(m_document.StandardAsciiFont))\n        //         writer.WriteAttributeString('ascii', this.wNamespace, m_document.StandardAsciiFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardFarEastFont))\n        //         writer.WriteAttributeString('eastAsia', this.wNamespace, m_document.StandardFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardNonFarEastFont))\n        //         writer.WriteAttributeString('hAnsi', this.wNamespace, m_document.StandardNonFarEastFont);\n        //     if (!string.IsNullOrEmpty(m_document.StandardBidiFont))\n        //         writer.WriteAttributeString('cs', this.wNamespace, m_document.StandardBidiFont);\n        //     writer.WriteEndElement();\n        //     float fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('sz', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     fontSize = GetDefFontSize(m_document, WCharacterFormat.FontSizeBidiKey);\n        //     if (fontSize !== 0f)\n        //     {\n        //         writer.WriteStartElement('szCs', this.wNamespace);\n        //         writer.WriteAttributeString('val', this.wNamespace, (fontSize * 2).ToString(CultureInfo.InvariantCulture));\n        //         writer.WriteEndElement();\n        //     }\n        //     writer.WriteEndElement();\n        // }\n        // writer.WriteEndElement();\n        // //}\n        writer.writeStartElement(undefined, 'pPrDefault', this.wNamespace);\n        if (!isNullOrUndefined(this.defParagraphFormat)) {\n            writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n            this.serializeParagraphFormat(writer, this.defParagraphFormat, undefined);\n            writer.writeEndElement(); //end of pPr\n        }\n        writer.writeEndElement(); //end of pPrDefault\n        // writer.WriteEndElement();\n        // SerializeLatentStyles();\n        // //Default styles\n        // if (m_document.Styles.length === 0 || isNullOrUndefined(m_document.Styles.FindByName('Normal')))\n        // {\n        //     SerializeDefaultParagraphStyle();\n        // }\n        // if (!IsDocumentContainsDefaultTableStyle())\n        // {\n        //     SerializeTableNormalStyle();\n        // }\n        // if (isNullOrUndefined(m_document.Styles.FindByName('No List')) && isNullOrUndefined(m_document.Styles.FindByName('NoList')))\n        //     SerializeNoListStyle();\n        // tslint:disable-next-line:max-line-length\n        // if (isNullOrUndefined(m_document.Styles.FindByName('Table Grid')) && isNullOrUndefined(m_document.Styles.FindByName('TableGrid')))\n        // {\n        //     SerializeTableGridStyle();\n        // }\n        // }        \n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeDocumentStyles = function (writer) {\n        for (var i = 0; i < this.mStyles.length; i++) {\n            var style = this.mStyles[i];\n            writer.writeStartElement(undefined, 'style', this.wNamespace);\n            var type = style.type === 'Paragraph' ? 'paragraph' : 'character';\n            writer.writeAttributeString('w', 'type', this.wNamespace, type);\n            writer.writeAttributeString('w', 'styleId', this.wNamespace, style.name);\n            //name\n            writer.writeStartElement(undefined, 'name', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, style.name);\n            writer.writeEndElement();\n            //basedOn\n            if (!isNullOrUndefined(style.basedOn)) {\n                writer.writeStartElement(undefined, 'basedOn', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.basedOn);\n                writer.writeEndElement();\n            }\n            //next\n            if (!isNullOrUndefined(style.next)) {\n                writer.writeStartElement(undefined, 'next', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.next);\n                writer.writeEndElement();\n            }\n            //link\n            if (!isNullOrUndefined(style.link)) {\n                writer.writeStartElement(undefined, 'link', this.wNamespace);\n                writer.writeAttributeString('w', 'val', this.wNamespace, style.link);\n                writer.writeEndElement();\n            }\n            if (style.type === 'Paragraph') {\n                writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n                this.serializeParagraphFormat(writer, style.paragraphFormat, undefined);\n                writer.writeEndElement();\n            }\n            // let value = (style.characterFormat as WCharacterFormat).newgetCharacterFormat();\n            this.serializeCharacterFormat(writer, style.characterFormat);\n            writer.writeEndElement(); //end of Style\n        }\n    };\n    // Serializes the Character format\n    WordExport.prototype.serializeCharacterFormat = function (writer, characterFormat) {\n        writer.writeStartElement(undefined, 'rPr', this.wNamespace);\n        if (!isNullOrUndefined(characterFormat.styleName)) {\n            writer.writeStartElement(undefined, 'rStyle', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, characterFormat.styleName);\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontFamily)) {\n            writer.writeStartElement(undefined, 'rFonts', this.wNamespace);\n            writer.writeAttributeString(undefined, 'ascii', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'hAnsi', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'eastAsia', this.wNamespace, characterFormat.fontFamily);\n            writer.writeAttributeString(undefined, 'cs', this.wNamespace, characterFormat.fontFamily);\n            writer.writeEndElement(); //end         \n        }\n        if (!isNullOrUndefined(characterFormat.bold)) {\n            this.serializeBoolProperty(writer, 'b', characterFormat.bold);\n        }\n        if (!isNullOrUndefined(characterFormat.italic)) {\n            this.serializeBoolProperty(writer, 'i', characterFormat.italic);\n        }\n        if (!isNullOrUndefined(characterFormat.strikethrough)) {\n            switch (characterFormat.strikethrough) {\n                case 'SingleStrike':\n                    this.serializeBoolProperty(writer, 'strike', true);\n                    break;\n                case 'DoubleStrike':\n                    this.serializeBoolProperty(writer, 'dstrike', true);\n                    break;\n                default:\n                    this.serializeBoolProperty(writer, 'strike', false);\n                    this.serializeBoolProperty(writer, 'dstrike', false);\n                    break;\n            }\n        }\n        if (!isNullOrUndefined(characterFormat.fontColor)) {\n            writer.writeStartElement(undefined, 'color', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getColor(characterFormat.fontColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.fontSize)) {\n            writer.writeStartElement(undefined, 'sz', this.wNamespace);\n            // tslint:disable-next-line:max-line-length\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.roundToTwoDecimal(characterFormat.fontSize * 2).toString());\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.highlightColor) && characterFormat.highlightColor !== 'NoColor') {\n            writer.writeStartElement(undefined, 'highlight', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getHighlightColor(characterFormat.highlightColor));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.underline) && characterFormat.underline !== 'None') {\n            writer.writeStartElement(undefined, 'u', this.wNamespace);\n            writer.writeAttributeString('w', 'val', this.wNamespace, this.getUnderlineStyle(characterFormat.underline));\n            writer.writeEndElement();\n        }\n        if (!isNullOrUndefined(characterFormat.baselineAlignment)) {\n            writer.writeStartElement(undefined, 'vertAlign', this.wNamespace);\n            switch (characterFormat.baselineAlignment) {\n                case 'Subscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'subscript');\n                    break;\n                case 'Superscript':\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'superscript');\n                    break;\n                default:\n                    writer.writeAttributeString('w', 'val', this.wNamespace, 'baseline');\n                    break;\n            }\n            writer.writeEndElement();\n        }\n        writer.writeEndElement(); //end of rPrChange\n    };\n    WordExport.prototype.getColor = function (color) {\n        if (color.length > 0) {\n            if (color[0] === '#') {\n                color = color.substr(1);\n            }\n            if (color.length > 6) {\n                color = color.substr(0, 6);\n            }\n        }\n        return color;\n    };\n    // Get the underline style as string\n    WordExport.prototype.getUnderlineStyle = function (underlineStyle) {\n        switch (underlineStyle) {\n            case 'DotDotDashHeavy':\n                return 'dashDotDotHeavy';\n            case 'DotDashHeavy':\n                return 'dashDotHeavy';\n            case 'DashHeavy':\n                return 'dashedHeavy';\n            case 'DashLong':\n                return 'dashLong';\n            case 'DashLongHeavy':\n                return 'dashLongHeavy';\n            case 'DotDash':\n                return 'dotDash';\n            case 'DotDotDash':\n                return 'dotDotDash';\n            case 'Dotted':\n                return 'dotted';\n            case 'DottedHeavy':\n                return 'dottedHeavy';\n            case 'Double':\n                return 'double';\n            case 'Single':\n                return 'single';\n            case 'Thick':\n                return 'thick';\n            case 'Wavy':\n                return 'wave';\n            case 'WavyDouble':\n                return 'wavyDouble';\n            case 'WavyHeavy':\n                return 'wavyHeavy';\n            case 'Words':\n                return 'words';\n            default:\n                return 'dash';\n        }\n    };\n    WordExport.prototype.getHighlightColor = function (highlight) {\n        switch (highlight) {\n            // Highlights the content with bright green (#ff00ff00) color.\n            case 'BrightGreen':\n                return 'green';\n            // Highlights the content with turquoise (#ff00ffff) color.\n            case 'Turquoise':\n                return 'cyan';\n            // Highlights the content with pink (#ffff00ff) color.\n            case 'Pink':\n                return 'magenta';\n            // Highlights the content with blue (#ff0000ff) color.\n            case 'Blue':\n                return 'blue';\n            // Highlights the content with red (#ffff0000) color.\n            case 'Red':\n                return 'red';\n            // Highlights the content with dark blue (#ff000080) color.\n            case 'DarkBlue':\n                return 'darkBlue';\n            // Highlights the content with teal (#ff008080) color.\n            case 'Teal':\n                return 'darkCyan';\n            // Highlights the content with green (#ff008000) color.\n            case 'Green':\n                return 'darkGreen';\n            // Highlights the content with violet (#ff800080) color.\n            case 'Violet':\n                return 'darkMagenta';\n            // Highlights the content with dark red (#ff800000) color.\n            case 'DarkRed':\n                return 'darkRed';\n            // Highlights the content with dark yellow (#ff808000)  color.\n            case 'DarkYellow':\n                return 'darkYellow';\n            // Highlights the content with gray 50 (#ff808080) color.\n            case 'Gray50':\n                return 'darkGray';\n            // Highlights the content with gray 25 (#ffc0c0c0) color.\n            case 'Gray25':\n                return 'lightGray';\n            // Highlights the content with black (#ff000000) color.\n            case 'Black':\n                return 'black';\n            // Highlights the content with yellow (#ffffff00) color.\n            default:\n                return 'yellow';\n        }\n    };\n    /*private toggleFirstCahar(text: string) {\n        return text.charAt(0).toLowerCase() + text.slice(1);\n    }*/\n    // Serializes the bool character format property\n    WordExport.prototype.serializeBoolProperty = function (writer, tag, value) {\n        writer.writeStartElement(undefined, tag, this.wNamespace);\n        if (!value) {\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n        }\n        writer.writeEndElement();\n    };\n    // Serialize the list styles and numberings (numberings.xml)\n    WordExport.prototype.serializeNumberings = function () {\n        if (this.document.lists.length === 0) {\n            return;\n        }\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'numbering', this.wNamespace);\n        this.writeCommonAttributeStrings(writer);\n        // this.serializePictureBullets(writer, this.mDocument.lists);\n        this.serializeAbstractListStyles(writer, this.document.abstractLists);\n        this.serializeListInstances(writer, this.document.lists);\n        // SerializeListOverrides(writer, this.mDocument.ridesm_document.ListOverrides);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.numberingPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the abstract list styles\n    WordExport.prototype.serializeAbstractListStyles = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var abstractList = listStyles[i];\n            writer.writeStartElement(undefined, 'abstractNum', this.wNamespace);\n            writer.writeAttributeString(undefined, 'abstractNumId', this.wNamespace, abstractList.abstractListId.toString());\n            writer.writeStartElement(undefined, 'nsid', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, this.generateHex());\n            writer.writeEndElement();\n            for (var ilvl = 0, cnt = abstractList.levels.length; ilvl < cnt; ilvl++) {\n                this.serializeListLevel(writer, abstractList.levels[ilvl], ilvl);\n            }\n            writer.writeEndElement(); //end of abstractNum\n        }\n    };\n    // Serializes the list styles\n    WordExport.prototype.serializeListInstances = function (writer, listStyles) {\n        for (var i = 0; i < listStyles.length; i++) {\n            var list = listStyles[i];\n            writer.writeStartElement(undefined, 'num', this.wNamespace);\n            writer.writeAttributeString(undefined, 'numId', this.wNamespace, (list.listId + 1).toString());\n            writer.writeStartElement(undefined, 'abstractNumId', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, list.abstractListId.toString());\n            writer.writeEndElement();\n            writer.writeEndElement();\n        }\n    };\n    WordExport.prototype.generateHex = function () {\n        return (Math.floor(Math.random() * (4000000000 - 270000000)) + 270000000).toString(16).toUpperCase();\n    };\n    WordExport.prototype.roundToTwoDecimal = function (num) {\n        return Math.round(num); // * 100) / 100;\n    };\n    // Serialize the list level\n    WordExport.prototype.serializeListLevel = function (writer, listLevel, levelIndex) {\n        writer.writeStartElement(undefined, 'lvl', this.wNamespace);\n        writer.writeAttributeString(undefined, 'ilvl', this.wNamespace, levelIndex.toString());\n        writer.writeStartElement(undefined, 'start', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, listLevel.startAt.toString());\n        writer.writeEndElement();\n        writer.writeStartElement(undefined, 'numFmt', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, this.getLevelPattern(listLevel.listLevelPattern));\n        writer.writeEndElement();\n        if (listLevel.restartLevel > 0) {\n            writer.writeStartElement(undefined, 'lvlRestart', this.wNamespace);\n            writer.writeAttributeString(undefined, 'val', this.wNamespace, '0');\n            writer.writeEndElement();\n        }\n        // if (!isNullOrUndefined(listLevel.paragraphFormat)) {\n        //     string name = listLevel.ParaStyleName.Substring(0, 1).ToUpper() + listLevel.ParaStyleName.Remove(0, 1);\n        //     writer.WriteStartElement('pStyle', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, name);\n        //     writer.WriteEndElement();\n        // }\n        // if (listLevel.IsLegalStyleNumbering) {\n        //     writer.WriteStartElement('isLgl', this.wNamespace);\n        //     writer.WriteEndElement();\n        // }\n        this.serializeLevelFollow(writer, listLevel);\n        this.serializeLevelText(writer, listLevel, levelIndex + 1);\n        // SerializeLegacyProperties(listLevel);\n        // if (listLevel.PicBulletId > 0) {\n        //     writer.WriteStartElement('lvlPicBulletId', this.wNamespace);\n        //     writer.WriteAttributeString('val', this.wNamespace, listLevel.PicBulletId.ToString());\n        //     writer.WriteEndElement();\n        // }\n        // //lvlJc\n        // if (listLevel.NumberAlignment !== ListNumberAlignment.Left) {\n        //     writer.WriteStartElement('lvlJc', this.wNamespace);\n        //     string alignment = string.Empty;\n        //     if (listLevel.NumberAlignment === ListNumberAlignment.Right) {\n        //         alignment = 'right';\n        //     }\n        //     else {\n        //         alignment = 'center';\n        //     }\n        //     writer.WriteAttributeString('val', this.wNamespace, alignment);\n        //     writer.WriteEndElement();\n        // }\n        writer.writeStartElement(undefined, 'pPr', this.wNamespace);\n        this.serializeParagraphFormat(writer, listLevel.paragraphFormat, undefined);\n        writer.writeEndElement(); //end of pPr\n        this.serializeCharacterFormat(writer, listLevel.characterFormat);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.getLevelPattern = function (levelPattern) {\n        var patternType;\n        switch (levelPattern) {\n            case 'Arabic':\n                patternType = 'decimal';\n                break;\n            case 'UpRoman':\n                patternType = 'upperRoman';\n                break;\n            case 'LowRoman':\n                patternType = 'lowerRoman';\n                break;\n            case 'UpLetter':\n                patternType = 'upperLetter';\n                break;\n            case 'LowLetter':\n                patternType = 'lowerLetter';\n                break;\n            // case 'Ordinal':\n            //     patternType = 'ordinal';\n            //     break;\n            // case 'Number':\n            //     patternType = 'cardinalText';\n            //     break;\n            // case 'OrdinalText':\n            //     patternType = 'ordinalText';\n            //     break;\n            // case 'LeadingZero':\n            //     patternType = 'decimalZero';\n            //     break;\n            // case 'Bullet':\n            default:\n                patternType = 'bullet';\n                break;\n            // case 'FarEast':\n            //     patternType = 'aiueoFullWidth';\n            //     break;\n            // case 'Special':\n            //     patternType = 'russianLower';\n            //     break;\n            // case 'None':\n            //     patternType = 'none';\n            //     break;\n        }\n        return patternType;\n    };\n    // Serializes the level text\n    WordExport.prototype.serializeLevelText = function (writer, listLevel, lvlIndex) {\n        writer.writeStartElement(undefined, 'lvlText', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, (listLevel.numberFormat));\n        writer.writeEndElement();\n    };\n    // Serialize the level follow character\n    WordExport.prototype.serializeLevelFollow = function (writer, listLevel) {\n        var fc;\n        //TODO:Type issue returns number instead of string\n        if (listLevel.followCharacter === 'Tab') {\n            fc = 'tab';\n        }\n        else if (listLevel.followCharacter === 'Space') {\n            fc = 'space';\n        }\n        else {\n            fc = 'nothing';\n        }\n        writer.writeStartElement(undefined, 'suff', this.wNamespace);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, fc);\n        writer.writeEndElement();\n    };\n    WordExport.prototype.serializeSettings = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'settings', this.wNamespace);\n        this.writeCustom(writer);\n        // writer.writeAttributeString('xmlns', 'mc', undefined, this.veNamespace);\n        // writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        // writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        // writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        // writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'w14', undefined, this.w14Namespace);\n        writer.writeAttributeString('xmlns', 'w15', undefined, this.w15Namespace);\n        writer.writeAttributeString('xmlns', 'sl', undefined, this.slNamespace);\n        writer.writeAttributeString('mc', 'Ignorable', undefined, 'w14 w15');\n        // //w:writeProtection - Write Protection\n        // if (m_document.WriteProtected)\n        // {\n        //     writer.writeStartElement('w', 'writeProtection', this.wNamespace);\n        //     writer.writeAttributeString('recommended', this.wNamespace, '1');\n        //     writer.writeEndElement();\n        // }\n        //w:view - Document View Setting\n        // if (this.mDocument.ViewSetup.DocumentViewType !== DocumentViewType.PrintLayout &&\n        //   m_document.ViewSetup.DocumentViewType !== DocumentViewType.NormalLayout)\n        // {\n        //     writer.writeStartElement('view', this.wNamespace);\n        //     string viewTypeStr = string.Empty;\n        //     if (m_document.ViewSetup.DocumentViewType === DocumentViewType.OutlineLayout)\n        //     {\n        //         viewTypeStr = 'outline';\n        //     }\n        //     else if (m_document.ViewSetup.DocumentViewType === DocumentViewType.WebLayout)\n        //     {\n        //         viewTypeStr = 'web';\n        //     }\n        //     writer.writeAttributeString('val', this.wNamespace, viewTypeStr);\n        //     writer.writeEndElement();\n        // }\n        //w:zoom - Magnification Setting\n        writer.writeStartElement('w', 'zoom', this.wNamespace);\n        // switch (m_document.ViewSetup.ZoomType)\n        // {\n        //     case ZoomType.FullPage:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'fullPage');\n        //         break;\n        //     case ZoomType.PageWidth:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'bestFit');\n        //         break;\n        //     case ZoomType.TextFit:\n        //         writer.writeAttributeString('w', 'val', this.wNamespace, 'textFit');\n        //         break;\n        // default:\n        writer.writeAttributeString('w', 'val', this.wNamespace, 'none');\n        // break;\n        // }\n        writer.writeAttributeString('w', 'percent', this.wNamespace, '100');\n        writer.writeEndElement();\n        //w:displayBackgroundShape - Display Background Objects When Displaying Document\n        // if (m_document.Background.Type !== BackgroundType.NoBackground)\n        // {\n        writer.writeStartElement(undefined, 'displayBackgroundShape', this.wNamespace);\n        writer.writeEndElement();\n        // }\n        //w:defaultTabStop - Distance Between Automatic Tab Stops\n        writer.writeStartElement(undefined, 'defaultTabStop', this.wNamespace);\n        var tabWidth = Math.round(this.defaultTabWidthValue * this.twipsInOnePoint);\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, tabWidth.toString());\n        writer.writeEndElement();\n        //w:evenAndOddHeaders - Different Even/Odd Page Headers and Footers        \n        if (this.mDifferentFirstPage) {\n            writer.writeStartElement(undefined, 'evenAndOddHeaders', this.wNamespace);\n            writer.writeEndElement();\n        }\n        //w:footnotePr - Document-Wide Footnote Properties and w:endnotePr - Document-Wide Endnote Properties\n        // SerializeFootnoteSettings();\n        //w:compat - Compatibility Settings\n        writer.writeStartElement(undefined, 'compat', this.wNamespace);\n        writer.writeStartElement(undefined, 'compatSetting', this.wNamespace);\n        writer.writeAttributeString(undefined, 'name', this.wNamespace, 'compatibilityMode');\n        writer.writeAttributeString(undefined, 'uri', this.wNamespace, 'http://schemas.microsoft.com/office/word');\n        writer.writeAttributeString(undefined, 'val', this.wNamespace, '15');\n        writer.writeEndElement();\n        writer.writeEndElement();\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.settingsPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeCoreProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeAppProperties = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeFontTable = function (contentType) {\n        //implementation\n    };\n    WordExport.prototype.serializeSettingsRelation = function () {\n        //implementation\n    };\n    WordExport.prototype.serializeHeaderFooters = function () {\n        this.serializeHeaderFooter('EvenFooter');\n        this.serializeHeaderFooter('EvenHeader');\n        this.serializeHeaderFooter('FirstPageFooter');\n        this.serializeHeaderFooter('FirstPageHeader');\n        this.serializeHeaderFooter('OddFooter');\n        this.serializeHeaderFooter('OddHeader');\n    };\n    // Serializes the Header/Footer\n    WordExport.prototype.serializeHeaderFooter = function (hfType) {\n        if (this.headersFooters.length === 0) {\n            return;\n        }\n        var headerFooterPath;\n        var headerFooterRelsPath;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        var hf = undefined;\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            hf = hfColl.get(id);\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = this.headerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.headerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeHeader(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n            else {\n                headerFooterPath = this.footerPath + id.replace('rId', '') + '.xml';\n                headerFooterRelsPath = this.footerRelationPath + id.replace('rId', '') + '.xml.rels';\n                this.serializeFooter(hf, id, headerFooterPath, headerFooterRelsPath);\n            }\n        }\n    };\n    // Serialize the header part\n    WordExport.prototype.serializeHeader = function (header, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = header;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'hdr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        var owner = this.blockOwner;\n        this.blockOwner = header;\n        this.serializeBodyItems(writer, header.blocks, true);\n        this.blockOwner = owner;\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n        this.headerFooter = undefined;\n    };\n    // Serializes the HeaderFooter relations\n    WordExport.prototype.serializeHFRelations = function (hfId, headerFooterRelsPath) {\n        var hasHFImage = this.headerFooterImages.containsKey(hfId);\n        // let hasHFHyperlinks = HeaderFooterHyperlinks.ContainsKey(hfId);\n        // let hasHFInclPics = HeaderFooterInclPicUrls.ContainsKey(hfId);\n        // let hasHFAlternateChunks = HeaderFooterAlternateChunks.ContainsKey(hfId);\n        if (hasHFImage) { // || hasHFHyperlinks ||hasHFAlternateChunks\n            var writer = new XmlWriter();\n            writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n            this.serializeImagesRelations(this.headerFooterImages.get(hfId), writer);\n            // if (hasHFHyperlinks)\n            //     SerializeHyperlinkRelations(stream, HeaderFooterHyperlinks[hfId]);\n            // if (hasHFAlternateChunks)\n            //     SerializeAltChunkRelations(stream, HeaderFooterAlternateChunks[hfId]);\n            // if (hasHFInclPics)\n            //     SerializeIncludePictureUrlRelations(stream, HeaderFooterInclPicUrls[hfId]);\n            // if (HFOleContainers.ContainsKey(hfId))\n            // {\n            //     AddOLEToZip(HFOleContainers[hfId]);\n            // }\n            // if (HFRelations.ContainsKey(hfId))\n            //     SerializeHFCommonRelations(stream, HFRelations[hfId]);\n            writer.writeEndElement();\n            var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterRelsPath);\n            this.mArchive.addItem(zipArchiveItem);\n        }\n        else {\n            return;\n        }\n    };\n    WordExport.prototype.writeHFCommonAttributes = function (writer) {\n        writer.writeAttributeString('xmlns', 'v', undefined, this.vNamespace);\n        writer.writeAttributeString('xmlns', 'w10', undefined, this.w10Namespace);\n        writer.writeAttributeString('xmlns', 'o', undefined, this.oNamespace);\n        writer.writeAttributeString('xmlns', 've', undefined, this.veNamespace);\n        writer.writeAttributeString('xmlns', 'r', undefined, this.rNamespace);\n        writer.writeAttributeString('xmlns', 'm', undefined, this.mNamespace);\n        writer.writeAttributeString('xmlns', 'wne', undefined, this.wneNamespace);\n        writer.writeAttributeString('xmlns', 'a', undefined, this.aNamespace);\n        writer.writeAttributeString('xmlns', 'pic', undefined, this.pictureNamespace);\n        writer.writeAttributeString('xmlns', 'wp', undefined, this.wpNamespace);\n        writer.writeAttributeString('xmlns', 'wpc', undefined, this.wpCanvasNamespace);\n        writer.writeAttributeString('xmlns', 'wp14', undefined, this.wpDrawingNamespace);\n        this.writeDup(writer);\n        writer.writeAttributeString('xmlns', 'wps', undefined, this.wpShapeNamespace);\n        writer.writeAttributeString('ve', 'Ignorable', undefined, 'w14 w15 wp14');\n    };\n    // Serailize the footer and its relations\n    WordExport.prototype.serializeFooter = function (footer, id, headerFooterPath, headerFooterRelsPath) {\n        this.headerFooter = footer;\n        var writer = new XmlWriter();\n        writer.writeStartElement('w', 'ftr', this.wNamespace);\n        this.writeHFCommonAttributes(writer);\n        this.serializeBodyItems(writer, footer.blocks, true);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, headerFooterPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.serializeHFRelations(id, headerFooterRelsPath);\n    };\n    WordExport.prototype.serializeDocumentRelations = function () {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.stylesRelType, 'styles.xml');\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.settingsRelType, 'settings.xml');\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.ThemeRelType, 'theme/theme1.xml');\n        if (this.document.lists.length > 0) {\n            this.serializeRelationShip(writer, this.getNextRelationShipID(), this.numberingRelType, 'numbering.xml');\n        }\n        this.serializeHeaderFooterRelations(writer);\n        // if (HasFontTable) {\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.FontTableRelType, 'fontTable.xml');\n        // }\n        // SerializeIncludePictureUrlRelations(docRelstream, InclPicFieldUrl);\n        // //// Creating relationships for every hyperlink and image containing in the document\n        this.serializeImagesRelations(this.documentImages, writer);\n        // SerializeSvgImageRelation();\n        //this.serializeExternalLinkImages(writer);\n        // if (HasHyperlink && HyperlinkTargets.length > 0) {\n        //     SerializeHyperlinkRelations(docRelstream, HyperlinkTargets);\n        // }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled)\n        //     SerializeRelationShip(docRelstream, GetNextRelationShipID(), this.VbaProjectRelType, this.VbaProject);\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.wordRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n        this.headerFooter = undefined;\n    };\n    // Serializes the image relations\n    WordExport.prototype.serializeImagesRelations = function (images, writer) {\n        if (images.length > 0) {\n            var imagePath = '';\n            var base64ImageString = void 0;\n            var keys = images.keys;\n            for (var i = 0; i < keys.length; i++) {\n                var mImage = images.get(keys[i]);\n                base64ImageString = mImage.imageString;\n                if (isNullOrUndefined(base64ImageString)) {\n                    imagePath = this.imagePath + '/0.jpeg';\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                }\n                else {\n                    var extension = '';\n                    var formatClippedString = '';\n                    if (this.startsWith(base64ImageString, 'data:image/bmp;base64,')) {\n                        extension = '.bmp';\n                        formatClippedString = base64ImageString.replace('data:image/bmp;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-emf;base64,')) {\n                        extension = '.emf';\n                        formatClippedString = base64ImageString.replace('data:image/x-emf;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/exif;base64,')) {\n                        extension = '.exif';\n                        formatClippedString = base64ImageString.replace('data:image/exif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/gif;base64,')) {\n                        extension = '.gif';\n                        formatClippedString = base64ImageString.replace('data:image/gif;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/icon;base64,')) {\n                        extension = '.ico';\n                        formatClippedString = base64ImageString.replace('data:image/icon;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpeg;base64,')) {\n                        extension = '.jpeg';\n                        formatClippedString = base64ImageString.replace('data:image/jpeg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/jpg;base64,')) {\n                        extension = '.jpg';\n                        formatClippedString = base64ImageString.replace('data:image/jpg;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/png;base64,')) {\n                        extension = '.png';\n                        formatClippedString = base64ImageString.replace('data:image/png;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/tiff;base64,')) {\n                        extension = '.tif';\n                        formatClippedString = base64ImageString.replace('data:image/tiff;base64,', '');\n                    }\n                    else if (this.startsWith(base64ImageString, 'data:image/x-wmf;base64,')) {\n                        extension = '.wmf';\n                        formatClippedString = base64ImageString.replace('data:image/x-wmf;base64,', '');\n                    }\n                    else {\n                        extension = '.jpeg';\n                    }\n                    imagePath = this.imagePath + keys[i] + extension;\n                    this.serializeRelationShip(writer, keys[i], this.imageRelType, imagePath.replace('word/', ''));\n                    //if (m_archive.Find(imagePath.Replace('\\\\', '/')) === -1)\n                    // {\n                    var imageBlob = new Blob([this.encodedString(formatClippedString)]);\n                    var zipArchiveItem = new ZipArchiveItem(imageBlob, imagePath);\n                    // let TestArchive = new ZipArchive();\n                    this.mArchive.addItem(zipArchiveItem);\n                    // TestArchive.save('image.zip').then(function (): void {\n                    //     TestArchive.destroy();\n                    // });\n                    // }\n                }\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    WordExport.prototype.encodedString = function (input) {\n        var keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n        var chr1;\n        var chr2;\n        var chr3;\n        var enc1;\n        var enc2;\n        var enc3;\n        var enc4;\n        var i = 0;\n        var resultIndex = 0;\n        /*let dataUrlPrefix: string = 'data:';*/\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, '');\n        var totalLength = input.length * 3 / 4;\n        if (input.charAt(input.length - 1) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (input.charAt(input.length - 2) === keyStr.charAt(64)) {\n            totalLength--;\n        }\n        if (totalLength % 1 !== 0) {\n            // totalLength is not an integer, the length does not match a valid\n            // base64 content. That can happen if:\n            // - the input is not a base64 content\n            // - the input is *almost* a base64 content, with a extra chars at the\n            // beginning or at the end\n            // - the input uses a base64 variant (base64url for example)\n            throw new Error('Invalid base64 input, bad content length.');\n        }\n        var output = new Uint8Array(totalLength | 0);\n        while (i < input.length) {\n            enc1 = keyStr.indexOf(input.charAt(i++));\n            enc2 = keyStr.indexOf(input.charAt(i++));\n            enc3 = keyStr.indexOf(input.charAt(i++));\n            enc4 = keyStr.indexOf(input.charAt(i++));\n            chr1 = (enc1 << 2) | (enc2 >> 4);\n            chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);\n            chr3 = ((enc3 & 3) << 6) | enc4;\n            output[resultIndex++] = chr1;\n            if (enc3 !== 64) {\n                output[resultIndex++] = chr2;\n            }\n            if (enc4 !== 64) {\n                output[resultIndex++] = chr3;\n            }\n        }\n        return output;\n    };\n    WordExport.prototype.serializeExternalLinkImages = function (writer) {\n        var imagePath = '';\n        var keys = this.externalImages.keys;\n        for (var i = 0; i < this.externalImages.keys.length; i++) {\n            this.serializeRelationShip(writer, keys[i], this.imageRelType, this.externalImages.get(keys[i]));\n        }\n    };\n    // Serializes the HeaderFooters relations to the document relations stream\n    WordExport.prototype.serializeHeaderFooterRelations = function (writer) {\n        this.serializeHFRelation(writer, 'EvenFooter');\n        this.serializeHFRelation(writer, 'EvenHeader');\n        this.serializeHFRelation(writer, 'FirstPageFooter');\n        this.serializeHFRelation(writer, 'FirstPageHeader');\n        this.serializeHFRelation(writer, 'OddFooter');\n        this.serializeHFRelation(writer, 'OddHeader');\n    };\n    // Serializes the headers footers relations.\n    WordExport.prototype.serializeHFRelation = function (writer, hfType) {\n        var headerFooterPath = '';\n        var relType;\n        if (!this.headersFooters.containsKey(hfType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(hfType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (hfType === 'EvenHeader' || hfType === 'FirstPageHeader' ||\n                hfType === 'OddHeader') {\n                headerFooterPath = 'header' + id.replace('rId', '') + '.xml';\n                relType = this.headerRelType;\n            }\n            else {\n                headerFooterPath = 'footer' + id.replace('rId', '') + '.xml';\n                relType = this.footerRelType;\n            }\n            this.serializeRelationShip(writer, id, relType, headerFooterPath);\n        }\n    };\n    // Serializes the relationship\n    WordExport.prototype.serializeRelationShip = function (writer, relationshipID, relationshipType, targetPath) {\n        writer.writeStartElement(undefined, 'Relationship', undefined);\n        writer.writeAttributeString(undefined, 'Id', undefined, relationshipID);\n        writer.writeAttributeString(undefined, 'Type', undefined, relationshipType);\n        writer.writeAttributeString(undefined, 'Target', undefined, targetPath.replace('\\\\', '/').replace('\\v', ''));\n        // tslint:disable-next-line:max-line-length\n        if (relationshipType === this.hyperlinkRelType || this.startsWith(targetPath, 'http://') || this.startsWith(targetPath, 'https://') || this.startsWith(targetPath, 'file:///')) {\n            // Uri targetUri;\n            // if ((!targetPath.StartsWith('file:///')) && Uri.TryCreate(targetPath, UriKind.Absolute, out targetUri))\n            // {\n            //     //Handled using Try catch to avoid exception if the Host name type is None because in \n            //Silverlight 'HostNameType' property is not available.\n            //     try\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetUri.AbsoluteUri);\n            //     }\n            //     catch\n            //     {\n            //         m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            //     }\n            // }\n            // else\n            // {\n            //     m_writer.WriteAttributeString('Target', targetPath.Replace('\\\\', '/').Replace(ControlChar.LineBreak, string.Empty));\n            // }\n            writer.writeAttributeString(undefined, 'TargetMode', undefined, 'External');\n        }\n        writer.writeEndElement();\n    };\n    // Get the next relationship ID\n    WordExport.prototype.getNextRelationShipID = function () {\n        return 'rId' + (++this.mRelationShipID);\n    };\n    WordExport.prototype.serializeGeneralRelations = function () {\n        var writer = new XmlWriter();\n        this.resetRelationShipID();\n        writer.writeStartElement(undefined, 'Relationships', this.rpNamespace);\n        this.serializeRelationShip(writer, this.getNextRelationShipID(), this.documentRelType, this.documentPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.AppRelType, this.appPath);\n        // this.serializeRelationShip(writer, this.getNextRelationShipID(), this.CoreRelType, this.corePath);\n        //End of Relationships tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.generalRelationPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    WordExport.prototype.serializeContentTypes = function (contentType) {\n        var writer = new XmlWriter();\n        writer.writeStartElement(undefined, 'Types', 'http://schemas.openxmlformats.org/package/2006/content-types');\n        //if (m_hasOleObject)\n        //{\n        //    //<Default Extension='bin' ContentType='application/vnd.openxmlformats-officedocument.oleObject'/>\n        //    SerializeDefaultContentType(contentStream, 'bin', 'application/vnd.openxmlformats-officedocument.oleObject');\n        //}\n        this.serializeDefaultContentType(writer, 'rels', this.relationContentType);\n        this.serializeDefaultContentType(writer, 'xml', this.xmlContentType);\n        // if (m_hasEmbedFonts && !string.IsNullOrEmpty(type))\n        // {\n        //     SerializeDefaultContentType(contentStream,type, this.fontContentType);\n        // }\n        if (this.documentImages.length > 0 || this.externalImages.length > 0 || this.headerFooterImages.length > 0) {\n            this.serializeDefaultContentType(writer, 'png', 'image/png');\n            this.serializeDefaultContentType(writer, 'bmp', 'image/bmp');\n            this.serializeDefaultContentType(writer, 'emf', 'image/x-emf');\n            this.serializeDefaultContentType(writer, 'wmf', 'image/x-wmf');\n            this.serializeDefaultContentType(writer, 'gif', 'image/gif');\n            this.serializeDefaultContentType(writer, 'ico', 'image/x-icon');\n            this.serializeDefaultContentType(writer, 'tif', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'tiff', 'image/tiff');\n            this.serializeDefaultContentType(writer, 'jpeg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'jpg', 'image/jpeg');\n            this.serializeDefaultContentType(writer, 'svg', 'image/svg+xml');\n        }\n        // if (m_document.HasMacros\n        //     && IsMacroEnabled && !m_isSkipBinExtension)\n        // {\n        //     SerializeDefaultContentType(contentStream, 'bin', this.VbaProjectContentType);\n        //     m_isSkipBinExtension = true;\n        // }\n        // if (m_hasOleObject)\n        // {\n        //     SerializeOleContentType(contentStream);\n        // }\n        //document.xml\n        this.serializeOverrideContentType(writer, this.documentPath, this.documentContentType);\n        // tslint:disable-next-line:max-line-length\n        //<Override PartName='/word/numbering.xml' ContentType='application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml'/>\n        // if (HasNumbering) {\n        this.serializeOverrideContentType(writer, this.numberingPath, this.numberingContentType);\n        // }\n        //Add the header/footer Alternate chunks\n        // if (HeaderFooterAlternateChunks.length > 0) {\n        //     foreach(Dictionary < string, string > item in m_headerFooterAlternateChunks.Values)\n        //     AddAlternateChunkItem(item);\n        // }\n        //styles.xml\n        this.serializeOverrideContentType(writer, this.stylePath, this.stylesContentType);\n        //settings.xml\n        this.serializeOverrideContentType(writer, this.settingsPath, this.settingsContentType);\n        //             //core.xml\n        //             SerializeOverrideContentType(contentStream, this.corePath, this.CoreContentType);\n        //             //app.xml\n        //             SerializeOverrideContentType(contentStream, this.appPath, this.AppContentType);\n        //             //custom.xml\n        //             if (!isNullOrUndefined(m_document.CustomDocumentProperties) && m_document.CustomDocumentProperties.length > 0)\n        //                 SerializeOverrideContentType(contentStream, this.CustomPath, this.CustomContentType);\n        // #if Chart\n        //             if (m_hasChart)\n        //                 SerializeChartContentType(contentStream);\n        // #endif\n        this.serializeHFContentTypes(writer);\n        // WriteXmlItemsContentTypes(contentStream);\n        //End of Types tag\n        writer.writeEndElement();\n        var zipArchiveItem = new ZipArchiveItem(writer.buffer, this.contentTypesPath);\n        this.mArchive.addItem(zipArchiveItem);\n    };\n    // Serializes the HeaderFooter content types\n    WordExport.prototype.serializeHFContentTypes = function (writer) {\n        this.serializeHeaderFootersContentType(writer, 'EvenFooter');\n        this.serializeHeaderFootersContentType(writer, 'EvenHeader');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageFooter');\n        this.serializeHeaderFootersContentType(writer, 'FirstPageHeader');\n        this.serializeHeaderFootersContentType(writer, 'OddFooter');\n        this.serializeHeaderFootersContentType(writer, 'OddHeader');\n    };\n    // Serializes the HeaderFooter content types.\n    WordExport.prototype.serializeHeaderFootersContentType = function (writer, headerFooterType) {\n        var contentType;\n        var partName;\n        if (!this.headersFooters.containsKey(headerFooterType)) {\n            return;\n        }\n        var hfColl = this.headersFooters.get(headerFooterType);\n        for (var i = 0; i < hfColl.keys.length; i++) {\n            var id = hfColl.keys[i];\n            if (headerFooterType === 'EvenHeader' || headerFooterType === 'FirstPageHeader' ||\n                headerFooterType === 'OddHeader') {\n                partName = this.headerPath + id.replace('rId', '') + '.xml';\n                contentType = this.headerContentType;\n            }\n            else {\n                partName = this.footerPath + id.replace('rId', '') + '.xml';\n                contentType = this.footerContentType;\n            }\n            this.serializeOverrideContentType(writer, partName, contentType);\n        }\n    };\n    // Serializes the Override content type.\n    WordExport.prototype.serializeOverrideContentType = function (writer, partName, contentType) {\n        writer.writeStartElement(undefined, 'Override', undefined);\n        writer.writeAttributeString(undefined, 'PartName', undefined, '/' + partName.replace('\\\\', '/'));\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Serializes the default content type\n    WordExport.prototype.serializeDefaultContentType = function (writer, extension, contentType) {\n        writer.writeStartElement(undefined, 'Default', undefined);\n        writer.writeAttributeString(undefined, 'Extension', undefined, extension);\n        writer.writeAttributeString(undefined, 'ContentType', undefined, contentType);\n        writer.writeEndElement();\n    };\n    // Reset the relationship id counter\n    WordExport.prototype.resetRelationShipID = function () {\n        this.mRelationShipID = 0;\n    };\n    WordExport.prototype.close = function () {\n        //Implement\n    };\n    return WordExport;\n}());\nexport { WordExport };\n","import { StreamWriter } from '@syncfusion/ej2-file-utils';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * Exports the document to Text format.\n */\nvar TextExport = /** @class */ (function () {\n    function TextExport() {\n        this.text = '';\n        this.curSectionIndex = 0;\n        this.inField = false;\n    }\n    TextExport.prototype.getModuleName = function () {\n        return 'TextExport';\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.save = function (viewer, fileName) {\n        this.serialize(viewer);\n        var writer = new StreamWriter();\n        this.writeInternal(writer);\n        writer.save(fileName + '.txt');\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.saveAsBlob = function (viewer) {\n        this.serialize(viewer);\n        var streamWriter = new StreamWriter();\n        this.writeInternal(streamWriter);\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    TextExport.prototype.serialize = function (viewer) {\n        var document = viewer.owner.sfdtExportModule.write();\n        this.setDocument(document);\n    };\n    TextExport.prototype.setDocument = function (document) {\n        this.document = document;\n        this.mSections = document.sections;\n    };\n    TextExport.prototype.writeInternal = function (streamWriter) {\n        var section = undefined;\n        var sectionCount = this.document.sections.length - 1;\n        var isLastSection = false;\n        this.updateLastParagraph();\n        for (var i = 0; i <= sectionCount; i++) {\n            section = this.document.sections[i];\n            isLastSection = (i === sectionCount) ? true : false;\n            this.writeBody(streamWriter, section.blocks);\n            this.writeNewLine(streamWriter);\n            this.writeSectionEnd(section, isLastSection);\n        }\n        for (var j = 0; j <= sectionCount; j++) {\n            section = this.document.sections[j];\n            this.writeHeadersFooters(streamWriter, section);\n        }\n    };\n    /// <summary>\n    /// Writes the specified document content to the text file.\n    /// </summary>\n    TextExport.prototype.writeBody = function (streamWriter, body) {\n        var bodyItemsCount = body.length - 1;\n        var bodyItem = undefined;\n        for (var i = 0; i <= bodyItemsCount; i++) {\n            bodyItem = body[i];\n            if (bodyItem.hasOwnProperty('inlines')) {\n                var isLastPara = (bodyItem === this.lastPara) ? true : false;\n                this.writeParagraph(streamWriter, bodyItem, isLastPara);\n            }\n            else {\n                this.writeTable(streamWriter, bodyItem);\n            }\n        }\n    };\n    TextExport.prototype.writeParagraph = function (streamWriter, paragraph, isLastPara) {\n        for (var i = 0; i < paragraph.inlines.length; i++) {\n            var item = paragraph.inlines[i];\n            if (item.hasOwnProperty('fieldType')) {\n                this.inField = item.fieldType === 0;\n            }\n            else if (item.hasOwnProperty('text') && !this.inField) {\n                this.writeText(streamWriter, item.text);\n            }\n        }\n        if (!isLastPara) {\n            this.writeNewLine(streamWriter);\n        }\n    };\n    /// }\n    /// <summary>\n    /// Writes the specified table text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeTable = function (streamWriter, table) {\n        for (var i = 0; i < table.rows.length; i++) {\n            var row = table.rows[i];\n            for (var j = 0; j < row.cells.length; j++) {\n                var cell = row.cells[j];\n                this.writeBody(streamWriter, cell.blocks);\n            }\n        }\n    };\n    /// <summary>\n    /// Writes the specified Header Footer text content to the text file.\n    /// </summary>\n    TextExport.prototype.writeHeadersFooters = function (streamWriter, section) {\n        var headersFooters = section.headersFooters;\n        if (isNullOrUndefined(headersFooters)) {\n            return;\n        }\n        this.writeHeaderFooter(streamWriter, section.headersFooters.header);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.footer);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenFooter);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.evenHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageHeader);\n        this.writeHeaderFooter(streamWriter, section.headersFooters.firstPageFooter);\n    };\n    TextExport.prototype.writeHeaderFooter = function (streamWriter, headerFooter) {\n        if (headerFooter && headerFooter.blocks) {\n            this.writeBody(streamWriter, headerFooter.blocks);\n        }\n    };\n    /// <summary>\n    /// Writes the end of the section.\n    /// </summary>\n    TextExport.prototype.writeSectionEnd = function (section, lastSection) {\n        this.curSectionIndex++;\n    };\n    TextExport.prototype.writeNewLine = function (writer) {\n        writer.writeLine('');\n    };\n    TextExport.prototype.writeText = function (writer, text) {\n        writer.write(text);\n    };\n    TextExport.prototype.updateLastParagraph = function () {\n        var cnt = this.document.sections.length;\n        var sec;\n        if (cnt > 0) {\n            sec = this.document.sections[cnt - 1];\n        }\n        if (!isNullOrUndefined(sec)) {\n            var paragraphs = [];\n            for (var i = 0; i < sec.blocks.length; i++) {\n                if (sec.blocks[i].hasOwnProperty('inlines')) {\n                    paragraphs.push(sec.blocks[i]);\n                }\n            }\n            var pCount = paragraphs.length;\n            if (pCount > 0) {\n                this.lastPara = paragraphs[pCount - 1];\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TextExport.prototype.destroy = function () {\n        this.document = undefined;\n        this.lastPara = undefined;\n        this.mSections = undefined;\n        this.sections = undefined;\n    };\n    return TextExport;\n}());\nexport { TextExport };\n","import { LineWidget, ParagraphWidget, BodyWidget, TextElementBox, FieldElementBox, TableRowWidget, TableCellWidget, ImageElementBox, ListTextElementBox, BookmarkElementBox } from '../viewer/page';\nimport { BlockWidget } from '../viewer/page';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\nimport { StreamWriter } from '@syncfusion/ej2-file-utils';\n/**\n * Exports the document to Sfdt format.\n */\nvar SfdtExport = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function SfdtExport(owner) {\n        /* tslint:disable:no-any */\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.endCell = undefined;\n        this.startColumnIndex = undefined;\n        this.endColumnIndex = undefined;\n        this.lists = undefined;\n        this.viewer = undefined;\n        this.document = undefined;\n        this.writeInlineStyles = undefined;\n        this.viewer = owner;\n    }\n    SfdtExport.prototype.getModuleName = function () {\n        return 'SfdtExport';\n    };\n    SfdtExport.prototype.clear = function () {\n        this.writeInlineStyles = undefined;\n        this.endLine = undefined;\n        this.lists = undefined;\n        this.document = undefined;\n    };\n    /**\n     * Serialize the data as Syncfusion document text.\n     * @private\n     */\n    SfdtExport.prototype.serialize = function () {\n        return JSON.stringify(this.write());\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.saveAsBlob = function (viewer) {\n        var streamWriter = new StreamWriter();\n        streamWriter.write(this.serialize());\n        var blob = streamWriter.buffer;\n        streamWriter.destroy();\n        var promise;\n        return new Promise(function (resolve, reject) {\n            resolve(blob);\n        });\n    };\n    // tslint:disable-next-line:max-line-length\n    /**\n     * @private\n     */\n    SfdtExport.prototype.write = function (line, startOffset, endLine, endOffset, writeInlineStyles) {\n        if (writeInlineStyles) {\n            this.writeInlineStyles = true;\n        }\n        this.lists = [];\n        this.document = {};\n        this.document.sections = [];\n        this.document.characterFormat = this.writeCharacterFormat(this.viewer.characterFormat);\n        this.document.paragraphFormat = this.writeParagraphFormat(this.viewer.paragraphFormat);\n        if (line instanceof LineWidget && endLine instanceof LineWidget) {\n            // For selection\n            var startPara = line.paragraph;\n            var endPara = endLine.paragraph;\n            var startCell = startPara.associatedCell;\n            var endCell = endPara.associatedCell;\n            // Creates section\n            var bodyWidget = startPara.bodyWidget;\n            var section = this.createSection(line.paragraph.bodyWidget);\n            this.document.sections.push(section);\n            if (startCell === endCell || isNullOrUndefined(endCell)) {\n                this.endLine = endLine;\n                this.endOffset = endOffset;\n            }\n            else {\n                // Todo: Handle nested table cases\n                if (startCell instanceof TableCellWidget) {\n                    var startTable = startCell.getContainerTable();\n                    var endTable = endCell.getContainerTable();\n                    if (startTable.tableFormat === endTable.tableFormat) {\n                        this.endCell = endCell;\n                        this.endColumnIndex = this.endCell.columnIndex + this.endCell.cellFormat.columnSpan;\n                        this.startColumnIndex = startCell.columnIndex;\n                    }\n                }\n                else {\n                    this.endCell = endCell;\n                }\n            }\n            if (startCell === endCell || isNullOrUndefined(startCell)) {\n                var paragraph = this.createParagraph(line.paragraph);\n                section.blocks.push(paragraph);\n                if (!this.writeParagraph(line.paragraph, paragraph, section.blocks, line.indexInOwner, startOffset)) {\n                    // Todo:continue in next section\n                }\n            }\n            else {\n                var table = this.createTable(startCell.ownerTable);\n                section.blocks.push(table);\n                this.writeTable(startCell.ownerTable, table, startCell.ownerRow.indexInOwner, section.blocks);\n            }\n        }\n        else {\n            if (this.viewer.pages.length > 0) {\n                var page = this.viewer.pages[0];\n                if (page.bodyWidgets.length > 0) {\n                    this.writeBodyWidget(page.bodyWidgets[0], 0);\n                }\n            }\n        }\n        this.writeStyles(this.viewer);\n        this.writeLists(this.viewer);\n        var doc = this.document;\n        this.clear();\n        return doc;\n    };\n    SfdtExport.prototype.writeBodyWidget = function (bodyWidget, index) {\n        if (!(bodyWidget instanceof BodyWidget)) {\n            return true;\n        }\n        var section = this.createSection(bodyWidget);\n        this.document.sections.push(section);\n        this.writeHeaderFooters(this.viewer.headersFooters[bodyWidget.index], section);\n        if (this.writeBlock(bodyWidget.childWidgets[index], 0, section.blocks)) {\n            return true;\n        }\n        var next = bodyWidget;\n        do {\n            bodyWidget = next;\n            next = next.nextRenderedWidget;\n        } while (next instanceof BodyWidget && next.index === bodyWidget.index);\n        return this.writeBodyWidget(next, index);\n    };\n    SfdtExport.prototype.writeHeaderFooters = function (hfs, section) {\n        if (isNullOrUndefined(hfs)) {\n            return;\n        }\n        section.headersFooters.header = this.writeHeaderFooter(hfs[0]);\n        section.headersFooters.footer = this.writeHeaderFooter(hfs[1]);\n        section.headersFooters.evenHeader = this.writeHeaderFooter(hfs[2]);\n        section.headersFooters.evenFooter = this.writeHeaderFooter(hfs[3]);\n        section.headersFooters.firstPageHeader = this.writeHeaderFooter(hfs[4]);\n        section.headersFooters.firstPageFooter = this.writeHeaderFooter(hfs[5]);\n    };\n    SfdtExport.prototype.writeHeaderFooter = function (widget) {\n        if (isNullOrUndefined(widget)) {\n            return undefined;\n        }\n        var headerFooter = {};\n        if (widget && widget.childWidgets && widget.childWidgets.length > 0) {\n            headerFooter.blocks = [];\n            this.writeBlock(widget.firstChild, 0, headerFooter.blocks);\n        }\n        return headerFooter;\n    };\n    SfdtExport.prototype.createSection = function (bodyWidget) {\n        var section = {};\n        section.sectionFormat = {};\n        section.sectionFormat.pageWidth = bodyWidget.sectionFormat.pageWidth;\n        section.sectionFormat.pageHeight = bodyWidget.sectionFormat.pageHeight;\n        section.sectionFormat.leftMargin = bodyWidget.sectionFormat.leftMargin;\n        section.sectionFormat.rightMargin = bodyWidget.sectionFormat.rightMargin;\n        section.sectionFormat.topMargin = bodyWidget.sectionFormat.topMargin;\n        section.sectionFormat.bottomMargin = bodyWidget.sectionFormat.bottomMargin;\n        section.sectionFormat.differentFirstPage = bodyWidget.sectionFormat.differentFirstPage;\n        section.sectionFormat.differentOddAndEvenPages = bodyWidget.sectionFormat.differentOddAndEvenPages;\n        section.sectionFormat.headerDistance = bodyWidget.sectionFormat.headerDistance;\n        section.sectionFormat.footerDistance = bodyWidget.sectionFormat.footerDistance;\n        section.blocks = [];\n        section.headersFooters = {};\n        return section;\n    };\n    SfdtExport.prototype.writeBlock = function (widget, index, blocks) {\n        if (!(widget instanceof BlockWidget)) {\n            return true;\n        }\n        if (widget instanceof ParagraphWidget) {\n            var paragraph = this.createParagraph(widget);\n            blocks.push(paragraph);\n            if (this.writeParagraph(widget, paragraph, blocks)) {\n                return true;\n            }\n        }\n        else {\n            var tableWidget = widget;\n            var table = this.createTable(tableWidget);\n            blocks.push(table);\n            if (this.writeTable(tableWidget, table, 0, blocks)) {\n                return true;\n            }\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeNextBlock = function (widget, blocks) {\n        var next = widget.nextRenderedWidget;\n        if (next instanceof BlockWidget && next.containerWidget.index === widget.containerWidget.index) {\n            return this.writeBlock(widget.nextRenderedWidget, 0, blocks);\n        }\n        return false;\n    };\n    SfdtExport.prototype.writeParagraph = function (paragraphWidget, paragraph, blocks, lineIndex, start) {\n        if (isNullOrUndefined(lineIndex)) {\n            lineIndex = 0;\n        }\n        if (isNullOrUndefined(start)) {\n            start = 0;\n        }\n        var next = paragraphWidget;\n        while (next instanceof ParagraphWidget) {\n            if (this.writeLines(next, lineIndex, start, paragraph.inlines)) {\n                return true;\n            }\n            lineIndex = 0;\n            start = 0;\n            paragraphWidget = next;\n            next = paragraphWidget.nextSplitWidget;\n        }\n        return this.writeNextBlock(paragraphWidget, blocks);\n    };\n    SfdtExport.prototype.writeInlines = function (line, inlines) {\n        for (var i = 0; i < line.children.length; i++) {\n            var element = line.children[i];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = this.writeInline(element);\n            if (!isNullOrUndefined(inline)) {\n                inlines.push(inline);\n            }\n        }\n    };\n    SfdtExport.prototype.writeInline = function (element) {\n        var inline = {};\n        inline.characterFormat = this.writeCharacterFormat(element.characterFormat);\n        if (element instanceof FieldElementBox) {\n            inline.fieldType = element.fieldType;\n        }\n        else if (element instanceof ImageElementBox) {\n            inline.imageString = element.imageString;\n            inline.width = HelperMethods.convertPixelToPoint(element.width);\n            inline.height = HelperMethods.convertPixelToPoint(element.height);\n        }\n        else if (element instanceof BookmarkElementBox) {\n            inline.bookmarkType = element.bookmarkType;\n            inline.name = element.name;\n        }\n        else if (element instanceof TextElementBox) {\n            inline.text = element.text;\n        }\n        else {\n            inline = undefined;\n        }\n        return inline;\n    };\n    SfdtExport.prototype.writeLines = function (paragraph, lineIndex, offset, inlines) {\n        var startIndex = lineIndex;\n        var endParagraph = this.endLine instanceof LineWidget && this.endLine.paragraph === paragraph;\n        var endIndex = endParagraph ? this.endLine.indexInOwner : paragraph.childWidgets.length - 1;\n        for (var i = startIndex; i <= endIndex; i++) {\n            var child = paragraph.childWidgets[i];\n            if (this.endLine === child || (lineIndex === i && offset !== 0)) {\n                this.writeLine(child, offset, inlines);\n            }\n            else {\n                this.writeInlines(child, inlines);\n            }\n        }\n        return endParagraph;\n    };\n    SfdtExport.prototype.writeLine = function (line, offset, inlines) {\n        var isEnd = line === this.endLine;\n        var started = false;\n        var ended = false;\n        var length = 0;\n        for (var j = 0; j < line.children.length; j++) {\n            var element = line.children[j];\n            if (element instanceof ListTextElementBox) {\n                continue;\n            }\n            var inline = undefined;\n            length += element.length;\n            started = length > offset;\n            ended = isEnd && length >= this.endOffset;\n            if (!started) {\n                continue;\n            }\n            inline = this.writeInline(element);\n            inlines[inlines.length] = inline;\n            if (length > offset || ended) {\n                if (inline.hasOwnProperty('text')) {\n                    var startIndex = length - element.length;\n                    var indexInInline = offset - startIndex;\n                    var endIndex = ended ? this.endOffset - startIndex : element.length;\n                    inline.text = inline.text.substring(indexInInline, endIndex);\n                }\n                offset = -1;\n            }\n            if (ended) {\n                break;\n            }\n        }\n    };\n    SfdtExport.prototype.createParagraph = function (paragraphWidget) {\n        var paragraph = {};\n        paragraph.paragraphFormat = this.writeParagraphFormat(paragraphWidget.paragraphFormat);\n        paragraph.characterFormat = this.writeCharacterFormat(paragraphWidget.characterFormat);\n        paragraph.inlines = [];\n        return paragraph;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeCharacterFormat = function (format, isInline) {\n        var characterFormat = {};\n        HelperMethods.writeCharacterFormat(characterFormat, isInline, format);\n        if (this.writeInlineStyles && !isInline) {\n            characterFormat.inlineFormat = this.writeCharacterFormat(format, true);\n        }\n        return characterFormat;\n    };\n    SfdtExport.prototype.writeParagraphFormat = function (format, isInline) {\n        var paragraphFormat = {};\n        paragraphFormat.leftIndent = isInline ? format.leftIndent : format.getValue('leftIndent');\n        paragraphFormat.rightIndent = isInline ? format.rightIndent : format.getValue('rightIndent');\n        paragraphFormat.firstLineIndent = isInline ? format.firstLineIndent : format.getValue('firstLineIndent');\n        paragraphFormat.textAlignment = isInline ? format.textAlignment : format.getValue('textAlignment');\n        paragraphFormat.beforeSpacing = isInline ? format.beforeSpacing : format.getValue('beforeSpacing');\n        paragraphFormat.afterSpacing = isInline ? format.afterSpacing : format.getValue('afterSpacing');\n        paragraphFormat.lineSpacing = isInline ? format.lineSpacing : format.getValue('lineSpacing');\n        paragraphFormat.lineSpacingType = isInline ? format.lineSpacingType : format.getValue('lineSpacingType');\n        paragraphFormat.styleName = !isNullOrUndefined(format.baseStyle) ? format.baseStyle.name : undefined;\n        paragraphFormat.outlineLevel = isInline ? format.outlineLevel : format.getValue('outlineLevel');\n        paragraphFormat.listFormat = this.writeListFormat(format.listFormat, isInline);\n        paragraphFormat.tabs = this.writeTabs(format.tabs);\n        if (this.writeInlineStyles && !isInline) {\n            paragraphFormat.inlineFormat = this.writeParagraphFormat(format, true);\n        }\n        return paragraphFormat;\n    };\n    SfdtExport.prototype.writeTabs = function (tabStops) {\n        if (isNullOrUndefined(tabStops) || tabStops.length < 1) {\n            return undefined;\n        }\n        var tabs = [];\n        for (var i = 0; i < tabStops.length; i++) {\n            var tabStop = tabStops[i];\n            var tab = {};\n            tab.position = tabStop.position;\n            tab.deletePosition = tabStop.deletePosition;\n            tab.tabJustification = tabStop.tabJustification;\n            tab.tabLeader = tabStop.tabLeader;\n            tabs.push(tab);\n        }\n        return tabs;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.writeListFormat = function (format, isInline) {\n        var listFormat = {};\n        var listIdValue = format.getValue('listId');\n        if (!isNullOrUndefined(listIdValue) && listIdValue > -1) {\n            listFormat.listId = listIdValue;\n            listFormat.listLevelNumber = format.getValue('listLevelNumber');\n            if (this.lists.indexOf(format.listId) < 0) {\n                this.lists.push(format.listId);\n            }\n        }\n        return listFormat;\n    };\n    SfdtExport.prototype.writeTable = function (tableWidget, table, index, blocks) {\n        var widget = tableWidget.childWidgets[index];\n        if (widget instanceof TableRowWidget) {\n            if (this.writeRow(widget, table.rows)) {\n                return true;\n            }\n        }\n        var next = tableWidget;\n        do {\n            tableWidget = next;\n            next = tableWidget.nextSplitWidget;\n        } while (next instanceof BlockWidget);\n        return this.writeNextBlock(tableWidget, blocks);\n    };\n    SfdtExport.prototype.writeRow = function (rowWidget, rows) {\n        if (!(rowWidget instanceof TableRowWidget)) {\n            return false;\n        }\n        var row = this.createRow(rowWidget);\n        rows.push(row);\n        for (var i = 0; i < rowWidget.childWidgets.length; i++) {\n            var widget = rowWidget.childWidgets[i];\n            if (widget instanceof TableCellWidget) {\n                if (rowWidget.index === widget.rowIndex\n                    && (isNullOrUndefined(this.startColumnIndex) || widget.columnIndex >= this.startColumnIndex)\n                    && (isNullOrUndefined(this.endColumnIndex) || widget.columnIndex < this.endColumnIndex)) {\n                    if (this.writeCell(widget, row.cells)) {\n                        return true;\n                    }\n                }\n            }\n        }\n        var next = rowWidget;\n        do {\n            rowWidget = next;\n            next = rowWidget.nextRenderedWidget;\n        } while (next instanceof TableRowWidget && next.index === rowWidget.index);\n        return this.writeRow(next, rows);\n    };\n    SfdtExport.prototype.writeCell = function (cellWidget, cells) {\n        var cell = this.createCell(cellWidget);\n        cells.push(cell);\n        if (this.writeBlock(cellWidget.firstChild, 0, cell.blocks)) {\n            return true;\n        }\n        return this.endCell instanceof TableCellWidget ? this.endCell.cellFormat === cellWidget.cellFormat : false;\n    };\n    SfdtExport.prototype.createTable = function (tableWidget) {\n        var table = {};\n        table.rows = [];\n        table.grid = [];\n        for (var i = 0; i < tableWidget.tableHolder.columns.length; i++) {\n            table.grid[i] = tableWidget.tableHolder.columns[i].preferredWidth;\n        }\n        table.tableFormat = this.writeTableFormat(tableWidget.tableFormat);\n        table.description = tableWidget.description;\n        table.title = tableWidget.title;\n        return table;\n    };\n    SfdtExport.prototype.createRow = function (rowWidget) {\n        var row = {};\n        row.cells = [];\n        row.rowFormat = this.writeRowFormat(rowWidget.rowFormat);\n        return row;\n    };\n    SfdtExport.prototype.createCell = function (cellWidget) {\n        var cell = {};\n        cell.blocks = [];\n        cell.cellFormat = this.writeCellFormat(cellWidget.cellFormat);\n        cell.columnIndex = cellWidget.columnIndex;\n        return cell;\n    };\n    SfdtExport.prototype.writeShading = function (wShading) {\n        var shading = {};\n        shading.backgroundColor = wShading.backgroundColor;\n        shading.foregroundColor = wShading.foregroundColor;\n        shading.textureStyle = wShading.textureStyle;\n        return shading;\n    };\n    SfdtExport.prototype.writeBorder = function (wBorder) {\n        var border = {};\n        border.color = wBorder.color;\n        border.hasNoneStyle = wBorder.hasNoneStyle;\n        border.lineStyle = wBorder.lineStyle;\n        border.lineWidth = wBorder.lineWidth;\n        border.shadow = wBorder.shadow;\n        border.space = wBorder.space;\n        return border;\n    };\n    SfdtExport.prototype.writeBorders = function (wBorders) {\n        var borders = {};\n        borders.top = this.writeBorder(wBorders.top);\n        borders.left = this.writeBorder(wBorders.left);\n        borders.right = this.writeBorder(wBorders.right);\n        borders.bottom = this.writeBorder(wBorders.bottom);\n        borders.diagonalDown = this.writeBorder(wBorders.diagonalDown);\n        borders.diagonalUp = this.writeBorder(wBorders.diagonalUp);\n        borders.horizontal = this.writeBorder(wBorders.horizontal);\n        borders.vertical = this.writeBorder(wBorders.vertical);\n        return borders;\n    };\n    SfdtExport.prototype.writeCellFormat = function (wCellFormat) {\n        var cellFormat = {};\n        cellFormat.borders = this.writeBorders(wCellFormat.borders);\n        cellFormat.shading = this.writeShading(wCellFormat.shading);\n        cellFormat.topMargin = wCellFormat.topMargin;\n        cellFormat.rightMargin = wCellFormat.rightMargin;\n        cellFormat.leftMargin = wCellFormat.leftMargin;\n        cellFormat.bottomMargin = wCellFormat.bottomMargin;\n        cellFormat.preferredWidth = wCellFormat.preferredWidth;\n        cellFormat.preferredWidthType = wCellFormat.preferredWidthType;\n        cellFormat.cellWidth = wCellFormat.cellWidth;\n        cellFormat.columnSpan = wCellFormat.columnSpan;\n        cellFormat.rowSpan = wCellFormat.rowSpan;\n        cellFormat.verticalAlignment = wCellFormat.verticalAlignment;\n        return cellFormat;\n    };\n    SfdtExport.prototype.writeRowFormat = function (wRowFormat) {\n        var rowFormat = {};\n        rowFormat.height = wRowFormat.height;\n        rowFormat.allowBreakAcrossPages = wRowFormat.allowBreakAcrossPages;\n        rowFormat.heightType = wRowFormat.heightType;\n        rowFormat.isHeader = wRowFormat.isHeader;\n        rowFormat.borders = this.writeBorders(wRowFormat.borders);\n        rowFormat.gridBefore = wRowFormat.gridBefore;\n        rowFormat.gridBeforeWidth = wRowFormat.gridBeforeWidth;\n        rowFormat.gridBeforeWidthType = wRowFormat.gridBeforeWidthType;\n        rowFormat.gridAfter = wRowFormat.gridAfter;\n        rowFormat.gridAfterWidth = wRowFormat.gridAfterWidth;\n        rowFormat.gridAfterWidthType = wRowFormat.gridAfterWidthType;\n        return rowFormat;\n    };\n    SfdtExport.prototype.writeTableFormat = function (wTableFormat) {\n        var tableFormat = {};\n        tableFormat.borders = this.writeBorders(wTableFormat.borders);\n        tableFormat.shading = this.writeShading(wTableFormat.shading);\n        tableFormat.cellSpacing = wTableFormat.cellSpacing;\n        tableFormat.leftIndent = wTableFormat.leftIndent;\n        tableFormat.tableAlignment = wTableFormat.tableAlignment;\n        tableFormat.topMargin = wTableFormat.topMargin;\n        tableFormat.rightMargin = wTableFormat.rightMargin;\n        tableFormat.leftMargin = wTableFormat.leftMargin;\n        tableFormat.bottomMargin = wTableFormat.bottomMargin;\n        tableFormat.preferredWidth = wTableFormat.preferredWidth;\n        tableFormat.preferredWidthType = wTableFormat.preferredWidthType;\n        return tableFormat;\n    };\n    SfdtExport.prototype.writeStyles = function (viewer) {\n        var styles = [];\n        this.document.styles = [];\n        for (var i = 0; i < viewer.styles.length; i++) {\n            this.document.styles.push(this.writeStyle(viewer.styles.getItem(i)));\n        }\n    };\n    SfdtExport.prototype.writeStyle = function (style) {\n        var wStyle = {};\n        wStyle.name = style.name;\n        if (style.type === 'Paragraph') {\n            wStyle.type = 'Paragraph';\n            wStyle.paragraphFormat = this.writeParagraphFormat(style.paragraphFormat);\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (style.type === 'Character') {\n            wStyle.type = 'Character';\n            wStyle.characterFormat = this.writeCharacterFormat(style.characterFormat);\n        }\n        if (!isNullOrUndefined(style.basedOn)) {\n            wStyle.basedOn = style.basedOn.name;\n        }\n        if (!isNullOrUndefined(style.link)) {\n            wStyle.link = style.link.name;\n        }\n        if (!isNullOrUndefined(style.next)) {\n            wStyle.next = style.next.name;\n        }\n        return wStyle;\n    };\n    SfdtExport.prototype.writeLists = function (viewer) {\n        var abstractLists = [];\n        this.document.lists = [];\n        for (var i = 0; i < viewer.lists.length; i++) {\n            var list = viewer.lists[i];\n            if (this.lists.indexOf(list.listId) > -1) {\n                this.document.lists.push(this.writeList(list));\n                if (abstractLists.indexOf(list.abstractListId) < 0) {\n                    abstractLists.push(list.abstractListId);\n                }\n            }\n        }\n        this.document.abstractLists = [];\n        for (var i = 0; i < viewer.abstractLists.length; i++) {\n            var abstractList = viewer.abstractLists[i];\n            if (this.lists.indexOf(abstractList.abstractListId) > -1) {\n                this.document.abstractLists.push(this.writeAbstractList(abstractList));\n            }\n        }\n    };\n    SfdtExport.prototype.writeAbstractList = function (wAbstractList) {\n        var abstractList = {};\n        abstractList.abstractListId = wAbstractList.abstractListId;\n        abstractList.levels = [];\n        for (var i = 0; i < wAbstractList.levels.length; i++) {\n            abstractList.levels[i] = this.writeListLevel(wAbstractList.levels[i]);\n        }\n        return abstractList;\n    };\n    SfdtExport.prototype.writeList = function (wList) {\n        var list = {};\n        list.abstractListId = wList.abstractListId;\n        //list.levelOverrides = wList.levelOverrides;\n        list.listId = wList.listId;\n        return list;\n    };\n    SfdtExport.prototype.writeListLevel = function (wListLevel) {\n        var listLevel = {};\n        listLevel.characterFormat = this.writeCharacterFormat(wListLevel.characterFormat);\n        listLevel.paragraphFormat = this.writeParagraphFormat(wListLevel.paragraphFormat);\n        listLevel.followCharacter = wListLevel.followCharacter;\n        listLevel.listLevelPattern = wListLevel.listLevelPattern;\n        listLevel.numberFormat = wListLevel.numberFormat;\n        listLevel.restartLevel = wListLevel.restartLevel;\n        listLevel.startAt = wListLevel.startAt;\n        return listLevel;\n    };\n    /**\n     * @private\n     */\n    SfdtExport.prototype.destroy = function () {\n        this.lists = undefined;\n        this.endLine = undefined;\n        this.endOffset = undefined;\n        this.viewer = undefined;\n    };\n    return SfdtExport;\n}());\nexport { SfdtExport };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\n/**\n * The Hyperlink dialog is used to insert or edit hyperlink at selection.\n */\n/* tslint:disable:max-line-length */\nvar HyperlinkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function HyperlinkDialog(viewer) {\n        var _this = this;\n        this.displayText = '';\n        this.navigationUrl = undefined;\n        this.bookmarkDropdown = undefined;\n        this.bookmarkCheckbox = undefined;\n        this.bookmarks = [];\n        /**\n         * @private\n         */\n        this.onKeyUpOnUrlBox = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.displayTextBox.value !== '' && _this.urlTextBox.value !== '') {\n                    _this.onInsertHyperlink();\n                }\n                return;\n            }\n            var selectedText = _this.owner.selection.text;\n            var urlValue = _this.urlTextBox.value;\n            if (urlValue.substring(0, 4).toLowerCase() === 'www.') {\n                _this.urlTextBox.value = 'http://' + urlValue;\n            }\n            if (_this.displayText === '') {\n                _this.displayTextBox.value = urlValue;\n            }\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onKeyUpOnDisplayBox = function () {\n            _this.displayText = _this.displayTextBox.value;\n            _this.enableOrDisableInsertButton();\n        };\n        /**\n         * @private\n         */\n        this.onInsertButtonClick = function () {\n            _this.onInsertHyperlink();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.clearValue();\n        };\n        /**\n         * @private\n         */\n        this.loadHyperlinkDialog = function () {\n            _this.owner.updateFocus();\n            _this.bookmarks = [];\n            for (var i = 0; i < _this.owner.bookmarks.keys.length; i++) {\n                var bookmark = _this.owner.bookmarks.keys[i];\n                if (bookmark.indexOf('_') !== 0) {\n                    _this.bookmarks.push(bookmark);\n                }\n            }\n            var fieldBegin = _this.owner.selection.getHyperlinkField();\n            if (!isNullOrUndefined(fieldBegin)) {\n                if (!isNullOrUndefined(fieldBegin.fieldSeparator)) {\n                    var format = undefined;\n                    // tslint:disable-next-line:max-line-length\n                    var fieldObj = _this.owner.selection.getHyperlinkDisplayText(fieldBegin.fieldSeparator.line.paragraph, fieldBegin.fieldSeparator, fieldBegin.fieldEnd, false, format);\n                    _this.displayText = fieldObj.displayText;\n                    _this.displayTextBox.disabled = fieldObj.isNestedField;\n                }\n                _this.displayTextBox.value = _this.displayText;\n                var link = _this.owner.selection.getLinkText(fieldBegin);\n                _this.urlTextBox.value = _this.navigationUrl = link;\n                _this.owner.dialog.header = _this.localObj.getConstant('Edit Hyperlink');\n            }\n            else {\n                _this.displayText = _this.owner.selection.getText(true);\n                if (_this.displayText !== '') {\n                    if (_this.displayText.indexOf(String.fromCharCode(65532)) !== -1 ||\n                        _this.displayText.indexOf('\\r') !== -1 && (_this.displayText.lastIndexOf('\\r') !== -1 &&\n                            _this.displayText.slice(0, -1).indexOf('\\r') !== -1)) {\n                        _this.displayTextBox.value = '<<Selection in document>>';\n                        _this.displayTextBox.disabled = true;\n                    }\n                    else {\n                        _this.displayTextBox.value = _this.displayText;\n                    }\n                }\n            }\n            _this.bookmarkDiv.style.display = 'none';\n            _this.addressText.style.display = 'block';\n            _this.urlTextBox.style.display = 'block';\n            _this.bookmarkCheckbox.checked = false;\n            _this.bookmarkDropdown.dataSource = _this.owner.bookmarks.keys;\n            _this.insertButton = document.getElementsByClassName('e-hyper-insert')[0];\n            _this.enableOrDisableInsertButton();\n            _this.urlTextBox.focus();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeHyperlinkDialog = function () {\n            _this.clearValue();\n            _this.owner.updateFocus();\n        };\n        /* tslint:disable:no-any */\n        this.onUseBookmarkChange = function (args) {\n            if (args.checked) {\n                _this.bookmarkDiv.style.display = 'block';\n                _this.bookmarkDropdown.dataSource = _this.bookmarks;\n                _this.addressText.style.display = 'none';\n                _this.urlTextBox.style.display = 'none';\n            }\n            else {\n                _this.bookmarkDiv.style.display = 'none';\n                _this.addressText.style.display = 'block';\n                _this.urlTextBox.style.display = 'block';\n            }\n        };\n        this.onBookmarkchange = function (args) {\n            if (_this.bookmarkDropdown.value !== '') {\n                _this.insertButton.disabled = false;\n            }\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.getModuleName = function () {\n        return 'HyperlinkDialog';\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.initHyperlinkDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_hyperlink';\n        this.target = createElement('div', { id: id, className: 'e-de-hyperlink' });\n        var container = createElement('div');\n        var displayText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Text to display') });\n        this.displayTextBox = createElement('input', { id: this.owner.owner.containerId + '_display_text', className: 'e-input e-de-hyperlink-dlg-input' });\n        this.displayTextBox.addEventListener('keyup', instance.onKeyUpOnDisplayBox);\n        container.appendChild(displayText);\n        container.appendChild(this.displayTextBox);\n        this.addressText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Address') });\n        this.urlTextBox = createElement('input', { id: this.owner.owner.containerId + '_url_text', className: 'e-input e-de-hyperlink-dlg-input', attrs: { autofocus: 'true' } });\n        this.urlTextBox.addEventListener('input', instance.onKeyUpOnUrlBox);\n        this.urlTextBox.addEventListener('keyup', instance.onKeyUpOnUrlBox);\n        container.appendChild(this.addressText);\n        container.appendChild(this.urlTextBox);\n        this.bookmarkDiv = createElement('div', { styles: 'display:none;' });\n        var bookmarkText = createElement('div', { className: 'e-de-hyperlink-dlg-title', innerHTML: localValue.getConstant('Bookmark') });\n        var bookmarkTextElement = createElement('div', { className: 'e-de-hyperlink-dlg-bookmark' });\n        // tslint:disable-next-line:max-line-length\n        var bookmarkValue = createElement('input', { id: 'e-de-hyperlink-dlg-bookmark-value' });\n        bookmarkTextElement.appendChild(bookmarkValue);\n        // tslint:disable-next-line:max-line-length\n        this.bookmarkDropdown = new DropDownList({ dataSource: [], change: this.onBookmarkchange, popupHeight: '230px', width: '230px', noRecordsTemplate: localValue.getConstant('No bookmarks found') });\n        this.bookmarkDropdown.appendTo(bookmarkValue);\n        this.bookmarkDiv.appendChild(bookmarkText);\n        this.bookmarkDiv.appendChild(bookmarkTextElement);\n        container.appendChild(this.bookmarkDiv);\n        // tslint:disable-next-line:max-line-length\n        var bookmarkCheckDiv = createElement('div', { className: 'e-de-hyperlink-bookmark-check e-de-hyperlink-dlg-title' });\n        var bookmarkCheck = createElement('input', { attrs: { type: 'checkbox' }, id: this.target.id + '_bookmark', className: this.target.id + '_bookmarkcheck' });\n        bookmarkCheckDiv.appendChild(bookmarkCheck);\n        this.bookmarkCheckbox = new CheckBox({ label: localValue.getConstant('Use bookmarks'), change: this.onUseBookmarkChange });\n        this.bookmarkCheckbox.appendTo(bookmarkCheck);\n        container.appendChild(bookmarkCheckDiv);\n        this.target.appendChild(container);\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.show = function () {\n        this.localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initHyperlinkDialog(this.localObj);\n        }\n        this.owner.dialog.header = this.localObj.getConstant('Insert Hyperlink');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Ok'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: this.localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.beforeOpen = this.loadHyperlinkDialog;\n        this.owner.dialog.close = this.closeHyperlinkDialog;\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.hide = function () {\n        this.closeHyperlinkDialog();\n    };\n    HyperlinkDialog.prototype.enableOrDisableInsertButton = function () {\n        if (!isNullOrUndefined(this.insertButton)) {\n            // tslint:disable-next-line:max-line-length\n            this.insertButton.disabled = (this.urlTextBox.value === '' || this.displayTextBox.value === '');\n        }\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.onInsertHyperlink = function () {\n        var displayText = this.displayTextBox.value.trim();\n        var address = this.urlTextBox.value.trim();\n        var isBookmark = false;\n        if (!isNullOrUndefined(this.bookmarkDropdown.value) && this.bookmarkDropdown.value !== '') {\n            address = this.bookmarkDropdown.value;\n            isBookmark = true;\n        }\n        if (address === '') {\n            this.owner.dialog.hide();\n            return;\n        }\n        if (displayText === '' && address !== '') {\n            displayText = address;\n        }\n        else {\n            displayText = this.displayTextBox.value;\n        }\n        if (!isNullOrUndefined(this.navigationUrl)) {\n            this.owner.owner.editorModule.editHyperlink(this.owner.selection, address, displayText, isBookmark);\n        }\n        else {\n            var remove = this.owner.selection.text !== displayText && !this.displayTextBox.disabled;\n            this.owner.owner.editorModule.insertHyperlink(address, displayText, remove, isBookmark);\n        }\n        this.owner.dialog.hide();\n        this.navigationUrl = undefined;\n    };\n    /* tslint:enable:no-any */\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.clearValue = function () {\n        this.displayTextBox.value = '';\n        this.urlTextBox.value = '';\n        this.displayText = '';\n        this.displayTextBox.disabled = false;\n        this.bookmarks = [];\n    };\n    /**\n     * @private\n     */\n    HyperlinkDialog.prototype.destroy = function () {\n        if (this.displayTextBox) {\n            this.displayTextBox.innerHTML = '';\n            this.displayTextBox = undefined;\n        }\n        if (this.urlTextBox) {\n            this.urlTextBox.parentElement.removeChild(this.urlTextBox);\n            this.urlTextBox = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            this.target.innerHTML = '';\n            this.target = undefined;\n        }\n    };\n    return HyperlinkDialog;\n}());\nexport { HyperlinkDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { L10n, createElement, setCulture, isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * The Table dialog is used to insert table at selection.\n */\nvar TableDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.keyUpInsertTable = function (event) {\n            if (event.keyCode === 13) {\n                if (_this.rowsCountBox.value !== '' && _this.columnsCountBox.value !== '') {\n                    _this.onInsertTableClick();\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.onInsertTableClick = function () {\n            var rowCount = _this.rowValueTextBox.value;\n            var columnCount = _this.columnValueTexBox.value;\n            if (!(isNullOrUndefined(rowCount) && isNullOrUndefined(columnCount))) {\n                _this.owner.owner.editor.insertTable(rowCount, columnCount);\n            }\n            _this.owner.dialog.hide();\n        };\n        this.owner = viewer;\n    }\n    TableDialog.prototype.getModuleName = function () {\n        return 'TableDialog';\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.initTableDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_Table';\n        this.target = createElement('div', { id: id, className: 'e-de-insert-table' });\n        var parentDiv = createElement('div');\n        var columnContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of columns')\n        });\n        var columnValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.columnsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + '_column'\n        });\n        columnValue.appendChild(this.columnsCountBox);\n        var rowContainer = createElement('div', {\n            className: 'e-de-insert-table-dlg-sub-header', innerHTML: localValue.getConstant('Number of rows')\n        });\n        var rowValue = createElement('div', { className: 'e-de-insert-table-dlg-input' });\n        this.rowsCountBox = createElement('input', {\n            attrs: { type: 'text' }, id: this.owner.owner.containerId + 'row'\n        });\n        rowValue.appendChild(this.rowsCountBox);\n        parentDiv.appendChild(columnContainer);\n        parentDiv.appendChild(columnValue);\n        parentDiv.appendChild(rowContainer);\n        parentDiv.appendChild(rowValue);\n        this.target.appendChild(parentDiv);\n        this.columnsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowsCountBox.addEventListener('keyup', instance.keyUpInsertTable);\n        this.rowValueTextBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 32767,\n            enablePersistence: false\n        });\n        this.rowValueTextBox.appendTo(this.rowsCountBox);\n        this.columnValueTexBox = new NumericTextBox({\n            format: '#',\n            value: 2,\n            min: 1,\n            max: 63,\n            enablePersistence: false\n        });\n        this.columnValueTexBox.appendTo(this.columnsCountBox);\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog.header = localValue.getConstant('Insert Table');\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertTableClick,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ok', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cancel' }\n            }];\n        this.rowValueTextBox.value = 2;\n        this.columnValueTexBox.value = 2;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableDialog.prototype.destroy = function () {\n        if (this.columnsCountBox) {\n            if (this.columnsCountBox.parentElement) {\n                this.columnsCountBox.parentElement.removeChild(this.columnsCountBox);\n            }\n            this.columnsCountBox = undefined;\n        }\n        if (this.rowsCountBox) {\n            if (this.rowsCountBox.parentElement) {\n                this.rowsCountBox.parentElement.removeChild(this.rowsCountBox);\n            }\n            this.rowsCountBox = undefined;\n        }\n        if (this.columnValueTexBox) {\n            this.columnValueTexBox.destroy();\n            this.columnValueTexBox = undefined;\n        }\n        if (this.rowValueTextBox) {\n            this.rowValueTextBox.destroy();\n            this.rowValueTextBox = undefined;\n        }\n        this.columnsCountBox = undefined;\n        this.rowsCountBox = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var i = 0; i < this.target.childNodes.length; i++) {\n                this.target.removeChild(this.target.childNodes[i]);\n                i--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableDialog;\n}());\nexport { TableDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Bookmark dialog is used to add, navigate or delete bookmarks.\n */\nvar BookmarkDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BookmarkDialog(viewer) {\n        var _this = this;\n        this.addBookmark = function () {\n            _this.owner.owner.editorModule.insertBookmark(_this.textBoxInput.value);\n            _this.owner.dialog.hide();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('bookmark_text_box');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.gotoBookmark = function () {\n            _this.owner.selection.selectBookmark(_this.textBoxInput.value);\n        };\n        this.deleteBookmark = function () {\n            _this.owner.owner.editorModule.deleteBookmark(_this.textBoxInput.value);\n            _this.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.getModuleName = function () {\n        return 'BookmarkDialog';\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.initBookmarkDialog = function (localValue, bookmarks) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_bookmark';\n        this.target = createElement('div', { id: id, className: 'e-de-bookmark' });\n        var headerValue = localValue.getConstant('Bookmark name') + ':';\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-bookmark-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-bookmark-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-bookmark-list' });\n        commonDiv.appendChild(searchDiv);\n        var textBoxDiv = createElement('div', { className: 'e-bookmark-textboxdiv' });\n        searchDiv.appendChild(textBoxDiv);\n        // tslint:disable-next-line:max-line-length\n        this.textBoxInput = createElement('input', { className: 'e-input e-bookmark-textbox-input', id: 'bookmark_text_box' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listviewDiv = createElement('div', { className: 'e-bookmark-listViewDiv', id: 'bookmark_listview' });\n        searchDiv.appendChild(listviewDiv);\n        var arts = this.owner.bookmarks.keys;\n        this.listviewInstance = new ListView({\n            dataSource: bookmarks,\n            cssClass: 'e-bookmark-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-bookmark-button' });\n        commonDiv.appendChild(buttonDiv);\n        var addbuttonDiv = createElement('div', { className: 'e-bookmark-addbutton' });\n        buttonDiv.appendChild(addbuttonDiv);\n        var addButtonElement = createElement('button', { innerHTML: 'Add', id: 'add' });\n        addbuttonDiv.appendChild(addButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(addButtonElement);\n        addButtonElement.addEventListener('click', this.addBookmark);\n        var deleteButtonDiv = createElement('div', { className: 'e-bookmark-deletebutton' });\n        buttonDiv.appendChild(deleteButtonDiv);\n        var deleteButtonElement = createElement('button', { innerHTML: 'Delete', id: 'delete' });\n        deleteButtonDiv.appendChild(deleteButtonElement);\n        var deletebutton = new Button({ cssClass: 'e-button-custom' });\n        deletebutton.appendTo(deleteButtonElement);\n        deleteButtonElement.addEventListener('click', this.deleteBookmark);\n        var gotoButtonDiv = createElement('div', { className: 'e-bookmark-gotobutton' });\n        buttonDiv.appendChild(gotoButtonDiv);\n        var gotoButtonElement = createElement('button', { innerHTML: 'Go To', id: 'goto' });\n        gotoButtonDiv.appendChild(gotoButtonElement);\n        var gotobutton = new Button({ cssClass: 'e-button-custom' });\n        gotobutton.appendTo(gotoButtonElement);\n        gotoButtonElement.addEventListener('click', this.gotoBookmark);\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.show = function () {\n        var bookmarks = this.owner.getBookmarks();\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        // if (!this.target) {\n        this.initBookmarkDialog(localObj, bookmarks);\n        //}\n        this.owner.dialog.header = 'Bookmark';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.buttons = [{\n                click: this.removeObjects.bind(this),\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BookmarkDialog.prototype.removeObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    BookmarkDialog.prototype.destroy = function () {\n        if (this.textBoxInput) {\n            this.textBoxInput.remove();\n            this.textBoxInput = undefined;\n        }\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return BookmarkDialog;\n}());\nexport { BookmarkDialog };\n","import { L10n, setCulture, createElement, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { CheckBox, Button } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { ListView } from '@syncfusion/ej2-lists';\n/**\n * The Table of contents dialog is used to insert or edit table of contents at selection.\n */\nvar TableOfContentsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOfContentsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.loadTableofContentDialog = function () {\n            _this.owner.updateFocus();\n            _this.pageNumber.checked = true;\n            _this.rightAlign.disabled = false;\n            _this.rightAlign.checked = true;\n            _this.tabLeader.enabled = true;\n            _this.hyperlink.checked = true;\n            _this.style.checked = true;\n            _this.outline.checked = true;\n            _this.outline.disabled = false;\n            _this.showLevel.enabled = true;\n        };\n        /**\n         * @private\n         */\n        this.closeTableOfContentDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.textBoxInput.value = args.text;\n            /* tslint:disable:no-any */\n            var value = document.getElementById('toclist');\n            value.setSelectionRange(0, args.text.length);\n            value.focus();\n        };\n        this.showStyleDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.styleDialogModule)) {\n                _this.owner.owner.styleDialogModule.show(_this.textBoxInput.value);\n            }\n        };\n        this.changeShowLevelValue = function (event) {\n            var levels = event.value;\n            var values = [];\n            switch (levels) {\n                case 1:\n                    values = ['1', null, null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 2:\n                    values = ['1', '2', null, null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 3:\n                    values = ['1', '2', '3', null, null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 4:\n                    values = ['1', '2', '3', '4', null, null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 5:\n                    values = ['1', '2', '3', '4', '5', null, null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 6:\n                    values = ['1', '2', '3', '4', '5', '6', null, null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 7:\n                    values = ['1', '2', '3', '4', '5', '6', '7', null, null];\n                    _this.changeByValue(values);\n                    break;\n                case 8:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', null];\n                    _this.changeByValue(values);\n                    break;\n                case 9:\n                    values = ['1', '2', '3', '4', '5', '6', '7', '8', '9'];\n                    _this.changeByValue(values);\n                    break;\n            }\n        };\n        this.changeByValue = function (headings) {\n            _this.heading1.value = headings[0];\n            _this.heading2.value = headings[1];\n            _this.heading3.value = headings[2];\n            _this.heading4.value = headings[3];\n            _this.heading5.value = headings[4];\n            _this.heading6.value = headings[5];\n            _this.heading7.value = headings[6];\n            _this.heading8.value = headings[7];\n            _this.heading9.value = headings[8];\n        };\n        this.reset = function () {\n            _this.showLevel.enabled = true;\n            _this.showLevel.value = 3;\n            _this.outline.disabled = false;\n            _this.outline.checked = true;\n            var values = ['1', '2', '3', null, null, null, null, null, null];\n            _this.changeByValue(values);\n            _this.normal.value = null;\n        };\n        this.changeStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            var value = _this.getElementValue(args.srcElement);\n            if (headingValue !== value && headingValue !== '') {\n                _this.showLevel.enabled = false;\n            }\n            else {\n                _this.showLevel.enabled = true;\n                _this.checkLevel();\n            }\n        };\n        this.changeHeadingStyle = function (args) {\n            var headingValue = args.srcElement.value;\n            if (headingValue === '') {\n                _this.showLevel.enabled = true;\n            }\n            else {\n                _this.showLevel.enabled = false;\n            }\n            if (_this.normal === args.srcElement) {\n                _this.outline.checked = false;\n                _this.outline.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changePageNumberValue = function (args) {\n            if (args.checked) {\n                _this.rightAlign.checked = true;\n                _this.rightAlign.disabled = false;\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.rightAlign.disabled = true;\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeRightAlignValue = function (args) {\n            if (args.checked) {\n                _this.tabLeader.enabled = true;\n            }\n            else {\n                _this.tabLeader.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeStyleValue = function (args) {\n            if (args.checked) {\n                _this.heading1.disabled = false;\n                _this.heading2.disabled = false;\n                _this.heading3.disabled = false;\n                _this.heading4.disabled = false;\n                _this.heading5.disabled = false;\n                _this.heading6.disabled = false;\n                _this.heading7.disabled = false;\n                _this.heading8.disabled = false;\n                _this.heading9.disabled = false;\n                _this.normal.disabled = false;\n            }\n            else {\n                _this.heading1.disabled = true;\n                _this.heading2.disabled = true;\n                _this.heading3.disabled = true;\n                _this.heading4.disabled = true;\n                _this.heading5.disabled = true;\n                _this.heading6.disabled = true;\n                _this.heading7.disabled = true;\n                _this.heading8.disabled = true;\n                _this.heading9.disabled = true;\n                _this.normal.disabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableOfContentProperties = function () {\n            var tocSettings = {\n                startLevel: 1,\n                endLevel: _this.showLevel.value,\n                includeHyperlink: _this.hyperlink.checked,\n                includePageNumber: _this.pageNumber.checked,\n                rightAlign: _this.rightAlign.checked,\n                tabLeader: _this.tabLeader.value,\n                includeOutlineLevels: _this.outline.checked\n            };\n            _this.applyLevelSetting(tocSettings);\n            _this.owner.owner.editorModule.insertTableOfContents(tocSettings);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.pageNumber.checked = false;\n            _this.rightAlign.checked = false;\n            _this.tabLeader.value = '';\n            _this.hyperlink.checked = false;\n            _this.style.checked = false;\n            _this.outline.checked = false;\n            _this.normal.value = '';\n        };\n        this.owner = viewer;\n    }\n    TableOfContentsDialog.prototype.getModuleName = function () {\n        return 'TableOfContentsDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.initTableOfContentDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_toc_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-toc-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var generalDiv = createElement('div', { id: 'general_div', className: 'e-de-toc-dlg-sub-container' });\n        this.target.appendChild(generalDiv);\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-toc-dlg-main-heading', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('General') });\n        generalDiv.appendChild(genLabel);\n        // tslint:disable-next-line:max-line-length\n        var leftGeneralDiv = createElement('div', { id: 'left_general', styles: 'float:left;position:relative;' });\n        generalDiv.appendChild(leftGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightGeneralDiv = createElement('div', { styles: 'position:relative;', className: 'e-de-toc-dlg-right-general-div' });\n        generalDiv.appendChild(rightGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var leftBottomGeneralDiv = createElement('div', { id: 'leftBottom_general', styles: 'float:left;position:absolute;top:210px;' });\n        generalDiv.appendChild(leftBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightBottomGeneralDiv = createElement('div', { className: 'e-de-toc-dlg-right-sub-container', styles: 'float:right;' });\n        generalDiv.appendChild(rightBottomGeneralDiv);\n        // tslint:disable-next-line:max-line-length\n        var pageNumberDiv = createElement('div', { id: 'pageNumber_div', className: 'e-de-toc-dlg-sub-container' });\n        var pageNumber = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_pageNumber'\n        });\n        pageNumberDiv.appendChild(pageNumber);\n        // tslint:disable-next-line:max-line-length\n        var rightAlignDiv = createElement('div', { id: 'rightAlign_div', className: 'e-de-toc-dlg-sub-container' });\n        var rightAlign = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_rightAlign'\n        });\n        rightAlignDiv.appendChild(rightAlign);\n        // tslint:disable-next-line:max-line-length\n        this.pageNumber = new CheckBox({ label: locale.getConstant('Show page numbers'), checked: true, change: this.changePageNumberValue });\n        // tslint:disable-next-line:max-line-length\n        this.rightAlign = new CheckBox({ label: locale.getConstant('Right align page numbers'), checked: true, change: this.changeRightAlignValue });\n        this.pageNumber.appendTo(pageNumber);\n        this.rightAlign.appendTo(rightAlign);\n        var tabDiv = createElement('div', { id: 'tab_div', className: 'e-de-toc-dlg-tab-div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabelDiv = createElement('div', { id: 'tabLeaderLabel_div' });\n        // tslint:disable-next-line:max-line-length\n        var tabLeaderLabel = createElement('label', { id: ownerId + '_tabLeaderLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Tab leader') + ':' });\n        tabLeaderLabelDiv.appendChild(tabLeaderLabel);\n        var tabLeaderDiv = createElement('div', { id: 'tabLeader_div' });\n        var tabLeader = createElement('select', {\n            id: ownerId + '_tabLeader',\n            innerHTML: '<option value=\"None\">' + '(' + locale.getConstant('None').toLocaleLowerCase() + ')' +\n                '</option><option value=\"Dot\" selected>' + '....................' +\n                '</option><option value=\"Hyphen\">' + '-------------------' +\n                '</option><option value=\"Underscore\">' + '____________' + '</option>'\n        });\n        tabLeaderDiv.appendChild(tabLeader);\n        tabDiv.appendChild(tabLeaderLabelDiv);\n        tabDiv.appendChild(tabLeaderDiv);\n        leftGeneralDiv.appendChild(pageNumberDiv);\n        leftGeneralDiv.appendChild(rightAlignDiv);\n        leftGeneralDiv.appendChild(tabDiv);\n        this.tabLeader = new DropDownList({ width: 210 });\n        this.tabLeader.appendTo(tabLeader);\n        var hyperlink = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_hyperlink'\n        });\n        rightGeneralDiv.appendChild(hyperlink);\n        this.hyperlink = new CheckBox({ label: locale.getConstant('Use hyperlinks instead of page numbers'), checked: true });\n        this.hyperlink.appendTo(hyperlink);\n        // tslint:disable-next-line:max-line-length\n        var showDiv = createElement('div', { id: 'show_div', className: 'e-de-toc-dlg-style-label' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabelDiv = createElement('div', { id: 'showLevelLabel_div', className: 'e-de-toc-dlg-show-level-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevelLabel = createElement('label', { id: ownerId + '_showLevelLabel', className: 'e-de-toc-dlg-heading', innerHTML: locale.getConstant('Show levels') + ':' });\n        showLevelLabelDiv.appendChild(showLevelLabel);\n        // tslint:disable-next-line:max-line-length\n        var showLevelDiv = createElement('div', { id: 'showLevel_div', className: 'e-de-toc-dlg-showlevel-div' });\n        // tslint:disable-next-line:max-line-length\n        var showLevel = createElement('input', { id: ownerId + '_showLevel', attrs: { 'type': 'text' } });\n        showLevelDiv.appendChild(showLevel);\n        showDiv.appendChild(showLevelLabelDiv);\n        showDiv.appendChild(showLevelDiv);\n        rightGeneralDiv.appendChild(showDiv);\n        this.showLevel = new NumericTextBox({ format: '#', value: 3, min: 1, max: 9, width: 210, change: this.changeShowLevelValue });\n        this.showLevel.appendTo(showLevel);\n        // tslint:disable-next-line:max-line-length\n        var buildTableDiv = createElement('div', { id: 'buildTable_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var buildTableLabel = createElement('div', { id: ownerId + '_buildTableLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-build-table', styles: 'margin-bottom: 13px;', innerHTML: locale.getConstant('Build table of contents from') + ':' });\n        leftBottomGeneralDiv.appendChild(buildTableDiv);\n        leftBottomGeneralDiv.appendChild(buildTableLabel);\n        var style = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_style',\n        });\n        leftBottomGeneralDiv.appendChild(style);\n        this.style = new CheckBox({ label: locale.getConstant('Styles'), checked: true, change: this.changeStyleValue });\n        this.style.appendTo(style);\n        var table = createElement('TABLE', { styles: 'margin-top:3px;' });\n        var tr1 = createElement('tr');\n        var td1 = createElement('td', { styles: 'width:120px;padding-left:10px;' });\n        var availableLabel = createElement('label', {\n            // tslint:disable-next-line:max-line-length\n            innerHTML: locale.getConstant('Available styles'), className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading', id: this.target.id + '_availableLabel'\n        });\n        td1.appendChild(availableLabel);\n        var td2 = createElement('td');\n        var tocLabel = createElement('label', {\n            innerHTML: locale.getConstant('TOC level') + ':', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading',\n            id: this.target.id + '_tocLabel'\n        });\n        td2.appendChild(tocLabel);\n        tr1.appendChild(td1);\n        tr1.appendChild(td2);\n        table.appendChild(tr1);\n        // tslint:disable-next-line:max-line-length\n        var tableDiv = createElement('div', { id: 'table_div', className: 'e-de-toc-table-div' });\n        var table1 = createElement('TABLE');\n        var tr2 = createElement('tr');\n        var td3 = createElement('td');\n        var heading1Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 1',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading1Label'\n        });\n        td3.appendChild(heading1Label);\n        var td4 = createElement('td');\n        this.heading1 = createElement('input', { id: '_heading1', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading1.value = '1';\n        this.heading1.addEventListener('keyup', this.changeStyle);\n        td4.appendChild(this.heading1);\n        tr2.appendChild(td3);\n        tr2.appendChild(td4);\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var heading2Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 2',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading2Label'\n        });\n        td5.appendChild(heading2Label);\n        var td6 = createElement('td');\n        this.heading2 = createElement('input', { id: '_heading2', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading2.value = '2';\n        this.heading2.addEventListener('keyup', this.changeStyle);\n        td6.appendChild(this.heading2);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        var tr4 = createElement('tr');\n        var td7 = createElement('td');\n        var heading3Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 3',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading3Label'\n        });\n        td7.appendChild(heading3Label);\n        var td8 = createElement('td');\n        this.heading3 = createElement('input', { id: '_heading3', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading3.value = '3';\n        this.heading3.addEventListener('keyup', this.changeStyle);\n        td8.appendChild(this.heading3);\n        tr4.appendChild(td7);\n        tr4.appendChild(td8);\n        var tr5 = createElement('tr');\n        var td9 = createElement('td');\n        var heading4Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 4',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading4Label'\n        });\n        td9.appendChild(heading4Label);\n        var td10 = createElement('td');\n        this.heading4 = createElement('input', { id: '_heading4', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading4.addEventListener('keyup', this.changeStyle);\n        td10.appendChild(this.heading4);\n        tr5.appendChild(td9);\n        tr5.appendChild(td10);\n        var tr6 = createElement('tr');\n        var td11 = createElement('td');\n        var heading5Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 5',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading5Label'\n        });\n        td11.appendChild(heading5Label);\n        var td12 = createElement('td');\n        this.heading5 = createElement('input', { id: '_heading5', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading5.addEventListener('keyup', this.changeStyle);\n        td12.appendChild(this.heading5);\n        tr6.appendChild(td11);\n        tr6.appendChild(td12);\n        var tr7 = createElement('tr');\n        var td13 = createElement('td');\n        var heading6Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 6',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading6Label'\n        });\n        td13.appendChild(heading6Label);\n        var td14 = createElement('td');\n        this.heading6 = createElement('input', { id: '_heading6', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading6.addEventListener('keyup', this.changeStyle);\n        td14.appendChild(this.heading6);\n        tr7.appendChild(td13);\n        tr7.appendChild(td14);\n        var tr8 = createElement('tr');\n        var td15 = createElement('td');\n        var heading7Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 7',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading7Label'\n        });\n        td15.appendChild(heading7Label);\n        var td16 = createElement('td');\n        this.heading7 = createElement('input', { id: '_heading7', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading7.addEventListener('keyup', this.changeStyle);\n        td16.appendChild(this.heading7);\n        tr8.appendChild(td15);\n        tr8.appendChild(td16);\n        var tr9 = createElement('tr');\n        var td17 = createElement('td');\n        var heading8Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 8',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading8Label'\n        });\n        td17.appendChild(heading8Label);\n        var td18 = createElement('td');\n        this.heading8 = createElement('input', { id: '_heading8', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading8.addEventListener('keyup', this.changeStyle);\n        td18.appendChild(this.heading8);\n        tr9.appendChild(td17);\n        tr9.appendChild(td18);\n        var tr10 = createElement('tr');\n        var td19 = createElement('td');\n        var heading9Label = createElement('label', {\n            innerHTML: locale.getConstant('Heading') + ' 9',\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_heading9Label'\n        });\n        td19.appendChild(heading9Label);\n        var td20 = createElement('td');\n        this.heading9 = createElement('input', { id: '_heading9', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.heading9.addEventListener('keyup', this.changeStyle);\n        td20.appendChild(this.heading9);\n        tr10.appendChild(td19);\n        tr10.appendChild(td20);\n        var tr12 = createElement('tr');\n        var td23 = createElement('td');\n        var normalLabel = createElement('label', {\n            innerHTML: locale.getConstant('Normal'),\n            className: 'e-de-toc-dlg-sub-heading', id: this.target.id + '_normalLabel'\n        });\n        td23.appendChild(normalLabel);\n        var td24 = createElement('td');\n        this.normal = createElement('input', { id: '_normal', className: 'e-input e-de-toc-dlg-toc-level' });\n        this.normal.addEventListener('keyup', this.changeHeadingStyle);\n        td24.appendChild(this.normal);\n        tr12.appendChild(td23);\n        tr12.appendChild(td24);\n        table1.appendChild(tr2);\n        table1.appendChild(tr3);\n        table1.appendChild(tr4);\n        table1.appendChild(tr5);\n        table1.appendChild(tr6);\n        table1.appendChild(tr7);\n        table1.appendChild(tr8);\n        table1.appendChild(tr9);\n        table1.appendChild(tr10);\n        table1.appendChild(tr12);\n        tableDiv.appendChild(table1);\n        var stylesLevelDiv = createElement('div', { className: 'e-de-toc-styles-table-div' });\n        stylesLevelDiv.appendChild(table);\n        stylesLevelDiv.appendChild(tableDiv);\n        leftBottomGeneralDiv.appendChild(stylesLevelDiv);\n        //leftBottomGeneralDiv.appendChild(table); leftBottomGeneralDiv.appendChild(tableDiv);\n        var fieldsDiv = createElement('div', { id: 'fields_div', styles: 'display: flex;' });\n        leftBottomGeneralDiv.appendChild(fieldsDiv);\n        var outDiv = createElement('div', { id: 'out_div' });\n        // tslint:disable-next-line:max-line-length\n        var outlineDiv = createElement('div', { id: 'outline_div', className: 'e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels' });\n        var outline = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: '_outline'\n        });\n        outlineDiv.appendChild(outline);\n        outDiv.appendChild(outlineDiv);\n        fieldsDiv.appendChild(outDiv);\n        this.outline = new CheckBox({ label: locale.getConstant('Outline levels'), checked: true });\n        this.outline.appendTo(outline);\n        var resetButtonDiv = createElement('div', { className: 'e-de-toc-reset-button' });\n        fieldsDiv.appendChild(resetButtonDiv);\n        var resetElement = createElement('button', { innerHTML: 'Reset', id: 'reset' });\n        resetButtonDiv.appendChild(resetElement);\n        var resetButton = new Button({ cssClass: 'e-btn e-flat' });\n        resetButton.appendTo(resetElement);\n        resetElement.addEventListener('click', this.reset);\n        // tslint:disable-next-line:max-line-length\n        var tocStylesDiv = createElement('div', { id: 'tocStyles_div', className: 'e-de-toc-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var tocStylesLabel = createElement('div', {\n            id: ownerId + '_tocStylesLabel', className: 'e-de-toc-dlg-main-heading e-de-toc-dlg-styles',\n            innerHTML: locale.getConstant('Styles') + ':'\n        });\n        rightBottomGeneralDiv.appendChild(tocStylesDiv);\n        rightBottomGeneralDiv.appendChild(tocStylesLabel);\n        var textBoxDiv = createElement('div', { className: 'e-de-toc-dlg-style-input' });\n        rightBottomGeneralDiv.appendChild(textBoxDiv);\n        this.textBoxInput = createElement('input', { className: 'e-input', id: 'toclist' });\n        this.textBoxInput.setAttribute('type', 'text');\n        textBoxDiv.appendChild(this.textBoxInput);\n        var listViewDiv = createElement('div', { className: 'e-de-toc-list-view' });\n        var styleValues = ['TOC 1', 'TOC 2', 'TOC 3', 'TOC 4', 'TOC 5', 'TOC 6', 'TOC 7', 'TOC 8', 'TOC 9'];\n        this.listViewInstance = new ListView({ dataSource: styleValues, cssClass: 'e-toc-list-view' });\n        this.listViewInstance.appendTo(listViewDiv);\n        this.listViewInstance.addEventListener('select', this.selectHandler);\n        rightBottomGeneralDiv.appendChild(listViewDiv);\n        var modifyButtonDiv = createElement('div', { className: 'e-de-toc-modify-button' });\n        rightBottomGeneralDiv.appendChild(modifyButtonDiv);\n        var modifyElement = createElement('button', { innerHTML: 'Modify', id: 'modify' });\n        modifyButtonDiv.appendChild(modifyElement);\n        var modifyButton = new Button({ cssClass: 'e-btn e-flat' });\n        modifyButton.appendTo(modifyElement);\n        modifyElement.addEventListener('click', this.showStyleDialog);\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOfContentDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Table of Contents');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadTableofContentDialog;\n        this.owner.dialog.close = this.closeTableOfContentDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableOfContentProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-toc-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-toc-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    TableOfContentsDialog.prototype.checkLevel = function () {\n        if (this.heading1.value !== '') {\n            this.showLevel.value = 1;\n        }\n        if (this.heading2.value !== '') {\n            this.showLevel.value = 2;\n        }\n        if (this.heading3.value !== '') {\n            this.showLevel.value = 3;\n        }\n        if (this.heading4.value !== '') {\n            this.showLevel.value = 4;\n        }\n        if (this.heading5.value !== '') {\n            this.showLevel.value = 5;\n        }\n        if (this.heading6.value !== '') {\n            this.showLevel.value = 6;\n        }\n        if (this.heading7.value !== '') {\n            this.showLevel.value = 7;\n        }\n        if (this.heading8.value !== '') {\n            this.showLevel.value = 8;\n        }\n        if (this.heading9.value !== '') {\n            this.showLevel.value = 9;\n        }\n    };\n    TableOfContentsDialog.prototype.getElementValue = function (element) {\n        switch (element) {\n            case this.heading1:\n                return '1';\n            case this.heading2:\n                return '2';\n            case this.heading3:\n                return '3';\n            case this.heading4:\n                return '4';\n            case this.heading5:\n                return '5';\n            case this.heading6:\n                return '6';\n            case this.heading7:\n                return '7';\n            case this.heading8:\n                return '8';\n            case this.heading9:\n                return '9';\n            default:\n                return '1';\n        }\n    };\n    TableOfContentsDialog.prototype.getHeadingLevel = function (index) {\n        switch (index) {\n            case 1:\n                return parseInt(this.heading1.value);\n            case 2:\n                return parseInt(this.heading2.value);\n            case 3:\n                return parseInt(this.heading3.value);\n            case 4:\n                return parseInt(this.heading4.value);\n            case 5:\n                return parseInt(this.heading5.value);\n            case 6:\n                return parseInt(this.heading6.value);\n            case 7:\n                return parseInt(this.heading7.value);\n            case 8:\n                return parseInt(this.heading8.value);\n            case 9:\n                return parseInt(this.heading9.value);\n            default:\n                return 0;\n        }\n    };\n    TableOfContentsDialog.prototype.applyLevelSetting = function (tocSettings) {\n        tocSettings.levelSettings = {};\n        var headingPrefix = 'Heading ';\n        var newStartLevel = 0;\n        var newEndLevel = 0;\n        var isEndLevel = false;\n        for (var i = 1; i <= tocSettings.endLevel; i++) {\n            var outlineLevel = this.getHeadingLevel(i);\n            if (i === outlineLevel) {\n                if (newStartLevel === 0) {\n                    newStartLevel = i;\n                    isEndLevel = false;\n                }\n                if (!isEndLevel) {\n                    newEndLevel = i;\n                }\n            }\n            else {\n                isEndLevel = true;\n                if (outlineLevel !== 0) {\n                    var headingStyle = headingPrefix + i.toString();\n                    tocSettings.levelSettings[headingStyle] = outlineLevel;\n                }\n            }\n        }\n        tocSettings.startLevel = newStartLevel;\n        tocSettings.endLevel = newEndLevel;\n        if (this.normal.value !== '') {\n            tocSettings.levelSettings['Normal'] = +this.normal.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOfContentsDialog.prototype.destroy = function () {\n        if (this.pageNumber) {\n            this.pageNumber.destroy();\n            this.pageNumber = undefined;\n        }\n        if (this.rightAlign) {\n            this.rightAlign.destroy();\n            this.rightAlign = undefined;\n        }\n        if (this.tabLeader) {\n            this.tabLeader.destroy();\n            this.tabLeader = undefined;\n        }\n        if (this.showLevel) {\n            this.showLevel.destroy();\n            this.showLevel = undefined;\n        }\n        if (this.hyperlink) {\n            this.hyperlink.destroy();\n            this.hyperlink = undefined;\n        }\n        if (this.style) {\n            this.style.destroy();\n            this.style = undefined;\n        }\n        if (this.outline) {\n            this.outline.destroy();\n            this.outline = undefined;\n        }\n        if (this.listViewInstance) {\n            this.listViewInstance.destroy();\n            this.listViewInstance = undefined;\n        }\n        this.heading1 = undefined;\n        this.heading2 = undefined;\n        this.heading3 = undefined;\n        this.heading4 = undefined;\n        this.heading5 = undefined;\n        this.heading6 = undefined;\n        this.heading7 = undefined;\n        this.heading8 = undefined;\n        this.heading9 = undefined;\n        this.normal = undefined;\n        this.textBoxInput = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var count = 0; count < this.target.childNodes.length; count++) {\n                this.target.removeChild(this.target.childNodes[count]);\n                count--;\n            }\n            this.target = undefined;\n        }\n    };\n    return TableOfContentsDialog;\n}());\nexport { TableOfContentsDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox, RadioButton } from '@syncfusion/ej2-buttons';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { WSectionFormat } from './../../implementation/format/index';\nimport { Tab } from '@syncfusion/ej2-navigations';\n/**\n * The Page setup dialog is used to modify formatting of selected sections.\n */\nvar PageSetupDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function PageSetupDialog(viewer) {\n        var _this = this;\n        this.isPortrait = true;\n        /**\n         * @private\n         */\n        this.loadPageSetupDialog = function () {\n            _this.owner.updateFocus();\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            _this.topMarginBox.value = sectionFormat.topMargin;\n            _this.leftMarginBox.value = sectionFormat.leftMargin;\n            _this.bottomMarginBox.value = sectionFormat.bottomMargin;\n            _this.rightMarginBox.value = sectionFormat.rightMargin;\n            _this.widthBox.value = sectionFormat.pageWidth;\n            _this.heightBox.value = sectionFormat.pageHeight;\n            _this.checkBox1.checked = sectionFormat.differentOddAndEvenPages;\n            _this.checkBox2.checked = sectionFormat.differentFirstPage;\n            _this.headerBox.value = sectionFormat.headerDistance;\n            _this.footerBox.value = sectionFormat.footerDistance;\n            if (_this.widthBox.value > _this.heightBox.value) {\n                _this.landscape.checked = true;\n            }\n            else {\n                _this.portrait.checked = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.closePageSetupDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.keyUpInsertPageSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyPageSetupProperties();\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyPageSetupProperties = function () {\n            var sectionFormat = new WSectionFormat();\n            sectionFormat.bottomMargin = _this.bottomMarginBox.value;\n            sectionFormat.topMargin = _this.topMarginBox.value;\n            sectionFormat.leftMargin = _this.leftMarginBox.value;\n            sectionFormat.rightMargin = _this.rightMarginBox.value;\n            sectionFormat.pageWidth = _this.widthBox.value;\n            sectionFormat.pageHeight = _this.heightBox.value;\n            sectionFormat.differentOddAndEvenPages = _this.checkBox1.checked;\n            sectionFormat.differentFirstPage = _this.checkBox2.checked;\n            sectionFormat.headerDistance = _this.headerBox.value;\n            sectionFormat.footerDistance = _this.footerBox.value;\n            _this.owner.owner.editorModule.onApplySectionFormat(undefined, sectionFormat);\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.changeByPaperSize = function (event) {\n            var value = event.value;\n            var sectionFormat = _this.owner.selection.sectionFormat;\n            var width = sectionFormat.pageWidth;\n            var height = sectionFormat.pageHeight;\n            if (_this.owner.selection.sectionFormat.pageWidth > _this.owner.selection.sectionFormat.pageHeight || _this.landscape.checked) {\n                _this.isPortrait = false;\n            }\n            else {\n                _this.isPortrait = true;\n            }\n            if (value === 'letter') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 792;\n                }\n                else {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'tabloid') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 792;\n                    _this.heightBox.value = 1224;\n                }\n                else {\n                    _this.widthBox.value = 1224;\n                    _this.heightBox.value = 792;\n                }\n            }\n            else if (value === 'legal') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 1008;\n                }\n                else {\n                    _this.widthBox.value = 1008;\n                    _this.heightBox.value = 612;\n                }\n            }\n            else if (value === 'statement') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 392;\n                    _this.heightBox.value = 612;\n                }\n                else {\n                    _this.widthBox.value = 612;\n                    _this.heightBox.value = 392;\n                }\n            }\n            else if (value === 'executive') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 522;\n                    _this.heightBox.value = 756;\n                }\n                else {\n                    _this.widthBox.value = 756;\n                    _this.heightBox.value = 522;\n                }\n            }\n            else if (value === 'a3') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 1190.55;\n                }\n                else {\n                    _this.widthBox.value = 1190.55;\n                    _this.heightBox.value = 841.9;\n                }\n            }\n            else if (value === 'a4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 841.9;\n                }\n                else {\n                    _this.widthBox.value = 841.9;\n                    _this.heightBox.value = 595.3;\n                }\n            }\n            else if (value === 'a5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 419.55;\n                    _this.heightBox.value = 595.3;\n                }\n                else {\n                    _this.widthBox.value = 595.3;\n                    _this.heightBox.value = 419.55;\n                }\n            }\n            else if (value === 'b4') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 1031.8;\n                }\n                else {\n                    _this.widthBox.value = 1031.8;\n                    _this.heightBox.value = 728.5;\n                }\n            }\n            else if (value === 'b5') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n            else if (value === 'customsize') {\n                if (_this.isPortrait) {\n                    _this.widthBox.value = 515.9;\n                    _this.heightBox.value = 728.5;\n                }\n                else {\n                    _this.widthBox.value = 728.5;\n                    _this.heightBox.value = 515.9;\n                }\n            }\n        };\n        /**\n         * @private\n         */\n        this.onPortrait = function (event) {\n            _this.landscape.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width > height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.onLandscape = function (event) {\n            _this.portrait.checked = false;\n            var width = _this.widthBox.value;\n            var height = _this.heightBox.value;\n            if (width < height) {\n                _this.widthBox.value = height;\n                _this.heightBox.value = width;\n            }\n        };\n        /**\n         * @private\n         */\n        this.unWireEventsAndBindings = function () {\n            _this.paperSize.value = undefined;\n            _this.topMarginBox.value = undefined;\n            _this.bottomMarginBox.value = undefined;\n            _this.leftMarginBox.value = undefined;\n            _this.rightMarginBox.value = undefined;\n            _this.headerBox.value = undefined;\n            _this.footerBox.value = undefined;\n            _this.widthBox.value = undefined;\n            _this.heightBox.value = undefined;\n            _this.checkBox1.checked = false;\n            _this.checkBox2.checked = false;\n            _this.portrait.checked = false;\n            _this.landscape.checked = false;\n        };\n        this.owner = viewer;\n    }\n    PageSetupDialog.prototype.getModuleName = function () {\n        return 'PageSetupDialog';\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPageSetupDialog = function (locale) {\n        var id = this.owner.owner.containerId + '_pagesetup_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-pagesetup-dlg-container' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_MarginTabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.marginTab = createElement('div', {\n            id: this.target.id + '_marginPropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.paperTab = createElement('div', {\n            id: this.target.id + '_paperSizePropertyTab', styles: 'position: relative;width:400px;'\n        });\n        this.layoutTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', styles: 'position: relative;width:400px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_PageSetupDialogTab', className: 'e-de-page-setup-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var marginHeader = createElement('div', {\n            id: this.target.id + '_marginHeader', innerHTML: locale.getConstant('Margin')\n        });\n        var paperHeader = createElement('div', {\n            id: this.target.id + '_paperHeader', innerHTML: locale.getConstant('Paper')\n        });\n        var layoutHeader = createElement('div', {\n            id: this.target.id + '_layoutHeader', innerHTML: locale.getConstant('Layout')\n        });\n        headerContainer.appendChild(marginHeader);\n        headerContainer.appendChild(paperHeader);\n        headerContainer.appendChild(layoutHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var marginContent = createElement('div', { id: this.target.id + '_marginContent' });\n        var paperContent = createElement('div', { id: this.target.id + '_paperContent' });\n        var layoutContent = createElement('div', { id: this.target.id + '_layoutContent' });\n        marginContent.appendChild(this.marginTab);\n        paperContent.appendChild(this.paperTab);\n        layoutContent.appendChild(this.layoutTab);\n        contentContainer.appendChild(marginContent);\n        contentContainer.appendChild(paperContent);\n        contentContainer.appendChild(layoutContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initMarginProperties(this.marginTab, locale);\n        this.initPaperSizeProperties(this.paperTab, locale);\n        this.initLayoutProperties(this.layoutTab, locale);\n        var tabObj = new Tab({}, ejtab);\n        this.target.addEventListener('keyup', this.keyUpInsertPageSettings);\n        var marginTabHeader = tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var marginTabHeaderItem = marginTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        marginTabHeaderItem.classList.add('e-de-page-setup-dlg-margin-tab-header');\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initMarginProperties = function (element, locale) {\n        var marginDiv = createElement('div', {\n            id: 'margin_div',\n            className: 'e-de-page-setup-dlg-sub-container', styles: 'height:135px;'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftMarginDiv = createElement('div', { id: 'left_margin', className: 'e-de-page-setup-dlg-left-sub-container' });\n        marginDiv.appendChild(leftMarginDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightMarginDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        marginDiv.appendChild(rightMarginDiv);\n        var topLabel = createElement('label', {\n            innerHTML: locale.getConstant('Top'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_TopLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var topTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Top'\n        });\n        var bottomBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Bottom'),\n            className: 'e-de-page-setup-dlg-sub-title-header', id: this.target.id + '_bottomLabel'\n        });\n        var bottomTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_bottom'\n        });\n        leftMarginDiv.appendChild(topLabel);\n        leftMarginDiv.appendChild(topTextBox);\n        leftMarginDiv.appendChild(bottomBoxLabel);\n        leftMarginDiv.appendChild(bottomTextBox);\n        var leftBoxLabel = createElement('label', {\n            innerHTML: locale.getConstant('Left'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_leftLabel'\n        });\n        var leftTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_left'\n        });\n        var rightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Right'),\n            id: this.target.id + '_rightLabel', className: 'e-de-page-setup-dlg-sub-title-header'\n        });\n        var rightTextBox = createElement('input', {\n            attrs: { 'type': 'text' },\n            id: this.target.id + '_right'\n        });\n        rightMarginDiv.appendChild(leftBoxLabel);\n        rightMarginDiv.appendChild(leftTextBox);\n        rightMarginDiv.appendChild(rightLabel);\n        rightMarginDiv.appendChild(rightTextBox);\n        element.appendChild(marginDiv);\n        this.topMarginBox = new NumericTextBox({ value: 71, width: 170, decimals: 2 });\n        this.topMarginBox.appendTo(topTextBox);\n        this.leftMarginBox = new NumericTextBox({ value: 73, width: 170, decimals: 2 });\n        this.leftMarginBox.appendTo(leftTextBox);\n        this.bottomMarginBox = new NumericTextBox({ value: 72, width: 170, decimals: 2 });\n        this.bottomMarginBox.appendTo(bottomTextBox);\n        this.rightMarginBox = new NumericTextBox({ value: 74, width: 170, decimals: 2 });\n        this.rightMarginBox.appendTo(rightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var orientationDiv = createElement('div', { id: 'orientation_div', className: 'e-de-page-setup-dlg-sub-container-port' });\n        // tslint:disable-next-line:max-line-length\n        var orientationLabeldiv = createElement('div', { id: '_orientationLabelDiv', className: 'e-de-page-setup-dlg-sub-label', innerHTML: locale.getConstant('Orientation') });\n        var orientationPropDiv = createElement('div', { id: '_orientationPropDiv', styles: 'display: flex;', className: 'e-de-page-setup-dlg-orientation-prop' });\n        var portraitDiv = createElement('div', { id: '_portraitDiv', styles: 'padding-right: 30px;' });\n        var portrait = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_portrait'\n        });\n        var landscapeDiv = createElement('div', { id: '_landscapeDiv' });\n        var landscape = createElement('input', {\n            attrs: { 'type': 'radiobutton' }, id: this.target.id + '_landscape'\n        });\n        portraitDiv.appendChild(portrait);\n        landscapeDiv.appendChild(landscape);\n        orientationPropDiv.appendChild(portraitDiv);\n        orientationPropDiv.appendChild(landscapeDiv);\n        orientationDiv.appendChild(orientationLabeldiv);\n        orientationDiv.appendChild(orientationPropDiv);\n        this.portrait = new RadioButton({ label: locale.getConstant('Portrait'), checked: true, change: this.onPortrait });\n        this.landscape = new RadioButton({ label: locale.getConstant('Landscape'), change: this.onLandscape });\n        this.portrait.appendTo(portrait);\n        this.landscape.appendTo(landscape);\n        element.appendChild(orientationDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initPaperSizeProperties = function (element, locale) {\n        var sizeDiv = createElement('div', {\n            id: 'size_div',\n            className: 'e-de-page-setup-dlg-sub-size-container'\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftSizeDiv = createElement('div', { id: 'left_size', className: 'e-de-page-setup-dlg-left-sub-container' });\n        sizeDiv.appendChild(leftSizeDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSizeDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-sub-container' });\n        sizeDiv.appendChild(rightSizeDiv);\n        var widthLabel = createElement('label', {\n            innerHTML: locale.getConstant('Width'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_widthLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var widthTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_Width'\n        });\n        leftSizeDiv.appendChild(widthLabel);\n        leftSizeDiv.appendChild(widthTextBox);\n        var heightLabel = createElement('label', {\n            innerHTML: locale.getConstant('Height'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_heightLabel'\n        });\n        var heightTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_height'\n        });\n        rightSizeDiv.appendChild(heightLabel);\n        rightSizeDiv.appendChild(heightTextBox);\n        element.appendChild(sizeDiv);\n        this.widthBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.widthBox.appendTo(widthTextBox);\n        this.heightBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.heightBox.appendTo(heightTextBox);\n        // tslint:disable-next-line:max-line-length\n        var paperSizeDiv = createElement('div', { id: '_paperSizeDiv', styles: 'height:37px;', className: 'e-de-page-setup-dlg-sub-container' });\n        var paperSize = createElement('select', {\n            id: this.target.id + '_papersize', styles: 'width:170px;padding-bottom: 20px;',\n            innerHTML: '<option value=\"letter\">' + locale.getConstant('Letter') +\n                '</option><option value=\"tabloid\">' + locale.getConstant('Tabloid') +\n                '</option><option value=\"legal\">' + locale.getConstant('Legal') +\n                '</option><option value=\"statement\">' + locale.getConstant('Statement') +\n                '</option><option value=\"executive\">' + locale.getConstant('Executive') +\n                '</option><option value=\"a3\">' + locale.getConstant('A3') +\n                '</option><option value=\"a4\">' + locale.getConstant('A4') +\n                '</option><option value=\"a5\">' + locale.getConstant('A5') +\n                '</option><option value=\"b4\">' + locale.getConstant('B4') +\n                '</option><option value=\"b5\">' + locale.getConstant('B5') +\n                '</option><option value=\"customsize\">' + locale.getConstant('Custom Size') + '</option>'\n        });\n        paperSizeDiv.appendChild(paperSize);\n        this.paperSize = new DropDownList({ change: this.changeByPaperSize, width: '170px' });\n        this.paperSize.appendTo(paperSize);\n        element.appendChild(paperSizeDiv);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.initLayoutProperties = function (element, locale) {\n        // tslint:disable-next-line:max-line-length\n        var layoutDiv = createElement('div', { id: '_layoutDiv', className: 'e-de-page-setup-dlg-layout-sub-container', });\n        // tslint:disable-next-line:max-line-length\n        var firstPageDiv = createElement('div', { id: '_firstPageDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-first-page-prop' });\n        var checkBox1 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_oddoreven'\n        });\n        firstPageDiv.appendChild(checkBox1);\n        // tslint:disable-next-line:max-line-length\n        var oddOrEvenDiv = createElement('div', { id: '_oddOrEvenDiv', styles: 'height: 27px;', className: 'e-de-page-setup-dlg-odd-or-even-prop' });\n        var checkBox2 = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_even'\n        });\n        oddOrEvenDiv.appendChild(checkBox2);\n        layoutDiv.appendChild(firstPageDiv);\n        layoutDiv.appendChild(oddOrEvenDiv);\n        this.checkBox1 = new CheckBox({ label: locale.getConstant('Different odd and even') });\n        this.checkBox2 = new CheckBox({ label: locale.getConstant('Different first page') });\n        this.checkBox1.appendTo(checkBox1);\n        this.checkBox2.appendTo(checkBox2);\n        element.appendChild(layoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var textLabelDiv = createElement('div', { id: '_textLabelDiv', className: 'e-de-page-setup-dlg-sub-label' });\n        var textLabel = createElement('label', {\n            innerHTML: locale.getConstant('From edge'), id: this.target.id + '_textLabel'\n        });\n        textLabelDiv.appendChild(textLabel);\n        element.appendChild(textLabelDiv);\n        // tslint:disable-next-line:max-line-length\n        var propertyDiv = createElement('div', { id: '_headerFooeterPropDiv', className: 'e-de-page-setup-dlg-sub-container', styles: 'height: 65px;' });\n        // tslint:disable-next-line:max-line-length\n        var leftLayoutDiv = createElement('div', { id: '_leftLayoutDiv', className: 'e-de-page-setup-dlg-left-layout-container' });\n        propertyDiv.appendChild(leftLayoutDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightLayoutDiv = createElement('div', { className: 'e-de-page-setup-dlg-right-layout-container' });\n        propertyDiv.appendChild(rightLayoutDiv);\n        var headerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Header'), className: 'e-de-page-setup-dlg-sub-header',\n            id: this.target.id + '_headerLabel', styles: 'padding-top:0px;width:190px;'\n        });\n        var headerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_header'\n        });\n        leftLayoutDiv.appendChild(headerLabel);\n        leftLayoutDiv.appendChild(headerBox);\n        var footerLabel = createElement('label', {\n            innerHTML: locale.getConstant('Footer'), className: 'e-de-page-setup-dlg-sub-header', styles: 'padding-top:0px;width:190px;',\n            id: this.target.id + '_footerLabel'\n        });\n        var footerBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_footer'\n        });\n        rightLayoutDiv.appendChild(footerLabel);\n        rightLayoutDiv.appendChild(footerBox);\n        element.appendChild(propertyDiv);\n        this.headerBox = new NumericTextBox({ value: 612, width: 170, decimals: 2 });\n        this.headerBox.appendTo(headerBox);\n        this.footerBox = new NumericTextBox({ value: 792, width: 170, decimals: 2 });\n        this.footerBox.appendTo(footerBox);\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initPageSetupDialog(localValue);\n        }\n        this.owner.dialog.header = localValue.getConstant('Page Setup');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadPageSetupDialog;\n        this.owner.dialog.close = this.closePageSetupDialog;\n        this.owner.dialog.buttons = [{\n                click: this.applyPageSetupProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-layout-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-layout-ppty-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    PageSetupDialog.prototype.destroy = function () {\n        if (this.topMarginBox) {\n            this.topMarginBox.destroy();\n            this.topMarginBox = undefined;\n        }\n        if (this.leftMarginBox) {\n            this.leftMarginBox.destroy();\n            this.leftMarginBox = undefined;\n        }\n        if (this.bottomMarginBox) {\n            this.bottomMarginBox.destroy();\n            this.bottomMarginBox = undefined;\n        }\n        if (this.rightMarginBox) {\n            this.rightMarginBox.destroy();\n            this.rightMarginBox = undefined;\n        }\n        if (this.headerBox) {\n            this.headerBox.destroy();\n            this.headerBox = undefined;\n        }\n        if (this.footerBox) {\n            this.footerBox.destroy();\n            this.footerBox = undefined;\n        }\n        if (this.widthBox) {\n            this.widthBox.destroy();\n            this.widthBox = undefined;\n        }\n        if (this.heightBox) {\n            this.heightBox.destroy();\n            this.heightBox = undefined;\n        }\n        if (this.paperSize) {\n            this.paperSize.destroy();\n            this.paperSize = undefined;\n        }\n        if (this.checkBox1) {\n            this.checkBox1.destroy();\n            this.checkBox1 = undefined;\n        }\n        if (this.checkBox2) {\n            this.checkBox2.destroy();\n            this.checkBox2 = undefined;\n        }\n        if (this.portrait) {\n            this.portrait.destroy();\n            this.portrait = undefined;\n        }\n        if (this.landscape) {\n            this.landscape.destroy();\n            this.landscape = undefined;\n        }\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n    };\n    return PageSetupDialog;\n}());\nexport { PageSetupDialog };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { WParagraphFormat } from '../index';\n/**\n * The Paragraph dialog is used to modify formatting of selected paragraphs.\n */\nvar ParagraphDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ParagraphDialog(viewer) {\n        var _this = this;\n        //paragraph Format properties\n        this.leftIndent = undefined;\n        this.rightIndent = undefined;\n        this.beforeSpacing = undefined;\n        this.afterSpacing = undefined;\n        this.textAlignment = undefined;\n        this.firstLineIndent = undefined;\n        this.lineSpacingIn = undefined;\n        this.lineSpacingType = undefined;\n        this.paragraphFormat = undefined;\n        /**\n         * @private\n         */\n        this.keyUpParagraphSettings = function (event) {\n            if (event.keyCode === 13) {\n                _this.applyParagraphFormat();\n            }\n        };\n        this.changeBeforeSpacing = function (event) {\n            _this.beforeSpacing = event.value;\n        };\n        this.changeAfterSpacing = function (event) {\n            _this.afterSpacing = event.value;\n        };\n        this.changeLeftIndent = function (event) {\n            _this.leftIndent = event.value;\n        };\n        this.changeRightIndent = function (event) {\n            _this.rightIndent = event.value;\n        };\n        this.changeLineSpacingValue = function (event) {\n            _this.lineSpacingIn = event.value;\n        };\n        this.changeFirstLineIndent = function (event) {\n            _this.firstLineIndent = event.value;\n        };\n        this.changeByTextAlignment = function (args) {\n            _this.textAlignment = args.value;\n        };\n        /**\n         * @private\n         */\n        this.changeByValue = function (event) {\n            var paragraphFormat = _this.owner.selection.paragraphFormat;\n            switch (_this.special.index) {\n                case 0:\n                    if (paragraphFormat.firstLineIndent !== 0) {\n                        _this.byIn.value = 0;\n                    }\n                    break;\n                case 1:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        _this.byIn.value = 0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent < 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n                case 2:\n                    if (paragraphFormat.firstLineIndent === 0 || isNullOrUndefined(paragraphFormat.firstLineIndent)) {\n                        paragraphFormat.firstLineIndent = -0.1;\n                    }\n                    else if (paragraphFormat.firstLineIndent > 0) {\n                        _this.byIn.value = -(paragraphFormat.firstLineIndent);\n                    }\n                    break;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeBySpacing = function (event) {\n            if (isNullOrUndefined(_this.lineSpacing)) {\n                return;\n            }\n            switch (_this.lineSpacing.index) {\n                case 0:\n                    _this.lineSpacingType = 'AtLeast';\n                    _this.atIn.value = 12;\n                    break;\n                case 1:\n                    _this.lineSpacingType = 'Exactly';\n                    _this.atIn.value = 12;\n                    break;\n                case 2:\n                    _this.lineSpacingType = 'Multiple';\n                    _this.atIn.value = 1;\n                    break;\n            }\n        };\n        /* tslint:enable */\n        /**\n         * @private\n         */\n        this.loadParagraphDialog = function () {\n            var selectionFormat;\n            if (_this.paragraphFormat) {\n                selectionFormat = _this.paragraphFormat;\n            }\n            else {\n                selectionFormat = _this.owner.selection.paragraphFormat;\n            }\n            var alignValue = _this.alignment.index;\n            if (selectionFormat.textAlignment === 'Center') {\n                alignValue = 0;\n            }\n            else if (selectionFormat.textAlignment === 'Left') {\n                alignValue = 1;\n            }\n            else if (selectionFormat.textAlignment === 'Right') {\n                alignValue = 2;\n            }\n            else {\n                alignValue = 3;\n            }\n            _this.alignment.index = alignValue;\n            _this.beforeSpacingIn.value = selectionFormat.beforeSpacing;\n            _this.afterSpacingIn.value = selectionFormat.afterSpacing;\n            _this.leftIndentIn.value = selectionFormat.leftIndent;\n            _this.rightIndentIn.value = selectionFormat.rightIndent;\n            _this.byIn.value = selectionFormat.firstLineIndent;\n            var lineSpaceValue = _this.lineSpacing.index;\n            if (selectionFormat.lineSpacingType === 'AtLeast') {\n                lineSpaceValue = 0;\n            }\n            else if (selectionFormat.lineSpacingType === 'Exactly') {\n                lineSpaceValue = 1;\n            }\n            else {\n                lineSpaceValue = 2;\n            }\n            _this.lineSpacing.index = lineSpaceValue;\n            _this.atIn.value = selectionFormat.lineSpacing;\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyParagraphFormat = function () {\n            var paraFormat;\n            var isApply;\n            if (_this.paragraphFormat) {\n                paraFormat = _this.paragraphFormat;\n                isApply = false;\n            }\n            else {\n                paraFormat = new WParagraphFormat();\n                isApply = true;\n            }\n            if (!isNullOrUndefined(_this.beforeSpacing)) {\n                paraFormat.beforeSpacing = _this.beforeSpacing;\n            }\n            if (!isNullOrUndefined(_this.afterSpacing)) {\n                paraFormat.afterSpacing = _this.afterSpacing;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingType)) {\n                paraFormat.lineSpacingType = _this.lineSpacingType;\n            }\n            if (!isNullOrUndefined(_this.leftIndent)) {\n                paraFormat.leftIndent = _this.leftIndent;\n            }\n            if (!isNullOrUndefined(_this.rightIndent)) {\n                paraFormat.rightIndent = _this.rightIndent;\n            }\n            if (!isNullOrUndefined(_this.lineSpacingIn)) {\n                paraFormat.lineSpacing = _this.lineSpacingIn;\n            }\n            if (!isNullOrUndefined(_this.firstLineIndent)) {\n                paraFormat.firstLineIndent = _this.firstLineIndent;\n            }\n            if (!isNullOrUndefined(_this.textAlignment)) {\n                paraFormat.textAlignment = _this.textAlignment;\n            }\n            if (isApply) {\n                _this.onParagraphFormat(paraFormat);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateParagraphFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeParagraphDialog = function () {\n            _this.leftIndent = undefined;\n            _this.afterSpacing = undefined;\n            _this.beforeSpacing = undefined;\n            _this.firstLineIndent = undefined;\n            _this.textAlignment = undefined;\n            _this.rightIndent = undefined;\n            _this.lineSpacingIn = undefined;\n            _this.lineSpacingType = undefined;\n            _this.paragraphFormat = undefined;\n            _this.owner.dialog.hide();\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.getModuleName = function () {\n        return 'ParagraphDialog';\n    };\n    /*tslint:disable max-func-body-length*/\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.initParagraphDialog = function (locale) {\n        var instance = this;\n        var ownerId = this.owner.owner.containerId;\n        var id = ownerId + '_paragraph_dialog';\n        this.target = createElement('div', { id: id, className: 'e-de-para-dlg-container' });\n        // tslint:disable-next-line:max-line-length\n        var div = createElement('div', { id: 'property_div', styles: 'width:400px;' });\n        var generalDiv = createElement('div', { id: 'genral_div', styles: 'width:200px;height:85px;', className: 'e-de-para-dlg-sub-container' });\n        // tslint:disable-next-line:max-line-length\n        var genLabel = createElement('div', { id: ownerId + '_genLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('General') });\n        var alignLabel = createElement('div', { id: ownerId + '_AlignLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Alignment') });\n        var alignment = createElement('select', {\n            id: ownerId + '_Alignment',\n            innerHTML: '<option value=\"Center\">' + locale.getConstant('Center') +\n                '</option><option value=\"Left\">' + locale.getConstant('Left') +\n                '</option><option value=\"Right\">' + locale.getConstant('Right') +\n                '</option><option value=\"Justify\">' + locale.getConstant('Justify') + '</option>'\n        });\n        generalDiv.appendChild(genLabel);\n        generalDiv.appendChild(alignLabel);\n        generalDiv.appendChild(alignment);\n        // tslint:disable-next-line:max-line-length\n        var indentionDiv = createElement('div', { id: 'indention_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftIndentionDiv = createElement('div', { id: 'left_indention', styles: 'float:left;position:relative;' });\n        indentionDiv.appendChild(leftIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightIndentionDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        indentionDiv.appendChild(rightIndentionDiv);\n        // tslint:disable-next-line:max-line-length\n        var spacingDiv = createElement('div', { id: 'spacing_div', styles: 'width: 400px;height: 150px;', className: 'e-de-para-dlg-sub-container' });\n        var leftSpacingDiv = createElement('div', { id: 'left_spacing', styles: 'float:left;position:relative;' });\n        spacingDiv.appendChild(leftSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var rightSpacingDiv = createElement('div', { className: 'e-de-para-dlg-right-sub-container', styles: 'float:right;position:relative;' });\n        spacingDiv.appendChild(rightSpacingDiv);\n        // tslint:disable-next-line:max-line-length\n        var indentLabel = createElement('div', {\n            id: ownerId + '_indentLabel', className: 'e-de-para-dlg-heading', innerHTML: locale.getConstant('Indentation')\n        });\n        var beforeTextLabel = createElement('div', {\n            id: ownerId + '_bfTextLabel',\n            className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before text')\n        });\n        // tslint:disable-next-line:max-line-length\n        var leftIndent = createElement('input', { id: ownerId + '_leftIndent', attrs: { 'type': 'text' } });\n        var specialLabel = createElement('div', { id: ownerId + '_specialLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Special') });\n        var special = createElement('select', {\n            id: ownerId + '_special',\n            innerHTML: '<option value=\"None\">' + locale.getConstant('None') +\n                '</option><option value=\"First Line\">' + locale.getConstant('First line') +\n                '</option><option value=\"Hanging\">' + locale.getConstant('Hanging') + '</option> '\n        });\n        leftIndentionDiv.appendChild(indentLabel);\n        leftIndentionDiv.appendChild(beforeTextLabel);\n        leftIndentionDiv.appendChild(leftIndent);\n        leftIndentionDiv.appendChild(specialLabel);\n        leftIndentionDiv.appendChild(special);\n        // tslint:disable-next-line:max-line-length\n        var afterTextLabel = createElement('div', { id: ownerId + '_afTextLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('After text') });\n        var rightIndent = createElement('input', { id: ownerId + '_rightIndent', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var byLabel = createElement('label', { id: ownerId + '_byLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('By') });\n        var by = createElement('input', { id: ownerId + '_By', attrs: { 'type': 'text' } });\n        rightIndentionDiv.appendChild(afterTextLabel);\n        rightIndentionDiv.appendChild(rightIndent);\n        rightIndentionDiv.appendChild(byLabel);\n        rightIndentionDiv.appendChild(by);\n        // tslint:disable-next-line:max-line-length\n        var spaceLabel = createElement('div', { innerHTML: locale.getConstant('Spacing'), className: 'e-de-para-dlg-heading', id: ownerId + '_spaceLabel' });\n        var beforeLabel = createElement('div', { className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Before'), id: ownerId + '_beforeLabel' });\n        // tslint:disable-next-line:max-line-length\n        var beforeSpacing = createElement('input', { id: ownerId + '_beforeSpacing', attrs: { 'type': 'text' } });\n        var lineSpaceLabel = createElement('div', { id: ownerId + '_lineSpaceLabel', className: 'e-de-dlg-sub-header', innerHTML: locale.getConstant('Line Spacing') });\n        // tslint:disable-next-line:max-line-length\n        var lineSpacing = createElement('select', {\n            id: ownerId + '_lineSpacing', styles: 'width:180px;',\n            innerHTML: '<option value=\"At least\">' + locale.getConstant('At least') +\n                '</option><option value=\"Exactly\">' + locale.getConstant('Exactly') +\n                '</option><option value=\"Multiple\">' + locale.getConstant('Multiple') + '</option>'\n        });\n        leftSpacingDiv.appendChild(spaceLabel);\n        leftSpacingDiv.appendChild(beforeLabel);\n        leftSpacingDiv.appendChild(beforeSpacing);\n        leftSpacingDiv.appendChild(lineSpaceLabel);\n        leftSpacingDiv.appendChild(lineSpacing);\n        // tslint:disable-next-line:max-line-length\n        var afterLabel = createElement('div', { innerHTML: locale.getConstant('After'), className: 'e-de-dlg-sub-header', id: ownerId + '_afterLabel' });\n        var afterSpacing = createElement('input', { id: ownerId + '_afterSpacing', attrs: { 'type': 'text' } });\n        // tslint:disable-next-line:max-line-length\n        var atLabel = createElement('div', { innerHTML: locale.getConstant('At'), id: ownerId + '_atLabel', className: 'e-de-dlg-sub-header' });\n        var lineSpacingAt = createElement('input', { id: ownerId + '_lineSpacingAt', attrs: { 'type': 'text' } });\n        rightSpacingDiv.appendChild(afterLabel);\n        rightSpacingDiv.appendChild(afterSpacing);\n        rightSpacingDiv.appendChild(atLabel);\n        rightSpacingDiv.appendChild(lineSpacingAt);\n        div.appendChild(generalDiv);\n        div.appendChild(indentionDiv);\n        div.appendChild(spacingDiv);\n        this.target.appendChild(div);\n        this.leftIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeLeftIndent\n        });\n        this.leftIndentIn.appendTo(leftIndent);\n        this.rightIndentIn = new NumericTextBox({\n            format: 'n1', value: 0, min: -1584, max: 1584, width: 180, enablePersistence: false, change: this.changeRightIndent\n        });\n        this.rightIndentIn.appendTo(rightIndent);\n        this.byIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, enablePersistence: false, change: this.changeFirstLineIndent\n        });\n        this.byIn.appendTo(by);\n        this.beforeSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeBeforeSpacing\n        });\n        this.beforeSpacingIn.appendTo(beforeSpacing);\n        this.afterSpacingIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 0, max: 1584, width: 180, step: 6, enablePersistence: false,\n            change: this.changeAfterSpacing\n        });\n        this.afterSpacingIn.appendTo(afterSpacing);\n        this.atIn = new NumericTextBox({\n            format: 'n1', value: 0, min: 1, max: 1584, width: 180, step: 0.5, enablePersistence: false, change: this.changeLineSpacingValue\n        });\n        this.special = new DropDownList({ change: this.changeByValue, width: 180 });\n        this.special.appendTo(special);\n        this.lineSpacing = new DropDownList({ change: this.changeBySpacing, width: '180px' });\n        this.lineSpacing.appendTo(lineSpacing);\n        this.alignment = new DropDownList({ width: 180, change: this.changeByTextAlignment });\n        this.alignment.appendTo(alignment);\n        this.atIn.appendTo(lineSpacingAt);\n        this.target.addEventListener('keyup', instance.keyUpParagraphSettings);\n    };\n    /**\n     * Applies Paragraph Format\n     * @param  {WParagraphFormat} paragraphFormat\n     * @private\n     */\n    ParagraphDialog.prototype.onParagraphFormat = function (paragraphFormat) {\n        this.owner.owner.editorModule.initHistory('ParagraphFormat');\n        var selection = this.owner.selection;\n        this.owner.owner.isShiftingEnabled = true;\n        if (this.owner.selection.isEmpty) {\n            this.owner.owner.editorModule.applyParaFormatProperty(selection.start.paragraph, undefined, paragraphFormat, false);\n            this.owner.owner.editor.layoutItemBlock(selection.start.paragraph, false);\n        }\n        else {\n            this.owner.owner.editorModule.updateSelectionParagraphFormatting('ParagraphFormat', paragraphFormat, false);\n        }\n        this.owner.owner.editorModule.reLayout(selection);\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.show = function (paragraphFormat) {\n        if (paragraphFormat) {\n            this.paragraphFormat = paragraphFormat;\n        }\n        var local = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        local.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initParagraphDialog(local);\n        }\n        this.loadParagraphDialog();\n        this.owner.dialog.header = 'Paragraph';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyParagraphFormat,\n                buttonModel: { content: local.getConstant('Ok'), cssClass: 'e-flat e-para-okay', isPrimary: true }\n            },\n            {\n                click: this.closeParagraphDialog,\n                buttonModel: { content: local.getConstant('Cancel'), cssClass: 'e-flat e-para-cancel' }\n            }];\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    ParagraphDialog.prototype.destroy = function () {\n        if (this.afterSpacingIn) {\n            this.afterSpacingIn.destroy();\n            this.afterSpacingIn = undefined;\n        }\n        if (this.beforeSpacingIn) {\n            this.beforeSpacingIn.destroy();\n            this.beforeSpacingIn = undefined;\n        }\n        if (this.leftIndentIn) {\n            this.leftIndentIn.destroy();\n            this.leftIndentIn = undefined;\n        }\n        if (this.rightIndentIn) {\n            this.rightIndentIn.destroy();\n            this.rightIndentIn = undefined;\n        }\n        if (this.byIn) {\n            this.byIn.destroy();\n            this.byIn = undefined;\n        }\n        if (this.atIn) {\n            this.atIn.destroy();\n            this.atIn = undefined;\n        }\n        if (this.alignment) {\n            this.alignment.change = undefined;\n            this.alignment.destroy();\n        }\n        this.alignment = undefined;\n        if (this.lineSpacing) {\n            this.lineSpacing.change = undefined;\n            this.lineSpacing.destroy();\n        }\n        this.lineSpacing = undefined;\n        if (this.special) {\n            this.special.change = undefined;\n            this.special.destroy();\n        }\n        this.special = undefined;\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var q = 0; q < this.target.childNodes.length; q++) {\n                this.target.removeChild(this.target.childNodes[q]);\n                q--;\n            }\n            this.target = undefined;\n        }\n    };\n    return ParagraphDialog;\n}());\nexport { ParagraphDialog };\n","import { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n/**\n * List view model implementation\n * @private\n */\nvar ListViewModel = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListViewModel() {\n        this.listIn = undefined;\n        this.levelNumberIn = undefined;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.levelNumber = 0;\n    }\n    Object.defineProperty(ListViewModel.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.levelNumberIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.levelNumberIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.listIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (isNullOrUndefined(value)) {\n                this.createList();\n            }\n            else {\n                this.listIn = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.list) && this.levelNumber >= 0 && this.levelNumber < 9) {\n                if (!isNullOrUndefined(this.dialog.owner.getAbstractListById(this.list.abstractListId))) {\n                    if (this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length <= this.levelNumber) {\n                        this.addListLevels();\n                    }\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[this.levelNumber];\n                }\n                else {\n                    this.dialog.owner.lists.push(this.list);\n                    var abstractList = this.list.abstractList;\n                    if (!this.list.abstractList) {\n                        abstractList = new WAbstractList();\n                        abstractList.abstractListId = this.list.abstractListId;\n                    }\n                    var listLevelAdv = new WListLevel(abstractList);\n                    listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                    listLevelAdv.paragraphFormat.leftIndent = (1) * 48;\n                    listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                    listLevelAdv.numberFormat = '%' + (1).toString() + '.';\n                    listLevelAdv.listLevelPattern = 'UpRoman';\n                    listLevelAdv.followCharacter = 'Tab';\n                    listLevelAdv.startAt = 1;\n                    listLevelAdv.restartLevel = 1;\n                    this.dialog.owner.abstractLists.push(abstractList);\n                    return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[0];\n                    // return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.getItem(0);\n                }\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"listLevelPattern\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.listLevelPattern;\n            }\n            return 'Arabic';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.listLevelPattern = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListViewModel.prototype, \"followCharacter\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.listLevel)) {\n                return this.listLevel.followCharacter;\n            }\n            return 'None';\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            if (!isNullOrUndefined(this.listLevel)) {\n                this.listLevel.followCharacter = value;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    ListViewModel.prototype.createList = function () {\n        this.list = new WList();\n        this.list.listId = this.dialog.owner.lists.length + 1;\n        var abstractList = new WAbstractList();\n        abstractList.abstractListId = this.dialog.owner.abstractLists.length + 1;\n        this.list.abstractListId = abstractList.abstractListId;\n        this.dialog.owner.lists.push(this.list);\n        var listLevel = new WListLevel(abstractList);\n        listLevel.paragraphFormat = new WParagraphFormat(listLevel);\n        listLevel.paragraphFormat.leftIndent = 48;\n        listLevel.paragraphFormat.firstLineIndent = -24;\n        listLevel.characterFormat = new WCharacterFormat(listLevel);\n        listLevel.numberFormat = '%1.';\n        listLevel.startAt = 1;\n        abstractList.levels.push(listLevel);\n        this.dialog.owner.abstractLists.push(abstractList);\n    };\n    ListViewModel.prototype.addListLevels = function () {\n        if (!isNullOrUndefined(this.list) && !isNullOrUndefined(this.list.abstractListId)) {\n            for (var i = this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length; i < 9; i++) {\n                var listLevelAdv = new WListLevel(this.dialog.owner.getAbstractListById(this.list.abstractListId));\n                listLevelAdv.characterFormat = new WCharacterFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat = new WParagraphFormat(listLevelAdv);\n                listLevelAdv.paragraphFormat.leftIndent = (i + 1) * 48;\n                listLevelAdv.paragraphFormat.firstLineIndent = -24;\n                listLevelAdv.numberFormat = '%' + (i + 1).toString() + '.';\n                listLevelAdv.listLevelPattern = 'Arabic';\n                listLevelAdv.followCharacter = 'Tab';\n                listLevelAdv.startAt = 1;\n                listLevelAdv.restartLevel = i;\n                (this.dialog.owner).getAbstractListById(this.list.abstractListId).levels.push(listLevelAdv);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    ListViewModel.prototype.destroy = function () {\n        this.list = undefined;\n        this.followCharacter = undefined;\n        this.levelNumber = undefined;\n        this.listLevelPattern = undefined;\n    };\n    return ListViewModel;\n}());\nexport { ListViewModel };\n","import { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { isNullOrUndefined } from '@syncfusion/ej2-base';\n// tslint:disable-next-line:max-line-length\nimport { WCharacterFormat, WParagraphFormat } from '../format/index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WLevelOverride } from '../list/level-override';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tooltip } from '@syncfusion/ej2-popups';\nimport { ListViewModel } from './list-view-model';\n/**\n * The List dialog is used to create or modify lists.\n */\n/* tslint:disable:no-any */\nvar ListDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function ListDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.dialog = undefined;\n        this.target = undefined;\n        /**\n         * @private\n         */\n        this.owner = undefined;\n        this.viewModel = undefined;\n        this.startAt = undefined;\n        this.textIndent = undefined;\n        this.alignedAt = undefined;\n        this.listLevelElement = undefined;\n        this.followNumberWith = undefined;\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        this.restartBy = undefined;\n        /**\n         * @private\n         */\n        this.isListCharacterFormat = false;\n        this.onTextIndentChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.leftIndent = args.value;\n        };\n        this.onStartValueChanged = function (args) {\n            _this.viewModel.listLevel.startAt = args.value;\n        };\n        this.onListLevelValueChanged = function (args) {\n            _this.viewModel.levelNumber = parseInt(args.value.slice(args.value.length - 1), 10) - 1;\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (!isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            _this.updateRestartLevelBox();\n        };\n        this.onNumberFormatChanged = function (args) {\n            _this.viewModel.listLevel.numberFormat = args.target.value;\n        };\n        this.onAlignedAtValueChanged = function (args) {\n            _this.viewModel.listLevel.paragraphFormat.firstLineIndent = args.value;\n        };\n        this.onFollowCharacterValueChanged = function (args) {\n            if (args.value) {\n                _this.viewModel.followCharacter = args.value;\n            }\n        };\n        this.onLevelPatternValueChanged = function (args) {\n            _this.viewModel.listLevelPattern = args.value;\n            var numberFormat = '%' + (_this.levelNumber + 1).toString();\n            // tslint:disable-next-line:max-line-length\n            var numberFormatTextBox = document.getElementById(_this.owner.owner.containerId + '_numberFormat');\n            if (_this.listLevel.listLevelPattern === 'Bullet') {\n                _this.listLevel.numberFormat = '\\uf0b7';\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n                _this.listLevel.characterFormat.fontFamily = 'Wingdings';\n            }\n            else {\n                if (_this.listLevel.listLevelPattern === 'None') {\n                    _this.listLevel.numberFormat = '';\n                }\n                if (!_this.listLevel.numberFormat.match(numberFormat) && _this.listLevel.listLevelPattern !== 'None') {\n                    _this.listLevel.numberFormat = numberFormat + '.';\n                }\n                numberFormatTextBox.value = _this.listLevel.numberFormat;\n            }\n        };\n        this.loadListDialog = function () {\n            _this.owner.updateFocus();\n            if (isNullOrUndefined(_this.owner.owner)) {\n                return;\n            }\n            _this.viewModel = new ListViewModel();\n            _this.viewModel.dialog = _this;\n            if (_this.owner.selection.paragraphFormat.listLevelNumber > 0) {\n                _this.viewModel.levelNumber = _this.owner.selection.paragraphFormat.listLevelNumber;\n            }\n            _this.viewModel.list = _this.owner.selection.paragraphFormat.getList();\n            if (isNullOrUndefined(_this.listLevel)) {\n                return;\n            }\n            if (isNullOrUndefined(_this.listLevel.characterFormat)) {\n                _this.listLevel.characterFormat = new WCharacterFormat(_this.viewModel.listLevel);\n            }\n            if (isNullOrUndefined(_this.listLevel.paragraphFormat)) {\n                _this.listLevel.paragraphFormat = new WParagraphFormat(_this.viewModel.listLevel);\n            }\n            _this.updateDialogValues();\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        this.showFontDialog = function () {\n            _this.owner.owner.fontDialogModule.showFontDialog(_this.listLevel.characterFormat);\n        };\n        this.onApplyList = function () {\n            if (!isNullOrUndefined(_this.owner)) {\n                _this.owner.selection.paragraphFormat.setList(_this.list);\n            }\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        this.onCancelButtonClick = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.closeListDialog = function () {\n            _this.disposeBindingForListUI();\n            _this.owner.updateFocus();\n            _this.isListCharacterFormat = false;\n        };\n        this.owner = viewer;\n        this.viewModel = new ListViewModel();\n    }\n    Object.defineProperty(ListDialog.prototype, \"listLevel\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.listLevel;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"list\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (!isNullOrUndefined(this.viewModel)) {\n                return this.viewModel.list;\n            }\n            return undefined;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(ListDialog.prototype, \"levelNumber\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (this.listLevel.ownerBase instanceof WLevelOverride) {\n                return this.listLevel.ownerBase.levelNumber;\n                // tslint:disable-next-line:max-line-length\n            }\n            else if (this.listLevel.ownerBase instanceof WAbstractList && !isNullOrUndefined(this.listLevel.ownerBase.levels)) {\n                return this.listLevel.ownerBase.levels.indexOf(this.listLevel);\n            }\n            else {\n                return -1;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    ListDialog.prototype.getModuleName = function () {\n        return 'ListDialog';\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.showListDialog = function () {\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initListDialog(locale);\n        }\n        this.isListCharacterFormat = true;\n        this.owner.dialog2.header = locale.getConstant('Define new Multilevel list');\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.buttons = [{\n                click: this.showFontDialog,\n                buttonModel: { content: locale.getConstant('Font'), cssClass: 'e-flat e-list-dlg-font e-font' }\n            }, {\n                click: this.onApplyList,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-list-dlg', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-list-dlg' }\n            }];\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.beforeOpen = this.loadListDialog;\n        this.owner.dialog2.close = this.closeListDialog;\n        this.owner.dialog2.position = { X: 'center', Y: 'top' };\n        this.owner.dialog2.show();\n    };\n    /**\n     * Shows the table properties dialog\n     * @private\n     */\n    ListDialog.prototype.initListDialog = function (locale) {\n        var instance = this;\n        var containerId = this.owner.owner.containerId;\n        var id = containerId + '_insert_list';\n        this.target = createElement('div', { id: id, className: 'e-de-list-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        // tslint:disable-next-line:max-line-length\n        var listLevelDiv = createElement('div', { innerHTML: '<label id=\"' + containerId + '_listLevellabel\" style=\"display:block;\" class=e-de-list-ddl-header-list-level>' + locale.getConstant('List level') + '</label><label id=\"' + containerId + '_modifyLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Choose level to modify') + '</label><select style=\"height:20px;width:43%\" id=\"' + containerId + '_listLevel\"><option>' + locale.getConstant('Level') + ' 1' + '</option><option>' + locale.getConstant('Level') + ' 2' + '</option><option>' + locale.getConstant('Level') + ' 3' + '</option><option>' + locale.getConstant('Level') + ' 4' + '</option><option>' + locale.getConstant('Level') + ' 5' + '</option><option>' + locale.getConstant('Level') + ' 6' + '</option><option>' + locale.getConstant('Level') + ' 7' + '</option><option>' + locale.getConstant('Level') + ' 8' + '</option><option>' + locale.getConstant('Level') + ' 9' + '</option></select>' });\n        this.target.appendChild(listLevelDiv);\n        var div = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var numberStyleDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_numberFormatLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Number format') + '</label><label id=\"' + containerId + '_numberStyleLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Number style for this level') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_numberStyle\"><option>' + locale.getConstant('Arabic') + '</option><option>' + locale.getConstant('UpRoman') + '</option><option>' + locale.getConstant('LowRoman') + '</option><option>' + locale.getConstant('UpLetter') + '</option><option>' + locale.getConstant('LowLetter') + '</option><option>' + locale.getConstant('Number') + '</option><option>' + locale.getConstant('Leading zero') + '</option><option>' + locale.getConstant('Bullet') + '</option><option>' + locale.getConstant('Ordinal') + '</option><option>' + locale.getConstant('Ordinal Text') + '</option><option>' + locale.getConstant('Special') + '</option><option>' + locale.getConstant('For East') + '</option></select><label id=\"' + containerId + '_startAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Start at') + '</label><input type=\"text\" id=\"' + containerId + '_startAt\">' });\n        div.appendChild(numberStyleDiv);\n        // tslint:disable-next-line:max-line-length\n        var numberFormatDiv = createElement('div', { className: 'e-de-list-dlg-subdiv', innerHTML: '<div><div><label id=\"' + containerId + '_formatLabel\" style=\"display:inline-block;width:86%\" class=e-de-list-ddl-subheader>' + locale.getConstant('Enter formatting for number') + '</label><button id=\"' + containerId + '_list_info\" class=\"e-control e-btn e-primary e-de-list-format-info\">i</button></div><input style=width:180px; type=\"text\" id=\"' + containerId + '_numberFormat\" class=e-input></div><label id=\"' + containerId + '_restartLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Restart list after') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_restartBy\"><option>' + locale.getConstant('No Restart') + '</option></select></div>' });\n        div.appendChild(numberFormatDiv);\n        this.target.appendChild(div);\n        // tslint:disable-next-line:max-line-length\n        var indentsDiv = createElement('div', { innerHTML: '<div style=\"float:left;display:block;\"><label id=\"' + containerId + '_IndentsLabel\" style=\"display:block;\" class=e-de-list-ddl-header>' + locale.getConstant('Position') + '</label><label id=\"' + containerId + '_textIndentLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Text indent at') + '</label><input type=\"text\" id=\"' + containerId + '_textIndent\"><label id=\"' + containerId + '_followCharacterLabel\" style=\"display:block;\" class=e-de-list-ddl-subheaderbottom>' + locale.getConstant('Follow number with') + '</label><select style=\"height:20px;width:100%\" id=\"' + containerId + '_followCharacter\"><option>' + locale.getConstant('Tab character') + '</option><option>' + locale.getConstant('Space') + '</option><option>' + locale.getConstant('Nothing') + '</option></select></div><div class=\"e-de-list-dlg-div\"><label id=\"' + containerId + '_alignedAtLabel\" style=\"display:block;\" class=e-de-list-ddl-subheader>' + locale.getConstant('Aligned at') + '</label><input type=\"text\" id=\"' + containerId + '_alignedAt\"></div>', });\n        this.target.appendChild(indentsDiv);\n        var startAtTextBox = document.getElementById(containerId + '_startAt');\n        var textIndentAtTextBox = document.getElementById(containerId + '_textIndent');\n        var alignedAtTextBox = document.getElementById(containerId + '_alignedAt');\n        this.startAt = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 50,\n            width: '180px',\n            enablePersistence: false,\n        });\n        this.startAt.addEventListener('change', instance.onStartValueChanged);\n        this.startAt.appendTo(startAtTextBox);\n        this.textIndent = new NumericTextBox({\n            format: '#',\n            decimals: 0,\n            min: 0,\n            max: 1584,\n            width: '180px',\n            step: 4,\n            enablePersistence: false\n        });\n        this.textIndent.addEventListener('change', instance.onTextIndentChanged);\n        this.textIndent.appendTo(textIndentAtTextBox);\n        this.alignedAt = new NumericTextBox({\n            format: '#',\n            max: 1584,\n            step: 6,\n            width: '180px',\n            enablePersistence: false\n        });\n        this.alignedAt.addEventListener('change', instance.onAlignedAtValueChanged);\n        this.alignedAt.appendTo(alignedAtTextBox);\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        this.listLevelElement = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onListLevelValueChanged });\n        this.listLevelElement.appendTo(listLevel);\n        var followCharacterElement = document.getElementById(containerId + '_followCharacter');\n        this.followNumberWith = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onFollowCharacterValueChanged });\n        this.followNumberWith.appendTo(followCharacterElement);\n        var numberStyleEle = document.getElementById(containerId + '_numberStyle');\n        this.numberStyle = new DropDownList({ popupHeight: '150px', width: '180px', change: instance.onLevelPatternValueChanged });\n        this.numberStyle.appendTo(numberStyleEle);\n        this.numberFormat = document.getElementById(containerId + '_numberFormat');\n        this.numberFormat.addEventListener('change', instance.onNumberFormatChanged);\n        var restartElement = document.getElementById(containerId + '_restartBy');\n        this.restartBy = new DropDownList({ popupHeight: '150px', width: '180px' });\n        this.restartBy.appendTo(restartElement);\n        var button = document.getElementById(containerId + '_list_info');\n        this.formatInfoToolTip = new Tooltip({ width: 200 });\n        // tslint:disable-next-line:max-line-length\n        this.formatInfoToolTip.content = locale.getConstant('Number format tooltip information');\n        this.formatInfoToolTip.position = 'RightTop';\n        this.formatInfoToolTip.appendTo(button);\n    };\n    ListDialog.prototype.updateRestartLevelBox = function () {\n        var containerId = this.owner.owner.containerId;\n        var listLevel = document.getElementById(containerId + '_listLevel');\n        var restartBy = document.getElementById(containerId + '_restartBy');\n        for (var i = 0; i < restartBy.options.length; i) {\n            restartBy.options.remove(i);\n        }\n        if (listLevel.selectedIndex === 0) {\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        else {\n            for (var i = listLevel.selectedIndex; i > 0; i--) {\n                var option_1 = document.createElement('option');\n                option_1.value = 'Level ' + i;\n                option_1.innerHTML = 'Level ' + i;\n                restartBy.appendChild(option_1);\n            }\n            var option = document.createElement('option');\n            option.value = 'No Restart';\n            option.innerHTML = 'No Restart';\n            restartBy.appendChild(option);\n        }\n        restartBy.selectedIndex = 0;\n    };\n    ListDialog.prototype.listPatternConverter = function (listLevelPattern) {\n        switch (listLevelPattern) {\n            case 'Arabic': return 0;\n            case 'UpRoman': return 1;\n            case 'LowRoman': return 2;\n            case 'UpLetter': return 3;\n            case 'LowLetter': return 4;\n            case 'Number': return 5;\n            case 'LeadingZero': return 6;\n            case 'Bullet': return 7;\n            case 'Ordinal': return 8;\n            case 'OrdinalText': return 9;\n            case 'Special': return 10;\n            case 'FarEast': return 11;\n            default: return 12;\n        }\n    };\n    ListDialog.prototype.followCharacterConverter = function (followCharacter) {\n        switch (followCharacter) {\n            case 'Tab':\n                return 0;\n            case 'Space':\n                return 1;\n            default:\n                return 2;\n        }\n    };\n    ListDialog.prototype.updateDialogValues = function () {\n        // tslint:disable-next-line:max-line-length\n        var restartByTextBox = document.getElementById(this.owner.owner.containerId + '_restartBy');\n        this.startAt.value = this.viewModel.listLevel.startAt;\n        this.textIndent.value = this.viewModel.listLevel.paragraphFormat.leftIndent;\n        this.alignedAt.value = this.viewModel.listLevel.paragraphFormat.firstLineIndent;\n        this.followNumberWith.index = this.followCharacterConverter(this.viewModel.followCharacter);\n        this.numberFormat.value = this.viewModel.listLevel.numberFormat;\n        this.numberStyle.index = this.listPatternConverter(this.viewModel.listLevelPattern);\n        this.listLevelElement.index = this.viewModel.levelNumber;\n        this.viewModel.levelNumber = this.viewModel.levelNumber;\n    };\n    ListDialog.prototype.disposeBindingForListUI = function () {\n        this.followNumberWith.index = -1;\n        this.numberFormat.value = ' ';\n        this.numberStyle.index = -1;\n        this.listLevelElement.index = -1;\n        this.restartBy.index = -1;\n        this.viewModel.destroy();\n    };\n    /**\n     * @private\n     */\n    ListDialog.prototype.destroy = function () {\n        if (this.alignedAt) {\n            this.alignedAt.destroy();\n        }\n        this.alignedAt = undefined;\n        this.dialog = undefined;\n        if (this.followNumberWith) {\n            this.followNumberWith.destroy();\n        }\n        this.followNumberWith = undefined;\n        if (this.listLevelElement) {\n            this.listLevelElement.destroy();\n        }\n        this.listLevelElement = undefined;\n        if (this.textIndent) {\n            this.textIndent.destroy();\n        }\n        this.textIndent = undefined;\n        if (this.startAt) {\n            this.startAt.destroy();\n        }\n        this.startAt = undefined;\n        if (this.numberStyle) {\n            this.numberStyle.destroy();\n        }\n        this.numberStyle = undefined;\n        this.numberFormat = undefined;\n        if (this.restartBy) {\n            this.restartBy.destroy();\n        }\n        this.restartBy = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var l = 0; l < this.target.childNodes.length; l++) {\n                this.target.removeChild(this.target.childNodes[l]);\n                l--;\n            }\n            this.target = undefined;\n        }\n        this.owner = undefined;\n        this.viewModel = undefined;\n    };\n    return ListDialog;\n}());\nexport { ListDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { WCharacterStyle, WParagraphStyle } from '../../implementation/format/style';\nimport { BulletsAndNumberingDialog } from './index';\nimport { WAbstractList } from '../list/abstract-list';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\n/**\n * The Style dialog is used to create or modify styles.\n */\nvar StyleDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StyleDialog(viewer) {\n        var _this = this;\n        this.target = undefined;\n        this.styleType = undefined;\n        this.styleBasedOn = undefined;\n        this.styleParagraph = undefined;\n        this.onlyThisDocument = undefined;\n        this.template = undefined;\n        this.fontFamily = undefined;\n        this.fontSize = undefined;\n        this.characterFormat = undefined;\n        this.paragraphFormat = undefined;\n        /* tslint:disable-next-line:no-any */\n        this.openDialog = function (args) {\n            switch (args.item.id) {\n                case 'style_font':\n                    _this.showFontDialog();\n                    break;\n                case 'style_paragraph':\n                    _this.showParagraphDialog();\n                    break;\n                case 'style_numbering':\n                    _this.showNumberingBulletDialog();\n                    break;\n            }\n        };\n        this.setBoldProperty = function () {\n            _this.characterFormat.bold = !_this.characterFormat.bold;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setItalicProperty = function () {\n            _this.characterFormat.italic = !_this.characterFormat.italic;\n            _this.fontButtonClicked(undefined);\n        };\n        this.setUnderlineProperty = function () {\n            _this.characterFormat.underline = _this.characterFormat.underline === 'None' ? 'Single' : 'None';\n            _this.fontButtonClicked(undefined);\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontButtonClicked = function (args) {\n            if (_this.characterFormat.bold) {\n                if (!_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.bold.classList.contains('e-active')) {\n                    _this.bold.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.italic) {\n                if (!_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.add('e-active');\n                }\n            }\n            else {\n                if (_this.italic.classList.contains('e-active')) {\n                    _this.italic.classList.remove('e-active');\n                }\n            }\n            if (_this.characterFormat.underline !== undefined && _this.characterFormat.underline !== 'None') {\n                if (!_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.add('e-active');\n                    _this.characterFormat.underline = 'Single';\n                }\n            }\n            else {\n                if (_this.underline.classList.contains('e-active')) {\n                    _this.underline.classList.remove('e-active');\n                    _this.characterFormat.underline = 'None';\n                }\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontSizeUpdate = function (args) {\n            _this.characterFormat.fontSize = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontFamilyChanged = function (args) {\n            _this.characterFormat.fontFamily = args.value;\n        };\n        /* tslint:disable-next-line:no-any */\n        this.fontColorUpdate = function (args) {\n            _this.characterFormat.fontColor = args.currentValue.rgba;\n        };\n        this.setLeftAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Left') {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setRightAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Right') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Right';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setCenterAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Center') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Center';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.setJustifyAlignment = function () {\n            if (_this.paragraphFormat.textAlignment === 'Justify') {\n                _this.paragraphFormat.textAlignment = 'Left';\n            }\n            else {\n                _this.paragraphFormat.textAlignment = 'Justify';\n            }\n            _this.updateParagraphFormat();\n        };\n        this.increaseBeforeAfterSpacing = function () {\n            _this.paragraphFormat.beforeSpacing += 6;\n            _this.paragraphFormat.afterSpacing += 6;\n        };\n        this.decreaseBeforeAfterSpacing = function () {\n            if (_this.paragraphFormat.beforeSpacing >= 6) {\n                _this.paragraphFormat.beforeSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.beforeSpacing = 0;\n            }\n            if (_this.paragraphFormat.afterSpacing >= 6) {\n                _this.paragraphFormat.afterSpacing -= 6;\n            }\n            else {\n                _this.paragraphFormat.afterSpacing = 0;\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateNextStyle = function (args) {\n            var typedName = args.srcElement.value;\n            if (_this.getTypeValue() === 'Paragraph' && !isNullOrUndefined(typedName) && typedName !== '' && !_this.isUserNextParaUpdated) {\n                var styles = _this.owner.owner.viewer.styles.getStyleNames(_this.getTypeValue());\n                if (_this.isEdit) {\n                    styles = styles.filter(function (e) { return e !== _this.editStyleName; });\n                }\n                styles.push(typedName);\n                _this.styleParagraph.dataSource = styles;\n                _this.styleParagraph.index = null;\n                _this.styleParagraph.index = styles.indexOf(typedName);\n                _this.styleParagraph.dataBind();\n            }\n        };\n        /**\n         * @private\n         */\n        this.updateOkButton = function () {\n            var styleName = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0).value;\n            _this.enableOrDisableOkButton();\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleTypeChange = function (args) {\n            if (args.isInteracted) {\n                var type = void 0;\n                if (args.value === 'Character') {\n                    _this.style = new WCharacterStyle();\n                    type = 'Character';\n                }\n                if (args.value === 'Paragraph' || args.value === 'Linked(Paragraph and Character)') {\n                    _this.style = new WParagraphStyle();\n                    type = 'Paragraph';\n                }\n                _this.toggleDisable();\n                _this.updateStyleNames(type);\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.styleBasedOnChange = function (args) {\n            //Based on change\n        };\n        /**\n         * @private\n         */\n        /* tslint:disable-next-line:no-any */\n        this.styleParagraphChange = function (args) {\n            if (args.isInteracted) {\n                _this.isUserNextParaUpdated = true;\n            }\n            //Next change\n        };\n        /**\n         * @private\n         */\n        this.showFontDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.fontDialogModule)) {\n                _this.owner.owner.showFontDialog(_this.characterFormat);\n            }\n            _this.updateCharacterFormat();\n        };\n        /**\n         * @private\n         */\n        this.showParagraphDialog = function () {\n            if (!isNullOrUndefined(_this.owner.owner.paragraphDialogModule)) {\n                _this.owner.owner.showParagraphDialog(_this.paragraphFormat);\n            }\n        };\n        /**\n         * @private\n         */\n        this.showNumberingBulletDialog = function () {\n            _this.numberingBulletDialog = new BulletsAndNumberingDialog(_this.owner.owner.viewer);\n            if (_this.style instanceof WParagraphStyle && (!isNullOrUndefined(_this.style.paragraphFormat))) {\n                // tslint:disable-next-line:max-line-length\n                _this.numberingBulletDialog.showNumberBulletDialog(_this.style.paragraphFormat.listFormat, _this.abstractList);\n            }\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            var styleName = _this.styleNameElement.value;\n            if (styleName.length > 0) {\n                var style = _this.owner.owner.viewer.styles.findByName(styleName);\n                var name_1;\n                if (!isNullOrUndefined(style)) {\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        _this.style.characterFormat.mergeFormat(style.characterFormat);\n                        _this.style.paragraphFormat.mergeFormat(style.paragraphFormat);\n                        _this.updateList();\n                        // tslint:disable-next-line:max-line-length\n                        _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName, _this.isEdit) : undefined;\n                    }\n                    //Updating existing style implementation\n                    _this.style.name = style.name;\n                    name_1 = style.name;\n                    style = _this.style;\n                    _this.owner.owner.isShiftingEnabled = true;\n                    _this.owner.owner.editorModule.layoutWholeDocument();\n                    _this.owner.owner.isShiftingEnabled = false;\n                }\n                else {\n                    /* tslint:disable-next-line:no-any */\n                    var basedOn = _this.owner.owner.viewer.styles.findByName(_this.styleBasedOn.value);\n                    if (_this.styleType.value === 'Paragraph' || _this.styleType.value === 'Linked(Paragraph and Character)') {\n                        if (styleName === _this.styleParagraph.value) {\n                            _this.style.next = _this.style;\n                        }\n                        else {\n                            _this.style.next = _this.owner.owner.viewer.styles.findByName(_this.styleParagraph.value);\n                        }\n                        _this.updateList();\n                    }\n                    // tslint:disable-next-line:max-line-length\n                    _this.style.link = (_this.styleType.value === 'Linked(Paragraph and Character)') ? _this.createLinkStyle(styleName) : undefined;\n                    _this.style.type = _this.getTypeValue();\n                    _this.style.name = styleName;\n                    _this.style.basedOn = basedOn;\n                    /* tslint:disable-next-line:no-any */\n                    _this.owner.owner.viewer.styles.push(_this.style);\n                    name_1 = styleName;\n                    _this.owner.owner.editorModule.applyStyle(name_1);\n                }\n                _this.owner.owner.viewer.dialog2.hide();\n            }\n            else {\n                throw new Error('Enter valid Style name');\n            }\n            if (_this.style) {\n                //this.style.destroy();\n            }\n        };\n        /* tslint:disable-next-line:no-any */\n        this.loadStyleDialog = function (args) {\n            _this.owner.owner.viewer.updateFocus();\n            _this.isUserNextParaUpdated = false;\n            /*Â tslint:disable-next-line:max-line-length */\n            _this.styleNameElement = _this.target.getElementsByClassName('e-input e-de-style-dlg-name-input').item(0);\n            _this.styleNameElement.value = null;\n            if (!_this.isEdit) {\n                _this.styleType.index = 0; //Set to paragraph            \n            }\n            var name;\n            if (_this.isEdit) {\n                _this.styleNameElement.value = _this.editStyleName;\n                name = _this.editStyleName;\n            }\n            /*Â tslint:disable-next-line:max-line-length */\n            _this.okButton = _this.owner.dialog2.element.getElementsByClassName('e-flat e-style-okay').item(0);\n            _this.enableOrDisableOkButton();\n            _this.updateStyleNames(_this.getTypeValue(), name);\n            _this.updateCharacterFormat(_this.style.characterFormat);\n            _this.updateParagraphFormat(_this.style.paragraphFormat);\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            if (!_this.isEdit && _this.style) {\n                _this.style.destroy();\n            }\n            _this.owner.owner.viewer.dialog2.hide();\n        };\n        /**\n         * @private\n         */\n        this.closeStyleDialog = function () {\n            _this.owner.owner.viewer.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StyleDialog.prototype.getModuleName = function () {\n        return 'StyleDialog';\n    };\n    /**\n     * @private\n     */\n    //tslint:disable: max-func-body-length\n    StyleDialog.prototype.initStyleDialog = function (localValue) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_style';\n        this.target = createElement('div', { id: id, className: 'e-de-style-dialog' });\n        var container = createElement('div');\n        // tslint:disable-next-line:max-line-length\n        var properties = createElement('div', { className: 'e-de-style-properties', innerHTML: localValue.getConstant('Properties') });\n        container.appendChild(properties);\n        var styleNameTypeDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-nametype-div' });\n        container.appendChild(styleNameTypeDiv);\n        var nameWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleNameTypeDiv.appendChild(nameWholeDiv);\n        var name = createElement('div', { className: 'e-de-style-name', innerHTML: localValue.getConstant('Name') + ':' });\n        nameWholeDiv.appendChild(name);\n        // tslint:disable-next-line:max-line-length\n        var nameValue = createElement('input', { id: this.owner.owner.containerId + '_style_name', styles: 'width:210px;', className: 'e-input e-de-style-dlg-name-input' });\n        nameValue.addEventListener('keyup', this.updateOkButton);\n        nameValue.addEventListener('input', this.updateOkButton);\n        nameValue.addEventListener('blur', this.updateNextStyle);\n        nameWholeDiv.appendChild(nameValue);\n        var styleTypeWholeDiv = createElement('div');\n        styleNameTypeDiv.appendChild(styleTypeWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleType = createElement('div', { className: 'e-de-style-styletype', innerHTML: localValue.getConstant('Style type') + ':' });\n        styleTypeWholeDiv.appendChild(styleType);\n        var styleTypeDivElement = createElement('div', { className: 'e-de-style-style-type-div' });\n        var styleTypeValue = createElement('select', { id: 'e-de-style-style-type' });\n        // tslint:disable-next-line:max-line-length\n        styleTypeValue.innerHTML = '<option>Paragraph</option><option>Character</option><option>Linked(Paragraph and Character)</option>'; //<option>Linked(Paragraph and Character)</option><option>Table</option><option>List</option>';\n        styleTypeDivElement.appendChild(styleTypeValue);\n        this.styleType = new DropDownList({ change: this.styleTypeChange, popupHeight: '253px', width: '210px' });\n        this.styleType.appendTo(styleTypeValue);\n        styleTypeWholeDiv.appendChild(styleTypeDivElement);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedParaDiv = createElement('div', { styles: 'display:flex', className: 'e-de-style-based-para-div' });\n        container.appendChild(styleBasedParaDiv);\n        var styleBasedOnWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleBasedOnWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOn = createElement('div', { className: 'e-de-style-style-based-on', innerHTML: localValue.getConstant('Style based on') + ':' });\n        styleBasedOnWholeDiv.appendChild(styleBasedOn);\n        var styleBasedOnDivElement = createElement('div', { className: 'e-de-style-style-based-on-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleBasedOnValue = createElement('input', { id: 'e-de-style-style-based-on-value' });\n        //styleBasedOnValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleBasedOnDivElement.appendChild(styleBasedOnValue);\n        this.styleBasedOn = new DropDownList({ dataSource: [], select: this.styleBasedOnChange, popupHeight: '253px', width: '210px' });\n        this.styleBasedOn.appendTo(styleBasedOnValue);\n        styleBasedOnWholeDiv.appendChild(styleBasedOnDivElement);\n        var styleParagraphWholeDiv = createElement('div', { className: 'e-de-style-left-div' });\n        styleBasedParaDiv.appendChild(styleParagraphWholeDiv);\n        // tslint:disable-next-line:max-line-length\n        var styleParagraph = createElement('div', { className: 'e-de-style-style-paragraph', innerHTML: localValue.getConstant('Style for following paragraph') + ':' });\n        styleParagraphWholeDiv.appendChild(styleParagraph);\n        var styleParagraphDivElement = createElement('div', { className: 'e-de-style-style-paragraph-div' });\n        // tslint:disable-next-line:max-line-length\n        var styleParagraphValue = createElement('input', { id: 'e-de-style-style-paragraph-value' });\n        // tslint:disable-next-line:max-line-length\n        //styleParagraphValue.innerHTML = '<option>Normal</option><option>Heading 1</option><option>Heading 2</option><option>Heading 3</option><option>Heading 4</option><option>Heading 5</option><option>Heading 6</option>';\n        styleParagraphDivElement.appendChild(styleParagraphValue);\n        this.styleParagraph = new DropDownList({ dataSource: [], select: this.styleParagraphChange, popupHeight: '253px', width: '210px' });\n        this.styleParagraph.appendTo(styleParagraphValue);\n        styleParagraphWholeDiv.appendChild(styleParagraphDivElement);\n        // tslint:disable-next-line:max-line-length\n        var formatting = createElement('div', { className: 'e-de-style-formatting', innerHTML: localValue.getConstant('Formatting') });\n        container.appendChild(formatting);\n        var optionsDiv = createElement('div', { className: 'e-de-style-options-div' });\n        container.appendChild(optionsDiv);\n        var fontOptionsDiv = createElement('div', { styles: 'display:flex;margin-bottom: 15px;' });\n        optionsDiv.appendChild(fontOptionsDiv);\n        this.createFontOptions(fontOptionsDiv);\n        var paragraphOptionsDiv = createElement('div', { styles: 'display:flex', className: 'e-style-paragraph' });\n        optionsDiv.appendChild(paragraphOptionsDiv);\n        this.createParagraphOptions(paragraphOptionsDiv);\n        // let radioOptionsDiv: HTMLElement = createElement('div', { styles: 'display:flex' });\n        // container.appendChild(radioOptionsDiv);\n        // let onlyThisDocumentDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let onlyThisDocument: HTMLInputElement = createElement('input', { className: 'e-de-style-only-this-doc', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // onlyThisDocumentDiv.appendChild(onlyThisDocument);\n        // tslint:disable-next-line:max-line-length\n        // this.onlyThisDocument = new RadioButton({ label: 'Only in this document', value: 'only in this document', checked: true, name: 'styles' });\n        // this.onlyThisDocument.appendTo(onlyThisDocument);\n        // radioOptionsDiv.appendChild(onlyThisDocumentDiv);\n        // let templateDiv: HTMLElement = createElement('div', { className: 'e-de-style-radio-button' });\n        // tslint:disable-next-line:max-line-length\n        // let template: HTMLInputElement = createElement('input', { className: 'e-de-style-temp', attrs: { type: 'radio' } }) as HTMLInputElement;\n        // templateDiv.appendChild(template);\n        // this.template = new RadioButton({ label: 'Template', value: 'template', name: 'styles' });\n        // this.template.appendTo(template);\n        // radioOptionsDiv.appendChild(templateDiv);\n        this.createFormatDropdown(container, localValue);\n        this.target.appendChild(container);\n    };\n    StyleDialog.prototype.createFormatDropdown = function (parentDiv, localValue) {\n        var _this = this;\n        var formatBtn = createElement('button', { id: 'style_format_dropdown', innerHTML: localValue.getConstant('Format') });\n        formatBtn.style.height = '35px';\n        parentDiv.appendChild(formatBtn);\n        var items = [{ text: localValue.getConstant('Font') + '..', id: 'style_font' },\n            { text: localValue.getConstant('Paragraph') + '..', id: 'style_paragraph' },\n            { text: localValue.getConstant('Numbering') + '..', id: 'style_numbering' }];\n        var dropDownbtn = new DropDownButton({\n            items: items, cssClass: 'e-de-style-format-dropdwn',\n            beforeItemRender: function (args) {\n                if (_this.styleType.value === 'Character') {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.add('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.add('e-disabled');\n                    }\n                }\n                else {\n                    if (args.item.text === 'Paragraph') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                    if (args.item.text === 'Numbering') {\n                        args.element.classList.remove('e-disabled');\n                    }\n                }\n            }\n        });\n        dropDownbtn.appendTo(formatBtn);\n        dropDownbtn.addEventListener('select', this.openDialog);\n    };\n    StyleDialog.prototype.createFontOptions = function (parentDiv) {\n        var fontFamilyElement = createElement('select', { id: this.target.id + '_fontName' });\n        fontFamilyElement.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option>' +\n            '<option>Comic Sans MS</option><option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        parentDiv.appendChild(fontFamilyElement);\n        this.fontFamily = new ComboBox({\n            width: '123px', popupWidth: '123px',\n            cssClass: 'e-style-font-fmaily-right', change: this.fontFamilyChanged\n        });\n        this.fontFamily.showClearButton = false;\n        this.fontFamily.appendTo(fontFamilyElement);\n        var fontSizeElement = createElement('input');\n        parentDiv.appendChild(fontSizeElement);\n        var sizeDataSource = [8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72];\n        this.fontSize = new ComboBox({\n            dataSource: sizeDataSource, width: '73px', cssClass: 'e-style-font-fmaily-right',\n            change: this.fontSizeUpdate\n        });\n        this.fontSize.showClearButton = false;\n        this.fontSize.appendTo(fontSizeElement);\n        var fontGroupButton = createElement('div', { className: 'e-de-style-font-group-button' });\n        parentDiv.appendChild(fontGroupButton);\n        // tslint:disable-next-line:max-line-length\n        this.bold = this.createButtonElement(fontGroupButton, 'e-de-bold', 'e-de-style-bold-button-size', this.owner.owner.containerId + '_style_bold');\n        this.bold.addEventListener('click', this.setBoldProperty);\n        // tslint:disable-next-line:max-line-length\n        this.italic = this.createButtonElement(fontGroupButton, 'e-de-italic', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_italic');\n        this.italic.addEventListener('click', this.setItalicProperty);\n        // tslint:disable-next-line:max-line-length\n        this.underline = this.createButtonElement(fontGroupButton, 'e-de-underline', 'e-de-style-icon-button-size', this.owner.owner.containerId + '_style_underline');\n        this.underline.addEventListener('click', this.setUnderlineProperty);\n        var fontColorElement = createElement('input', { attrs: { type: 'color' }, className: 'e-de-style-icon-button-size' });\n        parentDiv.appendChild(fontColorElement);\n        this.fontColor = new ColorPicker({ cssClass: 'e-de-style-font-color-picker', change: this.fontColorUpdate });\n        this.fontColor.appendTo(fontColorElement);\n    };\n    StyleDialog.prototype.createParagraphOptions = function (parentDiv) {\n        var _this = this;\n        var alignmentDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(alignmentDiv);\n        this.leftAlign = this.createButtonElement(alignmentDiv, 'e-de-align-left', 'e-de-style-icon-button-size');\n        this.leftAlign.addEventListener('click', this.setLeftAlignment);\n        this.centerAlign = this.createButtonElement(alignmentDiv, 'e-de-align-center', 'e-de-style-icon-button-size');\n        this.centerAlign.addEventListener('click', this.setCenterAlignment);\n        this.rightAlign = this.createButtonElement(alignmentDiv, 'e-de-align-right', 'e-de-style-icon-button-size');\n        this.rightAlign.addEventListener('click', this.setRightAlignment);\n        this.justify = this.createButtonElement(alignmentDiv, 'e-de-justify', 'e-de-style-icon-button-last-size');\n        this.justify.addEventListener('click', this.setJustifyAlignment);\n        var lineSpacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(lineSpacingDiv);\n        this.singleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-single-spacing', 'e-de-style-icon-button-first-size');\n        this.singleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1;\n            _this.updateParagraphFormat();\n        });\n        // tslint:disable-next-line:max-line-length\n        this.onePointFiveLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-one-point-five-spacing', 'e-de-style-icon-button-size');\n        this.onePointFiveLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 1.5;\n            _this.updateParagraphFormat();\n        });\n        this.doubleLineSpacing = this.createButtonElement(lineSpacingDiv, 'e-de-double-spacing', 'e-de-style-icon-button-last-size');\n        this.doubleLineSpacing.addEventListener('click', function () {\n            _this.paragraphFormat.lineSpacing = 2;\n            _this.updateParagraphFormat();\n        });\n        var spacingDiv = createElement('div', { className: 'e-de-style-paragraph-group-button' });\n        parentDiv.appendChild(spacingDiv);\n        var beforeSpacing = this.createButtonElement(spacingDiv, 'e-de-before-spacing', 'e-de-style-icon-button-first-size');\n        var afterSpacing = this.createButtonElement(spacingDiv, 'e-de-after-spacing', 'e-de-style-icon-button-last-size');\n        beforeSpacing.addEventListener('click', this.increaseBeforeAfterSpacing);\n        afterSpacing.addEventListener('click', this.decreaseBeforeAfterSpacing);\n        var indentingDiv = createElement('div', { className: 'e-de-style-paragraph-indent-group-button' });\n        parentDiv.appendChild(indentingDiv);\n        var decreaseIndent = this.createButtonElement(indentingDiv, 'e-de-indent', 'e-de-style-icon-button-first-size');\n        decreaseIndent.addEventListener('click', function () {\n            if (_this.paragraphFormat.leftIndent >= 36) {\n                _this.paragraphFormat.leftIndent -= 36;\n            }\n            else {\n                _this.paragraphFormat.leftIndent = 0;\n            }\n        });\n        var increaseindent = this.createButtonElement(indentingDiv, 'e-de-outdent', 'e-de-style-icon-button-size');\n        increaseindent.addEventListener('click', function () {\n            _this.paragraphFormat.leftIndent += 36;\n        });\n    };\n    StyleDialog.prototype.createButtonElement = function (parentDiv, iconCss, className, id) {\n        var buttonElement = createElement('button');\n        if (!isNullOrUndefined(id)) {\n            buttonElement.id = id;\n        }\n        parentDiv.appendChild(buttonElement);\n        var button = new Button({ iconCss: iconCss, cssClass: className });\n        button.appendTo(buttonElement);\n        return buttonElement;\n    };\n    StyleDialog.prototype.toggleDisable = function () {\n        if (this.styleType.value === 'Character') {\n            this.styleParagraph.enabled = false;\n            // tslint:disable-next-line:max-line-length\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex;pointer-events:none;opacity:0.5');\n        }\n        else {\n            this.styleParagraph.enabled = true;\n            this.target.getElementsByClassName('e-style-paragraph').item(0).removeAttribute('style');\n            this.target.getElementsByClassName('e-style-paragraph').item(0).setAttribute('style', 'display:flex');\n        }\n        this.styleBasedOn.enabled = true;\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.show = function (styleName, header) {\n        var localObj = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        this.isEdit = (!isNullOrUndefined(styleName) && styleName.length > 0) ? true : false;\n        this.editStyleName = styleName;\n        this.abstractList = new WAbstractList();\n        // tslint:disable-next-line:max-line-length\n        var style = this.owner.owner.viewer.styles.findByName(styleName);\n        this.style = !this.isEdit ? new WParagraphStyle() : style ? style : this.getStyle(styleName);\n        localObj.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initStyleDialog(localObj);\n        }\n        if (isNullOrUndefined(header)) {\n            header = localObj.getConstant('Create New Style');\n        }\n        this.owner.owner.viewer.dialog2.header = header;\n        this.owner.owner.viewer.dialog2.height = 'auto';\n        this.owner.owner.viewer.dialog2.width = 'auto';\n        this.owner.owner.viewer.dialog2.content = this.target;\n        this.owner.owner.viewer.dialog2.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: localObj.getConstant('Ok'), cssClass: 'e-flat e-style-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: localObj.getConstant('Cancel'), cssClass: 'e-flat e-style-cancel' }\n            }];\n        this.toggleDisable();\n        this.owner.owner.viewer.dialog2.dataBind();\n        this.owner.owner.viewer.dialog2.beforeOpen = this.loadStyleDialog;\n        this.owner.owner.viewer.dialog2.close = this.closeStyleDialog;\n        this.owner.owner.viewer.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.owner.viewer.dialog2.show();\n    };\n    StyleDialog.prototype.updateList = function () {\n        var listId = this.style.paragraphFormat.listFormat.listId;\n        if (listId > -1) {\n            if (this.owner.owner.viewer.lists.filter(function (a) { return (a.listId === listId); }).length === 0) {\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n            else {\n                this.owner.owner.viewer.lists = this.owner.owner.viewer.lists.filter(function (a) { return (a.listId !== listId); });\n                this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list);\n            }\n        }\n        if (this.abstractList.abstractListId !== -1) {\n            this.owner.owner.viewer.abstractLists.push(this.abstractList);\n        }\n    };\n    StyleDialog.prototype.createLinkStyle = function (name, isEdit) {\n        var charStyle;\n        if (isEdit) {\n            charStyle = this.owner.owner.viewer.styles.findByName((name + ' Char'), 'Character');\n        }\n        else {\n            charStyle = new WCharacterStyle();\n        }\n        charStyle.type = 'Character';\n        charStyle.name = name + ' Char';\n        charStyle.characterFormat = this.style.characterFormat.cloneFormat();\n        charStyle.basedOn = this.style.basedOn;\n        if (!isEdit) {\n            this.owner.owner.viewer.styles.push(charStyle);\n        }\n        return this.owner.owner.viewer.styles.findByName(charStyle.name, 'Character');\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateCharacterFormat = function (characterFormat) {\n        if (!isNullOrUndefined(characterFormat)) {\n            this.characterFormat = characterFormat;\n        }\n        this.fontFamily.value = this.characterFormat.fontFamily;\n        this.fontSize.value = this.characterFormat.fontSize;\n        this.fontColor.value = this.characterFormat.fontColor;\n        this.fontButtonClicked(undefined);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.updateParagraphFormat = function (paragraphFOrmat) {\n        if (!isNullOrUndefined(paragraphFOrmat)) {\n            this.paragraphFormat = paragraphFOrmat;\n        }\n        if (this.paragraphFormat.textAlignment === 'Left') {\n            if (!this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.add('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Right') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (!this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.add('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Center') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (!this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.add('e-active');\n            }\n            if (this.justify.classList.contains('e-active')) {\n                this.justify.classList.remove('e-active');\n            }\n        }\n        else if (this.paragraphFormat.textAlignment === 'Justify') {\n            if (this.leftAlign.classList.contains('e-active')) {\n                this.leftAlign.classList.remove('e-active');\n            }\n            if (this.rightAlign.classList.contains('e-active')) {\n                this.rightAlign.classList.remove('e-active');\n            }\n            if (this.centerAlign.classList.contains('e-active')) {\n                this.centerAlign.classList.remove('e-active');\n            }\n            if (!this.justify.classList.contains('e-active')) {\n                this.justify.classList.add('e-active');\n            }\n        }\n        if (this.paragraphFormat.lineSpacing === 1) {\n            this.singleLineSpacing.classList.add('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 1.5) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.add('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n        else if (this.paragraphFormat.lineSpacing === 2) {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.add('e-active');\n        }\n        else {\n            this.singleLineSpacing.classList.remove('e-active');\n            this.onePointFiveLineSpacing.classList.remove('e-active');\n            this.doubleLineSpacing.classList.remove('e-active');\n        }\n    };\n    StyleDialog.prototype.enableOrDisableOkButton = function () {\n        if (!isNullOrUndefined(this.okButton)) {\n            this.okButton.disabled = (this.styleNameElement.value === '');\n        }\n    };\n    StyleDialog.prototype.getTypeValue = function () {\n        var type;\n        if (this.styleType.value === 'Linked(Paragraph and Character)' || this.styleType.value === 'Paragraph') {\n            return 'Paragraph';\n        }\n        else {\n            return 'Character';\n        }\n    };\n    StyleDialog.prototype.updateStyleNames = function (type, name) {\n        var styles = this.owner.owner.viewer.styles.getStyleNames(type);\n        this.styleParagraph.dataSource = styles;\n        this.styleParagraph.index = null;\n        if (name) {\n            this.styleBasedOn.dataSource = styles.filter(function (e) { return e !== name; });\n            this.styleBasedOn.index = null;\n            var style = this.getStyle(name);\n            if (style.basedOn instanceof String || isNullOrUndefined(style.basedOn)) {\n                this.styleBasedOn.enabled = false;\n            }\n            else {\n                /*Â tslint:disable-next-line:max-line-length */\n                this.styleBasedOn.index = styles.indexOf(style.basedOn.name) > -1 ? styles.indexOf(style.basedOn.name) : 0;\n            }\n            if (style.type === 'Paragraph') {\n                if (!isNullOrUndefined(style.link)) {\n                    this.styleType.index = 2;\n                }\n                else {\n                    this.styleType.index = 0;\n                }\n            }\n            else {\n                this.styleType.index = 1;\n            }\n            if (!isNullOrUndefined(style.next)) {\n                var nxtName = style.next.name;\n                var index = 0;\n                if (styles.indexOf(nxtName) > -1) {\n                    index = styles.indexOf(nxtName);\n                }\n                this.styleParagraph.index = index;\n                this.isUserNextParaUpdated = (nxtName === name) ? false : true;\n            }\n        }\n        else {\n            this.styleBasedOn.dataSource = styles;\n            this.styleBasedOn.index = null;\n            var basedOnIndex = 0;\n            if (this.owner.owner.selectionModule) {\n                var styleName = void 0;\n                if (type === 'Character') {\n                    styleName = this.owner.owner.selection.characterFormat.styleName;\n                }\n                else {\n                    styleName = this.owner.owner.selection.paragraphFormat.styleName;\n                }\n                basedOnIndex = styles.indexOf(styleName);\n            }\n            this.styleBasedOn.index = basedOnIndex;\n            this.styleParagraph.index = 0;\n        }\n        if (this.isEdit) {\n            this.styleType.enabled = false;\n        }\n        else {\n            this.styleType.enabled = true;\n        }\n        this.styleBasedOn.dataBind();\n        this.styleParagraph.dataBind();\n    };\n    StyleDialog.prototype.getStyle = function (styleName) {\n        /* tslint:disable-next-line:max-line-length */\n        if (isNullOrUndefined(this.owner.owner.viewer.styles.findByName(styleName))) {\n            /* tslint:disable-next-line:max-line-length */\n            this.owner.owner.editor.createStyle(this.owner.owner.viewer.preDefinedStyles.get(styleName));\n        }\n        return this.owner.owner.viewer.styles.findByName(styleName);\n    };\n    /**\n     * @private\n     */\n    StyleDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var n = 0; n < this.target.childNodes.length; n++) {\n                this.target.removeChild(this.target.childNodes[n]);\n                n--;\n            }\n            this.target = undefined;\n        }\n        if (this.styleType) {\n            this.styleType.destroy();\n        }\n        this.styleType = undefined;\n        if (this.styleBasedOn) {\n            this.styleBasedOn.destroy();\n        }\n        this.styleBasedOn = undefined;\n        if (this.styleParagraph) {\n            this.styleParagraph.destroy();\n        }\n        this.styleParagraph = undefined;\n        if (this.onlyThisDocument) {\n            this.onlyThisDocument.destroy();\n        }\n        this.onlyThisDocument = undefined;\n        if (this.template) {\n            this.template.destroy();\n        }\n        this.template = undefined;\n        if (this.style) {\n            this.style = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList = undefined;\n        }\n        if (this.numberingBulletDialog) {\n            this.numberingBulletDialog.destroy();\n        }\n        this.numberingBulletDialog = undefined;\n    };\n    return StyleDialog;\n}());\nexport { StyleDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { WList } from '../list/list';\nimport { WAbstractList } from '../list/abstract-list';\nimport { WListLevel } from '../list/list-level';\nimport { WListFormat } from '../../implementation/format/list-format';\n/**\n * The Bullets and Numbering dialog is used to apply list format for a paragraph style.\n */\n/* tslint:disable:no-any */\nvar BulletsAndNumberingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BulletsAndNumberingDialog(layoutViewer) {\n        var _this = this;\n        this.isBullet = false;\n        /**\n         * @private\n         */\n        this.numberListClick = function (args) {\n            _this.isBullet = false;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-de-list-numbered-none')) {\n                _this.numberFormat = undefined;\n                _this.listLevelPattern = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-number-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'Arabic';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpRoman';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-up-letter')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'UpLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-letter-brace')) {\n                _this.numberFormat = '%1)';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-numbered-low-letter-dot')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowLetter';\n            }\n            else if (args.currentTarget.classList.contains('e-de-list-numbered-low-roman')) {\n                _this.numberFormat = '%1.';\n                _this.listLevelPattern = 'LowRoman';\n            }\n        };\n        /**\n         * @private\n         */\n        this.bulletListClick = function (args) {\n            _this.isBullet = true;\n            _this.setActiveElement(args);\n            if (args.currentTarget.classList.contains('e-bullet-none')) {\n                _this.symbol = undefined;\n                _this.fontFamily = undefined;\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-dot')) {\n                _this.symbol = '\\uf0b7';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-circle')) {\n                _this.symbol = '\\uf06f' + '\\u0020';\n                _this.fontFamily = 'Symbol';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-square')) {\n                _this.symbol = '\\uf0a7';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-flower')) {\n                _this.symbol = '\\uf076';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-arrow')) {\n                _this.symbol = '\\uf0d8';\n                _this.fontFamily = 'Wingdings';\n            }\n            else if (args.currentTarget.classList.contains('e-bullet-tick')) {\n                _this.symbol = '\\uf0fc';\n                _this.fontFamily = 'Wingdings';\n            }\n        };\n        /**\n         * @private\n         */\n        this.loadNumberingBulletDialog = function () {\n            //Load \n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.closeNumberingBulletDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.isBullet = false;\n            _this.listLevelPattern = undefined;\n            _this.numberFormat = undefined;\n            _this.symbol = undefined;\n            _this.fontFamily = undefined;\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onOkButtonClick = function () {\n            if (_this.owner.owner.viewer.lists.length > 0) {\n                _this.listFormat.list.listId = _this.owner.owner.viewer.lists[_this.owner.owner.viewer.lists.length - 1].listId + 1;\n                _this.listFormat.listId = _this.listFormat.list.listId;\n            }\n            else {\n                _this.listFormat.list.listId = 0;\n                _this.listFormat.listId = 0;\n            }\n            if (_this.owner.owner.viewer.abstractLists.length > 0) {\n                /*Â tslint:disable-next-line:max-line-length */\n                _this.abstractList.abstractListId = _this.owner.owner.viewer.abstractLists[_this.owner.owner.viewer.abstractLists.length - 1].abstractListId + 1;\n            }\n            else {\n                _this.abstractList.abstractListId = 0;\n            }\n            _this.listFormat.list.abstractListId = _this.abstractList.abstractListId;\n            var listLevel = new WListLevel(_this.abstractList);\n            listLevel.listLevelPattern = !isNullOrUndefined(_this.listLevelPattern) ? _this.listLevelPattern : 'Bullet';\n            listLevel.numberFormat = _this.isBullet ? _this.symbol : _this.numberFormat;\n            if (listLevel.listLevelPattern !== 'Bullet') {\n                listLevel.startAt = 1;\n            }\n            listLevel.characterFormat.fontFamily = !isNullOrUndefined(_this.fontFamily) ? _this.fontFamily : 'Verdana';\n            listLevel.paragraphFormat.leftIndent = 36;\n            listLevel.paragraphFormat.firstLineIndent = -18;\n            _this.abstractList.levels.push(listLevel);\n            _this.listFormat.listLevelNumber = 0;\n            _this.listFormat.list.abstractList = _this.abstractList;\n            _this.owner.dialog.hide();\n        };\n        this.owner = layoutViewer;\n    }\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.getModuleName = function () {\n        return 'BulletsAndNumberingDialog';\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.initNumberingBulletDialog = function (locale) {\n        var instance = this;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertNumberBulletDialog', className: 'e-de-number-bullet-dlg' });\n        var tabTarget = createElement('div', { id: id + '_tabNumberBulletDialog', className: 'e-de-tab-number-bullet-dlg' });\n        this.target.appendChild(tabTarget);\n        this.createNumberList(id);\n        this.createBulletList(id);\n        //Initialize Tab component\n        var tabObj = new Tab({\n            items: [\n                {\n                    header: { 'text': locale.getConstant('Numbering') },\n                    /*Â tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Number'),\n                },\n                {\n                    header: { 'text': locale.getConstant('Bullets') },\n                    /*Â tslint:disable-next-line:max-line-length */\n                    content: ('#' + id + '_Bullet'),\n                },\n            ],\n            heightAdjustMode: 'None',\n            width: 272,\n        });\n        //Render initialized Tab component\n        tabObj.appendTo(tabTarget);\n        this.owner.owner.element.appendChild(this.target);\n        tabObj.refresh();\n    };\n    BulletsAndNumberingDialog.prototype.createNumberList = function (id) {\n        var numberListDiv = createElement('div', { className: 'e-de-style-numbered-list', id: id + '_Number' });\n        numberListDiv.style.display = 'none';\n        numberListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;',\n            id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        numberListDiv.appendChild(ulTag);\n        var numberedNone = this.createNumberNoneListTag(ulTag);\n        var numberedNumberDot = this.createNumberListTag(ulTag, '1.', '2.', '3.', 'e-de-list-numbered-number-dot');\n        var numberedNumberBrace = this.createNumberListTag(ulTag, '1)', '2)', '3)', 'e-de-list-numbered-number-brace');\n        var numberedUpRoman = this.createNumberListTag(ulTag, 'I.', 'II.', 'III.', 'e-de-list-numbered-up-roman');\n        var numberedUpLettter = this.createNumberListTag(ulTag, 'A.', 'B.', 'C.', 'e-de-list-numbered-up-letter');\n        var numberedLowLetterDot = this.createNumberListTag(ulTag, 'a.', 'b.', 'c.', 'e-de-numbered-low-letter-dot');\n        var numberedLowLetterBrace = this.createNumberListTag(ulTag, 'a)', 'b)', 'c)', 'e-de-list-numbered-low-letter-brace');\n        var numberedLowRoman = this.createNumberListTag(ulTag, 'i.', 'ii.', 'iii.', 'e-de-list-numbered-low-roman');\n        numberedNone.addEventListener('click', this.numberListClick);\n        numberedNumberDot.addEventListener('click', this.numberListClick);\n        numberedNumberBrace.addEventListener('click', this.numberListClick);\n        numberedUpRoman.addEventListener('click', this.numberListClick);\n        numberedUpLettter.addEventListener('click', this.numberListClick);\n        numberedLowLetterBrace.addEventListener('click', this.numberListClick);\n        numberedLowLetterDot.addEventListener('click', this.numberListClick);\n        numberedLowRoman.addEventListener('click', this.numberListClick);\n        this.target.appendChild(numberListDiv);\n    };\n    BulletsAndNumberingDialog.prototype.createNumberListTag = function (ulTag, text1, text2, text3, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /*Â tslint:disable-next-line:max-line-length */\n        var innerHTML = '<div>' + text1 + '<span class=\"e-de-ui-list-line\"></span></div><div>' + text2 + '<span class=\"e-de-ui-list-line\">';\n        innerHTML += '</span></div><div>' + text3 + '<span class=\"e-de-ui-list-line\"> </span></div >';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createNumberNoneListTag = function (ulTag) {\n        var liTag = createElement('li', {\n            styles: 'display:block',\n            /*Â tslint:disable-next-line:max-line-length */\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none'\n        });\n        ulTag.appendChild(liTag);\n        var innerHTML = '<div class=\"e-de-ui-bullets e-de-bullet-icons\">None</div>';\n        var liInnerDiv = createElement('div', {\n            className: 'e-de-ui-list-header-presetmenu',\n            id: 'e-de-ui-zlist0', innerHTML: innerHTML\n        });\n        liTag.style.cssFloat = 'left';\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletListTag = function (ulTag, iconCss, className) {\n        var liTag = createElement('li', {\n            styles: 'display:block;',\n            className: 'e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size ' + className\n        });\n        ulTag.appendChild(liTag);\n        /*Â tslint:disable-next-line:max-line-length */\n        var liInnerDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size', id: 'e-de-ui-zlist0' });\n        var liNextDiv = createElement('div', { className: iconCss });\n        liInnerDiv.appendChild(liNextDiv);\n        liTag.appendChild(liInnerDiv);\n        return liTag;\n    };\n    BulletsAndNumberingDialog.prototype.createBulletList = function (id) {\n        var bulletListDiv = createElement('div', { className: 'e-de-ui-bullet-list-header-presetmenu', id: id + '_Bullet' });\n        bulletListDiv.style.display = 'none';\n        bulletListDiv.style.height = '270px';\n        var ulTag = createElement('ul', {\n            styles: 'display: block; outline: 0px;', id: 'listMenu',\n            className: 'e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail'\n        });\n        bulletListDiv.appendChild(ulTag);\n        var bulletNone = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-none e-de-bullet-icons', 'e-bullet-none');\n        var bulletDot = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-dot e-de-bullet-icons', 'e-bullet-dot');\n        /*Â tslint:disable-next-line:max-line-length */\n        var bulletCircle = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-circle e-de-bullet-icons', 'e-bullet-circle');\n        var bulletSquare = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-square e-de-bullet-icons', 'e-bullet-square');\n        /*Â tslint:disable-next-line:max-line-length */\n        var bulletFlower = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-flower e-de-bullet-icons', 'e-bullet-flower');\n        var bulletArrow = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-arrow e-de-bullet-icons', 'e-bullet-arrow');\n        var bulletTick = this.createBulletListTag(ulTag, 'e-de-icon-bullet-list-tick e-de-bullet-icons', 'e-bullet-tick');\n        bulletNone.addEventListener('click', this.bulletListClick);\n        bulletDot.addEventListener('click', this.bulletListClick);\n        bulletCircle.addEventListener('click', this.bulletListClick);\n        bulletSquare.addEventListener('click', this.bulletListClick);\n        bulletFlower.addEventListener('click', this.bulletListClick);\n        bulletArrow.addEventListener('click', this.bulletListClick);\n        bulletTick.addEventListener('click', this.bulletListClick);\n        // bulletListDiv.appendChild(table1);        \n        this.target.appendChild(bulletListDiv);\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.showNumberBulletDialog = function (listFormat, abstractList) {\n        if (!isNullOrUndefined(listFormat)) {\n            this.listFormat = listFormat;\n        }\n        else {\n            this.listFormat = new WListFormat();\n        }\n        if (isNullOrUndefined(this.listFormat.list)) {\n            this.listFormat.list = new WList();\n        }\n        if (!isNullOrUndefined(abstractList)) {\n            this.abstractList = abstractList;\n        }\n        else {\n            this.abstractList = new WAbstractList();\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initNumberingBulletDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Numbering and Bullets');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadNumberingBulletDialog;\n        this.owner.dialog.close = this.closeNumberingBulletDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.buttons = [{\n                click: this.onOkButtonClick,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-numbering-bullet-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-numbering-bullet-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BulletsAndNumberingDialog.prototype.setActiveElement = function (args) {\n        var html = args.currentTarget.parentElement;\n        for (var i = 0; i < html.childElementCount; i++) {\n            if (html.childNodes[i].classList.contains('e-de-list-active')) {\n                html.childNodes[i].classList.remove('e-de-list-active');\n            }\n        }\n        args.currentTarget.classList.add('e-de-list-active');\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.unWireEventsAndBindings = function () {\n        //Unwire events\n    };\n    /**\n     * @private\n     */\n    BulletsAndNumberingDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.listFormat) {\n            this.listFormat.destroy();\n            this.listFormat = undefined;\n        }\n        if (this.abstractList) {\n            this.abstractList.destroy();\n            this.abstractList = undefined;\n        }\n        if (this.target && this.target.parentElement) {\n            this.target.parentElement.removeChild(this.target);\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n    };\n    return BulletsAndNumberingDialog;\n}());\nexport { BulletsAndNumberingDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { DropDownList, ComboBox } from '@syncfusion/ej2-dropdowns';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { WCharacterFormat } from '../format/character-format';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Font dialog is used to modify formatting of selected text.\n */\n/* tslint:disable:no-any */\nvar FontDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function FontDialog(layoutViewer) {\n        var _this = this;\n        this.fontStyleInternal = undefined;\n        this.fontNameList = undefined;\n        this.fontStyleText = undefined;\n        this.fontSizeText = undefined;\n        this.colorPicker = undefined;\n        this.underlineDrop = undefined;\n        this.strikethroughBox = undefined;\n        this.doublestrikethrough = undefined;\n        this.superscript = undefined;\n        this.subscript = undefined;\n        //Character Format Property\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n        this.fontColor = undefined;\n        /**\n         * @private\n         */\n        this.characterFormat = undefined;\n        /**\n         * @private\n         */\n        this.loadFontDialog = function () {\n            _this.owner.updateFocus();\n            var characterFormat;\n            if (_this.characterFormat) {\n                characterFormat = _this.characterFormat;\n            }\n            else {\n                characterFormat = _this.owner.owner.selection.characterFormat;\n            }\n            _this.fontNameList.value = characterFormat.fontFamily;\n            if (!characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 0;\n            }\n            else if (characterFormat.bold && !characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 1;\n            }\n            else if (!characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 2;\n            }\n            else if (characterFormat.bold && characterFormat.italic) {\n                _this.fontStyleText.value = _this.fontSizeText.value;\n                _this.fontStyleText.index = 3;\n            }\n            if (!isNullOrUndefined(characterFormat.fontSize)) {\n                for (var i = 0; i <= 15; i++) {\n                    var items = _this.fontSizeText.getItems();\n                    if (characterFormat.fontSize.toString() === items[i].innerHTML) {\n                        _this.fontSizeText.value = characterFormat.fontSize;\n                        _this.fontSizeText.index = i;\n                        break;\n                    }\n                }\n            }\n            if (!isNullOrUndefined(characterFormat.fontColor)) {\n                _this.colorPicker.value = characterFormat.fontColor;\n            }\n            else {\n                _this.colorPicker.value = '#000000';\n            }\n            if (characterFormat.underline === 'None') {\n                _this.underlineDrop.index = 0;\n            }\n            else if (characterFormat.underline === 'Single') {\n                _this.underlineDrop.index = 1;\n            }\n            if (characterFormat.strikethrough === 'SingleStrike') {\n                _this.strikethroughBox.checked = true;\n            }\n            else if (characterFormat.strikethrough === 'DoubleStrike') {\n                _this.doublestrikethrough.checked = true;\n            }\n            else {\n                _this.strikethroughBox.checked = false;\n                _this.doublestrikethrough.checked = false;\n            }\n            if (characterFormat.baselineAlignment === 'Superscript') {\n                _this.superscript.checked = true;\n            }\n            else if (characterFormat.baselineAlignment === 'Subscript') {\n                _this.subscript.checked = true;\n            }\n            else {\n                _this.superscript.checked = false;\n                _this.subscript.checked = false;\n            }\n            if (_this.owner.selection.caret.style.display !== 'none') {\n                _this.owner.selection.caret.style.display = 'none';\n            }\n        };\n        /**\n         * @private\n         */\n        this.closeFontDialog = function () {\n            _this.unWireEventsAndBindings();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.onCancelButtonClick = function () {\n            _this.owner.dialog.hide();\n            _this.unWireEventsAndBindings();\n        };\n        /**\n         * @private\n         */\n        this.onInsertFontFormat = function () {\n            var format;\n            if (_this.characterFormat) {\n                format = _this.characterFormat;\n            }\n            else {\n                format = new WCharacterFormat(undefined);\n            }\n            if (!isNullOrUndefined(_this.bold)) {\n                format.bold = _this.bold;\n            }\n            if (!isNullOrUndefined(_this.italic)) {\n                format.italic = _this.italic;\n            }\n            if (!isNullOrUndefined(_this.fontSize) && _this.fontSize > 0) {\n                format.fontSize = _this.fontSize;\n            }\n            if (!isNullOrUndefined(_this.fontColor)) {\n                format.fontColor = _this.fontColor;\n            }\n            if (!isNullOrUndefined(_this.baselineAlignment)) {\n                format.baselineAlignment = _this.baselineAlignment;\n            }\n            if (!isNullOrUndefined(_this.strikethrough)) {\n                format.strikethrough = _this.strikethrough;\n            }\n            if (!isNullOrUndefined(_this.underline)) {\n                format.underline = _this.underline;\n            }\n            if (!isNullOrUndefined(_this.fontFamily)) {\n                format.fontFamily = _this.fontFamily;\n            }\n            if (!_this.characterFormat) {\n                _this.onCharacterFormat(_this.owner.selection, format);\n            }\n            else {\n                _this.owner.owner.styleDialogModule.updateCharacterFormat();\n            }\n            _this.owner.dialog.hide();\n        };\n        this.fontSizeUpdate = function (args) {\n            _this.fontSize = args.value;\n        };\n        this.fontStyleUpdate = function (args) {\n            _this.fontStyle = args.value;\n        };\n        this.fontFamilyUpdate = function (args) {\n            _this.fontFamily = args.value;\n        };\n        this.underlineUpdate = function (args) {\n            _this.underline = args.value;\n        };\n        this.fontColorUpdate = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                _this.fontColor = args.currentValue.hex;\n            }\n        };\n        this.singleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'SingleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.doubleStrikeUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.strikethrough = 'DoubleStrike';\n            }\n            else {\n                _this.strikethrough = 'None';\n            }\n        };\n        this.superscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Superscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.subscriptUpdate = function (args) {\n            _this.enableCheckBoxProperty(args);\n            if (args.checked) {\n                _this.baselineAlignment = 'Subscript';\n            }\n            else {\n                _this.baselineAlignment = 'Normal';\n            }\n        };\n        this.owner = layoutViewer;\n    }\n    Object.defineProperty(FontDialog.prototype, \"fontStyle\", {\n        /**\n         * @private\n         */\n        get: function () {\n            return this.fontStyleInternal;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.fontStyleInternal = value;\n            switch (this.fontStyle) {\n                case 'Bold':\n                    this.bold = true;\n                    this.italic = false;\n                    break;\n                case 'Italic':\n                    this.bold = false;\n                    this.italic = true;\n                    break;\n                case 'BoldItalic':\n                    this.bold = true;\n                    this.italic = true;\n                    break;\n                case 'Regular':\n                    this.bold = false;\n                    this.italic = false;\n                    break;\n            }\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    FontDialog.prototype.getModuleName = function () {\n        return 'FontDialog';\n    };\n    FontDialog.prototype.createInputElement = function (type, id, className) {\n        var element = createElement('input', {\n            attrs: { type: type },\n            id: id,\n            className: className\n        });\n        return element;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.initFontDialog = function (locale) {\n        var instance = this;\n        var effectLabel;\n        var strikeThroughElement;\n        var superScriptElement;\n        var subScriptElement;\n        var doubleStrikeThroughElement;\n        var id = this.owner.owner.containerId;\n        this.target = createElement('div', { id: id + '_insertFontDialog', className: 'e-de-font-dlg' });\n        var fontDiv = this.getFontDiv(locale);\n        this.target.appendChild(fontDiv);\n        var sizeDiv = this.getFontSizeDiv(locale);\n        this.target.appendChild(sizeDiv);\n        var colorDiv = createElement('div', { id: id + '_fontColor', styles: 'margin-top:15px;' });\n        this.fontColorDiv = createElement('div', { id: id + '_fontColorDiv', className: 'e-de-font-dlg-display' });\n        var fontColorLabel = createElement('label', {\n            className: 'e-de-font-dlg-header-font-color e-de-font-color-margin', innerHTML: locale.getConstant('Font color')\n        });\n        this.fontColorDiv.appendChild(fontColorLabel);\n        var fontColorElement = this.createInputElement('color', this.target.id + '_ColorDiv', 'e-de-font-dlg-color');\n        this.fontColorDiv.appendChild(fontColorElement);\n        colorDiv.appendChild(this.fontColorDiv);\n        this.target.appendChild(colorDiv);\n        var fontEffectsDiv = createElement('div', { id: id + '_fontEffectsDiv' });\n        var fontEffectSubDiv1 = createElement('div', {\n            className: 'e-de-font-color-label e-de-font-dlg-display',\n            id: this.target.id + '_fontEffectsSubDiv1'\n        });\n        effectLabel = createElement('label', { className: 'e-de-font-dlg-header-effects', innerHTML: locale.getConstant('Effects') });\n        fontEffectSubDiv1.appendChild(effectLabel);\n        strikeThroughElement = this.createInputElement('checkbox', this.target.id + '_strikeThrough', '');\n        fontEffectSubDiv1.appendChild(strikeThroughElement);\n        superScriptElement = this.createInputElement('checkbox', this.target.id + '_superScript', '');\n        fontEffectSubDiv1.appendChild(superScriptElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv1);\n        var fontEffectSubDiv2 = createElement('div', { className: 'e-de-font-checkbox', id: id + '_fontEffectsSubDiv2' });\n        subScriptElement = this.createInputElement('checkbox', this.target.id + '_subScript', '');\n        fontEffectSubDiv2.appendChild(subScriptElement);\n        doubleStrikeThroughElement = this.createInputElement('checkbox', this.target.id + '_doubleStrikeThrough', '');\n        fontEffectSubDiv2.appendChild(doubleStrikeThroughElement);\n        fontEffectsDiv.appendChild(fontEffectSubDiv2);\n        this.target.appendChild(fontEffectsDiv);\n        this.owner.owner.element.appendChild(this.target);\n        this.colorPicker = new ColorPicker({\n            change: this.fontColorUpdate, value: '#000000',\n        });\n        this.colorPicker.appendTo(fontColorElement);\n        this.strikethroughBox = new CheckBox({\n            change: this.singleStrikeUpdate,\n            cssClass: 'e-de-font-content-label',\n            label: locale.getConstant('Strikethrough')\n        });\n        this.strikethroughBox.appendTo(strikeThroughElement);\n        this.doublestrikethrough = new CheckBox({\n            change: this.doubleStrikeUpdate,\n            cssClass: 'e-de-font-content-checkbox-label',\n            label: locale.getConstant('Double strikethrough')\n        });\n        this.doublestrikethrough.appendTo(doubleStrikeThroughElement);\n        this.subscript = new CheckBox({\n            label: locale.getConstant('Subscript'),\n            change: this.subscriptUpdate\n        });\n        this.subscript.appendTo(subScriptElement);\n        this.superscript = new CheckBox({\n            label: locale.getConstant('Superscript'),\n            cssClass: 'e-de-font-content-label', change: this.superscriptUpdate\n        });\n        this.superscript.appendTo(superScriptElement);\n    };\n    FontDialog.prototype.getFontSizeDiv = function (locale) {\n        var fontSize;\n        var sizeDiv;\n        var id = this.owner.owner.containerId;\n        sizeDiv = createElement('div', { id: id + '_fontSizeAndUnderlineDiv', className: 'e-de-font-dlg-padding e-de-font-dlg-display' });\n        var sizeSubDiv1 = createElement('div', { id: id + '_fontSizeAndUnderlineSubDiv1' });\n        var sizeLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Size') });\n        var styles = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontSize = createElement('select', { id: this.target.id + '_fontSize', styles: styles });\n        fontSize.innerHTML = '<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option>' +\n            '<option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option>' +\n            '<option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>';\n        sizeSubDiv1.appendChild(sizeLabel);\n        sizeSubDiv1.appendChild(fontSize);\n        sizeDiv.appendChild(sizeSubDiv1);\n        var sizeSubDiv2 = createElement('div', {\n            className: 'e-de-font-dlg-cb-right',\n            id: id + '_fontSizeAndUnderlineSubDiv2'\n        });\n        var html = locale.getConstant('Underline style');\n        var underlineLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: html });\n        var underlineElement;\n        underlineElement = createElement('select', { id: this.target.id + '_underLine', styles: styles });\n        underlineElement.innerHTML = '<option>' + locale.getConstant('None') + '</option><option>________</option>';\n        sizeSubDiv2.appendChild(underlineLabel);\n        sizeSubDiv2.appendChild(underlineElement);\n        sizeDiv.appendChild(sizeSubDiv2);\n        this.fontSizeText = new ComboBox({ change: this.fontSizeUpdate, popupHeight: '170px', width: '170px' });\n        this.fontSizeText.showClearButton = false;\n        this.fontSizeText.appendTo(fontSize);\n        this.underlineDrop = new DropDownList({ change: this.underlineUpdate, popupHeight: '100px', width: '170px' });\n        this.underlineDrop.appendTo(underlineElement);\n        return sizeDiv;\n    };\n    FontDialog.prototype.getFontDiv = function (locale) {\n        var id = this.owner.owner.containerId;\n        var fontDiv = createElement('div', { id: id + '_fontDiv', className: 'e-de-font-dlg-display' });\n        var fontSubDiv1 = createElement('div', { id: id + '_fontSubDiv1' });\n        var fontNameLabel = createElement('label', {\n            className: 'e-de-font-dlg-header',\n            innerHTML: locale.getConstant('Font')\n        });\n        var fontNameValues = createElement('select', { id: this.target.id + '_fontName' });\n        fontNameValues.innerHTML = '<option>Arial</option><option>Calibri</option><option>Candara</option><option>Comic Sans MS</option>' +\n            '<option>Consolas</option><option>Constantia</option><option>Corbel</option>' +\n            '<option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option>' +\n            '<option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option>' +\n            '<option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option>' +\n            '<option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option>' +\n            '<option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>';\n        fontSubDiv1.appendChild(fontNameLabel);\n        fontSubDiv1.appendChild(fontNameValues);\n        fontDiv.appendChild(fontSubDiv1);\n        var fontSubDiv2;\n        var fontStyleLabel;\n        var fontStyleValues;\n        fontSubDiv2 = createElement('div', { className: 'e-de-font-dlg-cb-right', id: id + '_fontSubDiv2', styles: 'float:right;' });\n        fontStyleLabel = createElement('label', { className: 'e-de-font-dlg-header', innerHTML: locale.getConstant('Font style') });\n        var fontStyle = 'font-family:Roboto;font-size:14px;opacity:0.8;';\n        fontStyleValues = createElement('select', { id: this.target.id + '_fontStyle', styles: fontStyle });\n        fontStyleValues.innerHTML = '<option>' +\n            locale.getConstant('Regular') + '</option><option>' + locale.getConstant('Bold') + '</option><option>' +\n            locale.getConstant('Italic') + '</option><option>' + locale.getConstant('Bold') + locale.getConstant('Italic') + '</option>';\n        fontSubDiv2.appendChild(fontStyleLabel);\n        fontSubDiv2.appendChild(fontStyleValues);\n        fontDiv.appendChild(fontSubDiv2);\n        this.fontNameList = new ComboBox({ change: this.fontFamilyUpdate, popupHeight: '200px', width: '170px' });\n        this.fontNameList.showClearButton = false;\n        this.fontNameList.appendTo(fontNameValues);\n        this.fontStyleText = new DropDownList({ change: this.fontStyleUpdate, popupHeight: '170px', width: '170px' });\n        this.fontStyleText.appendTo(fontStyleValues);\n        return fontDiv;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.showFontDialog = function (characterFormat) {\n        if (characterFormat) {\n            this.characterFormat = characterFormat;\n        }\n        var locale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        locale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initFontDialog(locale);\n        }\n        this.owner.dialog.header = locale.getConstant('Font');\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.loadFontDialog;\n        this.owner.dialog.close = this.closeFontDialog;\n        this.owner.dialog.buttons = [{\n                click: this.onInsertFontFormat,\n                buttonModel: { content: locale.getConstant('Ok'), cssClass: 'e-flat e-font-okay', isPrimary: true }\n            },\n            {\n                click: this.onCancelButtonClick,\n                buttonModel: { content: locale.getConstant('Cancel'), cssClass: 'e-flat e-font-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * Applies character format\n     * @param  {Selection} selection\n     * @param  {WCharacterFormat} format\n     * @private\n     */\n    FontDialog.prototype.onCharacterFormat = function (selection, format) {\n        this.owner.owner.editorModule.initHistory('CharacterFormat');\n        if (selection.isEmpty) {\n            if (selection.start.offset === selection.getParagraphLength(selection.start.paragraph)) {\n                // tslint:disable-next-line:max-line-length\n                this.owner.owner.editorModule.applyCharFormatValueInternal(selection, selection.start.paragraph.characterFormat, undefined, format);\n                this.owner.owner.editorModule.reLayout(selection);\n            }\n            this.owner.updateFocus();\n            return;\n        }\n        else {\n            //Iterate and update formating.\n            this.owner.owner.editorModule.setOffsetValue(this.owner.selection);\n            this.owner.owner.editorModule.updateSelectionCharacterFormatting('CharacterFormat', format, false);\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.enableCheckBoxProperty = function (args) {\n        if (this.strikethroughBox.checked && this.doublestrikethrough.checked) {\n            this.strikethroughBox.checked = false;\n            this.doublestrikethrough.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_doubleStrikeThrough') {\n                this.doublestrikethrough.checked = true;\n            }\n            else {\n                this.strikethroughBox.checked = true;\n            }\n        }\n        if (this.superscript.checked && this.subscript.checked) {\n            this.subscript.checked = false;\n            this.superscript.checked = false;\n            if (args.event.currentTarget.id === this.target.id + '_subScript') {\n                this.subscript.checked = true;\n            }\n            else {\n                this.superscript.checked = true;\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.unWireEventsAndBindings = function () {\n        this.fontNameList.value = '';\n        this.fontSizeText.value = '';\n        this.fontStyleText.value = '';\n        this.strikethroughBox.checked = false;\n        this.doublestrikethrough.checked = false;\n        this.superscript.checked = false;\n        this.subscript.checked = false;\n        this.bold = undefined;\n        this.italic = undefined;\n        this.underline = undefined;\n        this.strikethrough = undefined;\n        this.baselineAlignment = undefined;\n        this.fontColor = undefined;\n        this.fontSize = undefined;\n        this.fontFamily = undefined;\n    };\n    /**\n     * @private\n     */\n    FontDialog.prototype.destroy = function () {\n        this.owner = undefined;\n        if (this.characterFormat) {\n            this.characterFormat.destroy();\n            this.characterFormat = undefined;\n        }\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var m = 0; m < this.target.childNodes.length; m++) {\n                this.target.removeChild(this.target.childNodes[m]);\n                m--;\n            }\n            this.target = undefined;\n        }\n        if (this.fontNameList) {\n            this.fontNameList.destroy();\n        }\n        this.fontNameList = undefined;\n        if (this.fontStyleText) {\n            this.fontStyleText.destroy();\n        }\n        this.fontStyleText = undefined;\n        if (this.fontSizeText) {\n            this.fontSizeText.destroy();\n        }\n        this.fontSizeText = undefined;\n        if (this.colorPicker) {\n            this.colorPicker.destroy();\n        }\n        this.colorPicker = undefined;\n        if (this.underlineDrop) {\n            this.underlineDrop.destroy();\n        }\n        this.underlineDrop = undefined;\n        if (this.strikethroughBox) {\n            this.strikethroughBox.destroy();\n        }\n        this.strikethroughBox = undefined;\n        if (this.doublestrikethrough) {\n            this.doublestrikethrough.destroy();\n        }\n        this.doublestrikethrough = undefined;\n        if (this.superscript) {\n            this.superscript.destroy();\n        }\n        this.superscript = undefined;\n        if (this.subscript) {\n            this.subscript.destroy();\n        }\n        this.subscript = undefined;\n    };\n    return FontDialog;\n}());\nexport { FontDialog };\n/* tslint:enable:no-any */ \n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WRowFormat, WCellFormat } from '../format/index';\nimport { CheckBox } from '@syncfusion/ej2-buttons';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { Tab } from '@syncfusion/ej2-navigations';\nimport { classList } from '@syncfusion/ej2-base';\nimport { HelperMethods } from '../editor/editor-helper';\n/**\n * The Table properties dialog is used to modify properties of selected table.\n */\nvar TablePropertiesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TablePropertiesDialog(viewer) {\n        var _this = this;\n        this.hasTableWidth = false;\n        this.hasCellWidth = false;\n        /**\n         * @private\n         */\n        this.isTableBordersAndShadingUpdated = false;\n        /**\n         * @private\n         */\n        this.isCellBordersAndShadingUpdated = false;\n        this.tabObj = undefined;\n        /**\n         * @private\n         */\n        this.isCellOptionsUpdated = false;\n        /**\n         * @private\n         */\n        this.isTableOptionsUpdated = false;\n        this.onBeforeOpen = function () {\n            _this.owner.updateFocus();\n            _this.loadTableProperties();\n        };\n        /**\n         * @private\n         */\n        this.onCloseTablePropertyDialog = function () {\n            _this.unWireEvent.bind(_this);\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableProperties = function () {\n            var selection = _this.owner.selection;\n            if (!_this.preferCheckBox.checked && !_this.preferCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.tableFormat.preferredWidth) || selection.tableFormat.preferredWidth !== 0) {\n                    _this.tableFormat.preferredWidth = 0;\n                    _this.tableFormat.preferredWidthType = 'Point';\n                }\n            }\n            if (_this.tableFormat.hasValue('tableAlignment') && _this.tableFormat.tableAlignment !== 'Left') {\n                if (isNullOrUndefined(selection.tableFormat.leftIndent) || selection.tableFormat.leftIndent !== 0) {\n                    _this.tableFormat.leftIndent = 0;\n                }\n            }\n            if (!_this.rowHeightCheckBox.checked && !_this.rowHeightCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.rowFormat.height) || selection.rowFormat.height !== 0) {\n                    _this.rowFormat.heightType = 'AtLeast';\n                    _this.rowFormat.height = 0;\n                }\n            }\n            if (!_this.preferredCellWidthCheckBox.checked && !_this.preferredCellWidthCheckBox.indeterminate) {\n                if (isNullOrUndefined(selection.cellFormat.preferredWidth) || selection.cellFormat.preferredWidth === 0) {\n                    _this.cellFormat.preferredWidthType = 'Point';\n                    _this.cellFormat.preferredWidth = 0;\n                }\n            }\n            else {\n                if (_this.cellFormat.preferredWidthType === 'Percent') {\n                    if (!_this.tableFormat.hasValue('preferredWidth') && !_this.tableFormat.hasValue('preferredWidthType')\n                        && _this.owner.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth === 0) {\n                        // tslint:disable-next-line:max-line-length\n                        var containerWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(true);\n                        var tableWidth = _this.owner.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(containerWidth);\n                        _this.tableFormat.preferredWidthType = 'Percent';\n                        _this.tableFormat.preferredWidth = tableWidth / HelperMethods.convertPixelToPoint(_this.owner.clientArea.width) * 100;\n                    }\n                }\n            }\n            if (_this.rowHeightValue) {\n                _this.rowFormat.height = _this.rowHeightValue;\n            }\n            _this.owner.owner.editorModule.initComplexHistory('TableProperties');\n            _this.owner.owner.editorModule.onTableFormat(_this.tableFormat);\n            _this.owner.owner.editorModule.onRowFormat(_this.rowFormat);\n            _this.owner.owner.editorModule.onCellFormat(_this.cellFormat);\n            _this.owner.owner.editorHistory.updateComplexHistory();\n            _this.closeTablePropertiesDialog();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.applyTableSubProperties = function () {\n            if (_this.isCellOptionsUpdated) {\n                var cellFormat = _this.owner.owner.cellOptionsDialogModule.cellFormat;\n                _this.owner.owner.cellOptionsDialogModule.applySubCellOptions(cellFormat);\n            }\n            if (_this.isTableOptionsUpdated) {\n                var tableFormat = _this.owner.owner.tableOptionsDialogModule.tableFormat;\n                _this.owner.owner.tableOptionsDialogModule.applySubTableOptions(tableFormat);\n            }\n            _this.isCellOptionsUpdated = false;\n            _this.isTableOptionsUpdated = false;\n        };\n        /**\n         * @private\n         */\n        this.unWireEvent = function () {\n            //Table Format\n            _this.preferCheckBox.change = undefined;\n            _this.tableWidthBox.change = undefined;\n            _this.tableWidthType.change = undefined;\n            _this.leftIndentBox.change = undefined;\n            //Row Format\n            _this.rowHeightCheckBox.change = undefined;\n            _this.rowHeightBox.change = undefined;\n            _this.rowHeightType.change = undefined;\n            _this.repeatHeader.change = undefined;\n            _this.allowRowBreak.change = undefined;\n            //Cell Format\n            _this.preferredCellWidthCheckBox.change = undefined;\n            _this.cellWidthBox.change = undefined;\n            _this.cellWidthType.change = undefined;\n            _this.cellFormat.destroy();\n            _this.rowFormat.destroy();\n            _this.tableFormat.destroy();\n            _this.rowHeightValue = undefined;\n            _this.owner.dialog2.open = _this.owner.selection.hideCaret.bind(_this.owner);\n        };\n        /**\n         * @private\n         */\n        this.closeTablePropertiesDialog = function () {\n            _this.owner.dialog2.hide();\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeTableCheckBox = function () {\n            var enable = (_this.preferCheckBox.checked || _this.preferCheckBox.indeterminate);\n            _this.tableWidthBox.enabled = enable;\n            _this.tableWidthType.enabled = enable;\n            if (enable) {\n                _this.tableFormat.preferredWidthType = (_this.tableWidthType.value === 'Points') ?\n                    'Point' : _this.tableWidthType.value;\n            }\n            else {\n                _this.tableFormat.preferredWidthType = _this.owner.selection.tableFormat.preferredWidthType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableAlignment = function (event) {\n            _this.updateClassForAlignmentProperties(_this.tableTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-table-properties-alignment']);\n            if (element.classList.contains('e-de-table-left-alignment')) {\n                _this.leftIndentBox.enabled = true;\n            }\n            else {\n                _this.leftIndentBox.enabled = false;\n            }\n            _this.tableFormat.tableAlignment = _this.getTableAlignment();\n        };\n        /**\n         * @private\n         */\n        this.changeTableRowCheckBox = function () {\n            _this.rowHeightType.enabled = _this.rowHeightCheckBox.checked;\n            _this.rowHeightBox.enabled = _this.rowHeightCheckBox.checked;\n            if (_this.rowHeightType.enabled) {\n                _this.rowFormat.heightType = _this.rowHeightType.value;\n            }\n            else {\n                _this.rowFormat.heightType = _this.owner.selection.rowFormat.heightType;\n            }\n        };\n        /**\n         * @private\n         */\n        this.changeTableCellCheckBox = function () {\n            _this.cellWidthType.enabled = _this.preferredCellWidthCheckBox.checked;\n            _this.cellWidthBox.enabled = _this.preferredCellWidthCheckBox.checked;\n        };\n        /**\n         * @private\n         */\n        this.changeCellAlignment = function (event) {\n            _this.updateClassForCellAlignment(_this.cellTab);\n            var element = event.target;\n            classList(element, ['e-de-table-alignment-active'], ['e-de-tablecell-alignment']);\n            _this.cellFormat.verticalAlignment = _this.getCellAlignment();\n        };\n        //#endregion\n        /**\n         * @private\n         */\n        this.showTableOptionsDialog = function () {\n            _this.owner.owner.tableOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showBordersShadingsPropertiesDialog = function () {\n            _this.owner.owner.bordersAndShadingDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        /**\n         * @private\n         */\n        this.showCellOptionsDialog = function () {\n            _this.owner.owner.cellOptionsDialogModule.show();\n            _this.owner.dialog2.element.style.pointerEvents = 'none';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TablePropertiesDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.cellFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                this.tableFormatIn = new WTableFormat();\n                return this.tableFormatIn;\n            }\n            return this.tableFormatIn;\n        },\n        /**\n         * @private\n         */\n        set: function (value) {\n            this.tableFormatIn = value;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(TablePropertiesDialog.prototype, \"rowFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.rowFormatInternal)) {\n                this.rowFormatInternal = new WRowFormat();\n                return this.rowFormatInternal;\n            }\n            return this.rowFormatInternal;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    TablePropertiesDialog.prototype.getModuleName = function () {\n        return 'TablePropertiesDialog';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTablePropertyDialog = function (localValue) {\n        var id = this.owner.owner.containerId + '_TablePropertiesDialog';\n        this.target = createElement('div', { id: id, className: 'e-de-table-properties-dlg' });\n        this.owner.owner.element.appendChild(this.target);\n        var ejtabContainer = createElement('div', { id: this.target.id + '_TabContainer' });\n        this.target.appendChild(ejtabContainer);\n        this.tableTab = createElement('div', {\n            id: this.target.id + '_TablePropertiesContentDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.rowTab = createElement('div', {\n            id: this.target.id + '_RowPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        this.cellTab = createElement('div', {\n            id: this.target.id + '_CellPropertiesDialogTab', className: 'e-de-table-ppty-dlg-tabs'\n        });\n        var separatorLine = createElement('div', { className: 'e-de-table-dialog-separator-line' });\n        // tslint:disable-next-line:max-line-length\n        var ejtab = createElement('div', { id: this.target.id + '_TablePropertiesDialogTab', className: 'e-de-table-ppty-tab' });\n        var headerContainer = createElement('div', { className: 'e-tab-header' });\n        var tableHeader = createElement('div', {\n            id: this.target.id + '_tableHeader', innerHTML: localValue.getConstant('Table')\n        });\n        var rowHeader = createElement('div', {\n            id: this.target.id + '_rowHeader', innerHTML: localValue.getConstant('Row')\n        });\n        var cellHeader = createElement('div', {\n            id: this.target.id + '_cellHeader', innerHTML: localValue.getConstant('Cell')\n        });\n        headerContainer.appendChild(tableHeader);\n        headerContainer.appendChild(rowHeader);\n        headerContainer.appendChild(cellHeader);\n        var contentContainer = createElement('div', { className: 'e-content' });\n        var tableContent = createElement('div', { id: this.target.id + '_tableContent' });\n        var rowContent = createElement('div', { id: this.target.id + '_rowContent' });\n        var cellContent = createElement('div', { id: this.target.id + '_cellContent' });\n        tableContent.appendChild(this.tableTab);\n        rowContent.appendChild(this.rowTab);\n        cellContent.appendChild(this.cellTab);\n        contentContainer.appendChild(tableContent);\n        contentContainer.appendChild(rowContent);\n        contentContainer.appendChild(cellContent);\n        ejtab.appendChild(headerContainer);\n        ejtab.appendChild(contentContainer);\n        ejtabContainer.appendChild(ejtab);\n        this.initTableProperties(this.tableTab, localValue);\n        this.initTableRowProperties(this.rowTab, localValue);\n        this.initTableCellProperties(this.cellTab, localValue);\n        this.tabObj = new Tab({}, ejtab);\n        this.target.appendChild(separatorLine);\n        var alignMentButtons = this.tableTab.getElementsByClassName(this.tableTab.id + 'e-de-table-alignment');\n        for (var i = 0; i < alignMentButtons.length; i++) {\n            alignMentButtons[i].addEventListener('click', this.changeTableAlignment);\n        }\n        var cellAlignment = this.cellTab.getElementsByClassName(this.cellTab.id + 'e-de-table-cell-alignment');\n        for (var i = 0; i < cellAlignment.length; i++) {\n            cellAlignment[i].addEventListener('click', this.changeCellAlignment);\n        }\n        var tableTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[0];\n        var tableTabHeaderItem = tableTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        tableTabHeaderItem.classList.add('e-de-table-ppty-dlg-table-header');\n        var rowTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[1];\n        var rowTabHeaderItem = rowTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        rowTabHeaderItem.classList.add('e-de-table-ppty-dlg-row-header');\n        var cellTabHeader = this.tabObj.element.getElementsByClassName('e-item e-toolbar-item')[2];\n        var cellTabHeaderItem = cellTabHeader.getElementsByClassName('e-tab-wrap')[0];\n        cellTabHeaderItem.classList.add('e-de-table-ppty-dlg-cell-header');\n        this.tabObj.element.getElementsByClassName('e-indicator')[0].style.right = '155px';\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.show = function () {\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTablePropertyDialog(localValue);\n        }\n        if (this.owner.selection.caret.style.display !== 'none') {\n            this.owner.selection.caret.style.display = 'none';\n        }\n        this.owner.dialog2.header = localValue.getConstant('Table Properties');\n        this.owner.dialog2.position = { X: 'center', Y: 'center' };\n        this.owner.dialog2.width = 'auto';\n        this.owner.dialog2.height = 'auto';\n        this.owner.dialog2.content = this.target;\n        this.owner.dialog2.beforeOpen = this.onBeforeOpen;\n        this.owner.dialog2.close = this.onCloseTablePropertyDialog;\n        this.owner.dialog2.open = this.wireEvent.bind(this);\n        this.owner.dialog2.buttons = [{\n                click: this.applyTableProperties,\n                buttonModel: { content: localValue.getConstant('Ok'), cssClass: 'e-flat e-table-ppty-okay', isPrimary: true }\n            },\n            {\n                click: this.closeTablePropertiesDialog,\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-table-ppty-cancel' }\n            }];\n        //this.tabObj.select(0);\n        this.owner.dialog2.dataBind();\n        this.owner.dialog2.show();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.calculateGridValue = function (table) {\n        table.calculateGrid();\n        table.isGridUpdated = false;\n        table.buildTableColumns();\n        table.isGridUpdated = true;\n        this.owner.selection.owner.isLayoutEnabled = true;\n        this.owner.layout.reLayoutTable(table);\n        this.owner.owner.editorModule.reLayout(this.owner.selection);\n        this.owner.owner.editorModule.updateSelectionTextPosition(true);\n        var history = this.owner.owner.editorHistory;\n        if (history && history.currentBaseHistoryInfo) {\n            if (history.currentBaseHistoryInfo.modifiedProperties.length > 0) {\n                history.currentBaseHistoryInfo.updateSelection();\n            }\n            history.updateHistory();\n        }\n        this.owner.owner.editorModule.fireContentChange();\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.loadTableProperties = function () {\n        this.setTableProperties();\n        this.setTableRowProperties();\n        this.setTableCellProperties();\n        if (!this.owner.owner.bordersAndShadingDialogModule) {\n            this.bordersAndShadingButton.disabled = true;\n        }\n        else {\n            this.bordersAndShadingButton.disabled = false;\n        }\n        // if (!this.owner.owner.tableOptionsDialogModule) {\n        //     this.tableOptionButton.disabled = true;\n        // } else {\n        this.tableOptionButton.disabled = false;\n        // }\n        // if (!this.owner.owner.cellOptionsDialogModule) {\n        //     this.cellOptionButton.disabled = true;\n        // } else {\n        this.cellOptionButton.disabled = false;\n        // }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.wireEvent = function () {\n        this.owner.selection.hideCaret();\n        //Table Format\n        this.preferCheckBox.change = this.changeTableCheckBox.bind(this);\n        this.tableWidthBox.change = this.onTableWidthChange.bind(this);\n        this.tableWidthType.change = this.onTableWidthTypeChange.bind(this);\n        this.leftIndentBox.change = this.onLeftIndentChange.bind(this);\n        //Row Format\n        this.rowHeightCheckBox.change = this.changeTableRowCheckBox.bind(this);\n        this.rowHeightBox.change = this.onRowHeightChange.bind(this);\n        this.rowHeightType.change = this.onRowHeightTypeChange.bind(this);\n        this.allowRowBreak.change = this.onAllowBreakAcrossPage.bind(this);\n        this.repeatHeader.change = this.onRepeatHeader.bind(this);\n        //Cell Format\n        this.preferredCellWidthCheckBox.change = this.changeTableCellCheckBox.bind(this);\n        this.cellWidthBox.change = this.onCellWidthChange.bind(this);\n        this.cellWidthType.change = this.onCellWidthTypeChange.bind(this);\n    };\n    //#region Table Format\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    TablePropertiesDialog.prototype.initTableProperties = function (element, localValue) {\n        var container = createElement('div', { id: element.id + '_table_TabContainer' });\n        var sizeHeader = createElement('div', {\n            id: container.id + '_sizeLabel', innerHTML: localValue.getConstant('Size'),\n            styles: 'width:100%;margin:0px;padding-top: 20px;padding-bottom: 0px;', className: 'e-de-table-dialog-options-label'\n        });\n        var parentContainer = createElement('div', { styles: 'display: inline-flex;' });\n        var childContainer1 = createElement('div', {\n            styles: 'float: left;',\n            className: 'e-de-table-container-div'\n        });\n        var childContainer2 = createElement('div', {\n            className: 'e-de-table-ppty-dlg-preferred-width-div'\n        });\n        var child1 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-measure-div'\n        });\n        var child2 = createElement('div', {\n            styles: 'display: inline;position: absolute;',\n            className: 'e-de-table-ppty-dlg-measure-drop-down-div'\n        });\n        var childContainer3 = createElement('div');\n        var preferCheckBox = createElement('input', {\n            id: element.id + '_Prefer_Width_CheckBox', attrs: { 'type': 'checkbox' }\n        });\n        this.preferredWidth = createElement('input', { id: element.id + 'preferred_Width' });\n        var controlDiv = createElement('div');\n        var tableWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') +\n                '</option><option>' + localValue.getConstant('Percent') + '</option>', id: element.id + '_width_dropdown'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'), styles: 'width: 60px;font-size: 11px; font-weight: normal;'\n        });\n        var alignmentHeader = createElement('div', {\n            innerHTML: localValue.getConstant('Alignment'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;margin: 0px;padding-bottom: 15px'\n        });\n        var alignmentContainer = createElement('div', { styles: 'height:70px;' });\n        var classDivName = element.id + 'e-de-table-alignment';\n        var leftAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.left = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment e-de-table-left-alignment ' + classDivName,\n            id: element.id + '_left_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        leftAlignDiv.appendChild(this.left);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.center = createElement('div', {\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-center-alignment ' + classDivName,\n            id: element.id + '_center_alignment', styles: 'width:54px;height:54px;margin:2px'\n        });\n        centerAlignDiv.appendChild(this.center);\n        this.right = createElement('div', {\n            styles: 'width:54px;height:54px;margin:2px', id: element.id + '_right_alignment',\n            className: 'e-icons e-de-table-properties-alignment  e-de-table-right-alignment ' + classDivName\n        });\n        var rightAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        rightAlignDiv.appendChild(this.right);\n        var leftlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Left'), className: 'e-de-table-dia-align-label'\n        });\n        var centerlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var rightlabel = createElement('label', {\n            innerHTML: localValue.getConstant('Right'), className: 'e-de-table-dia-align-label'\n        });\n        var leftIndenetContainer = createElement('div', {\n            className: 'e-de-table-ppty-dlg-left-indent-container'\n        });\n        var leftIndentLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Indent from left'),\n            styles: 'font-weight: normal;font-size: 11px;float:right;margin-right:121px;'\n        });\n        var leftIndentBox = createElement('div', {\n            styles: 'margin-top: 27px;'\n        });\n        this.leftIndent = createElement('input', { id: element.id + '_left_indent' });\n        var tableOptionContiner = createElement('div', {\n            className: 'e-de-tbl-dlg-border-btn'\n        });\n        this.bordersAndShadingButton = createElement('button', {\n            innerHTML: localValue.getConstant('Borders and Shading'),\n            id: element.id + '_borders_and_shadings', className: 'e-control e-btn e-flat e-de-ok-button'\n        });\n        this.tableOptionButton = createElement('button', {\n            className: 'e-control e-btn e-flat', innerHTML: localValue.getConstant('Options'),\n            id: element.id + '_table_cellmargin'\n        });\n        this.tableOptionButton.addEventListener('click', this.showTableOptionsDialog);\n        this.bordersAndShadingButton.addEventListener('click', this.showBordersShadingsPropertiesDialog);\n        tableOptionContiner.appendChild(this.bordersAndShadingButton);\n        tableOptionContiner.appendChild(this.tableOptionButton);\n        leftIndenetContainer.appendChild(leftIndentLabel);\n        leftIndentBox.appendChild(this.leftIndent);\n        leftIndenetContainer.appendChild(leftIndentBox);\n        alignmentContainer.appendChild(leftAlignDiv);\n        alignmentContainer.appendChild(centerAlignDiv);\n        alignmentContainer.appendChild(rightAlignDiv);\n        leftAlignDiv.appendChild(leftlabel);\n        centerAlignDiv.appendChild(centerlabel);\n        rightAlignDiv.appendChild(rightlabel);\n        alignmentContainer.appendChild(leftIndenetContainer);\n        container.appendChild(sizeHeader);\n        element.appendChild(container);\n        childContainer1.appendChild(preferCheckBox);\n        parentContainer.appendChild(childContainer1);\n        childContainer2.appendChild(this.preferredWidth);\n        parentContainer.appendChild(childContainer2);\n        controlDiv.appendChild(tableWidthType);\n        child1.appendChild(labeltext);\n        child2.appendChild(controlDiv);\n        childContainer3.appendChild(child1);\n        childContainer3.appendChild(child2);\n        parentContainer.appendChild(childContainer3);\n        element.appendChild(parentContainer);\n        element.appendChild(alignmentHeader);\n        element.appendChild(alignmentContainer);\n        element.appendChild(tableOptionContiner);\n        this.tableWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.tableWidthBox.appendTo(this.preferredWidth);\n        this.leftIndentBox = new NumericTextBox({\n            value: 0, decimals: 2, min: -1584, max: 1584, width: 140, enablePersistence: false\n        });\n        this.leftIndentBox.appendTo(this.leftIndent);\n        this.preferCheckBox = new CheckBox({\n            label: localValue.getConstant('Preferred Width')\n        });\n        this.preferCheckBox.appendTo(preferCheckBox);\n        this.tableWidthType = new DropDownList({ width: '120px' });\n        this.tableWidthType.appendTo(tableWidthType);\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthChange = function () {\n        this.tableFormat.preferredWidth = this.tableWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onTableWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var width = HelperMethods.convertPixelToPoint(this.owner.clientArea.width);\n        if (this.tableWidthType.text === 'Percent' && this.owner.selection.tableFormat.preferredWidthType !== 'Percent') {\n            value = this.tableWidthBox.value / width * 100;\n            this.formatNumericTextBox(this.tableWidthBox, 'Percent', value);\n        }\n        else if (this.tableWidthType.text === 'Points' && this.owner.selection.tableFormat.preferredWidthType !== 'Point') {\n            value = width / 100 * this.tableWidthBox.value;\n            this.formatNumericTextBox(this.tableWidthBox, 'Point', value);\n        }\n        else {\n            if (this.tableWidthBox.format === '#\\'\\%\\'') {\n                if (this.tableWidthType.text === 'Points') {\n                    value = width / 100 * this.tableWidthBox.value;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            else {\n                if (this.tableWidthType.text === 'Percent') {\n                    value = this.tableWidthBox.value / width * 100;\n                }\n                else {\n                    value = this.tableWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.tableWidthBox, (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text, value);\n        }\n        this.tableFormat.preferredWidthType = (this.tableWidthType.text === 'Points') ? 'Point' : this.tableWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onLeftIndentChange = function () {\n        this.tableFormat.leftIndent = this.leftIndentBox.value;\n    };\n    TablePropertiesDialog.prototype.setTableProperties = function () {\n        //instance of Table Property values\n        var tableFormat = this.owner.selection.tableFormat;\n        var tableHasWidth = tableFormat.preferredWidth > 0;\n        var preferredWidth = tableFormat.preferredWidth;\n        if (isNullOrUndefined(tableFormat.preferredWidth)) {\n            this.preferCheckBox.indeterminate = true;\n            var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n            var table = startTable.combineWidget(this.owner);\n            preferredWidth = table.tableFormat.preferredWidth;\n        }\n        else {\n            this.preferCheckBox.checked = tableHasWidth;\n        }\n        this.tableWidthBox.enabled = tableHasWidth;\n        this.tableWidthType.enabled = tableHasWidth;\n        this.formatNumericTextBox(this.tableWidthBox, tableFormat.preferredWidthType, preferredWidth);\n        if (tableFormat.preferredWidthType === 'Auto' || tableFormat.preferredWidthType === 'Point') {\n            this.tableWidthType.index = 0;\n        }\n        else {\n            this.tableWidthType.index = 1;\n        }\n        this.leftIndentBox.value = tableFormat.leftIndent;\n        this.leftIndentBox.enabled = tableFormat.tableAlignment === 'Left';\n        classList(this.left, [], ['e-de-table-alignment-active']);\n        classList(this.right, [], ['e-de-table-alignment-active']);\n        classList(this.center, [], ['e-de-table-alignment-active']);\n        if (tableFormat.tableAlignment === 'Left') {\n            this.left.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Center') {\n            this.center.classList.add('e-de-table-alignment-active');\n        }\n        else if (tableFormat.tableAlignment === 'Right') {\n            this.right.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getTableAlignment = function () {\n        var id = this.tableTab.id;\n        var groupButtons = this.tableTab.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Left';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Right';\n                }\n            }\n        }\n        return undefined;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForAlignmentProperties = function (element) {\n        var id = element.id;\n        var groupButtons = element.getElementsByClassName(id + 'e-de-table-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                classList(groupButton, ['e-de-table-properties-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    //#endregion\n    //#region Row Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableRowProperties = function (element, localValue) {\n        var rowDiv = createElement('div', { styles: 'width: 100%;' });\n        var sizeLabeldiv = createElement('div', {\n            innerHTML: localValue.getConstant('Size'),\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var parentDiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childDiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-header-div'\n        });\n        var rowHeightCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_height_CheckBox'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-row-ht-top'\n        });\n        this.rowHeight = createElement('input', {\n            attrs: { 'type': 'text' }, 'id': element.id + '_table_row_height'\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-row-height-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var rowHeightType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('At least')\n                + '</option><option>' + localValue.getConstant('Exactly') + '</option>',\n            id: element.id + '_height_type'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Row height is'), styles: 'font-size: 11px;font-weight: normal;width: 75px;'\n        });\n        rowDiv.appendChild(sizeLabeldiv);\n        element.appendChild(rowDiv);\n        childDiv1.appendChild(rowHeightCheckBox);\n        parentDiv.appendChild(childDiv1);\n        childdiv2.appendChild(this.rowHeight);\n        parentDiv.appendChild(childdiv2);\n        controlDiv.appendChild(rowHeightType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentDiv.appendChild(child2);\n        element.appendChild(parentDiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Options'), styles: 'width: 100%;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        // tslint:disable-next-line:max-line-length\n        var allowRowContainer = createElement('div', { className: 'e-de-table-ppty-options-break' });\n        var repeatHeaderContaniner = createElement('div', { className: 'e-de-table-ppty-options-header-row' });\n        var allowRowBreak = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_allow_row_break'\n        });\n        var repeatHeader = createElement('input', {\n            attrs: { 'type': 'checkbox' }, 'id': element.id + '_repeat_header'\n        });\n        allowRowContainer.appendChild(allowRowBreak);\n        repeatHeaderContaniner.appendChild(repeatHeader);\n        element.appendChild(alignmentDiv);\n        element.appendChild(allowRowContainer);\n        element.appendChild(repeatHeaderContaniner);\n        this.rowHeightBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.rowHeightBox.appendTo(this.rowHeight);\n        this.rowHeightCheckBox = new CheckBox({\n            label: localValue.getConstant('Specify height')\n        });\n        this.rowHeightCheckBox.appendTo(rowHeightCheckBox);\n        this.rowHeightType = new DropDownList({ width: '120px' });\n        this.rowHeightType.appendTo(rowHeightType);\n        this.allowRowBreak = new CheckBox({\n            label: localValue.getConstant('Allow row to break across pages')\n        });\n        this.allowRowBreak.appendTo(allowRowBreak);\n        this.repeatHeader = new CheckBox({\n            label: localValue.getConstant('Repeat as header row at the top of each page')\n        });\n        this.repeatHeader.appendTo(repeatHeader);\n    };\n    TablePropertiesDialog.prototype.setTableRowProperties = function () {\n        var rowFormat = this.owner.selection.rowFormat;\n        var enableRowHeight = (rowFormat.height > 0 || rowFormat.heightType === 'Exactly');\n        //instance of table row values\n        if (enableRowHeight) {\n            this.rowHeightCheckBox.checked = true;\n        }\n        else {\n            if (rowFormat.heightType === undefined) {\n                this.rowHeightCheckBox.indeterminate = true;\n                enableRowHeight = true;\n            }\n            else {\n                this.rowHeightCheckBox.checked = false;\n            }\n        }\n        this.rowHeightBox.enabled = enableRowHeight;\n        this.rowHeightType.enabled = enableRowHeight;\n        // let enabledHeader: boolean = this.enableRepeatHeader() ? false : true;\n        var enabledHeader = true;\n        if (isNullOrUndefined(this.owner.selection.rowFormat.isHeader)) {\n            this.repeatHeader.indeterminate = true;\n            this.repeatHeader.disabled = true;\n        }\n        else if (this.owner.selection.rowFormat.isHeader) {\n            this.repeatHeader.checked = !enabledHeader;\n            this.repeatHeader.indeterminate = enabledHeader;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        else {\n            this.repeatHeader.checked = false;\n            this.repeatHeader.indeterminate = false;\n            this.repeatHeader.disabled = enabledHeader;\n        }\n        if (isNullOrUndefined(rowFormat.allowBreakAcrossPages)) {\n            this.allowRowBreak.indeterminate = true;\n        }\n        else {\n            this.allowRowBreak.checked = rowFormat.allowBreakAcrossPages;\n        }\n        this.rowHeightBox.value = rowFormat.height;\n        if (rowFormat.heightType === 'Auto' || rowFormat.heightType === 'AtLeast') {\n            this.rowHeightType.index = 0;\n        }\n        else {\n            this.rowHeightType.index = 1;\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightChange = function () {\n        this.rowHeightValue = this.rowHeightBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRowHeightTypeChange = function () {\n        this.rowFormat.heightType = this.rowHeightType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onAllowBreakAcrossPage = function () {\n        this.rowFormat.allowBreakAcrossPages = this.allowRowBreak.checked;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onRepeatHeader = function () {\n        this.rowFormat.isHeader = this.repeatHeader.checked;\n    };\n    /**\n     * @private\n     */\n    // public enableRepeatHeader(): boolean {\n    //     let isFirstRow: number = 0;\n    //     for (let i: number = 0; i < this.owner.selection.selectionRanges.length; i++) {\n    //         let range: SelectionRange = this.owner.selection.selectionRanges.getRange(i);\n    //         let table: WTable = range.start.paragraph.associatedCell.ownerTable;\n    //         if (table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0 ||\n    //             table.childNodes.indexOf(range.start.paragraph.associatedCell.ownerRow) === 0) {\n    //             isFirstRow++;\n    //         }\n    //     }\n    //     return isFirstRow === this.owner.selection.selectionRanges.length;\n    // }\n    //#endregion\n    //#region Cell Format\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.initTableCellProperties = function (element, localValue) {\n        var sizeDiv = createElement('div', { styles: 'width: 100%;' });\n        var div = createElement('div', {\n            innerHTML: localValue.getConstant('Size'), className: 'e-de-table-dialog-options-label',\n            styles: 'width: 100%;padding-top: 20px;padding-bottom: 10px;',\n        });\n        var parentdiv = createElement('div', { styles: 'display: inline;width: 100%;' });\n        var childdiv1 = createElement('div', {\n            styles: 'display: inline;float: left;',\n            className: 'e-de-table-cell-header-div'\n        });\n        var preferredCellWidthCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: element.id + '_Prefer_Width_CheckBox_cell'\n        });\n        var childdiv2 = createElement('div', {\n            styles: 'display: inline-block;',\n            className: 'e-de-cell-width-top'\n        });\n        this.preferredCellWidth = createElement('input', {\n            id: element.id + 'tablecell_Width_textBox', attrs: { 'type': 'text' }\n        });\n        var child2 = createElement('div', {\n            styles: 'float: right;display: inline;width: auto;margin-top: 5px;'\n        });\n        var child3 = createElement('div', {\n            styles: 'display: inline;',\n            className: 'e-de-table-ppty-dlg-cell-tab-measure-label'\n        });\n        var child4 = createElement('div', {\n            styles: 'display: inline;float: right;', className: 'e-de-table-cell-subheader-div'\n        });\n        var controlDiv = createElement('div');\n        var cellWidthType = createElement('select', {\n            innerHTML: '<option>' + localValue.getConstant('Points') + '</option><option>' +\n                localValue.getConstant('Percent') + '</option>', 'id': element.id + '_measure_type_cell'\n        });\n        var labeltext = createElement('label', {\n            innerHTML: localValue.getConstant('Measure in'),\n            styles: 'font-size: 11px;font-weight: normal;'\n        });\n        sizeDiv.appendChild(div);\n        element.appendChild(sizeDiv);\n        childdiv1.appendChild(preferredCellWidthCheckBox);\n        parentdiv.appendChild(childdiv1);\n        childdiv2.appendChild(this.preferredCellWidth);\n        parentdiv.appendChild(childdiv2);\n        controlDiv.appendChild(cellWidthType);\n        child3.appendChild(labeltext);\n        child4.appendChild(controlDiv);\n        child2.appendChild(child3);\n        child2.appendChild(child4);\n        parentdiv.appendChild(child2);\n        element.appendChild(parentdiv);\n        var alignmentDiv = createElement('div', {\n            innerHTML: localValue.getConstant('Vertical alignment'),\n            styles: 'width: 100%;margin: 0px;',\n            className: 'e-de-table-dialog-options-label'\n        });\n        var classDivName = element.id + 'e-de-table-cell-alignment';\n        var divAlignment = createElement('div', {\n            styles: 'width: 100%;height: 100px;'\n        });\n        var divStyle = 'width:54px;height:54px;margin:2px;border-style:solid;border-width:1px';\n        var topAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellTopAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_top-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment ' + classDivName\n        });\n        topAlignDiv.appendChild(this.cellTopAlign);\n        var centerAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellCenterAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_center-alignment',\n            className: 'e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment ' + classDivName\n        });\n        centerAlignDiv.appendChild(this.cellCenterAlign);\n        var bottomAlignDiv = createElement('div', { className: 'e-de-table-dia-align-div' });\n        this.cellBottomAlign = createElement('div', {\n            styles: divStyle, id: element.id + '_cell_bottom-alignment',\n            className: 'e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  ' + classDivName\n        });\n        bottomAlignDiv.appendChild(this.cellBottomAlign);\n        var topLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Top'), className: 'e-de-table-dia-align-label'\n        });\n        var centerLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Center'), className: 'e-de-table-dia-align-label'\n        });\n        var bottomLabel = createElement('label', {\n            innerHTML: localValue.getConstant('Bottom'), className: 'e-de-table-dia-align-label'\n        });\n        this.cellOptionButton = createElement('button', {\n            innerHTML: localValue.getConstant('Options'), id: element.id + '_table_cellmargin',\n            className: 'e-de-tbl-dlg-op-btn e-control e-btn e-flat e-de-cell-options',\n        });\n        divAlignment.appendChild(topAlignDiv);\n        divAlignment.appendChild(centerAlignDiv);\n        divAlignment.appendChild(bottomAlignDiv);\n        topAlignDiv.appendChild(topLabel);\n        centerAlignDiv.appendChild(centerLabel);\n        bottomAlignDiv.appendChild(bottomLabel);\n        element.appendChild(alignmentDiv);\n        element.appendChild(divAlignment);\n        element.appendChild(this.cellOptionButton);\n        this.cellOptionButton.addEventListener('click', this.showCellOptionsDialog);\n        this.cellWidthBox = new NumericTextBox({\n            value: 0, decimals: 2, min: 0, max: 1584, width: 120, enablePersistence: false\n        });\n        this.cellWidthBox.appendTo(this.preferredCellWidth);\n        this.preferredCellWidthCheckBox = new CheckBox({ label: localValue.getConstant('Preferred Width') });\n        this.preferredCellWidthCheckBox.appendTo(preferredCellWidthCheckBox);\n        this.cellWidthType = new DropDownList({ width: '120px' });\n        this.cellWidthType.appendTo(cellWidthType);\n    };\n    TablePropertiesDialog.prototype.setTableCellProperties = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        //instance of table cell Values\n        this.hasCellWidth = cellFormat.preferredWidth > 0;\n        var preferredWidth = cellFormat.preferredWidth;\n        if (isNullOrUndefined(cellFormat.preferredWidth)) {\n            this.preferredCellWidthCheckBox.indeterminate = true;\n            preferredWidth = this.owner.selection.start.paragraph.associatedCell.cellFormat.preferredWidth;\n        }\n        else {\n            this.preferredCellWidthCheckBox.checked = this.hasCellWidth;\n        }\n        this.cellWidthBox.enabled = this.hasCellWidth;\n        this.cellWidthType.enabled = this.hasCellWidth;\n        if (cellFormat.preferredWidthType === 'Auto' || cellFormat.preferredWidthType === 'Point') {\n            this.cellWidthType.index = 0;\n        }\n        else {\n            this.cellWidthType.index = 1;\n        }\n        this.formatNumericTextBox(this.cellWidthBox, cellFormat.preferredWidthType, preferredWidth);\n        classList(this.cellTopAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellCenterAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        classList(this.cellBottomAlign, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n        if (cellFormat.verticalAlignment === 'Top') {\n            this.cellTopAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Center') {\n            this.cellCenterAlign.classList.add('e-de-table-alignment-active');\n        }\n        else if (cellFormat.verticalAlignment === 'Bottom') {\n            this.cellBottomAlign.classList.add('e-de-table-alignment-active');\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.updateClassForCellAlignment = function (element) {\n        var cellAlignments = element.getElementsByClassName(element.id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < cellAlignments.length; j++) {\n            var cellAlignment = cellAlignments[j];\n            if (cellAlignment.classList.contains('e-de-table-alignment-active')) {\n                classList(cellAlignment, ['e-de-tablecell-alignment'], ['e-de-table-alignment-active']);\n            }\n        }\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.formatNumericTextBox = function (textBox, format, value) {\n        if (format === 'Auto' || format === 'Point') {\n            textBox.format = 'n2';\n        }\n        else {\n            textBox.format = '#\\'\\%\\'';\n        }\n        textBox.step = 1;\n        textBox.decimals = 2;\n        textBox.value = value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.getCellAlignment = function () {\n        var id = this.cellTab.id;\n        var groupButtons = this.cellTab.getElementsByClassName(id + 'e-de-table-cell-alignment');\n        for (var j = 0; j < groupButtons.length; j++) {\n            var groupButton = groupButtons[j];\n            if (groupButton.classList.contains('e-de-table-alignment-active')) {\n                if (j === 0) {\n                    return 'Top';\n                }\n                else if (j === 1) {\n                    return 'Center';\n                }\n                else {\n                    return 'Bottom';\n                }\n            }\n        }\n        return this.owner.selection.cellFormat.verticalAlignment;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthChange = function () {\n        this.cellFormat.preferredWidth = this.cellWidthBox.value;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.onCellWidthTypeChange = function () {\n        var value;\n        var table = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        var containerWidth = table.getOwnerWidth(true);\n        var tableWidth = table.getTableClientWidth(containerWidth);\n        if (this.cellWidthType.text === 'Percent' && this.owner.selection.cellFormat.preferredWidthType !== 'Percent') {\n            value = this.cellWidthBox.value / tableWidth * 100;\n            this.formatNumericTextBox(this.cellWidthBox, 'Percent', value);\n        }\n        else if (this.cellWidthType.text === 'Points' && this.owner.selection.cellFormat.preferredWidthType !== 'Point') {\n            value = tableWidth / 100 * this.cellWidthBox.value;\n            this.formatNumericTextBox(this.cellWidthBox, 'Point', value);\n        }\n        else {\n            if (this.cellWidthBox.format === '#\\'\\%\\'') {\n                if (this.cellWidthType.text === 'Points') {\n                    value = tableWidth / 100 * this.cellWidthBox.value;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            else {\n                if (this.cellWidthType.text === 'Percent') {\n                    value = this.cellWidthBox.value / tableWidth * 100;\n                }\n                else {\n                    value = this.cellWidthBox.value;\n                }\n            }\n            // tslint:disable-next-line:max-line-length\n            this.formatNumericTextBox(this.cellWidthBox, (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text, value);\n        }\n        this.cellFormat.preferredWidthType = (this.cellWidthType.text === 'Points') ? 'Point' : this.cellWidthType.text;\n    };\n    /**\n     * @private\n     */\n    TablePropertiesDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var s = 0; s < this.target.childNodes.length; s++) {\n                this.target.removeChild(this.target.childNodes[s]);\n                s--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.cellAlignment = undefined;\n        this.tableAlignment = undefined;\n        this.owner = undefined;\n        this.preferCheckBox = undefined;\n        this.tableWidthType = undefined;\n        this.preferredWidth = undefined;\n        this.rowHeightType = undefined;\n        this.rowHeightCheckBox = undefined;\n        this.rowHeight = undefined;\n        this.cellWidthType = undefined;\n        this.preferredCellWidthCheckBox = undefined;\n        this.preferredCellWidth = undefined;\n        this.tableTab = undefined;\n        this.rowTab = undefined;\n        this.cellTab = undefined;\n        this.left = undefined;\n        this.center = undefined;\n        this.right = undefined;\n        this.leftIndent = undefined;\n        this.allowRowBreak = undefined;\n        this.repeatHeader = undefined;\n        this.cellTopAlign = undefined;\n        this.cellCenterAlign = undefined;\n        this.cellBottomAlign = undefined;\n        this.tableFormat.destroy();\n        this.cellFormat.destroy();\n        this.tableFormat = undefined;\n        this.cellFormat = undefined;\n    };\n    return TablePropertiesDialog;\n}());\nexport { TablePropertiesDialog };\n","import { createElement, isNullOrUndefined, L10n, setCulture } from '@syncfusion/ej2-base';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat, WBorder, WBorders, WShading, WCellFormat } from '../format/index';\nimport { DropDownList } from '@syncfusion/ej2-dropdowns';\nimport { ColorPicker } from '@syncfusion/ej2-inputs';\n/**\n * The Borders and Shading dialog is used to modify borders and shading options for selected table or cells.\n */\nvar BordersAndShadingDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function BordersAndShadingDialog(viewer) {\n        var _this = this;\n        this.cellFormat = new WCellFormat();\n        this.tableFormat = new WTableFormat();\n        this.applyBordersShadingsProperties = function () {\n            var tablePropertiesDialog = _this.owner.owner.tablePropertiesDialogModule;\n            var selectedCell = _this.owner.selection.start.paragraph.associatedCell;\n            //Need to bind the properties with current cell and current table formats.\n            var borders = undefined;\n            if (_this.checkClassName(_this.previewDivTopTop) || _this.checkClassName(_this.previewDivTopBottom)\n                || _this.checkClassName(_this.previewDivTopCenter) || _this.checkClassName(_this.previewDivBottomcenter)\n                || _this.checkClassName(_this.previewDivBottomLeft) || _this.checkClassName(_this.previewDivBottomRight)\n                || _this.checkClassName(_this.previewDivDiagonalRight) || _this.checkClassName(_this.previewDivLeftDiagonal)) {\n                borders = new WBorders();\n                if (_this.checkClassName(_this.previewDivTopTop)) {\n                    borders.top = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopBottom)) {\n                    borders.bottom = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomLeft)) {\n                    borders.left = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomRight)) {\n                    borders.right = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivTopCenter)) {\n                    borders.horizontal = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivBottomcenter)) {\n                    borders.vertical = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivLeftDiagonal)) {\n                    borders.diagonalDown = _this.getBorder();\n                }\n                if (_this.checkClassName(_this.previewDivDiagonalRight)) {\n                    borders.diagonalUp = _this.getBorder();\n                }\n            }\n            var shading = new WShading();\n            var editorModule = _this.owner.owner.editorModule;\n            shading.backgroundColor = _this.shadingColorPicker.value;\n            if (_this.ulelementShading.index === 0) {\n                _this.applyTo = 0;\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isCellBordersAndShadingUpdated = true;\n                }\n                _this.cellFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.cellFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(selectedCell.cellFormat.shading)) {\n                    shading.foregroundColor = selectedCell.cellFormat.shading.foregroundColor;\n                    shading.textureStyle = selectedCell.cellFormat.shading.textureStyle;\n                }\n                _this.cellFormat.shading = new WShading();\n                editorModule.applyShading(_this.cellFormat.shading, shading);\n            }\n            else {\n                if (tablePropertiesDialog) {\n                    tablePropertiesDialog.isTableBordersAndShadingUpdated = true;\n                }\n                _this.applyTo = 1;\n                var currentTableFormat = _this.owner.owner.selection.tableFormat.table.tableFormat;\n                _this.tableFormat.copyFormat(currentTableFormat);\n                _this.tableFormat.borders = new WBorders();\n                if (!isNullOrUndefined(borders)) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, borders);\n                }\n                else if (_this.noneDiv.classList.contains('e-de-table-border-inside-setting-click')) {\n                    editorModule.applyBordersInternal(_this.tableFormat.borders, new WBorders());\n                }\n                // Once option has been added for texture and foreground, need to handle this similar to Shading Fill.\n                if (!isNullOrUndefined(currentTableFormat.shading)) {\n                    shading.foregroundColor = currentTableFormat.shading.foregroundColor;\n                    shading.textureStyle = currentTableFormat.shading.textureStyle;\n                }\n                _this.tableFormat.shading = new WShading();\n                editorModule.applyShading(_this.tableFormat.shading, shading);\n            }\n            _this.applyFormat();\n            _this.closeDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeDialog = function () {\n            _this.owner.dialog.hide();\n            _this.closeBordersShadingsDialog();\n        };\n        this.closeBordersShadingsDialog = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.handleSettingCheckBoxAction = function (event) {\n            var targetId = event.target.id;\n            var tableBorderDialogId = _this.target.id;\n            var targetDiv;\n            if (targetId === tableBorderDialogId + '_None_Div' || targetId === tableBorderDialogId + '_None_Div_Container'\n                || targetId === tableBorderDialogId + '_None_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('none');\n            }\n            else if (targetId === tableBorderDialogId + '_Box_Div' || targetId === tableBorderDialogId + '_Box_Div_Container'\n                || targetId === tableBorderDialogId + '_Box_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('box');\n            }\n            else if (targetId === tableBorderDialogId + '_All_Div' || targetId === tableBorderDialogId + '_All_Div_Container'\n                || targetId === tableBorderDialogId + '_All_Div_Transparent') {\n                _this.updateClassForSettingDivElements();\n                _this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('all');\n            }\n            else {\n                _this.updateClassForSettingDivElements();\n                _this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                _this.setSettingPreviewDivElement('customDiv');\n            }\n        };\n        this.handlePreviewCheckBoxAction = function (event) {\n            var target = event.target;\n            var targetId = target.id;\n            var tableBorderDialog = _this.target;\n            var tableBorderDialogId = _this.target.id;\n            var checkBox;\n            var compareClass = 'e-de-table-border-inside-preview-click';\n            _this.customDiv.click();\n            if (targetId === tableBorderDialogId + '_Preview_Div_TopTop_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopTop'\n                || targetId === tableBorderDialogId + '_previewDivTopTopTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopTop);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopTop', 'TopTop');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_TopCenter'\n                || targetId === tableBorderDialogId + '_previewDivTopCenterTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopCenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Horizontal', '_Preview_Div_TopCenter', 'TopCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_TopBottom_Container' || targetId === tableBorderDialogId + '_Preview_Div_TopBottom'\n                || targetId === tableBorderDialogId + '_previewDivTopBottomTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivTopBottom);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_TopBottom', 'TopBottom');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_LeftDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivLeftDiagonalTransParent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivLeftDiagonal);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Left_Diagonal', '_Preview_Div_LeftDiagonal', 'LeftDiagonal');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomLeft_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomLeft'\n                || targetId === tableBorderDialogId + '_previewDivBottomLeftTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomLeft);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomLeft', 'BottomLeft');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomCenter_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_BottomCenter'\n                || targetId === tableBorderDialogId + '_previewDivBottomcenterTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomcenter);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Vertical', '_Preview_Div_BottomCenter', 'BottomCenter');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_BottomRight_Container' || targetId === tableBorderDialogId + '_Preview_Div_BottomRight'\n                || targetId === tableBorderDialogId + '_previewDivBottomRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivBottomRight);\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div', '_Preview_Div_BottomRight', 'BottomRight');\n            }\n            else if (targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal_Container'\n                || targetId === tableBorderDialogId + '_Preview_Div_RightDiagonal'\n                || targetId === tableBorderDialogId + '_previewDivDiagonalRightTransparent') {\n                _this.handlePreviewCheckBoxShowHide(tableBorderDialogId, compareClass, _this.previewDivDiagonalRight);\n                // tslint:disable-next-line:max-line-length\n                _this.showHidePreviewDivElements(tableBorderDialogId, compareClass, '_Preview_Div_Right_Diagonal', '_Preview_Div_RightDiagonal', 'RightDiagonal');\n            }\n        };\n        this.applyTableCellPreviewBoxes = function () {\n            _this.customDiv.click();\n            if (!isNullOrUndefined(_this.ulelementShading)) {\n                if (_this.ulelementShading.index === 0) {\n                    _this.previewDivBottomcenterContainer.style.display = 'none';\n                    _this.previewDivTopCenterContainer.style.display = 'none';\n                    _this.previewVerticalDiv.style.display = 'none';\n                    _this.previewHorizontalDiv.style.display = 'none';\n                    _this.previewDivLeftDiagonal.style.display = '';\n                    _this.previewDivDiagonalRight.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '80px';\n                }\n                else {\n                    _this.previewDivLeftDiagonal.style.display = 'none';\n                    _this.previewDivDiagonalRight.style.display = 'none';\n                    _this.previewDivBottomcenterContainer.style.display = '';\n                    _this.previewDivTopCenterContainer.style.display = '';\n                    _this.previewVerticalDiv.style.display = '';\n                    _this.previewHorizontalDiv.style.display = '';\n                    _this.previewDivBottomRightContainer.style.left = '110px';\n                }\n            }\n        };\n        this.applyPreviewTableBackgroundColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.backgroundColor = color;\n            }\n        };\n        this.applyPreviewTableBorderColor = function (args) {\n            if (!isNullOrUndefined(args.currentValue)) {\n                var color = args.currentValue.hex;\n                _this.previewDiv.style.borderColor = color;\n                _this.previewRightDiagonalDiv.style.backgroundColor = color;\n                _this.previewLeftDiagonalDiv.style.backgroundColor = color;\n                _this.previewVerticalDiv.style.backgroundColor = color;\n                _this.previewHorizontalDiv.style.backgroundColor = color;\n            }\n        };\n        this.owner = viewer;\n    }\n    BordersAndShadingDialog.prototype.getModuleName = function () {\n        return 'BordersAndShadingDialog';\n    };\n    /**\n     * @private\n     */\n    // tslint:disable-next-line:max-func-body-length\n    BordersAndShadingDialog.prototype.initBordersAndShadingsDialog = function (localeValue) {\n        var instance = this;\n        this.target = createElement('div', {\n            id: instance.owner.owner.containerId + '_table_border_shadings',\n            className: 'e-de-table-border-shading-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var displayText = createElement('div', {\n            innerHTML: localeValue.getConstant('Borders'), styles: 'position: absolute;top: 65px;',\n            id: this.target.id + '_border_label', className: 'e-de-table-border-heading'\n        });\n        var settingsContiner = createElement('div', {\n            styles: 'display: inline-block;position: absolute;top: 105px;width: 100px;height: 235px;border-style: none;',\n            id: this.target.id + '_border_settings'\n        });\n        var styleContainer = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 125px;top: 125px;width: 150px;height: 235px;padding-left: 40px;border-style: none;padding-right: 40px;',\n            id: this.target.id + '_border_style'\n        });\n        var previewContiner = createElement('div', {\n            // tslint:disable-next-line:max-line-length\n            styles: 'display: inline-block;position: absolute;left: 345px;top: 87px;width: 180px;height: 235px;padding: 0px;border-style: none;',\n            id: this.target.id + '_border_preview'\n        });\n        var styleText = createElement('div', {\n            innerHTML: localeValue.getConstant('Style'), styles: 'width: 100%;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var dropDownList = createElement('select', {\n            id: this.target.id + '_border_style_dropDown'\n        });\n        dropDownList.innerHTML = '<option>' + localeValue.getConstant('None') + '</option><option>'\n            + localeValue.getConstant('Single') + '</option><option>' + localeValue.getConstant('Dot') + '</option><option>'\n            + localeValue.getConstant('DashSmallGap') + '</option><option>' + localeValue.getConstant('DashLargeGap') + '</option><option>'\n            + localeValue.getConstant('DashDot') + '</option><option>' + localeValue.getConstant('DashDotDot') + '</option><option>'\n            + localeValue.getConstant('Double') + '</option><option>' + localeValue.getConstant('Triple') + '</option><option>'\n            + localeValue.getConstant('ThinThickSmallGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinSmallGap') + '</option><option>' + localeValue.getConstant('ThinThickThinSmallGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickMediumGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinMediumGap') + '</option><option>' + localeValue.getConstant('ThinThickThinMediumGap')\n            + '</option><option>' + localeValue.getConstant('ThinThickLargeGap') + '</option><option>'\n            + localeValue.getConstant('ThickThinLargeGap') + '</option><option>' + localeValue.getConstant('ThinThickThinLargeGap')\n            + '</option><option>' + localeValue.getConstant('SingleWavy') + '</option><option>'\n            + localeValue.getConstant('DoubleWavy') + '</option><option>' + localeValue.getConstant('DashDotStroked')\n            + '</option><option>' + localeValue.getConstant('Emboss3D') + '</option><option>' + localeValue.getConstant('Engrave3D')\n            + '</option><option>' + localeValue.getConstant('Outset') + '</option><option>'\n            + localeValue.getConstant('Inset') + '</option><option>' + localeValue.getConstant('Thick') + '</option>';\n        var widthText = createElement('div', {\n            innerHTML: localeValue.getConstant('Width'), styles: 'width:100%;padding-top: 20px;padding-bottom: 10px;',\n            className: 'e-de-table-element-subheading'\n        });\n        var widthNumeric = createElement('input', {\n            id: this.target.id + '_width'\n        });\n        var colorText = createElement('div', {\n            innerHTML: localeValue.getConstant('Color'), styles: 'padding-top: 25px;',\n            className: 'e-de-table-setting-heading'\n        });\n        var borderColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_border_color',\n            styles: 'width: 30px;position: absolute;left: 90px;',\n            className: 'e-dlg-clr-pkr-top'\n        });\n        var settingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Setting'), styles: 'width: 100%;position: absolute;',\n            className: 'e-de-table-setting-heading'\n        });\n        var noneDivContainer = createElement('div', {\n            id: this.target.id + '_None_Div_Container', className: 'e-de-table-border-none'\n        });\n        this.noneDiv = createElement('div', {\n            id: this.target.id + '_None_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var noneDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('None'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_None_Div_Label'\n        });\n        var boxDivContainer = createElement('div', {\n            id: this.target.id + '_Box_Div_Container', className: 'e-de-table-border-box'\n        });\n        this.boxDiv = createElement('div', {\n            id: this.target.id + '_Box_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var boxDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Box'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 20px;position: absolute;',\n            id: this.target.id + '_Box_Div_Label'\n        });\n        var allDivContainer = createElement('div', {\n            id: this.target.id + '_All_Div_Container', className: 'e-de-table-border-all'\n        });\n        this.allDiv = createElement('div', {\n            id: this.target.id + '_All_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var allDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('All'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_All_Div_Label'\n        });\n        var customDivContainer = createElement('div', {\n            id: this.target.id + '_Custom_Div_Container', className: 'e-de-table-border-custom'\n        });\n        this.customDiv = createElement('div', {\n            id: this.target.id + '_Custom_Div',\n            className: 'e-de-table-border-inside-setting e-de-table-border-setting-genral'\n        });\n        var customDivLabel = createElement('label', {\n            innerHTML: localeValue.getConstant('Custom'), className: 'e-de-table-setting-labels-heading',\n            styles: 'padding-left: 10px;top: 25px;position: absolute;',\n            id: this.target.id + '_Custom_Div_Label'\n        });\n        this.noneDivTransparent = createElement('div', {\n            id: this.target.id + '_None_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-none-setting'\n        });\n        this.boxDivTransparent = createElement('div', {\n            id: this.target.id + '_Box_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-box-setting'\n        });\n        this.allDivTransparent = createElement('div', {\n            id: this.target.id + '_All_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-all-setting'\n        });\n        this.customDivTransparent = createElement('div', {\n            id: this.target.id + '_Custom_Div_Transparent', className: 'e-icons e-de-table-border-setting e-de-table-border-custom-setting'\n        });\n        var previewText = createElement('div', {\n            innerHTML: localeValue.getConstant('Preview'), className: 'e-de-table-setting-heading',\n            styles: 'position: absolute;top: 20px;left: 10px;'\n        });\n        this.previewDiv = createElement('div', {\n            styles: 'width: 80px;height: 80px;position: absolute; left: 50px;top: 50px;',\n            id: this.target.id + '_Preview_Div', className: 'e-de-border-dlg-preview-div'\n        });\n        this.previewRightDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width:1px;height:113px;left: 90px;top: 34px;transform: rotate(135deg);',\n            id: this.target.id + '_Preview_Div_Right_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewLeftDiagonalDiv = createElement('div', {\n            styles: 'position: absolute;width: 1px;height: 113px;left: 90px;top: 34px;transform:rotate(45deg);',\n            id: this.target.id + '_Preview_Div_Left_Diagonal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewVerticalDiv = createElement('div', {\n            styles: 'width: 1px;height: 81px;position: absolute;left: 90px;top: 50px;',\n            id: this.target.id + '_Preview_Div_Vertical',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewHorizontalDiv = createElement('div', {\n            styles: 'width: 81px;height: 1px;position: absolute;left: 50px;top: 90px;',\n            id: this.target.id + '_Preview_Div_Horizontal',\n            className: 'e-de-border-dlg-preview-inside-divs'\n        });\n        this.previewDivTopTopContainer = createElement('div', {\n            styles: 'top: 50px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopTop_Container'\n        });\n        this.previewDivTopTop = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopTop',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopCenterContainer = createElement('div', {\n            styles: 'top: 80px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopCenter_Container'\n        });\n        this.previewDivTopCenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopBottomContainer = createElement('div', {\n            styles: 'top: 110px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_TopBottom_Container'\n        });\n        this.previewDivTopBottom = createElement('div', {\n            id: this.target.id + '_Preview_Div_TopBottom',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivLeftDiagonalContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 10px;', id: this.target.id + '_Preview_Div_LeftDiagonal_Container'\n        });\n        this.previewDivLeftDiagonal = createElement('div', {\n            id: this.target.id + '_Preview_Div_LeftDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomLeftContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 50px', id: this.target.id + '_Preview_Div_BottomLeft_Container'\n        });\n        this.previewDivBottomLeft = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomLeft',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomcenterContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 80px;', id: this.target.id + '_Preview_Div_BottomCenter_Container'\n        });\n        this.previewDivBottomcenter = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomCenter',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivBottomRightContainer = createElement('div', {\n            styles: 'top: 145px;position: absolute;left: 110px;', id: this.target.id + '_Preview_Div_BottomRight_Container'\n        });\n        this.previewDivBottomRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_BottomRight',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivDiagonalRightContainer = createElement('div', {\n            styles: 'top: 145px; position: absolute; left: 110px;', id: this.target.id + '_Preview_Div_RightDiagonal_Container'\n        });\n        this.previewDivDiagonalRight = createElement('div', {\n            id: this.target.id + '_Preview_Div_RightDiagonal',\n            className: 'e-de-table-border-inside-preview e-de-table-border-preview-genral'\n        });\n        this.previewDivTopTopTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopTopTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-toptop-alignment'\n        });\n        this.previewDivTopCenterTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopCenterTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment'\n        });\n        this.previewDivTopBottomTransParent = createElement('div', {\n            id: this.target.id + '_previewDivTopBottomTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment'\n        });\n        this.previewDivLeftDiagonalTransParent = createElement('div', {\n            id: this.target.id + '_previewDivLeftDiagonalTransParent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment'\n        });\n        this.previewDivBottomLeftTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomLeftTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment'\n        });\n        this.previewDivBottomcenterTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomcenterTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment'\n        });\n        this.previewDivBottomRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivBottomRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment'\n        });\n        this.previewDivDiagonalRightTransparent = createElement('div', {\n            id: this.target.id + '_previewDivDiagonalRightTransparent',\n            className: 'e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment'\n        });\n        this.shadingContiner = createElement('div', {\n            /* tslint:disable:max-line-length */\n            styles: 'display:inline-block;position:absolute;left:17px;width:400px;height:100px;padding:0px;border-style: none;margin-left:10px;',\n            id: this.target.id + '_shading_preview', className: 'e-de-table-shading-preview'\n        });\n        var shadingText = createElement('div', {\n            innerHTML: localeValue.getConstant('Shading'), className: 'e-de-table-border-heading',\n            styles: 'padding-top: 30px;left: 5px;'\n        });\n        var shadings = createElement('div', { styles: 'display:flex;' });\n        var label = createElement('div', {\n            innerHTML: localeValue.getConstant('Fill'), className: 'e-de-table-setting-heading e-de-table-border-fill',\n            styles: 'top: 50px;left: 10px;'\n        });\n        var shadingColorPickerElement = createElement('input', {\n            attrs: { 'type': 'color' },\n            id: this.target.id + '_shading_color', styles: 'position: absolute;top: 75px;left: 40px;width: 30px;'\n        });\n        var shdApply = createElement('div', {\n            styles: 'position:absolute;top:41px;left:150px;width:180px;'\n        });\n        var div = createElement('div', {\n            styles: 'width:100px;padding-bottom: 10px;', innerHTML: localeValue.getConstant('Apply To'),\n            className: 'e-de-table-element-subheading'\n        });\n        var divsion = createElement('div', { styles: 'width:100px;position:absolute;' });\n        var ulelementShading = createElement('select', {\n            innerHTML: '<option>' + localeValue.getConstant('Cell') + '</option>'\n                + '<option>' + localeValue.getConstant('Table') + '</option>',\n            id: this.target.id + '_shading'\n        });\n        divsion.appendChild(ulelementShading);\n        this.noneDiv.appendChild(this.noneDivTransparent);\n        this.boxDiv.appendChild(this.boxDivTransparent);\n        this.allDiv.appendChild(this.allDivTransparent);\n        this.customDiv.appendChild(this.customDivTransparent);\n        noneDivContainer.appendChild(this.noneDiv);\n        noneDivContainer.appendChild(noneDivLabel);\n        boxDivContainer.appendChild(this.boxDiv);\n        boxDivContainer.appendChild(boxDivLabel);\n        allDivContainer.appendChild(this.allDiv);\n        allDivContainer.appendChild(allDivLabel);\n        customDivContainer.appendChild(this.customDiv);\n        customDivContainer.appendChild(customDivLabel);\n        settingsContiner.appendChild(settingText);\n        settingsContiner.appendChild(noneDivContainer);\n        settingsContiner.appendChild(boxDivContainer);\n        settingsContiner.appendChild(allDivContainer);\n        settingsContiner.appendChild(customDivContainer);\n        this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent);\n        this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent);\n        this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent);\n        this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent);\n        this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent);\n        this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent);\n        this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent);\n        this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent);\n        this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter);\n        this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft);\n        this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight);\n        this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight);\n        this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal);\n        this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom);\n        this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter);\n        this.previewDivTopTopContainer.appendChild(this.previewDivTopTop);\n        previewContiner.appendChild(previewText);\n        previewContiner.appendChild(this.previewDiv);\n        previewContiner.appendChild(this.previewRightDiagonalDiv);\n        previewContiner.appendChild(this.previewHorizontalDiv);\n        previewContiner.appendChild(this.previewLeftDiagonalDiv);\n        previewContiner.appendChild(this.previewVerticalDiv);\n        previewContiner.appendChild(this.previewDivBottomcenterContainer);\n        previewContiner.appendChild(this.previewDivBottomLeftContainer);\n        previewContiner.appendChild(this.previewDivBottomRightContainer);\n        previewContiner.appendChild(this.previewDivDiagonalRightContainer);\n        previewContiner.appendChild(this.previewDivLeftDiagonalContainer);\n        previewContiner.appendChild(this.previewDivTopBottomContainer);\n        previewContiner.appendChild(this.previewDivTopCenterContainer);\n        previewContiner.appendChild(this.previewDivTopTopContainer);\n        shdApply.appendChild(div);\n        shdApply.appendChild(divsion);\n        shadings.appendChild(label);\n        shadings.appendChild(shadingColorPickerElement);\n        shadings.appendChild(shdApply);\n        this.shadingContiner.appendChild(shadingText);\n        this.shadingContiner.appendChild(shadings);\n        styleContainer.appendChild(styleText);\n        styleContainer.appendChild(dropDownList);\n        styleContainer.appendChild(widthText);\n        styleContainer.appendChild(widthNumeric);\n        styleContainer.appendChild(colorText);\n        styleContainer.appendChild(borderColorPickerElement);\n        this.target.appendChild(displayText);\n        this.target.appendChild(settingsContiner);\n        this.target.appendChild(styleContainer);\n        this.target.appendChild(previewContiner);\n        this.target.appendChild(this.shadingContiner);\n        // Handling Setting Container\n        noneDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        boxDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        allDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        customDivContainer.addEventListener('click', this.handleSettingCheckBoxAction);\n        // Handling Preview Div Container\n        this.previewDivBottomcenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomLeftContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivBottomRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopTopContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopBottomContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivTopCenterContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivDiagonalRightContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        this.previewDivLeftDiagonalContainer.addEventListener('click', this.handlePreviewCheckBoxAction);\n        // handling dropdown change\n        this.borderWidth = new NumericTextBox({\n            value: 0, min: 0, max: 6, decimals: 2,\n            width: 150, enablePersistence: false\n        });\n        this.borderWidth.appendTo(widthNumeric);\n        this.borderStyle = new DropDownList({\n            width: '150px', popupHeight: '150px', index: 1\n        });\n        this.borderStyle.appendTo(dropDownList);\n        this.ulelementShading = new DropDownList({\n            width: '150px', change: this.applyTableCellPreviewBoxes, index: 1\n        });\n        this.ulelementShading.appendTo(ulelementShading);\n        this.borderColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBorderColor\n        });\n        this.borderColorPicker.appendTo(borderColorPickerElement);\n        this.shadingColorPicker = new ColorPicker({\n            value: '#000000', change: this.applyPreviewTableBackgroundColor\n        });\n        this.shadingColorPicker.appendTo(shadingColorPickerElement);\n    };\n    BordersAndShadingDialog.prototype.applyFormat = function () {\n        var selection = this.owner.selection;\n        var editorModule = this.owner.owner.editorModule;\n        editorModule.initComplexHistory('BordersAndShading');\n        editorModule.isBordersAndShadingDialog = true;\n        if (this.applyTo === 0) {\n            editorModule.onCellFormat(this.cellFormat);\n        }\n        else {\n            editorModule.onTableFormat(this.tableFormat);\n        }\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n        editorModule.isBordersAndShadingDialog = false;\n    };\n    BordersAndShadingDialog.prototype.getBorder = function () {\n        var border = new WBorder();\n        border.color = this.borderColorPicker.value;\n        border.lineStyle = this.borderStyle.text;\n        border.lineWidth = this.borderWidth.value;\n        return border;\n    };\n    BordersAndShadingDialog.prototype.checkClassName = function (element) {\n        return element.classList.contains('e-de-table-border-inside-preview-click');\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.show = function () {\n        var localeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initBordersAndShadingsDialog(localeValue);\n        }\n        this.loadBordersShadingsPropertiesDialog();\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.header = localeValue.getConstant('Borders and Shading');\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.closeBordersShadingsDialog;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.applyBordersShadingsProperties,\n                buttonModel: { content: localeValue.getConstant('Ok'), cssClass: 'e-flat e-table-border-shading-okay', isPrimary: true }\n            },\n            {\n                click: this.closeDialog,\n                buttonModel: { content: localeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-border-shading-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    BordersAndShadingDialog.prototype.updateClassForSettingDivElements = function () {\n        var settingDivs = this.target.getElementsByClassName('e-de-table-border-inside-setting');\n        for (var j = 0; j < settingDivs.length; j++) {\n            if (settingDivs[j].className.indexOf('e-de-table-border-inside-setting-click') !== -1) {\n                var tempClassName = settingDivs[j].className;\n                tempClassName = tempClassName.replace('e-de-table-border-inside-setting-click', '');\n                settingDivs[j].className = tempClassName;\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.setSettingPreviewDivElement = function (position) {\n        switch (position) {\n            case 'none':\n                this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('none');\n                break;\n            case 'box':\n                this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('box');\n                break;\n            case 'all':\n                this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n                this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                this.isShowHidePreviewTableElements('all');\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.isShowHidePreviewTableElements = function (settingDiv) {\n        switch (settingDiv) {\n            case 'none':\n                this.previewDiv.style.border = 'none';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'box':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'none';\n                this.previewVerticalDiv.style.display = 'none';\n                break;\n            case 'all':\n                this.previewDiv.style.border = '1px solid rgba(0, 0, 0, .54)';\n                this.previewRightDiagonalDiv.style.display = 'none';\n                this.previewLeftDiagonalDiv.style.display = 'none';\n                this.previewHorizontalDiv.style.display = 'block';\n                this.previewVerticalDiv.style.display = 'block';\n                break;\n        }\n    };\n    BordersAndShadingDialog.prototype.handlePreviewCheckBoxShowHide = function (tableBorderDialogId, compareClass, element) {\n        if (element.classList.contains(compareClass)) {\n            element.classList.remove(compareClass);\n        }\n        else {\n            element.classList.add(compareClass);\n        }\n    };\n    // tslint:disable-next-line:max-line-length\n    BordersAndShadingDialog.prototype.showHidePreviewDivElements = function (tableBorderDialogId, compareClass, elementClass, compareElementClass, position) {\n        var setElement = document.getElementById(tableBorderDialogId + elementClass);\n        var compareElement = document.getElementById(tableBorderDialogId + compareElementClass);\n        if (position === 'TopTop') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-top');\n        }\n        else if (position === 'TopCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'TopBottom') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-bottom');\n        }\n        else if (position === 'LeftDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomLeft') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-left');\n        }\n        else if (position === 'BottomCenter') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n        else if (position === 'BottomRight') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'border-right');\n        }\n        else if (position === 'RightDiagonal') {\n            this.setPropertyPreviewDivElement(setElement, compareElement, compareClass, 'display');\n        }\n    };\n    BordersAndShadingDialog.prototype.setPropertyPreviewDivElement = function (ele, compareElement, compareClass, property) {\n        if (compareElement.classList.contains(compareClass) && property.split('-')[0] === 'border') {\n            /* tslint:disable:no-any */\n            ele.style[property] = '1px solid rgba(0, 0, 0, .54)';\n        }\n        else if (compareElement.classList.contains(compareClass) && property === 'display') {\n            ele.style[property] = 'block';\n        }\n        else {\n            ele.style[property] = 'none';\n            /* tslint:enable:no-any */\n        }\n    };\n    BordersAndShadingDialog.prototype.loadBordersShadingsPropertiesDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat.table.tableFormat;\n        var lineStyle;\n        var borderColor;\n        var fillColor;\n        var borderWidth;\n        if (!isNullOrUndefined(tableFormat) && !isNullOrUndefined(tableFormat.borders)) {\n            this.cloneBorders(tableFormat.borders);\n            if (isNullOrUndefined(tableFormat.borders) || isNullOrUndefined(tableFormat.borders.top)) {\n                lineStyle = 1;\n                borderColor = '#000000';\n                borderWidth = 0;\n                fillColor = '#000000';\n            }\n            else {\n                lineStyle = this.getLineStyle(tableFormat.borders.top.lineStyle);\n                borderColor = tableFormat.borders.top.color;\n                borderWidth = tableFormat.borders.top.getLineWidth();\n                fillColor = tableFormat.shading.backgroundColor;\n            }\n        }\n        this.borderColorPicker.value = borderColor;\n        this.shadingColorPicker.value = fillColor;\n        /* tslint:disable:no-any */\n        var colorPickerEvent = {\n            target: this.borderColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        var fillColorEvent = {\n            target: this.shadingColorPicker, ctrlKey: false,\n            shiftKey: false, which: 0\n        };\n        /* tslint:enable:no-any */\n        this.applyPreviewTableBackgroundColor(fillColorEvent);\n        this.applyPreviewTableBorderColor(colorPickerEvent);\n        this.ulelementShading.index = 1;\n        this.previewDivLeftDiagonal.style.display = 'none';\n        this.previewDivDiagonalRight.style.display = 'none';\n        this.borderWidth.value = borderWidth;\n        this.borderStyle.index = lineStyle;\n    };\n    // tslint:disable:max-func-body-length\n    BordersAndShadingDialog.prototype.cloneBorders = function (borders) {\n        var topBorder = false;\n        var bottomBorder = false;\n        var leftBorder = false;\n        var rightBorder = false;\n        var horizontalBorder = false;\n        var verticalBorder = false;\n        var diagonalDownBorder = false;\n        var customBorder = false;\n        var diagonalUpBorder = false;\n        if (borders !== null) {\n            if (borders.top && (borders.top.hasNoneStyle || borders.top.lineStyle !== 'None')) {\n                topBorder = true;\n            }\n            if (borders.bottom && (borders.bottom.hasNoneStyle || borders.bottom.lineStyle !== 'None')) {\n                bottomBorder = true;\n            }\n            if (borders.left && (borders.left.hasNoneStyle || borders.left.lineStyle !== 'None')) {\n                leftBorder = true;\n            }\n            if (borders.right && (borders.right.hasNoneStyle || borders.right.lineStyle !== 'None')) {\n                rightBorder = true;\n            }\n            if (borders.horizontal && (borders.horizontal.hasNoneStyle || borders.horizontal.lineStyle !== 'None')) {\n                horizontalBorder = true;\n            }\n            if (borders.vertical && (borders.vertical.hasNoneStyle || borders.vertical.lineStyle !== 'None')) {\n                verticalBorder = true;\n            }\n            if (borders.diagonalDown && (borders.diagonalDown.hasNoneStyle || borders.diagonalDown.lineStyle !== 'None')) {\n                diagonalDownBorder = true;\n            }\n            if (borders.diagonalUp && (borders.diagonalUp.hasNoneStyle || borders.diagonalUp.lineStyle !== 'None')) {\n                diagonalUpBorder = true;\n            }\n            if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder)) {\n                if (!(!topBorder || !bottomBorder || !leftBorder || !rightBorder || !horizontalBorder\n                    || !verticalBorder || diagonalUpBorder || diagonalDownBorder)) {\n                    if ((topBorder && bottomBorder && leftBorder && rightBorder && horizontalBorder && verticalBorder\n                        && !diagonalUpBorder && !diagonalDownBorder)) {\n                        if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                            && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                            this.setSettingPreviewDivElement('none');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                        else {\n                            this.setSettingPreviewDivElement('all');\n                            this.allDiv.classList.add('e-de-table-border-inside-setting-click');\n                            this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                            this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        }\n                    }\n                }\n                else if ((leftBorder && bottomBorder && topBorder && rightBorder && !horizontalBorder && !verticalBorder)) {\n                    if (borders.top.hasNoneStyle && borders.bottom.hasNoneStyle && borders.left.hasNoneStyle\n                        && borders.right.hasNoneStyle && borders.horizontal.hasNoneStyle && borders.vertical.hasNoneStyle) {\n                        this.setSettingPreviewDivElement('none');\n                        this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.add('e-de-table-border-inside-setting-click');\n                    }\n                    else {\n                        this.setSettingPreviewDivElement('box');\n                        this.customDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                        this.boxDiv.classList.add('e-de-table-border-inside-setting-click');\n                        this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                    }\n                }\n                else {\n                    customBorder = true;\n                }\n            }\n            else {\n                customBorder = true;\n            }\n            this.previewDivLeftDiagonal.classList.remove('e-de-table-border-inside-preview-click');\n            this.previewDivDiagonalRight.classList.remove('e-de-table-border-inside-preview-click');\n            if (customBorder) {\n                this.customDiv.classList.add('e-de-table-border-inside-setting-click');\n                this.noneDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.boxDiv.classList.remove('e-de-table-border-inside-setting-click');\n                this.allDiv.classList.remove('e-de-table-border-inside-setting-click');\n                if (topBorder) {\n                    this.previewDivTopTop.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopTop.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (bottomBorder) {\n                    this.previewDivTopBottom.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopBottom.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (leftBorder) {\n                    this.previewDivBottomLeft.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomLeft.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (rightBorder) {\n                    this.previewDivBottomRight.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomRight.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (verticalBorder) {\n                    this.previewDivBottomcenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivBottomcenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n                if (horizontalBorder) {\n                    this.previewDivTopCenter.classList.add('e-de-table-border-inside-preview-click');\n                }\n                else {\n                    this.previewDivTopCenter.classList.remove('e-de-table-border-inside-preview-click');\n                }\n            }\n        }\n    };\n    BordersAndShadingDialog.prototype.getLineStyle = function (lineStyle) {\n        switch (lineStyle) {\n            case 'Single': return 1;\n            case 'Dot': return 2;\n            case 'DashSmallGap': return 3;\n            case 'DashLargeGap': return 4;\n            case 'DashDot': return 5;\n            case 'DashDotDot': return 6;\n            case 'Double': return 7;\n            case 'Triple': return 8;\n            case 'ThinThickSmallGap': return 9;\n            case 'ThickThinSmallGap': return 10;\n            case 'ThinThickThinSmallGap': return 11;\n            case 'ThinThickMediumGap': return 12;\n            case 'ThickThinMediumGap': return 13;\n            case 'ThinThickThinMediumGap': return 14;\n            case 'ThinThickLargeGap': return 15;\n            case 'ThickThinLargeGap': return 16;\n            case 'ThinThickThinLargeGap': return 17;\n            case 'SingleWavy': return 18;\n            case 'DoubleWavy': return 19;\n            case 'DashDotStroked': return 20;\n            case 'Emboss3D': return 21;\n            case 'Engrave3D': return 22;\n            case 'Outset': return 23;\n            case 'Inset': return 24;\n            case 'Thick': return 25;\n        }\n        return 0;\n    };\n    /**\n     * @private\n     */\n    BordersAndShadingDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var k = 0; k < this.target.childNodes.length; k++) {\n                this.target.removeChild(this.target.childNodes[k]);\n                k--;\n            }\n            this.target = undefined;\n        }\n        if (this.cellFormat) {\n            this.cellFormat.destroy();\n            this.cellFormat = undefined;\n        }\n        if (this.tableFormat) {\n            this.tableFormat.destroy();\n            this.tableFormat = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        if (!isNullOrUndefined(this.borderStyle)) {\n            this.borderStyle.destroy();\n        }\n        this.borderStyle = undefined;\n        if (!isNullOrUndefined(this.borderColorPicker)) {\n            this.borderColorPicker.destroy();\n        }\n        this.borderColorPicker = undefined;\n        if (!isNullOrUndefined(this.shadingColorPicker)) {\n            this.shadingColorPicker.destroy();\n        }\n        this.shadingColorPicker = undefined;\n        if (!isNullOrUndefined(this.ulelementShading)) {\n            this.ulelementShading.destroy();\n        }\n        this.ulelementShading = undefined;\n        this.noneDivTransparent = undefined;\n        this.boxDivTransparent = undefined;\n        this.allDivTransparent = undefined;\n        this.customDivTransparent = undefined;\n        this.previewDiv = undefined;\n        this.previewRightDiagonalDiv = undefined;\n        this.previewLeftDiagonalDiv = undefined;\n        this.previewVerticalDiv = undefined;\n        this.previewHorizontalDiv = undefined;\n        this.previewDivTopTopContainer = undefined;\n        this.previewDivTopTop = undefined;\n        this.previewDivTopCenterContainer = undefined;\n        this.previewDivTopCenter = undefined;\n        this.previewDivTopBottomContainer = undefined;\n        this.previewDivTopBottom = undefined;\n        this.previewDivLeftDiagonalContainer = undefined;\n        this.previewDivLeftDiagonal = undefined;\n        this.previewDivBottomLeftContainer = undefined;\n        this.previewDivBottomLeft = undefined;\n        this.previewDivBottomcenterContainer = undefined;\n        this.previewDivBottomcenter = undefined;\n        this.previewDivBottomRightContainer = undefined;\n        this.previewDivBottomRight = undefined;\n        this.previewDivDiagonalRightContainer = undefined;\n        this.previewDivDiagonalRight = undefined;\n        this.previewDivTopTopTransParent = undefined;\n        this.previewDivTopCenterTransParent = undefined;\n        this.previewDivTopBottomTransParent = undefined;\n        this.previewDivLeftDiagonalTransParent = undefined;\n        this.previewDivBottomLeftTransparent = undefined;\n        this.previewDivBottomcenterTransparent = undefined;\n        this.previewDivBottomRightTransparent = undefined;\n        this.previewDivDiagonalRightTransparent = undefined;\n        this.shadingContiner = undefined;\n        this.noneDiv = undefined;\n        this.customDiv = undefined;\n        this.allDiv = undefined;\n        this.boxDiv = undefined;\n    };\n    return BordersAndShadingDialog;\n}());\nexport { BordersAndShadingDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WTableFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\nimport { CellOptionsDialog } from './index';\n/**\n * The Table options dialog is used to modify default cell margins and cell spacing of selected table.\n */\nvar TableOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function TableOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var tableFormat = _this.owner.selection.tableFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value || _this.cellSpaceTextBox.value)\n                && (tableFormat.bottomMargin !== _this.bottomMarginBox.value\n                    || tableFormat.leftMargin !== _this.leftMarginBox.value\n                    || tableFormat.rightMargin !== _this.rightMarginBox.value\n                    || tableFormat.topMargin !== _this.topMarginBox.value\n                    || tableFormat.cellSpacing !== _this.cellSpaceTextBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isTableOptionsUpdated = true;\n                _this.applyTableOptions(_this.tableFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeAllowSpaceCheckBox = function () {\n            if (_this.allowSpaceCheckBox.checked) {\n                _this.cellSpaceTextBox.enabled = true;\n            }\n            else {\n                _this.cellSpaceTextBox.enabled = false;\n            }\n        };\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(TableOptionsDialog.prototype, \"tableFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.tableFormatIn)) {\n                return this.tableFormatIn = new WTableFormat();\n            }\n            return this.tableFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.getModuleName = function () {\n        return 'TableOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.initTableOptionsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_insertCellMarginsDialog', className: 'e-de-table-options-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 180px;' });\n        var innerDivLabel = createElement('Label', {\n            id: this.target.id + '_innerDivLabel', className: 'e-de-cell-dia-options-label',\n            innerHTML: localValue.getConstant('Default cell margins')\n        });\n        innerDiv.appendChild(innerDivLabel);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var div = createElement('div', { styles: 'width: 475px; position: relative;' });\n        var cellSpaceLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label',\n            id: this.target.id + '_cellSpaceLabel'\n        });\n        cellSpaceLabel.innerHTML = localValue.getConstant('Default cell spacing');\n        div.appendChild(cellSpaceLabel);\n        var table2 = createElement('TABLE', {\n            styles: 'height: 30px;padding-bottom: 15px;'\n        });\n        var tr3 = createElement('tr');\n        var td5 = createElement('td');\n        var allowSpaceCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_cellcheck'\n        });\n        var td6 = createElement('td', { styles: 'padding-left: 15px;', });\n        this.cellspacingTextBox = createElement('input', {\n            attrs: { 'type': 'text' }, id: this.target.id + '_cellspacing'\n        });\n        td5.appendChild(allowSpaceCheckBox);\n        td6.appendChild(this.cellspacingTextBox);\n        tr3.appendChild(td5);\n        tr3.appendChild(td6);\n        table2.appendChild(tr3);\n        div.appendChild(table2);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(div);\n        this.target.appendChild(divBtn);\n        this.cellSpaceTextBox = new NumericTextBox({\n            value: 0, min: 0, max: 264.5, width: 150,\n            decimals: 2, enablePersistence: false\n        });\n        this.cellSpaceTextBox.appendTo(this.cellspacingTextBox);\n        this.allowSpaceCheckBox = new CheckBox({\n            label: localValue.getConstant('Allow spacing between cells'),\n            change: this.changeAllowSpaceCheckBox,\n            cssClass: 'e-de-tbl-margin-sub-header',\n        });\n        this.allowSpaceCheckBox.appendTo(allowSpaceCheckBox);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var tableFormat = this.owner.selection.tableFormat;\n        this.cellSpaceTextBox.value = tableFormat.cellSpacing;\n        this.bottomMarginBox.value = tableFormat.bottomMargin;\n        this.topMarginBox.value = tableFormat.topMargin;\n        this.rightMarginBox.value = tableFormat.rightMargin;\n        this.leftMarginBox.value = tableFormat.leftMargin;\n        if (tableFormat.cellSpacing > 0) {\n            this.allowSpaceCheckBox.checked = true;\n            this.cellSpaceTextBox.enabled = true;\n        }\n        else {\n            this.allowSpaceCheckBox.checked = false;\n            this.cellSpaceTextBox.enabled = false;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptions = function (tableFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'TableMarginsSelection');\n        this.applyTableOptionsHistory(tableFormat);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHelper = function (tableFormat) {\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptionsHistory = function (tableFormat) {\n        this.owner.owner.editorModule.initHistory('TableOptions');\n        this.applySubTableOptionsHelper(tableFormat);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applySubTableOptionsHelper = function (tableFormat) {\n        var ownerTable = this.owner.selection.start.currentWidget.paragraph.associatedCell.ownerTable;\n        ownerTable = ownerTable.combineWidget(this.owner);\n        var currentTableFormat = ownerTable.tableFormat;\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(currentTableFormat);\n        }\n        currentTableFormat.cellSpacing = tableFormat.cellSpacing;\n        currentTableFormat.leftMargin = tableFormat.leftMargin;\n        currentTableFormat.topMargin = tableFormat.topMargin;\n        currentTableFormat.rightMargin = tableFormat.rightMargin;\n        currentTableFormat.bottomMargin = tableFormat.bottomMargin;\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(ownerTable);\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.applyTableOptions = function (tableFormat) {\n        tableFormat.leftMargin = this.leftMarginBox.value;\n        tableFormat.topMargin = this.topMarginBox.value;\n        tableFormat.bottomMargin = this.bottomMarginBox.value;\n        tableFormat.rightMargin = this.rightMarginBox.value;\n        if (this.allowSpaceCheckBox.checked) {\n            tableFormat.cellSpacing = this.cellSpaceTextBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.show = function () {\n        var documentLocale = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        documentLocale.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initTableOptionsDialog(documentLocale);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = documentLocale.getConstant('Table Options');\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.position = { X: 'center', Y: 'center' };\n        //  this.owner.dialog.cssClass = 'e-de-table-margin-size';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: documentLocale.getConstant('Ok'), cssClass: 'e-flat e-table-cell-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: documentLocale.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-cancel' }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    TableOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var p = 0; p < this.target.childNodes.length; p++) {\n                this.target.removeChild(this.target.childNodes[p]);\n                p--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.cellspacingTextBox = undefined;\n        this.allowSpaceCheckBox = undefined;\n    };\n    return TableOptionsDialog;\n}());\nexport { TableOptionsDialog };\n","import { CheckBox } from '@syncfusion/ej2-buttons';\nimport { NumericTextBox } from '@syncfusion/ej2-inputs';\nimport { WCellFormat } from '../index';\nimport { isNullOrUndefined, L10n, createElement, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Cell options dialog is used to modify margins of selected cells.\n */\nvar CellOptionsDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function CellOptionsDialog(viewer) {\n        var _this = this;\n        /**\n         * @private\n         */\n        this.removeEvents = function () {\n            _this.owner.dialog2.element.style.pointerEvents = '';\n            _this.owner.updateFocus();\n        };\n        /**\n         * @private\n         */\n        this.changeSameAsTable = function () {\n            if (_this.sameAsTableCheckBox.checked) {\n                _this.leftMarginBox.enabled = false;\n                _this.rightMarginBox.enabled = false;\n                _this.bottomMarginBox.enabled = false;\n                _this.topMarginBox.enabled = false;\n            }\n            else {\n                _this.leftMarginBox.enabled = true;\n                _this.rightMarginBox.enabled = true;\n                _this.bottomMarginBox.enabled = true;\n                _this.topMarginBox.enabled = true;\n            }\n        };\n        /**\n         * @private\n         */\n        this.applyTableCellProperties = function () {\n            var cellFormat = _this.owner.selection.cellFormat;\n            if (!isNullOrUndefined(_this.bottomMarginBox.value || _this.leftMarginBox.value\n                || _this.rightMarginBox.value || _this.topMarginBox.value) &&\n                (cellFormat.bottomMargin !== _this.bottomMarginBox.value || cellFormat.leftMargin !== _this.leftMarginBox.value\n                    || cellFormat.rightMargin !== _this.rightMarginBox.value || cellFormat.topMargin !== _this.topMarginBox.value)) {\n                _this.owner.owner.tablePropertiesDialogModule.isCellOptionsUpdated = true;\n                _this.applyTableOptions(_this.cellFormat);\n                _this.owner.owner.tablePropertiesDialogModule.applyTableSubProperties();\n            }\n            _this.closeCellMarginsDialog();\n        };\n        /**\n         * @private\n         */\n        this.closeCellMarginsDialog = function () {\n            _this.owner.dialog.hide();\n            _this.owner.dialog.element.style.pointerEvents = '';\n        };\n        this.owner = viewer;\n    }\n    Object.defineProperty(CellOptionsDialog.prototype, \"cellFormat\", {\n        /**\n         * @private\n         */\n        get: function () {\n            if (isNullOrUndefined(this.cellFormatIn)) {\n                return this.cellFormatIn = new WCellFormat();\n            }\n            return this.cellFormatIn;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.getModuleName = function () {\n        return 'CellOptionsDialog';\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.initCellMarginsDialog = function (localValue) {\n        var instance = this.owner;\n        this.target = createElement('div', {\n            id: this.owner.owner.containerId + '_tableCellMarginsDialog', className: 'e-de-table-cell-margin-dlg'\n        });\n        this.owner.owner.element.appendChild(this.target);\n        var innerDiv = createElement('div', { styles: 'width: 475px;position: relative;height: 165px;' });\n        var innerDivLabel = createElement('Label', {\n            className: 'e-de-cell-dia-options-label', id: this.target.id + '_innerDivLabel'\n        });\n        innerDivLabel.innerHTML = localValue.getConstant('Cell margins');\n        innerDiv.appendChild(innerDivLabel);\n        var table = createElement('TABLE', {\n            styles: 'height: 40px;padding-bottom: 0px;', className: 'e-de-cell-margin-top'\n        });\n        var tr = createElement('tr');\n        var td = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n        var sameAsTableCheckBox = createElement('input', {\n            attrs: { 'type': 'checkbox' }, id: this.target.id + '_sameAsCheckBox'\n        });\n        td.appendChild(sameAsTableCheckBox);\n        tr.appendChild(td);\n        table.appendChild(tr);\n        innerDiv.appendChild(table);\n        CellOptionsDialog.getCellMarginDialogElements(this, innerDiv, localValue);\n        var divBtn = document.createElement('div');\n        this.target.appendChild(divBtn);\n        this.sameAsTableCheckBox = new CheckBox({\n            label: localValue.getConstant('Same as the whole table'),\n            change: this.changeSameAsTable\n        });\n        this.sameAsTableCheckBox.appendTo(sameAsTableCheckBox);\n        this.sameAsTableCheckBox.addEventListener('change', this.changeSameAsTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.show = function () {\n        var localizeValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localizeValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        if (!this.target) {\n            this.initCellMarginsDialog(localizeValue);\n        }\n        this.loadCellMarginsDialog();\n        this.owner.dialog.header = localizeValue.getConstant('Cell Options');\n        this.owner.dialog.position = { X: 'center', Y: 'top' };\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = undefined;\n        this.owner.dialog.open = undefined;\n        this.owner.dialog.close = this.removeEvents;\n        this.owner.dialog.buttons = [{\n                click: this.applyTableCellProperties,\n                buttonModel: { content: localizeValue.getConstant('Ok'), cssClass: 'e-flat e-table-cell-margin-okay', isPrimary: true }\n            },\n            {\n                click: this.closeCellMarginsDialog,\n                buttonModel: { content: localizeValue.getConstant('Cancel'), cssClass: 'e-flat e-table-cell-margin-cancel' }\n            }];\n        this.owner.dialog.show();\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.loadCellMarginsDialog = function () {\n        var cellFormat = this.owner.selection.cellFormat;\n        this.sameAsTable = isNullOrUndefined(cellFormat.leftMargin || cellFormat.topMargin\n            || cellFormat.rightMargin || cellFormat.bottomMargin);\n        if (this.sameAsTable) {\n            var tableFormat = this.owner.selection.tableFormat;\n            this.loadCellProperties(tableFormat, false, true);\n        }\n        else {\n            this.loadCellProperties(cellFormat, true, false);\n        }\n    };\n    CellOptionsDialog.prototype.loadCellProperties = function (format, enableTextBox, enableCheckBox) {\n        this.leftMarginBox.value = format.leftMargin;\n        this.rightMarginBox.value = format.rightMargin;\n        this.topMarginBox.value = format.topMargin;\n        this.bottomMarginBox.value = format.bottomMargin;\n        this.leftMarginBox.enabled = enableTextBox;\n        this.rightMarginBox.enabled = enableTextBox;\n        this.topMarginBox.enabled = enableTextBox;\n        this.bottomMarginBox.enabled = enableTextBox;\n        this.sameAsTableCheckBox.checked = enableCheckBox;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellOptions = function (cellFormat) {\n        this.owner.owner.editorHistory.initComplexHistory(this.owner.selection, 'CellMarginsSelection');\n        this.owner.owner.editorModule.initHistory('CellOptions');\n        /* tslint:disable:max-line-length */\n        var startTable = this.owner.selection.start.paragraph.associatedCell.ownerTable;\n        startTable = startTable.combineWidget(this.owner);\n        this.applyCellmarginsValue(this.owner.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner), this.owner.selection.start, this.owner.selection.end, cellFormat);\n        this.owner.owner.editorModule.reLayout(this.owner.selection, false);\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)) {\n            this.owner.owner.editorHistory.updateComplexHistory();\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellmarginsValue = function (row, start, end, cellFormat) {\n        this.applyCellMarginsInternal(row, cellFormat);\n        if (end.paragraph.associatedCell.ownerRow === row) {\n            return;\n        }\n        var newRow = row.nextWidget;\n        if (!isNullOrUndefined(newRow)) {\n            this.applyCellmarginsValue(newRow, start, end, cellFormat);\n        }\n    };\n    CellOptionsDialog.prototype.applyCellMarginsInternal = function (row, cellFormat) {\n        if (!isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)) {\n            var currentFormat = row.childWidgets[0].cellFormat;\n            /* tslint:disable:max-line-length */\n            cellFormat = this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(currentFormat, cellFormat, row.ownerTable);\n        }\n        if (!isNullOrUndefined(cellFormat)) {\n            this.applyCellMarginsForCells(row, cellFormat);\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyCellMarginsForCells = function (row, cellFormat) {\n        var rowCells = row.childWidgets;\n        this.iterateCells(rowCells, cellFormat);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.iterateCells = function (cells, cellFormat) {\n        for (var i = 0; i < cells.length; i++) {\n            this.applySubCellMargins(cells[i].cellFormat, cellFormat);\n        }\n        this.owner.owner.tablePropertiesDialogModule.calculateGridValue(cells[0].ownerTable);\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applySubCellMargins = function (sourceFormat, cellFormat) {\n        sourceFormat.leftMargin = cellFormat.leftMargin;\n        sourceFormat.topMargin = cellFormat.topMargin;\n        sourceFormat.rightMargin = cellFormat.rightMargin;\n        sourceFormat.bottomMargin = cellFormat.bottomMargin;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.applyTableOptions = function (cellFormat) {\n        if (!this.sameAsTableCheckBox.checked) {\n            cellFormat.leftMargin = this.leftMarginBox.value;\n            cellFormat.topMargin = this.topMarginBox.value;\n            cellFormat.bottomMargin = this.bottomMarginBox.value;\n            cellFormat.rightMargin = this.rightMarginBox.value;\n        }\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.prototype.destroy = function () {\n        if (!isNullOrUndefined(this.target)) {\n            if (this.target.parentElement) {\n                this.target.parentElement.removeChild(this.target);\n            }\n            for (var y = 0; y < this.target.childNodes.length; y++) {\n                this.target.removeChild(this.target.childNodes[y]);\n                y--;\n            }\n            this.target = undefined;\n        }\n        this.dialog = undefined;\n        this.target = undefined;\n        this.owner = undefined;\n        this.sameAsTableCheckBox = undefined;\n    };\n    /**\n     * @private\n     */\n    CellOptionsDialog.getCellMarginDialogElements = function (dialog, div, locale) {\n        if (!isNullOrUndefined(dialog)) {\n            var table = createElement('TABLE', { className: 'e-de-cell-margin-top' });\n            var tr1 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td1 = createElement('td');\n            var topLabel = createElement('label', {\n                innerHTML: locale.getConstant('Top'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_TopLabel'\n            });\n            var topTextBox = createElement('input', {\n                attrs: { 'type': 'text' }, styles: 'width:100%', id: dialog.target.id + '_Top'\n            });\n            td1.appendChild(topLabel);\n            td1.appendChild(topTextBox);\n            var td2 = createElement('td', { className: 'e-de-tbl-btn-seperator' });\n            var leftLabel = createElement('label', {\n                innerHTML: locale.getConstant('Left'), className: 'e-de-cell-dia-label-common',\n                id: dialog.target.id + '_leftLabel'\n            });\n            var leftTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_left'\n            });\n            td2.appendChild(leftLabel);\n            td2.appendChild(leftTextBox);\n            tr1.appendChild(td1);\n            tr1.appendChild(td2);\n            var tr2 = createElement('tr', { styles: 'height: 50px;color:black;' });\n            var td3 = createElement('td', { styles: 'width:40%;' });\n            var bottomLabel = createElement('label', {\n                innerHTML: locale.getConstant('Bottom'),\n                className: 'e-de-cell-dia-label-common', id: dialog.target.id + '_bottomLabel'\n            });\n            var bottomTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_bottom'\n            });\n            td3.appendChild(bottomLabel);\n            td3.appendChild(bottomTextBox);\n            var td4 = createElement('td', { styles: 'width:40%;' });\n            var rightLabel = createElement('label', {\n                innerHTML: locale.getConstant('Right'), id: dialog.target.id + '_rightLabel',\n                className: 'e-de-cell-dia-label-common'\n            });\n            var rightTextBox = createElement('input', {\n                attrs: { 'type': 'text' },\n                styles: 'width:100%', id: dialog.target.id + '_right'\n            });\n            td4.appendChild(rightLabel);\n            td4.appendChild(rightTextBox);\n            tr2.appendChild(td3);\n            tr2.appendChild(td4);\n            table.appendChild(tr1);\n            table.appendChild(tr2);\n            div.appendChild(table);\n            dialog.target.appendChild(div);\n            dialog.topMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.topMarginBox.appendTo(topTextBox);\n            dialog.leftMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.leftMarginBox.appendTo(leftTextBox);\n            dialog.bottomMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150, decimals: 2,\n                enablePersistence: false\n            });\n            dialog.bottomMarginBox.appendTo(bottomTextBox);\n            dialog.rightMarginBox = new NumericTextBox({\n                value: 0, min: 0, max: 1584, width: 150,\n                decimals: 2, enablePersistence: false\n            });\n            dialog.rightMarginBox.appendTo(rightTextBox);\n        }\n    };\n    return CellOptionsDialog;\n}());\nexport { CellOptionsDialog };\n","import { ListView } from '@syncfusion/ej2-lists';\nimport { Button } from '@syncfusion/ej2-buttons';\nimport { createElement, L10n, setCulture } from '@syncfusion/ej2-base';\n/**\n * The Styles dialog is used to create or modify styles.\n */\nvar StylesDialog = /** @class */ (function () {\n    /**\n     * @private\n     */\n    function StylesDialog(viewer) {\n        var _this = this;\n        this.updateStyleNames = function () {\n            var collection = _this.owner.owner.viewer.styles.getStyleNames('Paragraph');\n            var defaultStyleNames = ['Normal', 'Heading 1', 'Heading 2', 'Heading 3', 'Heading 4', 'Heading 5', 'Heading 6'];\n            var finalList = collection.concat(defaultStyleNames).filter(function (v, i, a) { return a.indexOf(v) === i; });\n            return finalList;\n        };\n        this.modifyStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show(_this.styleName, _this.localValue.getConstant('Modify Style'));\n        };\n        /* tslint:disable:no-any */\n        this.selectHandler = function (args) {\n            _this.styleName = args.text;\n        };\n        this.addNewStyles = function () {\n            _this.owner.dialog.hide();\n            _this.owner.owner.styleDialogModule.show();\n        };\n        this.owner = viewer;\n    }\n    /**\n     * @private\n     */\n    StylesDialog.prototype.getModuleName = function () {\n        return 'StylesDialog';\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.initStylesDialog = function (localValue, styles) {\n        var instance = this;\n        var id = this.owner.owner.containerId + '_insert_styles';\n        this.target = createElement('div', { id: id, className: 'e-de-styles' });\n        var headerValue = localValue.getConstant('Styles');\n        var dlgFields = createElement('div', { innerHTML: headerValue, className: 'e-styles-dlgfields' });\n        this.target.appendChild(dlgFields);\n        var commonDiv = createElement('div', { className: 'e-styles-common' });\n        this.target.appendChild(commonDiv);\n        var searchDiv = createElement('div', { className: 'e-styles-list' });\n        commonDiv.appendChild(searchDiv);\n        var listviewDiv = createElement('div', { className: 'e-styles-listViewDiv', id: 'styles_listview' });\n        searchDiv.appendChild(listviewDiv);\n        this.listviewInstance = new ListView({\n            dataSource: styles,\n            cssClass: 'e-styles-listview',\n        });\n        this.listviewInstance.appendTo(listviewDiv);\n        this.listviewInstance.addEventListener('select', this.selectHandler);\n        var buttonDiv = createElement('div', { className: 'e-styles-button' });\n        commonDiv.appendChild(buttonDiv);\n        var newButtonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(newButtonDiv);\n        var newButtonElement = createElement('button', { innerHTML: localValue.getConstant('New'), id: 'new' });\n        newButtonDiv.appendChild(newButtonElement);\n        var newbutton = new Button({ cssClass: 'e-button-custom' });\n        newbutton.appendTo(newButtonElement);\n        newButtonElement.addEventListener('click', this.addNewStyles);\n        var modifybuttonDiv = createElement('div', { className: 'e-styles-addbutton' });\n        buttonDiv.appendChild(modifybuttonDiv);\n        var modifyButtonElement = createElement('button', { innerHTML: localValue.getConstant('Modify'), id: 'modify' });\n        modifybuttonDiv.appendChild(modifyButtonElement);\n        var addbutton = new Button({ cssClass: 'e-button-custom' });\n        addbutton.appendTo(modifyButtonElement);\n        modifyButtonElement.addEventListener('click', this.modifyStyles);\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.show = function () {\n        var styles = this.updateStyleNames();\n        var localValue = new L10n('documenteditor', this.owner.owner.defaultLocale);\n        localValue.setLocale(this.owner.owner.locale);\n        setCulture(this.owner.owner.locale);\n        this.localValue = localValue;\n        this.initStylesDialog(localValue, styles);\n        this.owner.dialog.content = this.target;\n        this.owner.dialog.beforeOpen = this.owner.updateFocus;\n        this.owner.dialog.close = this.owner.updateFocus;\n        this.owner.dialog.header = 'Styles';\n        this.owner.dialog.height = 'auto';\n        this.owner.dialog.width = 'auto';\n        this.owner.dialog.buttons = [{\n                click: this.hideObjects.bind(this),\n                buttonModel: { content: localValue.getConstant('Cancel'), cssClass: 'e-flat e-hyper-insert', isPrimary: true }\n            }];\n        this.owner.dialog.dataBind();\n        this.owner.dialog.show();\n    };\n    StylesDialog.prototype.hideObjects = function () {\n        this.owner.dialog.hide();\n    };\n    /**\n     * @private\n     */\n    StylesDialog.prototype.destroy = function () {\n        if (this.listviewInstance) {\n            this.listviewInstance.destroy();\n            this.listviewInstance = undefined;\n        }\n    };\n    return StylesDialog;\n}());\nexport { StylesDialog };\n"],"names":["Dictionary","this","keysInternal","valuesInternal","item","Object","defineProperty","prototype","get","length","enumerable","configurable","getItem","i","push","add","key","value","isNullOrUndefined","ReferenceError","indexOf","index","RangeError","set","remove","splice","containsKey","clear","destroy","undefined","WUniqueFormat","type","referenceCount","uniqueFormatType","propertiesHash","isEqual","source","property","modifiedValue","isBorderEqual","isCharacterFormatEqual","isParagraphFormatEqual","isCellFormatEqual","isShadingEqual","isRowFormatEqual","isListFormatEqual","isTableFormatEqual","isListLevelEqual","isSectionFormatEqual","isNotEqual","modifiedProperty","targetValue","propertyType","getPropertyType","sourceValue","getBorderPropertyType","getCharacterFormatPropertyType","getParaFormatPropertyType","getCellFormatPropertyType","getShadingPropertyType","getRowFormatType","getListFormatType","getTableFormatType","getListLevelType","getSectionFormatType","cloneItems","format","keys","mergeProperties","hash","cloneProperties","WUniqueFormats","items","addUniqueFormat","matchedFormat","updateUniqueFormat","uniqueFormat","__extends","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__decorate","decorators","target","desc","c","arguments","r","getOwnPropertyDescriptor","Reflect","decorate","DocumentEditor","_super","options","element","_this","call","enableHeaderFooterIn","isShiftingEnabled","isLayoutEnabled","isPastingContent","parser","disableHistoryIn","findResultsList","documentName","tablePropertiesDialogModule","bordersAndShadingDialogModule","cellOptionsDialogModule","tableOptionsDialogModule","paragraphDialogModule","imageResizerModule","useCtrlClickToFollowHyperlink","pageOutline","enableCursorOnReadOnly","enableLocalPaste","defaultLocale","Table","Row","Cell","Ok","Cancel","Size","Preferred Width","Points","Percent","Measure in","Alignment","Left","Center","Right","Justify","Indent from left","Borders and Shading","Options","Specify height","At least","Exactly","Row height is","Allow row to break across pages","Repeat as header row at the top of each page","Vertical alignment","Top","Bottom","Default cell margins","Default cell spacing","Allow spacing between cells","Cell margins","Same as the whole table","Borders","None","Single","Dot","DashSmallGap","DashLargeGap","DashDot","DashDotDot","Double","Triple","ThinThickSmallGap","ThickThinSmallGap","ThinThickThinSmallGap","ThinThickMediumGap","ThickThinMediumGap","ThinThickThinMediumGap","ThinThickLargeGap","ThickThinLargeGap","ThinThickThinLargeGap","SingleWavy","DoubleWavy","DashDotStroked","Emboss3D","Engrave3D","Outset","Inset","Thick","Style","Width","Height","Letter","Tabloid","Legal","Statement","Executive","A3","A4","A5","B4","B5","Custom Size","Different odd and even","Different first page","From edge","Header","Footer","Margin","Paper","Layout","Orientation","Landscape","Portrait","Table Of Contents","Show page numbers","Right align page numbers","Nothing","Tab leader","Show levels","Use hyperlinks instead of page numbers","Build table of contents from","Styles","Available styles","TOC level","Heading","List Paragraph","Normal","Outline levels","Table entry fields","Modify","Color","Setting","Box","All","Custom","Preview","Shading","Fill","Apply To","Table Properties","Cell Options","Table Options","Insert Table","Number of columns","Number of rows","Text to display","Address","Insert Hyperlink","Edit Hyperlink","Insert","General","Indentation","Before text","Special","First line","Hanging","After text","By","Before","Line Spacing","After","At","Multiple","Spacing","Define new Multilevel list","List level","Choose level to modify","Level","Number format","Number style for this level","Enter formatting for number","Start at","Restart list after","Position","Text indent at","Aligned at","Follow number with","Tab character","Space","Arabic","UpRoman","LowRoman","UpLetter","LowLetter","Number","Leading zero","Bullet","Ordinal","Ordinal Text","For East","No Restart","Font","Font style","Underline style","Font color","Effects","Strikethrough","Superscript","Subscript","Double strikethrough","Regular","Bold","Italic","Cut","Copy","Paste","Hyperlink","Open Hyperlink","Copy Hyperlink","Remove Hyperlink","Paragraph","Merge Cells","Insert Above","Insert Below","Insert Left","Insert Right","Delete","Delete Table","Delete Row","Delete Column","File Name","Format Type","Save","Navigation","Results","Replace","Replace All","We replaced all","Find","No matches","All Done","Result","of","instances","with","Click to follow link","Continue Numbering","Bookmark name","Close","Restart At","Properties","Name","Style type","Style based on","Style for following paragraph","Formatting","Numbering and Bullets","Numbering","Update Field","Edit Field","Bookmark","Page Setup","No bookmarks found","Number format tooltip information","Format","Create New Style","Modify Style","New","Bullets","Use bookmarks","Table of Contents","viewer","PageLayoutViewer","SfdtReader","DocumentEditor_1","updateScrollBars","isDocumentLoaded","pages","selectionModule","editorModule","editorHistoryModule","searchModule","contextMenuModule","id","isDocumentLoadedIn","enableEditorHistory","selection","getDocumentStart","getDocumentEnd","isReadOnly","enableImageResizer","preRender","render","initializeComponents","openBlank","container","style","minHeight","minWidth","getModuleName","onPropertyChanged","model","oldProp","_i","_a","zoomFactor","localizeDialogs","optionsPaneModule","isOptionsPaneShow","showHideOptionsPane","locale","l10n","L10n","setLocale","setCulture","initOptionsPane","initParagraphDialog","pageSetupDialogModule","initPageSetupDialog","fontDialogModule","initFontDialog","hyperlinkDialogModule","initHyperlinkDialog","initContextMenu","listDialogModule","initListDialog","initTablePropertyDialog","initBordersAndShadingsDialog","initCellMarginsDialog","initTableOptionsDialog","tableDialogModule","initTableDialog","styleDialogModule","initStyleDialog","tableOfContentsDialogModule","initTableOfContentDialog","getPersistData","clearPreservedCollectionsInViewer","LayoutViewer","clearDocumentItems","getDocumentEditorElement","fireContentChange","eventArgs","trigger","fireDocumentChange","fireSelectionChange","isCompositionStart","Browser","isDevice","predictText","fireZoomFactorChange","fireViewChange","visiblePages","startPage","endPage","showParagraphDialog","paragraphFormat","isReadOnlyMode","show","showPageSetupDialog","showFontDialog","characterFormat","showCellOptionsDialog","showTableOptionsDialog","showTableDialog","showTableOfContentsDialog","showStyleDialog","showHyperlinkDialog","showBookmarkDialog","bookmarkDialogModule","showStylesDialog","stylesDialogModule","showListDialog","showTablePropertiesDialog","showBordersAndShadingDialog","requiredModules","modules","enablePrint","member","args","enableSfdtExport","enableWordExport","enableTextExport","enableSelection","enableEditor","enableSearch","enableContextMenu","enableOptionsPane","enableHyperlinkDialog","enableTableDialog","enableBookmarkDialog","enableTableOfContentsDialog","enablePageSetupDialog","enableStyleDialog","enableListDialog","enableParagraphDialog","enableFontDialog","enableTablePropertiesDialog","enableBordersAndShadingDialog","enableTableOptionsDialog","open","sfdtText","lists","abstractLists","styles","WStyles","onDocumentChanged","convertJsonToDocument","intializeDefaultStyles","scrollToPage","pageNumber","enableAllModules","Inject","Print","SfdtExport","WordExport","TextExport","Selection","Search","Editor","ImageResizer","EditorHistory","ContextMenu","OptionsPane","HyperlinkDialog","TableDialog","BookmarkDialog","TableOfContentsDialog","PageSetupDialog","StyleDialog","ListDialog","ParagraphDialog","BulletsAndNumberingDialog","FontDialog","TablePropertiesDialog","BordersAndShadingDialog","TableOptionsDialog","CellOptionsDialog","StylesDialog","resize","width","height","updateViewerSize","focusIn","updateFocus","fitPage","pageFitType","print","printWindow","Error","printModule","serialize","sfdtExportModule","save","fileName","formatType","wordExportModule","textExportModule","jsonString","blob","Blob","saveAsBlob","Promise","resolve","reject","section","BodyWidget","sectionFormat","WSectionFormat","paragraph","ParagraphWidget","WParagraphFormat","WCharacterFormat","childWidgets","containerWidget","sections","hfs","parseHeaderFooter","header","footer","evenHeader","evenFooter","firstPageHeader","firstPageFooter","headersFooters","findByName","baseStyle","listFormat","getStyleNames","styleType","getStyles","showDialog","dialogType","showOptionsPane","destroyDependentModules","classList","innerHTML","Property","Event","NotifyPropertyChanges","Component","navigator","userAgent","browserUserAgent","getPageHeight","getPageWidth","printElement","document","createElement","overflow","generatePrintContent","window","write","toString","close","focus","interval","setInterval","ready","clearInterval","htmlString","page","pageHeight","boundingRectangle","pageWidth","isPrinting","renderWidgets","canvasURL","pageCanvas","toDataURL","node","uniqueSectionFormat","ownerBase","getPropertyValue","setPropertyValue","uniqueSectionFormats","hasValue","getPropertyDefaultValue","initializeUniqueSectionFormat","propValue","uniqueSectionFormatTemp","addUniqueSectionFormat","copyFormat","history","isUndoing","isRedoing","updateUniqueSectionFormat","cloneFormat","WLevelOverride","overrideListLevel","levelNumber","startAt","WList","listId","sourceListId","abstractListId","abstractList","levelOverrides","getListLevel","levelOverride","getLevelOverride","levels","mergeList","list","WListFormat","uniqueListFormat","baseListStyle","basedOn","listLevelNumber","WParagraphStyle","initializeUniqueListFormat","uniqueListFormats","uniqueListFormatTemp","addUniqueListFormat","clearFormat","ApplyStyle","getValue","mergeFormat","WTabStop","positionIn","deletePositionIn","justification","leader","position","deletePosition","tabJustification","uniqueParagraphFormat","tabs","getUpdatedTabs","inTabs","tabStops","tab","_b","_c","hasTabStop","concat","filter","a","sort","getListFormatParagraphFormat","level","listLevel","ifListFormat","getDefaultValue","docParagraphFormat","documentParagraphFormat","bodyWidget","initializeUniqueParagraphFormat","uniqueParagraphFormats","uniqueParaFormatTemp","addUniqueParaFormat","updateUniqueParagraphFormat","leftIndent","rightIndent","firstLineIndent","beforeSpacing","afterSpacing","lineSpacing","lineSpacingType","textAlignment","outlineLevel","uniqueCharacterFormat","baseCharStyle","charStyleValue","checkCharacterStyle","baseStyleValue","checkBaseStyle","docCharacterFormat","documentCharacterFormat","name","returnPropertyType","initializeUniqueCharacterFormat","uniqueCharacterFormats","uniqueCharFormatTemp","addUniqueCharacterFormat","isEqualFormat","fontSize","fontFamily","bold","italic","baselineAlignment","underline","fontColor","strikethrough","highlightColor","isSameFormat","updateUniqueCharacterFormat","HelperMethods","insert","spanText","text","slice","join","substring","indexOfAny","wordSplitCharacter","j","temp","lastIndexOfAny","addCssStyle","css","cssText","appendChild","createTextNode","getElementsByTagName","getHighlightColorCode","color","convertPointToPixel","point","round","convertPixelToPoint","pixel","isLinkedFieldCharacter","inline","FieldElementBox","fieldType","fieldEnd","fieldBegin","removeSpace","charAt","replace","trimStart","trimEnd","endsWith","writeCharacterFormat","isInline","styleName","decimalDigits","Math","wordBefore","wordAfter","wordSplitCharacters","Point","xPosition","yPosition","xIn","yIn","copy","WStyle","copyStyle","paraStyle","next","link","WCharacterStyle","charStyle","collection","contains","pop","returnStyle","map","styleObjects","styles_1","returnStyleObject","JSON","stringify","WBorder","uniqueBorderFormat","initializeUniqueBorder","uniqueBorderFormats","uniqueBorderFormatTemp","addUniqueBorderFormat","getLineWidth","lineStyle","lineArray","getBorderLineWidthArray","lineWidth","borderLineArray","abs","getBorderWeight","weight","numberOfLines","getNumberOfLines","borderNumber","getBorderNumber","getPrecedence","border","shadow","space","WBorders","leftIn","rightIn","topIn","bottomIn","horizontalIn","verticalIn","diagonalUpIn","diagonalDownIn","lineWidthIn","left","top","bottom","right","horizontal","vertical","diagonalDown","diagonalUp","valueIn","borders","WShading","uniqueShadingFormat","initializeUniqueShading","uniqueShadingFormats","uniqueShadingTemp","addUniqueShading","shading","backgroundColor","foregroundColor","textureStyle","WTableFormat","owner","uniqueTableFormat","assignTableMarginValue","initializeUniqueTableFormat","uniqueTableFormats","uniqueTableFormatTemp","addUniqueTableFormat","leftMargin","topMargin","rightMargin","bottomMargin","initializeTableBorders","tableFormat","tableAlignment","cellSpacing","preferredWidth","preferredWidthType","WRowFormat","uniqueRowFormat","beforeWidth","afterWidth","heightType","initializeUniqueRowFormat","uniqueRowFormats","uniqueRowFormatTemp","addUniqueRowFormat","allowBreakAcrossPages","isHeader","gridBefore","gridBeforeWidth","gridBeforeWidthType","gridAfter","gridAfterWidth","gridAfterWidthType","WCellFormat","uniqueCellFormat","initializeUniqueCellFormat","uniqueCellFormats","uniqueCellFormatTemp","addUniqueCellFormat","containsMargins","verticalAlignment","cellWidth","columnSpan","rowSpan","Rect","x","y","clone","Widget","bodyWidgets","widget","indexInOwner","previousPage","previousContainer","TableCellWidget","getPreviousSplitWidget","TableRowWidget","HeaderFooterWidget","previousRenderedWidget","lastChild","nextPage","nextContainer","getNextSplitWidget","nextRenderedWidget","firstChild","previous","equals","BlockWidget","getPreviousSplitWidgets","widgets","previousSplitWidget","unshift","getSplitWidgets","nextSplitWidget","combineWidget","root","shift","splitWidget","combine","TableWidget","combineRows","addWidgets","destroyInternal","LineWidget","removeChild","child","margin","BlockContainer","apply","sectionFormatIn","getHierarchicalIndex","hierarchicalIndex","headerFooterType","getTableCellWidget","touchPoint","tableCellWidget","n","chilgWidget","headerWidget","footerWidget","headerFooter","block","isPageBreak","children","getIndex","ownerTable","ownerRow","getContainerWidth","isInsideTable","associatedCell","cellFormat","isEndsWithPageBreak","isEmpty","inlineElement","TextElementBox","ImageElementBox","BookmarkElementBox","getInline","offset","indexInInline","count","isStarted","splittedWidget","k","line","ListTextElementBox","getLength","cloneLine","flags","leftBorderWidth","rightBorderWidth","topBorderWidth","bottomBorderWidth","tableHolder","WTableHolder","spannedRowCollection","row","combineCells","tableCell","getOwnerWidth","isBasedOnViewer","getTableWidth","rowWidth","getTableClientWidth","clientWidth","tableWidth","getCellWidth","containerWidth","cell","getMinimumPreferredWidth","fitCellsToClientArea","factor","rowFormat","calculateGrid","tempGrid","spannedCells","tableCellInfo","rowCellInfo","currOffset","startOffset","columnIndex","removeSpannedCell","rowIndex","m","cellIndex","columns","updateColumnSpans","getGridCount","buildTableColumns","isGridUpdated","resetColumns","rowSpannedCells","isAutoWidth","addColumns","rowSpannedCell","minWidth_1","ownerColumn","validateColumnWidths","fitColumns","setWidthToCells","rw","getMaxRowWidth","updateWidth","dragValue","totalPreferredWidth","getTotalWidth","convertPointToPercent","tablePreferredWidth","ownerWidth","table","getTableOf","getRowOf","fitChildToClientArea","getColumnCellsForSelection","startCell","endCell","cells","start","end","splitWidthToTableCells","tableClientWidth","splitWidthToRowCells","insertTableRowsInternal","tableRows","startIndex","updateRowIndex","getCellStartOffset","tableGrids","headerHeight","description","title","getCellOf","getCell","tableGrid","prevOffset","gridStartIndex","getOffsetIndex","getCellOffset","updateRowBySpannedCells","getPreviousRowSpannedCells","currentRowIndex","spannedCell","include","previousWidget","cellWidget","getContainerTable","previousCell","nextCell","cellPreferredWidth","getCellLeftBorder","leftBorder","cellBorder","rowBorders","tableBorders","getLeftBorderToRenderByHierarchy","prevCell","previousRow","prevRowCell","getPreviousCellLeftBorder","getLeftBorderWidth","getRightBorderWidth","getCellSpacing","actualCellSpacing","hasNoneStyle","prevCellRightBorder","getBorderBasedOnPriority","adjacentBorder","borderWeight","adjacentBorderWeight","borderPriority","adjacentBorderPriority","borderColInRGB","convertHexToRGB","R1","G1","g","B1","adjacentBorderColInRGB","R2","G2","B2","borderBrightness","adjacentBorderBrightness","getCellRightBorder","rightBorder","getRightBorderToRenderByHierarchy","nextWidget","getAdjacentCellRightBorder","nextCellLeftBorder","getCellTopBorder","topBorder","getTopBorderToRenderByHierarchy","prevTopCell","prevRow","getPreviousCellTopBorder","previousTopCell","prevTopCellBottomBorder","getCellBottomBorder","bottomBorder","getBottomBorderToRenderByHierarchy","nextBottomCell","nextRow","getAdjacentCellBottomBorder","prevBottomCellTopBorder","colorCode","colCodeNo","parseInt","paragraphWidget","lineIndex","splitParagraph","lastElement","isFirstLine","isLastLine","getOffset","textIndex","getEndOffset","previousLine","elementBox","ElementBox","linkFieldCharacter","linkFieldTraversingForward","fields","linkFieldTraversingBackwardSeparator","fieldSeparator","isFieldEnd","linkFieldTraversingBackward","previousNode","childNode","prevParagraph","nextLine","childElement","lineWidget","objectCharacter","String","fromCharCode","hasFieldEnd","fieldBeginInternal","fieldSeparatorInternal","fieldEndInternal","field","baselineOffset","span","FieldTextElementBox","fieldText","TabElementBox","tabText","tabLeader","bookmarkTypeIn","refereneceIn","nameIn","reference","bookmarkType","isInlineImage","imageStr","imgElement","isInlineImageIn","isMetaFile","src","image","imageString","isListFollowCharacter","isFollowCharacter","Page","repeatHeaderRowTableWidget","editor","removeFieldInWidget","removePage","tableColumns","getPreviousSpannedCellWidth","previousColumnIndex","curColumnIndex","currentColumnIndex","WColumn","availableWidth","endOffset","isFitColumns","preferredTableWidth","totalColumnWidth","isNaN","column","maxWidth","CONTEXTMENU_COPY","CONTEXTMENU_CUT","CONTEXTMENU_PASTE","CONTEXTMENU_UPDATE_FIELD","CONTEXTMENU_EDIT_FIELD","CONTEXTMENU_HYPERLINK","CONTEXTMENU_OPEN_HYPERLINK","CONTEXTMENU_COPY_HYPERLINK","CONTEXTMENU_REMOVE_HYPERLINK","CONTEXTMENU_EDIT_HYPERLINK","CONTEXTMENU_FONT_DIALOG","CONTEXTMENU_PARAGRAPH","CONTEXTMENU_TABLE","CONTEXTMENU_INSERT_TABLE","CONTEXTMENU_DELETE_TABLE","CONTEXTMENU_INSERT_ABOVE","CONTEXTMENU_INSERT_BELOW","CONTEXTMENU_INSERT_RIGHT","CONTEXTMENU_INSERT_LEFT","CONTEXTMENU_COMPLETE_DELETE_TABLE","CONTEXTMENU_DELETE_ROW","CONTEXTMENU_DELETE_COLUMN","CONTEXTMENU_MERGE_CELL","CONTEXTMENU_CONTINUE_NUMBERING","CONTEXTMENU_RESTART_AT","contextMenuInstance","onContextMenuInternal","event","showHideElements","preventDefault","localValue","contextMenu","containerId","body","ul","listStyle","padding","maxHeight","oncontextmenu","disableBrowserContextmenu","menuItems","getConstant","iconCss","separator","menuOptions","select","handleContextMenuItem","Menu","beforeOpen","caret","showCaret","onClose","cut","pasteInternal","updateToc","navigateHyperlink","copyHyperlink","removeHyperlink","mergeCells","insertRow","insertColumn","deleteTable","deleteRow","deleteColumn","applyContinueNumbering","applyRestartNumbering","getElementById","paste","updateField","editField","font","tableProperties","insertTable","hyperlink","openHyperlink","editHyperlink","continueNumbering","restartAt","display","nextSibling","hideToolTip","copiedData","contextType","listLevelPattern","isCellSelected","getHyperlinkField","isImageField","canMergeCells","previousSibling","parentElement","WAbstractList","abstractListIdIn","WListLevel","uniqueListLevel","followCharacter","numberFormat","restartLevel","initializeUniqueWListLevel","uniqueListLevels","uniqueListLevelTemp","addUniqueWListLevel","dotBullet","squareBullet","arrowBullet","circleBullet","allowLayout","isInitialLoad","maxTextHeight","maxBaseline","maxTextBaseline","isFieldCode","layout","layoutItems","createNewPage","addBodyWidget","clientActiveArea","pageIndex","i_1","prevPage","sectionIndex","insertPage","layoutSection","updateFieldElements","setTimeout","ownerWidget","nextBlock","updateClientAreaForBlock","layoutBlock","layoutHeaderFooter","headerFooterWidget","getCurrentPageHeaderFooter","updateHFClientArea","layoutHeaderFooterItems","updateHeaderFooterToParent","typeIndex","getHeaderFooter","clearTableWidget","linkFieldInHeaderFooter","linkFieldInParagraph","linkFieldInTable","updateClientAreaLocation","pargaraph","shiftChildLocation","clientArea","shiftTop","widgetTop","footerMaxHeight","max","childWidget","shiftChildLocationForTableWidget","tableWidget","shiftChildLocationForTableRowWidget","rowWidget","shiftChildLocationForTableCellWidget","moveToLine","layoutParagraph","layoutTable","addParagraphWidget","area","textHelper","getParagraphMarkWidth","addLineWidget","layoutListItems","layoutEmptyLineWidget","updateClientWidth","layoutLine","updateWidgetToPage","clearLineMeasures","moveElementFromNextLine","layoutElement","nextElement","layoutFieldCharacters","nextNode","moveToNextLine","moveFromNextPage","hasValidElement","getFieldResult","checkAndSplitTabOrLineBreakCharacter","getTextSize","getTabWidth","moveToNextPage","updateFieldText","previousElement","cutClientWidth","textWrap","addElementToLine","currentLine","addSplittedLineWidget","splitTextForClientArea","checkLineWidgetWithClientArea","splitElementForClientArea","elementIndex","getNextValidElementForField","character","splitByLineBreakOrTab","currentElement","splitCurrentWidget","cutFromLeft","splitTextElementWordByWord","fieldStacks","isEmptyLine","isShiftEnter","paragraphMarkSize","getParagraphMarkSize","getBeforeSpacing","getLineSpacing","BaselineOffset","cutFromTop","getListById","clearListElementBox","layoutList","currentListLevel","getListNumber","updateTextSize","addListLevels","val","getListLevelPattern","splittedElementBox","movedElementBox","newLineWidget","splitByWord","getSplitIndexByWord","getWidth","substr","splitByCharacter","textElement","getTextSplitIndexByCharacter","splitWidth","measureTextExcludingSpaceAtEnd","splittedElement","trim","getTextIndexAfterSpace","splittedText","isSplitByWord","textWidth","characterUptoWS","checkPreviousElement","spiltBy","inlineIndex","remainder","newSpan","newText","paraFormat","isParagraphStart","isParagraphEnd","maxDescent","updateLineWidget","measurement","measureText","subWidth","whiteSpaceCount","getWidthAndSpace","getSubWidth","spaceCount","addSubWidth","alignElements","alignLineElements","nextBody","moveBlocksToNextPage","updateClientArea","nextParagraph","insertIndex","isLastElement","getCellContentHeight","enableHeaderAndFooter","shiftFooterChildLocation","top_2","footerDistance","lastTextElement","index_1","lastIndexOf","updateListValues","getListText","getListStartValue","renderedLists","getAbstractListById","startVal","listAdv","listText","levelKey","match","getListTextListLevel","getAsLetter","number","quotient","letter","listValue","getAsRoman","toUpperCase","toLowerCase","getAsLeadingZero","generateNumber","magnitude","numberstring","retval","levelOverrideAdv","fposition","isCustomTab","defaultTabWidth","tabPosition","tabwidth","getRightTabWidth","diff","clientActiveWidth","nextIndex","totalClientWidth","clientActiveAreaWidth","justify","trimSpace","lineText","elementText","isParagraphFirstLine","isParagraphLastLine","lastLineWidget","lastInline","moveNextWidgetsToTable","rowWidgets","moveFromNext","currentRow","currentTable","nextWidgets","addTableCellWidget","maxCellMarginTop","maxCellMarginBottom","prevColumnIndex","cellspace","prevSpannedCellWidth","addWidgetToTable","tableCollection","rowCollection","endRowWidget","prevWidget","rowWidgetIndex","prevIndex","addTableWidget","updateRowHeightBySpannedCell","updateRowHeightByCellSpacing","updateHeightForRowWidget","updateSpannedRowCollection","prevRowWidget","updateRowHeight","mergedCellHeight","isRowSpanEnd","splittedCellWidgets","splittedCell","isVerticalMergedCellContinue","colIndex","splitWidgets","tableRowWidget","isLastRow","isFirstLineFitForRow","getSplittedWidgetForRow","insertSplittedCellWidgets","getSplittedWidget","updateWidgetLocation","updateWidgetsToTable","tableWidgets","rowHeight","getRowHeight","isAllowBreakAcrossPages","moveRowToNextTable","continueHeader","isInsertSplittedWidgets","updateWidgetsToPage","prevBodyWidget","curretTable","currentRenderingPage","updateChildLocationForRow","getHeader","getHeaderHeight","flag","row_1","updateWidgetToRow","lastWidget","cellHeight","isUpdateVerticalPosition","isLayouted","cellspacing","currentRowWidgetIndex","rowSpanWidgetEndIndex","splitSpannedCellWidget","spanEndRowWidget","childWidget_1","updateHeightForCellWidget","updateCellVerticalPosition","updateHeightForTableWidget","previousRowIndex","insertRowSpannedWidget","length_1","insertEmptySplittedCellWidget","previousLeft","emptyCellWidget","createCellWidget","splitMinimalWidget","splittedPara","getSplittedWidgetForPara","tableCol","tableHeight","splittedTable","getSplittedWidgetForTable","createTableWidget","newTable","lineBottom","rowBottom","splittedRow","allowRowBreakAcrossPages","isFirstLineFitForPara","paraWidget","cellwidget","isFirstLineFitInShiftWidgets","containerCellWidget","isFirstLineFitForTable","isFit","isFirstLineFitForCell","updateChildLocationForTable","spacing","updateChildLocationForCell","isUpdateToTop","displacement","getDisplacement","updateCellContentVerticalPosition","location","updateTableWidgetLocation","cellContentHeight","contentHeight","getTableLeftBorder","getTableRightBorder","getTableTopBorder","getTableBottomBorder","getCellDiagonalUpBorder","getCellDiagonalDownBorder","layoutNextItemsBlock","blockAdv","blockToShift","updateNextBlockList","currentWidget","blocks","isInsertingTOC","updateContainerWidget","getFirstParagraphInFirstCell","updateWholeListItems","updateListItemsTillEnd","updateClientAreaForLine","startLineWidget","getTop","getParentTable","reLayoutParagraph","elementBoxIndex","layoutBodyWidgetCollection","reLayoutTable","reLayoutLine","isInHeaderFooter","updateHCFClientAreaWithTop","isBlockInHeader","block_1","clearPosition","clearHeight","clearRowWidget","clearCellWidget","blockIndex","shiftNextWidget","curretBlock","checkAndGetBlock","currentParagraph","shiftNextWidgets","tableView","updateClientAreaTopOrLeft","layoutRow","tables","rows","addTableRowWidget","updateClientAreaForRow","layoutCell","getMaxTopOrBottomCellMargin","borderWidth","topOrBottom","updateClientAreaForCell","shiftLayoutedItems","reLayoutOrShiftWidgets","removeEmptyPages","fieldCode","getFieldCode","shiftWidgetsBlock","updateRenderedListItems","shiftWidgetsForPara","shiftWidgetsForTable","prevBodyObj","getBodyWidgetOfPreviousBlock","shiftToPreviousWidget","updateClientAreaByWidget","isFitInClientArea","nextBodyWidget","createOrGetNextBodyWidget","previousBlock","isSplittedToNewPage","shiftTableWidget","shiftRowWidget","shiftCellWidget","shiftParagraphWidget","prevObj","updateVerticalPositionToTop","combinedTable","isUpdateTop","tablewidget","previousBodyWidget","firstLine","maxElementHeight","getMaxElementHeight","paragraphView","widgetIndex","updateParagraphWidgetInternal","activeArea","lastLine","newParagraphWidget","destroyAndScroll","scrollToBottom","createSplitBody","lastBlock","newBody","lineToLayout","Renderer","pageLeft","pageTop","pageCanvasIn","getContext","containerCanvas","selectionCanvas","getColor","pageContext","fillStyle","beginPath","fillRect","closePath","strokeStyle","strokeRect","setPageSize","rect","clip","renderHFWidgets","renderHeaderSeparator","restore","clearRect","selectionContext","dpr","devicePixelRatio","globalAlpha","scale","cliped","widgetHeight","headerFooterHeight","getScaledValue","renderWidget","ctx","min","renderDashLine","getHeaderFooterType","renderHeaderFooterMark","renderHeaderFooterMarkText","footerHeight","differentFirstPage","differentOddAndEvenPages","isSmallDash","setLineDash","moveTo","lineTo","stroke","w","h","content","textBaseline","fillText","renderHeader","renderParagraphWidget","renderTableWidget","renderTableCellWidget","renderLine","renderTableRowWidget","renderTableOutline","visibleBounds","selectedWidgets","addSelectionHighlightTable","renderTableCellOutline","clipRect","addSelectionHighlight","searchHighlighters","widgetInfo","toSkipFieldCode","underlineY","getUnderlineYPosition","renderListTextElementBox","renderImageElementBox","renderTextElementBox","lineHeight","breakCharacterFormat","renderUnderline","renderStrikeThrough","isHeightType","scaledWidth","tabElement","getTabLeader","tabString","getTabLeaderString","floor","xPos","yPos","renderedHeight","underlineHeight","lineCount","widgetWidth","isClipped","containerWid","drawImage","renderSingleBorder","cellTopMargin","cellBottomMargin","cellLeftMargin","cellRightMargin","renderCellBackground","nextRowIsInCurrentTableWidget","nextRowWidget","bgColor","top_1","startX","startY","endX","endY","TextHelper","context","containerContext","paragraphMark","getHeight","textTrimEndWidth","getFormatText","heightInfoCollection","sizeInfo","getHeightInternal","formatText","toLocaleLowerCase","textHeight","spanElement","whiteSpace","innerText","applyStyle","parentDiv","tempDiv","setAttribute","offsetHeight","textTopVal","offsetTop","lineBreakMark","fontWeight","fontStyle","listCharacterFormat","Zoom","onMouseWheelInternal","ctrlKey","pageX","viewerContainer","offsetLeft","pageContainer","offsetWidth","wheel","detail","wheelDelta","setZoomFactor","onZoomFactorChanged","updateCaretPosition","updateTouchMarkPosition","updateImageResizerPosition","zoom","clearContent","handleZoom","currentPage","selectionStartPageIn","selectionEndPageIn","tableLefts","tapCount","timer","isTimerStarted","preZoomFactor","preDifference","fieldEndParagraph","fieldToLayout","containerTop","containerLeft","isMouseDown","isSelectionChangedOnMouseMoved","isControlPressed","isTouchInput","useTouchSelectionMark","touchDownOnSelectionMark","isComposingIME","lastComposedText","isCompositionUpdated","isCompositionCanceled","isCompositionEnd","prefix","suffix","preDefinedStyles","isRowOrCellResizing","isMouseDownInFooterRegion","pageFitTypeIn","fieldCollection","isPageField","mouseDownOffset","zoomFactorInternal","onTextInput","data","handleTextInput","compositionStart","positionEditableTarget","editorHistory","initComplexHistory","compositionUpdated","insertIMEText","getEditableDivTextContent","compositionEnd","iframe","editableDiv","updateComplexHistory","undo","redoStack","onImageResizer","isImageResizerVisible","isImageResizing","MouseEvent","onMouseUpInternal","TouchEvent","onTouchUpInternal","onKeyPressInternal","keyCode","charCode","char","onTextInputInternal","onPaste","onFocusOut","hideCaret","scrollHandler","vtHeight","scrollTop","onWindowResize","resizeTimer","updateViewerSizeInternal","clearTimeout","onContextMenu","onMouseDownInternal","offsetX","offsetY","clientHeight","updateCursor","isLeftButtonPressed","enableImageResizerMode","selectedResizeElement","cursorPoint","findFocusedPage","isCursorInsidePageRect","isCursorInFooterRegion","tableResize","isInCellResizerArea","isInRowResizerArea","startingPoint","handleResize","which","checkCursorIsInSelection","getLineWidget","onMouseMoveInternal","isImageMoveToNextPage","handleImageResizingOnMouse","handleResizing","updateTextPositionForSelection","touchY","textPosition","touchPoint_1","moveTextPosition","checkForCursorVisibility","onDoubleTap","checkAndEnableHeaderFooter","selectCurrentWord","isListTextSelected","isIE","updateResizingHistory","isImageSelected","navigateHyperLinkOnEvent","isSelectionInListText","selectListText","mouseUpInternal","scrollToPosition","updateHistoryForImageResizer","imageResizer","leftValue","topValue","onTouchStartInternal","touches","zoomX","clientX","zoomY","clientY","getTouchOffsetValue","resizeObj","getImagePointOnTouch","selectedElement","getCaretBottom","onTouchMoveInternal","touch","handleImageResizingOnTouch","currentDiff","sqrt","pow","onPinchOutInternal","onPinchInInternal","changedTouches","touchStart","touchEnd","onKeyUpInternal","getSelection","anchorOffset","setEditableDivCaretPosition","onKeyDownInternal","isHandled","keyEventArgs","ctrl","metaKey","shiftKey","alt","altKey","initalizeStyles","bookmarks","containerCanvasIn","selectionCanvasIn","visibleBoundsIn","zoomModule","dialogInternal","initDialog","dialogInternal2","initDialog2","onPageFitTypeChanged","getListLevelNumber","getBookmarks","includeHidden","bookmark","optionsPaneContainer","className","tabIndex","outline","pointerEvents","createEditableDiv","createEditableIFrame","initializeImageResizer","initTouchEllipse","wireEvent","contentEditable","attrs","scrolling","contentDocument","initCaret","addEventListener","info","textContent","getRect","getSelectionPage","updateCaretSize","iframeStyle","dialogTarget","Dialog","showCloseIcon","allowDragging","visible","isModal","X","Y","zIndex","beforeClose","appendTo","tocStyles","tocBookmarkId","selectRange","documentStart","ellipse","getPage","pageGap","getLeftValue","isInsideRect","selectionLineWidget","button","getBoundingClientRect","touchOffsetValues","pageY","updatedZoomFactor","optionsRect","optionsPane","ceil","beforeLayout","currentResizingTable","resizerPosition","headerDistance","updateClientAreaForTable","POSITIVE_INFINITY","updateTextPosition","selectCurrentParagraph","startPosition","endPosition","getLineWidgetInternal","prevLineWidget","prevTop","scrollLeft","caretInfo","caretHeight","updateCaretToPage","scrollBarWidth","isMouseDragged","pageBottom","getPageTop","getLineWidgetBodyWidget","clearSelectionHighlight","clearSelectionHighlightInSelectedWidgets","scrollToLastPage","containerHeight","fieldCodes","split","fieldCategory","fieldPattern","getFieldText","pattern","unWireEvent","removeEventListener","hyperlinkField","div","isRowResize","isCellResize","resizePosition","getImagePoint","lineLeft","getLineStartLeft","getHyperLinkFieldInCurrentSelection","updateTextPositionIn","getLeft","setHyperlinkContentToToolTip","cursor","currentPoint","updateCurrentPage","pageRight","prevScaleFactor","verticalHeight","horizontalWidth","horWidth","prevPageTop","prevY","prevValue","prevX","getCurrentHeaderFooter","createHeaderFooterWidget","viewerWidth","viewerHeight","displayPixelRatio","updateScrollBarPosition","parseFloat","updateVisiblePages","pageH","left_1","addVisiblePage","setImageResizerPositions","renderPage","renderVisiblePages","json","jsonObject","parse","parseCharacterFormat","parseParagraphFormat","background","parseAbstractList","parseList","parseStyles","parseSections","parseStyle","wStyle","basedStyle","getStyle","styleString","linkStyle","charaStyle","nextStyleString","abstract","parseListLevel","listCollection","parseLevelOverride","parseSectionFormat","parseTextBody","oddHeader","oddFooter","parseBody","styleObj","inlines","parseParagraph","parseTable","parseTableFormat","tableRow","parseRowFormat","parseRowGridValues","parseCellFormat","writeInlineFormat","lineWidgetCount","bookmarkStart","sourceFormat","parseBorders","parseShading","isSamePaddingAsTable","parseCellMargin","sourceBorders","destBorder","parseBorder","sourceBorder","sourceShading","destShading","texture","inlineFormat","parseListFormat","parseTabStop","wTabs","tabStop","SelectionCharacterFormat","boldIn","italicIn","underlineIn","strikeThroughIn","baselineAlignmentIn","highlightColorIn","fontSizeIn","fontColorIn","notifyPropertyChanged","fontFamilyIn","propertyName","isCleared","isRetrieveFormatting","propertyValue","onApplyCharacterFormat","combineFormat","selectionCharacterFormat","SelectionParagraphFormat","leftIndentIn","rightIndentIn","beforeSpacingIn","afterSpacingIn","textAlignmentIn","firstLineIndentIn","lineSpacingIn","lineSpacingTypeIn","listLevelNumberIn","levelPattern","listTextElement","getListTextElementBox","onApplyListInternal","onApplyParagraphFormat","copyToFormat","getList","currentAbstractList","cloneListLevel","cloneLevelOverride","setList","onApplyList","history_1","setOffsetValue","updateListChangesInHistory","updateListParagraphs","applyListChanges","layoutWholeDocument","updateSelectionTextPosition","currentBaseHistoryInfo","modifiedProperties","updateSelection","updateHistory","SelectionSectionFormat","differentFirstPageIn","differentOddAndEvenPagesIn","pageHeightIn","pageWidthIn","leftMarginIn","bottomMarginIn","topMarginIn","rightMarginIn","headerDistanceIn","footerDistanceIn","getPropertyvalue","onApplySectionFormat","SelectionTableFormat","backgroundIn","tableAlignmentIn","cellSpacingIn","preferredWidthIn","tableIn","preferredWidthTypeIn","onApplyTableFormat","SelectionCellFormat","verticalAlignmentIn","onApplyTableCellFormat","clearCellFormat","SelectionRowFormat","heightIn","heightTypeIn","isHeaderIn","allowRowBreakAcrossPagesIn","onApplyTableRowFormat","clearRowFormat","SelectionImageFormat","updateImageFormat","onImageFormat","copyImageFormat","clearImageFormat","HtmlExport","fieldCheck","writeHtml","html","serializeSection","string","serializeParagraph","serializeTable","blockStyle","tagAttributes","serializeParagraphStyle","createAttributesTag","serializeInlines","endTag","serializeImageContainer","serializeInlineStyle","serializeSpan","spanClass","decodeHtmlNames","imageStyle","imageSource","serializeCell","cellHtml","serializeCellBordersStyle","createTableStartTag","serializeRow","createTableEndTag","createRowStartTag","isList","paragraphClass","serializeCharacterFormat","serializeParagraphFormat","serializeTableBorderStyle","borderStyle","convertBorderLineStyle","serializeBorderStyle","borderPosition","tagValue","localProperties","sb","createTag","s","tableStyle","createRowEndTag","htmlText","TextPosition","isUpdateLocation","getStartOffset","getLineLength","getHierarchicalIndexInternal","setPositionForSelection","physicalLocation","isLastRenderedInline","getParagraphLength","setPositionFromLine","setPosition","positionAtStart","updatePhysicalPosition","setPositionInternal","setPositionForCurrentIndex","getParagraphWidget","setPositionParagraph","newValue","moveNextLine","getPhysicalPositionInternal","isAtSamePosition","isInSameParagraph","isExistBefore","isExistAfter","startParagraph","endParagraph","offsetInLine","setPositionForLineWidget","lineLength","nextLineWidget","getNextRenderedBlock","prevLine","currentOffSet","moveNextPosition","isNavigate","getNextStartInline","moveNextPositionInternal","fieldEndOffset","fieldEndIndex","isForwardSelection","moveToInline","nextOffset","getNextValidOffset","nextValidInline","getNextValidElement","getStartLineOffset","inlineObj","updateOffsetToNextParagraph","moveToPreviousParagraphInTable","previousParagraph","currentPara","getPreviousSelectionCell","getPreviousParagraphBlock","isHighlight","getNextSelectionBlock","getContainerCellOf","getNextParagraphBlock","updateOffsetToPrevPosition","inlineInfo","getPreviousValidOffset","getPreviousSelectionBlock","previousInline","getPreviousValidElement","moveToNextParagraphStartInternal","movePreviousPosition","movePreviousPositionInternal","hasValidInline","moveBackward","nextInline","getNextRenderedElementBox","fieldBeginOffset","moveForward","fieldBeginIndex","selectionStartIndex","selectionStartInlineObj","selectionStartInline","inlineObj_1","selectionStart","selectionEnd","moveToWordStartInternal","getPreviousWordOffset","calculateOffset","getNextWordOffset","isInField","endSelection","excludeSpace","getNextWordOffsetSpan","getNextWordOffsetImage","getNextWordOffsetFieldBegin","getNextWordOffsetFieldSeperator","getNextWordOffsetFieldEnd","wordEndIndex","txt","getPreviousWordOffsetSpan","getPreviousWordOffsetImage","getPreviousWordOffsetFieldBegin","getPreviousWordOffsetFieldSeparator","getPreviousWordOffsetFieldEnd","getPreviousWordOffsetBookMark","wordStartIndex","setPreviousWordOffset","validateForwardFieldSelection","currentIndex","selectionEndIndex","isPositionMoved","validateBackwardFieldSelection","paragraphStartInternal","moveToPreviousParagraph","moveToNextParagraphInTableCheck","paragraphValue","moveToParagraphStartInternal","moveToParagraphEndInternal","moveToNextParagraph","splittedParagraph","moveToNextParagraphInTable","moveUp","moveToLineStartInternal","getFirstCellInRegion","lastParagraph","getLastParagraph","prevBlock","getLastBlockInLastCell","getLineWidgetParagraph","upDownSelectionLength","getLastCellInRegion","updateTextPositionWidget","moveDown","moveToLineEndInternal","getFirstParagraph","getFirstBlockInFirstCell","moveToPreviousLine","firstElement","getFirstElementInternal","getIndexInInline","prevInline","moveToWordEndInternal","incrementValue","getNextSelectionCell","moveUpInTable","lineStart","isMoveToLineEnd","moveDownInTable","firstItemWidth","getLeftInternal","isPositionUpdated","isBackwardSelection","containerCell","getSelectedCell","isInContainerCell","containsCell","isContainerCellSelected","isAtParagraphStart","getContainerCell","isForward","SelectionWidgetInfo","widthIn","fieldBeginAdv","linkInternal","localRef","opensNewWindow","parseFieldValues","typeInternal","codes","isLocalRef","code","parseFieldValue","setLinkType","endChar","endIndex","navigationLink","ImageFormat","imageContainer","documentEditor","isSkipLayouting","contextTypeInternal","skipFormatRetrieval","isMoveDownOrMoveUp","characterFormatIn","paragraphFormatIn","rowFormatIn","cellFormatIn","tableFormatIn","imageFormatInternal","htmlWriterIn","startInternal","endInternal","selectionStartPage","selectionEndPage","getText","goToHeader","enableHeadersFootersRegion","goToFooter","closeHeaderFooter","disableHeaderFooter","goToPage","updateTextPositionForBlockContainer","selectTable","selectTableInternal","selectRow","selectTableRow","selectColumn","selectColumnInternal","selectCell","selectTableCell","selectionSettings","pageCoordinates","extend","toggleBold","toggleItalic","toggleUnderline","toggleStrikethrough","toggleHighlightColor","toggleSubscript","toggleSuperscript","toggleTextAlignment","increaseIndent","decreaseIndent","fireRequestNavigate","linkType","localReference","navigateBookmark","hyperLinkField","linkText","getLinkText","copyToClipboard","highlightSelection","isSelectionChanged","hideImageResizer","highlightSelectedContent","createHighlightBorder","selectionWidget","clipSelection","createHighlightBorderInsideTable","isVisiblePage","canvasContext","fillColor","copyInsertFormat","heightInfo","descent","removeSelectionHighlight","currentParaWidget","pageRect","selectCurrentWordRange","fireSelectionChanged","wordStart","extendToParagraphStart","extendToParagraphEnd","updateForwardSelection","updateBackwardSelection","extendToPreviousLine","extendToLineEnd","extendToLineStart","firstrow","firstcell","selectionLength","isMovePrevious","cellStart","getCellLeft","cellEnd","cellLeft","firstBlock","getFirstParagraphBlock","lastrow","lastcell","moveToLineStart","moveToLineEnd","setPositionForBlock","lastPage","handleControlEndKey","documentEnd","selectContent","handleControlHomeKey","handleControlLeftKey","extendToWordStart","handleControlRightKey","extendToWordEnd","handleControlDownKey","handleControlUpKey","handleShiftLeftKey","extendBackward","handleShiftUpKey","handleShiftRightKey","extendForward","handleShiftDownKey","extendToNextLine","handleControlShiftLeftKey","handleControlShiftUpKey","handleControlShiftRightKey","handleControlShiftDownKey","handleLeftKey","handleUpKey","handleRightKey","handleEndKey","handleHomeKey","handleDownKey","handleShiftEndKey","handleShiftHomeKey","handleControlShiftEndKey","handleControlShiftHomeKey","handleTabKey","isNavigateInCell","isShiftTab","selectPreviousCell","selectNextCell","updateListLevel","selectTableCellInternal","clearMultiSelection","firstParagraph","selectParagraph","firstLineWidget","getTable","firstPara","lastPara","getLastParagraphBlock","selectPosition","startTextPos","endTextPos","columnCells","startCellColumnCells","endCellColumnCells","startPos","endPos","selectAll","getContainerWidget","extendToWordStartEnd","isNavigation","getTextPosition","includeObject","getTextInternal","startInlineObj","elementInfo","getRenderedInline","endInlineObj","endInline","getTextInline","nextParagraphWidget","paragarph","endParagraphWidget","startLineIndex","getFieldCodeInternal","getTocFieldInternal","getNextParagraph","getPreviousParagraph","getFirstParagraphInCell","getLastParagraphInLastCell","getLastParagraphInFirstRow","getPreviousTextInline","getNextTextInline","cell1","cell2","isExistBeforeInline","currentInline","isExistAfterInline","getPreviousRenderedBlock","getNextParagraphCell","getFirstBlockInNextHeaderFooter","getLastBlockInPreviousHeaderFooter","getPreviousParagraphCell","endLine","getLineInfo","childLength","getElementInfo","getPreviousParagraphSelection","getFirstParagraphInLastRow","getPreviousSelectionRow","getNextParagraphSelection","getNextSelection","getNextSelectionRow","getCellInTable","getPreviousSelection","selLength","isMovePrev","validOffset","size","maxBaselineOffset","getPhysicalPositionInline","startInline","fieldValue","elementBoxObj","getElementBoxInternal","positionImageResizer","showImageResizer","highlight","highlightCell","startElement","endElement","endLineWidget","startLineObj","getStartLineWidget","endLineObj","getEndLineWidget","highlightParagraph","highlightNextBlock","highlightTable","getLineWidgetInternalInline","linewidget","highlightCells","endCellLeft","endCellRight","tableWidgetCollection","startTableIndex","endTableIndex","highlightRow","startRowIndex","endRowIndex","highlightInternal","getNextParagraphRow","getPreviousParagraphRow","containsRow","highlightCellWidget","sourceCell","getSelectedCells","highlightContainer","previousValidInline","validateTextPosition","getElementBox","getFieldCharacterPosition","getNextLineWidget","getPreviousTextElement","getNextTextElement","measureObj","firstInline","getEndPosition","getRenderedField","elementObj","getCaretHeight","isEmptySelection","isItalic","getFieldCharacterHeight","heightElement","maxLineHeight","textSizeInfo","charHeight","elementHeight","top_3","isNonEmptySelection","clearChildSelectionHighlight","clearSelectionHighlightLineWidget","getLineWidgetParaWidget","getLineWidgetTableWidget","getLineWidgetRowWidget","leftCellSpacing","rightCellSpacing","topCellSpacing","bottomCellSpacing","getLineWidgetCellWidget","getFirstBlock","caretPosition","isImageSelectedObj","selectInternal","includeParagraphMark","elementValues","getFirstElement","prevWidth","charIndex","curIndex","textMetrics","isLineEnd","updatePositionObj","selectFirstBlock","selects","skipSelectionChange","retrieveCurrentFormatProperties","retrieveImageFormat","retrieveCharacterFormat","retrieveParagraphFormat","retrieveSectionFormat","retrieveTableFormat","imageFormat","setCurrentContextType","contextIsinImage","contextIsinTable","tocField","isInHeader","tableAdv","retrieveCellFormat","retrieveRowFormat","getCellFormat","getRowFormat","tempTableRow","startTable","endTable","startParaSection","endParaSection","startPageIndex","endPageIndex","getParagraphFormatForSelection","getParagraphFormatInternalInParagraph","getParagraphFormatInternalInCell","getParagraphFormatInternalInBlock","getParagraphFormatInternalInTable","getParagraphFormatInCell","getParagraphFormatInBlock","getParagraphFormatInParagraph","getParagraphFormatInTable","cellAdv","getParagraphFormatInRow","getParaFormatForCell","startCellIn","endCellIn","para","elemInfo","getCharacterFormatForSelection","getCharacterFormatInTableCell","getCharacterFormat","getCharacterFormatForTableRow","tableRowAdv","getCharacterFormatForSelectionCell","getCharacterFormatForBlock","getCharacterFormatInternalInTable","startIn","endIn","setCharacterFormat","isFieldStartSelected","fieldInline","getCharacterFormatInternal","inlineAndIndex","getNextValidCharacterFormatOfField","getNextValidCharacterFormat","getCharacterFormatInTable","isSelected","top_4","copySelectionParagraphFormat","getHyperlinkDisplayText","isNestedField","displayText","toolTipElement","toolTipText","top_5","showToolTip","toolTipField","toolTipObject","Popup","relateTo","hide","cursorPosition","lineStartLeft","checkedFields","getHyperLinkFields","getHyperLinkFieldInternal","paragraphIsInFieldResult","inlineIsInFieldResult","getBlock","bodyIndex","getBlockInternal","fieldParagraph","selectionIndex","highlightListText","updateImageSize","getSelectedCellsInTable","startColumnIndex","endColumnIndex","startRowindex","copySelectedContent","isCut","htmlWriter","handleCut","htmlContent","removeAllRanges","range","createRange","selectNodeContents","addRange","copySuccess","execCommand","e","parentNode","caretLeft","caretStartLeft","caretEndLeft","page_1","childNodes","setStart","collapse","top_6","skipUpdate","paragraphInfo","transform","caretHeightInfo","searchResults","pagePoint","isCursorInHeaderRegion","moveToStart","bookmrkElmnt","bookmrkEnd","endoffset","selectBookmark","getTocField","tocPara","isTocStyle","TextSearch","isFooter","find","findOption","findNext","hierarchicalPosition","stringToRegex","textSearchResults","clearResults","results","findDocument","currentSearchResult","textToFind","option","RegExp","isPatternEmpty","wordEmpty","patternRegExp","findAll","isFirstMatch","hierachicalPosition","findInline","findInlineText","inlineEle","stringBuilder","spans","matchObject","matches","exec","result","addResult","spanKeys","spanLength","SearchWidgetInfo","leftInternal","widthInternal","TextSearchResult","TextSearchResults","innerList","textSearchResult","SearchResults","search","navigate","textToReplace","replaceInternal","replaceAll","replaceAllInternal","clearSearchHighlight","isHandledOddPageHeader","isHandledEvenPageHeader","isHandledOddPageFooter","isHandledEvenPageFooter","textSearch","searchResultsInternal","findOptions","replaceText","insertText","endTextPosition","currentHistoryInfo","updateComplexWithoutHistory","highlightResult","highlightSearchResult","highlightSearchResultParaWidget","findHighLight","addSearchHighlightBorder","highlighters","searchHighlight","addSearchResultItems","addFindResultView","addFindResultViewForSearch","suffixtext","lastIndex","boxObj","box","boxIndex","shiftIndex","headerFooterString","listElement","layoutViewer","matchCase","wholeWord","searchText","resultsText","messageDivText","replaceButtonText","replaceAllButtonText","focusedIndex","focusedElement","isOptionsPane","replacePaneText","findPaneText","matchDivReplaceText","tabInstance","isReplace","selectedTabItem","previousIndex","selectedIndex","previousTab","querySelector","nextTab","insertBefore","firstElementChild","onFindPane","onReplacePane","searchOptionChange","clearSearchResultItems","inputText","searchInput","navigateSearchResult","messageDiv","localeValue","resultContainer","resultsListBlock","clearFocusElement","wholeWordsChange","matchInput","checked","wholeInput","matchChange","onWireEvents","searchIcon","searchIconClickInternal","navigateToNextResult","navigateNextResultButtonClick","navigateToPreviousResult","navigatePreviousResultButtonClick","onKeyDown","onEnableDisableReplaceButton","resultListBlockClick","closeButton","replaceButton","onReplaceButtonClick","replaceAllButton","onReplaceAllButtonClick","replaceDiv","occurrenceDiv","replaceTabContentDiv","findDiv","findTabButtonHeader","replaceTabButtonHeader","getMessageDivHeight","disabled","replaceWith","onKeyDownOnOptionPane","focusIndex","HTMLInputElement","HTMLLIElement","click","findText","selectionText","inputElement","matchDiv","patterns","resultsContainerHeight","currentelement","listElementsDiv","liElement","listElements","currentlist","list_1","searchDiv","closeSpan","findTab","tabHeader","findTabButton","replaceTabButton","tabContent","findTabContent","findTabContentDiv","searchTextBoxContainer","placeholder","CheckBox","label","change","replaceTabContent","createReplacePane","Tab","selected","findHeader","getElementsByClassName","replaceHeader","replaceButtonDiv","emptyDiv6","currentIndexValue","blur","text_1","scrollHeight","hideTab","textBox","selectedText","resultListBox","message","TableResizer","resizeNode","initResizingHistory","getRowReSizerPosition","getCellReSizerPosition","getTableWidget","startingPointX","resizerBoundaryWidth","getCellReSizerPositionInternal","childTableWidget","getTableWidgetFromWidget","childCellWidget","getActualWidth","resizeTableCellColumn","resizeTableRow","parentTable","reLayout","currentHeight","selectionFlag","setPreferredWidth","newIndent","resizeColumnWithSelection","rightColumn","prevDragValue","newWidth","dragOffset","updateCellPreferredWidths","updateGridValue","resizeColumnAtLastColumnIndex","resizeCellAtMiddle","selectedCells","resizeColumnAtStart","leftColumnCollection","getColumnCells","increaseOrDecreaseWidth","updateRowsGridAfterWidth","rightColumnCollection","isColumnResizing","isColumnSelected","changeWidthOfCells","selectedRow","newGridBefore","updateGridBefore","leastGridBefore","getLeastGridBefore","updateWidthForCells","hasTableWidth","leftColumn","isContinue","isUpdate","getOffsetValue","isLeftSideCollection","ignoreRow","isIncrease","minimumWidth","isSelection","maxRowWidth","currentRowWidth","getRowWidth","toUpdateGridAfter","leftColumnCells","rightColumnCells","columnCell","applyProperties","tableHistoryInfo","isAutoFit","updateGridBeforeWidth","updateGridAfterWidth","nodes","editHyperlinkInternal","isHandledComplex","refListNumber","incrementListNumber","removedBookmarkElements","pageRefFields","isBordersAndShadingDialog","nbsp","lineFeed","textBoxText","handleBackKey","insertField","fieldCodeSpan","fieldResultSpan","pasteContentsInternal","clearDirectFormatting","clearFormatting","getCompleteStyles","action","getPrefixAndSuffix","boxInfo","spaceIndex","prefixAdded","endInlineInfo","suffixAdded","toggleBaselineAlignment","acceptTab","handleEnterKey","handleDelete","handleShiftEnter","insertPageBreak","redo","onBackSpace","onDelete","onEnter","animationTimer","insertFormat","sFormat","insertPosition","isRemoved","initHistory","getParagraphInfo","editPosition","removeSelectedContents","updateInsertPosition","insertTextInline","tempSpan","splittedSpan","updateEndPosition","isSelectionOnHyperlink","checkAndConvertList","checkAndConvertToHyperlink","insertSectionBreak","insertSection","newSectionFormat","newParagraph","splitTable","updateNextBlocksIndex","splitParagraphInternal","splitBodyWidget","startBlock","newBodyWidget","updateSectionIndex","insertRemoveHeaderFooter","updateBlockIndex","startBodyWidget","increaseIndex","currentSectionIndex","isTab","convertList","isLeadingZero","tabValue","previousText","checkNumberFormat","checkLeadingZero","deleteSelectedContents","leadingZeroText","autoConvertList","newList","newAbstractList","isBullet","isZero","getPageFromBlockWidget","insertImageText","insertFieldBeginText","insertFieldSeparatorText","insertFieldEndText","insertBookMarkText","spanObj","spanIndex","previousInlineObj","nextInlineObj","isEnter","tabCharIndex","lowerCaseText","containsURL","atIndex","dotIndex","autoFormatHyperlink","url","blockInfo","createHyperlinkElement","appylingHyperlinkFormat","updateCharacterFormatWithUpdate","initInsertInline","begin","insertHyperlinkfield","isBookmark","unLinkFieldCharacter","fieldIndex","insertHyperlink","insertHyperlinkInternal","fieldStartPosition","insertHyperlinkByFormat","insertElement","insertInlineInSelection","insertElementInCurrentLine","isReLayout","checkIsNotRedoing","checkEndPosition","updateHistoryPosition","fieldResult","fieldObj","newFieldBegin","insertInlineInternal","removedNodes","insertClonedFieldResult","getClonedFieldResultWithSel","getClonedFieldResult","insertParagraph","insertBlock","curParagraph","fieldSeparatorPosition","pasteWindow","pasteLocal","clipboardData","getData","pasteContents","document_1","getBlocks","pasteContent","arr","insertParaFormat","removeSelectedContentInternal","pasteCopiedData","insertTableRows","insertBlockInternal","insertTableInternal","moveRows","removeBlock","insertBlockTable","moveInlines","checkInsertPosition","deleteSelectedContent","curInline","insertElementInternal","prevElement","newElement","relayout","startPara","insertNewParagraphWidget","insertImage","insertPicture","createTable","startLine","above","rowPlacement","getOwnerCell","cloneTableToHistoryInfo","rowCount","getRowCountToInsert","isAffectedByRowSpannedCell","cellCountInfo","updateRowspan","newRow","createRowAndColumn","updateCellFormatForInsertedRow","cellFormats","isCellIncluded","isRowSpanned","clonedRowIndex","columnPlacement","newCell","columnCount","getColumnCountToInsert","createColumn","isCellInserted","j_1","rowCell","getOwnerRow","isStart","startRow","endRow","getOwnerTable","mergeSelectedCellsInTable","startOwnerCell","endOwnerCell","mergedCell","mergeSelectedCells","cellInfo","updateSelectedCellsInTable","rowStartIndex","mergeBorders","updateBlockIndexAfterMerge","mergedCellborders","cellBorders","startCellIndex","canMergeSelectedCellsInTable","startLeft","endLeft","selectionLeft","selectionRight","isRowLeftWithinSel","isRowRightWithinSel","rowLeft","rowRight","checkCellWithInSelection","isPrevCellWithinSel","checkPrevOrNextCellIsWithinSel","isNextCellWithinSel","isNoRowSpan","isCellWithInSel","checkCurrentCell","checkCellWidth","isPrev","prevOrNextCell","isPrevCellWithInSel","cellOwner","spannedCellOwner","checkRowSpannedCells","insertAfter","insertIndex_1","isMoved","moveContent","removeEmptyLine","updateHeaderFooterWidget","isHandledComplexHistory","updateHeaderFooterWidgetToPage","shiftPageContent","isEvenPage","updateHeaderFooterWidgetToPageInternal","hfWidget","headerOrFooter","removeFieldInBlock","removeFieldTable","removeField","checkAndShiftFromBottom","update","isAtParagraphEnd","applyCharFormatValue","applyCharacterFormatForListText","updateSelectionCharacterFormatting","values","applyListCharacterFormatByValue","updateListCharacterFormat","updateListTextSelRange","startPositionInternal","endPositionInternal","initHistoryPosition","startSelectionReLayouting","currentList","clearList","applyBullet","bullet","applyBulletOrNumbering","applyNumbering","baseAlignment","updateProperty","initializeHistory","updateParagraphFormatInternal","currentUnderline","script","completeStylesString","name_1","existingStyles","styleNames_1","name_2","createStyle","createStyleIn","getUniqueStyleName","uniqueName","getUniqueName","matchArray","updateCharacterFormat","applyCharFormatSelectedContent","applyCharFormat","applyCharFormatCell","applyCharFormatForSelectedPara","splittedLastParagraph","splittedWidets","getNextParagraphForCharacterFormatting","widgetCollection","applyCharFormatForTable","inlineLength","applyCharFormatInline","getCurrentSelectionValue","updateFontSize","fontsizeCollection","formatInline","getCharacterFormatValueOfCell","applyCharFormatForSelectedCell","applyCharFormatRow","applyCharFormatForTableCell","applyCharFormatForSelTable","startCellLeft","startCellRight","applyCharFormatValueInternal","copyInlineCharacterFormat","destFormat","addModifiedProperties","modifiedFormat","getIndentIncrementValue","applyParaFormatProperty","layoutItemBlock","updateSelectionParagraphFormatting","increaseLevel","nextListLevel","incrementFactor","currentParagraphIndent","getIndentIncrementValueInternal","fPosition","updateParagraphFormat","applyParaFormatSelectedContent","applyCharacterStyle","applyParaFormat","applyParaFormatInCell","addModifiedPropertiesForParagraphFormat","copyParagraphFormat","copyFromListLevelParagraphFormat","onListFormatChange","updateListParagraphFormat","listlevel","oldFormat","newFormat","applyContinueNumberingInternal","numberingInfo","getContinueNumberingInfo","getParagraphFormat","listPattern","changeListId","revertContinueNumbering","levelNum","listType","baseHistoryInfo","addModifiedPropertiesForContinueNumbering","checkNumberArabic","restartListAt","createListLevels","restartListAtInternal","changeRestartNumbering","addModifiedPropertiesForRestartNumbering","levelPatterns","indexOfLevelPattern","getNextParagraphForFormatting","obj","cellContainer","getParaFormatValueInCell","applyParaFormatCellInternal","applyParagraphFormatRow","applyParaFormatTableCell","wCell","applyParagraphFormatTableInternal","wRow","startValue","endValue","applyParaFormatTable","updateSectionFormat","startSectionIndex","endSectionIndex","applyPropertyValueForSection","getTableFormatAction","applyTablePropertyValue","updateSelectionTableFormat","getRowAction","applyRowPropertyValue","getTableCellAction","applyCellPropertyValue","addModifiedPropertiesForSection","startInfo","endInfo","combineSection","nextSection","combineSectionChild","updateTableFormat","updateCellFormat","updateRowFormat","tableStartPosition","newStartPosition","updateFormatForCell","rowStartPosition","rowEndPosition","applyRowFormat","reLayoutSelectionOfTable","reLayoutSelection","isEnded","reLayoutSelectionOfBlock","removeSelectedContent","editAction","deletePara","deleteTableCell","getParagraphForSelection","deleteCells","removeRow","updateTable","paragraphStart","endParagraphStartOffset","isCombineNextParagraph","lastLinelength","isEndInAdjacentTable","isStartParagraph","removeInlines","deleteSection","deleteBlock","insertParagraphPaste","addRemovedNodes","checkAndInsertBlock","combineSectionInternal","currentSection","lastBlockIndex","paragraphAdv","deleteTableBlock","deletePreviousBlock","updateEditPosition","deleteCellsInTable","deleteCell","deleteContainer","isDeleteCells","cell_1","setActionInternal","copyChildToClipboard","checkClearCells","deleteContent","splitEndRow","enableHistoryMode","clonedTable","deleteParagraphMark","removeContent","copyListLevel","destination","listParagraphs","updateListParagraphsInBlock","startListLevel","tempList","abstractListAdv","listName","bulletCharacters","isInsertPageBreak","initialStart","breakParagraph","pageBreak","updateIndex","currentCellIndex","increment","singleBackspace","skipBackSpace","insertRemoveBookMarkElements","bookMark","bookMarkStart","bookMarkEnd","isBackSpace","deleteSelectedContentInternal","getParagraph","lineInfo","canRedo","canUndo","historyInfo","undoStack","startBlockInfo","endBlockInfo","currentLineWidget","setPositionForHistory","removeOffset","removeAtOffset","singleDelete","nextRenderedInline","bookMarkBegin","paraEndOffset","singleDeleteInternal","updateEditPositionOnMerge","base64String","imageElementBox","insertPictureInternal","fitImageToPage","onPortrait","onLandscape","copyValues","changeMarginValue","onPaperSize","currentBlock","updateListItems","updateListItemsForPara","updateListItemsForTable","updateListItemsForRow","updateListItemsForCell","updateRenderedListItemsForPara","updateRenderedListItemsForTable","updateRenderedListItemsForRow","updateRenderedListItemsForCell","getParagraphInfoInternal","lineOffset","insertPageNumber","createFields","insertPageCount","fieldtext","insertBookmark","bookmarkEnd","insertElements","updateComplexHistoryInternal","deleteBookmark","bookmarkName","setBookmarkInfo","deleteBookmarkInternal","getSelectionInfo","startElementInfo","endElementInfo","endElements","startElements","insertElementsInternal","elements","hfString","getBodyWidget","getBlockByIndex","blockObj","getParagraphInternal","getHeaderFooterWidget","getBodyWidgetInternal","isInsertPosition","applyBorders","settings","getBorder","borderColor","clearAllBorderValues","selectedCell","getTopBorderCellsOnSelection","getLeftBorderCellsOnSelection","getRightBorderCellsOnSelection","getBottomBorderCellsOnSelection","getAdjacentCellToApplyBottomBorder","clearBorder","getAdjacentCellToApplyRightBorder","applyAllBorders","applyInsideBorders","updateGridForTableDialog","borderType","isLastSelectedRow","isLastRightCell","nextRowIndex","getAdjacentBottomBorderOnEmptyCells","rightBorderCells","getSelectedCellsNextWidgets","topBorderCells","leftBorderCells","bottomBorderCells","nextCellColIndex","isSingleCell","startPosIn","endPosIn","applyBordersInternal","applyBorder","applyShading","onTableFormat","applyTableFormat","addModifiedTableProperties","handleTableFormat","applyFormat","shiftNextItem","onRowFormat","rowStartPos","rowEndPos","addModifiedRowProperties","handleRowFormat","onCellFormat","updateCellMargins","cellStartPosition","cellEndPosition","applyCellmarginsValue","getSelectedCellInColumn","rowEndIndex","addModifiedCellProperties","handleCellFormat","isTocField","insertTableOfContents","validateTocSettings","getTocSettings","tocSettings","includePageNumber","rightAlign","startLevel","endLevel","swtiches","swtch","includeHyperlink","includeOutlineLevels","decodeTSwitch","tSwitch","levelSettings","tableOfContentsSettings","constructTocFieldCode","buildToc","tocLastPara","tocLastLine","appendEndField","appendEmptyPara","updatePageRef","emptyPara","emptyLine","tocFieldCode","constructTSwitch","isFirstPara","tocDomBody","createHeadingLevels","createOutlineLevels","isHeadingStyle","isOutlineLevelStyle","insertTocBookmark","createTOCWidgets","levelStyle","headingStyle","createTocFieldElement","tocLine","headingStyleName","tocStyleName","insertTocHyperlink","pageField","insertTocPageNumber","bookMarkname","isRightAlign","pageRef","generateBookmarkName","formatString","onCellContentAlignment","ModifiedLevel","modified","ownerListLevelIn","modifiedListLevelIn","ownerListLevel","modifiedListLevel","ModifiedParagraphFormat","ownerFormat","ownerFormatIn","modifiedFormatIn","RowHistoryFormat","rowHeightType","revertChanges","isRedo","currentRowHeightType","TableHistoryInfo","TableFormatHistoryInfo","copyProperties","RowFormatHistoryInfo","CellFormatHistoryInfo","tableHierarchicalIndex","CellHistoryFormat","BaseHistoryInfo","ownerIn","modifiedPropertiesIn","modifiedNodeLength","removedNodesIn","actionIn","selectionStartIn","selectionEndIn","insertPositionIn","endPositionIn","revertBookmark","bookmarkInfo","recordChanges","revert","selectionStartTextPosition","selectionEndTextPosition","revertModifiedProperties","deletedNodes","insertTextPosition","isRemoveContent","isRedoAction","revertModifiedNodes","isDelete","revertResizing","revertTableDialogProperties","revertProperties","redoAction","lastNode","firstNode","insertRemovedNodes","prevTableHistoryInfo","tableHistoryInfoCurrent","currentPropertyIndex","applyTableOptionsHelper","previousFormat","currentFormat","skipRemove","prevLength","nextFormat","addModifiedPropertiesForList","previousLevel","getProperty","modifiedLevel","updateListChanges","addModifiedCellOptions","copyCellOptions","addModifiedTableOptions","copyTableOptions","getCharacterPropertyValue","previousTableFormat","resizeContainerDiv","topLeftRect","topMiddleRect","topRightRect","bottomLeftRect","bottomMiddleRect","bottomRightRect","leftMiddleRect","rightMiddleRect","topLeftRectParent","topMiddleRectParent","topRightRectParent","bottomLeftRectParent","bottomMiddleRectParent","bottomRightRectParent","leftMiddleRectParent","rightMiddleRectParent","resizeMarkSizeIn","selectedImageWidget","imageResizerPoints","ImageResizingPoints","imageResizerDiv","currentImageElementBoxIn","imageResizerDivElement","resizeDiv","initResizeMarks","currentImageElementBox","currentPageDiv","currentPageDivWidth","currentPageDivHeight","imageResizerDivWidth","imageResizerDivHeight","resizeMarkSize","setImageResizerPosition","selectedImageInfo","SelectedImageInfo","initResizeContainerDiv","opacity","setImageResizingPoints","applyPropertiesForTouch","applyPropertiesForMouse","resizeRectElement","boxShadow","handleImageResizing","points","topRightResizing","topLeftResizing","topMiddleResizing","bottomRightResizing","bottomLeftResizing","leftMiddleResizing","imageHeight","initHistoryForImageResizer","getOuterResizingPoint","getInnerResizingPoint","touchEvent","imageResizingPoints","bottomMiddle","bottomRight","bottomLeft","topMiddle","topRight","topLeft","rightMiddle","leftMiddle","touchPoints","imageResizingPointsOnTouch","selectedElements","HistoryInfo","isChild","isChildHistoryInfo","modifiedActions","addModifiedAction","undoStackIn","redoStackIn","historyInfoStack","modifiedParaFormats","undoLimitIn","redoLimitIn","rowHistoryFormat","cellHistoryFormat","redoLimit","undoLimit","clearRedoStack","hasAction","modifiedLevelsInternal","modifiedCollection","revertListChanges","clearHistory","clearUndoStack","documentPath","stylePath","numberingPath","settingsPath","headerPath","footerPath","imagePath","appPath","corePath","contentTypesPath","generalRelationPath","wordRelationPath","headerRelationPath","footerRelationPath","xmlContentType","fontContentType","documentContentType","settingsContentType","footerContentType","headerContentType","numberingContentType","stylesContentType","webSettingsContentType","appContentType","coreContentType","customContentType","customXmlContentType","relationContentType","tableStyleContentType","settingsRelType","footerRelType","headerRelType","documentRelType","numberingRelType","stylesRelType","fontRelType","tableStyleRelType","coreRelType","appRelType","customRelType","imageRelType","hyperlinkRelType","controlRelType","packageRelType","customXmlRelType","customUIRelType","attachedTemplateRelType","wNamespace","wpNamespace","pictureNamespace","aNamespace","a14Namespace","rNamespace","rpNamespace","vNamespace","oNamespace","xmlNamespace","w10Namespace","cpNamespace","dcNamespace","docPropsNamespace","veNamespace","mNamespace","wneNamespace","customPropsNamespace","vtNamespace","chartNamespace","slNamespace","dtNamespace","wmlNamespace","w14Namespace","wpCanvasNamespace","wpDrawingNamespace","wpGroupNamespace","wpInkNamespace","wpShapeNamespace","w15Namespace","diagramNamespace","eNamespace","pNamespace","certNamespace","cRelationshipsTag","cRelationshipTag","cIdTag","cTypeTag","cTargetTag","cUserShapesTag","cExternalData","twipsInOnePoint","twentiethOfPoint","borderMultiplier","percentageFactor","emusPerPoint","cConditionalTableStyleTag","cTableFormatTag","cTowFormatTag","cCellFormatTag","cParagraphFormatTag","cCharacterFormatTag","packageType","relsPartPath","documentRelsPartPath","webSettingsPath","wordMLDocumentPath","wordMLStylePath","wordMLNumberingPath","wordMLSettingsPath","wordMLHeaderPath","wordMLFooterPath","wordMLCommentsPath","wordMLImagePath","wordMLFootnotesPath","wordMLEndnotesPath","wordMLAppPath","wordMLCorePath","wordMLCustomPath","wordMLFontTablePath","wordMLChartsPath","wordMLDefaultEmbeddingPath","wordMLEmbeddingPath","wordMLDrawingPath","wordMLThemePath","wordMLFontsPath","wordMLDiagramPath","wordMLControlPath","wordMLVbaProject","wordMLVbaData","wordMLVbaProjectPath","wordMLVbaDataPath","wordMLWebSettingsPath","wordMLCustomItemProp1Path","wordMLFootnoteRelPath","wordMLEndnoteRelPath","wordMLSettingsRelPath","wordMLNumberingRelPath","wordMLFontTableRelPath","wordMLCustomXmlPropsRelType","wordMLControlRelType","wordMLDiagramContentType","lastSection","mRelationShipID","mDocPrID","mDifferentFirstPage","mBookmarks","mDocumentImages","mExternalLinkImages","mHeaderFooterImages","mHeaderFooterColl","mArchive","then","clearDocument","setDocument","ZipArchive","compressionLevel","mVerticalMerge","mGridSpans","serializeDocument","serializeStyles","serializeNumberings","serializeSettings","serializeCoreProperties","serializeAppProperties","serializeFontTable","contenttype","serializeSettingsRelation","serializeHeaderFooters","serializeDocumentRelations","serializeGeneralRelations","serializeContentTypes","mSections","mLists","mAbstractLists","defCharacterFormat","defParagraphFormat","defaultTabWidthValue","mStyles","blockOwner","writer","XmlWriter","writeStartElement","writeCommonAttributeStrings","serializeDocumentBody","writeEndElement","archiveItem","ZipArchiveItem","buffer","addItem","writeAttributeString","writeCustom","writeDup","last","serializeBodyItems","serializeSectionProperties","serializeHFReference","serializeSectionType","serializePageSetup","serializeColumns","pageSetup","serializePageSize","serializePageMargins","roundToTwoDecimal","marginValue","sectionBreakCode","hfId","hf","getNextRelationShipID","addHeaderFooter","hfType","hfColl","blockCollection","isLastSection","serializeBodyItem","sec","serializeParagraphItems","paraItems","serializeFieldCharacter","serializePicture","serializeBookMark","serializeTextRange","bookmarkId","getBookmarkId","serializeDrawing","serializeInlinePicture","cx","cy","serializeDrawingGraphics","startsWith","sourceString","startString","picture","updateShapeId","documentImages","externalImages","tOwner","updateHFImageRels","addImageRelation","imageCollection","relationId","headerId","types","hfKeys","headerImages","headerFooterImages","serializeTableFormat","serializeTableGrid","serializeTableRows","grid","serializeGridColumns","serializeRowFormat","serializeCells","pointWidth","serializeCellFormat","itemIndex","serializeCellWidth","serializeCellMerge","serializeGridSpan","serializeBorders","serializeShading","serializeTableCellDirection","serializeCellVerticalAlign","cf","collKey","isserialized","createMerge","serializeColumnSpan","checkMergeCell","num","alignment","gridValue","serializeTableWidth","serializeTableAlignment","serializeCellSpacing","serializeTableIndentation","serializeTableBorders","serializeTblLayout","getTextureStyle","multipler","serializeBorder","tagName","multiplier","sz","getBorderStyle","tableIndent","writeElementString","isField","writeString","serializeListFormat","serializeParagraphSpacing","serializeIndentation","serializeParagraphAlignment","serializeTabs","serializeTab","getTabJustification","lf","txtAlignment","serializeDefaultStyles","serializeDocumentStyles","zipArchiveItem","serializeBoolProperty","getHighlightColor","getUnderlineStyle","underlineStyle","tag","serializeAbstractListStyles","serializeListInstances","listStyles","generateHex","ilvl","cnt","serializeListLevel","random","levelIndex","getLevelPattern","serializeLevelFollow","serializeLevelText","patternType","lvlIndex","fc","tabWidth","contentType","serializeHeaderFooter","headerFooterPath","headerFooterRelsPath","serializeHeader","serializeFooter","writeHFCommonAttributes","serializeHFRelations","serializeImagesRelations","serializeRelationShip","serializeHeaderFooterRelations","images","base64ImageString","extension","formatClippedString","imageBlob","encodedString","input","chr1","chr2","chr3","enc2","enc3","enc4","keyStr","resultIndex","totalLength","output","Uint8Array","serializeExternalLinkImages","serializeHFRelation","relType","relationshipID","relationshipType","targetPath","resetRelationShipID","serializeDefaultContentType","serializeOverrideContentType","serializeHFContentTypes","serializeHeaderFootersContentType","partName","curSectionIndex","inField","StreamWriter","writeInternal","streamWriter","sectionCount","updateLastParagraph","writeBody","writeNewLine","writeSectionEnd","writeHeadersFooters","bodyItemsCount","bodyItem","isLastPara","writeParagraph","writeTable","writeText","writeHeaderFooter","writeLine","paragraphs","pCount","writeInlineStyles","writeParagraphFormat","endPara","createSection","createParagraph","writeBodyWidget","writeStyles","writeLists","doc","writeHeaderFooters","writeBlock","writeNextBlock","writeLines","writeInlines","writeInline","isEnd","started","ended","writeListFormat","writeTabs","listIdValue","writeRow","createRow","writeCell","createCell","writeTableFormat","writeRowFormat","writeCellFormat","writeShading","wShading","writeBorder","wBorder","writeBorders","wBorders","wCellFormat","wRowFormat","wTableFormat","writeStyle","writeList","writeAbstractList","wAbstractList","writeListLevel","wList","wListLevel","navigationUrl","bookmarkDropdown","bookmarkCheckbox","onKeyUpOnUrlBox","urlValue","urlTextBox","displayTextBox","enableOrDisableInsertButton","onInsertHyperlink","onKeyUpOnDisplayBox","onInsertButtonClick","onCancelButtonClick","dialog","clearValue","loadHyperlinkDialog","localObj","bookmarkDiv","addressText","dataSource","insertButton","closeHyperlinkDialog","onUseBookmarkChange","onBookmarkchange","autofocus","bookmarkText","bookmarkTextElement","bookmarkValue","DropDownList","popupHeight","noRecordsTemplate","bookmarkCheckDiv","bookmarkCheck","buttons","buttonModel","cssClass","isPrimary","dataBind","address","keyUpInsertTable","rowsCountBox","columnsCountBox","onInsertTableClick","rowValueTextBox","columnValueTexBox","columnContainer","columnValue","rowContainer","rowValue","NumericTextBox","enablePersistence","addBookmark","textBoxInput","selectHandler","setSelectionRange","gotoBookmark","initBookmarkDialog","headerValue","dlgFields","commonDiv","textBoxDiv","listviewDiv","listviewInstance","ListView","buttonDiv","addbuttonDiv","addButtonElement","Button","deleteButtonDiv","deleteButtonElement","gotoButtonDiv","gotoButtonElement","removeObjects","bind","loadTableofContentDialog","enabled","showLevel","closeTableOfContentDialog","unWireEventsAndBindings","changeShowLevelValue","changeByValue","headings","heading1","heading2","heading3","heading4","heading5","heading6","heading7","heading8","heading9","reset","normal","changeStyle","headingValue","srcElement","getElementValue","checkLevel","changeHeadingStyle","changePageNumberValue","changeRightAlignValue","changeStyleValue","applyTableOfContentProperties","applyLevelSetting","ownerId","generalDiv","genLabel","leftGeneralDiv","rightGeneralDiv","leftBottomGeneralDiv","rightBottomGeneralDiv","pageNumberDiv","rightAlignDiv","tabDiv","tabLeaderLabelDiv","tabLeaderLabel","tabLeaderDiv","showDiv","showLevelLabelDiv","showLevelLabel","showLevelDiv","buildTableDiv","buildTableLabel","tr1","td1","availableLabel","td2","tocLabel","tableDiv","table1","tr2","td3","heading1Label","td4","tr3","td5","heading2Label","td6","tr4","td7","heading3Label","td8","tr5","td9","heading4Label","td10","tr6","td11","heading5Label","td12","tr7","td13","heading6Label","td14","tr8","td15","heading7Label","td16","tr9","td17","heading8Label","td18","tr10","td19","heading9Label","td20","tr12","td23","normalLabel","td24","stylesLevelDiv","fieldsDiv","outDiv","outlineDiv","resetButtonDiv","resetElement","tocStylesDiv","tocStylesLabel","listViewDiv","listViewInstance","modifyButtonDiv","modifyElement","getHeadingLevel","newStartLevel","newEndLevel","isEndLevel","isPortrait","loadPageSetupDialog","topMarginBox","leftMarginBox","bottomMarginBox","rightMarginBox","widthBox","heightBox","checkBox1","checkBox2","headerBox","footerBox","landscape","portrait","closePageSetupDialog","keyUpInsertPageSettings","applyPageSetupProperties","changeByPaperSize","paperSize","ejtabContainer","marginTab","paperTab","layoutTab","ejtab","headerContainer","marginHeader","paperHeader","layoutHeader","contentContainer","marginContent","paperContent","layoutContent","initMarginProperties","initPaperSizeProperties","initLayoutProperties","tabObj","marginDiv","leftMarginDiv","rightMarginDiv","topLabel","topTextBox","bottomBoxLabel","bottomTextBox","leftBoxLabel","leftTextBox","rightLabel","rightTextBox","decimals","orientationDiv","orientationLabeldiv","orientationPropDiv","portraitDiv","landscapeDiv","RadioButton","sizeDiv","leftSizeDiv","rightSizeDiv","widthLabel","widthTextBox","heightLabel","heightTextBox","paperSizeDiv","layoutDiv","firstPageDiv","oddOrEvenDiv","textLabelDiv","textLabel","propertyDiv","leftLayoutDiv","rightLayoutDiv","headerLabel","footerLabel","keyUpParagraphSettings","applyParagraphFormat","changeBeforeSpacing","changeAfterSpacing","changeLeftIndent","changeRightIndent","changeLineSpacingValue","changeFirstLineIndent","changeByTextAlignment","special","byIn","changeBySpacing","atIn","loadParagraphDialog","selectionFormat","alignValue","lineSpaceValue","isApply","onParagraphFormat","closeParagraphDialog","alignLabel","indentionDiv","leftIndentionDiv","rightIndentionDiv","spacingDiv","leftSpacingDiv","rightSpacingDiv","indentLabel","beforeTextLabel","specialLabel","afterTextLabel","byLabel","by","spaceLabel","beforeLabel","lineSpaceLabel","afterLabel","atLabel","lineSpacingAt","step","local","q","ListViewModel","listIn","levelNumberIn","createList","listLevelAdv","viewModel","textIndent","alignedAt","listLevelElement","followNumberWith","numberStyle","restartBy","isListCharacterFormat","onTextIndentChanged","onStartValueChanged","onListLevelValueChanged","updateDialogValues","updateRestartLevelBox","onNumberFormatChanged","onAlignedAtValueChanged","onFollowCharacterValueChanged","onLevelPatternValueChanged","numberFormatTextBox","loadListDialog","dialog2","disposeBindingForListUI","closeListDialog","listLevelDiv","numberStyleDiv","numberFormatDiv","indentsDiv","startAtTextBox","textIndentAtTextBox","alignedAtTextBox","followCharacterElement","numberStyleEle","restartElement","formatInfoToolTip","Tooltip","option_1","listPatternConverter","followCharacterConverter","l","styleBasedOn","styleParagraph","onlyThisDocument","template","openDialog","showNumberingBulletDialog","setBoldProperty","fontButtonClicked","setItalicProperty","setUnderlineProperty","fontSizeUpdate","fontFamilyChanged","fontColorUpdate","currentValue","rgba","setLeftAlignment","setRightAlignment","setCenterAlignment","setJustifyAlignment","increaseBeforeAfterSpacing","decreaseBeforeAfterSpacing","updateNextStyle","typedName","getTypeValue","isUserNextParaUpdated","isEdit","editStyleName","updateOkButton","enableOrDisableOkButton","styleTypeChange","isInteracted","toggleDisable","updateStyleNames","styleBasedOnChange","styleParagraphChange","numberingBulletDialog","showNumberBulletDialog","onOkButtonClick","styleNameElement","updateList","createLinkStyle","loadStyleDialog","okButton","closeStyleDialog","properties","styleNameTypeDiv","nameWholeDiv","nameValue","styleTypeWholeDiv","styleTypeDivElement","styleTypeValue","styleBasedParaDiv","styleBasedOnWholeDiv","styleBasedOnDivElement","styleBasedOnValue","styleParagraphWholeDiv","styleParagraphDivElement","styleParagraphValue","formatting","optionsDiv","fontOptionsDiv","createFontOptions","paragraphOptionsDiv","createParagraphOptions","createFormatDropdown","formatBtn","dropDownbtn","DropDownButton","beforeItemRender","fontFamilyElement","ComboBox","popupWidth","showClearButton","fontSizeElement","fontGroupButton","createButtonElement","fontColorElement","ColorPicker","alignmentDiv","leftAlign","centerAlign","lineSpacingDiv","singleLineSpacing","onePointFiveLineSpacing","doubleLineSpacing","indentingDiv","buttonElement","removeAttribute","paragraphFOrmat","nxtName","basedOnIndex","numberListClick","setActiveElement","currentTarget","bulletListClick","symbol","loadNumberingBulletDialog","closeNumberingBulletDialog","initNumberingBulletDialog","tabTarget","createNumberList","createBulletList","heightAdjustMode","refresh","numberListDiv","ulTag","numberedNone","createNumberNoneListTag","numberedNumberDot","createNumberListTag","numberedNumberBrace","numberedUpRoman","numberedUpLettter","numberedLowLetterDot","numberedLowLetterBrace","numberedLowRoman","text1","text2","text3","liTag","liInnerDiv","cssFloat","createBulletListTag","liNextDiv","bulletListDiv","bulletNone","bulletDot","bulletCircle","bulletSquare","bulletFlower","bulletArrow","bulletTick","childElementCount","fontStyleInternal","fontNameList","fontStyleText","fontSizeText","colorPicker","underlineDrop","strikethroughBox","doublestrikethrough","superscript","subscript","loadFontDialog","getItems","closeFontDialog","onInsertFontFormat","onCharacterFormat","fontStyleUpdate","fontFamilyUpdate","underlineUpdate","hex","singleStrikeUpdate","enableCheckBoxProperty","doubleStrikeUpdate","superscriptUpdate","subscriptUpdate","createInputElement","effectLabel","strikeThroughElement","superScriptElement","subScriptElement","doubleStrikeThroughElement","fontDiv","getFontDiv","getFontSizeDiv","colorDiv","fontColorDiv","fontColorLabel","fontEffectsDiv","fontEffectSubDiv1","fontEffectSubDiv2","sizeSubDiv1","sizeLabel","underlineElement","sizeSubDiv2","underlineLabel","fontSubDiv1","fontNameLabel","fontNameValues","fontSubDiv2","fontStyleLabel","fontStyleValues","hasCellWidth","isTableBordersAndShadingUpdated","isCellBordersAndShadingUpdated","isCellOptionsUpdated","isTableOptionsUpdated","onBeforeOpen","loadTableProperties","onCloseTablePropertyDialog","applyTableProperties","preferCheckBox","indeterminate","rowHeightCheckBox","preferredCellWidthCheckBox","rowHeightValue","closeTablePropertiesDialog","applyTableSubProperties","applySubCellOptions","applySubTableOptions","tableWidthBox","tableWidthType","leftIndentBox","rowHeightBox","repeatHeader","allowRowBreak","cellWidthBox","cellWidthType","changeTableCheckBox","enable","changeTableAlignment","updateClassForAlignmentProperties","tableTab","getTableAlignment","changeTableRowCheckBox","changeTableCellCheckBox","changeCellAlignment","updateClassForCellAlignment","cellTab","getCellAlignment","showBordersShadingsPropertiesDialog","rowFormatInternal","rowTab","separatorLine","tableHeader","rowHeader","cellHeader","tableContent","rowContent","cellContent","initTableProperties","initTableRowProperties","initTableCellProperties","alignMentButtons","cellAlignment","calculateGridValue","setTableProperties","setTableRowProperties","setTableCellProperties","bordersAndShadingButton","tableOptionButton","cellOptionButton","onTableWidthChange","onTableWidthTypeChange","onLeftIndentChange","onRowHeightChange","onRowHeightTypeChange","onAllowBreakAcrossPage","onRepeatHeader","onCellWidthChange","onCellWidthTypeChange","sizeHeader","parentContainer","childContainer1","childContainer2","child1","child2","childContainer3","controlDiv","labeltext","alignmentHeader","alignmentContainer","classDivName","leftAlignDiv","centerAlignDiv","center","leftlabel","centerlabel","rightlabel","leftIndenetContainer","leftIndentLabel","tableOptionContiner","formatNumericTextBox","tableHasWidth","groupButtons","groupButton","rowDiv","sizeLabeldiv","childDiv1","childdiv2","child3","child4","allowRowContainer","repeatHeaderContaniner","enableRowHeight","parentdiv","childdiv1","preferredCellWidth","divAlignment","divStyle","topAlignDiv","cellTopAlign","cellCenterAlign","bottomAlignDiv","cellBottomAlign","centerLabel","bottomLabel","cellAlignments","applyBordersShadingsProperties","tablePropertiesDialog","checkClassName","previewDivTopTop","previewDivTopBottom","previewDivTopCenter","previewDivBottomcenter","previewDivBottomLeft","previewDivBottomRight","previewDivDiagonalRight","previewDivLeftDiagonal","shadingColorPicker","ulelementShading","applyTo","noneDiv","currentTableFormat","closeDialog","closeBordersShadingsDialog","handleSettingCheckBoxAction","targetId","tableBorderDialogId","updateClassForSettingDivElements","setSettingPreviewDivElement","boxDiv","allDiv","customDiv","handlePreviewCheckBoxAction","compareClass","handlePreviewCheckBoxShowHide","showHidePreviewDivElements","applyTableCellPreviewBoxes","previewDivBottomcenterContainer","previewDivTopCenterContainer","previewVerticalDiv","previewHorizontalDiv","previewDivBottomRightContainer","applyPreviewTableBackgroundColor","previewDiv","applyPreviewTableBorderColor","previewRightDiagonalDiv","previewLeftDiagonalDiv","settingsContiner","styleContainer","previewContiner","styleText","dropDownList","widthText","widthNumeric","colorText","borderColorPickerElement","settingText","noneDivContainer","noneDivLabel","boxDivContainer","boxDivLabel","allDivContainer","allDivLabel","customDivContainer","customDivLabel","noneDivTransparent","boxDivTransparent","allDivTransparent","customDivTransparent","previewText","previewDivTopTopContainer","previewDivTopBottomContainer","previewDivLeftDiagonalContainer","previewDivBottomLeftContainer","previewDivDiagonalRightContainer","previewDivTopTopTransParent","previewDivTopCenterTransParent","previewDivTopBottomTransParent","previewDivLeftDiagonalTransParent","previewDivBottomLeftTransparent","previewDivBottomcenterTransparent","previewDivBottomRightTransparent","previewDivDiagonalRightTransparent","shadingContiner","shadingText","shadings","shadingColorPickerElement","shdApply","divsion","borderColorPicker","loadBordersShadingsPropertiesDialog","settingDivs","tempClassName","isShowHidePreviewTableElements","settingDiv","elementClass","compareElementClass","setElement","compareElement","setPropertyPreviewDivElement","ele","cloneBorders","getLineStyle","colorPickerEvent","fillColorEvent","horizontalBorder","verticalBorder","diagonalDownBorder","customBorder","diagonalUpBorder","applyTableCellProperties","cellSpaceTextBox","applyTableOptions","closeCellMarginsDialog","changeAllowSpaceCheckBox","allowSpaceCheckBox","removeEvents","innerDiv","innerDivLabel","getCellMarginDialogElements","cellSpaceLabel","table2","cellspacingTextBox","divBtn","loadCellMarginsDialog","applyTableOptionsHistory","applySubTableOptionsHelper","documentLocale","changeSameAsTable","sameAsTableCheckBox","tr","td","localizeValue","sameAsTable","loadCellProperties","enableTextBox","enableCheckBox","applyCellMarginsInternal","applyCellMarginsForCells","rowCells","iterateCells","applySubCellMargins","leftLabel","v","modifyStyles","addNewStyles","initStylesDialog","newButtonDiv","newButtonElement","modifybuttonDiv","modifyButtonElement","hideObjects"],"mappings":"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"}