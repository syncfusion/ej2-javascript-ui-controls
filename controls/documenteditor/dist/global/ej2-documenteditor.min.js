this.ej=this.ej||{},this.ej.documenteditor=function(e,t,i,r,n,o,a,s,l,d,h){"use strict";var c=function(){function e(){this.keysInternal=[],this.valuesInternal=[],this.item=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.keysInternal.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return this.getItem()},enumerable:!0,configurable:!0}),e.prototype.getItem=function(){this.item=[];for(var e=0;e<this.keysInternal.length;e++)this.item.push(this.keysInternal[e]);return this.item},e.prototype.add=function(e,i){if(t.isNullOrUndefined(e))throw new ReferenceError("Provided key or value is not valid.");return this.keysInternal.indexOf(e)<0&&(this.keysInternal.push(e),this.valuesInternal.push(i)),1},e.prototype.get=function(e){if(t.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(e);if(i<0||i>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.valuesInternal[i]},e.prototype.set=function(e,i){if(t.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var r=this.keysInternal.indexOf(e);if(r<0||r>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");this.valuesInternal[r]=i},e.prototype.remove=function(e){if(t.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(e);if(i<0||i>this.keysInternal.length-1)throw new RangeError("No item with the specified key has been added.");return this.keysInternal.splice(i,1),this.valuesInternal.splice(i,1),!0},e.prototype.containsKey=function(e){if(t.isNullOrUndefined(e))throw new ReferenceError("Provided key is not valid.");var i=this.keysInternal.indexOf(e);return!(i<0||i>this.keysInternal.length-1)},e.prototype.clear=function(){this.keysInternal=[],this.valuesInternal=[]},e.prototype.destroy=function(){this.clear(),this.keysInternal=void 0,this.valuesInternal=void 0},e}(),p=function(){function e(e){this.referenceCount=0,this.uniqueFormatType=e,this.propertiesHash=new c}return e.prototype.isEqual=function(e,t,i){var r=!1;switch(this.uniqueFormatType){case 1:r=this.isBorderEqual(e,t,i);break;case 2:r=this.isCharacterFormatEqual(e,t,i);break;case 3:r=this.isParagraphFormatEqual(e,t,i);break;case 4:r=this.isCellFormatEqual(e,t,i);break;case 5:r=this.isShadingEqual(e,t,i);break;case 6:r=this.isRowFormatEqual(e,t,i);break;case 7:r=this.isListFormatEqual(e,t,i);break;case 8:r=this.isTableFormatEqual(e,t,i);break;case 9:r=this.isListLevelEqual(e,t,i);break;case 10:r=this.isSectionFormatEqual(e,t,i)}return r},e.prototype.isNotEqual=function(i,r,n,o,a){var s=void 0,l=e.getPropertyType(a,i);this.propertiesHash.containsKey(l)&&(s=this.propertiesHash.get(l));var d=void 0;return i===n?d=o:r.containsKey(l)&&(d=r.get(l)),!(s===d||!t.isNullOrUndefined(s)&&!t.isNullOrUndefined(d)&&s===d)},e.getPropertyType=function(e,t){var i=0;switch(e){case 1:i=this.getBorderPropertyType(t);break;case 2:i=this.getCharacterFormatPropertyType(t);break;case 3:i=this.getParaFormatPropertyType(t);break;case 4:i=this.getCellFormatPropertyType(t);break;case 5:i=this.getShadingPropertyType(t);break;case 6:i=this.getRowFormatType(t);break;case 7:i=this.getListFormatType(t);break;case 8:i=this.getTableFormatType(t);break;case 9:i=this.getListLevelType(t);break;case 10:i=this.getSectionFormatType(t)}return i},e.getRowFormatType=function(e){return"allowBreakAcrossPages"===e?1:"isHeader"===e?2:"height"===e?3:"heightType"===e?4:"gridBefore"===e?5:"gridBeforeWidth"===e?6:"gridBeforeWidthType"===e?7:"gridAfter"===e?8:"gridAfterWidth"===e?9:"gridAfterWidthType"===e?10:0},e.getListFormatType=function(e){return"listId"===e?1:"listLevelNumber"===e?2:0},e.getTableFormatType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"cellSpacing"===e?5:"leftIndent"===e?6:"tableAlignment"===e?7:"preferredWidth"===e?8:"preferredWidthType"===e?9:0},e.getListLevelType=function(e){return"listLevelPattern"===e?1:"startAt"===e?2:"followCharacter"===e?3:"numberFormat"===e?4:"restartLevel"===e?5:0},e.getShadingPropertyType=function(e){return"backgroundColor"===e?1:"foregroundColor"===e?2:"textureStyle"===e?3:0},e.getCellFormatPropertyType=function(e){return"leftMargin"===e?1:"rightMargin"===e?2:"topMargin"===e?3:"bottomMargin"===e?4:"columnSpan"===e?5:"rowSpan"===e?6:"verticalAlignment"===e?7:"preferredWidthType"===e?8:"preferredWidth"===e?9:"cellWidth"===e?10:0},e.getBorderPropertyType=function(e){return"color"===e?1:"lineStyle"===e?2:"lineWidth"===e?3:"shadow"===e?4:"space"===e?5:"hasNoneStyle"===e?6:0},e.getCharacterFormatPropertyType=function(e){return"fontColor"===e?1:"fontFamily"===e?2:"fontSize"===e?3:"bold"===e?4:"italic"===e?5:"underline"===e?6:"strikethrough"===e?7:"baselineAlignment"===e?8:"highlightColor"===e?9:0},e.getParaFormatPropertyType=function(e){return"leftIndent"===e?1:"rightIndent"===e?2:"firstLineIndent"===e?3:"textAlignment"===e?4:"beforeSpacing"===e?5:"afterSpacing"===e?6:"lineSpacing"===e?7:"lineSpacingType"===e?8:"outlineLevel"===e?9:0},e.getSectionFormatType=function(e){return"headerDistance"===e?1:"footerDistance"===e?2:"differentFirstPage"===e?3:"differentOddAndEvenPages"===e?4:"pageWidth"===e?5:"pageHeight"===e?6:"leftMargin"===e?7:"topMargin"===e?8:"rightMargin"===e?9:"bottomMargin"===e?10:0},e.prototype.isBorderEqual=function(e,t,i){return!this.isNotEqual("color",e,t,i,1)&&(!this.isNotEqual("lineStyle",e,t,i,1)&&(!this.isNotEqual("lineWidth",e,t,i,1)&&(!this.isNotEqual("shadow",e,t,i,1)&&(!this.isNotEqual("space",e,t,i,1)&&!this.isNotEqual("hasNoneStyle",e,t,i,1)))))},e.prototype.isCharacterFormatEqual=function(e,t,i){return!this.isNotEqual("fontColor",e,t,i,2)&&(!this.isNotEqual("fontFamily",e,t,i,2)&&(!this.isNotEqual("fontSize",e,t,i,2)&&(!this.isNotEqual("bold",e,t,i,2)&&(!this.isNotEqual("italic",e,t,i,2)&&(!this.isNotEqual("underline",e,t,i,2)&&(!this.isNotEqual("strikethrough",e,t,i,2)&&(!this.isNotEqual("baselineAlignment",e,t,i,2)&&!this.isNotEqual("highlightColor",e,t,i,2))))))))},e.prototype.isParagraphFormatEqual=function(e,t,i){return!this.isNotEqual("leftIndent",e,t,i,3)&&(!this.isNotEqual("rightIndent",e,t,i,3)&&(!this.isNotEqual("firstLineIndent",e,t,i,3)&&(!this.isNotEqual("textAlignment",e,t,i,3)&&(!this.isNotEqual("beforeSpacing",e,t,i,3)&&(!this.isNotEqual("afterSpacing",e,t,i,3)&&(!this.isNotEqual("lineSpacing",e,t,i,3)&&(!this.isNotEqual("lineSpacingType",e,t,i,3)&&!this.isNotEqual("outlineLevel",e,t,i,3))))))))},e.prototype.isCellFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,4)&&(!this.isNotEqual("rightMargin",e,t,i,4)&&(!this.isNotEqual("topMargin",e,t,i,4)&&(!this.isNotEqual("bottomMargin",e,t,i,4)&&(!this.isNotEqual("columnSpan",e,t,i,4)&&(!this.isNotEqual("rowSpan",e,t,i,4)&&(!this.isNotEqual("verticalAlignment",e,t,i,4)&&(!this.isNotEqual("preferredWidthType",e,t,i,4)&&(!this.isNotEqual("preferredWidth",e,t,i,4)&&!this.isNotEqual("cellWidth",e,t,i,4)))))))))},e.prototype.isShadingEqual=function(e,t,i){return!this.isNotEqual("backgroundColor",e,t,i,5)&&(!this.isNotEqual("foregroundColor",e,t,i,5)&&!this.isNotEqual("textureStyle",e,t,i,5))},e.prototype.isRowFormatEqual=function(e,t,i){return!this.isNotEqual("allowBreakAcrossPages",e,t,i,6)&&(!this.isNotEqual("isHeader",e,t,i,6)&&(!this.isNotEqual("height",e,t,i,6)&&(!this.isNotEqual("heightType",e,t,i,6)&&(!this.isNotEqual("gridBefore",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidth",e,t,i,6)&&(!this.isNotEqual("gridBeforeWidthType",e,t,i,6)&&(!this.isNotEqual("gridAfter",e,t,i,6)&&(!this.isNotEqual("gridAfterWidth",e,t,i,6)&&!this.isNotEqual("gridAfterWidthType",e,t,i,6)))))))))},e.prototype.isListFormatEqual=function(e,t,i){return!this.isNotEqual("listId",e,t,i,7)&&!this.isNotEqual("listLevelNumber",e,t,i,7)},e.prototype.isTableFormatEqual=function(e,t,i){return!this.isNotEqual("leftMargin",e,t,i,8)&&(!this.isNotEqual("rightMargin",e,t,i,8)&&(!this.isNotEqual("topMargin",e,t,i,8)&&(!this.isNotEqual("bottomMargin",e,t,i,8)&&(!this.isNotEqual("cellSpacing",e,t,i,8)&&(!this.isNotEqual("leftIndent",e,t,i,8)&&(!this.isNotEqual("tableAlignment",e,t,i,8)&&(!this.isNotEqual("preferredWidth",e,t,i,8)&&!this.isNotEqual("preferredWidthType",e,t,i,8))))))))},e.prototype.isListLevelEqual=function(e,t,i){return!this.isNotEqual("listLevelPattern",e,t,i,9)&&(!this.isNotEqual("startAt",e,t,i,9)&&(!this.isNotEqual("followCharacter",e,t,i,9)&&(!this.isNotEqual("numberFormat",e,t,i,9)&&!this.isNotEqual("restartLevel",e,t,i,9))))},e.prototype.isSectionFormatEqual=function(e,t,i){return!this.isNotEqual("headerDistance",e,t,i,10)&&(!this.isNotEqual("footerDistance",e,t,i,10)&&(!this.isNotEqual("differentFirstPage",e,t,i,10)&&(!this.isNotEqual("differentOddAndEvenPages",e,t,i,10)&&(!this.isNotEqual("pageWidth",e,t,i,10)&&(!this.isNotEqual("pageHeight",e,t,i,10)&&(!this.isNotEqual("leftMargin",e,t,i,10)&&(!this.isNotEqual("topMargin",e,t,i,10)&&(!this.isNotEqual("rightMargin",e,t,i,10)&&!this.isNotEqual("bottomMargin",e,t,i,10)))))))))},e.prototype.cloneItems=function(t,i,r,n){for(var o=e.getPropertyType(n,i),a=t.propertiesHash.getItem(),s=0;s<a.length;s++)a[s]===o?this.propertiesHash.add(o,r):this.propertiesHash.add(a[s],t.propertiesHash.get(a[s]));t.propertiesHash.containsKey(o)||this.propertiesHash.add(o,r)},e.prototype.mergeProperties=function(e){for(var t=e.cloneProperties(),i=this.propertiesHash.keys,r=0;r<i.length;r++)t.containsKey(i[r])||t.add(i[r],this.propertiesHash.get(i[r]));return t},e.prototype.cloneProperties=function(){for(var e=new c,t=this.propertiesHash.keys,i=0;i<t.length;i++)e.add(t[i],this.propertiesHash.get(t[i]));return e},e.prototype.destroy=function(){t.isNullOrUndefined(this.propertiesHash)||this.propertiesHash.destroy(),this.propertiesHash=void 0,this.referenceCount=void 0,this.uniqueFormatType=void 0},e}(),g=function(){function e(){this.items=[]}return e.prototype.addUniqueFormat=function(e,i){for(var r=void 0,n=0;n<this.items.length;n++)if(this.items[n].isEqual(e,void 0,void 0)){r=this.items[n];break}return t.isNullOrUndefined(r)?((r=new p(i)).propertiesHash=e,r.referenceCount=1,this.items.push(r)):r.referenceCount++,r},e.prototype.updateUniqueFormat=function(e,i,r){for(var n=void 0,o=0;o<this.items.length;o++)if(this.items[o].isEqual(e.propertiesHash,i,r)){n=this.items[o];break}return t.isNullOrUndefined(n)?((n=new p(e.uniqueFormatType)).cloneItems(e,i,r,e.uniqueFormatType),n.referenceCount=1,this.items.push(n)):n.referenceCount++,this.remove(e),e=void 0,n},e.prototype.remove=function(e){--e.referenceCount<=0&&(this.items.splice(this.items.indexOf(e),1),e.destroy(),e=void 0)},e.prototype.clear=function(){if(t.isNullOrUndefined(this.items))for(var e=0;e<this.items.length;e++)this.items[e].destroy();this.items=[]},e.prototype.destroy=function(){this.clear(),this.items=void 0},e}(),u=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),f=function(e,t,i,r){var n,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,i,a):n(t,i))||a);return o>3&&a&&Object.defineProperty(t,i,a),a},m=function(e){function r(t,i){var r=e.call(this,t,i)||this;return r.enableHeaderFooterIn=!1,r.isShiftingEnabled=!1,r.isLayoutEnabled=!0,r.isPastingContent=!1,r.parser=void 0,r.disableHistoryIn=!1,r.findResultsList=void 0,r.documentName="",r.tablePropertiesDialogModule=void 0,r.bordersAndShadingDialogModule=void 0,r.cellOptionsDialogModule=void 0,r.tableOptionsDialogModule=void 0,r.paragraphDialogModule=void 0,r.imageResizerModule=void 0,r.useCtrlClickToFollowHyperlink=!0,r.pageOutline="#000000",r.enableCursorOnReadOnly=!1,r.enableLocalPaste=!1,r.defaultLocale={Table:"Table",Row:"Row",Cell:"Cell",Ok:"Ok",Cancel:"Cancel",Size:"Size","Preferred Width":"Preferred width",Points:"Points",Percent:"Percent","Measure in":"Measure in",Alignment:"Alignment",Left:"Left",Center:"Center",Right:"Right",Justify:"Justify","Indent from left":"Indent from left","Borders and Shading":"Borders and Shading",Options:"Options","Specify height":"Specify height","At least":"At least",Exactly:"Exactly","Row height is":"Row height is","Allow row to break across pages":"Allow row to break across pages","Repeat as header row at the top of each page":"Repeat as header row at the top of each page","Vertical alignment":"Vertical alignment",Top:"Top",Bottom:"Bottom","Default cell margins":"Default cell margins","Default cell spacing":"Default cell spacing","Allow spacing between cells":"Allow spacing between cells","Cell margins":"Cell margins","Same as the whole table":"Same as the whole table",Borders:"Borders",None:"None",Single:"Single",Dot:"Dot",DashSmallGap:"DashSmallGap",DashLargeGap:"DashLargeGap",DashDot:"DashDot",DashDotDot:"DashDotDot",Double:"Double",Triple:"Triple",ThinThickSmallGap:"ThinThickSmallGap",ThickThinSmallGap:"ThickThinSmallGap",ThinThickThinSmallGap:"ThinThickThinSmallGap",ThinThickMediumGap:"ThinThickMediumGap",ThickThinMediumGap:"ThickThinMediumGap",ThinThickThinMediumGap:"ThinThickThinMediumGap",ThinThickLargeGap:"ThinThickLargeGap",ThickThinLargeGap:"ThickThinLargeGap",ThinThickThinLargeGap:"ThinThickThinLargeGap",SingleWavy:"SingleWavy",DoubleWavy:"DoubleWavy",DashDotStroked:"DashDotStroked",Emboss3D:"Emboss3D",Engrave3D:"Engrave3D",Outset:"Outset",Inset:"Inset",Thick:"Thick",Style:"Style",Width:"Width",Height:"Height",Letter:"Letter",Tabloid:"Tabloid",Legal:"Legal",Statement:"Statement",Executive:"Executive",A3:"A3",A4:"A4",A5:"A5",B4:"B4",B5:"B5","Custom Size":"Custom size","Different odd and even":"Different odd and even","Different first page":"Different first page","From edge":"From edge",Header:"Header",Footer:"Footer",Margin:"Margins",Paper:"Paper",Layout:"Layout",Orientation:"Orientation",Landscape:"Landscape",Portrait:"Portrait","Table Of Contents":"Table Of Contents","Show page numbers":"Show page numbers","Right align page numbers":"Right align page numbers",Nothing:"Nothing","Tab leader":"Tab leader","Show levels":"Show levels","Use hyperlinks instead of page numbers":"Use hyperlinks instead of page numbers","Build table of contents from":"Build table of contents from",Styles:"Styles","Available styles":"Available styles","TOC level":"TOC level",Heading:"Heading","List Paragraph":"List Paragraph",Normal:"Normal","Outline levels":"Outline levels","Table entry fields":"Table entry fields",Modify:"Modify",Color:"Color",Setting:"Setting",Box:"Box",All:"All",Custom:"Custom",Preview:"Preview",Shading:"Shading",Fill:"Fill","Apply To":"Apply to","Table Properties":"Table Properties","Cell Options":"Cell Options","Table Options":"Table Options","Insert Table":"Insert Table","Number of columns":"Number of columns","Number of rows":"Number of rows","Text to display":"Text to display",Address:"Address","Insert Hyperlink":"Insert Hyperlink","Edit Hyperlink":"Edit Hyperlink",Insert:"Insert",General:"General",Indentation:"Indentation","Before text":"Before text",Special:"Special","First line":"First line",Hanging:"Hanging","After text":"After text",By:"By",Before:"Before","Line Spacing":"Line spacing",After:"After",At:"At",Multiple:"Multiple",Spacing:"Spacing","Define new Multilevel list":"Define new Multilevel list","List level":"List level","Choose level to modify":"Choose level to modify",Level:"Level","Number format":"Number format","Number style for this level":"Number style for this level","Enter formatting for number":"Enter formatting for number","Start at":"Start at","Restart list after":"Restart list after",Position:"Position","Text indent at":"Text indent at","Aligned at":"Aligned at","Follow number with":"Follow number with","Tab character":"Tab character",Space:"Space",Arabic:"Arabic",UpRoman:"UpRoman",LowRoman:"LowRoman",UpLetter:"UpLetter",LowLetter:"LowLetter",Number:"Number","Leading zero":"Leading zero",Bullet:"Bullet",Ordinal:"Ordinal","Ordinal Text":"Ordinal Text","For East":"For East","No Restart":"No Restart",Font:"Font","Font style":"Font style","Underline style":"Underline style","Font color":"Font color",Effects:"Effects",Strikethrough:"Strikethrough",Superscript:"Superscript",Subscript:"Subscript","Double strikethrough":"Double strikethrough",Regular:"Regular",Bold:"Bold",Italic:"Italic",Cut:"Cut",Copy:"Copy",Paste:"Paste",Hyperlink:"Hyperlink","Open Hyperlink":"Open Hyperlink","Copy Hyperlink":"Copy Hyperlink","Remove Hyperlink":"Remove Hyperlink",Paragraph:"Paragraph","Merge Cells":"Merge Cells","Insert Above":"Insert Above","Insert Below":"Insert Below","Insert Left":"Insert Left","Insert Right":"Insert Right",Delete:"Delete","Delete Table":"Delete Table","Delete Row":"Delete Row","Delete Column":"Delete Column","File Name":"File Name","Format Type":"Format Type",Save:"Save",Navigation:"Navigation",Results:"Results",Replace:"Replace","Replace All":"Replace All","We replaced all":"We replaced all",Find:"Find","No matches":"No matches","All Done":"All Done",Result:"Result",of:"of",instances:"instances",with:"with","Click to follow link":"Click to follow link","Continue Numbering":"Continue Numbering","Bookmark name":"Bookmark name",Close:"Close","Restart At":"Restart At",Properties:"Properties",Name:"Name","Style type":"Style type","Style based on":"Style based on","Style for following paragraph":"Style for following paragraph",Formatting:"Formatting","Numbering and Bullets":"Numbering and Bullets",Numbering:"Numbering","Update Field":"Update Field","Edit Field":"Edit Field",Bookmark:"Bookmark","Page Setup":"Page Setup","No bookmarks found":"No bookmarks found","Number format tooltip information":'Single-level number format: </br>[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "Chapter %1." will display numbering like</br>Chapter 1. Item</br>Chapter 2. Item</br>…</br>Chapter N. Item</br></br>Multilevel number format:</br>[PREFIX]%[LEVELNUMBER][SUFFIX]+[PREFIX]%[LEVELNUMBER][SUFFIX]</br>For example, "%1.%2." will display numbering like</br>1.1. Item</br>1.2. Item</br>…</br>1.N. Item',Format:"Format","Create New Style":"Create New Style","Modify Style":"Modify Style",New:"New",Bullets:"Bullets","Use bookmarks":"Use bookmarks","Table of Contents":"Table of Contents"},r.viewer=new ve(r),r.parser=new ye(r.viewer),r}u(r,e),n=r,Object.defineProperty(r.prototype,"enableHeaderAndFooter",{get:function(){return this.enableHeaderFooterIn},set:function(e){this.enableHeaderFooterIn=e,this.viewer.updateScrollBars()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pageCount",{get:function(){return!this.isDocumentLoaded||t.isNullOrUndefined(this.viewer)?1:this.viewer.pages.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selection",{get:function(){return this.selectionModule},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"editor",{get:function(){return this.editorModule},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"editorHistory",{get:function(){return this.editorHistoryModule},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"search",{get:function(){return this.searchModule},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"contextMenu",{get:function(){return this.contextMenuModule},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"containerId",{get:function(){return this.element.id},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isDocumentLoaded",{get:function(){return this.isDocumentLoadedIn},set:function(e){this.isDocumentLoadedIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"enableHistoryMode",{get:function(){return this.enableEditorHistory&&!t.isNullOrUndefined(this.editorHistoryModule)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"documentStart",{get:function(){if(!t.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentStart()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"documentEnd",{get:function(){if(!t.isNullOrUndefined(this.selectionModule))return this.selection.getDocumentEnd()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isReadOnlyMode",{get:function(){return this.isReadOnly||t.isNullOrUndefined(this.editorModule)||t.isNullOrUndefined(this.selectionModule)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"enableImageResizerMode",{get:function(){return this.enableImageResizer&&!t.isNullOrUndefined(this.imageResizerModule)},enumerable:!0,configurable:!0}),r.prototype.preRender=function(){this.findResultsList=[]},r.prototype.render=function(){if(this.viewer.initializeComponents(),this.openBlank(),!t.isNullOrUndefined(this.element)){var e=this.element;e.style.minHeight="200px",e.style.minWidth="200px"}},r.prototype.getModuleName=function(){return"DocumentEditor"},r.prototype.onPropertyChanged=function(e,i){for(var r=0,n=Object.keys(e);r<n.length;r++)switch(n[r]){case"zoomFactor":this.viewer&&(this.viewer.zoomFactor=e.zoomFactor);break;case"locale":this.localizeDialogs();break;case"isReadOnly":!t.isNullOrUndefined(this.optionsPaneModule)&&this.optionsPaneModule.isOptionsPaneShow&&this.optionsPaneModule.showHideOptionsPane(!1)}},r.prototype.localizeDialogs=function(){if(""!==this.locale){var e=new t.L10n("documenteditor",this.defaultLocale);e.setLocale(this.locale),t.setCulture(this.locale),this.optionsPaneModule&&this.optionsPaneModule.initOptionsPane(e),this.paragraphDialogModule&&this.paragraphDialogModule.initParagraphDialog(e),this.pageSetupDialogModule&&this.pageSetupDialogModule.initPageSetupDialog(e),this.fontDialogModule&&this.fontDialogModule.initFontDialog(e),this.hyperlinkDialogModule&&this.hyperlinkDialogModule.initHyperlinkDialog(e),this.contextMenuModule&&this.contextMenuModule.initContextMenu(e),this.listDialogModule&&this.listDialogModule.initListDialog(e),this.tablePropertiesDialogModule&&this.tablePropertiesDialogModule.initTablePropertyDialog(e),this.bordersAndShadingDialogModule&&this.bordersAndShadingDialogModule.initBordersAndShadingsDialog(e),this.cellOptionsDialogModule&&this.cellOptionsDialogModule.initCellMarginsDialog(e),this.tableOptionsDialogModule&&this.tableOptionsDialogModule.initTableOptionsDialog(e),this.tableDialogModule&&this.tableDialogModule.initTableDialog(e),this.styleDialogModule&&this.styleDialogModule.initStyleDialog(e),this.tableOfContentsDialogModule&&this.tableOfContentsDialogModule.initTableOfContentDialog(e)}},r.prototype.getPersistData=function(){return"documenteditor"},r.prototype.clearPreservedCollectionsInViewer=function(){this.viewer instanceof me&&this.viewer.clearDocumentItems()},r.prototype.getDocumentEditorElement=function(){return this.element},r.prototype.fireContentChange=function(){var e={source:this};this.trigger("contentChange",e)},r.prototype.fireDocumentChange=function(){var e={source:this};this.trigger("documentChange",e)},r.prototype.fireSelectionChange=function(){!this.viewer.isCompositionStart&&t.Browser.isDevice&&this.editorModule&&this.editorModule.predictText();var e={source:this};this.trigger("selectionChange",e)},r.prototype.fireZoomFactorChange=function(){var e={source:this};this.trigger("zoomFactorChange",e)},r.prototype.fireViewChange=function(){if(this.viewer&&this.viewer.pages.length>0&&this.viewer.visiblePages.length>0){var e=this.viewer.visiblePages,t={startPage:e[0].index+1,endPage:e[e.length-1].index+1,source:this};this.trigger("viewChange",t)}},r.prototype.showParagraphDialog=function(e){this.paragraphDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.paragraphDialogModule.show(e)},r.prototype.showPageSetupDialog=function(){this.pageSetupDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.pageSetupDialogModule.show()},r.prototype.showFontDialog=function(e){this.fontDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.fontDialogModule.showFontDialog(e)},r.prototype.showCellOptionsDialog=function(){this.cellOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.cellOptionsDialogModule.show()},r.prototype.showTableOptionsDialog=function(){this.tableOptionsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableOptionsDialogModule.show()},r.prototype.showTableDialog=function(){this.tableDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableDialogModule.show()},r.prototype.showTableOfContentsDialog=function(){this.tableOfContentsDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tableOfContentsDialogModule.show()},r.prototype.showStyleDialog=function(){this.styleDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.styleDialogModule.show()},r.prototype.showHyperlinkDialog=function(){this.hyperlinkDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.hyperlinkDialogModule.show()},r.prototype.showBookmarkDialog=function(){this.bookmarkDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.bookmarkDialogModule.show()},r.prototype.showStylesDialog=function(){this.stylesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.stylesDialogModule.show()},r.prototype.showListDialog=function(){this.listDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.listDialogModule.showListDialog()},r.prototype.showTablePropertiesDialog=function(){this.tablePropertiesDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.tablePropertiesDialogModule.show()},r.prototype.showBordersAndShadingDialog=function(){this.bordersAndShadingDialogModule&&!this.isReadOnlyMode&&this.viewer&&this.bordersAndShadingDialogModule.show()},r.prototype.requiredModules=function(){var e=[];return this.enablePrint&&e.push({member:"Print",args:[]}),(this.enableSfdtExport||this.enableWordExport||this.enableTextExport||this.enableSelection||this.enableEditor)&&e.push({member:"SfdtExport",args:[this.viewer]}),this.enableWordExport&&e.push({member:"WordExport",args:[]}),this.enableTextExport&&e.push({member:"TextExport",args:[]}),(this.enableSelection||this.enableSearch||this.enableEditor)&&(e.push({member:"Selection",args:[this]}),this.enableContextMenu&&e.push({member:"ContextMenu",args:[this.viewer]})),this.enableSearch&&(e.push({member:"Search",args:[this]}),this.enableOptionsPane&&e.push({member:"OptionsPane",args:[this.viewer]})),this.enableEditor&&(e.push({member:"Editor",args:[this.viewer]}),this.enableImageResizer&&e.push({member:"ImageResizer",args:[this,this.viewer]}),this.enableEditorHistory&&e.push({member:"EditorHistory",args:[this]}),this.enableHyperlinkDialog&&e.push({member:"HyperlinkDialog",args:[this.viewer]}),this.enableTableDialog&&e.push({member:"TableDialog",args:[this.viewer]}),this.enableBookmarkDialog&&e.push({member:"BookmarkDialog",args:[this.viewer]}),this.enableTableOfContentsDialog&&e.push({member:"TableOfContentsDialog",args:[this.viewer]}),this.enablePageSetupDialog&&e.push({member:"PageSetupDialog",args:[this.viewer]}),this.enableStyleDialog&&(e.push({member:"StylesDialog",args:[this.viewer]}),e.push({member:"StyleDialog",args:[this.viewer]}),e.push({member:"BulletsAndNumberingDialog",args:[this.viewer]})),this.enableListDialog&&e.push({member:"ListDialog",args:[this.viewer]}),this.enableParagraphDialog&&e.push({member:"ParagraphDialog",args:[this.viewer]}),this.enableFontDialog&&e.push({member:"FontDialog",args:[this.viewer]}),this.enableTablePropertiesDialog&&(e.push({member:"TablePropertiesDialog",args:[this.viewer]}),e.push({member:"CellOptionsDialog",args:[this.viewer]})),this.enableBordersAndShadingDialog&&e.push({member:"BordersAndShadingDialog",args:[this.viewer]}),this.enableTableOptionsDialog&&e.push({member:"TableOptionsDialog",args:[this.viewer]})),e},r.prototype.open=function(e){t.isNullOrUndefined(this.viewer)||(this.clearPreservedCollectionsInViewer(),this.viewer.lists=[],this.viewer.abstractLists=[],this.viewer.styles=new L,!t.isNullOrUndefined(e)&&this.viewer&&(this.viewer.onDocumentChanged(this.parser.convertJsonToDocument(e)),this.editorModule&&this.editorModule.intializeDefaultStyles()))},r.prototype.scrollToPage=function(e){return!(t.isNullOrUndefined(this.viewer)||e<1||e>this.viewer.pages.length)&&(this.viewer.scrollToPage(e-1),!0)},r.prototype.enableAllModules=function(){this.enablePrint=this.enableSfdtExport=this.enableWordExport=this.enableTextExport=this.enableSelection=this.enableContextMenu=this.enableSearch=this.enableOptionsPane=this.enableEditor=this.enableImageResizer=this.enableEditorHistory=this.enableHyperlinkDialog=this.enableTableDialog=this.enableBookmarkDialog=this.enableTableOfContentsDialog=this.enablePageSetupDialog=this.enableStyleDialog=this.enableListDialog=this.enableParagraphDialog=this.enableFontDialog=this.enableTablePropertiesDialog=this.enableBordersAndShadingDialog=this.enableTableOptionsDialog=!0,n.Inject(v,nt,it,rt,Le,He,Ae,Je,tt,le,Ue,ot,at,st,lt,dt,gt,pt,ht,ut,ft,mt,vt,yt,wt,bt)},r.prototype.resize=function(e,i){this.element&&(!t.isNullOrUndefined(e)&&e>200&&(this.element.style.width=e+"px"),!t.isNullOrUndefined(i)&&i>200&&(this.element.style.height=i+"px"),this.viewer&&this.viewer.updateViewerSize())},r.prototype.focusIn=function(){this.viewer&&this.viewer.updateFocus()},r.prototype.fitPage=function(e){t.isNullOrUndefined(e)&&(e="None"),this.viewer&&(this.viewer.pageFitType=e)},r.prototype.print=function(e){if(t.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if(!this.printModule)throw new Error("Invalid operation. Print is not enabled.");this.printModule.print(this.viewer,e)},r.prototype.serialize=function(){if(!(this.enableSfdtExport&&this.sfdtExportModule instanceof nt))throw new Error("Invalid operation. Sfdt export is not enabled.");return this.sfdtExportModule.serialize()},r.prototype.save=function(e,r){if(e=e||"Untitled",t.isNullOrUndefined(this.viewer))throw new Error("Invalid operation.");if("Docx"===r&&this.wordExportModule)this.wordExportModule&&this.wordExportModule.save(this.viewer,e);else if("Txt"===r&&this.textExportModule)this.textExportModule.save(this.viewer,e);else{if("Sfdt"!==r||!this.enableSfdtExport||!this.sfdtExportModule)throw new Error("Invalid operation. Specified export is not enabled.");var n=this.serialize(),o=new Blob([n],{type:"application/json"});i.Save.save(e+".sfdt",o)}},r.prototype.saveAsBlob=function(e){var i=this;if(t.isNullOrUndefined(this.viewer))throw new Error("Invalid operation");return new Promise(function(t,r){"Docx"===e&&i.wordExportModule?t(i.wordExportModule.saveAsBlob(i.viewer)):"Txt"===e&&i.textExportModule?t(i.textExportModule.saveAsBlob(i.viewer)):"Sfdt"===e&&i.enableSfdtExport&&i.sfdtExportModule&&t(i.sfdtExportModule.saveAsBlob(i.viewer))})},r.prototype.openBlank=function(){var e=new V;e.index=0,e.sectionFormat=new y(e);var t=new G;t.index=0,t.paragraphFormat=new F(t),t.characterFormat=new P(t),e.childWidgets.push(t),t.containerWidget=e;var i=[];i.push(e);var r=this.parser.parseHeaderFooter({header:{},footer:{},evenHeader:{},evenFooter:{},firstPageHeader:{},firstPageFooter:{}},void 0);if(this.viewer&&(this.clearPreservedCollectionsInViewer(),this.viewer.headersFooters.push(r),this.viewer.onDocumentChanged(i),this.editorModule)){this.editorModule.intializeDefaultStyles();var n=this.viewer.styles.findByName("Normal");t.paragraphFormat.baseStyle=n,t.paragraphFormat.listFormat.baseStyle=n}},r.prototype.getStyleNames=function(e){return this.viewer?this.viewer.styles.getStyleNames(e):[]},r.prototype.getStyles=function(e){return this.viewer?this.viewer.styles.getStyles(e):[]},r.prototype.showDialog=function(e){switch(e){case"Hyperlink":this.showHyperlinkDialog();break;case"Table":this.showTableDialog();break;case"Bookmark":this.showBookmarkDialog();break;case"TableOfContents":this.showTableOfContentsDialog();break;case"PageSetup":this.showPageSetupDialog();break;case"List":this.showListDialog();break;case"Styles":this.showStylesDialog();break;case"Style":this.showStyleDialog();break;case"Paragraph":this.showParagraphDialog();break;case"Font":this.showFontDialog();break;case"TableProperties":this.showTablePropertiesDialog();break;case"BordersAndShading":this.showBordersAndShadingDialog();break;case"TableOptions":this.showTableOptionsDialog()}},r.prototype.showOptionsPane=function(){t.isNullOrUndefined(this.optionsPaneModule)||t.isNullOrUndefined(this.viewer)||this.optionsPaneModule.showHideOptionsPane(!0)},r.prototype.destroy=function(){e.prototype.destroy.call(this),this.destroyDependentModules(),t.isNullOrUndefined(this.viewer)||this.viewer.destroy(),this.viewer=void 0,t.isNullOrUndefined(this.element)||(this.element.classList.remove("e-documenteditor"),this.element.innerHTML=""),this.element=void 0,this.findResultsList=[],this.findResultsList=void 0},r.prototype.destroyDependentModules=function(){this.printModule&&(this.printModule.destroy(),this.printModule=void 0),this.sfdtExportModule&&(this.sfdtExportModule.destroy(),this.sfdtExportModule=void 0),this.optionsPaneModule&&(this.optionsPaneModule.destroy(),this.optionsPaneModule=void 0),t.isNullOrUndefined(this.hyperlinkDialogModule)||(this.hyperlinkDialogModule.destroy(),this.hyperlinkDialogModule=void 0),this.searchModule&&(this.searchModule.destroy(),this.searchModule=void 0),this.contextMenuModule&&(this.contextMenuModule.destroy(),this.contextMenuModule=void 0),this.editorModule&&(this.editorModule.destroy(),this.editorModule=void 0),this.selectionModule&&(this.selectionModule.destroy(),this.selectionModule=void 0),this.editorHistoryModule&&(this.editorHistoryModule.destroy(),this.editorHistoryModule=void 0),t.isNullOrUndefined(this.paragraphDialogModule)||(this.paragraphDialogModule.destroy(),this.paragraphDialogModule=void 0),this.pageSetupDialogModule&&(this.pageSetupDialogModule.destroy(),this.pageSetupDialogModule=void 0),this.fontDialogModule&&(this.fontDialogModule.destroy(),this.fontDialogModule=void 0),this.listDialogModule&&(this.listDialogModule.destroy(),this.listDialogModule=void 0),this.imageResizerModule&&(this.imageResizerModule.destroy(),this.imageResizerModule=void 0),this.tablePropertiesDialogModule&&(this.tablePropertiesDialogModule.destroy(),this.tablePropertiesDialogModule=void 0),this.bordersAndShadingDialogModule&&(this.bordersAndShadingDialogModule.destroy(),this.bordersAndShadingDialogModule=void 0),this.cellOptionsDialogModule&&(this.cellOptionsDialogModule.destroy(),this.cellOptionsDialogModule=void 0),this.tableOptionsDialogModule&&(this.tableOptionsDialogModule.destroy(),this.tableOptionsDialogModule=void 0),this.tableDialogModule&&(this.tableDialogModule.destroy(),this.tableDialogModule=void 0),this.styleDialogModule&&(this.styleDialogModule=void 0),this.bookmarkDialogModule&&(this.bookmarkDialogModule.destroy(),this.bookmarkDialogModule=void 0),this.styleDialogModule&&(this.styleDialogModule.destroy(),this.styleDialogModule=void 0),this.textExportModule&&(this.textExportModule.destroy(),this.textExportModule=void 0),this.wordExportModule&&(this.wordExportModule.destroy(),this.wordExportModule=void 0),this.tableOfContentsDialogModule&&(this.tableOfContentsDialogModule.destroy(),this.tableOfContentsDialogModule=void 0)};var n;return f([t.Property(1)],r.prototype,"zoomFactor",void 0),f([t.Property(!0)],r.prototype,"isReadOnly",void 0),f([t.Property(!1)],r.prototype,"enablePrint",void 0),f([t.Property(!1)],r.prototype,"enableSelection",void 0),f([t.Property(!1)],r.prototype,"enableEditor",void 0),f([t.Property(!1)],r.prototype,"enableEditorHistory",void 0),f([t.Property(!1)],r.prototype,"enableSfdtExport",void 0),f([t.Property(!1)],r.prototype,"enableWordExport",void 0),f([t.Property(!1)],r.prototype,"enableTextExport",void 0),f([t.Property(!1)],r.prototype,"enableOptionsPane",void 0),f([t.Property(!1)],r.prototype,"enableContextMenu",void 0),f([t.Property(!1)],r.prototype,"enableHyperlinkDialog",void 0),f([t.Property(!1)],r.prototype,"enableBookmarkDialog",void 0),f([t.Property(!1)],r.prototype,"enableTableOfContentsDialog",void 0),f([t.Property(!1)],r.prototype,"enableSearch",void 0),f([t.Property(!1)],r.prototype,"enableParagraphDialog",void 0),f([t.Property(!1)],r.prototype,"enableListDialog",void 0),f([t.Property(!1)],r.prototype,"enableTablePropertiesDialog",void 0),f([t.Property(!1)],r.prototype,"enableBordersAndShadingDialog",void 0),f([t.Property(!1)],r.prototype,"enablePageSetupDialog",void 0),f([t.Property(!1)],r.prototype,"enableStyleDialog",void 0),f([t.Property(!1)],r.prototype,"enableFontDialog",void 0),f([t.Property(!1)],r.prototype,"enableTableOptionsDialog",void 0),f([t.Property(!1)],r.prototype,"enableTableDialog",void 0),f([t.Property(!1)],r.prototype,"enableImageResizer",void 0),f([t.Event()],r.prototype,"documentChange",void 0),f([t.Event()],r.prototype,"viewChange",void 0),f([t.Event()],r.prototype,"zoomFactorChange",void 0),f([t.Event()],r.prototype,"selectionChange",void 0),f([t.Event()],r.prototype,"requestNavigate",void 0),f([t.Event()],r.prototype,"contentChange",void 0),f([t.Event()],r.prototype,"keyDown",void 0),f([t.Event()],r.prototype,"searchResultsChange",void 0),f([t.Event()],r.prototype,"created",void 0),f([t.Event()],r.prototype,"destroyed",void 0),r=n=f([t.NotifyPropertyChanges],r)}(t.Component),v=function(){function e(){}return e.prototype.getModuleName=function(){return"Print"},e.prototype.print=function(e,t){this.printWindow(e,navigator.userAgent,t)},e.prototype.printWindow=function(e,i,r){var n=this.getPageHeight(e.pages),o=this.getPageWidth(e.pages),a=document.createElement("div");a.style.width="100%",a.style.height="100%",a.style.overflow="scroll",this.generatePrintContent(e,a),t.isNullOrUndefined(r)&&(r=window.open("","print","height=452,width=1024,tabbar=no")),-1!==i.indexOf("Chrome")||-1!==i.indexOf("Firefox")?(r.document.write("<!DOCTYPE html>"),r.document.write("<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100 %; } img { height: 100 %; width: 100 %; display: block;}img { box-sizing: border-box; }br, button { display: none; }@page{ margin: 0cm; size:"+o.toString()+"px "+n.toString()+"px; }@media print{ body { margin: 0cm; }</style></head> <body><center>")):r.document.write("<html><head><style>@page{margin:0;size:"+o.toString()+"px "+n.toString()+"px;}</style></head><body><center>"),r.document.write(a.innerHTML+"</center><script> (function() { window.ready = true; })(); <\/script></body></html>"),a=void 0,r.document.close(),r.focus();var s=setInterval(function(){r.ready&&(r.print(),r.close(),clearInterval(s))},500)},e.prototype.generatePrintContent=function(e,t){for(var i="",r=0;r<e.pages.length;r++){var n=e.pages[r],o=n.boundingRectangle.height,a=n.boundingRectangle.width;e.render.isPrinting=!0,e.render.renderWidgets(n,0,0,0,0);var s=e.render.pageCanvas.toDataURL();e.render.isPrinting=!1,i+="<div><img src="+s+' style="margin:0px;display:block;width: '+a.toString()+"px; height:"+o.toString()+'px; "/></div><br/>'}t.innerHTML=i},e.prototype.getPageWidth=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.width&&(t=e[i].boundingRectangle.width);return t},e.prototype.getPageHeight=function(e){for(var t=0,i=0;i<e.length;i++)t<e[i].boundingRectangle.height&&(t=e[i].boundingRectangle.height);return t},e.prototype.destroy=function(){},e}(),y=function(){function e(e){this.uniqueSectionFormat=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.getPropertyValue("headerDistance")},set:function(e){this.setPropertyValue("headerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.getPropertyValue("footerDistance")},set:function(e){this.setPropertyValue("footerDistance",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.getPropertyValue("differentFirstPage")},set:function(e){this.setPropertyValue("differentFirstPage",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.getPropertyValue("differentOddAndEvenPages")},set:function(e){this.setPropertyValue("differentOddAndEvenPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.getPropertyValue("pageHeight")},set:function(e){this.setPropertyValue("pageHeight",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.getPropertyValue("pageWidth")},set:function(e){this.setPropertyValue("pageWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.isNullOrUndefined(this.uniqueSectionFormat)||e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueSectionFormat)){var i=p.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,e);return this.uniqueSectionFormat.propertiesHash.containsKey(i)}return!1},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"headerDistance":case"footerDistance":t=36;break;case"differentFirstPage":case"differentOddAndEvenPages":t=!1;break;case"pageWidth":t=612;break;case"pageHeight":t=792;break;case"leftMargin":case"topMargin":case"rightMargin":case"bottomMargin":t=72}return t},e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){var r=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueSectionFormat)&&this.uniqueSectionFormat.propertiesHash.containsKey(r))return this.uniqueSectionFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueSectionFormat))this.initializeUniqueSectionFormat(i,r);else{var n=p.getPropertyType(this.uniqueSectionFormat.uniqueFormatType,i);if(this.uniqueSectionFormat.propertiesHash.containsKey(n)&&this.uniqueSectionFormat.propertiesHash.get(n)===r)return;this.uniqueSectionFormat=e.uniqueSectionFormats.updateUniqueFormat(this.uniqueSectionFormat,i,r)}},e.prototype.initializeUniqueSectionFormat=function(t,i){var r=new c;this.addUniqueSectionFormat("headerDistance",t,i,r),this.addUniqueSectionFormat("footerDistance",t,i,r),this.addUniqueSectionFormat("differentFirstPage",t,i,r),this.addUniqueSectionFormat("differentOddAndEvenPages",t,i,r),this.addUniqueSectionFormat("pageWidth",t,i,r),this.addUniqueSectionFormat("pageHeight",t,i,r),this.addUniqueSectionFormat("leftMargin",t,i,r),this.addUniqueSectionFormat("topMargin",t,i,r),this.addUniqueSectionFormat("rightMargin",t,i,r),this.addUniqueSectionFormat("bottomMargin",t,i,r),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueSectionFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.copyFormat=function(e,i){i&&(i.isUndoing||i.isRedoing)?this.uniqueSectionFormat=e.uniqueSectionFormat:t.isNullOrUndefined(e)||!t.isNullOrUndefined(e.uniqueSectionFormat)&&e.uniqueSectionFormat.propertiesHash&&this.updateUniqueSectionFormat(e)},e.prototype.updateUniqueSectionFormat=function(i){var r=void 0;this.uniqueSectionFormat&&(r=this.uniqueSectionFormat.mergeProperties(i.uniqueSectionFormat),0===this.uniqueSectionFormat.referenceCount&&(e.uniqueSectionFormats.remove(this.uniqueSectionFormat),this.uniqueSectionFormat=void 0)),this.uniqueSectionFormat=new p(e.uniqueFormatType),t.isNullOrUndefined(r)&&(r=this.uniqueSectionFormat.mergeProperties(i.uniqueSectionFormat)),this.uniqueSectionFormat=e.uniqueSectionFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var t=new e;return t.uniqueSectionFormat=this.uniqueSectionFormat,t},e.clear=function(){this.uniqueSectionFormats.clear()},e.uniqueSectionFormats=new g,e.uniqueFormatType=10,e}(),w=function(){function e(){}return e.prototype.destroy=function(){t.isNullOrUndefined(this.overrideListLevel)||this.overrideListLevel.destroy(),this.levelNumber=void 0,this.startAt=void 0,this.overrideListLevel=void 0},e}(),b=function(){function e(){this.listId=-1,this.sourceListId=-1,this.abstractListId=-1,this.abstractList=void 0,this.levelOverrides=[]}return e.prototype.getListLevel=function(e){var i=this.getLevelOverride(e);return t.isNullOrUndefined(i)||t.isNullOrUndefined(i.overrideListLevel)?this.abstractList.levels[e]:i.overrideListLevel},e.prototype.getLevelOverride=function(e){for(var t=0;t<this.levelOverrides.length;t++)if(this.levelOverrides[t]instanceof w){var i=this.levelOverrides[t];if(i.levelNumber===e)return i}},e.prototype.destroy=function(){t.isNullOrUndefined(this.levelOverrides)||(this.levelOverrides=[]),this.abstractListId=void 0,this.listId=void 0,this.sourceListId=void 0,this.levelOverrides=void 0},e.prototype.mergeList=function(e){t.isNullOrUndefined(this.abstractListId)||-1===this.abstractListId||(this.abstractListId=e.abstractListId),t.isNullOrUndefined(this.listId)||-1===this.listId||(this.listId=e.listId),t.isNullOrUndefined(this.sourceListId)||-1===this.sourceListId||(this.sourceListId=e.sourceListId),t.isNullOrUndefined(this.levelOverrides)||0===this.levelOverrides.length||(this.levelOverrides=e.levelOverrides)},e}(),x=function(){function e(e){this.uniqueListFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.list=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"listId",{get:function(){return this.getPropertyValue("listId")},set:function(e){this.setPropertyValue("listId",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.getPropertyValue("listLevelNumber")},set:function(e){this.setPropertyValue("listLevelNumber",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){var e=void 0;if(t.isNullOrUndefined(this.list))for(var i=this.baseStyle;!t.isNullOrUndefined(i);){if(i.paragraphFormat.listFormat.list){e=i.paragraphFormat.listFormat.list;break}i=i.basedOn}else e=this.list;return t.isNullOrUndefined(e)?void 0:e.getListLevel(this.listLevelNumber)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){n=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueListFormat)&&this.uniqueListFormat.propertiesHash.containsKey(n))return this.uniqueListFormat.propertiesHash.get(n)}else if(this.baseStyle instanceof N){for(var r=this.baseStyle;!t.isNullOrUndefined(r)&&!r.paragraphFormat.listFormat.hasValue(i);)r=r.basedOn;if(!t.isNullOrUndefined(r)){var n=p.getPropertyType(e.uniqueFormatType,i);return r.paragraphFormat.listFormat.uniqueListFormat.propertiesHash.get(n)}}return e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueListFormat))this.initializeUniqueListFormat(i,r);else{var n=p.getPropertyType(this.uniqueListFormat.uniqueFormatType,i);if(this.uniqueListFormat.propertiesHash.containsKey(n)&&this.uniqueListFormat.propertiesHash.get(n)===r)return;this.uniqueListFormat=e.uniqueListFormats.updateUniqueFormat(this.uniqueListFormat,i,r)}},e.prototype.initializeUniqueListFormat=function(t,i){var r=new c;this.addUniqueListFormat("listId",t,i,r),this.addUniqueListFormat("listLevelNumber",t,i,r),this.uniqueListFormat=e.uniqueListFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueListFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listId":t=-1;break;case"listLevelNumber":t=0}return t},e.prototype.copyFormat=function(e){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.uniqueListFormat)||(this.listId=e.listId,this.listLevelNumber=e.listLevelNumber),t.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),t.isNullOrUndefined(e.list)||(this.list=e.list))},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueListFormat)){var i=p.getPropertyType(this.uniqueListFormat.uniqueFormatType,e);return this.uniqueListFormat.propertiesHash.containsKey(i)}return!1},e.prototype.clearFormat=function(){t.isNullOrUndefined(this.uniqueListFormat)||0!==this.uniqueListFormat.referenceCount||e.uniqueListFormats.remove(this.uniqueListFormat),this.uniqueListFormat=void 0,this.list=void 0},e.prototype.destroy=function(){this.clearFormat()},e.clear=function(){this.uniqueListFormats.clear()},e.prototype.ApplyStyle=function(e){this.baseStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){t.isNullOrUndefined(this.getValue("listId"))&&(this.listId=e.getValue("listId")),t.isNullOrUndefined(this.getValue("listLevelNumber"))&&(this.listLevelNumber=e.getValue("listLevelNumber")),t.isNullOrUndefined(e.list)||(t.isNullOrUndefined(this.list)&&(this.list=new b),this.list.mergeList(e.list))},e.uniqueListFormats=new g,e.uniqueFormatType=7,e}(),C=function(){function e(){}return Object.defineProperty(e.prototype,"position",{get:function(){return this.positionIn},set:function(e){this.positionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletePosition",{get:function(){return this.deletePositionIn},set:function(e){this.deletePositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabJustification",{get:function(){return this.justification},set:function(e){this.justification=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tabLeader",{get:function(){return this.leader},set:function(e){this.leader=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.position=void 0,this.deletePosition=void 0,this.tabJustification=void 0,this.leader=void 0},e}(),F=function(){function e(e){this.uniqueParagraphFormat=void 0,this.ownerBase=void 0,this.baseStyle=void 0,this.tabs=void 0,this.ownerBase=e,this.listFormat=new x(this),this.tabs=[]}return e.prototype.getUpdatedTabs=function(){var e=[];if(!t.isNullOrUndefined(this.baseStyle)){for(var i=this.baseStyle,r=new c;!t.isNullOrUndefined(i);){for(var n=0,o=i.paragraphFormat.tabs;n<o.length;n++){var a=o[n];r.containsKey(a.position)||r.add(a.position,a)}i=i.basedOn}for(var s=0,l=r.keys;s<l.length;s++){var d=l[s];this.hasTabStop(d)||e.push(r.get(d))}e=(e=e.concat(this.tabs.filter(function(e){return 0!==e.position&&0===e.deletePosition}))).sort(function(e,t){return e.position-t.position})}return e},e.prototype.hasTabStop=function(e){for(var t=0;t<this.tabs.length;t++)if(this.tabs[t].deletePosition===e)return!0;return!1},Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.getPropertyValue("rightIndent")},set:function(e){this.setPropertyValue("rightIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.getPropertyValue("firstLineIndent")},set:function(e){this.setPropertyValue("firstLineIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.getPropertyValue("beforeSpacing")},set:function(e){this.setPropertyValue("beforeSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.getPropertyValue("afterSpacing")},set:function(e){this.setPropertyValue("afterSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.getPropertyValue("lineSpacing")},set:function(e){this.setPropertyValue("lineSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.getPropertyValue("lineSpacingType")},set:function(e){this.setPropertyValue("lineSpacingType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){return this.getPropertyValue("textAlignment")},set:function(e){this.setPropertyValue("textAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineLevel",{get:function(){return this.getPropertyValue("outlineLevel")},set:function(e){this.setPropertyValue("outlineLevel",e)},enumerable:!0,configurable:!0}),e.prototype.getListFormatParagraphFormat=function(i){if(this.listFormat.listId>-1&&this.listFormat.listLevelNumber>-1){var r=this.listFormat.listLevel,n=p.getPropertyType(e.uniqueFormatType,i);return t.isNullOrUndefined(r)||t.isNullOrUndefined(r.paragraphFormat.uniqueParagraphFormat)||!r.paragraphFormat.uniqueParagraphFormat.propertiesHash.containsKey(n)?void 0:r.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(n)}},e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){o=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueParagraphFormat)&&this.uniqueParagraphFormat.propertiesHash.containsKey(o))return this.uniqueParagraphFormat.propertiesHash.get(o)}else{var r=this.getListFormatParagraphFormat(i);if(!t.isNullOrUndefined(r))return r;if(this.baseStyle instanceof N){for(var n=this.baseStyle;!t.isNullOrUndefined(n)&&!n.paragraphFormat.hasValue(i);)n=n.basedOn;if(!t.isNullOrUndefined(n)){var o=p.getPropertyType(e.uniqueFormatType,i);return n.paragraphFormat.uniqueParagraphFormat.propertiesHash.get(o)}}}return this.getDefaultValue(i)},e.prototype.getDefaultValue=function(i){var r=p.getPropertyType(e.uniqueFormatType,i),n=this.documentParagraphFormat();return t.isNullOrUndefined(n)||t.isNullOrUndefined(n.uniqueParagraphFormat)||!n.uniqueParagraphFormat.propertiesHash.containsKey(r)?e.getPropertyDefaultValue(i):n.uniqueParagraphFormat.propertiesHash.get(r)},e.prototype.documentParagraphFormat=function(){var e;return t.isNullOrUndefined(this.ownerBase)||t.isNullOrUndefined(this.ownerBase.bodyWidget)||(e=this.ownerBase.bodyWidget.page.viewer.paragraphFormat),e},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueParagraphFormat))this.initializeUniqueParagraphFormat(i,r);else{var n=p.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,i);if(this.uniqueParagraphFormat.propertiesHash.containsKey(n)&&this.uniqueParagraphFormat.propertiesHash.get(n)===r)return;this.uniqueParagraphFormat=e.uniqueParagraphFormats.updateUniqueFormat(this.uniqueParagraphFormat,i,r)}},e.prototype.initializeUniqueParagraphFormat=function(t,i){var r=new c;this.addUniqueParaFormat("leftIndent",t,i,r),this.addUniqueParaFormat("rightIndent",t,i,r),this.addUniqueParaFormat("firstLineIndent",t,i,r),this.addUniqueParaFormat("textAlignment",t,i,r),this.addUniqueParaFormat("beforeSpacing",t,i,r),this.addUniqueParaFormat("afterSpacing",t,i,r),this.addUniqueParaFormat("lineSpacing",t,i,r),this.addUniqueParaFormat("lineSpacingType",t,i,r),this.addUniqueParaFormat("outlineLevel",t,i,r),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueParaFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftIndent":case"rightIndent":case"firstLineIndent":t=0;break;case"textAlignment":t="Left";break;case"beforeSpacing":case"afterSpacing":t=0;break;case"lineSpacing":t=1;break;case"lineSpacingType":t="Multiple";break;case"styleName":t="Normal";break;case"outlineLevel":t="BodyText"}return t},e.prototype.clearFormat=function(){t.isNullOrUndefined(this.listFormat)||this.listFormat.clearFormat(),t.isNullOrUndefined(this.uniqueParagraphFormat)||0!==this.uniqueParagraphFormat.referenceCount||e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0,this.baseStyle=void 0},e.prototype.destroy=function(){if(this.clearFormat(),t.isNullOrUndefined(this.listFormat)||this.listFormat.destroy(),this.listFormat=void 0,void 0!==this.tabs){for(var e=0;e<this.tabs.length;e++)this.tabs[e].destroy();this.tabs=void 0}},e.prototype.copyFormat=function(e){if(!t.isNullOrUndefined(e)&&(t.isNullOrUndefined(e.uniqueParagraphFormat)||this.updateUniqueParagraphFormat(e),t.isNullOrUndefined(e.listFormat)||this.listFormat.copyFormat(e.listFormat),t.isNullOrUndefined(e.baseStyle)||(this.baseStyle=e.baseStyle),!t.isNullOrUndefined(e.tabs)))for(var i=0;i<e.tabs.length;i++)this.tabs[i]=e.tabs[i]},e.prototype.updateUniqueParagraphFormat=function(i){var r=void 0;this.uniqueParagraphFormat&&(r=this.uniqueParagraphFormat.mergeProperties(i.uniqueParagraphFormat),0===this.uniqueParagraphFormat.referenceCount&&(e.uniqueParagraphFormats.remove(this.uniqueParagraphFormat),this.uniqueParagraphFormat=void 0)),this.uniqueParagraphFormat=new p(e.uniqueFormatType),t.isNullOrUndefined(r)&&(r=this.uniqueParagraphFormat.mergeProperties(i.uniqueParagraphFormat)),this.uniqueParagraphFormat=e.uniqueParagraphFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.cloneFormat=function(){var i=new e(void 0);return i.uniqueParagraphFormat=this.uniqueParagraphFormat,i.baseStyle=this.baseStyle,t.isNullOrUndefined(this.listFormat)?i.listFormat=void 0:(i.listFormat=new x,i.listFormat.listId=this.listFormat.listId,i.listFormat.listLevelNumber=this.listFormat.listLevelNumber),i},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueParagraphFormat)&&!t.isNullOrUndefined(this.uniqueParagraphFormat.propertiesHash)){var i=p.getPropertyType(this.uniqueParagraphFormat.uniqueFormatType,e);return this.uniqueParagraphFormat.propertiesHash.containsKey(i)}return!1},e.clear=function(){this.uniqueParagraphFormats.clear()},e.prototype.ApplyStyle=function(e){this.baseStyle=e,this.listFormat.ApplyStyle(this.baseStyle)},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){t.isNullOrUndefined(this.getValue("leftIndent"))&&(this.leftIndent=e.getValue("leftIndent")),t.isNullOrUndefined(this.getValue("rightIndent"))&&(this.rightIndent=e.getValue("rightIndent")),t.isNullOrUndefined(this.getValue("firstLineIndent"))&&(this.firstLineIndent=e.getValue("firstLineIndent")),t.isNullOrUndefined(this.getValue("beforeSpacing"))&&(this.beforeSpacing=e.getValue("beforeSpacing")),t.isNullOrUndefined(this.getValue("afterSpacing"))&&(this.afterSpacing=e.getValue("afterSpacing")),t.isNullOrUndefined(this.getValue("lineSpacing"))&&(this.lineSpacing=e.getValue("lineSpacing")),t.isNullOrUndefined(this.getValue("lineSpacingType"))&&(this.lineSpacingType=e.getValue("lineSpacingType")),t.isNullOrUndefined(this.getValue("textAlignment"))&&(this.textAlignment=e.getValue("textAlignment")),t.isNullOrUndefined(this.getValue("outlineLevel"))&&(this.outlineLevel=e.getValue("outlineLevel")),t.isNullOrUndefined(this.listFormat)&&this.listFormat.mergeFormat(e.listFormat)},e.uniqueParagraphFormats=new g,e.uniqueFormatType=3,e}(),P=function(){function e(e){this.uniqueCharacterFormat=void 0,this.ownerBase=void 0,this.baseCharStyle=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"bold",{get:function(){return this.getPropertyValue("bold")},set:function(e){this.setPropertyValue("bold",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.getPropertyValue("italic")},set:function(e){this.setPropertyValue("italic",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.getPropertyValue("fontSize")},set:function(e){this.setPropertyValue("fontSize",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.getPropertyValue("fontFamily")},set:function(e){this.setPropertyValue("fontFamily",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.getPropertyValue("underline")},set:function(e){this.setPropertyValue("underline",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.getPropertyValue("strikethrough")},set:function(e){this.setPropertyValue("strikethrough",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.getPropertyValue("baselineAlignment")},set:function(e){this.setPropertyValue("baselineAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.getPropertyValue("highlightColor")},set:function(e){this.setPropertyValue("highlightColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.getPropertyValue("fontColor")},set:function(e){this.setPropertyValue("fontColor",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){var r=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueCharacterFormat)&&this.uniqueCharacterFormat.propertiesHash.containsKey(r))return this.uniqueCharacterFormat.propertiesHash.get(r)}else{var n=this.checkCharacterStyle(i);if(!t.isNullOrUndefined(n))return n;var o=this.checkBaseStyle(i);if(!t.isNullOrUndefined(o))return o}return this.getDefaultValue(i)},e.prototype.getDefaultValue=function(i){var r=p.getPropertyType(e.uniqueFormatType,i),n=this.documentCharacterFormat();return t.isNullOrUndefined(n)||t.isNullOrUndefined(n.uniqueCharacterFormat)||!n.uniqueCharacterFormat.propertiesHash.containsKey(r)?e.getPropertyDefaultValue(i):n.uniqueCharacterFormat.propertiesHash.get(r)},e.prototype.documentCharacterFormat=function(){var e;return t.isNullOrUndefined(this.ownerBase)||(t.isNullOrUndefined(this.ownerBase.paragraph)?t.isNullOrUndefined(this.ownerBase.bodyWidget)||(e=this.ownerBase.bodyWidget.page.viewer.characterFormat):e=this.ownerBase.paragraph.bodyWidget.page.viewer.characterFormat),e},e.prototype.checkBaseStyle=function(i){var r;for(t.isNullOrUndefined(this.ownerBase)||(t.isNullOrUndefined(this.ownerBase.paragraph)?this.ownerBase instanceof G&&!t.isNullOrUndefined(this.ownerBase.paragraphFormat)?r=this.ownerBase.paragraphFormat.baseStyle:t.isNullOrUndefined(this.ownerBase instanceof N)||(r=this.ownerBase.basedOn):r=this.ownerBase.paragraph.paragraphFormat.baseStyle);!t.isNullOrUndefined(r)&&!r.characterFormat.hasValue(i);)r=r.basedOn;if(!t.isNullOrUndefined(r)){var n=p.getPropertyType(e.uniqueFormatType,i);return r.characterFormat.uniqueCharacterFormat.propertiesHash.get(n)}},e.prototype.checkCharacterStyle=function(i){var r=this.baseCharStyle;if(!t.isNullOrUndefined(r))for(;!t.isNullOrUndefined(r)&&"Default Paragraph Font"!==r.name;){if(r.characterFormat.hasValue(i)){var n=p.getPropertyType(e.uniqueFormatType,i);return r.characterFormat.uniqueCharacterFormat.propertiesHash.get(n)}r=r.basedOn}},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueCharacterFormat))this.initializeUniqueCharacterFormat(i,r);else{var n=p.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,i);if(this.uniqueCharacterFormat.propertiesHash.containsKey(n)&&this.uniqueCharacterFormat.propertiesHash.get(n)===r)return;this.uniqueCharacterFormat=e.uniqueCharacterFormats.updateUniqueFormat(this.uniqueCharacterFormat,i,r)}},e.prototype.initializeUniqueCharacterFormat=function(t,i){var r=new c;this.addUniqueCharacterFormat("fontColor",t,i,r),this.addUniqueCharacterFormat("fontFamily",t,i,r),this.addUniqueCharacterFormat("fontSize",t,i,r),this.addUniqueCharacterFormat("bold",t,i,r),this.addUniqueCharacterFormat("italic",t,i,r),this.addUniqueCharacterFormat("underline",t,i,r),this.addUniqueCharacterFormat("strikethrough",t,i,r),this.addUniqueCharacterFormat("baselineAlignment",t,i,r),this.addUniqueCharacterFormat("highlightColor",t,i,r),this.addUniqueCharacterFormat("styleName",t,i,r),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueCharacterFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"bold":case"italic":t=!1;break;case"fontSize":t=11;break;case"underline":case"strikethrough":t="None";break;case"baselineAlignment":t="Normal";break;case"highlightColor":t="NoColor";break;case"fontColor":t="#000000";break;case"fontFamily":t="Calibri";break;case"styleName":t="Default Paragraph Font"}return t},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.fontFamily===e.fontFamily&&this.bold===e.bold&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.underline===e.underline&&this.fontColor===e.fontColor&&this.strikethrough===e.strikethrough&&this.highlightColor===e.highlightColor},e.prototype.isSameFormat=function(e){return this.baseCharStyle===e.baseCharStyle&&this.uniqueCharacterFormat===e.uniqueCharacterFormat},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.uniqueCharacterFormat=this.uniqueCharacterFormat,t.baseCharStyle=this.baseCharStyle,t},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueCharacterFormat)&&!t.isNullOrUndefined(this.uniqueCharacterFormat.propertiesHash)){var i=p.getPropertyType(this.uniqueCharacterFormat.uniqueFormatType,e);return this.uniqueCharacterFormat.propertiesHash.containsKey(i)}return!1},e.prototype.clearFormat=function(){t.isNullOrUndefined(this.uniqueCharacterFormat)||0!==this.uniqueCharacterFormat.referenceCount||e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0,this.baseCharStyle=void 0},e.prototype.destroy=function(){this.clearFormat()},e.prototype.copyFormat=function(e){t.isNullOrUndefined(e)||(!t.isNullOrUndefined(e.uniqueCharacterFormat)&&e.uniqueCharacterFormat.propertiesHash&&this.updateUniqueCharacterFormat(e),t.isNullOrUndefined(e.baseCharStyle)||(this.baseCharStyle=e.baseCharStyle))},e.prototype.updateUniqueCharacterFormat=function(i){var r=void 0;this.uniqueCharacterFormat&&(r=this.uniqueCharacterFormat.mergeProperties(i.uniqueCharacterFormat),0===this.uniqueCharacterFormat.referenceCount&&(e.uniqueCharacterFormats.remove(this.uniqueCharacterFormat),this.uniqueCharacterFormat=void 0)),this.uniqueCharacterFormat=new p(e.uniqueFormatType),t.isNullOrUndefined(r)&&(r=this.uniqueCharacterFormat.mergeProperties(i.uniqueCharacterFormat)),this.uniqueCharacterFormat=e.uniqueCharacterFormats.addUniqueFormat(r,e.uniqueFormatType)},e.clear=function(){this.uniqueCharacterFormats.clear()},e.prototype.ApplyStyle=function(e){this.baseCharStyle=e},e.prototype.getValue=function(e){return this.hasValue(e)?this.getPropertyValue(e):void 0},e.prototype.mergeFormat=function(e){t.isNullOrUndefined(this.getValue("bold"))&&(this.bold=e.getValue("bold")),t.isNullOrUndefined(this.getValue("italic"))&&(this.italic=e.getValue("italic")),t.isNullOrUndefined(this.getValue("fontSize"))&&(this.fontSize=e.getValue("fontSize")),t.isNullOrUndefined(this.getValue("fontFamily"))&&(this.fontFamily=e.getValue("fontFamily")),t.isNullOrUndefined(this.getValue("underline"))&&(this.underline=e.getValue("underline")),t.isNullOrUndefined(this.getValue("strikethrough"))&&(this.strikethrough=e.getValue("strikethrough")),t.isNullOrUndefined(this.getValue("baselineAlignment"))&&(this.baselineAlignment=e.getValue("baselineAlignment")),t.isNullOrUndefined(this.getValue("highlightColor"))&&(this.highlightColor=e.getValue("highlightColor")),t.isNullOrUndefined(this.getValue("fontColor"))&&(this.fontColor=e.getValue("fontColor"))},e.uniqueCharacterFormats=new g,e.uniqueFormatType=2,e}(),W=function(){function e(){}return e.insert=function(e,t,i){return t>=0?[e.slice(0,t)+i+e.slice(t)].join(""):i+this},e.remove=function(e,t,i){return 0===t?e.substring(t+1,e.length):e.substring(0,t)+e.substring(t+1,e.length)},e.indexOfAny=function(e,i){for(var r=void 0,n=0;n<i.length;n++){var o=e.indexOf(i[n]);-1!==o&&t.isNullOrUndefined(r)?r=o:-1!==o&&o<r&&(r=o)}return t.isNullOrUndefined(r)?-1:r},e.lastIndexOfAny=function(e,t){for(var i=e.length-1;i>=0;i--)for(var r=0;r<=t.length-1;r++)if(e[i]===t[r])return i;return-1},e.addCssStyle=function(e){var t=document.createElement("style");t.style.cssText?t.style.cssText=e:t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t)},e.getHighlightColorCode=function(e){var t="#ffffff";switch(e){case"Yellow":t="#ffff00";break;case"BrightGreen":t="#00ff00";break;case"Turquoise":t="#00ffff";break;case"Pink":t="#ff00ff";break;case"Blue":t="#0000ff";break;case"Red":t="#ff0000";break;case"DarkBlue":t="#000080";break;case"Teal":t="#008080";break;case"Green":t="#008000";break;case"Violet":t="#800080";break;case"DarkRed":t="#800000";break;case"DarkYellow":t="#808000";break;case"Gray50":t="#808080";break;case"Gray25":t="#c0c0c0";break;case"Black":t="#000000"}return t},e.convertPointToPixel=function(t){return e.round(96*t/72,5)},e.convertPixelToPoint=function(t){return e.round(72*t/96,5)},e.isLinkedFieldCharacter=function(e){return e instanceof $&&0===e.fieldType?!t.isNullOrUndefined(e.fieldEnd):e instanceof $&&2===e.fieldType?!t.isNullOrUndefined(e.fieldBegin)&&!t.isNullOrUndefined(e.fieldEnd):!t.isNullOrUndefined(e.fieldBegin)},e.removeSpace=function(e){if(!t.isNullOrUndefined(e)&&0!==e.length)for(var i=0;i<e.length;i++)" "===e.charAt(i)&&(e=e.replace(" ",""));return e},e.trimStart=function(e){var t=0;for(t;t<e.length&&" "===e[t];t++);return e.substring(t,e.length)},e.trimEnd=function(e){var t=e.length-1;for(t;t>=0&&" "===e[t];t--);return e.substring(0,t+1)},e.endsWith=function(e){return!t.isNullOrUndefined(e)&&0!==e.length&&" "===e[e.length-1]},e.writeCharacterFormat=function(e,i,r){e.bold=i?r.bold:r.getValue("bold"),e.italic=i?r.italic:r.getValue("italic"),e.fontSize=i?r.fontSize:r.getValue("fontSize"),e.fontFamily=i?r.fontFamily:r.getValue("fontFamily"),e.underline=i?r.underline:r.getValue("underline"),e.strikethrough=i?r.strikethrough:r.getValue("strikethrough"),e.baselineAlignment=i?r.baselineAlignment:r.getValue("baselineAlignment"),e.highlightColor=i?r.highlightColor:r.getValue("highlightColor"),e.fontColor=i?r.fontColor:r.getValue("fontColor"),e.styleName=t.isNullOrUndefined(r.baseCharStyle)?void 0:r.baseCharStyle.name},e.round=function(e,t){for(var i=e,r=0;r<t;r++)i*=10;i=Math.round(i);for(r=0;r<t;r++)i/=10;return i},e.wordBefore="\\b",e.wordAfter="\\b",e.wordSplitCharacters=[" ",",",".",":",";","<",">","=","+","-","_","{","}","[","]","`","~","!","@","#","$","%","^","&","*","(",")",'"',"?","/","|","\\","”"],e}(),T=function(){function e(e,t){this.xIn=0,this.yIn=0,this.xIn=e,this.yIn=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this.xIn},set:function(e){this.xIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.yIn},set:function(e){this.yIn=e},enumerable:!0,configurable:!0}),e.prototype.copy=function(e){this.xIn=e.xIn,this.yIn=e.yIn},e.prototype.destroy=function(){this.xIn=void 0,this.yIn=void 0},e}(),I=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),S=function(){function e(){}return e}(),N=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.paragraphFormat=new F(i),i.characterFormat=new P(i),i}return I(t,e),t.prototype.destroy=function(){this.characterFormat.destroy(),this.paragraphFormat.destroy()},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.link=e.link,this.characterFormat.copyFormat(e.characterFormat),this.paragraphFormat.copyFormat(e.paragraphFormat)},t}(S),O=function(e){function t(t){var i=e.call(this)||this;return i.ownerBase=t,i.characterFormat=new P(i),i}return I(t,e),t.prototype.destroy=function(){this.characterFormat.destroy()},t.prototype.copyStyle=function(e){this.name=e.name,this.ownerBase=e.ownerBase,this.type=e.type,this.next=e.next,this.basedOn=e.basedOn,this.characterFormat.copyFormat(e.characterFormat)},t}(S),L=function(){function e(){this.collection=[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.collection.length},enumerable:!0,configurable:!0}),e.prototype.remove=function(e){this.collection=this.collection.filter(function(t){return t.name!==e.name})},e.prototype.push=function(e){return null!=e&&void 0!==e&&this.collection.push(e),1},e.prototype.getItem=function(e){return this.collection.length>e?this.collection[e]:null},e.prototype.indexOf=function(e){return this.collection.indexOf(e)},e.prototype.contains=function(e){var t=this.collection.indexOf(e);return t>-1&&t<this.collection.length},e.prototype.clear=function(){for(;this.collection.length>0;)this.collection.pop()},e.prototype.findByName=function(e,i){for(var r,n=0,o=this.collection;n<o.length;n++){var a=o[n];a.name===e&&(r=a,t.isNullOrUndefined(i)||a.type!==i||(r=a))}return r},e.prototype.getStyleNames=function(e){return this.collection.filter(function(t){return t.type===e}).map(function(e){return e.name})},e.prototype.getStyles=function(e){for(var t=[],i=0,r=this.collection.filter(function(t){return t.type===e}).map(function(e){return e});i<r.length;i++){var n=r[i],o={},a={};a.characterFormat={},W.writeCharacterFormat(a.characterFormat,!0,n.characterFormat),o.name=n.name,o.style=JSON.stringify(a),t.push(o)}return t},e}(),k=function(){function e(e){this.uniqueBorderFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"color",{get:function(){return this.getPropertyValue("color")},set:function(e){this.setPropertyValue("color",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.getPropertyValue("lineStyle")},set:function(e){this.setPropertyValue("lineStyle",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineWidth",{get:function(){return this.getPropertyValue("lineWidth")},set:function(e){this.setPropertyValue("lineWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shadow",{get:function(){return this.getPropertyValue("shadow")},set:function(e){this.setPropertyValue("shadow",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"space",{get:function(){return this.getPropertyValue("space")},set:function(e){this.setPropertyValue("space",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasNoneStyle",{get:function(){return this.getPropertyValue("hasNoneStyle")},set:function(e){this.setPropertyValue("hasNoneStyle",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){var r=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueBorderFormat)&&this.uniqueBorderFormat.propertiesHash.containsKey(r))return this.uniqueBorderFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueBorderFormat))this.initializeUniqueBorder(i,r);else{var n=p.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,i);if(this.uniqueBorderFormat.propertiesHash.containsKey(n)&&this.uniqueBorderFormat.propertiesHash.get(n)===r)return;this.uniqueBorderFormat=e.uniqueBorderFormats.updateUniqueFormat(this.uniqueBorderFormat,i,r)}},e.prototype.initializeUniqueBorder=function(t,i){var r=new c;this.addUniqueBorderFormat("color",t,i,r),this.addUniqueBorderFormat("lineStyle",t,i,r),this.addUniqueBorderFormat("lineWidth",t,i,r),this.addUniqueBorderFormat("shadow",t,i,r),this.addUniqueBorderFormat("space",t,i,r),this.addUniqueBorderFormat("hasNoneStyle",t,i,r),this.uniqueBorderFormat=e.uniqueBorderFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueBorderFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"color":t="#000000";break;case"lineStyle":t="None";break;case"lineWidth":t=0;break;case"shadow":t=!1;break;case"space":t=0;break;case"hasNoneStyle":t=!1}return t},e.prototype.getLineWidth=function(){switch(this.lineStyle){case"None":case"Cleared":return 0;case"Triple":case"Double":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"Emboss3D":case"Engrave3D":for(var e=this.getBorderLineWidthArray(this.lineStyle,this.lineWidth),t=0,i=0;i<e.length;i++)t+=e[i];return t;case"Single":case"DashLargeGap":case"DashSmallGap":case"Dot":case"DashDot":case"DashDotDot":case"Thick":return this.lineWidth;case"SingleWavy":return 1.5===this.lineWidth?3:2.5;case"DoubleWavy":return 6.75;case"DashDotStroked":case"Outset":return this.lineWidth}return this.lineWidth},e.prototype.getBorderLineWidthArray=function(e,t){var i=[t];switch(e){case"Double":i=[1,1,1];break;case"ThinThickSmallGap":i=[1,-.75,-.75];break;case"ThickThinSmallGap":i=[-.75,-.75,1];break;case"ThinThickMediumGap":i=[1,.5,.5];break;case"ThickThinMediumGap":i=[.5,.5,1];break;case"ThinThickLargeGap":i=[-1.5,1,-.75];break;case"ThickThinLargeGap":i=[-.75,1,-1.5];break;case"Triple":i=[1,1,1,1,1];break;case"ThinThickThinSmallGap":i=[-.75,-.75,1,-.75,-.75];break;case"ThinThickThinMediumGap":i=[.5,.5,1,.5,.5];break;case"ThinThickThinLargeGap":i=[-.75,1,-1.5,1,-.75];break;case"Emboss3D":case"Engrave3D":i=[.25,0,1,0,.25]}if(1===i.length)return[t];for(var r=0;r<i.length;r++)i[r]>=0?i[r]=i[r]*t:i[r]=Math.abs(i[r]);return i},e.prototype.getBorderWeight=function(){var e=0,t=this.getNumberOfLines(),i=this.getBorderNumber();switch(this.lineStyle){case"Single":case"DashSmallGap":case"DashDot":case"DashDotDot":case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":case"SingleWavy":case"DoubleWavy":case"DashDotStroked":case"Emboss3D":case"Engrave3D":case"Outset":case"Inset":case"Thick":e=t*i;break;case"Dot":case"DashLargeGap":e=1}return e},e.prototype.getBorderNumber=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.getNumberOfLines=function(){var e=0;switch(this.lineStyle){case"Single":case"Dot":case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":e=1;break;case"Double":e=3;break;case"Triple":e=5;break;case"ThinThickSmallGap":case"ThickThinSmallGap":e=3;break;case"ThinThickThinSmallGap":e=5;break;case"ThinThickMediumGap":case"ThickThinMediumGap":e=3;break;case"ThinThickThinMediumGap":e=5;break;case"ThinThickLargeGap":case"ThickThinLargeGap":e=3;break;case"ThinThickThinLargeGap":e=5;break;case"SingleWavy":e=1;break;case"DoubleWavy":e=2;break;case"DashDotStroked":e=1;break;case"Emboss3D":case"Engrave3D":e=3;break;case"Outset":case"Inset":case"Thick":e=1}return e},e.prototype.getPrecedence=function(){var e=0;switch(this.lineStyle){case"Single":e=1;break;case"Thick":e=2;break;case"Double":e=3;break;case"Dot":e=4;break;case"DashLargeGap":e=5;break;case"DashDot":e=6;break;case"DashDotDot":e=7;break;case"Triple":e=8;break;case"ThinThickSmallGap":e=9;break;case"ThickThinSmallGap":e=10;break;case"ThinThickThinSmallGap":e=11;break;case"ThinThickMediumGap":e=12;break;case"ThickThinMediumGap":e=13;break;case"ThinThickThinMediumGap":e=14;break;case"ThinThickLargeGap":e=15;break;case"ThickThinLargeGap":e=16;break;case"ThinThickThinLargeGap":e=17;break;case"SingleWavy":e=18;break;case"DoubleWavy":e=19;break;case"DashSmallGap":e=20;break;case"DashDotStroked":e=21;break;case"Emboss3D":e=22;break;case"Engrave3D":e=23;break;case"Outset":e=24;break;case"Inset":e=25}return e},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueBorderFormat)){var i=p.getPropertyType(this.uniqueBorderFormat.uniqueFormatType,e);return this.uniqueBorderFormat.propertiesHash.containsKey(i)}return!1},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.color=this.color,t.lineStyle=this.lineStyle,t.lineWidth=this.lineWidth,t.shadow=this.shadow,t.space=this.space,t},e.prototype.destroy=function(){t.isNullOrUndefined(this.uniqueBorderFormat)||e.uniqueBorderFormats.remove(this.uniqueBorderFormat),this.uniqueBorderFormat=void 0},e.prototype.copyFormat=function(e){t.isNullOrUndefined(e)||t.isNullOrUndefined(e.uniqueBorderFormat)||(this.color=e.color,this.lineStyle=e.lineStyle,this.lineWidth=e.lineWidth,this.shadow=e.shadow,this.space=e.space)},e.clear=function(){this.uniqueBorderFormats.clear()},e.uniqueBorderFormats=new g,e.uniqueFormatType=1,e}(),B=function(){function e(e){this.leftIn=new k(this),this.rightIn=new k(this),this.topIn=new k(this),this.bottomIn=new k(this),this.horizontalIn=new k(this),this.verticalIn=new k(this),this.diagonalUpIn=new k(this),this.diagonalDownIn=new k(this),this.lineWidthIn=0,this.ownerBase=e}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.rightIn},set:function(e){this.rightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.topIn},set:function(e){this.topIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.bottomIn},set:function(e){this.bottomIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontal",{get:function(){return this.horizontalIn},set:function(e){this.horizontalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vertical",{get:function(){return this.verticalIn},set:function(e){this.verticalIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalUp",{get:function(){return this.diagonalUpIn},set:function(e){this.diagonalUpIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"diagonalDown",{get:function(){return this.diagonalDownIn},set:function(e){this.diagonalDownIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.isNullOrUndefined(this.left)||this.left.destroy(),t.isNullOrUndefined(this.top)||this.top.destroy(),t.isNullOrUndefined(this.bottom)||this.bottom.destroy(),t.isNullOrUndefined(this.right)||this.right.destroy(),t.isNullOrUndefined(this.horizontal)||this.horizontal.destroy(),t.isNullOrUndefined(this.vertical)||this.vertical.destroy(),t.isNullOrUndefined(this.diagonalDown)||this.diagonalDown.destroy(),t.isNullOrUndefined(this.diagonalUp)||this.diagonalUp.destroy(),this.topIn=void 0,this.bottomIn=void 0,this.leftIn=void 0,this.rightIn=void 0,this.horizontalIn=void 0,this.verticalIn=void 0,this.diagonalDownIn=void 0,this.diagonalUpIn=void 0,this.lineWidthIn=void 0,this.valueIn=void 0},e.prototype.cloneFormat=function(){var i=new e(void 0);return i.top=t.isNullOrUndefined(this.top)?void 0:this.top.cloneFormat(),i.bottom=t.isNullOrUndefined(this.bottom)?void 0:this.bottom.cloneFormat(),i.left=t.isNullOrUndefined(this.left)?void 0:this.left.cloneFormat(),i.right=t.isNullOrUndefined(this.right)?void 0:this.right.cloneFormat(),i.horizontal=t.isNullOrUndefined(this.horizontal)?void 0:this.horizontal.cloneFormat(),i.vertical=t.isNullOrUndefined(this.vertical)?void 0:this.vertical.cloneFormat(),i.diagonalUp=t.isNullOrUndefined(this.diagonalUp)?void 0:this.diagonalUp.cloneFormat(),i.diagonalDown=t.isNullOrUndefined(this.diagonalDown)?void 0:this.diagonalDown.cloneFormat(),i},e.prototype.copyFormat=function(e){!t.isNullOrUndefined(e.left)&&e.left instanceof k&&(this.left=new k(this),this.left.copyFormat(e.left)),!t.isNullOrUndefined(e.right)&&e.right instanceof k&&(this.right=new k(this),this.right.copyFormat(e.right)),!t.isNullOrUndefined(e.top)&&e.top instanceof k&&(this.top=new k(this),this.top.copyFormat(e.top)),!t.isNullOrUndefined(e.bottom)&&e.bottom instanceof k&&(this.bottom=new k(this),this.bottom.copyFormat(e.bottom)),!t.isNullOrUndefined(e.horizontal)&&e.horizontal instanceof k&&(this.horizontal=new k(this),this.horizontal.copyFormat(e.horizontal)),!t.isNullOrUndefined(e.vertical)&&e.vertical instanceof k&&(this.vertical=new k(this),this.vertical.copyFormat(e.vertical)),!t.isNullOrUndefined(e.diagonalDown)&&e.diagonalDown instanceof k&&(this.diagonalDown=new k(this),this.diagonalDown.copyFormat(e.diagonalDown)),!t.isNullOrUndefined(e.diagonalUp)&&e.diagonalUp instanceof k&&(this.diagonalUp=new k(this),this.diagonalUp.copyFormat(e.diagonalUp))},e}(),E=function(){function e(e){this.uniqueShadingFormat=void 0,this.ownerBase=void 0,this.ownerBase=e}return Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this.getPropertyValue("backgroundColor")},set:function(e){this.setPropertyValue("backgroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"foregroundColor",{get:function(){return this.getPropertyValue("foregroundColor")},set:function(e){this.setPropertyValue("foregroundColor",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textureStyle",{get:function(){return this.getPropertyValue("textureStyle")},set:function(e){this.setPropertyValue("textureStyle",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){var r=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueShadingFormat)&&this.uniqueShadingFormat.propertiesHash.containsKey(r))return this.uniqueShadingFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueShadingFormat))this.initializeUniqueShading(i,r);else{var n=p.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,i);if(this.uniqueShadingFormat.propertiesHash.containsKey(n)&&this.uniqueShadingFormat.propertiesHash.get(n)===r)return;this.uniqueShadingFormat=e.uniqueShadingFormats.updateUniqueFormat(this.uniqueShadingFormat,i,r)}},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"backgroundColor":t="#ffffff";break;case"foregroundColor":t="empty";break;case"textureStyle":t="TextureNone"}return t},e.prototype.initializeUniqueShading=function(t,i){var r=new c;this.addUniqueShading("backgroundColor",t,i,r),this.addUniqueShading("foregroundColor",t,i,r),this.addUniqueShading("textureStyle",t,i,r),this.uniqueShadingFormat=e.uniqueShadingFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueShading=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.prototype.destroy=function(){t.isNullOrUndefined(this.uniqueShadingFormat)||e.uniqueShadingFormats.remove(this.uniqueShadingFormat),this.uniqueShadingFormat=void 0},e.prototype.cloneFormat=function(){var t=new e(void 0);return t.backgroundColor=this.backgroundColor,t.foregroundColor=this.foregroundColor,t.textureStyle=this.textureStyle,t},e.prototype.copyFormat=function(e){t.isNullOrUndefined(e)||t.isNullOrUndefined(e.uniqueShadingFormat)||(this.backgroundColor=e.backgroundColor,this.foregroundColor=e.foregroundColor,this.textureStyle=e.textureStyle)},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueShadingFormat)){var i=p.getPropertyType(this.uniqueShadingFormat.uniqueFormatType,e);return this.uniqueShadingFormat.propertiesHash.containsKey(i)}return!1},e.clear=function(){this.uniqueShadingFormats.clear()},e.uniqueShadingFormats=new g,e.uniqueFormatType=5,e}(),R=function(){function e(e){this.uniqueTableFormat=void 0,this.borders=new B(this),this.shading=new E(this),this.ownerBase=void 0,this.ownerBase=e,this.assignTableMarginValue(5.4,0,5.4,0)}return Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.getPropertyValue("cellSpacing")},set:function(e){if(e<0||e>264.6)throw new RangeError("The measurement must be between 0 px and 264.6 px.");this.setPropertyValue("cellSpacing",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.getPropertyValue("leftIndent")},set:function(e){if(e<-1440||e>1440)throw new RangeError("The measurement must be between -1440 px and 1440 px.");this.setPropertyValue("leftIndent",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.getPropertyValue("tableAlignment")},set:function(e){this.setPropertyValue("tableAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){var r=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueTableFormat)&&this.uniqueTableFormat.propertiesHash.containsKey(r))return this.uniqueTableFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueTableFormat))this.initializeUniqueTableFormat(i,r);else{var n=p.getPropertyType(this.uniqueTableFormat.uniqueFormatType,i);if(this.uniqueTableFormat.propertiesHash.containsKey(n)&&this.uniqueTableFormat.propertiesHash.get(n)===r)return;this.uniqueTableFormat=e.uniqueTableFormats.updateUniqueFormat(this.uniqueTableFormat,i,r)}},e.prototype.initializeUniqueTableFormat=function(t,i){var r=new c;this.addUniqueTableFormat("cellSpacing",t,i,r),this.addUniqueTableFormat("leftMargin",t,i,r),this.addUniqueTableFormat("topMargin",t,i,r),this.addUniqueTableFormat("bottomMargin",t,i,r),this.addUniqueTableFormat("rightMargin",t,i,r),this.addUniqueTableFormat("leftIndent",t,i,r),this.addUniqueTableFormat("tableAlignment",t,i,r),this.addUniqueTableFormat("preferredWidth",t,i,r),this.addUniqueTableFormat("preferredWidthType",t,i,r),this.uniqueTableFormat=e.uniqueTableFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueTableFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"cellSpacing":t=0;break;case"leftMargin":t=5.4;break;case"topMargin":case"bottomMargin":t=0;break;case"rightMargin":t=5.4;break;case"leftIndent":t=0;break;case"tableAlignment":t="Left";break;case"preferredWidth":t=0;break;case"preferredWidthType":t="Point"}return t},e.prototype.assignTableMarginValue=function(e,t,i,r){this.leftMargin=e,this.topMargin=t,this.rightMargin=i,this.bottomMargin=r},e.prototype.initializeTableBorders=function(){this.borders.left.lineStyle="Single",this.borders.left.lineWidth=.5,this.borders.right.lineStyle="Single",this.borders.right.lineWidth=.5,this.borders.top.lineStyle="Single",this.borders.top.lineWidth=.5,this.borders.bottom.lineStyle="Single",this.borders.bottom.lineWidth=.5,this.borders.horizontal.lineStyle="Single",this.borders.horizontal.lineWidth=.5,this.borders.vertical.lineStyle="Single",this.borders.vertical.lineWidth=.5},e.prototype.destroy=function(){t.isNullOrUndefined(this.borders)||this.borders.destroy(),t.isNullOrUndefined(this.shading)||this.shading.destroy(),t.isNullOrUndefined(this.uniqueTableFormat)||e.uniqueTableFormats.remove(this.uniqueTableFormat),this.uniqueTableFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var i=new e(void 0);return i.leftIndent=this.leftIndent,i.tableAlignment=this.tableAlignment,i.cellSpacing=this.cellSpacing,i.leftMargin=this.leftMargin,i.rightMargin=this.rightMargin,i.topMargin=this.topMargin,i.bottomMargin=this.bottomMargin,i.preferredWidth=this.preferredWidth,i.preferredWidthType=this.preferredWidthType,i.borders=t.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),i.shading=t.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),i},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueTableFormat)){var i=p.getPropertyType(this.uniqueTableFormat.uniqueFormatType,e);return this.uniqueTableFormat.propertiesHash.containsKey(i)}return!1},e.prototype.copyFormat=function(e){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.uniqueTableFormat)||(this.cellSpacing=e.cellSpacing,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.leftIndent=e.leftIndent,this.tableAlignment=e.tableAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType),t.isNullOrUndefined(e.borders)||(this.borders=new B(this),this.borders.copyFormat(e.borders)),t.isNullOrUndefined(e.shading)||(this.shading=new E(this),this.shading.copyFormat(e.shading)))},e.clear=function(){this.uniqueTableFormats.clear()},e.uniqueTableFormats=new g,e.uniqueFormatType=8,e}(),M=function(){function e(e){this.uniqueRowFormat=void 0,this.borders=new B(this),this.ownerBase=void 0,this.beforeWidth=0,this.afterWidth=0,this.ownerBase=e}return Object.defineProperty(e.prototype,"gridBefore",{get:function(){return this.getPropertyValue("gridBefore")},set:function(e){this.setPropertyValue("gridBefore",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidth",{get:function(){return this.getPropertyValue("gridBeforeWidth")},set:function(e){this.setPropertyValue("gridBeforeWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridBeforeWidthType",{get:function(){return this.getPropertyValue("gridBeforeWidthType")},set:function(e){this.setPropertyValue("gridBeforeWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfter",{get:function(){return this.getPropertyValue("gridAfter")},set:function(e){this.setPropertyValue("gridAfter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidth",{get:function(){return this.getPropertyValue("gridAfterWidth")},set:function(e){this.setPropertyValue("gridAfterWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gridAfterWidthType",{get:function(){return this.getPropertyValue("gridAfterWidthType")},set:function(e){this.setPropertyValue("gridAfterWidthType",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.getPropertyValue("allowBreakAcrossPages")},set:function(e){this.setPropertyValue("allowBreakAcrossPages",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.getPropertyValue("isHeader")},set:function(e){this.setPropertyValue("isHeader",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getPropertyValue("height")},set:function(e){0!==e||"AtLeast"!==this.heightType&&"Exactly"!==this.heightType?"Auto"===this.heightType&&(e=0):e=1,this.setPropertyValue("height",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.getPropertyValue("heightType")},set:function(e){this.height="AtLeast"===e||"Exactly"===e?1:0,this.setPropertyValue("heightType",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){var r=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueRowFormat)&&this.uniqueRowFormat.propertiesHash.containsKey(r))return this.uniqueRowFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueRowFormat))this.initializeUniqueRowFormat(i,r);else{var n=p.getPropertyType(this.uniqueRowFormat.uniqueFormatType,i);if(this.uniqueRowFormat.propertiesHash.containsKey(n)&&this.uniqueRowFormat.propertiesHash.get(n)===r)return;this.uniqueRowFormat=e.uniqueRowFormats.updateUniqueFormat(this.uniqueRowFormat,i,r)}},e.prototype.initializeUniqueRowFormat=function(t,i){var r=new c;this.addUniqueRowFormat("allowBreakAcrossPages",t,i,r),this.addUniqueRowFormat("isHeader",t,i,r),this.addUniqueRowFormat("height",t,i,r),this.addUniqueRowFormat("heightType",t,i,r),this.addUniqueRowFormat("gridBefore",t,i,r),this.addUniqueRowFormat("gridBeforeWidth",t,i,r),this.addUniqueRowFormat("gridBeforeWidthType",t,i,r),this.addUniqueRowFormat("gridAfter",t,i,r),this.addUniqueRowFormat("gridAfterWidth",t,i,r),this.addUniqueRowFormat("gridgridAfterWidth",t,i,r),this.addUniqueRowFormat("gridBeforeWidthType",t,i,r),this.uniqueRowFormat=e.uniqueRowFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueRowFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"allowBreakAcrossPages":t=!0;break;case"isHeader":t=!1;break;case"height":t=0;break;case"heightType":t="Auto";break;case"gridBefore":case"gridBeforeWidth":t=0;break;case"gridBeforeWidthType":t="Point";break;case"gridAfter":case"gridAfterWidth":t=0;break;case"gridAfterWidthType":t="Point"}return t},e.prototype.cloneFormat=function(){var t=new e;return t.allowBreakAcrossPages=this.allowBreakAcrossPages,t.heightType=this.heightType,t.height=this.height,t.isHeader=this.isHeader,t.gridBefore=this.gridBefore,t.gridBeforeWidth=this.gridBeforeWidth,t.gridBeforeWidthType=this.gridBeforeWidthType,t.gridAfter=this.gridAfter,t.gridAfterWidth=this.gridAfterWidth,t.gridAfterWidthType=this.gridAfterWidthType,t},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueRowFormat)){var i=p.getPropertyType(this.uniqueRowFormat.uniqueFormatType,e);return this.uniqueRowFormat.propertiesHash.containsKey(i)}return!1},e.prototype.copyFormat=function(e){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.uniqueRowFormat)||(this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader,this.heightType=e.heightType,this.height=e.height,this.gridBefore=e.gridBefore,this.gridBeforeWidth=e.gridBeforeWidth,this.gridBeforeWidthType=e.gridBeforeWidthType,this.gridAfter=e.gridAfter,this.gridAfterWidth=e.gridAfterWidth,this.gridAfterWidthType=e.gridAfterWidthType),t.isNullOrUndefined(e.borders)||(this.borders=new B(this),this.borders.ownerBase=e,this.borders.copyFormat(e.borders)))},e.prototype.destroy=function(){t.isNullOrUndefined(this.borders)||this.borders.destroy(),t.isNullOrUndefined(this.uniqueRowFormat)||e.uniqueRowFormats.remove(this.uniqueRowFormat),this.beforeWidth=void 0,this.afterWidth=void 0,this.borders=void 0,this.uniqueRowFormat=void 0},e.clear=function(){this.uniqueRowFormats.clear()},e.uniqueRowFormats=new g,e.uniqueFormatType=6,e}(),H=function(){function e(e){this.uniqueCellFormat=void 0,this.borders=new B(this),this.shading=new E(this),this.ownerBase=e,this.borders=new B(this),this.shading=new E(this)}return Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.getPropertyValue("leftMargin")},set:function(e){this.setPropertyValue("leftMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.getPropertyValue("rightMargin")},set:function(e){this.setPropertyValue("rightMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.getPropertyValue("topMargin")},set:function(e){this.setPropertyValue("topMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.getPropertyValue("bottomMargin")},set:function(e){this.setPropertyValue("bottomMargin",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellWidth",{get:function(){return this.getPropertyValue("cellWidth")},set:function(e){this.setPropertyValue("cellWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnSpan",{get:function(){return this.getPropertyValue("columnSpan")},set:function(e){this.setPropertyValue("columnSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowSpan",{get:function(){return this.getPropertyValue("rowSpan")},set:function(e){this.setPropertyValue("rowSpan",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.getPropertyValue("preferredWidth")},set:function(e){this.setPropertyValue("preferredWidth",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.getPropertyValue("verticalAlignment")},set:function(e){this.setPropertyValue("verticalAlignment",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.getPropertyValue("preferredWidthType")},set:function(e){this.setPropertyValue("preferredWidthType",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){if(this.hasValue(i)){var r=p.getPropertyType(e.uniqueFormatType,i);if(!t.isNullOrUndefined(this.uniqueCellFormat)&&this.uniqueCellFormat.propertiesHash.containsKey(r))return this.uniqueCellFormat.propertiesHash.get(r)}return e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueCellFormat))this.initializeUniqueCellFormat(i,r);else{var n=p.getPropertyType(this.uniqueCellFormat.uniqueFormatType,i);if(this.uniqueCellFormat.propertiesHash.containsKey(n)&&this.uniqueCellFormat.propertiesHash.get(n)===r)return;this.uniqueCellFormat=e.uniqueCellFormats.updateUniqueFormat(this.uniqueCellFormat,i,r)}},e.prototype.initializeUniqueCellFormat=function(t,i){var r=new c;this.addUniqueCellFormat("leftMargin",t,i,r),this.addUniqueCellFormat("topMargin",t,i,r),this.addUniqueCellFormat("bottomMargin",t,i,r),this.addUniqueCellFormat("rightMargin",t,i,r),this.addUniqueCellFormat("cellWidth",t,i,r),this.addUniqueCellFormat("columnSpan",t,i,r),this.addUniqueCellFormat("rowSpan",t,i,r),this.addUniqueCellFormat("preferredWidth",t,i,r),this.addUniqueCellFormat("verticalAlignment",t,i,r),this.addUniqueCellFormat("preferredWidthType",t,i,r),this.uniqueCellFormat=e.uniqueCellFormats.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueCellFormat=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i&&n.add(o,r)},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"leftMargin":case"topMargin":case"bottomMargin":case"rightMargin":t=void 0;break;case"cellWidth":t=0;break;case"columnSpan":case"rowSpan":t=1;break;case"preferredWidth":t=0;break;case"verticalAlignment":t="Top";break;case"preferredWidthType":t="Point"}return t},e.prototype.containsMargins=function(){return!(t.isNullOrUndefined(this.leftMargin)&&t.isNullOrUndefined(this.rightMargin)&&t.isNullOrUndefined(this.bottomMargin)&&t.isNullOrUndefined(this.topMargin))},e.prototype.destroy=function(){t.isNullOrUndefined(this.borders)||this.borders.destroy(),t.isNullOrUndefined(this.shading)||this.shading.destroy(),t.isNullOrUndefined(this.uniqueCellFormat)||e.uniqueCellFormats.remove(this.uniqueCellFormat),this.uniqueCellFormat=void 0,this.borders=void 0,this.shading=void 0},e.prototype.cloneFormat=function(){var i=new e(void 0);return i.verticalAlignment=this.verticalAlignment,i.leftMargin=this.leftMargin,i.rightMargin=this.rightMargin,i.topMargin=this.topMargin,i.bottomMargin=this.bottomMargin,i.preferredWidth=this.preferredWidth,i.preferredWidthType=this.preferredWidthType,i.cellWidth=this.cellWidth,i.borders=t.isNullOrUndefined(this.borders)?void 0:this.borders.cloneFormat(),i.shading=t.isNullOrUndefined(this.shading)?void 0:this.shading.cloneFormat(),i},e.prototype.hasValue=function(e){if(!t.isNullOrUndefined(this.uniqueCellFormat)){var i=p.getPropertyType(this.uniqueCellFormat.uniqueFormatType,e);return this.uniqueCellFormat.propertiesHash.containsKey(i)}return!1},e.prototype.copyFormat=function(e){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.uniqueCellFormat)||(this.cellWidth=e.cellWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.preferredWidth=e.preferredWidth,this.columnSpan=e.columnSpan,this.rowSpan=e.rowSpan,this.preferredWidthType=e.preferredWidthType,this.verticalAlignment=e.verticalAlignment),t.isNullOrUndefined(e.shading)||(this.shading=new E(this),this.shading.copyFormat(e.shading)),t.isNullOrUndefined(e.borders)||(this.borders=new B(this),this.borders.copyFormat(e.borders)))},e.clear=function(){this.uniqueCellFormats.clear()},e.uniqueCellFormats=new g,e.uniqueFormatType=4,e}(),U=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),D=function(){function e(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r}return Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),e}(),A=function(){function e(e,t,i,r){this.left=e,this.top=t,this.right=i,this.bottom=r}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.destroy=function(){this.left=void 0,this.right=void 0,this.top=void 0,this.bottom=void 0},e}(),z=function(){function e(){this.childWidgets=[],this.x=0,this.y=0,this.width=0,this.height=0,this.index=0}return Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this instanceof V&&this.page?this.page.bodyWidgets.indexOf(this):this.containerWidget&&this.containerWidget.childWidgets?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.childWidgets.length>0?this.childWidgets[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastChild",{get:function(){if(this.childWidgets)return this.childWidgets.length>0?this.childWidgets[this.childWidgets.length-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousWidget",{get:function(){var e=this,t=this.indexInOwner;return e=e instanceof V?t>0?e.page.bodyWidgets[t-1]:void 0:t>0?e.containerWidget.childWidgets[t-1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextWidget",{get:function(){var e=this,t=this.indexInOwner;if(-1!==t)return e=e instanceof V?t<e.page.bodyWidgets.length-1?e.page.bodyWidgets[t+1]:void 0:t<e.containerWidget.childWidgets.length-1?e.containerWidget.childWidgets[t+1]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousRenderedWidget",{get:function(){var e=this,i=this.indexInOwner;if(!(i<0)){if(e instanceof V)if(i>0)e=e.page.bodyWidgets[i-1];else{var r=e.page.previousPage;e=r&&r.bodyWidgets.length>0?r.bodyWidgets[r.bodyWidgets.length-1]:void 0}else if(i>0)e=e.containerWidget.childWidgets[i-1];else{var n=void 0;for(e.containerWidget instanceof Y?n=e.containerWidget.getPreviousSplitWidget():e.containerWidget instanceof X||e.containerWidget instanceof q||(n=e.containerWidget.previousRenderedWidget);n&&0===n.childWidgets.length&&(n=n.previousRenderedWidget,!t.isNullOrUndefined(n)););e=n&&n.constructor===e.containerWidget.constructor?n.lastChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextRenderedWidget",{get:function(){var e=this,i=this.indexInOwner;if(!(i<0)){if(e instanceof V)if(i<e.page.bodyWidgets.length-1)e=e.page.bodyWidgets[i+1];else{var r=e.page.nextPage;e=r&&r.bodyWidgets.length>0?r.bodyWidgets[0]:void 0}else if(i<e.containerWidget.childWidgets.length-1)e=e.containerWidget.childWidgets[i+1];else{var n=void 0;for(e.containerWidget instanceof Y?n=e.containerWidget.getNextSplitWidget():e.containerWidget instanceof X||e.containerWidget instanceof q||(n=e.containerWidget.nextRenderedWidget);n&&0===n.childWidgets.length&&!(n instanceof Y)&&(n=n.nextRenderedWidget,!t.isNullOrUndefined(n)););e=n&&n.constructor===e.containerWidget.constructor?n.firstChild:void 0}return e}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousSplitWidget",{get:function(){var e=this;if(e instanceof Y)return e.getPreviousSplitWidget();var t=e.previousRenderedWidget;return e instanceof V&&t instanceof V&&e.equals(t)?t:t instanceof j&&e.index===t.index&&e.equals(t)?t:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextSplitWidget",{get:function(){var e=this;if(e instanceof Y)return e.getNextSplitWidget();var t=e.nextRenderedWidget;return e instanceof V&&t instanceof V&&e.equals(t)?t:t instanceof j&&e.index===t.index&&e.equals(t)?t:void 0},enumerable:!0,configurable:!0}),e.prototype.getPreviousSplitWidgets=function(){for(var e=[],t=this.previousSplitWidget;t;)e.unshift(t),t=t.previousSplitWidget;return e},e.prototype.getSplitWidgets=function(){for(var e=this.getPreviousSplitWidgets(),t=this;t;)e.push(t),t=t.nextSplitWidget;return e},e.prototype.combineWidget=function(e){var t=this,i=this.getSplitWidgets();if(i.length>1)for(t=i.shift();i.length>0;){var r=i.shift();t.combine(r,e)}return t instanceof K&&t.combineRows(e),t},e.prototype.combine=function(t,i){if(t.childWidgets.length>0){var r=this.lastChild;if(r instanceof K)r.combineWidget(i);else{var n=t.firstChild;!(t instanceof K)&&r instanceof e&&n instanceof e&&r.index===n.index&&r.combine(t.childWidgets.shift(),i)}this.addWidgets(t.childWidgets),t.childWidgets=[]}t.destroyInternal(i)},e.prototype.addWidgets=function(t){for(;t.length>0;){var i=t.shift();if(i instanceof J&&this instanceof G)i.paragraph=this,this.height+=i.height;else if(i instanceof e){var r=this.lastChild;i.containerWidget=this,i.y=r instanceof e?r.y+r.height:this.y,this.height+=i.height}this.childWidgets.push(i)}},e.prototype.removeChild=function(e){e>-1&&e<this.childWidgets.length&&this.childWidgets.splice(e,1)},e.prototype.destroy=function(){if(this.childWidgets)for(;this.childWidgets.length>0;){var t=this.childWidgets.pop();(t instanceof J||t instanceof e)&&t.destroy()}this.childWidgets=void 0,this.containerWidget&&this.containerWidget.removeChild(this.indexInOwner),this.containerWidget=void 0,this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.index=void 0},e}(),_=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.sectionFormatIn=void 0,t}return U(i,e),Object.defineProperty(i.prototype,"sectionFormat",{get:function(){var e=this;return e instanceof V?e.sectionFormatIn:e.page?e.page.bodyWidgets[0].sectionFormat:void 0},set:function(e){this instanceof V&&(this.sectionFormatIn=e)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sectionIndex",{get:function(){var e=this,t=0;return e instanceof V?t=e.index:e.page&&(t=e.page.bodyWidgets[0].index),t},enumerable:!0,configurable:!0}),i.prototype.getHierarchicalIndex=function(e){var i=this;return e=i instanceof V?i.index+";"+e:-1!==i.headerFooterType.indexOf("Header")?"H;"+e:"F;"+e,t.isNullOrUndefined(i.page)?e:this.page.viewer.pages.indexOf(this.page)+";"+e},i}(z),V=function(e){function i(){return e.call(this)||this}return U(i,e),i.prototype.equals=function(e){return e instanceof i&&e.sectionFormat===this.sectionFormat},i.prototype.getHierarchicalIndex=function(e){var i=this;return e=i.index+";"+e,t.isNullOrUndefined(i.page)?e:this.page.viewer.pages.indexOf(this.page)+";"+e},i.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=e.y&&this.childWidgets[t].y+this.childWidgets[t].height>=e.y)return this.childWidgets[t].getTableCellWidget(e);var i=void 0;return this.childWidgets.length>0&&(i=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),i},i.prototype.destroyInternal=function(e){this.height;if(!t.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];if(r.destroyInternal(e),t.isNullOrUndefined(this.childWidgets))break;i--}this.childWidgets=void 0}if(!t.isNullOrUndefined(this.page)){var n=this.indexInOwner;this.indexInOwner>-1&&(this.page.bodyWidgets.splice(n,1),0===this.page.bodyWidgets.length?this.page.destroy():this instanceof q&&this.page.headerWidget===this?this.page.headerWidget=void 0:this instanceof q&&this.page.footerWidget===this&&(this.page.footerWidget=void 0),this.page=void 0)}this.destroy()},i.prototype.destroy=function(){this.sectionFormat=void 0,this.page=void 0,e.prototype.destroy.call(this)},i}(_),q=function(e){function t(t){var i=e.call(this)||this;return i.headerFooterType=t,i}return U(t,e),t.prototype.getTableCellWidget=function(e){},t.prototype.equals=function(e){return e instanceof t&&e.containerWidget===this.containerWidget},t.prototype.clone=function(){for(var e=new t(this.headerFooterType),i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i].clone();e.childWidgets.push(r),r.index=i,r.containerWidget=e}return e.x=this.x,e.y=this.y,e.height=0,e.width=0,e},t.prototype.destroyInternal=function(t){this.page=void 0,e.prototype.destroy.call(this)},t}(_),j=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return U(i,e),Object.defineProperty(i.prototype,"bodyWidget",{get:function(){for(var e=this;e.containerWidget;){if(e.containerWidget instanceof _)return e.containerWidget;e=e.containerWidget}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"leftIndent",{get:function(){var e=this;return e instanceof G&&e.paragraphFormat instanceof F?e.paragraphFormat.leftIndent:e instanceof K&&e.tableFormat instanceof R?e.tableFormat.leftIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rightIndent",{get:function(){var e=this;return e instanceof G&&e.paragraphFormat instanceof F?e.paragraphFormat.rightIndent:0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInsideTable",{get:function(){return this.containerWidget instanceof Y},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isInHeaderFooter",{get:function(){return this.bodyWidget instanceof q},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"associatedCell",{get:function(){if(this.containerWidget instanceof Y)return this.containerWidget},enumerable:!0,configurable:!0}),i.prototype.isPageBreak=function(){var e=!1;if(this instanceof G){var t=this;null!=t&&1===t.childWidgets.length&&1===t.firstChild.children.length&&(e=t.firstChild.children[0].isPageBreak)}return e},i.prototype.getHierarchicalIndex=function(e){var r=this;if(e=r.containerWidget.childWidgets.indexOf(r)+";"+e,!t.isNullOrUndefined(r.containerWidget)){if(r.containerWidget instanceof i)return r.containerWidget.getHierarchicalIndex(e);r.containerWidget instanceof _&&(e=r.containerWidget.getHierarchicalIndex(e))}return e},i.prototype.getIndex=function(){return this instanceof G||this instanceof K?this.containerWidget.childWidgets.indexOf(this):this instanceof X?this.ownerTable.childWidgets.indexOf(this):this instanceof Y?this.ownerRow.childWidgets.indexOf(this):0},i.prototype.getContainerWidth=function(){if(this.isInsideTable)return this.associatedCell.cellFormat.cellWidth-(this.associatedCell.margin.left+this.associatedCell.margin.right);var e=this.bodyWidget.sectionFormat;return e.pageWidth-(e.leftMargin+e.rightMargin)},i}(z),G=function(e){function i(){var t=e.call(this)||this;return t.paragraphFormat=new F(t),t.characterFormat=new P(t),t}return U(i,e),Object.defineProperty(i.prototype,"isEndsWithPageBreak",{get:function(){return this.childWidgets.length>0&&this.lastChild.isEndsWithPageBreak},enumerable:!0,configurable:!0}),i.prototype.equals=function(e){return e instanceof i&&e.paragraphFormat===this.paragraphFormat},i.prototype.isEmpty=function(){if(t.isNullOrUndefined(this.childWidgets)||0===this.childWidgets.length)return!0;for(var e=0;e<this.childWidgets.length;e++)for(var i=this.childWidgets[e],r=0;r<i.children.length;r++){var n=i.children[r];if(0!==n.length&&(n instanceof Q||n instanceof re||n instanceof ie||n instanceof $&&W.isLinkedFieldCharacter(n)))return!1}return!0},i.prototype.getInline=function(e,i){for(var r=void 0,n=0,o=!1,a=this.getSplitWidgets(),s=0;s<a.length;s++)for(var l=a[s],d=0;d<l.childWidgets.length;d++)for(var h=l.childWidgets[d],c=0;c<h.children.length;c++)if(!((r=h.children[c])instanceof ne)){if(!o&&(r instanceof Q||r instanceof re||r instanceof ie||r instanceof $&&W.isLinkedFieldCharacter(r))&&(o=!0),o&&e<=n+r.length)return i=e-n,{element:r,index:i};n+=r.length}return e>n&&(i=t.isNullOrUndefined(r)?e:r.length),{element:r,index:i}},i.prototype.getLength=function(){for(var e=0,t=0;t<this.childWidgets.length;t++)for(var i=this.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];n instanceof ne||(e+=n.length)}return e},i.prototype.getTableCellWidget=function(e){},i.prototype.clone=function(){var e=new i;e.paragraphFormat.copyFormat(this.paragraphFormat),e.characterFormat.copyFormat(this.characterFormat);for(var t=0;t<this.childWidgets.length;t++){var r=this.childWidgets[t].clone();e.childWidgets.push(r),r.paragraph=e}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e},i.prototype.destroyInternal=function(e){var i=this.height;if(!t.isNullOrUndefined(this.childWidgets)){for(var r=0;r<this.childWidgets.length&&(this.childWidgets[r].destroy(),1===this.childWidgets.length&&t.isNullOrUndefined(this.childWidgets[0].children)&&(this.childWidgets=void 0),!t.isNullOrUndefined(this.childWidgets));r++)r--;this.childWidgets=void 0}t.isNullOrUndefined(this.containerWidget)||t.isNullOrUndefined(this.containerWidget.childWidgets)||-1===this.containerWidget.childWidgets.indexOf(this)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=i,this.containerWidget=void 0),this.destroy()},i.prototype.destroy=function(){this.paragraphFormat=void 0,this.characterFormat=void 0,e.prototype.destroy.call(this)},i}(j),K=function(e){function i(){var t=e.call(this)||this;return t.flags=0,t.leftMargin=0,t.topMargin=0,t.rightMargin=0,t.bottomMargin=0,t.margin=new A(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.topBorderWidth=0,t.bottomBorderWidth=0,t.tableFormat=new R(t),t.tableHolder=new ae,t.spannedRowCollection=new c,t}return U(i,e),Object.defineProperty(i.prototype,"isGridUpdated",{get:function(){return(4&this.flags)>>2!=0},set:function(e){this.flags=251&this.flags|(e?1:0)<<2},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"continueHeader",{get:function(){return(2&this.flags)>>1!=0},set:function(e){this.flags=253&this.flags|(e?1:0)<<1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"header",{get:function(){return 0!=(1&this.flags)},set:function(e){this.flags=254&this.flags|(e?1:0)},enumerable:!0,configurable:!0}),i.prototype.equals=function(e){return e instanceof i&&e.tableFormat===this.tableFormat},i.prototype.combineRows=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];0===i.childWidgets.length?(i.destroy(),t--):i.combineCells(e)}},i.prototype.contains=function(e){if(this.equals(e.ownerTable))return!0;for(;e.ownerTable.isInsideTable;){if(this.equals(e.ownerTable))return!0;e=e.ownerTable.associatedCell}return this.equals(e.ownerTable)},i.prototype.getOwnerWidth=function(e){var t=this.getContainerWidth();return t=t-this.leftIndent-this.rightIndent,t>=0?t:0},i.prototype.getTableWidth=function(){for(var e=0,t=0;t<this.childWidgets.length;t++){for(var i=0,r=this.childWidgets[t],n=0;n<r.childWidgets.length;n++)i+=r.childWidgets[n].cellFormat.cellWidth;e<i&&(e=i)}return e},i.prototype.getTableClientWidth=function(e){var t=e;return"Point"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?t=this.tableFormat.preferredWidth:"Percent"===this.tableFormat.preferredWidthType&&this.tableFormat.preferredWidth>0?t=t*this.tableFormat.preferredWidth/100:(this.tableFormat.preferredWidthType="Point",this.tableFormat.preferredWidth=t),t},i.prototype.getCellWidth=function(e,i,r,n){var o=e;return"Percent"===i?o=e*r/100:"Point"===i?o=e:t.isNullOrUndefined(n)||(o=n.getMinimumPreferredWidth()),o},i.prototype.fitCellsToClientArea=function(e){for(var t=e/this.getTableWidth(),i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];r.rowFormat.gridAfterWidth*=t,r.rowFormat.gridBeforeWidth*=t;for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n].cellFormat.cellWidth*=t}},i.prototype.getTableCellWidget=function(e){for(var t=void 0,i=0;i<this.childWidgets.length;i++)if(this.childWidgets[i].y<=e.y&&this.childWidgets[i].y+this.childWidgets[i].height>=e.y){t=this.childWidgets[i].getTableCellWidget(e);break}return t},i.prototype.calculateGrid=function(){var e=[],t=[],i=this.getOwnerWidth(!0),r=this.getTableClientWidth(i);this.tableCellInfo=new c;for(var n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n],a=new c,s=o.rowFormat,l=o.rowFormat.gridBefore,d=0;e.indexOf(d)<0&&e.push(d),d+=this.getCellWidth(s.gridBeforeWidth,s.gridBeforeWidthType,r,null);var h=Math.round(d);e.indexOf(h)<0&&e.push(h);for(var p=0;p<o.childWidgets.length;p++){for(var g=o.childWidgets[p],u=0;u<t.length;u++)if(!(t[u].columnIndex<l)){var f=t[u].cellFormat.rowSpan,m=!0;t[u].columnIndex>l?(m=!1,p===o.childWidgets.length-1&&o.rowFormat.gridAfter>0&&(d+=this.getCellWidth(t[u].cellFormat.preferredWidth,t[u].cellFormat.preferredWidthType,r,null))):(d+=this.getCellWidth(t[u].cellFormat.preferredWidth,t[u].cellFormat.preferredWidthType,r,null),l=t[u].columnIndex+t[u].cellFormat.columnSpan),m||p!==o.childWidgets.length-1||(m=!0),m&&n-t[u].ownerRow.rowIndex==f-1&&(t.splice(u,1),u--)}if(g.cellFormat.rowSpan>1)if(0===t.length||t[t.length-1].columnIndex<=l)t.push(g);else for(var v=t.length;v>0;v--)t[v-1].columnIndex>l&&t.splice(v-1,0,g);a.containsKey(g.cellIndex)||a.add(g.cellIndex,Math.round(d-h)),l+=g.cellFormat.columnSpan,d+=this.getCellWidth(g.cellFormat.preferredWidth,g.cellFormat.preferredWidthType,r,null);var y=Math.round(d);e.indexOf(y)<0&&e.push(y),p===o.childWidgets.length-1&&s.gridAfter>0&&(d+=this.getCellWidth(s.gridAfterWidth,"Point",r,null),e.indexOf(Math.round(d))<0&&e.push(Math.round(d)),l+=s.gridAfter),this.tableCellInfo.containsKey(o.rowIndex)||this.tableCellInfo.add(o.rowIndex,a)}}e.sort(function(e,t){return e-t}),e.length-1!==this.tableHolder.columns.length&&this.updateColumnSpans(e,r),this.tableCellInfo.clear(),this.tableCellInfo=void 0},i.prototype.updateColumnSpans=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];r.rowFormat.gridBeforeWidth>=0&&(r.rowFormat.gridBefore=r.getGridCount(e,void 0,-1,t));for(var n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n],a=r.getGridCount(e,o,o.getIndex(),t);a>0&&o.cellFormat.columnSpan!==a&&(o.cellFormat.columnSpan=a)}r.rowFormat.gridAfterWidth>=0&&(r.rowFormat.gridAfter=r.getGridCount(e,void 0,r.childWidgets.length,t))}},i.prototype.buildTableColumns=function(){if(!this.isGridUpdated){this.tableHolder.resetColumns();var e=0,t=0,i=[],r="Auto"===this.tableFormat.preferredWidthType;e=this.getOwnerWidth(!0),t=this.getTableClientWidth(e);for(var n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n],a=o.rowFormat,s=0,l=0,d=0;a.gridBefore>0&&(l=this.getCellWidth(a.gridBeforeWidth,o.rowFormat.gridAfterWidthType,t,null),this.tableHolder.addColumns(s,s=a.gridBefore,l,l,d=l));for(var h=0;h<o.childWidgets.length;h++){var c=o.childWidgets[h];0===i.length&&(c.columnIndex=s);for(var p=0;p<i.length;p++){var g=i[p];if(g.columnIndex<s)c.columnIndex=s;else{var u=1,f=!0;if(u=g.cellFormat.rowSpan,g.columnIndex>s)c.columnIndex=s,f=!1;else{l=this.getCellWidth(g.cellFormat.preferredWidth,g.cellFormat.preferredWidthType,t,g);var m=g.getMinimumPreferredWidth();this.tableHolder.columns.length>0?(this.tableHolder.addColumns(s,s=this.tableHolder.columns.indexOf(g.ownerColumn)+g.cellFormat.columnSpan,l,m,d+=l),c.columnIndex=s):(this.tableHolder.addColumns(s,s=g.columnIndex+g.cellFormat.columnSpan,l,m,d+=l),c.columnIndex=s)}f||h!==o.childWidgets.length-1||(f=!0),f&&n-g.ownerRow.rowIndex==u-1&&(i.splice(p,1),p--)}}if(c.cellFormat.rowSpan>1)if(0===i.length||i[i.length-1].columnIndex<=s)i.push(c);else for(var v=i.length;v>0;v--)i[v-1].columnIndex>s&&i.splice(v-1,0,c);l=this.getCellWidth(c.cellFormat.preferredWidth,c.cellFormat.preferredWidthType,t,c);var y=c.getMinimumPreferredWidth();this.tableHolder.addColumns(s,s+=c.cellFormat.columnSpan,l,y,d+=l),h===o.childWidgets.length-1&&a.gridAfterWidth>0&&(l=this.getCellWidth(a.gridAfterWidth,"Point",t,null),this.tableHolder.addColumns(s,s+=a.gridAfter,l,l,d+=l))}}this.tableHolder.validateColumnWidths(),this.tableHolder.fitColumns(e,t,r),this.setWidthToCells(t,r)}},i.prototype.setWidthToCells=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i],n=r.rowFormat;n.gridBefore>0&&(n.beforeWidth=this.tableHolder.getCellWidth(0,n.gridBefore,e,t));for(var o=0;o<r.childWidgets.length;o++){var a=r.childWidgets[o];a.cellFormat.cellWidth=this.tableHolder.getCellWidth(a.columnIndex,a.cellFormat.columnSpan,e,t),"Percent"!==a.cellFormat.preferredWidthType&&(a.cellFormat.preferredWidth=a.cellFormat.cellWidth,a.cellFormat.preferredWidthType="Point")}n.gridAfter>0&&(n.afterWidth=this.tableHolder.getCellWidth(0,n.gridAfter,e,t))}},i.prototype.getMaxRowWidth=function(e){for(var t=0,i=0;i<this.childWidgets.length;i++){for(var r=this.childWidgets[i],n=0,o=0;o<r.childWidgets.length;o++){var a=r.childWidgets[o];n+=this.getCellWidth(a.cellFormat.preferredWidth,a.cellFormat.preferredWidthType,e,a)}t<n&&(t=n)}return t},i.prototype.updateWidth=function(e){var t=this.tableHolder.getTotalWidth(),i=this.getTableClientWidth(this.getOwnerWidth(!0));i<=t&&"Auto"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidthType="Point"),"Auto"!==this.tableFormat.preferredWidthType&&"Point"===this.tableFormat.preferredWidthType&&(this.tableFormat.preferredWidth=this.getMaxRowWidth(i))},i.prototype.convertPointToPercent=function(e,t){var i=0;return i=e/t*100,i=Math.round(i),i<100?i:100},i.prototype.clone=function(){var e=new i;e.tableHolder=this.tableHolder.clone(),e.tableFormat.copyFormat(this.tableFormat);for(var t=0;t<this.childWidgets.length;t++){var r=this.childWidgets[t].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=t}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e.containerWidget=this.containerWidget,e},i.getTableOf=function(e){if(e instanceof B){var r=X.getRowOf(e);return t.isNullOrUndefined(r)?e.ownerBase instanceof R&&e.ownerBase.ownerBase instanceof i?e.ownerBase.ownerBase:void 0:r.ownerTable}},i.prototype.fitChildToClientArea=function(){var e=this.getContainerWidth();Math.round(e)<Math.round(this.getTableWidth())&&this.fitCellsToClientArea(e);for(var t=0;t<this.childWidgets.length;t++)for(var r=this.childWidgets[t],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],a=0;a<o.childWidgets.length;a++)o.childWidgets[a]instanceof i&&o.childWidgets[a].fitChildToClientArea()},i.prototype.getColumnCellsForSelection=function(e,t){for(var i=[],r=e.columnIndex,n=t.columnIndex+t.cellFormat.columnSpan,o=0;o<this.childWidgets.length;o++)for(var a=this.childWidgets[o],s=0;s<a.childWidgets.length;s++){var l=a.childWidgets[s],d=l.columnIndex,h=l.cellFormat.columnSpan;d+h>r&&d+h<n||d>r&&d<n?i.indexOf(l)<0&&i.push(l):d>r&&d<n&&d+h<n||d<r&&d+h>n?i.indexOf(l)<0&&i.push(l):d!==r&&d+h!==n||i.indexOf(l)<0&&i.push(l)}return i},i.prototype.splitWidthToTableCells=function(e){for(var t=0;t<this.childWidgets.length;t++)this.childWidgets[t].splitWidthToRowCells(e)},i.prototype.insertTableRowsInternal=function(e,t){for(var i=0;i<e.length;i++){var r=e.splice(i,1)[0];r.containerWidget=this,this.childWidgets.splice(t,0,r),i--}this.updateRowIndex(t),this.isGridUpdated=!1,this.buildTableColumns(),this.isGridUpdated=!0},i.prototype.updateRowIndex=function(e){for(var t=e;t<this.childWidgets.length;t++){var i=this.childWidgets[t];i.index=t;for(var r=0;r<i.childWidgets.length;r++)i.childWidgets[r].index=r,i.childWidgets[r].rowIndex=i.rowIndex;e++}},i.prototype.getCellStartOffset=function(e){var t=0;if(e&&this.tableCellInfo&&this.tableCellInfo.containsKey(e.ownerRow.rowIndex)){var i=this.tableCellInfo.get(e.ownerRow.rowIndex);i.containsKey(e.cellIndex)&&(t=i.get(e.cellIndex))}return t},i.prototype.destroyInternal=function(e){var i=this.height;if(!t.isNullOrUndefined(this.childWidgets)){for(var r=0;r<this.childWidgets.length;r++){var n=void 0;if(n=this.childWidgets[r],t.isNullOrUndefined(n)||n.destroyInternal(e),t.isNullOrUndefined(this.childWidgets))break;r--}this.childWidgets=void 0}t.isNullOrUndefined(this.containerWidget)||(t.isNullOrUndefined(this.containerWidget.childWidgets)||(-1!==this.containerWidget.childWidgets.indexOf(this)&&this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),this.containerWidget.height-=i),this.containerWidget=void 0),this.destroy()},i.prototype.destroy=function(){this.tableFormat=void 0,this.spannedRowCollection=void 0,this.tableGrids=[],this.tableGrids=void 0,this.tableHolder=void 0,this.flags=void 0,this.leftMargin=void 0,this.topMargin=void 0,this.rightMargin=void 0,this.bottomMargin=void 0,this.headerHeight=void 0,this.description=void 0,this.title=void 0,e.prototype.destroy.call(this)},i}(j),X=function(e){function i(){var t=e.call(this)||this;return t.spannedRowCollection=[],t.topBorderWidth=0,t.bottomBorderWidth=0,t.rowFormat=new M(t),t}return U(i,e),Object.defineProperty(i.prototype,"rowIndex",{get:function(){return this.containerWidget?this.containerWidget.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof K)return this.containerWidget},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"nextRow",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.ownerTable.childWidgets.length-1)return this.ownerTable.childWidgets[e+1]},enumerable:!0,configurable:!0}),i.prototype.equals=function(e){return e instanceof i&&e.rowFormat===this.rowFormat},i.prototype.combineCells=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=this.childWidgets[t];if(i.combineWidget(e),1===i.cellFormat.rowSpan){i.height,i.margin.top,i.margin.bottom;this.height-this.ownerTable.tableFormat.cellSpacing<i.height&&(this.height=this.ownerTable.tableFormat.cellSpacing+i.height)}}},i.getRowOf=function(e){if(e instanceof B){var r=Y.getCellOf(e);return t.isNullOrUndefined(r)?e.ownerBase instanceof M&&e.ownerBase.ownerBase instanceof i?e.ownerBase.ownerBase:void 0:r.ownerRow}},i.prototype.getCell=function(e,t){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];if(r.rowIndex===e&&r.index===t)return r}},i.prototype.splitWidthToRowCells=function(e){for(var t=this.childWidgets,i=e/t.length,r=0;r<t.length;r++)t[r].cellFormat.preferredWidth=i},i.prototype.getGridCount=function(e,t,i,r){var n=0,o=0,a=this.ownerTable,s=this.rowFormat;-1===i?o=a.getCellWidth(s.gridBeforeWidth,s.gridBeforeWidthType,r,null):(n+=a.getCellWidth(s.gridBeforeWidth,s.gridBeforeWidthType,r,null),i>=0&&(n+=a.getCellStartOffset(t)),o=i<this.childWidgets.length?a.getCellWidth(t.cellFormat.preferredWidth,t.cellFormat.preferredWidthType,r,null):a.getCellWidth(s.gridAfterWidth,s.gridAfterWidthType,r,null));var l=this.getOffsetIndex(e,n);return this.getOffsetIndex(e,n+o)-l},i.prototype.getOffsetIndex=function(e,t){t=Math.round(t);var i=0;if(e.indexOf(t)>=0)i=e.indexOf(t);else{for(var r=0;r<e.length;r++)if(e[r]>t)return r;i=e.length-1}return i},i.prototype.getCellOffset=function(e,t){for(var i=0,r=this.ownerTable,n=0;n<this.childWidgets.length;n++){var o=this.childWidgets[n].cellFormat;if(n===e)break;i+=r.getCellWidth(o.preferredWidth,o.preferredWidthType,t,null)}return i},i.prototype.updateRowBySpannedCells=function(){for(var e=this.getPreviousRowSpannedCells(),t=this.rowIndex,i=0;i<e.length;i++){var r=e[i];r.ownerRow.rowIndex+r.cellFormat.rowSpan-1>=t&&(r.cellFormat.rowSpan-=1)}},i.prototype.getPreviousRowSpannedCells=function(e){for(var i=[],r=e?this:this.previousWidget;!t.isNullOrUndefined(r);){for(var n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n];o.cellFormat.rowSpan>1&&i.splice(0,0,o)}r=r.previousWidget}return i},i.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++){var i=Math.round(this.childWidgets[t].x);if(i-this.childWidgets[t].margin.left-1<=e.x&&i+this.childWidgets[t].width>=e.x)return this.childWidgets[t];if(t===this.childWidgets.length-1&&this.childWidgets[t].x+this.childWidgets[t].width+1<=e.x)return this.childWidgets[t]}var r=void 0;return this.childWidgets.length>0&&(r=this.childWidgets[0].x<=e.x?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),r},i.prototype.destroyInternal=function(e){var i=this.height;if(!t.isNullOrUndefined(this.childWidgets)){for(var r=0;r<this.childWidgets.length&&(this.childWidgets[r].destroyInternal(e),!t.isNullOrUndefined(this.childWidgets));r++)r--;this.childWidgets=void 0}t.isNullOrUndefined(this.containerWidget)||t.isNullOrUndefined(this.containerWidget.childWidgets)||(this.containerWidget.childWidgets.splice(this.containerWidget.childWidgets.indexOf(this),1),(t.isNullOrUndefined(this.containerWidget.childWidgets)||0===this.containerWidget.childWidgets.length)&&this.containerWidget instanceof K?this.containerWidget.destroyInternal(e):this.containerWidget.containerWidget instanceof V&&(this.containerWidget.containerWidget.height-=i),this.containerWidget.height-=i),this.destroy()},i.prototype.clone=function(){var e=new i;e.rowFormat.copyFormat(this.rowFormat),e.topBorderWidth=this.topBorderWidth,e.bottomBorderWidth=this.bottomBorderWidth;for(var t=0;t<this.childWidgets.length;t++){var r=this.childWidgets[t].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=t,r.rowIndex=this.rowIndex}return e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e},i.prototype.destroy=function(){this.rowFormat=void 0,this.rowFormat=void 0,this.spannedRowCollection=[],this.spannedRowCollection=void 0,this.topBorderWidth=void 0,this.bottomBorderWidth=void 0,e.prototype.destroy.call(this)},i}(j),Y=function(e){function i(){var t=e.call(this)||this;return t.rowIndex=-1,t.margin=new A(t.leftMargin,t.topMargin,t.rightMargin,t.bottomMargin),t.leftBorderWidth=0,t.rightBorderWidth=0,t.cellFormat=new H(t),t}return U(i,e),Object.defineProperty(i.prototype,"ownerColumn",{get:function(){return this.ownerTable.tableHolder.columns[this.columnIndex]},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"leftMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.leftMargin:t.isNullOrUndefined(this.ownerTable)||t.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.leftMargin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.topMargin:t.isNullOrUndefined(this.ownerTable)||t.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.topMargin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rightMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.rightMargin:t.isNullOrUndefined(this.ownerTable)||t.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.rightMargin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomMargin",{get:function(){return this.cellFormat&&this.cellFormat.containsMargins()?this.cellFormat.bottomMargin:t.isNullOrUndefined(this.ownerTable)||t.isNullOrUndefined(this.ownerTable.tableFormat)?0:this.ownerTable.tableFormat.bottomMargin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cellIndex",{get:function(){return this.ownerRow?this.ownerRow.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ownerTable",{get:function(){if(this.containerWidget instanceof X)return this.containerWidget.ownerTable},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ownerRow",{get:function(){return this.containerWidget},enumerable:!0,configurable:!0}),i.prototype.equals=function(e){return e instanceof i&&e.cellFormat===this.cellFormat},i.prototype.getContainerTable=function(){for(var e=this.ownerTable;e instanceof K&&e.associatedCell instanceof i;)e=e.associatedCell.getContainerTable();return e},i.prototype.getPreviousSplitWidget=function(){if(this.containerWidget instanceof X){var e=this.containerWidget;do{if(e=e.previousRenderedWidget,t.isNullOrUndefined(e)||e.index<this.rowIndex)break;var i=e.getCell(this.rowIndex,this.index);if(i&&this.equals(i))return i}while(e)}},i.prototype.getNextSplitWidget=function(){var e=this.cellFormat.rowSpan;if(this.containerWidget instanceof X){var i=this.containerWidget;do{if(i=i.nextRenderedWidget,t.isNullOrUndefined(i)||i.index>this.rowIndex+e)break;var r=i.getCell(this.rowIndex,this.index);if(r&&this.equals(r))return r}while(i)}},i.prototype.getTableCellWidget=function(e){for(var t=0;t<this.childWidgets.length;t++)if(this.childWidgets[t].y<=e.y&&this.childWidgets[t].y+this.childWidgets[t].height>=e.y)return this.childWidgets[t].getTableCellWidget(e);var i=void 0;return this.childWidgets.length>0&&(i=this.childWidgets[0].y<=e.y?this.childWidgets[this.childWidgets.length-1].getTableCellWidget(e):this.childWidgets[0].getTableCellWidget(e)),i},i.prototype.updateWidth=function(e){"Auto"===this.cellFormat.preferredWidthType?(this.cellFormat.preferredWidth=e,this.cellFormat.preferredWidthType="Point"):"Point"===this.cellFormat.preferredWidthType?this.cellFormat.preferredWidth=e:"Percent"===this.cellFormat.preferredWidthType&&(this.cellFormat.preferredWidth=this.convertPointToPercent(e)),this.cellFormat.cellWidth=e},i.prototype.convertPointToPercent=function(e){var t=0,i=this.ownerTable.getOwnerWidth(!0);return t=e/this.ownerTable.getTableClientWidth(i)*100,t=Math.round(t),t<100?t:100},i.getCellLeftBorder=function(e){var i=void 0,r=e.cellFormat.borders,n=t.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,o=t.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(t.isNullOrUndefined(r.left)||(i=r.left),t.isNullOrUndefined(i)&&(i=e.getLeftBorderToRenderByHierarchy(i,n,o)),e.ownerTable.tableFormat.cellSpacing>0)i=e.getLeftBorderToRenderByHierarchy(i,n,o);else{var a=void 0;if(t.isNullOrUndefined(e.previousWidget)){if((e.cellFormat.columnSpan>1||e.columnIndex>1)&&e.ownerRow.rowIndex>0)for(var s=e.ownerRow.previousWidget;!t.isNullOrUndefined(s)&&s.childWidgets.length>0;){for(var l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l];if(d.columnIndex+d.cellFormat.columnSpan===e.columnIndex){a=s.childWidgets[l];break}}if(!t.isNullOrUndefined(a))break;s=s.previousWidget}}else a=e.previousWidget;i=e.getPreviousCellLeftBorder(i,a)}return t.isNullOrUndefined(i)&&(i=new k(e.cellFormat.borders)),i},i.prototype.getLeftBorderWidth=function(){return 0},i.prototype.getRightBorderWidth=function(){this.ownerTable;return 0},i.prototype.getCellSpacing=function(){var e=this.ownerTable&&this.ownerTable.tableFormat?this.ownerTable.tableFormat.cellSpacing:0;return 1===this.ownerRow.childWidgets.length?2*e:0===this.cellIndex||this.cellIndex===this.ownerRow.childWidgets.length-1?e+e/2:e},i.prototype.getMinimumPreferredWidth=function(){return this.leftMargin+this.rightMargin+this.getLeftBorderWidth()+this.getRightBorderWidth()+this.getCellSpacing()},i.prototype.getPreviousCellLeftBorder=function(e,i){if(t.isNullOrUndefined(i)||!t.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle){if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getLeftBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}else{var r=void 0;if(t.isNullOrUndefined(i.cellFormat.borders)||t.isNullOrUndefined(i.cellFormat.borders.right)||"None"===i.cellFormat.borders.right.lineStyle||(r=i.cellFormat.borders.right),!t.isNullOrUndefined(r)&&"None"!==r.lineStyle)return this.getBorderBasedOnPriority(r,e);if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getLeftBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}return e},i.prototype.getBorderBasedOnPriority=function(e,i){if(t.isNullOrUndefined(e))return i;if(t.isNullOrUndefined(i))return e;var r=e.getBorderWeight(),n=i.getBorderWeight();if(r===n){var o=e.getPrecedence(),a=i.getPrecedence();if(o===a){var s=this.convertHexToRGB(e.color),l=s.r,d=s.g,h=s.b,c=this.convertHexToRGB(i.color),p=c.r,g=c.g,u=c.b,f=l+h+2*d,m=p+u+2*g;return f===m?(f=h+2*d,m=u+2*g,f===m?d===g?e:d>g?i:e:f>m?i:e):f>m?i:e}return o>a?e:i}return r>n?e:i},i.prototype.getLeftBorderToRenderByHierarchy=function(e,r,n){return t.isNullOrUndefined(e)||"None"===e.lineStyle&&(!e.hasNoneStyle||"None"===e.lineStyle&&0===e.lineWidth&&"#000000"===e.color)?!t.isNullOrUndefined(e)&&e.ownerBase instanceof B&&0===i.getCellOf(e.ownerBase).columnIndex?(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.left)||(e=n.left),e):t.isNullOrUndefined(r)||t.isNullOrUndefined(r.vertical)||"None"===r.vertical.lineStyle?t.isNullOrUndefined(n)||t.isNullOrUndefined(n.vertical)||"None"===n.vertical.lineStyle?e:e=n.vertical:e=r.vertical:e},i.getCellRightBorder=function(e){var i=void 0,r=e.cellFormat.borders,n=t.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,o=t.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(t.isNullOrUndefined(r.right)||(i=r.right),t.isNullOrUndefined(i)&&(i=e.getRightBorderToRenderByHierarchy(i,n,o)),e.ownerTable.tableFormat.cellSpacing>0)i=e.getRightBorderToRenderByHierarchy(i,n,o);else{var a=void 0;t.isNullOrUndefined(e.nextWidget)||(a=e.nextWidget),i=e.getAdjacentCellRightBorder(i,a)}return t.isNullOrUndefined(i)&&(i=new k(e.cellFormat.borders)),i},i.prototype.getAdjacentCellRightBorder=function(e,i){if(t.isNullOrUndefined(i)||!t.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle){if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getRightBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}else{var r=void 0;if(t.isNullOrUndefined(i.cellFormat.borders)||t.isNullOrUndefined(i.cellFormat.borders.left)||"None"===i.cellFormat.borders.left.lineStyle||(r=i.cellFormat.borders.left),!t.isNullOrUndefined(r)&&"None"!==r.lineStyle)return this.getBorderBasedOnPriority(e,r);if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getRightBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}return e},i.prototype.getRightBorderToRenderByHierarchy=function(e,r,n){return t.isNullOrUndefined(e)||"None"===e.lineStyle&&(!e.hasNoneStyle||"None"===e.lineStyle&&0===e.lineWidth&&"#000000"===e.color)?!t.isNullOrUndefined(e)&&e.ownerBase instanceof B&&i.getCellOf(e.ownerBase).columnIndex===i.getCellOf(e.ownerBase).ownerRow.childWidgets.length-1?(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.right)||(e=n.right),e):t.isNullOrUndefined(r)||t.isNullOrUndefined(r.vertical)||"None"===r.vertical.lineStyle?t.isNullOrUndefined(n)||t.isNullOrUndefined(n.vertical)||"None"===n.vertical.lineStyle?e:e=n.vertical:e=r.vertical:e},i.getCellTopBorder=function(e){var i=void 0,r=e.cellFormat.borders,n=t.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,o=t.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(t.isNullOrUndefined(r.top)||(i=r.top),t.isNullOrUndefined(i)&&(i=e.getTopBorderToRenderByHierarchy(i,n,o)),e.ownerTable.tableFormat.cellSpacing>0)i=e.getTopBorderToRenderByHierarchy(i,n,o);else{for(var a=void 0,s=e.ownerRow.previousWidget;!t.isNullOrUndefined(s)&&s.childWidgets.length>0;){for(l=0;l<s.childWidgets.length;l++)if((d=s.childWidgets[l]).columnIndex+d.cellFormat.columnSpan-1>=e.columnIndex){a=s.childWidgets[l];break}if(!t.isNullOrUndefined(a))break;if(s=s.previousWidget,t.isNullOrUndefined(s)&&t.isNullOrUndefined(a))if(s=e.ownerRow.previousWidget,e.columnIndex<s.childWidgets.length)for(var l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l];if(d.columnIndex===e.columnIndex){a=s.childWidgets[l];break}}else a=e.ownerRow.previousWidget.childWidgets[e.ownerRow.previousWidget.childWidgets.length-1]}i=e.getPreviousCellTopBorder(i,a)}return t.isNullOrUndefined(i)&&(i=new k(e.cellFormat.borders)),i},i.prototype.getPreviousCellTopBorder=function(e,i){if(t.isNullOrUndefined(i)||!t.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle){if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getTopBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}else{var r=void 0;if(t.isNullOrUndefined(i.cellFormat.borders)||t.isNullOrUndefined(i.cellFormat.borders.bottom)||"None"===i.cellFormat.borders.bottom.lineStyle||(r=i.cellFormat.borders.bottom),!t.isNullOrUndefined(r)&&"None"!==r.lineStyle)return this.getBorderBasedOnPriority(e,r);if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getTopBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}return e},i.prototype.getTopBorderToRenderByHierarchy=function(e,r,n){return t.isNullOrUndefined(e)||"None"===e.lineStyle&&(!e.hasNoneStyle||"None"===e.lineStyle&&0===e.lineWidth&&"#000000"===e.color)?!t.isNullOrUndefined(e)&&e.ownerBase instanceof B&&0===i.getCellOf(e.ownerBase).ownerRow.rowIndex?(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.top)||(e=n.top),e):t.isNullOrUndefined(r)||t.isNullOrUndefined(r.horizontal)||"None"===r.horizontal.lineStyle?t.isNullOrUndefined(n)||t.isNullOrUndefined(n.horizontal)||"None"===n.horizontal.lineStyle?e:e=n.horizontal:e=r.horizontal:e},i.getCellBottomBorder=function(e){var i=void 0,r=e.cellFormat.borders,n=t.isNullOrUndefined(e.ownerRow)?void 0:e.ownerRow.rowFormat.borders,o=t.isNullOrUndefined(e.ownerTable)?void 0:e.ownerTable.tableFormat.borders;if(t.isNullOrUndefined(r.bottom)||(i=r.bottom),t.isNullOrUndefined(i)&&(i=e.getBottomBorderToRenderByHierarchy(i,n,o)),e.ownerTable.tableFormat.cellSpacing>0)i=e.getBottomBorderToRenderByHierarchy(i,n,o);else{var a=void 0,s=e.ownerRow.nextWidget;!t.isNullOrUndefined(s)&&e.columnIndex<s.childWidgets.length&&(a=s.childWidgets[e.columnIndex]),i=e.getAdjacentCellBottomBorder(i,a)}return t.isNullOrUndefined(i)&&(i=new k(e.cellFormat.borders)),i},i.prototype.getAdjacentCellBottomBorder=function(e,i){if(t.isNullOrUndefined(i)||!t.isNullOrUndefined(e)&&"None"===e.lineStyle&&!e.hasNoneStyle){if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getBottomBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}else{var r=void 0;if(t.isNullOrUndefined(i.cellFormat.borders)||t.isNullOrUndefined(i.cellFormat.borders.top)||"None"===i.cellFormat.borders.top.lineStyle||(r=i.cellFormat.borders.top),!t.isNullOrUndefined(r)&&"None"!==r.lineStyle)return this.getBorderBasedOnPriority(e,r);if(!(t.isNullOrUndefined(e)||e.ownerBase.ownerBase instanceof R))return this.getBottomBorderToRenderByHierarchy(e,X.getRowOf(e.ownerBase).rowFormat.borders,K.getTableOf(e.ownerBase).tableFormat.borders)}return e},i.prototype.getBottomBorderToRenderByHierarchy=function(e,r,n){return t.isNullOrUndefined(e)||"None"===e.lineStyle&&(!e.hasNoneStyle||"None"===e.lineStyle&&0===e.lineWidth&&"#000000"===e.color)?!t.isNullOrUndefined(e)&&e.ownerBase instanceof B&&i.getCellOf(e.ownerBase).ownerRow.rowIndex+i.getCellOf(e.ownerBase).cellFormat.rowSpan===i.getCellOf(e.ownerBase).ownerTable.childWidgets.length?(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.bottom)||(e=n.bottom),e):t.isNullOrUndefined(r)||t.isNullOrUndefined(r.horizontal)||"None"===r.horizontal.lineStyle?t.isNullOrUndefined(n)||t.isNullOrUndefined(n.horizontal)||"None"===n.horizontal.lineStyle?e:e=n.horizontal:e=r.horizontal:e},i.prototype.convertHexToRGB=function(e){if(e){e=e.replace(/[^0-9A-â€Œâ€‹F]/gi,"");var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}}},i.getCellOf=function(e){if(e instanceof B)return e.ownerBase instanceof H&&e.ownerBase.ownerBase instanceof i?e.ownerBase.ownerBase:void 0},i.prototype.destroyInternal=function(e){if(!t.isNullOrUndefined(this.childWidgets)){for(var i=0;i<this.childWidgets.length;i++){var r=this.childWidgets[i];r.destroyInternal(e),i--}this.childWidgets=void 0}this.destroy()},i.prototype.clone=function(){var e=new i;e.cellFormat.copyFormat(this.cellFormat);for(var t=0;t<this.childWidgets.length;t++){var r=this.childWidgets[t].clone();e.childWidgets.push(r),r.containerWidget=e,r.index=t}return e.leftBorderWidth=this.leftBorderWidth,e.rightBorderWidth=this.rightBorderWidth,this.margin&&(e.margin=this.margin.clone()),e.columnIndex=this.columnIndex,e.x=this.x,e.y=this.y,e.height=this.height,e.width=this.width,e},i.prototype.destroy=function(){this.cellFormat=void 0,this.rowIndex=void 0,this.columnIndex=void 0,e.prototype.destroy.call(this)},i}(j),J=function(){function e(e){this.children=[],this.x=0,this.y=0,this.width=0,this.height=0,this.paragraph=e}return Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.paragraph&&this.paragraph.childWidgets?this.paragraph.childWidgets.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextLine",{get:function(){var t=this.paragraph,i=this.indexInOwner;if(i<=t.childWidgets.length-2)return t.childWidgets[i+1];if(t.nextSplitWidget){var r=t.nextSplitWidget.firstChild;if(r instanceof e&&r.paragraph.equals(this.paragraph))return r}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousLine",{get:function(){var t=this.paragraph,i=this.indexInOwner,r=t.previousSplitWidget;if(i>0)return t.childWidgets[i-1];if(r instanceof G){var n=r.lastChild;if(n instanceof e&&n.paragraph.equals(this.paragraph))return n}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEndsWithPageBreak",{get:function(){if(this.children.length>0){var e=this.children[this.children.length-1];if(e instanceof Q)return e.isPageBreak}return!1},enumerable:!0,configurable:!0}),e.prototype.isFirstLine=function(){var e=this.indexInOwner;return e>-1&&void 0===this.paragraph.previousSplitWidget&&0===e},e.prototype.isLastLine=function(){var e=this.indexInOwner;return e>-1&&void 0===this.paragraph.nextSplitWidget&&e===this.paragraph.childWidgets.length-1},e.prototype.getOffset=function(e,i){if(t.isNullOrUndefined(e))return i;for(var r=i,n=e.line,o=(e.line.paragraph.childWidgets.indexOf(e.line),0);o<n.children.length;o++){var a=n.children[o];if(e===a)break;a instanceof ne||(r+=a.length)}return r},e.prototype.getEndOffset=function(){for(var e=0,t=0,i=0;i<this.children.length;i++){var r=this.children[i];0!==r.length&&(r instanceof ne||((r instanceof Q||r instanceof re||r instanceof ie||r instanceof $&&W.isLinkedFieldCharacter(r))&&(e=t+r.length),t+=r.length))}return e},e.prototype.getInline=function(e,i){var r=void 0,n=0,o=!1;if(0===this.children.length&&this.previousLine){var a=this.previousLine.children[this.previousLine.children.length-1];if(a instanceof Q&&"\v"===a.text)return r=this.previousLine.children[this.previousLine.children.length-1],i=1,{element:r,index:i}}for(var s=0;s<this.children.length;s++)if(!((r=this.children[s])instanceof ne)){if(!o&&(r instanceof Q||r instanceof re||r instanceof ie||r instanceof $&&W.isLinkedFieldCharacter(r))&&(o=!0),o&&e<=n+r.length)return i=e-n,{element:r,index:i};n+=r.length}return e>n&&(i=t.isNullOrUndefined(r)?e:r.length),{element:r,index:i}},e.prototype.getHierarchicalIndex=function(e){var t=this;return e=t.paragraph.childWidgets.indexOf(t)+";"+e,t.paragraph instanceof j?t.paragraph.getHierarchicalIndex(e):e},e.prototype.clone=function(){for(var t=new e(void 0),i=0;i<this.children.length;i++){var r=this.children[i].clone();t.children.push(r),r.line=t}return t.width=this.width,t.height=this.height,t},e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.children)){for(var e=0;e<this.children.length;e++)this.children[e].destroy();this.children=[]}this.children=void 0,this.paragraph&&this.paragraph.removeChild(this.indexInOwner),this.paragraph=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e}(),Z=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0,this.margin=new A(0,0,0,0),this.characterFormat=void 0,this.characterFormat=new P(this),this.margin=new A(0,0,0,0)}return Object.defineProperty(e.prototype,"isPageBreak",{get:function(){return this instanceof Q&&"\f"===this.text},enumerable:!0,configurable:!0}),e.prototype.linkFieldCharacter=function(e){if(this instanceof $)if(0===this.fieldType){var i=this;t.isNullOrUndefined(i.fieldEnd)&&(this.linkFieldTraversingForward(this.line,i,i),-1===e.fields.indexOf(i)&&e.fields.push(i))}else if(2===this.fieldType){var r=this;if(t.isNullOrUndefined(r.fieldBegin)&&this.linkFieldTraversingBackwardSeparator(this.line,r,r),r.fieldBegin.fieldSeparator=r,!t.isNullOrUndefined(r.fieldBegin)){var n=this.linkFieldTraversingForward(this.line,r.fieldBegin,r);t.isNullOrUndefined(r.fieldEnd)&&n&&(r.fieldEnd=r.fieldBegin.fieldEnd),r.fieldEnd&&(r.fieldEnd.fieldSeparator=r)}}else{var o=this;t.isNullOrUndefined(o.fieldBegin)&&this.linkFieldTraversingBackward(this.line,o,o)}},e.prototype.linkFieldTraversingBackward=function(e,i,r){var n=e.children.length-1;e.children.indexOf(r)>-1&&(n=e.children.indexOf(r)-1);for(var o=n;o>=0;o--){var a=e.children[o];if(a instanceof $){if(0===a.fieldType)return t.isNullOrUndefined(a.fieldEnd)&&(i.fieldBegin=a,t.isNullOrUndefined(a.fieldEnd)&&(a.fieldEnd=i),i.fieldSeparator&&t.isNullOrUndefined(i.fieldSeparator.fieldBegin)&&(i.fieldSeparator.fieldBegin=a,t.isNullOrUndefined(a.fieldSeparator)&&(a.fieldSeparator=i.fieldSeparator))),!t.isNullOrUndefined(i.fieldBegin);2===a.fieldType&&t.isNullOrUndefined(a.fieldEnd)&&(i.fieldSeparator=a,a.fieldEnd=i,t.isNullOrUndefined(a.fieldBegin)||(i.fieldBegin=a.fieldBegin))}}if(e.previousLine)this.linkFieldTraversingBackward(e.previousLine,i,this);else if(e.paragraph.previousRenderedWidget instanceof G){var s=e.paragraph.previousRenderedWidget;this.linkFieldTraversingBackward(s.childWidgets[s.childWidgets.length-1],i,this)}return!0},e.prototype.linkFieldTraversingForward=function(e,i,r){var n=0;e.children.indexOf(r)>-1&&(n=e.children.indexOf(r)+1);for(var o=n;o<e.children.length;o++){var a=e.children[o];if(a instanceof $){if(1===a.fieldType)return t.isNullOrUndefined(a.fieldBegin)&&(i.fieldEnd=a),i.fieldEnd&&t.isNullOrUndefined(i.fieldEnd.fieldBegin)&&(i.fieldEnd.fieldBegin=i),!0;if(t.isNullOrUndefined(i.fieldSeparator)){if(2!==a.fieldType||!t.isNullOrUndefined(a.fieldBegin))return!1;if(i.fieldSeparator=a,!t.isNullOrUndefined(a.fieldEnd))return i.fieldEnd=a.fieldEnd,!0}}}return e.nextLine?this.linkFieldTraversingForward(e.nextLine,i,this):e.paragraph.nextRenderedWidget instanceof G&&this.linkFieldTraversingForward(e.paragraph.nextRenderedWidget.childWidgets[0],i,this),!0},e.prototype.linkFieldTraversingBackwardSeparator=function(e,i,r){var n=e.children.length-1;e.children.indexOf(r)>-1&&(n=e.children.indexOf(r)-1);for(var o=n;o>=0;o--){var a=e.children[o];if(a instanceof $&&a instanceof $&&0===a.fieldType)return t.isNullOrUndefined(a.fieldSeparator)&&(i.fieldBegin=a),!t.isNullOrUndefined(i.fieldBegin)}if(e.previousLine)this.linkFieldTraversingBackwardSeparator(e.previousLine,i,this);else{if(!(e.paragraph.nextRenderedWidget instanceof G))return!0;e=e.paragraph.previousRenderedWidget.childWidgets[e.paragraph.previousRenderedWidget.childWidgets.length-1],this.linkFieldTraversingBackwardSeparator(e,i,this)}return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this.getLength()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"indexInOwner",{get:function(){return this.line instanceof J&&this.line.children?this.line.children.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousElement",{get:function(){var e=this.indexInOwner;if(e>0&&e<this.line.children.length)return this.line.children[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextElement",{get:function(){var e=this.indexInOwner;if(e>-1&&e<this.line.children.length-1)return this.line.children[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);return e<this.line.children.length-1?this.line.children[e+1]:t<this.line.paragraph.childWidgets.length-1?this.line.paragraph.childWidgets[t+1].children[0]:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousNode",{get:function(){var e=this.line.children.indexOf(this),t=this.line.paragraph.childWidgets.indexOf(this.line);if(e>0)return this.line.children[e-1];if(t>0){var i=this.line.paragraph.childWidgets[t-1];return i.children[i.children.length-1]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paragraph",{get:function(){if(this.line)return this.line.paragraph},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.line)&&this.line.children&&this.line.children.indexOf(this)>-1){var e=this.line.children.indexOf(this);this.line.children.splice(e,1)}this.line=void 0,this.characterFormat&&this.characterFormat.destroy(),this.characterFormat=void 0,this.margin&&this.margin.destroy(),this.margin=void 0,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0},e.objectCharacter=String.fromCharCode(65532),e}(),$=function(e){function t(t){var i=e.call(this)||this;return i.fieldType=0,i.hasFieldEnd=!1,i.fieldBeginInternal=void 0,i.fieldSeparatorInternal=void 0,i.fieldEndInternal=void 0,i.fieldType=t,i}return U(t,e),Object.defineProperty(t.prototype,"fieldBegin",{get:function(){return this.fieldBeginInternal},set:function(e){this.fieldBeginInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldSeparator",{get:function(){return this.fieldSeparatorInternal},set:function(e){this.fieldSeparatorInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fieldEnd",{get:function(){return this.fieldEndInternal},set:function(e){this.fieldEndInternal=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.clone=function(){var e=new t(this.fieldType);return e.characterFormat.copyFormat(this.characterFormat),this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t.prototype.destroy=function(){this.fieldType=void 0,this.hasFieldEnd=void 0,this.fieldBeginInternal=void 0,this.fieldEndInternal=void 0,this.fieldSeparatorInternal=void 0,e.prototype.destroy.call(this)},t}(Z),Q=function(e){function t(){var t=e.call(this)||this;return t.baselineOffset=0,t.text="",t}return U(t,e),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var e=new t;return e.characterFormat.copyFormat(this.characterFormat),e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},t}(Z),ee=function(e){function t(){var t=e.call(this)||this;return t.fieldText="",t}return U(t,e),Object.defineProperty(t.prototype,"text",{get:function(){return this.fieldText},set:function(e){this.fieldText=e},enumerable:!0,configurable:!0}),t.prototype.clone=function(){var e=new t;return e.characterFormat.copyFormat(this.characterFormat),e.fieldBegin=this.fieldBegin,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t}(Q),te=function(e){function t(){var t=e.call(this)||this;return t.tabText="",t.tabLeader="None",t}return U(t,e),t.prototype.destroy=function(){this.tabText=void 0,this.tabLeader=void 0},t.prototype.clone=function(){var e=new t;return e.characterFormat.copyFormat(this.characterFormat),e.tabText=this.tabText,e.tabLeader=this.tabLeader,e.text=this.text,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t}(Q),ie=function(e){function t(t){var i=e.call(this)||this;return i.bookmarkTypeIn=0,i.refereneceIn=void 0,i.nameIn="",i.bookmarkTypeIn=t,i}return U(t,e),Object.defineProperty(t.prototype,"bookmarkType",{get:function(){return this.bookmarkTypeIn},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.nameIn},set:function(e){this.nameIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reference",{get:function(){return this.refereneceIn},set:function(e){this.refereneceIn=e},enumerable:!0,configurable:!0}),t.prototype.getLength=function(){return 1},t.prototype.destroy=function(){this.name=void 0,this.reference=void 0,this.bookmarkTypeIn=void 0},t.prototype.clone=function(){var e=new t(this.bookmarkType);return e.name=this.name,e.reference=this.reference,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t}(Z),re=function(e){function i(t){var i=e.call(this)||this;return i.imageStr="",i.imgElement=void 0,i.isInlineImageIn=!0,i.isMetaFile=!1,i.isInlineImageIn=t,i}return U(i,e),Object.defineProperty(i.prototype,"isInlineImage",{get:function(){return this.isInlineImageIn},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return t.isNullOrUndefined(this.imgElement)&&(this.imgElement=document.createElement("img")),this.imgElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"imageString",{get:function(){return this.imageStr},set:function(e){this.imageStr=e,t.isNullOrUndefined(e)||(this.element.src=this.imageStr)},enumerable:!0,configurable:!0}),i.prototype.getLength=function(){return 1},i.prototype.clone=function(){var e=new i(this.isInlineImage);return e.characterFormat.copyFormat(this.characterFormat),e.imageString=this.imageString,e.isMetaFile=this.isMetaFile,e.width=this.width,e.height=this.height,this.margin&&(e.margin=this.margin.clone()),e},i.prototype.destroy=function(){this.imgElement=void 0,this.imageString=void 0,this.isInlineImageIn=void 0,e.prototype.destroy.call(this)},i}(Z),ne=function(e){function t(t,i){var r=e.call(this)||this;return r.baselineOffset=0,r.isFollowCharacter=!1,r.listLevel=t,r.isFollowCharacter=i,r}return U(t,e),t.prototype.getLength=function(){return this.text?this.text.length:0},t.prototype.clone=function(){var e=new t(this.listLevel,this.isFollowCharacter);return e.text=this.text,e.baselineOffset=this.baselineOffset,this.margin&&(e.margin=this.margin.clone()),e.width=this.width,e.height=this.height,e},t.prototype.destroy=function(){this.text=void 0,e.prototype.destroy.call(this)},t}(Z),oe=function(){function e(){this.boundingRectangle=new D(96,96,816,1056),this.repeatHeaderRowTableWidget=!1,this.bodyWidgets=[],this.headerWidget=void 0,this.footerWidget=void 0}return Object.defineProperty(e.prototype,"index",{get:function(){return this.viewer?this.viewer.pages.indexOf(this):-1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"previousPage",{get:function(){var e=this.index;if(e>0)return this.viewer.pages[e-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nextPage",{get:function(){var e=this.index;if(e<this.viewer.pages.length-1)return this.viewer.pages[e+1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionIndex",{get:function(){return this.bodyWidgets.length>0?this.bodyWidgets[0].index:-1},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.headerWidget&&(this.viewer&&this.viewer.owner.editor&&this.viewer.owner.editor.removeFieldInWidget(this.headerWidget),this.headerWidget.destroy()),this.headerWidget=void 0,this.footerWidget&&(this.viewer&&this.viewer.owner.editor&&this.viewer.owner.editor.removeFieldInWidget(this.footerWidget),this.footerWidget.destroy()),this.footerWidget=void 0,this.bodyWidgets=[],this.bodyWidgets=void 0,t.isNullOrUndefined(this.viewer)||t.isNullOrUndefined(this.viewer.pages)||this.viewer.removePage(this),this.viewer=void 0},e}(),ae=function(){function e(){this.tableColumns=[],this.tableWidth=0}return Object.defineProperty(e.prototype,"columns",{get:function(){return this.tableColumns},enumerable:!0,configurable:!0}),e.prototype.resetColumns=function(){for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[]},e.prototype.getPreviousSpannedCellWidth=function(e,t){for(var i=0,r=e;r<t;r++)i+=this.tableColumns[r].preferredWidth;return i},e.prototype.addColumns=function(e,t,i,r,n){for(var o=this.columns.length;o<t;o++)this.columns.push(new se);for(var a=0,s=e;s<t;s++)a+=this.columns[s].preferredWidth;!(t-e>1)&&a<i&&(this.columns[t-1].preferredWidth+=i-a),r>this.columns[t-1].minWidth&&(this.columns[t-1].minWidth=r),n>this.columns[t-1].endOffset&&(this.columns[t-1].endOffset=n)},e.prototype.getTotalWidth=function(){for(var e=0,t=0;t<this.columns.length;t++)e+=this.columns[t].preferredWidth;return e},e.prototype.isFitColumns=function(e,t,i){var r=this.getTotalWidth();if(this.tableWidth=i&&t>r?r:t,r!==this.tableWidth){var n=this.tableWidth/r;n=isNaN(n)?1:n;for(var o=0;o<this.columns.length;o++){var a=this.columns[o];if(n*a.preferredWidth<a.minWidth)return!1}return!0}return!0},e.prototype.fitColumns=function(e,t,i){var r=this.getTotalWidth();if(this.tableWidth=i&&t>r?r:t,r!==this.tableWidth)for(var n=this.tableWidth/r,o=0;o<this.columns.length;o++){var a=this.columns[o];a.preferredWidth=n*a.preferredWidth}},e.prototype.getCellWidth=function(e,t,i,r){for(var n=0,o=0;o<t;o++)n+=this.tableColumns[o+e].preferredWidth;return n},e.prototype.validateColumnWidths=function(){for(var e=0;e<this.columns.length;e++)0===e?this.columns[e].preferredWidth!==this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset):this.columns[e-1].endOffset+this.columns[e].preferredWidth<this.columns[e].endOffset&&(this.columns[e].preferredWidth=this.columns[e].endOffset-this.columns[e-1].endOffset)},e.prototype.clone=function(){var t=new e;t.tableWidth=this.tableWidth;for(var i=0;i<this.columns.length;i++)t.columns.push(this.columns[i].clone());return t},e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.tableColumns))for(var e=0;e<this.tableColumns.length;e++)this.tableColumns[e].destroy();this.tableColumns=[],this.tableColumns=void 0,this.tableWidth=void 0},e}(),se=function(){function e(){this.preferredWidth=0,this.minWidth=0,this.maxWidth=0,this.endOffset=0}return e.prototype.clone=function(){var t=new e;return t.preferredWidth=this.preferredWidth,t.minWidth=this.minWidth,t.maxWidth=this.maxWidth,t},e.prototype.destroy=function(){this.preferredWidth=void 0,this.minWidth=void 0,this.maxWidth=void 0},e}(),le=function(){function e(e){var i=this;this.contextMenuInstance=void 0,this.onContextMenuInternal=function(e){i.showHideElements(i.viewer.selection)&&(i.contextMenuInstance.open(e.y,e.x),e.preventDefault())},this.viewer=e;var r=new t.L10n("documenteditor",this.viewer.owner.defaultLocale);r.setLocale(this.viewer.owner.locale),t.setCulture(this.viewer.owner.locale),this.initContextMenu(r)}return e.prototype.getModuleName=function(){return"ContextMenu"},e.prototype.initContextMenu=function(e){var i=this,n=this.viewer.owner.element.id;this.contextMenu=document.createElement("div"),this.contextMenu.id=this.viewer.owner.containerId+"e-de-contextmenu",document.body.appendChild(this.contextMenu);var o=document.createElement("ul");o.style.width="auto",o.id=this.viewer.owner.containerId+"e-de-contextmenu-list",o.style.listStyle="none",o.style.margin="0px",o.style.padding="0px",o.style.maxHeight="auto",o.oncontextmenu=this.disableBrowserContextmenu,this.contextMenu.appendChild(o);var a=[{text:e.getConstant("Cut"),iconCss:"e-icons e-de-cut",id:n+"_contextmenu_cut"},{text:e.getConstant("Copy"),iconCss:"e-icons e-de-copy",id:n+"_contextmenu_copy"},{text:e.getConstant("Paste"),iconCss:"e-icons e-de-paste",id:n+"_contextmenu_paste"},{separator:!0},{text:e.getConstant("Update Field"),iconCss:"e-icons e-de-update_field",id:n+"_contextmenu_update_field"},{text:e.getConstant("Edit Field"),iconCss:"e-icons e-de-edit_field",id:n+"_contextmenu_edit_field"},{text:e.getConstant("Continue Numbering"),iconCss:"e-icons e-de-continue-numbering",id:n+"_contextmenu_continue_numbering"},{text:e.getConstant("Restart At")+" 1",iconCss:"e-icons e-de-restart-at",id:n+"_contextmenu_restart_at"},{separator:!0},{text:e.getConstant("Hyperlink"),iconCss:"e-icons e-de-insertlink",id:n+"_contextmenu_hyperlink"},{text:e.getConstant("Edit Hyperlink")+"...",iconCss:"e-icons e-de-edit-hyperlink",id:n+"_contextmenu_edit_hyperlink"},{text:e.getConstant("Open Hyperlink"),iconCss:"e-icons e-de-open-hyperlink",id:n+"_contextmenu_open_hyperlink"},{text:e.getConstant("Copy Hyperlink"),iconCss:"e-icons e-de-copy-hyperlink",id:n+"_contextmenu_copy_hyperlink"},{text:e.getConstant("Remove Hyperlink"),iconCss:"e-icons e-de-remove-hyperlink",id:n+"_contextmenu_remove_hyperlink"},{separator:!0},{text:e.getConstant("Font"),iconCss:"e-icons e-de-fonts",id:n+"_contextmenu_font_dialog"},{text:e.getConstant("Paragraph"),iconCss:"e-icons e-de-paragraph",id:n+"_contextmenu_paragraph_dialog"},{separator:!0},{text:e.getConstant("Table Properties"),id:n+"_contextmenu_table_dialog",iconCss:"e-icons e-de-table"},{text:e.getConstant("Merge Cells"),id:n+"_contextmenu_merge_cell",iconCss:"e-icons e-de-icon-table-merge-cells"},{text:e.getConstant("Insert"),id:n+"_contextmenu_insert_table",iconCss:"e-icons",items:[{text:e.getConstant("Insert Above"),id:n+"_contextmenu_insert_above",iconCss:"e-icons e-de-insertabove"},{text:e.getConstant("Insert Below"),id:n+"_contextmenu_insert_below",iconCss:"e-icons e-de-insertbelow"},{text:e.getConstant("Insert Left"),id:n+"_contextmenu_insert_left",iconCss:"e-icons e-de-insertleft"},{text:e.getConstant("Insert Right"),id:n+"_contextmenu_insert_right",iconCss:"e-icons e-de-insertright"}]},{text:e.getConstant("Delete"),id:n+"_contextmenu_delete_table",iconCss:"e-icons",items:[{text:e.getConstant("Delete Table"),id:n+"_contextmenu_complete_table_delete",iconCss:"e-icons e-de-delete-table"},{text:e.getConstant("Delete Row"),id:n+"_contextmenu_delete_row",iconCss:"e-icons e-de-deleterow"},{text:e.getConstant("Delete Column"),id:n+"_contextmenu_delete_column",iconCss:"e-icons e-de-deletecolumn"}]}],s={target:"#"+this.viewer.owner.containerId+"e-de-contextmenu",items:a,select:function(e){var t=e.element.id;i.handleContextMenuItem(t)}};this.contextMenuInstance=new r.ContextMenu(s,"#"+this.viewer.owner.containerId+"e-de-contextmenu-list"),this.contextMenuInstance.beforeOpen=function(){i.viewer&&i.viewer.selection&&(t.classList(i.viewer.selection.caret,[],["e-de-cursor-animation"]),i.viewer.selection.showCaret())},this.contextMenuInstance.onClose=function(){i.viewer&&i.viewer.selection&&(t.classList(i.viewer.selection.caret,["e-de-cursor-animation"],[]),i.viewer.updateFocus())}},e.prototype.disableBrowserContextmenu=function(){return!1},e.prototype.handleContextMenuItem=function(e){var t=this.viewer.owner.element.id;switch(e){case t+"_contextmenu_copy":this.viewer.selection.copy();break;case t+"_contextmenu_cut":this.viewer.owner.editor.cut();break;case t+"_contextmenu_paste":this.viewer.owner.isReadOnlyMode||this.viewer.owner.editorModule.pasteInternal(void 0);break;case t+"_contextmenu_update_field":this.viewer.owner.isReadOnlyMode||this.viewer.owner.editorModule.updateToc();break;case t+"_contextmenu_edit_field":this.viewer.owner.isReadOnlyMode||this.viewer.owner.tableOfContentsDialogModule.show();break;case t+"_contextmenu_font_dialog":this.viewer.owner.fontDialogModule&&this.viewer.owner.fontDialogModule.showFontDialog();break;case t+"_contextmenu_open_hyperlink":this.viewer.selection.navigateHyperlink();break;case t+"_contextmenu_copy_hyperlink":this.viewer.selection.copyHyperlink();break;case t+"_contextmenu_edit_hyperlink":case t+"_contextmenu_hyperlink":this.viewer.owner.hyperlinkDialogModule&&this.viewer.owner.hyperlinkDialogModule.show();break;case t+"_contextmenu_remove_hyperlink":this.viewer.owner.editor.removeHyperlink();break;case t+"_contextmenu_paragraph_dialog":this.viewer.owner.paragraphDialogModule&&this.viewer.owner.paragraphDialogModule.show();break;case t+"_contextmenu_table_dialog":this.viewer.owner.tablePropertiesDialogModule.show();break;case t+"_contextmenu_merge_cell":this.viewer.owner.editor.mergeCells();break;case t+"_contextmenu_insert_above":this.viewer.owner.editor.insertRow(!0);break;case t+"_contextmenu_insert_below":this.viewer.owner.editor.insertRow(!1);break;case t+"_contextmenu_insert_left":this.viewer.owner.editor.insertColumn(!0);break;case t+"_contextmenu_insert_right":this.viewer.owner.editor.insertColumn(!1);break;case t+"_contextmenu_complete_table_delete":this.viewer.owner.editor.deleteTable();break;case t+"_contextmenu_delete_row":this.viewer.owner.editor.deleteRow();break;case t+"_contextmenu_delete_column":this.viewer.owner.editor.deleteColumn();break;case t+"_contextmenu_continue_numbering":this.viewer.owner.editorModule.applyContinueNumbering(this.viewer.selection);break;case t+"_contextmenu_restart_at":this.viewer.owner.editorModule.applyRestartNumbering(this.viewer.selection)}},e.prototype.showHideElements=function(e){var i=this.viewer.owner,r=i.element.id,n=document.getElementById(r+"_contextmenu_copy"),o=document.getElementById(r+"_contextmenu_cut"),a=document.getElementById(r+"_contextmenu_paste"),s=document.getElementById(r+"_contextmenu_update_field"),l=document.getElementById(r+"_contextmenu_edit_field"),d=document.getElementById(r+"_contextmenu_font_dialog"),h=document.getElementById(r+"_contextmenu_paragraph_dialog"),c=document.getElementById(r+"_contextmenu_table_dialog"),p=document.getElementById(r+"_contextmenu_insert_table"),g=document.getElementById(r+"_contextmenu_delete_table"),u=document.getElementById(r+"_contextmenu_merge_cell"),f=document.getElementById(r+"_contextmenu_hyperlink"),m=document.getElementById(r+"_contextmenu_open_hyperlink"),v=document.getElementById(r+"_contextmenu_edit_hyperlink"),y=document.getElementById(r+"_contextmenu_copy_hyperlink"),w=document.getElementById(r+"_contextmenu_remove_hyperlink"),b=document.getElementById(r+"_contextmenu_continue_numbering"),x=document.getElementById(r+"_contextmenu_restart_at");if(o.style.display="none",a.style.display="none",a.nextSibling.style.display="none",f.style.display="none",m.style.display="none",y.style.display="none",v.style.display="none",w.style.display="none",w.nextSibling.style.display="none",u.style.display="none",d.style.display="none",h.style.display="none",h.nextSibling.style.display="none",p.style.display="none",g.style.display="none",c.style.display="none",s.style.display="none",l.style.display="none",b.style.display="none",x.style.display="none",x.nextSibling.style.display="none",t.isNullOrUndefined(e))return!1;if(e.hideToolTip(),e.isEmpty?(o.classList.add("e-disabled"),n.classList.add("e-disabled")):(o.classList.remove("e-disabled"),n.classList.remove("e-disabled")),i.isReadOnlyMode)return!0;if(o.style.display="block",a.style.display="block",a.nextSibling.style.display="block",p.classList.add("e-blankicon"),g.classList.add("e-blankicon"),s.classList.add("e-blankicon"),l.classList.add("e-blankicon"),i.enableLocalPaste&&!t.isNullOrUndefined(i.editor.copiedData)?a.classList.remove("e-disabled"):a.classList.add("e-disabled"),"TableOfContents"===e.contextType)s.style.display="block",l.style.display="block",x.nextSibling.style.display="block";else{var C=e.start,F=e.end;"List"===e.contextType&&"Bullet"!==i.editorModule.getListLevel(C.paragraph).listLevelPattern&&(b.style.display="block",x.style.display="block",x.nextSibling.style.display="block"),C.paragraph.isInsideTable&&(!F.paragraph.isInsideTable||C.paragraph.associatedCell!==F.paragraph.associatedCell||e.isCellSelected(C.paragraph.associatedCell,C,F))?f.classList.add("e-disabled"):f.classList.contains("e-disabled")&&f.classList.remove("e-disabled"),e.getHyperlinkField()instanceof $&&!e.isImageField()?(m.style.display="block",y.style.display="block",i.hyperlinkDialogModule&&(v.style.display="block"),w.style.display="block",w.nextSibling.style.display="block"):i.hyperlinkDialogModule&&(f.style.display="block")}return this.viewer.owner.selection.start.paragraph.isInsideTable&&this.viewer.owner.selection.end.paragraph.isInsideTable?(h.nextSibling.style.display="block",i.tablePropertiesDialogModule&&(c.style.display="block"),p.style.display="block",g.style.display="block",this.viewer.owner.editor.canMergeCells()&&(u.style.display="block")):(this.viewer.owner.fontDialogModule&&(d.style.display="block",d.previousSibling.style.display="block"),this.viewer.owner.paragraphDialogModule&&(h.style.display="block")),"Image"===e.contextType&&(d.style.display="none",h.style.display="none",w.nextSibling.style.display="none"),!0},e.prototype.destroy=function(){this.contextMenuInstance&&this.contextMenuInstance.destroy(),this.contextMenu&&(this.contextMenu.parentElement&&this.contextMenu.parentElement.removeChild(this.contextMenu),this.contextMenu.innerHTML=""),this.contextMenu=void 0,this.contextMenuInstance=void 0},e}(),de=function(){function e(){this.abstractListIdIn=-1,this.levels=[]}return Object.defineProperty(e.prototype,"abstractListId",{get:function(){return this.abstractListIdIn},set:function(e){this.abstractListIdIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.levels)){for(var e=0;e<this.levels.length;e++){var i=this.levels[e];i.destroy(),this.levels.splice(this.levels.indexOf(i),1),e--}this.levels=[]}this.levels=void 0},e}(),he=function(){function e(e){this.uniqueListLevel=void 0,this.paragraphFormat=void 0,this.characterFormat=void 0,this.ownerBase=e,this.characterFormat=new P(void 0),this.paragraphFormat=new F(void 0)}return Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return this.getPropertyValue("listLevelPattern")},set:function(e){this.setPropertyValue("listLevelPattern",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return this.getPropertyValue("followCharacter")},set:function(e){this.setPropertyValue("followCharacter",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startAt",{get:function(){return this.getPropertyValue("startAt")},set:function(e){this.setPropertyValue("startAt",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numberFormat",{get:function(){return this.getPropertyValue("numberFormat")},set:function(e){this.setPropertyValue("numberFormat",e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"restartLevel",{get:function(){return this.getPropertyValue("restartLevel")},set:function(e){this.setPropertyValue("restartLevel",e)},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(i){var r=p.getPropertyType(e.uniqueFormatType,i);return!t.isNullOrUndefined(this.uniqueListLevel)&&this.uniqueListLevel.propertiesHash.containsKey(r)?this.uniqueListLevel.propertiesHash.get(r):e.getPropertyDefaultValue(i)},e.prototype.setPropertyValue=function(i,r){if((t.isNullOrUndefined(r)||""===r)&&(r=e.getPropertyDefaultValue(i)),t.isNullOrUndefined(this.uniqueListLevel))this.initializeUniqueWListLevel(i,r);else{var n=p.getPropertyType(this.uniqueListLevel.uniqueFormatType,i);if(this.uniqueListLevel.propertiesHash.containsKey(n)&&this.uniqueListLevel.propertiesHash.get(n)===r)return;this.uniqueListLevel=e.uniqueListLevels.updateUniqueFormat(this.uniqueListLevel,i,r)}},e.prototype.initializeUniqueWListLevel=function(t,i){var r=new c;this.addUniqueWListLevel("listLevelPattern",t,i,r),this.addUniqueWListLevel("startAt",t,i,r),this.addUniqueWListLevel("followCharacter",t,i,r),this.addUniqueWListLevel("numberFormat",t,i,r),this.addUniqueWListLevel("restartLevel",t,i,r),this.uniqueListLevel=e.uniqueListLevels.addUniqueFormat(r,e.uniqueFormatType)},e.prototype.addUniqueWListLevel=function(t,i,r,n){var o;o=p.getPropertyType(e.uniqueFormatType,t),t===i?n.add(o,r):n.add(o,e.getPropertyDefaultValue(t))},e.getPropertyDefaultValue=function(e){var t=void 0;switch(e){case"listLevelPattern":t="Arabic";break;case"startAt":t=0;break;case"followCharacter":t="Tab";break;case"numberFormat":t="";break;case"restartLevel":t=0}return t},e.prototype.destroy=function(){t.isNullOrUndefined(this.characterFormat)||this.characterFormat.destroy(),t.isNullOrUndefined(this.paragraphFormat)||this.paragraphFormat.destroy(),t.isNullOrUndefined(this.uniqueListLevel)||e.uniqueListLevels.remove(this.uniqueListLevel),this.uniqueListLevel=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0},e.clear=function(){this.uniqueListLevels.clear()},e.dotBullet="",e.squareBullet="",e.arrowBullet="➤",e.circleBullet=" ",e.uniqueListLevels=new g,e.uniqueFormatType=9,e}(),ce=function(){function e(e){this.allowLayout=!0,this.isInitialLoad=!0,this.fieldBegin=void 0,this.maxTextHeight=0,this.maxBaseline=0,this.maxTextBaseline=0,this.isFieldCode=!1,this.viewer=e}return e.prototype.layout=function(){this.viewer.pages[0].bodyWidgets[0]},e.prototype.destroy=function(){this.viewer=void 0,this.value=void 0,this.allowLayout=void 0,this.isInitialLoad=void 0,this.fieldBegin=void 0,this.maxTextHeight=void 0,this.maxBaseline=void 0,this.maxTextBaseline=void 0,this.isFieldCode=void 0},e.prototype.layoutItems=function(e){for(var t,i=this,r=0;r<e.length;r++){var n=e[r];if(t=this.viewer.createNewPage(n),this.addBodyWidget(this.viewer.clientActiveArea,n),this.viewer.pages.length>1){for(var o=0,a=0;a<this.viewer.pages.length;a++){var s=this.viewer.pages[a];if(s.sectionIndex>n.index||s===t)break;o++}o<this.viewer.pages.length-1&&this.viewer.insertPage(o,t)}this.layoutSection(n,0,this.viewer)}this.updateFieldElements(),setTimeout(function(){i.viewer&&(i.viewer.updateScrollBars(),i.isInitialLoad=!1)})},e.prototype.layoutSection=function(e,t,i,r){var n,o=e.firstChild;do{this.viewer.updateClientAreaForBlock(o,!0),n=this.layoutBlock(o,t),t=0,this.viewer.updateClientAreaForBlock(o,!1),o=n}while(o)},e.prototype.layoutHeaderFooter=function(e,t,i){var r=t.getCurrentPageHeaderFooter(e,!0);if(r){var n=r.clone();n.page=i,t.updateHFClientArea(e.sectionFormat,!0),i.headerWidget=this.layoutHeaderFooterItems(t,n),this.updateHeaderFooterToParent(n)}if(r=t.getCurrentPageHeaderFooter(e,!1)){var o=r.clone();o.page=i,t.updateHFClientArea(e.sectionFormat,!1),i.footerWidget=this.layoutHeaderFooterItems(t,o),this.updateHeaderFooterToParent(o)}},e.prototype.updateHeaderFooterToParent=function(e){var t=e.page.sectionIndex,i=this.viewer.getHeaderFooter(e.headerFooterType),r=e.clone();this.viewer.headersFooters[t][i]=r;for(var n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n];o instanceof K&&this.clearTableWidget(o,!1,!0)}return r},e.prototype.linkFieldInHeaderFooter=function(e){var t=e.firstChild;do{t instanceof G?this.linkFieldInParagraph(t):this.linkFieldInTable(t)}while(t=t.nextWidget)},e.prototype.linkFieldInParagraph=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.children.length;r++){var n=i.children[r];n instanceof $&&0!==n.fieldType&&n.linkFieldCharacter(this.viewer)}},e.prototype.linkFieldInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++)for(var n=i.childWidgets[r],o=0;o<n.childWidgets.length;o++){var a=n.childWidgets[o];a instanceof G?this.linkFieldInParagraph(a):this.linkFieldInTable(a)}},e.prototype.layoutHeaderFooterItems=function(e,t){if(this.viewer.updateClientAreaLocation(t,e.clientActiveArea),0===t.childWidgets.length){var i=new G,r=new J(i);i.childWidgets.push(r),t.childWidgets.push(i),i.containerWidget=t}this.linkFieldInHeaderFooter(t);for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];e.updateClientAreaForBlock(o,!0),this.layoutBlock(o,0),e.updateClientAreaForBlock(o,!1)}var a=t.headerFooterType;return"OddFooter"!==a&&"EvenFooter"!==a&&"FirstPageFooter"!==a||this.shiftChildLocation(e.clientArea.y-e.clientActiveArea.y,t),t},e.prototype.shiftChildLocation=function(e,t){var i=t.y+e,r=t.page.boundingRectangle.height-t.page.boundingRectangle.height/100*40;e=(i=Math.max(i,r))-t.y,t.y=i;for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];o instanceof G?(o.x=o.x,o.y=o.y+e):this.shiftChildLocationForTableWidget(o,e)}},e.prototype.shiftChildLocationForTableWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];r instanceof X&&this.shiftChildLocationForTableRowWidget(r,t)}},e.prototype.shiftChildLocationForTableRowWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)this.shiftChildLocationForTableCellWidget(e.childWidgets[i],t)},e.prototype.shiftChildLocationForTableCellWidget=function(e,t){e.y=e.y+t;for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i]instanceof G?(e.childWidgets[i].x=e.childWidgets[i].x,e.childWidgets[i].y=e.childWidgets[i].y+t):this.shiftChildLocationForTableWidget(e.childWidgets[i],t)},e.prototype.layoutBlock=function(e,t,i){return(e instanceof G?this.layoutParagraph(e,t):this.layoutTable(e,t)).nextRenderedWidget},e.prototype.addParagraphWidget=function(e,i){if(!i.isEmpty()||t.isNullOrUndefined(i.paragraphFormat)||"Center"!==i.paragraphFormat.textAlignment&&"Right"!==i.paragraphFormat.textAlignment||-1!==i.paragraphFormat.listFormat.listId)i.width=e.width,i.x=e.x,i.y=e.y;else{var r=this.viewer.textHelper.getParagraphMarkWidth(i.characterFormat),n=e.x;"Center"===i.paragraphFormat.textAlignment?n+=(e.width-r)/2:n+=e.width-r,i.width=r,i.x=n,i.y=e.y}return i},e.prototype.addLineWidget=function(e){var t=void 0;return t=new J(e),t.width=e.width,e.childWidgets.push(t),t.paragraph=e,t},e.prototype.layoutParagraph=function(e,i){if(this.addParagraphWidget(this.viewer.clientActiveArea,e),this.layoutListItems(e),e.isEmpty())this.layoutEmptyLineWidget(e,!0);else for(var r=i<e.childWidgets.length?e.childWidgets[i]:void 0;r instanceof J;){if(r.isFirstLine()&&t.isNullOrUndefined(this.fieldBegin)&&!t.isNullOrUndefined(e.paragraphFormat)){var n=-W.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(n)}e=(r=this.layoutLine(r,0)).paragraph,r=r.nextLine}return this.updateWidgetToPage(this.viewer,e),e},e.prototype.clearLineMeasures=function(){this.maxBaseline=0,this.maxTextBaseline=0,this.maxTextHeight=0},e.prototype.moveElementFromNextLine=function(e){for(var t=e.nextLine;t instanceof J;){if(t.children.length>0){var i=t.children.splice(0,1)[0];e.children.push(i),i.line=e;break}1===t.paragraph.childWidgets.length?t.paragraph.destroy():t.destroy(),t=e.nextLine}},e.prototype.layoutLine=function(e,t){var i=e.paragraph;0===e.children.length&&this.moveElementFromNextLine(e);var r=e.children[t];for(this.clearLineMeasures();r instanceof Z;)this.layoutElement(r,i),e=r.line,r=r.nextElement;return e},e.prototype.layoutElement=function(e,i){var r=e.line,n="",o=e.indexInOwner;if(e instanceof $)return 0===e.fieldType&&-1===this.viewer.fields.indexOf(e)&&this.viewer.fields.push(e),this.layoutFieldCharacters(e),void(e.line.isLastLine()&&t.isNullOrUndefined(e.nextNode)&&!this.isFieldCode?(t.isNullOrUndefined(e.fieldSeparator)&&this.layoutEmptyLineWidget(i,!1,e.line),this.moveToNextLine(r)):t.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()?this.moveElementFromNextLine(r):t.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(r),r.paragraph.lastChild===r&&!t.isNullOrUndefined(r.nextLine)&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(r)));if(e instanceof ne||this.isFieldCode||e instanceof ie)return t.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(r),void(e.line.isLastLine()&&t.isNullOrUndefined(e.nextElement)&&(this.hasValidElement(r.paragraph)?this.moveToNextLine(r):this.layoutEmptyLineWidget(r.paragraph,!1,r,!1)));var a=e.width;if(e instanceof ee?""!==(n=this.viewer.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page))?e.text=n:n=e.text:e instanceof Q&&(this.checkAndSplitTabOrLineBreakCharacter(e.text,e),n=e.text),e instanceof Q&&(a=this.viewer.textHelper.getTextSize(e,e.characterFormat),"\t"===e.text&&(e.width=this.getTabWidth(i,this.viewer,o,r,e))),this.viewer instanceof ve&&this.viewer.clientActiveArea.height<e.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(this.moveToNextPage(this.viewer,r),e instanceof ee&&this.updateFieldText(e),e.previousElement&&this.cutClientWidth(e.previousElement)),a<this.viewer.clientActiveArea.width||!this.viewer.textWrap)this.addElementToLine(i,e),t.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()?this.moveElementFromNextLine(r):!e.line.isLastLine()&&t.isNullOrUndefined(e.nextElement)&&0===this.viewer.clientActiveArea.width&&(this.moveToNextLine(r),r.paragraph.lastChild===r&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(r));else if(e instanceof Q)if("\t"===e.text){var s=e.line;this.addSplittedLineWidget(s,s.children.indexOf(e)),this.moveToNextLine(s),e.width=this.getTabWidth(i,this.viewer,o,r,e),this.addElementToLine(i,e)}else do{r=e.line,this.splitTextForClientArea(r,e,e.text,e.width,e.characterFormat),this.checkLineWidgetWithClientArea(r,e),e instanceof ee&&this.updateFieldText(e)}while(e.line!==r&&this.cutClientWidth(e));else do{r=e.line,this.splitElementForClientArea(i,e),this.checkLineWidgetWithClientArea(r,e),e instanceof ee&&this.updateFieldText(e)}while(e.line!==r&&this.cutClientWidth(e));if("\v"===n||"\f"===n){var l=r.children.indexOf(e);l>-1&&this.addSplittedLineWidget(r,l)}(e.line.isLastLine()&&t.isNullOrUndefined(e.nextElement)||"\v"===n||"\f"===n)&&(this.moveToNextLine(e.line),"\v"===n&&t.isNullOrUndefined(e.nextNode)?this.layoutEmptyLineWidget(i,!0,r,!0):"\f"===n&&(t.isNullOrUndefined(e.nextNode)?this.moveToNextPage(this.viewer,e.line,!0):this.moveToNextPage(this.viewer,e.line.nextLine,!1)))},e.prototype.hasValidElement=function(e){var i=e.firstChild;if(i&&!t.isNullOrUndefined(this.viewer.selection))for(var r=i.children[0];r;){if(r instanceof $&&!(r=this.viewer.selection.getNextValidElementForField(r)).line.paragraph.equals(e))return!1;if(r instanceof Q)return!0;r=r.nextNode}return!1},e.prototype.updateFieldText=function(e){var t=this.viewer.getFieldResult(e.fieldBegin,e.paragraph.bodyWidget.page);""!==t&&(e.text=t,this.viewer.textHelper.getTextSize(e,e.characterFormat))},e.prototype.checkLineWidgetWithClientArea=function(e,i){(e!==i.line||i.line===e&&t.isNullOrUndefined(i.nextElement)&&!i.line.isLastLine())&&this.moveToNextLine(e),i.line!==e&&this.viewer instanceof ve&&this.viewer.clientActiveArea.height<i.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y?this.moveToNextPage(this.viewer,i.line):i.line===e&&t.isNullOrUndefined(i.nextElement)&&e.paragraph.lastChild===e&&!e.isLastLine()&&this.viewer.clientActiveArea.height>=0&&this.moveFromNextPage(e)},e.prototype.checkAndSplitTabOrLineBreakCharacter=function(e,t){var i=["\t","\v","\f"],r=W.indexOfAny(e,i);if(r>-1){var n=e[r];("\t"===n&&"\t"!==e||"\v"===n&&"\v"!==e||"\f"===n&&"\f"!==e)&&this.splitByLineBreakOrTab(this.viewer,t,r,n)}},e.prototype.moveFromNextPage=function(e){var t=e.nextLine;t&&-1===e.paragraph.childWidgets.indexOf(t)&&(t.paragraph.childWidgets.splice(t.indexInOwner,1),e.paragraph.childWidgets.push(t),t.paragraph=e.paragraph)},e.prototype.cutClientWidth=function(e){this.clearLineMeasures();for(var i=e.line,r=0,n=0;n<i.children.length;n++){var o=i.children[n];if(r+=o.width,e===o)break}var a=this.viewer.clientActiveArea.width-r<0;return a?e.previousElement&&this.cutClientWidth(e.previousElement):(this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+r),"Justify"===e.line.paragraph.paragraphFormat.textAlignment&&e instanceof Q&&this.splitTextElementWordByWord(e),t.isNullOrUndefined(e.nextElement)&&this.viewer.clientActiveArea.width>0&&!e.line.isLastLine()&&this.moveElementFromNextLine(i)),a},e.prototype.layoutFieldCharacters=function(e){if(0===e.fieldType)this.isFieldCode||t.isNullOrUndefined(e.fieldEnd)&&!e.hasFieldEnd||(this.viewer.fieldStacks.push(e),this.isFieldCode=!0,e.hasFieldEnd=!0);else if(this.viewer.fieldStacks.length>0)if(2===e.fieldType)(i=this.viewer.fieldStacks[this.viewer.fieldStacks.length-1]).fieldSeparator!==e||t.isNullOrUndefined(i.fieldEnd)&&!i.hasFieldEnd||(this.isFieldCode=!1);else{var i=this.viewer.fieldStacks[this.viewer.fieldStacks.length-1];e===i.fieldEnd&&(this.viewer.fieldStacks.pop(),this.isFieldCode=!1)}},e.prototype.layoutEmptyLineWidget=function(e,i,r,n){n=!t.isNullOrUndefined(n)&&n;var o,a=this.viewer.textHelper.getParagraphMarkSize(e.characterFormat),s=a.Height,l=this.getBeforeSpacing(e);o=e.childWidgets.length>0&&!n?e.childWidgets[0]:i?this.addLineWidget(e):r,this.viewer instanceof ve&&this.viewer.clientActiveArea.height<l+s&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&this.moveToNextPage(this.viewer,o);var d=this.getLineSpacing(e,s);a.BaselineOffset;!isNaN(this.maxTextHeight)&&s<this.maxTextHeight&&(s=this.maxTextHeight,this.maxTextBaseline);var h=0,c=0,p=0,g=s,u=e.paragraphFormat.lineSpacingType;"Multiple"===u?d>s?c+=d-s:h+=d-s:"Exactly"===u?h+=d-(h+g+c):d>h+g+c&&(h+=d-(h+g+c)),h+=l,c+=W.convertPointToPixel(e.paragraphFormat.afterSpacing);for(var f=0;f<o.children.length;f++){var m=o.children[f];if(m instanceof ne){var v=e.paragraphFormat.textAlignment;"Right"===v?p=this.viewer.clientArea.width-m.width:"Center"===v&&(p=(this.viewer.clientArea.width-m.width)/2),m.margin=new A(p,h,0,c),m.line=o,o.height=h+g+c}}o.height=h+g+c,this.viewer.cutFromTop(this.viewer.clientActiveArea.y+o.height)},e.prototype.layoutListItems=function(e){this.isFieldCode||(!t.isNullOrUndefined(e.paragraphFormat)&&!t.isNullOrUndefined(e.paragraphFormat.listFormat)&&!t.isNullOrUndefined(this.viewer.getListById(e.paragraphFormat.listFormat.listId))&&e.paragraphFormat.listFormat.listLevelNumber>=0&&e.paragraphFormat.listFormat.listLevelNumber<9?(this.clearListElementBox(e),this.layoutList(e,this.viewer)):e.paragraphFormat.listFormat&&-1===e.paragraphFormat.listFormat.listId&&this.clearListElementBox(e))},e.prototype.layoutList=function(e,i){var r=i.getListById(e.paragraphFormat.listFormat.listId);i.updateClientWidth(-W.convertPointToPixel(e.paragraphFormat.firstLineIndent));var n=this.getListLevel(r,e.paragraphFormat.listFormat.listLevelNumber),o=e.childWidgets[0];t.isNullOrUndefined(o)&&(o=new J(e),e.childWidgets.push(o));var a=new ne(n,!1);a.line=o,"Bullet"===n.listLevelPattern?a.text=n.numberFormat:a.text=this.getListNumber(e.paragraphFormat.listFormat),i.textHelper.updateTextSize(a,e);var s;if(this.viewer instanceof ve&&this.viewer.clientActiveArea.height<a.height&&this.viewer.clientActiveArea.y!==this.viewer.clientArea.y&&(s=!0),i.cutFromLeft(i.clientActiveArea.x+a.width),o.children.splice(0,0,a),"None"!==n.followCharacter){if(a=new ne(n,!0),"Tab"===n.followCharacter){a.text="\t";var l=o.children.indexOf(a);a.width=this.getTabWidth(e,i,l,o,void 0)}else a.text=" ",i.textHelper.updateTextSize(a,e);i.cutFromLeft(i.clientActiveArea.x+a.width),o.children.splice(1,0,a),a.line=o}if(s)return this.moveToNextPage(this.viewer,o),void this.cutClientWidth(a);"None"!==n.followCharacter&&i.updateClientWidth(W.convertPointToPixel(e.paragraphFormat.firstLineIndent))},e.prototype.addBodyWidget=function(e,t){var i;return i=t||new V,i.width=e.width,i.x=e.x,i.y=e.y,i},e.prototype.addListLevels=function(e){for(var t=e.levels.length;t<9;t++){var i=new he(e),r=t%3;"Bullet"===e.levels[0].listLevelPattern?(i.listLevelPattern="Bullet",i.numberFormat=0===r?"":1===r?"":"",i.characterFormat.fontFamily=(i.numberFormat,"Wingdings")):(i.listLevelPattern=this.getListLevelPattern(r),i.numberFormat="%"+(t+1).toString()+".",i.startAt=1,i.restartLevel=t),i.paragraphFormat=new F(void 0),i.paragraphFormat.leftIndent=48*(t+1),i.paragraphFormat.firstLineIndent=-24,e.levels.push(i)}},e.prototype.addSplittedLineWidget=function(e,i,r){var n=e.paragraph,o=[],a=n.childWidgets.indexOf(e);t.isNullOrUndefined(r)||o.push(r);for(var s=void 0,l=i+1;l<e.children.length;l++)o.push(e.children[l]);if(o.length>0){s=a===n.childWidgets.length-1?new J(n):n.childWidgets[a+1];for(var d=0;d<o.length;d++)o[d].line=s;e.children.splice(i+1,e.children.length-1),s.children=o.concat(s.children),-1===n.childWidgets.indexOf(s)&&n.childWidgets.splice(a+1,0,s)}},e.prototype.addElementToLine=function(e,t){this.viewer.cutFromLeft(this.viewer.clientActiveArea.x+t.width),"Justify"===e.paragraphFormat.textAlignment&&t instanceof Q&&this.splitTextElementWordByWord(t)},e.prototype.splitElementForClientArea=function(e,t){t.line;if(t.line.children.length>0){var i=t.previousElement,r=t.indexInOwner;t.line.children.length>1&&i&&this.viewer.clientActiveArea.x!==this.viewer.clientArea.x&&(r-=1),this.addSplittedLineWidget(t.line,r)}},e.prototype.splitByWord=function(e,t,i,r,n,o){var a=this.getSplitIndexByWord(this.viewer.clientActiveArea.width,r,n,o);if(a>0&&a<i.length){var s=e.children.indexOf(i),l=(t.childWidgets.indexOf(e),new Q);r=r.substring(a),l.text=r," "===r[0]&&(a+=r.length-(r=W.trimStart(r)).length),l.characterFormat.copyFormat(i.characterFormat),l.width=this.viewer.textHelper.getWidth(l.text,o),i.text=i.text.substr(0,a),i.width-=l.width,l.height=i.height,l.baselineOffset=i.baselineOffset,this.addSplittedLineWidget(e,s,l),this.addElementToLine(t,i),0===i.width&&e.children.splice(s,1)}},e.prototype.splitByCharacter=function(e,t,i,r,n){var o=e.paragraph,a=this.getTextSplitIndexByCharacter(this.viewer.clientArea.width,this.viewer.clientActiveArea.width,i,r,n),s=0;if(a<t.length&&(s=this.viewer.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a),n),i=i.substring(a)),s>this.viewer.clientActiveArea.width&&t.indexInOwner>0)return void this.addSplittedLineWidget(e,t.indexInOwner-1);var l=e.children.indexOf(t);if(a<t.length){o.childWidgets.indexOf(e);var d=new Q;d.text=i,t.text=t.text.substr(0,a),d.characterFormat.copyFormat(t.characterFormat),d.width=this.viewer.textHelper.getWidth(d.text,n),t.width-=d.width,d.height=t.height,d.baselineOffset=t.baselineOffset,e.children.splice(t.indexInOwner+1,0,d),this.addSplittedLineWidget(e,l),this.addElementToLine(o,t),0===t.width&&e.children.splice(l,1)}else this.addSplittedLineWidget(e,l),this.addElementToLine(o,t)},e.prototype.splitTextElementWordByWord=function(e){var t,i=e.line,r=i.children.indexOf(e),n=e.text;if(n.trim().indexOf(" ")>=0){i.children.splice(r,1);(t=e.characterFormat).fontSize;for(var o=e.length-W.trimStart(n).length;o<e.length&&0!==(o=this.getTextIndexAfterSpace(n,o))&&o!==e.length;)if(o<e.length){var a=new Q,s=n.substring(0,o);" "===(n=n.substring(o)).substring(0,1)&&(o+=n.length-W.trimStart(n).length),a.text=s,a.characterFormat.copyFormat(e.characterFormat),a.line=i,a.width=this.viewer.textHelper.getWidth(a.text,t),a.height=e.height,a.baselineOffset=e.baselineOffset,i.children.splice(r,0,a),e.text=n,e.width-=a.width,0===e.width&&i.children.splice(i.children.indexOf(e),1),o=0,r++}e.text=n,i.children.splice(r,0,e)}},e.prototype.splitTextForClientArea=function(e,t,i,r,n){var o=e.paragraph,a=!0,s=-1;if(" "!==i.substring(0,1)){var l=r,d=0;if(d=W.trimEnd(i).indexOf(" ")+1,(s=d)>0&&(l=this.viewer.textHelper.measureTextExcludingSpaceAtEnd(i.slice(0,s),n)),this.viewer.clientActiveArea.width<l&&(a=this.checkPreviousElement(e,e.children.indexOf(t),n)))return}else s=1;r<=this.viewer.clientActiveArea.width?this.addElementToLine(o,t):a&&(s>0||-1!==i.indexOf(" "))?this.splitByWord(e,o,t,i,r,n):this.splitByCharacter(e,t,i,r,n)},e.prototype.splitByLineBreakOrTab=function(e,t,i,r){var n=t.line.children.indexOf(t),o=t.text,a=o.substring(i),s="\t"===r?new te:new Q;if(s.line=t.line,s.characterFormat.copyFormat(t.characterFormat),t.line.children.splice(n+1,0,s),i>0&&1===a.length)s.text=o.substring(i),t.text=o.substring(0,i);else if(i>0){s.text=r;var l=new Q;l.line=t.line,l.text=o.substring(i+1),l.characterFormat.copyFormat(t.characterFormat),t.line.children.splice(n+2,0,l),t.text=o.substring(0,i)}else""!==a&&(s.text=o.substring(i+1),t.text=r)},e.prototype.moveToNextLine=function(e){var t=e.paragraph,i=t.paragraphFormat,r=e.isFirstLine(),n=e.isLastLine(),o=0,a=0,s=0,l=0,d=0,h=0;if(this.updateLineWidget(e),o=this.maxTextHeight,a=o-this.maxTextBaseline,r&&(l=this.getBeforeSpacing(t),h=W.convertPointToPixel(i.firstLineIndent)),n&&(s=W.convertPointToPixel(i.afterSpacing)),isNaN(this.maxTextHeight)){var c=this.viewer.textHelper.measureText("a",t.characterFormat);a=(o=c.Height)-c.BaselineOffset}else a=(o=this.maxTextHeight)-this.maxTextBaseline;d=this.getLineSpacing(t,o),"Exactly"===i.lineSpacingType&&d<a+this.maxBaseline&&(d=a+this.maxBaseline);var p=0,g=0,u=i.textAlignment;if("Left"!==u&&this.viewer.textWrap&&("Justify"!==u||!n)){var f=this.getSubWidth(e,"Justify"===u,g,h);p=f.subWidth,g=f.spaceCount}for(var m=!1,v=i.lineSpacingType,y=0;y<e.children.length;y++){var w=0,b=0,x=0,C=e.children[y],F=this.alignLineElements(C,w,b,a,m,p,u,g,y===e.children.length-1);w=F.topMargin,b=F.bottomMargin,m=F.addSubWidth,g=F.whiteSpaceCount,"Multiple"===v?d>o?b+=d-o:w+=d-o:"Exactly"===v?w+=d-(w+C.height+b):d>w+C.height+b&&(w+=d-(w+C.height+b)),w+=l,b+=s,0===y&&(e.height=w+C.height+b,"Right"===u?x=p:"Center"===u&&(x=p/2)),C.margin=new A(x,w,0,b),C.line=e}this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height)},e.prototype.updateLineWidget=function(e){for(var t=0;t<e.children.length;t++){var i=e.children[t];i instanceof Q||i instanceof ne?(this.maxTextHeight<i.height&&(this.maxTextHeight=i.height,this.maxTextBaseline=i.baselineOffset),this.maxBaseline<this.maxTextBaseline&&(this.maxBaseline=this.maxTextBaseline)):this.maxBaseline<i.height&&(this.maxBaseline=i.height)}},e.prototype.moveToNextPage=function(e,i,r){var n=i.paragraph,o=0;t.isNullOrUndefined(i)||((o=n.childWidgets.indexOf(i))>0||r)&&(n.height=e.clientActiveArea.y-n.y);var a=this.moveBlocksToNextPage(n);if(this.viewer.updateClientArea(a.sectionFormat,a.page),this.viewer.updateClientAreaForBlock(n,!0),o>0){if(i.isLastLine()&&r)return;var s=void 0;s=a.firstChild instanceof G&&a.firstChild.equals(n)?a.firstChild:new G,(s=this.addParagraphWidget(this.viewer.clientActiveArea,s)).index=n.index;for(var l=0,d=o;d<n.childWidgets.length;d++){var h=n.childWidgets[d];h.paragraph=s,s.childWidgets.splice(l,0,h),h.paragraph=s,l++}s.paragraphFormat=n.paragraphFormat,s.characterFormat=n.characterFormat,n.childWidgets.splice(o),n=s}else r||n.containerWidget.removeChild(n.indexInOwner);r||(-1===a.childWidgets.indexOf(n)&&a.childWidgets.splice(0,0,n),n.containerWidget=a,this.viewer.updateClientAreaLocation(n,this.viewer.clientActiveArea))},e.prototype.alignLineElements=function(e,i,r,n,o,a,s,l,d){if(e instanceof Q||e instanceof ne){var h=e instanceof Q?e:void 0,c=e instanceof Q?h.baselineOffset:e.baselineOffset;if(i+=this.maxBaseline-c,r+=n-(e.height-c),!t.isNullOrUndefined(h)&&"Justify"===s&&l>0){var p=h.width,g=h.text;if(o||(o=(g=W.trimStart(g)).length>0),o){var u=g.length-W.removeSpace(g).length;d&&(u-=g.length-W.trimEnd(g).length),l<u&&(p=this.viewer.textHelper.measureTextExcludingSpaceAtEnd(g,h.characterFormat),u=l),u>0&&(h.width=p+a*u,l-=u)}}}else o=!0,i+=this.maxBaseline-e.height,r+=n;return{topMargin:i,bottomMargin:r,addSubWidth:o,whiteSpaceCount:l}},e.prototype.updateWidgetToPage=function(e,i){if(i.isInsideTable){var r=i.associatedCell;if(i.height=e.clientActiveArea.y-i.y,t.isNullOrUndefined(i.associatedCell)||t.isNullOrUndefined(i.associatedCell.ownerRow)||t.isNullOrUndefined(i.associatedCell.ownerRow.rowFormat))return;"Exactly"===i.associatedCell.ownerRow.rowFormat.heightType?r.height=W.convertPointToPixel(i.associatedCell.ownerRow.rowFormat.height):[r].length<=1&&"AtLeast"===i.associatedCell.ownerRow.rowFormat.heightType?r.height=Math.max(W.convertPointToPixel(i.associatedCell.ownerRow.rowFormat.height),this.getCellContentHeight(r)):r.height=r.height+i.height,i.containerWidget=r}else i.isEndsWithPageBreak||(i.height=e.clientActiveArea.y-i.y);i.bodyWidget instanceof q&&(i.isInsideTable||(i.containerWidget.height+=i.height),this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer))},e.prototype.shiftFooterChildLocation=function(e,i){var r=e.page.bodyWidgets[0].sectionFormat.pageHeight;if(-1!==e.headerFooterType.indexOf("Footer")){var n,o=e.page.bodyWidgets[0].sectionFormat.footerDistance,a=W.convertPointToPixel(r-o);e.y+e.height>a?n=a-(e.y+e.height):e.y+e.height<a&&(n=e.y+e.height-a),t.isNullOrUndefined(n)||(n=a-(e.y+e.height),this.shiftChildLocation(n,e),i.clientActiveArea.y+=n)}},e.prototype.checkPreviousElement=function(e,t,i){e.paragraph;for(var r=!1,n=0,o=t-1;o>=0;o--){var a=e.children[o];if(a instanceof Q){var s=a.text;if(n=o,s.length>0&&" "===s[s.length-1]){if(o===t-1)return this.addSplittedLineWidget(e,t-1),!0;r=!0;break}if("\t"===s)return!1;if(s.indexOf(" ")>=0){r=!0;var l=s.lastIndexOf(" ")+1,d=new Q;d.text=s.substr(l),d.characterFormat.copyFormat(a.characterFormat),a.text=s.substr(0,l),this.viewer.textHelper.getTextSize(d,i),a.width-=d.width,a.height=d.height,0===a.width&&e.children.splice(o,1),e.children.splice(o+1,0,d);break}}else if(!(a instanceof ne)){n=o,r=!0;break}}if(r&&++n<e.children.length){for(var h=0,o=n;o<e.children.length;o++)h+=e.children[o].width,this.addSplittedLineWidget(e,o-1),o--;this.viewer.updateClientWidth(h)}return r},e.prototype.clearListElementBox=function(e){if(0!==e.childWidgets.length){var i=e.childWidgets[0];if(!t.isNullOrUndefined(i.children))for(var r=0;r<i.children.length&&i.children[r]instanceof ne;r++)i.children.splice(r,1),r--}},e.prototype.getListNumber=function(e){var i=this.viewer.getListById(e.listId),r=e.listLevelNumber,n=this.getListLevel(i,e.listLevelNumber);t.isNullOrUndefined(i.levelOverrides)||i.levelOverrides[r];return this.updateListValues(i,r),this.getListText(i,r,n)},e.prototype.getListStartValue=function(e,i){var r=t.isNullOrUndefined(i.levelOverrides)?void 0:i.levelOverrides[e];if(!t.isNullOrUndefined(r)&&t.isNullOrUndefined(r.overrideListLevel))return r.startAt;var n=this.getListLevel(i,e);return t.isNullOrUndefined(n)?0:n.startAt},e.prototype.updateListValues=function(e,t){if(this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(e.abstractListId))){var i=this.viewer.renderedLists.get(this.viewer.getAbstractListById(e.abstractListId));if(i.containsKey(t)){n=i.get(t);i.set(t,n+1);for(r=t+1;r<this.viewer.getAbstractListById(e.abstractListId).levels.length;){a=this.getListLevel(e,r);i.containsKey(r)&&a.restartLevel>t&&i.remove(r),r++}}else{for(var r=t;!i.containsKey(r-1)&&r>0;){a=this.getListLevel(e,r-1);i.add(r-1,this.getListStartValue(r-1,e)),r--}var n=this.getListStartValue(t,e);i.add(t,n)}}else{var o=new c;this.viewer.renderedLists.add(this.viewer.getAbstractListById(e.abstractListId),o);for(var a=this.getListLevel(e,t),s=0;s<=t;s++)o.add(s,this.getListStartValue(s,e))}},e.prototype.getListText=function(e,i,r){var n=r.numberFormat;if(this.viewer.renderedLists.containsKey(this.viewer.getAbstractListById(e.abstractListId)))for(var o=this.viewer.renderedLists.get(this.viewer.getAbstractListById(e.abstractListId)),a=o.keys,s=0;s<a.length;s++){var l=a[s],d="%"+(l+1).toString(),h=this.getListLevel(e,l);if(n.match(d)){if(l>i)return"";n=o.containsKey(l)&&!t.isNullOrUndefined(h)?n.replace(d,this.getListTextListLevel(h,o.get(l))):n.replace(d,"0")}}return n},e.prototype.getAsLetter=function(e){var t=e/26,i=e%26;0===i&&(i=26,t--);for(var r=String.fromCharCode(64+i),n="";t>=0;)n+=r.toString(),t--;return n},e.prototype.getListTextListLevel=function(e,t){switch(e.listLevelPattern){case"UpRoman":return this.getAsRoman(t).toUpperCase();case"LowRoman":return this.getAsRoman(t).toLowerCase();case"UpLetter":return this.getAsLetter(t).toUpperCase();case"LowLetter":return this.getAsLetter(t).toLowerCase();case"Arabic":return t.toString();case"LeadingZero":return this.getAsLeadingZero(t);case"Number":case"OrdinalText":case"Ordinal":case"FarEast":case"Special":return t.toString();default:return""}},e.prototype.generateNumber=function(e,t,i){for(var r="";e>=t;)e-=t,r+=i,this.value=e;return r.toString()},e.prototype.getAsLeadingZero=function(e){return e<10?"0"+e.toString():e.toString()},e.prototype.getAsRoman=function(e){var t="";return this.value=e,t+=this.generateNumber(this.value,1e3,"M"),t+=this.generateNumber(this.value,900,"CM"),t+=this.generateNumber(this.value,500,"D"),t+=this.generateNumber(this.value,400,"CD"),t+=this.generateNumber(this.value,100,"C"),t+=this.generateNumber(this.value,90,"XC"),t+=this.generateNumber(this.value,50,"L"),t+=this.generateNumber(this.value,40,"XL"),t+=this.generateNumber(this.value,10,"X"),t+=this.generateNumber(this.value,9,"IX"),t+=this.generateNumber(this.value,5,"V"),t+=this.generateNumber(this.value,4,"IV"),(t+=this.generateNumber(this.value,1,"I")).toString()},e.prototype.getListLevel=function(e,i){if(!t.isNullOrUndefined(e)){var r=this.viewer.getAbstractListById(e.abstractListId);!t.isNullOrUndefined(e)&&r.levels.length<=i&&i>=0&&i<9&&this.addListLevels(r);var n=void 0;if(!t.isNullOrUndefined(e.levelOverrides)&&!t.isNullOrUndefined(n=e.levelOverrides[i])&&!t.isNullOrUndefined(n.overrideListLevel))return n.overrideListLevel;if(!t.isNullOrUndefined(r)&&i>=0&&i<r.levels.length)return r.levels[i]}},e.prototype.getTabWidth=function(e,i,r,n,o){var a=0,s=!1,l=e.paragraphFormat.getUpdatedTabs();if(i.clientActiveArea.x<i.clientArea.x)return i.clientArea.x-i.clientActiveArea.x;var d=i.clientActiveArea.x-(i.clientArea.x-W.convertPointToPixel(e.paragraphFormat.leftIndent)),h=W.convertPointToPixel(i.defaultTabWidth);if(0!==l.length||0!==d&&0!==h){if(l.length>0)for(var c=0;c<l.length;c++){var p=W.convertPointToPixel(l[c].position);if("Left"===l[c].tabJustification&&d<p){a=p,s=!0,t.isNullOrUndefined(o)||(o.tabLeader=l[c].tabLeader,o.tabText="");break}if("Right"===l[c].tabJustification&&d<p){var g=p-d,u=this.getRightTabWidth(r+1,n,e);h=u<g?g-u:0,a=d,s=!0,t.isNullOrUndefined(o)||(o.tabLeader=l[c].tabLeader,o.tabText="");break}}if(!s){var f=100*Math.round(d)%(100*Math.round(h))/100;a=((Math.round(d)-f)/Math.round(h)+1)*h}return a-d>0?a-d:h}return h},e.prototype.getRightTabWidth=function(e,t,i){for(var r=0,n=!1;e<t.children.length;){var o=t.children[e];if(o instanceof $||o instanceof ie||n?(o instanceof $&&(0===o.fieldType?n=!0:2===o.fieldType&&(n=!1)),o.width=0):this.viewer.textHelper.getTextSize(o,o.characterFormat),o instanceof Q&&"\t"===o.text)return r;r+=o.width,e++}return r},e.prototype.getSplitIndexByWord=function(e,t,i,r){for(var n=0,o=t.length;n<o;){var a=this.getTextIndexAfterSpace(t,n);0!==a&&a!==o||(a=o-1);var s=i;if((a<o-1||a===o-1&&" "===t[a-1])&&n!==a&&(s=this.viewer.textHelper.measureTextExcludingSpaceAtEnd(t.slice(0,a),r)),!(s<=e)){0===n&&" "===t[0]&&(n=this.getTextIndexAfterSpace(t,0));break}n=a}return n},e.prototype.getTextSplitIndexByCharacter=function(e,t,i,r,n){for(var o=i.length,a=0;a<o;a++){var s=r;if(a+1<o&&(s=this.viewer.textHelper.measureTextExcludingSpaceAtEnd(i.substring(0,a+1),n)),s>t)return 0===a&&s>e?o>1&&" "===i[1]?this.getTextIndexAfterSpace(i,1):1:a}return 0},e.prototype.getSubWidth=function(e,t,i,r){for(var n=0,o=!0,a="",s=e.children.length-1;s>=0;s--){var l=e.children[s];if(l instanceof Q){var d=l.text;a=d+a,!o||""===d.trim()&&"\t"!==d?o||(n+=l.width):(W.endsWith(d)?n+=this.viewer.textHelper.measureTextExcludingSpaceAtEnd(d,l.characterFormat):n+=l.width,o=!1)}else a="a"+a,o=!1,n+=l.width;t||(n=Math.round(n))}i=(a=a.trim()).length-W.removeSpace(a).length;var h=this.viewer.clientArea.width-r-n;return h<=0||0===i&&t?(i=0,h=0):t&&(h/=i),{subWidth:h,spaceCount:i}},e.prototype.getBeforeSpacing=function(e){var t=0;return e.previousWidget instanceof G?e.previousWidget.paragraphFormat.afterSpacing<e.paragraphFormat.beforeSpacing&&(t=e.paragraphFormat.beforeSpacing-e.previousWidget.paragraphFormat.afterSpacing):t=e.paragraphFormat.beforeSpacing,t},e.prototype.getLineSpacing=function(e,i){if(t.isNullOrUndefined(e.paragraphFormat))return 0;var r=0;switch(e.paragraphFormat.lineSpacingType){case"AtLeast":case"Exactly":r=e.paragraphFormat.lineSpacing;break;default:r=e.paragraphFormat.lineSpacing*i}return r},e.prototype.isParagraphFirstLine=function(e,i){var r=e;return!(!t.isNullOrUndefined(r.childWidgets)&&0!==r.childWidgets.indexOf(i))&&(!(i.children.length>0&&!t.isNullOrUndefined(e.previousWidget)&&e.previousWidget instanceof G)||i.paragraph.index!==e.previousWidget.index)},e.prototype.isParagraphLastLine=function(e){var t=e.line.paragraph,i=t.childWidgets[t.childWidgets.length-1],r=i.children[i.children.length-1];return e===r&&(r instanceof $||!(r instanceof Q&&"\v"===r.text))},e.prototype.getTextIndexAfterSpace=function(e,t){var i=e.length,r=0,n=r=e.indexOf(" ",t)+1;if(0===n||n===i)return n;for(;" "===e[n]&&++n!==i;);return n},e.prototype.moveNextWidgetsToTable=function(e,t,i){var r=i?t[t.length-2]:t[t.length-1],n=r.indexInOwner,o=e[e.length-1];i&&(n+=1);for(var a=r.containerWidget.childWidgets.splice(n),s=0;s<a.length;s++)o.childWidgets.push(a[s]),a[s].containerWidget=o},e.prototype.addTableCellWidget=function(e,i,r,n){var o=0,a=0,s=0,l=r,d=0,h=n;t.isNullOrUndefined(e.cellFormat)||(e.cellFormat.containsMargins()?(s=t.isNullOrUndefined(e.cellFormat.leftMargin)?W.convertPointToPixel(e.ownerTable.tableFormat.leftMargin):W.convertPointToPixel(e.cellFormat.leftMargin),d=t.isNullOrUndefined(e.cellFormat.rightMargin)?W.convertPointToPixel(e.ownerTable.tableFormat.rightMargin):W.convertPointToPixel(e.cellFormat.rightMargin)):(s=W.convertPointToPixel(e.ownerTable.tableFormat.leftMargin),d=W.convertPointToPixel(e.ownerTable.tableFormat.rightMargin))),e.margin=new A(s,l,d,h),e.width=W.convertPointToPixel(e.cellFormat.cellWidth),t.isNullOrUndefined(e.previousWidget)||(o=e.previousWidget.columnIndex+e.previousWidget.cellFormat.columnSpan),a=t.isNullOrUndefined(e.ownerTable)||t.isNullOrUndefined(e.ownerTable.tableFormat)?0:W.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing);var c=0;return o<e.columnIndex&&(c=W.convertPointToPixel(e.ownerTable.tableHolder.getPreviousSpannedCellWidth(o,e.columnIndex)),0===o&&(c-=a/2)),e.x=i.x+c+e.margin.left,e.y=i.y+e.margin.top+a,e.width=e.width-e.margin.left-e.margin.right,a>0&&(e.x+=a,1===e.ownerTable.tableHolder.columns.length?e.width-=2*a:0===e.columnIndex||e.columnIndex===e.ownerTable.tableHolder.columns.length-1?e.width-=2*a-a/2:e.width-=a),e.leftBorderWidth=W.convertPointToPixel(Y.getCellLeftBorder(e).getLineWidth()),e.x+=e.leftBorderWidth,e.width-=e.leftBorderWidth,(a>0||e.cellIndex===e.ownerRow.childWidgets.length-1)&&(e.rightBorderWidth=Y.getCellRightBorder(e).getLineWidth(),e.width-=e.rightBorderWidth),e.margin.left=e.margin.left+e.leftBorderWidth,e.margin.right=e.margin.right+e.rightBorderWidth,e},e.prototype.addWidgetToTable=function(e,i,r,n,o){var a=i[0],s=a.childWidgets.length,l=void 0,d=r.indexOf(n);if(d>0?l=r[d-1]:n.previousRenderedWidget instanceof X&&n.previousRenderedWidget.ownerTable.equals(n.ownerTable)&&(l=n.previousRenderedWidget),!t.isNullOrUndefined(l)){if(a=l.containerWidget,s=a.childWidgets.indexOf(l)+1,Math.round(n.y)!==Math.round(l.y+l.height)){var h=i.indexOf(a);h+1>=i.length&&this.addTableWidget(e.clientActiveArea,i,!0),s=(a=i[h+1]).childWidgets.length}d>0&&(s=0)}this.updateRowHeightBySpannedCell(a,n,s),this.updateRowHeightByCellSpacing(i,n,e),n.containerWidget&&n.containerWidget!==a&&-1!==n.containerWidget.childWidgets.indexOf(n)&&n.containerWidget.childWidgets.splice(n.containerWidget.childWidgets.indexOf(n),1),-1===a.childWidgets.indexOf(n)&&a.childWidgets.splice(s,0,n),n.containerWidget=a,a.height=a.height+n.height,t.isNullOrUndefined(a.containerWidget)||!(a.containerWidget.childWidgets.indexOf(a)>=0)||a.containerWidget instanceof q||(a.containerWidget.height+=n.height),this.updateHeightForRowWidget(e,!1,i,r,n,!1,o),e.cutFromTop(n.y+n.height)},e.prototype.updateRowHeightBySpannedCell=function(e,i,r){var n=1;if(0===e.childWidgets.length||0===r)return void this.updateRowHeight(i,i);for(a=0;a<i.childWidgets.length;a++){var o=i.childWidgets[a];n=t.isNullOrUndefined(o)||t.isNullOrUndefined(o.cellFormat)?n:o.cellFormat.rowSpan,this.updateSpannedRowCollection(n,i)}if(!t.isNullOrUndefined(i.ownerTable))for(var a=0;a<i.ownerTable.spannedRowCollection.length;a++)if(i.ownerTable.spannedRowCollection.keys[a]===i.index){for(var s=0;s<r;s++){var l=e.childWidgets[s];this.updateRowHeight(l,i)}i.ownerTable.spannedRowCollection.remove(i.ownerTable.spannedRowCollection.keys[a]);break}},e.prototype.updateRowHeight=function(e,i){for(var r=i.index,n=1,o=0;o<e.childWidgets.length;o++){var a=e.childWidgets[o];if(n=t.isNullOrUndefined(a)||t.isNullOrUndefined(a.cellFormat)?n:a.cellFormat.rowSpan,this.updateSpannedRowCollection(n,i),r-a.rowIndex==n-1){var s=a.y+a.height+a.margin.bottom-i.y;i.height<s&&(i.height=s)}}},e.prototype.updateSpannedRowCollection=function(e,i){e>1&&!t.isNullOrUndefined(i.ownerTable)&&(i.ownerTable.spannedRowCollection.containsKey(i.index+e-1)||i.ownerTable.spannedRowCollection.add(i.index+e-1,i.index))},e.prototype.updateRowHeightByCellSpacing=function(e,t,i){t.ownerTable.tableFormat.cellSpacing>0&&e.length>1&&t.y===i.clientArea.y&&i instanceof ve&&(t.height=t.height-W.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing)/2)},e.prototype.isRowSpanEnd=function(e,i){for(var r=e.index,n=1,o=0;o<i.splittedCellWidgets.length;o++){var a=i.splittedCellWidgets[o];if(n=t.isNullOrUndefined(a)||t.isNullOrUndefined(a.cellFormat)?n:a.cellFormat.rowSpan,r-a.rowIndex==n-1)return!0}return!1},e.prototype.isVerticalMergedCellContinue=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i];if(t<r.columnIndex)return!0;t+=r.cellFormat.columnSpan}return t<e.ownerTable.tableHolder.columns.length},e.prototype.splitWidgets=function(e,t,i,r,n,o){if(this.isFirstLineFitForRow(t.clientArea.bottom,e)&&e.childWidgets.length>0){if(n=this.getSplittedWidgetForRow(t.clientArea.bottom,i,r,e),t.splittedCellWidgets.length>0||n!==e){if(o)for(var a=0;a<n.childWidgets.length;a++)n.childWidgets[a].rowIndex!==n.index&&(n.childWidgets.splice(a,1),a--);this.insertSplittedCellWidgets(t,i,n,e.indexInOwner-1)}}else this.insertSplittedCellWidgets(t,i,n,e.indexInOwner-1);return n},e.prototype.getSplittedWidgetForRow=function(e,i,r,n){for(var o=void 0,a=n.index,s=0;s<n.childWidgets.length;s++){var l=n.childWidgets[s],d=this.getSplittedWidget(e,!0,i,r,l);if(!t.isNullOrUndefined(d)){if(d===l)return n;-1!==n.childWidgets.indexOf(d)&&n.childWidgets.splice(n.childWidgets.indexOf(d),1),(0===s||n.height<l.height+l.margin.top+l.margin.bottom)&&(n.height=l.height+l.margin.top+l.margin.bottom),t.isNullOrUndefined(o)&&((o=new X).containerWidget=n.containerWidget,o.index=n.index,o.rowFormat=n.rowFormat,this.updateWidgetLocation(n,o),o.height=0,r.push(o));var h=1;h=t.isNullOrUndefined(d)||t.isNullOrUndefined(d.cellFormat)?h:d.cellFormat.rowSpan,a-d.rowIndex==h-1&&o.height<d.height+d.margin.top+d.margin.bottom&&(o.height=d.height+d.margin.top+d.margin.bottom),o.childWidgets.push(d),d.containerWidget=o}}return o},e.prototype.updateWidgetsToTable=function(e,i,r){var n=this.getRowHeight(r,[r]),o=this.viewer,a=r.rowFormat.isHeader,s=r.rowFormat.allowBreakAcrossPages,l=r.rowFormat.heightType,d=0,h=0,c=r,p=!1;r.ownerTable.continueHeader&&!a&&(r.ownerTable.continueHeader=!1);var g=!1;for(d=t.isNullOrUndefined(r.ownerTable)||t.isNullOrUndefined(r.ownerTable.tableFormat)?0:W.convertPointToPixel(r.ownerTable.tableFormat.cellSpacing);h<i.length;){if(h=i.length,r.ownerTable.isInsideTable||0===o.splittedCellWidgets.length&&c.y+c.height+d<=o.clientArea.bottom)this.addWidgetToTable(o,e,i,c),o.splittedCellWidgets.length>0&&t.isNullOrUndefined(i[i.length-1].nextRow)&&(h--,g=!0);else{if(o.splittedCellWidgets.length>0&&c.y+c.height<=o.clientArea.bottom&&!this.isRowSpanEnd(r,o)){this.isVerticalMergedCellContinue(r)&&c.y==o.clientArea.y&&this.insertSplittedCellWidgets(o,e,c,c.indexInOwner-1),this.addWidgetToTable(o,e,i,c);continue}var u=c,f=e[e.length-1];if(n+c.y>o.clientArea.bottom)if(!s||a&&r.ownerTable.continueHeader||"AtLeast"===l&&W.convertPointToPixel(r.rowFormat.height)<o.clientArea.bottom){if(("AtLeast"===l&&W.convertPointToPixel(r.rowFormat.height)<o.clientActiveArea.height&&s||"Exactly"!==l&&c.y===o.clientArea.y||"Auto"===l&&s)&&(u=this.splitWidgets(c,o,e,i,u,g)),"Exactly"===l&&c.y===o.clientArea.y&&(this.addWidgetToTable(o,e,i,c),h++),a&&r.ownerTable.continueHeader){r.ownerTable.header=!1,r.ownerTable.continueHeader=!1,r.ownerTable.headerHeight=0;P=void 0;if(P=o.pages,!t.isNullOrUndefined(P))for(T=0;T<P.length;T++)P[T].repeatHeaderRowTableWidget&&(P[T].repeatHeaderRowTableWidget=!1)}}else"Auto"!==l&&"AtLeast"!==l||!s?"Exactly"===l&&c.y===o.clientArea.y&&(this.addWidgetToTable(o,e,i,c),h++):W.convertPointToPixel(r.rowFormat.height)>o.clientArea.bottom&&c.y!==o.clientArea.y||(u=this.splitWidgets(c,o,e,i,u,g));else{var m=!1;this.isVerticalMergedCellContinue(r)&&(s||(m=c.y==o.clientArea.y))?m?this.insertSplittedCellWidgets(o,e,u,c.indexInOwner-1):u=this.splitWidgets(c,o,e,i,u,g):g&&!s&&(u=this.splitWidgets(c,o,e,i,u,g))}if(!t.isNullOrUndefined(u)){if(u!==c)this.addWidgetToTable(o,e,i,c,c.nextRow),this.updateWidgetsToPage(e,i,r.ownerTable,c.nextRow),e.indexOf(c.containerWidget)+1>=e.length&&this.addTableWidget(o.clientActiveArea,e,!0),c=u;else{if(r.index>0)if(this.updateWidgetsToPage(e,i,r.ownerTable,r),r.previousRenderedWidget instanceof X){var v=r.previousRenderedWidget;W.round(c.y,2)===W.round(v.y+v.height,2)?e.indexOf(v.containerWidget)+1>=e.length&&this.addTableWidget(o.clientActiveArea,e,!0):this.addTableWidget(o.clientActiveArea,e,!0)}else this.addTableWidget(o.clientActiveArea,e,!0);p=!0,h--}f=e[e.length-1];var y=void 0;y=e.length>1?e[e.length-2].containerWidget:r.ownerTable.previousRenderedWidget.containerWidget;t.isNullOrUndefined(y)||o.pages.indexOf(y.page);r.ownerTable.containerWidget.index;var w=void 0,b=void 0;b=p&&1===e.length?e[e.length-1]:e[e.length-2],w=this.moveBlocksToNextPage(b);var x=e[e.length-1];if(p&&0===r.index&&x.containerWidget&&-1!==x.containerWidget.childWidgets.indexOf(x)&&x.containerWidget.childWidgets.splice(x.containerWidget.childWidgets.indexOf(x),1),-1!==w.childWidgets.indexOf(x)&&w.childWidgets.splice(w.childWidgets.indexOf(x),1),w.childWidgets.unshift(x),x.containerWidget=w,(p&&r.index>0||i.length>1)&&this.moveNextWidgetsToTable(e,i,!p),p=!1,r.ownerTable.header&&c.height<o.clientArea.bottom){o.currentRenderingPage.repeatHeaderRowTableWidget=!0,o.updateClientAreaForBlock(r.ownerTable,!0,e),u.x=u.x,u.y=f.y+r.ownerTable.headerHeight;C=d/2;this.updateChildLocationForRow(f.y+r.ownerTable.headerHeight-C,u)}else{o.updateClientAreaForBlock(r.ownerTable,!0,e),u.x=u.x,u.y=f.y;var C=d/2;this.updateChildLocationForRow(f.y-C,u)}}g=!1}if(a&&r.ownerTable.continueHeader&&(r.ownerTable.header=!0,r.ownerTable.headerHeight=n+r.ownerTable.headerHeight),a&&!t.isNullOrUndefined(this.getHeader(r.ownerTable))&&r.index===this.getHeader(r.ownerTable).index){var F=this.getHeaderHeight(r.ownerTable,r,i);if((F>r.ownerTable.headerHeight||F>r.ownerTable.headerHeight)&&(r.ownerTable.headerHeight=F),r.ownerTable.headerHeight>o.clientArea.height){r.ownerTable.header=!1,r.ownerTable.continueHeader=!1,r.ownerTable.headerHeight=0;for(var P=o.pages,T=0;T<P.length;T++)P[T].repeatHeaderRowTableWidget&&(P[T].repeatHeaderRowTableWidget=!1)}}e.length>2&&r.ownerTable.header&&c.height<o.clientActiveArea.bottom&&!o.currentRenderingPage.repeatHeaderRowTableWidget&&(o.currentRenderingPage.repeatHeaderRowTableWidget=!0)}},e.prototype.getHeader=function(e){var t=void 0,i=!0;e=e.getSplitWidgets()[0];for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n.rowFormat.isHeader?t=n:i=!1,!i)break}return t},e.prototype.getHeaderHeight=function(e,t,i){var r=0;if(t.ownerTable.childWidgets.length>0&&e.childWidgets[0].rowFormat.isHeader)for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(!o.rowFormat.isHeader)break;r+=this.getRowHeight(o,i)}return r},e.prototype.updateWidgetToRow=function(e){this.viewer;var i=e.ownerRow;i.x;if(i.childWidgets.length>0){var r=i.childWidgets[i.childWidgets.length-1];r.x+r.width+r.margin.right}if(e.containerWidget=i,!t.isNullOrUndefined(e.ownerRow)&&"Exactly"!==e.ownerRow.rowFormat.heightType&&W.convertPointToPixel(e.ownerRow.rowFormat.height)>0&&0===e.cellIndex&&(i.height=i.height+W.convertPointToPixel(e.ownerRow.rowFormat.height)),1===e.cellFormat.rowSpan){var n=e.height+e.margin.top+e.margin.bottom;i.height-W.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing)<n&&(i.height=n+W.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))}},e.prototype.updateHeightForRowWidget=function(e,t,i,r,n,o,a){for(var s=0;s<n.childWidgets.length;s++){var l=0,d=void 0,h=1;if(h=(d=n.childWidgets[s]).cellFormat.rowSpan,l=W.convertPointToPixel(d.ownerTable.tableFormat.cellSpacing),h>1){var c=n.containerWidget.childWidgets.indexOf(n),p=c+h-1-(n.index-d.rowIndex);(e.clientArea.bottom<d.y+d.height+d.margin.bottom||p>=c+1)&&this.splitSpannedCellWidget(d,i,r,e);var g=n;if(p>0)if(p<n.containerWidget.childWidgets.length){var u=n.containerWidget.childWidgets[p];u instanceof X&&(g=u)===a&&(g=n)}else g=n.containerWidget.childWidgets[n.containerWidget.childWidgets.length-1];d.y+d.height+d.margin.bottom<g.y+g.height?d.height=g.y+g.height-d.y-d.margin.bottom:o&&g&&0!==g.y&&0!==g.height&&d.y+d.height+d.margin.bottom>g.y+g.height&&(g.height=d.y+d.height+d.margin.bottom-g.y)}else l>0&&i.length>1&&n.y===e.clientArea.y&&e instanceof ve&&(l/=2),d.height=n.height-d.margin.top-d.margin.bottom-l;this.updateHeightForCellWidget(e,i,r,d);for(var f=n.containerWidget;f.containerWidget instanceof z;)f=f.containerWidget;var m=void 0;f instanceof V&&(m=f.page),(e instanceof ve&&-1!==e.visiblePages.indexOf(m)||t)&&this.updateCellVerticalPosition(d,!1,!1)}},e.prototype.updateHeightForCellWidget=function(e,t,i,r){for(var n=0;n<r.childWidgets.length;n++)r.childWidgets[n]instanceof K&&this.updateHeightForTableWidget(t,i,r.childWidgets[n])},e.prototype.getRowHeight=function(e,t){var i=0;if("Exactly"===e.rowFormat.heightType)i=e.rowFormat.height;else{for(var r=0;r<t.length;r++)t[r]instanceof X&&(i=t[r].height+i);i=Math.max(i,e.rowFormat.height)}return i},e.prototype.splitSpannedCellWidget=function(e,i,r,n){var o=this.getSplittedWidget(n.clientArea.bottom,!1,i,r,e);t.isNullOrUndefined(o)||n.splittedCellWidgets.push(o)},e.prototype.insertSplittedCellWidgets=function(e,i,r,n){var o=r.x,a=0;a=W.convertPointToPixel(r.ownerTable.tableHolder.tableWidth);for(var s=0;s<r.childWidgets.length;s++){var l=r.childWidgets[s];if(Math.round(o)<Math.round(l.x-l.margin.left)){if(this.insertRowSpannedWidget(r,e,o,s)){s--;continue}var d=r.childWidgets.length;if(this.insertEmptySplittedCellWidget(r,i,o,s,n),d<r.childWidgets.length){s--;continue}}if(o+=l.margin.left+l.width+l.margin.right,s===r.childWidgets.length-1&&Math.round(o)<Math.round(r.x+a)){if(this.insertRowSpannedWidget(r,e,o,s+1))continue;this.insertEmptySplittedCellWidget(r,i,o,s+1,n)}else;}if((t.isNullOrUndefined(r.childWidgets)||0===r.childWidgets.length)&&e.splittedCellWidgets.length>0)for(var h=0;h<e.splittedCellWidgets.length;h++){var c=e.splittedCellWidgets[h];if(Math.round(o)<=Math.round(c.x-c.margin.left)){if(this.insertRowSpannedWidget(r,e,o,h)){h--;continue}var p=r.childWidgets.length;if(this.insertEmptySplittedCellWidget(r,i,o,h,n),p<r.childWidgets.length){h--;continue}}if(o+=c.margin.left+c.width+c.margin.right,h===r.childWidgets.length-1&&Math.round(o)<Math.round(r.x+a)){if(this.insertRowSpannedWidget(r,e,o,h+1))continue;this.insertEmptySplittedCellWidget(r,i,o,h+1,n)}else;}e.splittedCellWidgets.length>0&&(e.splittedCellWidgets=[])},e.prototype.insertRowSpannedWidget=function(e,t,i,r){var n=0;e.ownerTable.tableFormat.cellSpacing>0&&(n=W.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing));for(var o=0;o<t.splittedCellWidgets.length;o++){var a=t.splittedCellWidgets[o];if(Math.round(i)===Math.round(a.x-a.margin.left))return e.childWidgets.splice(r,0,a),a.containerWidget=e,a.y!==e.y+a.margin.top+n&&this.updateChildLocationForRow(e.y,e),t.splittedCellWidgets=[],!0}return!1},e.prototype.insertEmptySplittedCellWidget=function(e,i,r,n,o){for(var a=i[i.length-1],s=o;s>=0;s--)for(var l=a.childWidgets[s],d=l.x,h=0;h<l.childWidgets.length;h++){var c=1,p=l.childWidgets[h];if(Math.round(r)===Math.round(d)){if((c=t.isNullOrUndefined(p)||t.isNullOrUndefined(p.cellFormat)?c:p.cellFormat.rowSpan)>1){var g=this.createCellWidget(p);e.childWidgets.splice(n,0,g),g.containerWidget=e}return}d+=p.margin.left+p.width+p.margin.right}},e.prototype.getSplittedWidget=function(e,i,r,n,o){var a=void 0;if(o.y+o.height>e-o.margin.bottom)for(var s=0;s<o.childWidgets.length;s++)if(o.childWidgets[s]instanceof G){var l=o.childWidgets[s],d=this.getSplittedWidgetForPara(e-o.margin.bottom,l);if(!t.isNullOrUndefined(d)){if(0===s&&d===l)return o;-1!==o.childWidgets.indexOf(d)&&(o.childWidgets.splice(o.childWidgets.indexOf(d),1),s--),o.height-=d.height,t.isNullOrUndefined(a)&&(a=this.createCellWidget(o)),a.height+=d.height,a.childWidgets.push(d),d.containerWidget=a}}else{var h=o.childWidgets[s],c=[h];if(e-o.margin.bottom<h.y+h.height){var p=h.height,g=this.getSplittedWidgetForTable(e-o.margin.bottom,c,h);if(!t.isNullOrUndefined(g)){if(0===s&&g===h)return o;-1!==o.childWidgets.indexOf(g)?(o.childWidgets.splice(o.childWidgets.indexOf(g),1),s--,o.height-=g.height):o.height-=p-h.height,t.isNullOrUndefined(a)&&(a=this.createCellWidget(o)),a.height+=g.height,a.childWidgets.push(g),g.containerWidget=a}}}return t.isNullOrUndefined(a)&&i&&(a=this.createCellWidget(o)),a},e.prototype.getListLevelPattern=function(e){switch(e){case 0:return"Arabic";case 1:return"UpRoman";case 2:return"LowRoman";case 3:return"UpLetter";case 4:return"LowLetter";case 5:return"Ordinal";case 6:return"Number";case 7:return"OrdinalText";case 8:return"LeadingZero";case 9:return"Bullet";case 10:return"FarEast";case 11:return"Special";default:return"None"}},e.prototype.createCellWidget=function(e){var t=new Y;return t.cellFormat=e.cellFormat,t.index=e.index,t.rowIndex=e.rowIndex,t.columnIndex=e.columnIndex,t.containerWidget=e.containerWidget,this.updateWidgetLocation(e,t),t.margin=e.margin,t.leftBorderWidth=W.convertPointToPixel(e.leftBorderWidth),t.rightBorderWidth=W.convertPointToPixel(e.rightBorderWidth),t},e.prototype.createTableWidget=function(e){var t=new K;return e.header&&(t.header=e.header,t.headerHeight=e.headerHeight),t.index=e.index,t.tableFormat=e.tableFormat,t.tableHolder=e.tableHolder,t.isGridUpdated=e.isGridUpdated,t},e.prototype.getSplittedWidgetForPara=function(e,i){for(var r=i.y,n=void 0,o=0;o<i.childWidgets.length;o++){var a=i.childWidgets[o];if(e<r+a.height){if(0===o){if(a.paragraph.containerWidget instanceof Y&&a.paragraph.containerWidget.y===i.y){r+=a.height;continue}n=i;break}-1!==i.childWidgets.indexOf(a)&&(i.childWidgets.splice(i.childWidgets.indexOf(a),1),o--),i.height-=a.height,t.isNullOrUndefined(n)?((n=new G).characterFormat=i.characterFormat,n.paragraphFormat=i.paragraphFormat,n.index=i.index,this.updateWidgetLocation(i,n),n.height=a.height):n.height+=a.height,n.childWidgets.push(a),a.paragraph=n}r+=a.height}return n},e.prototype.getSplittedWidgetForTable=function(e,i,r){for(var n=r.y,o=void 0,a=0;a<r.childWidgets.length;a++){var s=void 0,l=(s=r.childWidgets[a]).height;if(e<n+l||!t.isNullOrUndefined(o)){var d=void 0,h=!0;if(t.isNullOrUndefined(s)||t.isNullOrUndefined(s.rowFormat)||(h=s.rowFormat.allowBreakAcrossPages),h&&(d=t.isNullOrUndefined(o)&&this.isFirstLineFitForRow(e,s)?this.getSplittedWidgetForRow(e,i,[s],s):s),!t.isNullOrUndefined(d)){if(0===a&&d===s)return r;-1!==r.childWidgets.indexOf(d)?(r.childWidgets.splice(r.childWidgets.indexOf(d),1),a--,r.height-=d.height):r.height-=l-s.height,t.isNullOrUndefined(o)?(o=this.createTableWidget(r),this.updateWidgetLocation(r,o),o.height=d.height):o.height+=d.height,o.childWidgets.push(d),d.containerWidget=o}}n+=s.height}return o},e.prototype.isFirstLineFitForPara=function(e,i){var r=i.childWidgets[0],n=r.paragraph.containerWidget;if(this.viewer.isFirstLineFitInShiftWidgets){if(this.viewer.clientActiveArea.y===this.viewer.clientArea.y&&i.y+r.height>=e)return!0}else if(n.ownerTable.isInsideTable){var o=void 0;if(n.containerWidget instanceof X&&n.containerWidget.containerWidget instanceof K&&n.containerWidget.containerWidget.containerWidget instanceof Y&&(o=n.containerWidget.containerWidget.containerWidget),!t.isNullOrUndefined(o)&&n.containerWidget.y===o.y&&i.y+r.height>=e)return!0}else if(n.containerWidget.y===this.viewer.clientArea.y&&i.y+r.height>=e)return!0;return i.y+r.height<=e},e.prototype.isFirstLineFitForTable=function(e,i){var r=void 0,n=!1;return r=i.childWidgets[0],t.isNullOrUndefined(r)||(n=this.isFirstLineFitForRow(e,r)),n},e.prototype.isFirstLineFitForRow=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];if(!this.isFirstLineFitForCell(e,r))return!1}return!0},e.prototype.isFirstLineFitForCell=function(e,t){if(0===t.childWidgets.length)return!0;if(t.childWidgets[0]instanceof G){var i=t.childWidgets[0];return this.isFirstLineFitForPara(e-t.margin.bottom,i)}var r=t.childWidgets[0];return this.isFirstLineFitForTable(e-t.margin.bottom,r)},e.prototype.updateWidgetLocation=function(e,t){t.x=e.x,t.y=e.y,t.width=e.width},e.prototype.updateChildLocationForTable=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];r.x=r.x,r.y=e,this.updateChildLocationForRow(e,r),e+=r.height}},e.prototype.updateChildLocationForRow=function(e,t){var i=0;t.ownerTable.tableFormat.cellSpacing>0&&(i=W.convertPointToPixel(t.ownerTable.tableFormat.cellSpacing));for(var r=0;r<t.childWidgets.length;r++){var n=t.childWidgets[r];n.x=n.x,n.y=e+n.margin.top+i,this.updateChildLocationForCell(n.y,n)}},e.prototype.updateChildLocationForCell=function(e,t){for(var i=0;i<t.childWidgets.length;i++)t.childWidgets[i].x=t.childWidgets[i].x,t.childWidgets[i].y=e,t.childWidgets[i]instanceof K&&this.updateChildLocationForTable(e,t.childWidgets[i]),e+=t.childWidgets[i].height},e.prototype.updateCellVerticalPosition=function(e,t,i){if(e.ownerTable.containerWidget instanceof V||i){var r=this.getDisplacement(e,t);this.updateCellContentVerticalPosition(e,r,t)}},e.prototype.updateCellContentVerticalPosition=function(e,t,i){if(0!==t)for(var r=e.y+t,n=0;n<e.childWidgets.length;n++)e.childWidgets[n]instanceof G?e.childWidgets[n].y=r:r=this.updateTableWidgetLocation(e.childWidgets[n],r,i),r+=e.childWidgets[n].height},e.prototype.updateTableWidgetLocation=function(e,t,i){e.y=t+=e.topBorderWidth;for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];n.y=t;for(var o=0;o<n.childWidgets.length;o++){var a=n.childWidgets[o];a.y=t+a.margin.top+0,this.updateCellVerticalPosition(a,i,!0)}t+=n.height}return t},e.prototype.getDisplacement=function(e,i){var r=0,n=e.containerWidget,o=e.margin.top+e.margin.bottom;r=!t.isNullOrUndefined(e.cellFormat)&&e.cellFormat.rowSpan>1?e.height:(t.isNullOrUndefined(n)?0:n.height)-o;var a=this.getCellContentHeight(e),s=0;return r>a&&(s=r-a,"Center"===e.cellFormat.verticalAlignment?s/=2:("Top"===e.cellFormat.verticalAlignment||i)&&(s=0)),s},e.prototype.getCellContentHeight=function(e){if(t.isNullOrUndefined(e.childWidgets))return 0;for(var i=0,r=0;r<e.childWidgets.length;r++)e.childWidgets[r],i+=e.childWidgets[r].height;return i},e.prototype.getTableLeftBorder=function(e){if(t.isNullOrUndefined(e.left)){var i=new k(e);return i.lineStyle="Single",i.lineWidth=.66,i}return e.left},e.prototype.getTableRightBorder=function(e){if(t.isNullOrUndefined(e.right)){var i=new k(e);return i.lineStyle="Single",i.lineWidth=.66,i}return e.right},e.prototype.getTableTopBorder=function(e){if(t.isNullOrUndefined(e.top)){var i=new k(e);return i.lineStyle="Single",i.lineWidth=.66,i}return e.top},e.prototype.getTableBottomBorder=function(e){if(t.isNullOrUndefined(e.bottom)){var i=new k(e);return i.lineStyle="Single",i.lineWidth=.66,i}return e.bottom},e.prototype.getCellDiagonalUpBorder=function(e){var t=void 0;return t=e.cellFormat.borders,t.diagonalUp},e.prototype.getCellDiagonalDownBorder=function(e){var t=void 0;return t=e.cellFormat.borders,t.diagonalDown},e.prototype.getTableWidth=function(e){for(var t=0,i=0;i<e.childWidgets.length;i++){for(var r=e.childWidgets[i],n=0,o=0;o<r.childWidgets.length;o++){var a=r.childWidgets[o];n+=W.convertPointToPixel(a.cellFormat.cellWidth)}t<n&&(t=n)}return t},e.prototype.layoutNextItemsBlock=function(e,i){var r=e.bodyWidget.sectionIndex,n=e,o=n.getSplitWidgets(),a=o[o.length-1].nextRenderedWidget;(t.isNullOrUndefined(a)||this.viewer.blockToShift===n)&&(this.viewer.blockToShift=void 0);for(var s=!0;a instanceof j&&a.bodyWidget.sectionIndex===r;){var l=void 0,d=n.getSplitWidgets();l=d[d.length-1],n=a,i.blockToShift===n&&(i.blockToShift=void 0),s=!1;var h=void 0;if(h=n.getSplitWidgets()[0],0===i.fieldStacks.length&&!t.isNullOrUndefined(h)&&l.containerWidget===h.containerWidget&&W.round(h.y,2)===W.round(l.y+l.height,2)){if(!t.isNullOrUndefined(i.blockToShift)){i.blockToShift=n;break}if(t.isNullOrUndefined(h.nextWidget))break}if(s=!0,i.owner.isShiftingEnabled&&0===i.fieldStacks.length){i.blockToShift=n;break}if(t.isNullOrUndefined(this.viewer.owner.editorModule)||!this.viewer.owner.editorModule.isInsertingTOC){n=n.combineWidget(this.viewer);var c=void 0;l.containerWidget!==n.containerWidget&&(!(l instanceof G)||l instanceof G&&!l.isEndsWithPageBreak)&&this.updateContainerWidget(n,l.containerWidget,l.indexInOwner+1,!1),n instanceof K?(this.clearTableWidget(n,!0,!0),n.isGridUpdated=!1,c=this.viewer.selection.getFirstParagraphInFirstCell(n)):c=n,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(c),i.updateClientAreaForBlock(n,!0),this.viewer.layout.layoutBlock(n,0),i.updateClientAreaForBlock(n,!1)}a=(o=a.getSplitWidgets())[o.length-1].nextRenderedWidget}i.owner.isShiftingEnabled&&this.viewer.blockToShift===n||this.viewer.owner.editorModule.updateListItemsTillEnd(n,s)},e.prototype.updateClientAreaForLine=function(e,t,i){var r=this.viewer.selection.getTop(t),n=this.viewer.clientArea.x;this.viewer.cutFromTop(r),this.viewer.cutFromLeft(n)},e.prototype.getParentTable=function(e){for(var t=e;t.containerWidget;){if(t.containerWidget instanceof _)return t;t=t.containerWidget}},e.prototype.reLayoutParagraph=function(e,t,i){this.viewer.blockToShift===e&&this.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),e.isInsideTable?this.reLayoutTable(e):this.reLayoutLine(e,t),e.bodyWidget instanceof q&&-1!==e.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(e.bodyWidget,this.viewer)},e.prototype.reLayoutTable=function(e){var t=this.getParentTable(e),i=t.combineWidget(this.viewer);i.isGridUpdated=!1,i.buildTableColumns(),i.isGridUpdated=!0;var r=i.containerWidget;if(this.viewer.owner.enableHeaderAndFooter||e.isInHeaderFooter?(r.height-=i.height,this.viewer.updateHCFClientAreaWithTop(t.bodyWidget.sectionFormat,this.viewer.isBlockInHeader(t),r.page)):this.viewer.updateClientArea(r.sectionFormat,r.page),this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule){var n=this.viewer.selection.getFirstParagraphInFirstCell(i);this.viewer.owner.editorModule.updateWholeListItems(n)}this.viewer.updateClientAreaForBlock(i,!0),i.x-=i.leftBorderWidth,i.y-=i.topBorderWidth,this.viewer.cutFromTop(i.y),this.clearTableWidget(i,!0,!0),this.layoutBlock(i,0,!0),this.viewer.updateClientAreaForBlock(i,!1),this.layoutNextItemsBlock(i,this.viewer)},e.prototype.clearTableWidget=function(e,t,i){e.height=0,t&&(e.y=0,e.x=0);for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];this.clearRowWidget(n,t,i)}},e.prototype.clearRowWidget=function(e,t,i){e.height=0,t&&(e.y=0,e.x=0);for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];this.clearCellWidget(n,t,i)}},e.prototype.clearCellWidget=function(e,t,i){e.height=0,t&&(e.y=0,e.x=0);for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];n instanceof G?i&&(n.height=0):this.clearTableWidget(n,t,i)}},e.prototype.layoutBodyWidgetCollection=function(e,i,r,n){if(!t.isNullOrUndefined(this.viewer.owner)&&this.viewer.owner.isLayoutEnabled)if(i instanceof _){var o=this.checkAndGetBlock(i,e);if(t.isNullOrUndefined(o))return;if(i instanceof q?(this.viewer.updateHCFClientAreaWithTop(i.sectionFormat,-1!==i.headerFooterType.indexOf("Header"),i.page),o.containerWidget.height-=o.height):this.viewer.updateClientArea(i.sectionFormat,i.page),e>0){var a=o.getSplitWidgets()[0].previousRenderedWidget;!(a instanceof G)||a instanceof G&&!a.isEndsWithPageBreak?(this.viewer.cutFromTop(a.y+a.height),o.containerWidget!==a.containerWidget&&this.updateContainerWidget(o,a.containerWidget,a.indexInOwner+1,!1)):a instanceof G&&a.isEndsWithPageBreak&&a.containerWidget===o.containerWidget&&this.moveBlocksToNextPage(a)}var s=void 0;(o=o.combineWidget(this.viewer))instanceof K?(this.clearTableWidget(o,!0,!0),o.isGridUpdated=!1,s=this.viewer.selection.getFirstParagraphInFirstCell(o)):s=o,this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(s),this.viewer.updateClientAreaForBlock(o,!0),this.viewer.layout.layoutBlock(o,0,!0),this.viewer.updateClientAreaForBlock(o,!1),n?this.shiftNextWidgets(o):this.layoutNextItemsBlock(o,this.viewer)}else if(i instanceof Y){var l=this.viewer.layout.getParentTable(i.ownerTable.getSplitWidgets()[0]);this.reLayoutTable(i.ownerTable),this.layoutNextItemsBlock(l,this.viewer)}},e.prototype.checkAndGetBlock=function(e,t){for(var i=e.index;e&&e.index===i;){if(e.childWidgets.length>0&&e.firstChild.index<=t&&e.lastChild.index>=t)for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n.index===t)return n}if(!(e instanceof V))break;e=e.nextRenderedWidget}},e.prototype.layoutTable=function(e,t){e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0);var i=[e];this.addTableWidget(this.viewer.clientActiveArea,i),this.viewer.updateClientAreaTopOrLeft(e,!0);var r=e.childWidgets[0].rowFormat.isHeader;e.childWidgets.length>0&&(e.header=r,e.continueHeader=r,e.headerHeight=0);for(var n=e.childWidgets[t];n;)n=(n=this.layoutRow(i,n)).nextRow;return this.updateWidgetsToPage(i,[],e),i[i.length-1]},e.prototype.addTableWidget=function(e,t,i){var r=t[t.length-1];return i&&(r=this.createTableWidget(r),t.push(r)),r.width=e.width,r.x=e.x,r.y=e.y,r.tableFormat.cellSpacing>0&&(r.height=r.height+W.convertPointToPixel(r.tableFormat.cellSpacing),r.leftBorderWidth=W.convertPointToPixel(this.getTableLeftBorder(r.tableFormat.borders).getLineWidth()),r.rightBorderWidth=W.convertPointToPixel(this.getTableRightBorder(r.tableFormat.borders).getLineWidth()),r.topBorderWidth=W.convertPointToPixel(this.getTableTopBorder(r.tableFormat.borders).getLineWidth()),r.bottomBorderWidth=W.convertPointToPixel(this.getTableBottomBorder(r.tableFormat.borders).getLineWidth()),r.x+=r.leftBorderWidth,r.y+=r.topBorderWidth,r.width-=r.leftBorderWidth,r.width-=r.rightBorderWidth,r.height+=r.bottomBorderWidth),r},e.prototype.updateWidgetsToPage=function(e,t,i,r){var n=this.viewer,o=e[e.length-1];i.isInsideTable||(this.updateHeightForTableWidget(e,t,o,r),o.childWidgets.length>0&&o.y!==o.childWidgets[0].y&&(o.y=o.childWidgets[0].y)),i.tableFormat.cellSpacing>0&&(o.y+o.height+W.convertPointToPixel(i.tableFormat.cellSpacing)>n.clientArea.bottom&&n instanceof ve&&(o.height=o.height-W.convertPointToPixel(i.tableFormat.cellSpacing)/2),n.cutFromTop(o.y+o.height)),i.bodyWidget instanceof q&&(i.containerWidget.height+=i.height,this.viewer.owner.enableHeaderAndFooter&&-1!==i.bodyWidget.headerFooterType.indexOf("Footer")&&this.shiftFooterChildLocation(i.bodyWidget,this.viewer))},e.prototype.updateHeightForTableWidget=function(e,t,i,r){for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[n];if(o===r)break;this.updateHeightForRowWidget(this.viewer,!0,e,t,o,!0,r)}},e.prototype.layoutRow=function(e,t){var i=this.viewer,r=[t],n=this.addTableRowWidget(i.clientActiveArea,r);i.updateClientAreaForRow(t,!0);for(var o=0;o<t.childWidgets.length;o++){var a=t.childWidgets[o];this.layoutCell(a,this.getMaxTopOrBottomCellMargin(t,0)+t.topBorderWidth,this.getMaxTopOrBottomCellMargin(t,1)+t.bottomBorderWidth,n)}i.updateClientAreaForRow(t,!1);var s=[t];return this.updateWidgetsToTable(e,s,t),s[s.length-1]},e.prototype.addTableRowWidget=function(e,i){var r=i[i.length-1];r.x=e.x+r.rowFormat.gridBeforeWidth,r.y=e.y,r.width=e.width;var n=0;if(!t.isNullOrUndefined(r.ownerTable)&&!t.isNullOrUndefined(r.ownerTable.tableFormat)&&r.ownerTable.tableFormat.cellSpacing>0){r.height=r.height+W.convertPointToPixel(r.ownerTable.tableFormat.cellSpacing);for(var o=0;o<r.childWidgets.length;o++)if(!t.isNullOrUndefined(r.childWidgets[o].cellFormat)&&!t.isNullOrUndefined(r.childWidgets[o].cellFormat.borders)){var a=Y.getCellBottomBorder(r.childWidgets[o]).getLineWidth();a>n&&(n=a)}if(r.bottomBorderWidth=W.convertPointToPixel(n),r.index>0&&!t.isNullOrUndefined(r.previousWidget)){var s=r.previousWidget;n=0;for(l=0;l<s.childWidgets.length;l++)t.isNullOrUndefined(s.childWidgets[l].cellFormat)||t.isNullOrUndefined(s.childWidgets[l].cellFormat.borders)||(d=Y.getCellBottomBorder(s.childWidgets[l]).getLineWidth())>n&&(n=d);r.topBorderWidth=W.convertPointToPixel(n)}}if(!t.isNullOrUndefined(r.childWidgets))for(l=0;l<r.childWidgets.length;l++)t.isNullOrUndefined(r.childWidgets[l].cellFormat)||t.isNullOrUndefined(r.childWidgets[l].cellFormat.borders)||(d=Y.getCellTopBorder(r.childWidgets[l]).getLineWidth())>n&&(n=d);if(r.topBorderWidth=W.convertPointToPixel(n),!t.isNullOrUndefined(r.ownerTable)&&!t.isNullOrUndefined(r.ownerTable.tableFormat)&&r.ownerTable.tableFormat.cellSpacing<=0&&r.rowIndex===r.ownerTable.childWidgets.length-1){for(var l=0;l<r.childWidgets.length;l++)if(!t.isNullOrUndefined(r.childWidgets[l].cellFormat)&&!t.isNullOrUndefined(r.childWidgets[l].cellFormat.borders)){var d=Y.getCellBottomBorder(r.childWidgets[l]).getLineWidth();d>n&&(n=d)}r.bottomBorderWidth=W.convertPointToPixel(n)}return r},e.prototype.getMaxTopOrBottomCellMargin=function(e,i){if(t.isNullOrUndefined(e.childWidgets))return 0;for(var r=0,n=0;n<e.childWidgets.length;n++)if(e.childWidgets.length>0){var o=e.childWidgets[n].cellFormat;if(o.containsMargins())0===i&&!t.isNullOrUndefined(o.topMargin)&&W.convertPointToPixel(o.topMargin)>r?r=W.convertPointToPixel(o.topMargin):1===i&&!t.isNullOrUndefined(o.bottomMargin)&&W.convertPointToPixel(o.bottomMargin)>r&&(r=W.convertPointToPixel(o.bottomMargin));else{var a=e.childWidgets[n].ownerTable.tableFormat;0===i&&W.convertPointToPixel(a.topMargin)>r?r=W.convertPointToPixel(a.topMargin):1===i&&W.convertPointToPixel(a.bottomMargin)>r&&(r=W.convertPointToPixel(a.bottomMargin))}}return r},e.prototype.layoutCell=function(e,t,i,r){var n=this.viewer;if(this.addTableCellWidget(e,n.clientActiveArea,t,i),n.updateClientAreaForCell(e,!0),0===e.childWidgets.length){var o=new G;o.characterFormat=new P,o.paragraphFormat=new F,o.index=0;var a=new J(void 0);o.childWidgets.push(a),e.childWidgets.push(o)}for(var s=0;s<e.childWidgets.length;s++){var l=e.childWidgets[s];n.updateClientAreaForBlock(l,!0),l.containerWidget=e,this.layoutBlock(l,0),n.updateClientAreaForBlock(l,!1)}this.updateWidgetToRow(e),n.updateClientAreaForCell(e,!1)},e.prototype.shiftLayoutedItems=function(){if(t.isNullOrUndefined(this.viewer.blockToShift)||t.isNullOrUndefined(this.viewer.blockToShift.containerWidget))return void(this.viewer.blockToShift=void 0);var e=this.viewer.blockToShift,i=e.bodyWidget.index;this.reLayoutOrShiftWidgets(e,this.viewer);for(var r=!0,n=e.getSplitWidgets(),o=n[n.length-1].nextRenderedWidget;o instanceof j&&o.bodyWidget.index===i;){var a=void 0,s=e.getSplitWidgets();a=s[s.length-1],r=!1;var l=void 0;if(s=(e=o).getSplitWidgets(),e instanceof G?l=s[0]:e instanceof K&&(l=s[0]),a.containerWidget===l.containerWidget&&W.round(l.y,2)===W.round(this.viewer.clientActiveArea.y,2)&&t.isNullOrUndefined(l.nextWidget))break;r=!0,this.reLayoutOrShiftWidgets(e,this.viewer),o=(n=e.getSplitWidgets())[n.length-1].nextRenderedWidget}this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateListItemsTillEnd(e,r),this.viewer.blockToShift=void 0;var d=this.viewer;d.removeEmptyPages(),this.updateFieldElements(),d.updateScrollBars()},e.prototype.updateFieldElements=function(){for(var e=0;e<this.viewer.fields.length;e++){var i=this.viewer.fields[e];if(!t.isNullOrUndefined(this.viewer.selection)){var r=this.viewer.selection.getFieldCode(i);if(!t.isNullOrUndefined(r)&&r.toLowerCase().match("numpages")){var n=i.fieldSeparator.nextNode;if(!t.isNullOrUndefined(n)){n.text=this.viewer.pages.length.toString();var o=i.line.paragraph;if(!t.isNullOrUndefined(o.bodyWidget)&&!t.isNullOrUndefined(o.bodyWidget.page)){var a=o.childWidgets.indexOf(i.line),s=i.line.children.indexOf(n);this.reLayoutParagraph(o,a,s)}}}}}},e.prototype.reLayoutOrShiftWidgets=function(e,t){var i=e;this.shiftWidgetsBlock(i,t),this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateRenderedListItems(i)},e.prototype.shiftWidgetsBlock=function(e,t){e instanceof G?this.shiftWidgetsForPara(e,t):e instanceof K&&this.shiftWidgetsForTable(e,t)},e.prototype.shiftWidgetsForPara=function(e,i){for(var r=this.getBodyWidgetOfPreviousBlock(e,0),n=r.bodyWidget,o=r.index,a=void 0,s=0;s<e.getSplitWidgets().length;s++){var l=e.getSplitWidgets()[s];if(!t.isNullOrUndefined(a)){c=!!a.lastChild&&a.lastChild.isEndsWithPageBreak;if(this.shiftToPreviousWidget(l,i,a,c),(t.isNullOrUndefined(l.childWidgets)||0===l.childWidgets.length)&&!c){s--;continue}a=void 0,n!==l.containerWidget&&(n=l.containerWidget,c&&i.updateClientAreaByWidget(l))}if(this.isFitInClientArea(l,i)){if(a=l,l.y=i.clientActiveArea.y,i.cutFromTop(i.clientActiveArea.y+l.height),t.isNullOrUndefined(n)||n===l.containerWidget||(o++,n.lastChild.isEndsWithPageBreak||this.updateContainerWidget(l,n,o,!0)),l.isEndsWithPageBreak){var d=this.createOrGetNextBodyWidget(n,this.viewer);d=this.moveBlocksToNextPage(l),i.updateClientArea(d.sectionFormat,d.page)}}else{var h=l.previousRenderedWidget,c=!1;h instanceof G&&h.isEndsWithPageBreak&&(c=!0);var p=this.splitWidget(l,i,n,o+1,c);a=void 0,n!==l.containerWidget&&(n=l.containerWidget,s--),o=n.childWidgets.indexOf(l),p&&(n=e.getSplitWidgets()[s+1].containerWidget)}}},e.prototype.shiftTableWidget=function(e,t){var i=[e];this.addTableWidget(this.viewer.clientActiveArea,i),this.viewer.updateClientAreaTopOrLeft(e,!0);for(var r=e.childWidgets[0];r;)r=(r=this.shiftRowWidget(i,r)).nextRow;return this.updateWidgetsToPage(i,[],e),i[i.length-1]},e.prototype.shiftRowWidget=function(e,t){var i=this.viewer,r=[t];this.addTableRowWidget(i.clientActiveArea,r);i.updateClientAreaForRow(t,!0);for(var n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];this.shiftCellWidget(o,this.getMaxTopOrBottomCellMargin(t,0)+t.topBorderWidth,this.getMaxTopOrBottomCellMargin(t,1)+t.bottomBorderWidth)}return i.updateClientAreaForRow(t,!1),this.updateWidgetsToTable(e,r,t),r[r.length-1]},e.prototype.shiftCellWidget=function(e,t,i){var r=this.viewer;this.addTableCellWidget(e,r.clientActiveArea,t,i),r.updateClientAreaForCell(e,!0);for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];r.updateClientAreaForBlock(o,!0),o instanceof G?this.shiftParagraphWidget(o):this.shiftTableWidget(o,r),r.updateClientAreaForBlock(o,!1)}this.updateWidgetToRow(e),r.updateClientAreaForCell(e,!1)},e.prototype.shiftParagraphWidget=function(e){this.addParagraphWidget(this.viewer.clientActiveArea,e),this.viewer.cutFromTop(this.viewer.clientActiveArea.y+e.height),this.updateWidgetToPage(this.viewer,e)},e.prototype.shiftWidgetsForTable=function(e,t){var i=this.getBodyWidgetOfPreviousBlock(e,0),r=i.bodyWidget,n=i.index,o=r.lastChild.lastChild.isEndsWithPageBreak;r!==e.containerWidget&&(o?t.updateClientArea(e.bodyWidget.sectionFormat,e.bodyWidget.page):this.updateContainerWidget(e,r,n+1,!0)),e.isInHeaderFooter&&(e.containerWidget.height-=e.height),e.y=this.viewer.clientActiveArea.y,this.updateVerticalPositionToTop(e,!0);var a=e.combineWidget(this.viewer);this.viewer.layout.updateChildLocationForTable(a.y,a),this.clearTableWidget(a,!0,!1),this.shiftTableWidget(a,this.viewer),this.updateVerticalPositionToTop(e,!1)},e.prototype.updateVerticalPositionToTop=function(e,t){for(var i=0;i<e.getSplitWidgets().length;i++)for(var r=e.getSplitWidgets()[i],n=0;n<r.childWidgets.length;n++)for(var o=r.childWidgets[n],a=0;a<o.childWidgets.length;a++){var s=o.childWidgets[a];this.viewer.layout.updateCellVerticalPosition(s,t,!1)}},e.prototype.splitWidget=function(e,i,r,n,o){var a=e.childWidgets[0],s=this.getMaxElementHeight(a,i),l=e.getSplitWidgets(),d=e.containerWidget;if(i.clientActiveArea.height>=s&&!o){var h=void 0,c=l.indexOf(e);c<l.length-1?d=(h=l[c+1]).containerWidget:((h=new G).index=e.index,h.characterFormat=e.characterFormat,h.paragraphFormat=e.paragraphFormat,h.width=e.width,h.x=e.x,h.y=e.y,l.push(h)),r!==e.containerWidget&&this.updateContainerWidget(e,r,n,!0);for(var p=e.childWidgets.length-1;p>0&&!this.isFitInClientArea(e,i);p--){var g=e.childWidgets[p];this.updateParagraphWidgetInternal(g,h,0)}if(t.isNullOrUndefined(h.containerWidget)&&h.childWidgets.length>0){var u=i.clientActiveArea.y,f=new D(i.clientArea.x,i.clientArea.y,i.clientArea.width,i.clientArea.height),m=new D(i.clientActiveArea.x,i.clientActiveArea.y,i.clientActiveArea.width,i.clientActiveArea.height);if((d=this.moveBlocksToNextPage(e)).childWidgets.splice(0,0,h),d.height+=h.height,h.containerWidget=d,1===d.childWidgets.length&&d.firstChild instanceof G&&d.firstChild.equals(e))return e.x=e.x,e.y=u,!0;i.clientArea=f,i.clientActiveArea=m}}else d=this.createOrGetNextBodyWidget(r,this.viewer),e.containerWidget!==d&&(d=this.moveBlocksToNextPage(e),this.updateContainerWidget(e,d,0,!0));return r===e.containerWidget?(e.y=i.clientActiveArea.y,i.cutFromTop(i.clientActiveArea.y+e.height)):i.updateClientArea(d.sectionFormat,d.page),!1},e.prototype.getMaxElementHeight=function(e,t){var i=0;if(0===e.children.length||1===e.children.length&&e.children[0]instanceof ne||2===e.children.length&&e.children[0]instanceof ne&&e.children[1]instanceof ne){i=t.selection.getParagraphMarkSize(e.paragraph,0,0).height,i+=0,e.children.length>0&&i<(n=e.children[0]).margin.top+n.height&&(i=n.margin.top+n.height)}else for(var r=0;r<e.children.length;r++){var n=e.children[r];i<n.margin.top+n.height&&(i=n.margin.top+n.height)}return i},e.prototype.createOrGetNextBodyWidget=function(e,t){var i=void 0,r=0;r=t.pages.indexOf(e.page);var n=void 0,o=void 0;if(o=e.index,r===t.pages.length-1||t.pages[r+1].sectionIndex!==o){var a=new V;a.sectionFormat=e.sectionFormat,a.index=e.index,n=t.createNewPage(a),t.pages[r+1].sectionIndex!==o&&t.insertPage(r+1,n),i=n.bodyWidgets[0]}else i=(n=t.pages[r+1]).bodyWidgets[0];return i},e.prototype.isFitInClientArea=function(e,t){var i=e.childWidgets[e.childWidgets.length-1],r=e.height,n=this.getMaxElementHeight(i,t);return i.height>n&&(r-=i.height-n),t.clientActiveArea.height>=r},e.prototype.shiftToPreviousWidget=function(e,i,r,n){for(var o=0;o<e.childWidgets.length;o++){var a=e.childWidgets[o],s=this.getMaxElementHeight(a,i);if(!(i.clientActiveArea.height>=s)||n){var l=r.containerWidget,d=this.createOrGetNextBodyWidget(l,i);e.containerWidget!==d&&(d=this.moveBlocksToNextPage(e)),l!==d&&this.updateContainerWidget(e,d,0,!0),i.updateClientArea(d.sectionFormat,d.page);break}if(this.updateParagraphWidgetInternal(a,r,r.childWidgets.length),o--,i.cutFromTop(i.clientActiveArea.y+a.height),t.isNullOrUndefined(e.childWidgets))break}},e.prototype.updateParagraphWidgetInternal=function(e,i,r){t.isNullOrUndefined(e.paragraph)||(e.paragraph.childWidgets.splice(e.paragraph.childWidgets.indexOf(e),1),e.paragraph.height-=e.height,t.isNullOrUndefined(e.paragraph.containerWidget)||(e.paragraph.containerWidget.height-=e.height),(t.isNullOrUndefined(e.paragraph.childWidgets)||0===e.paragraph.childWidgets.length)&&e.paragraph.destroyInternal(this.viewer)),i.childWidgets.splice(r,0,e),e.paragraph=i,i.height+=e.height,t.isNullOrUndefined(i.containerWidget)||(i.containerWidget.height+=e.height)},e.prototype.shiftNextWidgets=function(e){for(var t=e;t.nextWidget instanceof j;)t=t.nextWidget,this.reLayoutOrShiftWidgets(t,this.viewer)},e.prototype.updateContainerWidget=function(e,i,r,n){if(!t.isNullOrUndefined(e.containerWidget)&&(e.containerWidget.childWidgets.splice(e.containerWidget.childWidgets.indexOf(e),1),e.containerWidget.height-=i.height,(t.isNullOrUndefined(e.containerWidget.childWidgets)||0===e.containerWidget.childWidgets.length)&&e.containerWidget instanceof V&&e.containerWidget!==i&&n)){var o=e.containerWidget.page;this.viewer.pages[this.viewer.pages.length-1]===o&&-1!==this.viewer.visiblePages.indexOf(o)&&this.viewer.scrollToBottom(),(t.isNullOrUndefined(o.nextPage)||o.nextPage.bodyWidgets[0].index!==e.containerWidget.index)&&e.containerWidget.destroyInternal(this.viewer)}i.childWidgets.splice(r,0,e),i.height+=i.height,e.containerWidget=i},e.prototype.getBodyWidgetOfPreviousBlock=function(e,t){t=0;var i=void 0,r=e.previousRenderedWidget;return i=r&&r.containerWidget.equals(e.containerWidget)?r.containerWidget:e.containerWidget,t=r&&r.containerWidget.equals(e.containerWidget)?i.childWidgets.indexOf(r):e.containerWidget.childWidgets.indexOf(e),{bodyWidget:i,index:t}},e.prototype.moveBlocksToNextPage=function(e){var i=e.bodyWidget,r=i.page.index+1,n=void 0,o=void 0,a=!1;for(this.viewer.pages.length>r&&(0!==(n=this.viewer.pages[r]).bodyWidgets.length&&i.equals(n.bodyWidgets[0])?(o=n.bodyWidgets[0],this.viewer.updateClientArea(o.sectionFormat,o.page)):(n=void 0,a=!0)),t.isNullOrUndefined(n)&&(o=this.createSplitBody(i),n=this.viewer.createNewPage(o,r),a&&this.viewer.insertPage(r,n));;){var s=i.lastChild;if(e===s)break;i.childWidgets.pop(),o.childWidgets.splice(0,0,s),s.containerWidget=o,o.height+=s.height}return o},e.prototype.createSplitBody=function(e){var t=this.addBodyWidget(this.viewer.clientActiveArea);return t.sectionFormat=e.sectionFormat,t.index=e.index,t},e.prototype.reLayoutLine=function(e,i){this.viewer.owner.isDocumentLoaded&&this.viewer.owner.editorModule&&this.viewer.owner.editorModule.updateWholeListItems(e);var r,n=(r=e.paragraphFormat.listFormat&&-1!==e.paragraphFormat.listFormat.listId?e.getSplitWidgets()[0].firstChild:e.childWidgets[i]).previousLine;t.isNullOrUndefined(n)&&(n=r);n.paragraph;var o=e.containerWidget;if(o.height-=e.height,this.viewer.owner.enableHeaderAndFooter||e.isInHeaderFooter?this.viewer.updateHCFClientAreaWithTop(e.bodyWidget.sectionFormat,this.viewer.isBlockInHeader(e),o.page):this.viewer.updateClientArea(o.sectionFormat,o.page),this.viewer.updateClientAreaForBlock(e,!0),n.paragraph.isEmpty())this.viewer.cutFromTop(e.y),this.layoutParagraph(e,0);else{if(this.updateClientAreaForLine(n.paragraph,n,0),this.layoutListItems(n.paragraph),n.isFirstLine()&&!t.isNullOrUndefined(e.paragraphFormat)){var a=-W.convertPointToPixel(e.paragraphFormat.firstLineIndent);this.viewer.updateClientWidth(a)}do{e=(n=this.layoutLine(n,0)).paragraph,n=n.nextLine}while(n);this.updateWidgetToPage(this.viewer,e),this.viewer.updateClientAreaForBlock(e,!1)}this.layoutNextItemsBlock(e,this.viewer)},e}(),pe=function(){function e(e){this.isPrinting=!1,this.pageLeft=0,this.pageTop=0,this.isFieldCode=!1,this.viewer=e}return Object.defineProperty(e.prototype,"pageCanvas",{get:function(){return this.isPrinting?(t.isNullOrUndefined(this.pageCanvasIn)&&(this.pageCanvasIn=document.createElement("canvas"),this.pageCanvasIn.getContext("2d").save()),this.pageCanvasIn):t.isNullOrUndefined(this.viewer)?void 0:this.viewer.containerCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionCanvas",{get:function(){return t.isNullOrUndefined(this.viewer)?void 0:this.viewer.selectionCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageContext",{get:function(){return this.pageCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),e.prototype.getColor=function(e){return e.length>0&&"#"===e[0]&&e.length>7?e.substr(0,7):e},e.prototype.renderWidgets=function(e,i,r,n,o){if(!t.isNullOrUndefined(this.pageCanvas)&&!t.isNullOrUndefined(e)){this.pageContext.fillStyle=this.getColor(this.viewer.backgroundColor),this.pageContext.beginPath(),this.pageContext.fillRect(i,r,n,o),this.pageContext.closePath(),this.pageContext.strokeStyle=this.viewer.owner.pageOutline,this.pageContext.strokeRect(i,r,n,o),this.pageLeft=i,this.pageTop=r,this.isPrinting?this.setPageSize(e):(this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(i,r,n,o),this.pageContext.clip()),e.headerWidget&&this.renderHFWidgets(e,e.headerWidget,n,!0),e.footerWidget&&this.renderHFWidgets(e,e.footerWidget,n,!1);for(var a=0;a<e.bodyWidgets.length;a++)this.render(e,e.bodyWidgets[a]);this.viewer.owner.enableHeaderAndFooter&&!this.isPrinting&&this.renderHeaderSeparator(e,this.pageLeft,this.pageTop,e.headerWidget),this.pageLeft=0,this.pageTop=0,this.pageContext.restore()}},e.prototype.setPageSize=function(e){this.pageContext.clearRect(0,0,this.pageCanvas.width,this.pageCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height),this.pageContext.restore(),this.selectionContext.restore();var t=e.boundingRectangle.width,i=e.boundingRectangle.height,r=Math.max(1,window.devicePixelRatio||1);this.pageCanvas.width===t*r&&this.pageCanvas.height===i*r||(this.pageCanvas.height=i*r,this.pageCanvas.width=t*r,this.pageCanvas.style.height=i+"px",this.pageCanvas.style.width=t+"px",this.pageContext.globalAlpha=1,this.pageContext.scale(r,r))},e.prototype.renderHFWidgets=function(e,t,i,r){this.pageContext.globalAlpha=this.viewer.owner.enableHeaderAndFooter?1:.65;var n=!1;if(r){var o=W.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),a=Math.max(t.y+t.height,o),s=e.boundingRectangle.height/100*40;a>s&&(n=!0,this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.pageLeft,this.pageTop,i,this.getScaledValue(s)),this.pageContext.clip())}for(var l=0;l<t.childWidgets.length;l++){var d=t.childWidgets[l];this.renderWidget(e,d)}n&&this.pageContext.restore(),this.pageContext.globalAlpha=this.viewer.owner.enableHeaderAndFooter?.65:1},e.prototype.renderHeaderSeparator=function(e,t,i,r){var n=W.convertPointToPixel(e.bodyWidgets[0].sectionFormat.topMargin),o=this.getScaledValue(Math.max(r.y+r.height,n)),a=this.getScaledValue(e.boundingRectangle.width),s=this.pageContext;s.save(),s.globalAlpha=.65;var l=this.getScaledValue(e.boundingRectangle.height)/100*40;o=Math.min(o,l),this.renderDashLine(s,t,i+o,a,"#000000",!1);var d=this.getHeaderFooterType(e,!0);s.font="9pt Arial";var h=s.measureText(d).width;if(this.renderHeaderFooterMark(s,t+5,i+o,h+10,20),this.renderHeaderFooterMarkText(s,d,t+10,o+i+15),e.footerWidget){var c=W.convertPointToPixel(e.bodyWidgets[0].sectionFormat.footerDistance),p=this.getScaledValue(e.boundingRectangle.height)-this.getScaledValue(Math.max(e.footerWidget.height+c,W.convertPointToPixel(e.footerWidget.sectionFormat.bottomMargin)));p=Math.max(this.getScaledValue(e.boundingRectangle.height)-l,p),this.renderDashLine(s,t,i+p,a,"#000000",!1),d=this.getHeaderFooterType(e,!1),h=s.measureText(d).width,this.renderHeaderFooterMark(s,t+5,i+p-20,h+10,20),this.renderHeaderFooterMarkText(s,d,t+10,i+p-5),s.restore()}},e.prototype.getHeaderFooterType=function(e,t){var i;return i=t?"Header":"Footer",e.bodyWidgets[0].sectionFormat.differentFirstPage&&0===this.viewer.pages.indexOf(e)?i=t?"First Page Header":"First Page Footer":e.bodyWidgets[0].sectionFormat.differentOddAndEvenPages&&(i=(this.viewer.pages.indexOf(e)+1)%2==0?t?"Even Page Header":"Even Page Footer":t?"Odd Page Header":"Odd Page Footer"),i},e.prototype.renderDashLine=function(e,t,i,r,n,o){e.beginPath(),e.strokeStyle=n,e.lineWidth=1,o?e.setLineDash([3,2]):e.setLineDash([6,4]),e.moveTo(t,i),e.lineTo(t+r,i),e.stroke(),e.setLineDash([]),e.closePath()},e.prototype.renderHeaderFooterMark=function(e,t,i,r,n){e.beginPath(),e.fillStyle="lightgray",e.fillRect(t,i,r,n),e.strokeStyle="black",e.strokeRect(t,i,r,n),e.closePath()},e.prototype.renderHeaderFooterMarkText=function(e,t,i,r){e.beginPath(),e.fillStyle="#000000",e.textBaseline="alphabetic",e.fillText(t,i,r),e.closePath()},e.prototype.render=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];0===i&&t.childWidgets[0]instanceof K&&e.repeatHeaderRowTableWidget&&this.renderHeader(e,r,this.viewer.layout.getHeader(t.childWidgets[0])),this.renderWidget(e,r)}},e.prototype.renderWidget=function(e,t){t instanceof G?this.renderParagraphWidget(e,t):this.renderTableWidget(e,t)},e.prototype.renderHeader=function(e,i,r){if(!t.isNullOrUndefined(r)){for(var n=e.viewer.clientArea.y,o=0;o<=r.rowIndex;o++){if(0===r.ownerTable.getSplitWidgets()[0].childWidgets.length)return;var a=r.ownerTable.getSplitWidgets()[0].childWidgets[0],s=a.clone();s.containerWidget=a.containerWidget,e.viewer.updateClientAreaLocation(s,new D(e.viewer.clientArea.x,n,s.width,s.height)),e.viewer.layout.updateChildLocationForRow(n,s);for(var l=void 0,d=0;d<s.childWidgets.length;d++)l=s.childWidgets[d],this.renderTableCellWidget(e,l);n+=s.height}i.y!==n&&e.viewer.layout.updateChildLocationForTable(n,i)}},e.prototype.renderParagraphWidget=function(e,t){for(var i=t.y,r=t.x,n=0;n<t.childWidgets.length;n++){var o=t.childWidgets[n];this.renderLine(o,e,r,i),i+=o.height}},e.prototype.renderTableWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];this.renderTableRowWidget(e,r),t.tableFormat.cellSpacing>0&&this.renderTableOutline(t)}},e.prototype.renderTableRowWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i];this.renderTableCellWidget(e,r)}},e.prototype.renderTableCellWidget=function(e,t){if(this.isPrinting||!(this.getScaledValue(t.y,2)+t.height*this.viewer.zoomFactor<0||this.getScaledValue(t.y,2)>this.viewer.visibleBounds.height)){!this.isPrinting&&e.viewer.owner.selection&&e.viewer.owner.selection.selectedWidgets.length>0&&e.viewer.owner.selection.addSelectionHighlightTable(this.selectionContext,t),this.renderTableCellOutline(e.viewer,t);for(var i=0;i<t.childWidgets.length;i++){var r=t.childWidgets[i],n=t.width+t.margin.left-t.leftBorderWidth;this.clipRect(t.x,t.y,this.getScaledValue(n),this.getScaledValue(t.height)),this.renderWidget(e,r),this.pageContext.restore()}}},e.prototype.renderLine=function(e,i,r,n){if(!this.isPrinting&&i.viewer.owner.selection&&i.viewer.owner.selection.selectedWidgets.length>0&&i.viewer.owner.selection.addSelectionHighlight(this.selectionContext,e,n),e.isFirstLine()&&(r+=W.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),this.viewer.owner.searchModule&&!t.isNullOrUndefined(i.viewer.owner.searchModule.searchHighlighters)&&i.viewer.owner.searchModule.searchHighlighters.containsKey(e))for(var o=i.viewer.owner.searchModule.searchHighlighters.get(e),a=0;a<o.length;a++)this.pageContext.fillStyle="#ffe97f",this.pageContext.fillRect(this.getScaledValue(o[a].left,1),this.getScaledValue(n,2),this.getScaledValue(o[a].width),this.getScaledValue(e.height));for(a=0;a<e.children.length;a++){var s=e.children[a];if(s instanceof $||this.isFieldCode||0===s.width&&0===s.height)this.isFieldCode&&(s.width=0),r+=s.width+s.margin.left,this.toSkipFieldCode(s);else{var l=this.getUnderlineYPosition(e);this.isPrinting||!(this.getScaledValue(n+s.margin.top,2)+s.height*this.viewer.zoomFactor<0||this.getScaledValue(n+s.margin.top,2)>this.viewer.visibleBounds.height)?(s instanceof ne?this.renderListTextElementBox(s,r,n,l):s instanceof re?this.renderImageElementBox(s,r,n,l):this.renderTextElementBox(s,r,n,l),r+=s.width+s.margin.left):r+=s.width+s.margin.left}}},e.prototype.toSkipFieldCode=function(e){e instanceof $&&(0===e.fieldType?t.isNullOrUndefined(e.fieldEnd)&&!e.hasFieldEnd||(this.isFieldCode=!0):2!==e.fieldType&&1!==e.fieldType||(this.isFieldCode=!1))},e.prototype.getUnderlineYPosition=function(e){for(var t=0,i=0,r=0;r<e.children.length;r++)e.children[r]instanceof $||0===e.children[r].width&&0===e.children[r].height||t<e.children[r].height+e.children[r].margin.top&&(t=e.children[r].margin.top+e.children[r].height,i=e.children[r].height/20);return t-2*i},e.prototype.renderListTextElementBox=function(e,i,r,n){var o=e.margin.top,a=e.margin.left,s=e.listLevel.characterFormat,l=e.line.paragraph.characterFormat,d="#000000"===s.fontColor?l.fontColor:s.fontColor;this.pageContext.textBaseline="top";var h="",c="",p="Verdana"===s.fontFamily?l.fontFamily:s.fontFamily,g=11===s.fontSize?l.fontSize:s.fontSize,u="Normal"===s.baselineAlignment?l.baselineAlignment:s.baselineAlignment;h=s.bold?"bold":l.bold?"bold":"",c=s.italic?"italic":l.italic?"italic":"",g=0===g?.5:g/("Normal"===u?1:1.5);var f="None"===s.strikethrough?l.strikethrough:s.strikethrough,m="NoColor"===s.highlightColor?l.highlightColor:s.highlightColor;"NoColor"!==m&&("#"!==m.substring(0,1)?this.pageContext.fillStyle=W.getHighlightColorCode(m):this.pageContext.fillStyle=this.getColor(m),this.pageContext.fillRect(this.getScaledValue(i+a,1),this.getScaledValue(r+o,2),this.getScaledValue(e.width),this.getScaledValue(e.height))),this.pageContext.font=h+" "+c+" "+g*this.viewer.zoomFactor+"pt "+p,"Subscript"===u&&(o+=e.height-e.height/1.5),this.pageContext.fillStyle=this.getColor(d),this.pageContext.fillText(e.text,this.getScaledValue(i+a,1),this.getScaledValue(r+o,2),this.getScaledValue(e.width)),"None"===s.underline||t.isNullOrUndefined(s.underline)||this.renderUnderline(e,i,r,n,d,s.underline,u),"None"!==f&&this.renderStrikeThrough(e,i,r,s.strikethrough,d,u)},e.prototype.renderTextElementBox=function(e,i,r,n){var o=!1,a=e.line.paragraph.containerWidget;a instanceof Y&&(o="Exactly"===a.ownerRow.rowFormat.heightType);var s=e.margin.top,l=e.margin.left;o&&this.clipRect(a.x,a.y,this.getScaledValue(a.width),this.getScaledValue(a.height));var d=e.characterFormat;"NoColor"!==d.highlightColor&&("#"!==d.highlightColor.substring(0,1)?this.pageContext.fillStyle=W.getHighlightColorCode(d.highlightColor):this.pageContext.fillStyle=this.getColor(d.highlightColor),this.pageContext.fillRect(this.getScaledValue(i+l,1),this.getScaledValue(r+s,2),this.getScaledValue(e.width),this.getScaledValue(e.height)));var h=d.fontColor;this.pageContext.textBaseline="top";var c="",p="",g=11;c=d.bold?"bold":"",p=d.italic?"italic":"",g=0===d.fontSize?.5:d.fontSize/("Normal"===d.baselineAlignment?1:1.5),this.pageContext.font=c+" "+p+" "+g*this.viewer.zoomFactor+"pt "+d.fontFamily,"Subscript"===d.baselineAlignment&&(s+=e.height-e.height/1.5),this.pageContext.fillStyle=this.getColor(h);var u=this.getScaledValue(e.width),f=e.text;if(e instanceof te){var m=e;""!==m.tabText||t.isNullOrUndefined(m.tabLeader)||"None"===m.tabLeader?""!==m.tabText&&(f=m.tabText):(f=this.getTabLeader(e),m.tabText=f)}this.pageContext.fillText(f,this.getScaledValue(i+l,1),this.getScaledValue(r+s,2),u),"None"===d.underline||t.isNullOrUndefined(d.underline)||this.renderUnderline(e,i,r,n,h,d.underline,d.baselineAlignment),"None"===d.strikethrough||t.isNullOrUndefined(d.strikethrough)||this.renderStrikeThrough(e,i,r,d.strikethrough,h,d.baselineAlignment),o&&this.pageContext.restore()},e.prototype.getTabLeader=function(e){var t=0,i=this.getTabLeaderString(e.tabLeader),r=i;t=this.viewer.textHelper.getWidth(r,e.characterFormat);for(var n=Math.floor(e.width/t),o=0;o<=n;o++)r+=i;return r.slice(0,-1)},e.prototype.getTabLeaderString=function(e){var t="";switch(e){case"Dot":t=".";break;case"Hyphen":t="-";break;case"Underscore":t="_"}return t},e.prototype.clipRect=function(e,t,i,r){this.pageContext.beginPath(),this.pageContext.save(),this.pageContext.rect(this.getScaledValue(e,1),this.getScaledValue(t,2),i,r),this.pageContext.clip()},e.prototype.renderUnderline=function(e,t,i,r,n,o,a){var s=e.height/("Normal"===a?1:1.5),l=e.margin.top,d=s/20,h=0;"Subscript"===a||e instanceof ne?(h=s-2*d+i,h+=(l+=e.height-s)>0?l:0):h=r+i,this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(h,2),this.getScaledValue(e.width),this.getScaledValue(d))},e.prototype.renderStrikeThrough=function(e,t,i,r,n,o){var a=e.height/("Normal"===o?1:1.5),s=e.margin.top;"Subscript"===o&&(s+=e.height-a),i+=s>0?s:0;var l=a/20,d=a/2+.5*l,h=0;for("DoubleStrike"===r&&(d-=l);h<("DoubleStrike"===r?2:1);)h++,this.pageContext.fillRect(this.getScaledValue(t+e.margin.left,1),this.getScaledValue(d+i,2),this.getScaledValue(e.width),this.getScaledValue(l)),d+=2*l},e.prototype.renderImageElementBox=function(e,t,i,r){var n=e.margin.top,o=e.margin.left;this.pageContext.textBaseline="top";var a=0,s=!1;if(n<0||e.line.paragraph.width<e.width){var l=e.line.paragraph.containerWidget;if(l instanceof Y){var d=0;l.childWidgets[0]instanceof G&&(d=l.childWidgets[0].paragraphFormat.leftIndent),a=l.width+l.margin.left-l.leftBorderWidth-d,s=!0,this.clipRect(t+o,i+n,this.getScaledValue(a),this.getScaledValue(l.height))}}e.isMetaFile||this.pageContext.drawImage(e.element,this.getScaledValue(t+o,1),this.getScaledValue(i+n,2),this.getScaledValue(e.width),this.getScaledValue(e.height)),s&&this.pageContext.restore()},e.prototype.renderTableOutline=function(e){var t=new ce(this.viewer),i=e;e.width=this.viewer.layout.getTableWidth(i);var r=t.getTableTopBorder(i.tableFormat.borders),n=0;n=W.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r,e.x-e.margin.left-n/2,e.y,e.x-e.margin.left-n/2,e.y+e.height,n),r=t.getTableTopBorder(i.tableFormat.borders),n=0,n=W.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r,e.x-e.margin.left-n,e.y-n/2,e.x+e.width+n+e.margin.right,e.y-n/2,n),r=t.getTableRightBorder(i.tableFormat.borders),n=0,n=W.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r,e.x+e.width+e.margin.right+n/2,e.y,e.x+e.width+e.margin.right+n/2,e.y+e.height,n),r=t.getTableBottomBorder(i.tableFormat.borders),n=0,n=W.convertPointToPixel(r.getLineWidth()),this.renderSingleBorder(r,e.x-e.margin.left-n,e.y+e.height-n/2,e.x+e.width+n+e.margin.right,e.y+e.height-n/2,n)},e.prototype.renderTableCellOutline=function(e,i){var r=e.layout,n=i,o=0,a=0,s=0,l=0,d=0;n.cellFormat.borders,i.containerWidget instanceof X&&(a=i.margin.bottom-i.containerWidget.bottomBorderWidth,o=i.margin.top-i.containerWidget.topBorderWidth),s=i.margin.left-i.leftBorderWidth,l=i.margin.right-i.rightBorderWidth,d=t.isNullOrUndefined(n.ownerRow)||"Exactly"!==n.ownerRow.rowFormat.heightType?!t.isNullOrUndefined(n.ownerRow)&&[n.ownerRow].length<=1?Math.max(W.convertPointToPixel(n.ownerRow.rowFormat.height),i.height)+o+a:i.height+o+a:W.convertPointToPixel(n.ownerRow.rowFormat.height)+o+a,this.renderCellBackground(d,i);var h=Y.getCellLeftBorder(n),c=0;c=W.convertPointToPixel(h.getLineWidth()),this.renderSingleBorder(h,i.x-s-c,i.y-o,i.x-s-c,i.y+i.height+a,c),h=Y.getCellTopBorder(n),c=W.convertPointToPixel(h.getLineWidth()),this.renderSingleBorder(h,i.x-i.margin.left,i.y-i.margin.top+c/2,i.x+i.width+i.margin.right,i.y-i.margin.top+c/2,c),(n.ownerTable.tableFormat.cellSpacing>0||n.cellIndex===n.ownerRow.childWidgets.length-1)&&(h=Y.getCellRightBorder(n),c=W.convertPointToPixel(h.getLineWidth()),this.renderSingleBorder(h,i.x+i.width+i.margin.right-c/2,i.y-o,i.x+i.width+i.margin.right-c/2,i.y+i.height+a,c));var p=n.ownerRow.nextWidget,g=!1;if(!t.isNullOrUndefined(p)){var u=void 0;(u=p)instanceof X&&i.containerWidget instanceof X&&i.containerWidget.containerWidget instanceof K&&(g=-1!==i.containerWidget.containerWidget.childWidgets.indexOf(u))}(n.ownerTable.tableFormat.cellSpacing>0||n.ownerRow.rowIndex===n.ownerTable.childWidgets.length-1||n.cellFormat.rowSpan>1&&n.ownerRow.rowIndex+n.cellFormat.rowSpan===n.ownerTable.childWidgets.length||!g)&&(h=n.cellFormat.rowSpan>1&&n.ownerRow.rowIndex+n.cellFormat.rowSpan===n.ownerTable.childWidgets.length?n.getBorderBasedOnPriority(n.cellFormat.borders.bottom,Y.getCellBottomBorder(n)):Y.getCellBottomBorder(n),c=W.convertPointToPixel(h.getLineWidth()),this.renderSingleBorder(h,i.x-i.margin.left,i.y+i.height+a+c/2,i.x+i.width+i.margin.right,i.y+i.height+a+c/2,c)),h=r.getCellDiagonalUpBorder(n),(c=W.convertPointToPixel(h.getLineWidth()))>0&&this.renderSingleBorder(h,i.x-s,i.y+i.height+a,i.x+i.width+l,i.y-o,c),h=r.getCellDiagonalDownBorder(n),(c=W.convertPointToPixel(h.getLineWidth()))>0&&this.renderSingleBorder(h,i.x-s,i.y-o,i.x+i.width+l,i.y+i.height+a,c)},e.prototype.renderCellBackground=function(e,t){var i=t.cellFormat,r="#ffffff"===i.shading.backgroundColor?t.ownerTable.tableFormat.shading.backgroundColor:i.shading.backgroundColor;if(this.pageContext.beginPath(),"empty"!==r){this.pageContext.fillStyle=this.getColor(r);var n=t.x-t.margin.left+t.leftBorderWidth,o=t.y-W.convertPointToPixel(t.topMargin),a=t.width+t.margin.left+t.margin.right-t.leftBorderWidth-t.rightBorderWidth;this.pageContext.fillRect(this.getScaledValue(n,1),this.getScaledValue(o,2),this.getScaledValue(a),this.getScaledValue(e)),this.pageContext.closePath()}},e.prototype.renderSingleBorder=function(e,t,i,r,n,o){this.pageContext.beginPath(),this.pageContext.moveTo(this.getScaledValue(t,1),this.getScaledValue(i,2)),this.pageContext.lineTo(this.getScaledValue(r,1),this.getScaledValue(n,2)),this.pageContext.lineWidth=this.getScaledValue(o),this.pageContext.strokeStyle=e.color,o>0&&this.pageContext.stroke(),this.pageContext.closePath()},e.prototype.getScaledValue=function(e,i){return this.isPrinting?e:(t.isNullOrUndefined(i)&&(i=0),e*this.viewer.zoomFactor+(1===i?this.pageLeft:2===i?this.pageTop:0))},e.prototype.destroy=function(){this.viewer=void 0,t.isNullOrUndefined(this.pageCanvasIn)||(this.pageCanvasIn.innerHTML=""),this.pageCanvasIn=void 0},e}(),ge=function(){function e(e){this.owner=e,t.isNullOrUndefined(e)||(this.context=e.containerContext)}return Object.defineProperty(e.prototype,"paragraphMark",{get:function(){return"¶"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineBreakMark",{get:function(){return"↲"},enumerable:!0,configurable:!0}),e.prototype.getParagraphMarkWidth=function(e){return this.getWidth(this.paragraphMark,e)},e.prototype.getParagraphMarkSize=function(e){var t=this.getWidth(this.paragraphMark,e),i=this.getHeight(e);return{Width:t,Height:i.Height,BaselineOffset:i.BaselineOffset}},e.prototype.getTextSize=function(e,t){var i=0;i=this.getWidth(e.text,t),e.width=i;var r=this.getHeight(t);return e.height=r.Height,e.baselineOffset=r.BaselineOffset," "===e.text[e.text.length-1]&&(i=this.getWidth(W.trimEnd(e.text),t)),i},e.prototype.getHeight=function(e){var i=this.getFormatText(e);if(!t.isNullOrUndefined(this.owner.heightInfoCollection[i]))return this.owner.heightInfoCollection[i];var r=this.getHeightInternal(e);return this.owner.heightInfoCollection[i]=r,r},e.prototype.getFormatText=function(e){var t=e.fontFamily.toLocaleLowerCase();return t+=";"+e.fontSize,e.bold&&(t+=";bold"),e.italic&&(t+=";italic"),t},e.prototype.getHeightInternal=function(e){var t=0,i=0,r=document.createElement("span");r.id="tempSpan",r.style.whiteSpace="nowrap",r.innerText="m",this.applyStyle(r,e);document.getElementsByTagName("body");var n=document.createElement("div");n.style.display="inline-block";var o=document.createElement("div");o.setAttribute("style","display:inline-block;width: 1px; height: 0px;vertical-align: baseline;"),n.appendChild(r),n.appendChild(o),document.body.appendChild(n),t=r.offsetHeight;var a=r.offsetTop;return i=o.offsetTop-a,document.body.removeChild(n),{Height:t,BaselineOffset:i}},e.prototype.measureTextExcludingSpaceAtEnd=function(e,t){return this.getWidth(W.trimEnd(e),t)},e.prototype.getWidth=function(e,t){e.match("\v")&&e.replace("\v",this.lineBreakMark);var i="",r="",n="",o=t.fontSize;return i=t.bold?"bold":"",r=t.italic?"italic":"",n=t.fontFamily,o=0===o?.5:o/("Normal"===t.baselineAlignment?1:1.5),this.context.font=i+" "+r+" "+o+"pt "+n,this.context.measureText(e).width},e.prototype.applyStyle=function(e,i){if(!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(i)){""!==i.fontFamily&&(e.style.fontFamily=i.fontFamily);var r=i.fontSize;r<=.5&&(r=.5),e.style.fontSize=r.toString()+"pt",i.bold&&(e.style.fontWeight="bold"),i.italic&&(e.style.fontStyle="italic")}},e.prototype.measureText=function(e,t){var i=this.getWidth(e,t),r=this.getHeight(t);return{Width:i,Height:r.Height,BaselineOffset:r.BaselineOffset}},e.prototype.updateTextSize=function(e,t){var i=new P(void 0),r=e.listLevel.characterFormat,n=t.characterFormat;i.fontSize=11===r.fontSize?n.fontSize:r.fontSize,i.fontFamily="Verdana"===r.fontFamily?n.fontFamily:r.fontFamily;var o="",a="",s="Normal"===r.baselineAlignment?n.baselineAlignment:r.baselineAlignment;o=r.bold?"bold":n.bold?"bold":"",a=r.italic?"italic":n.italic?"italic":"",i.baselineAlignment=s,o&&(i.bold=!0),a&&(i.italic=!0),e.width=this.getWidth(e.text,i);var l=this.getHeight(i);e.height=l.Height,e.baselineOffset=l.BaselineOffset},e.prototype.destroy=function(){this.owner=void 0,this.context=void 0},e}(),ue=function(){function e(e){var t=this;this.onMouseWheelInternal=function(e){if(!0===e.ctrlKey&&(e.preventDefault(),e.pageX-t.viewer.viewerContainer.offsetLeft<t.viewer.pageContainer.offsetWidth)){var i=navigator.userAgent.match("Firefox")?e.detail<0:e.wheelDelta>0,r=t.viewer.zoomFactor;i?r<=4.9?r+=.1:r=5:r>=.2?r-=.1:r=.1,t.viewer.zoomFactor=r}},this.viewer=e}return e.prototype.setZoomFactor=function(e){this.onZoomFactorChanged(),t.isNullOrUndefined(this.viewer.selection)||this.viewer.selection.updateCaretPosition(),this.viewer.updateTouchMarkPosition(),t.isNullOrUndefined(this.viewer.owner.imageResizerModule)||this.viewer.owner.imageResizerModule.updateImageResizerPosition(),this.viewer.owner.fireZoomFactorChange()},e.prototype.onZoomFactorChanged=function(){this.viewer.zoomFactor>5?this.viewer.zoomFactor=5:this.viewer.zoomFactor<.1&&(this.viewer.zoomFactor=.1),this.zoom()},e.prototype.zoom=function(){var e=this.viewer;e.clearContent(),e.handleZoom(),e.updateFocus()},e}(),fe=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),me=function(){function e(e){var i=this;this.textWrap=!0,this.currentPage=void 0,this.selectionStartPageIn=void 0,this.selectionEndPageIn=void 0,this.fieldStacks=[],this.splittedCellWidgets=[],this.tableLefts=[],this.tapCount=0,this.timer=-1,this.isTimerStarted=!1,this.isFirstLineFitInShiftWidgets=!1,this.preZoomFactor=0,this.preDifference=-1,this.fieldEndParagraph=void 0,this.fieldToLayout=void 0,this.backgroundColor="#FFFFFF",this.containerTop=0,this.containerLeft=0,this.isMouseDown=!1,this.isSelectionChangedOnMouseMoved=!1,this.isControlPressed=!1,this.isTouchInput=!1,this.useTouchSelectionMark=!1,this.touchDownOnSelectionMark=0,this.isComposingIME=!1,this.lastComposedText="",this.isCompositionStart=!1,this.isCompositionUpdated=!1,this.isCompositionCanceled=!1,this.isCompositionEnd=!1,this.prefix="",this.suffix="",this.fields=[],this.heightInfoCollection={},this.defaultTabWidth=36,this.lists=[],this.abstractLists=[],this.styles=new L,this.preDefinedStyles=void 0,this.isRowOrCellResizing=!1,this.isMouseDownInFooterRegion=!1,this.pageFitTypeIn="None",this.fieldCollection=[],this.isPageField=!1,this.mouseDownOffset=new T(0,0),this.zoomFactorInternal=1,this.onTextInput=function(e){if(!i.isComposingIME){e.preventDefault();var t=e.data;i.owner.editor.handleTextInput(t)}},this.compositionStart=function(e){t.Browser.isDevice||i.owner.isReadOnlyMode||(i.isComposingIME=!0,i.positionEditableTarget(),i.owner.editorHistory&&i.owner.editor.initComplexHistory("IMEInput")),i.isCompositionStart=!0},this.compositionUpdated=function(e){i.isComposingIME&&!i.owner.isReadOnlyMode&&setTimeout(function(){i.owner.editor.insertIMEText(i.getEditableDivTextContent(),!0)},0),i.isCompositionUpdated=!0},this.compositionEnd=function(e){if(i.isComposingIME&&!i.owner.isReadOnlyMode){var t=i.getEditableDivTextContent();""!==t&&i.owner.editor.insertIMEText(t,!1),i.isComposingIME=!1,i.lastComposedText="",i.iframe.setAttribute("style","pointer-events:none;position:absolute;top:-10000px"),i.editableDiv.innerHTML="",i.owner.editorHistory&&(i.owner.editorHistory.updateComplexHistory(),""===t&&(i.owner.editorHistory.undo(),i.owner.editorHistory.redoStack.pop()))}e.preventDefault(),i.isCompositionUpdated=!1,i.isCompositionEnd=!0},this.onImageResizer=function(e){!t.isNullOrUndefined(i.owner.imageResizerModule)&&i.owner.imageResizerModule.isImageResizerVisible&&i.owner.imageResizerModule.isImageResizing&&(e instanceof MouseEvent?i.onMouseUpInternal(e):e instanceof TouchEvent&&i.onTouchUpInternal(e))},this.onKeyPressInternal=function(e){if(!i.owner.isReadOnlyMode){var t=e.keyCode||e.charCode,r="";t?r=String.fromCharCode(t):e.key&&(r=e.key),"Spacebar"===r||"\r"===r||"\b"===r||""===r||i.owner.isReadOnlyMode||!1!==e.ctrlKey?"Spacebar"===r&&i.owner.editorModule.handleTextInput(" "):i.owner.editorModule.handleTextInput(r),e.preventDefault()}},this.onTextInputInternal=function(e){i.owner.isReadOnlyMode?i.editableDiv.innerText="":i.owner.editorModule.onTextInputInternal(e)},this.onPaste=function(e){i.owner.isReadOnlyMode||i.owner.editorModule.pasteInternal(e),i.editableDiv.innerText="",e.preventDefault()},this.onFocusOut=function(){if(!t.isNullOrUndefined(i.selection)){if(i.owner.contextMenuModule&&i.owner.contextMenuModule.contextMenuInstance&&"block"===i.owner.contextMenuModule.contextMenuInstance.element.style.display)return;i.selection.hideCaret()}},this.updateFocus=function(){i.selection&&(i.editableDiv.focus(),i.selection.showCaret())},this.scrollHandler=function(){i.clearContent(),i.updateScrollBars();var e=i.containerTop+i.visibleBounds.height;e>i.pageContainer.offsetHeight&&(i.viewerContainer.scrollTop=i.containerTop-(e-i.pageContainer.offsetHeight)),i instanceof ve&&!t.isNullOrUndefined(i.owner)&&i.owner.fireViewChange()},this.onWindowResize=function(){var e,r=i;e=setTimeout(function(){t.isNullOrUndefined(r.owner)||t.isNullOrUndefined(i.owner.element)||(r.updateViewerSizeInternal(document.getElementById(r.owner.element.id)),r.updateScrollBars(),t.isNullOrUndefined(i.selection)||i.selection.updateCaretPosition(),r.updateTouchMarkPosition(),r.owner.contextMenuModule&&r.owner.contextMenuModule.contextMenuInstance&&r.owner.contextMenuModule.contextMenuInstance.close(),e&&clearTimeout(e))},100)},this.onContextMenu=function(e){i.owner.contextMenuModule&&i.owner.contextMenuModule.onContextMenuInternal(e)},this.onMouseDownInternal=function(e){if(!(i.isTouchInput||e.offsetX>i.visibleBounds.width-(i.visibleBounds.width-i.viewerContainer.clientWidth)||e.offsetY>i.visibleBounds.height-(i.visibleBounds.height-i.viewerContainer.clientHeight)||t.isNullOrUndefined(i.selection))){i.updateCursor(e),i.isLeftButtonPressed(e)&&!i.owner.isReadOnlyMode&&i.owner.enableImageResizerMode&&!t.isNullOrUndefined(i.owner.imageResizerModule.selectedResizeElement)&&(i.owner.imageResizerModule.isImageResizing=!0),e.preventDefault(),i.isTouchInput||i.selection.hideCaret();var r=new T(e.offsetX,e.offsetY),n=i.findFocusedPage(r,!0);if(i.mouseDownOffset.x=n.x,i.mouseDownOffset.y=n.y,i.isMouseDownInFooterRegion=i.selection.isCursorInsidePageRect(r,i.currentPage)&&i.selection.isCursorInFooterRegion(r,i.currentPage),i.isSelectionChangedOnMouseMoved=!1,!i.owner.isReadOnlyMode&&(i.owner.editorModule.tableResize.isInCellResizerArea(n)||i.owner.editorModule.tableResize.isInRowResizerArea(n)))return i.selection.hideCaret(),i.isMouseDown=!0,i.isSelectionChangedOnMouseMoved=!1,void(i.isLeftButtonPressed(e)&&(i.owner.editorModule.tableResize.startingPoint.x=n.x,i.owner.editorModule.tableResize.startingPoint.y=n.y,i.owner.editorModule.tableResize.handleResize(n)));if(e.ctrlKey&&(i.isControlPressed=!0),i.owner.selection.isEmpty&&(i.useTouchSelectionMark=!1),3===e.which&&!i.owner.selection.isEmpty&&i.selection.checkCursorIsInSelection(i.getLineWidget(n),n))return void e.preventDefault();i.isTouchInput=!1,i.isMouseDown=!0,i.updateFocus(),i.timer=setTimeout(function(){4===++i.tapCount&&(i.tapCount=1)},200)}},this.onMouseMoveInternal=function(e){if(e.preventDefault(),!t.isNullOrUndefined(i.selection)){if(!i.owner.isReadOnlyMode&&i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizing)return void(i.owner.imageResizerModule.isImageMoveToNextPage||i.owner.imageResizerModule.handleImageResizingOnMouse(e));var r=new T(e.offsetX,e.offsetY),n=i.findFocusedPage(r,!i.owner.enableHeaderAndFooter);if(i.isMouseDown){if(!t.isNullOrUndefined(i.currentPage)){var o=n.x,a=n.y;if(!i.owner.isReadOnlyMode&&i.isRowOrCellResizing)i.owner.editorModule.tableResize.handleResizing(n);else if(i.isTouchInput||i.isSelectionChangedOnMouseMoved||i.touchDownOnSelectionMark>0||i.updateTextPositionForSelection(n,1),i.isLeftButtonPressed(e)){e.preventDefault();var s=a,l=i.owner.selection.end,d=new T(o,s);i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizerVisible||i.owner.selection.moveTextPosition(d,l),i.isSelectionChangedOnMouseMoved=!0}}i.selection.checkForCursorVisibility()}i.isRowOrCellResizing||i.isSelectionChangedOnMouseMoved||i.updateCursor(e),i.isRowOrCellResizing&&i.selection.hideCaret()}},this.onDoubleTap=function(e){if(!t.isNullOrUndefined(i.selection)){i.isTouchInput=!1;var r=new T(e.offsetX,e.offsetY);if(i.selection.checkAndEnableHeaderFooter(r,i.findFocusedPage(r,!0)))return;!i.selection.isEmpty||t.isNullOrUndefined(i.currentPage)||t.isNullOrUndefined(i.owner.selection.start)||(i.owner.selection.selectCurrentWord(),i.selection.checkForCursorVisibility(),i.tapCount=2)}},this.onMouseUpInternal=function(e){e.preventDefault(),i.isListTextSelected=!1;var r=new T(e.offsetX,e.offsetY),n=i.findFocusedPage(r,!0);if(!t.isNullOrUndefined(i.selection)){var o=1;if(t.Browser.isIE?o=i.tapCount:e.detail>2&&(o=e.detail),i.isRowOrCellResizing&&i.owner.editorModule.tableResize.updateResizingHistory(n),!i.isMouseDown||i.isSelectionChangedOnMouseMoved||t.isNullOrUndefined(i.currentPage)||t.isNullOrUndefined(i.owner.selection.start)||i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizing||(0!==i.touchDownOnSelectionMark||i.isRowOrCellResizing||(i.updateTextPositionForSelection(n,o),t.Browser.isIE&&2===o&&i.selection.checkAndEnableHeaderFooter(r,n)),i.selection.checkForCursorVisibility()),t.isNullOrUndefined(i.currentPage)||t.isNullOrUndefined(i.owner.selection.start)||!i.owner.selection.isEmpty&&!i.owner.selection.isImageSelected||!(e.ctrlKey&&i.owner.useCtrlClickToFollowHyperlink||!i.owner.useCtrlClickToFollowHyperlink)||!0!==i.isLeftButtonPressed(e)||i.selection.navigateHyperLinkOnEvent(n,!1),!i.owner.isReadOnlyMode&&i.isSelectionInListText(n)&&i.selection.selectListText(),!i.owner.isReadOnlyMode&&i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizing&&(i.owner.imageResizerModule.mouseUpInternal(),i.scrollToPosition(i.owner.selection.start,i.owner.selection.end),i.owner.imageResizerModule.isImageResizing=!1,i.owner.imageResizerModule.updateHistoryForImageResizer()),i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizerVisible&&!t.isNullOrUndefined(i.selection.caret)&&(i.selection.caret.style.display="none"),i.isMouseDown=!1,i.isSelectionChangedOnMouseMoved=!1,i.isTouchInput=!1,i.useTouchSelectionMark=!0,i.isControlPressed=!1,i.updateFocus(),i.isListTextSelected&&i.selection.hideCaret(),i.owner.enableImageResizerMode){var a=i.owner.imageResizerModule;a.isImageResizing=!1,a.isImageMoveToNextPage=!1,a.leftValue=void 0,a.topValue=void 0}i.isMouseDownInFooterRegion=!1}},this.onTouchStartInternal=function(e){if(i.selection){if(i.isCompositionStart=!1,i.isCompositionEnd=!1,i.isCompositionUpdated=!1,i.isCompositionCanceled=!0,i.isTouchInput=!0,i.isTimerStarted?1===i.tapCount?i.tapCount=2:(i.tapCount=3,i.isTimerStarted=!1):(i.isTimerStarted=!0,i.tapCount=1),1===e.touches.length){i.zoomX=e.touches[0].clientX,i.zoomY=e.touches[0].clientY,i.owner.selection.isEmpty&&(i.useTouchSelectionMark=!1),i.isMouseDown=!0,i.isSelectionChangedOnMouseMoved=!1;var r=void 0;if(i.isMouseDown&&(r=i.getTouchOffsetValue(e)),r=i.findFocusedPage(r,!0),i.owner.enableImageResizerMode){var n=i.owner.imageResizerModule.getImagePointOnTouch(r);i.owner.imageResizerModule.selectedResizeElement=n.selectedElement}i.owner.enableImageResizerMode&&!t.isNullOrUndefined(i.owner.imageResizerModule.selectedResizeElement)&&(i.owner.imageResizerModule.isImageResizing=!0);var o=i.owner.selection.end.location.x,a=i.selection.getCaretBottom(i.owner.selection.end,i.owner.selection.isEmpty)+9;i.touchDownOnSelectionMark=(r.y<=a&&r.y>=a-20||r.y>=a&&r.y<=a+20)&&(r.x<=o&&r.x>=o-20||r.x>=o&&r.x<=o+20)?1:0,i.owner.selection.isEmpty||0!==i.touchDownOnSelectionMark||(o=i.owner.selection.start.location.x,a=i.selection.getCaretBottom(i.owner.selection.start,!1)+9,i.touchDownOnSelectionMark=(r.y<=a&&r.y>=a-20||r.y>=a&&r.y<=a+20)&&(r.x<=o&&r.x>=o-20||r.x>=o&&r.x<=o+20)?2:0)}!t.isNullOrUndefined(i.owner.contextMenuModule)&&i.owner.contextMenuModule.contextMenuInstance&&i.owner.contextMenuModule.contextMenuInstance.close(),(i.touchDownOnSelectionMark||e.touches.length>1)&&e.preventDefault(),i.timer=setTimeout(function(){i.isTimerStarted=!1},200)}},this.onTouchMoveInternal=function(e){var r,n=e.touches;if(!t.isNullOrUndefined(i.selection)){if(i.owner.editorModule&&i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizing)return e.preventDefault(),void(i.owner.imageResizerModule.isImageMoveToNextPage||(i.owner.imageResizerModule.handleImageResizingOnTouch(e),i.selection.caret.style.display="none"));if(i.isMouseDown){r=i.getTouchOffsetValue(e);var o=i.findFocusedPage(r,!0);if(i.touchDownOnSelectionMark>0){e.preventDefault();var a=o.y,s=i.owner.selection.end;o.y<=26?a-=o.y<0?0:o.y+.5:a-=36.5,s=2===i.touchDownOnSelectionMark?i.selection.start:i.selection.end,o=new T(o.x,a),i.owner.selection.moveTextPosition(o,s),i.isSelectionChangedOnMouseMoved=!0}i.selection.checkForCursorVisibility()}}if(n.length>1){e.preventDefault(),i.isMouseDown=!1,i.zoomX=(n[0].clientX+n[1].clientX)/2,i.zoomY=(n[0].clientY+n[1].clientY)/2;var l=Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2));i.preDifference>-1?l>i.preDifference?i.onPinchOutInternal(e):l<i.preDifference&&i.onPinchInInternal(e):i.zoomFactor<2?-1!==i.preDifference&&l>i.preDifference&&i.onPinchInInternal(e):-1===i.preDifference&&i.zoomFactor>2&&l>i.preDifference&&i.onPinchInInternal(e),i.preDifference=l}},this.onTouchUpInternal=function(e){if(!t.isNullOrUndefined(i.selection)){var r=i.getTouchOffsetValue(e),n=i.findFocusedPage(r,!0);1===e.changedTouches.length&&(i.zoomX=void 0,i.zoomY=void 0,!i.isMouseDown||i.isSelectionChangedOnMouseMoved||t.isNullOrUndefined(i.currentPage)||t.isNullOrUndefined(i.owner.selection.start)||(0===i.touchDownOnSelectionMark&&(i.updateTextPositionForSelection(new T(n.x,n.y),i.tapCount),2===i.tapCount&&i.selection.checkAndEnableHeaderFooter(r,n)),i.owner.selection.isEmpty&&i.selection.updateCaretPosition(),i.selection.checkForCursorVisibility()),t.isNullOrUndefined(i.currentPage)||t.isNullOrUndefined(i.selection.start)||i.isSelectionChangedOnMouseMoved||!(i.selection.isEmpty||i.selection.isImageField()&&(!i.owner.enableImageResizerMode||i.owner.enableImageResizerMode&&!i.owner.imageResizerModule.isImageResizing))||i.selection.navigateHyperLinkOnEvent(n,!0),i.isMouseDown=!1,i.touchDownOnSelectionMark=0,i.useTouchSelectionMark=!0,i.isSelectionChangedOnMouseMoved=!1),i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizing&&(i.owner.imageResizerModule.mouseUpInternal(),i.owner.imageResizerModule.isImageResizing=!1,i.owner.imageResizerModule.isImageMoveToNextPage=!1,i.scrollToPosition(i.owner.selection.start,i.owner.selection.end),i.owner.imageResizerModule.updateHistoryForImageResizer()),i.owner.enableImageResizerMode&&i.owner.imageResizerModule.isImageResizerVisible&&i.isTouchInput&&(i.touchStart.style.display="none",i.touchEnd.style.display="none"),e.preventDefault()}i.preDifference=-1,i.isTouchInput=!1,i.isTimerStarted||(i.tapCount=1),i.isListTextSelected&&i.selection.hideCaret()},this.onKeyUpInternal=function(e){t.Browser.isDevice&&window.getSelection().anchorOffset!==i.prefix.length&&i.selection.setEditableDivCaretPosition(i.editableDiv.innerText.length),(e.ctrlKey||17===e.keyCode||17===e.which)&&(i.isControlPressed=!1)},this.onKeyDownInternal=function(e){var r=!1,n={event:e,isHandled:!1,source:i.owner};if(i.owner.trigger("keyDown",n),!n.isHandled){var o=e.which||e.keyCode,a=!(!e.ctrlKey&&!e.metaKey)||17===o,s=e.shiftKey?e.shiftKey:16===o,l=e.altKey?e.altKey:18===o;if(a&&!s&&!l)switch(o){case 80:e.preventDefault(),i.owner.print(),r=!0;break;case 83:e.preventDefault(),i.owner.save(""===i.owner.documentName?"sample":i.owner.documentName,"Sfdt"),r=!0}r||t.isNullOrUndefined(i.selection)||i.selection.onKeyDownInternal(e,a,s,l),r&&e.preventDefault()}},this.owner=e,this.pages=[],this.render=new pe(this),this.lists=[],this.abstractLists=[],this.characterFormat=new P(this),this.paragraphFormat=new F(this),this.renderedLists=new c,this.headersFooters=[],this.styles=new L,this.preDefinedStyles=new c,this.initalizeStyles(),this.bookmarks=new c}return Object.defineProperty(e.prototype,"containerCanvas",{get:function(){return t.isNullOrUndefined(this.containerCanvasIn)&&(this.containerCanvasIn=document.createElement("canvas"),this.containerCanvasIn.getContext("2d").save()),t.isNullOrUndefined(this.pageContainer)||this.containerCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.containerCanvasIn),this.containerCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionCanvas",{get:function(){return t.isNullOrUndefined(this.selectionCanvasIn)&&(this.selectionCanvasIn=document.createElement("canvas"),this.selectionCanvas.getContext("2d").save()),t.isNullOrUndefined(this.pageContainer)||this.selectionCanvasIn.parentElement===this.pageContainer||this.pageContainer.appendChild(this.selectionCanvasIn),this.selectionCanvasIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"containerContext",{get:function(){return this.containerCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionContext",{get:function(){return this.selectionCanvas.getContext("2d")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentRenderingPage",{get:function(){if(0!==this.pages.length)return this.pages[this.pages.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"visibleBounds",{get:function(){return this.visibleBoundsIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"zoomFactor",{get:function(){return this.zoomFactorInternal},set:function(e){this.zoomFactorInternal!==e&&(this.preZoomFactor=this.zoomFactor,this.zoomFactorInternal=e,this.zoomModule.setZoomFactor(e),this.owner.zoomFactor=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStartPage",{get:function(){return this.selectionStartPageIn},set:function(e){this.selectionStartPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEndPage",{get:function(){return this.selectionEndPageIn},set:function(e){this.selectionEndPageIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog",{get:function(){return this.dialogInternal||this.initDialog(),this.dialogInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dialog2",{get:function(){return this.dialogInternal2||this.initDialog2(),this.dialogInternal2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageFitType",{get:function(){return this.pageFitTypeIn},set:function(e){this.pageFitTypeIn=e,this.onPageFitTypeChanged(this.pageFitTypeIn)},enumerable:!0,configurable:!0}),e.prototype.initalizeStyles=function(){this.preDefinedStyles.add("Normal",'{"type":"Paragraph","name":"Normal","next":"Normal"}'),this.preDefinedStyles.add("Heading 1",'{"type":"Paragraph","name":"Heading 1","basedOn":"Normal","next":"Normal","link":"Heading 1 Char","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":12.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level1"}}'),this.preDefinedStyles.add("Heading 2",'{"type":"Paragraph","name":"Heading 2","basedOn":"Normal","next":"Normal","link":"Heading 2 Char","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level2"}}'),this.preDefinedStyles.add("Heading 3",'{"type":"Paragraph","name":"Heading 3","basedOn":"Normal","next":"Normal","link":"Heading 3 Char","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level3"}}'),this.preDefinedStyles.add("Heading 4",'{"type":"Paragraph","name":"Heading 4","basedOn":"Normal","next":"Normal","link":"Heading 4 Char","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level4"}}'),this.preDefinedStyles.add("Heading 5",'{"type":"Paragraph","name":"Heading 5","basedOn":"Normal","next":"Normal","link":"Heading 5 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level5"}}'),this.preDefinedStyles.add("Heading 6",'{"type":"Paragraph","name":"Heading 6","basedOn":"Normal","next":"Normal","link":"Heading 6 Char","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"},"paragraphFormat":{"leftIndent":0.0,"rightIndent":0.0,"firstLineIndent":0.0,"beforeSpacing":2.0,"afterSpacing":0.0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","textAlignment":"Left","outlineLevel":"Level6"}}'),this.preDefinedStyles.add("Default Paragraph Font",'{"type":"Character","name":"Default Paragraph Font"}'),this.preDefinedStyles.add("Heading 1 Char",'{"type":"Character","name":"Heading 1 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":16.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 2 Char",'{"type":"Character","name":"Heading 2 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":13.0,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 3 Char",'{"type":"Character","name":"Heading 3 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontSize":12.0,"fontFamily":"Calibri Light","fontColor": "#1F3763"}}'),this.preDefinedStyles.add("Heading 4 Char",'{"type":"Character","name":"Heading 4 Char","basedOn":"Default Paragraph Font","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 5 Char",'{"type":"Character","name":"Heading 5 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496"}}'),this.preDefinedStyles.add("Heading 6 Char",'{"type":"Character","name":"Heading 6 Char","basedOn":"Default Paragraph Font","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763"}}'),this.preDefinedStyles.add("Hyperlink",'{"type":"Character","name":"Hyperlink","basedOn":"Default Paragraph Font","next":"Normal","characterFormat":{"fontColor":"#0563C1","underline": "Single"}}'),this.preDefinedStyles.add("Toc1",'{"type":"Paragraph","name":"Toc1","basedOn":"Normal","next":"Normal","paragraphFormat":{"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc2",'{"type":"Paragraph","name":"Toc2","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :11.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc3",'{"type":"Paragraph","name":"Toc3","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :22.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc4",'{"type":"Paragraph","name":"Toc4","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :33.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc5",'{"type":"Paragraph","name":"Toc5","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :44.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc6",'{"type":"Paragraph","name":"Toc6","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :55.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc7",'{"type":"Paragraph","name":"Toc7","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :66.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc8",'{"type":"Paragraph","name":"Toc8","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :77.0,"afterSpacing":5.0}}'),this.preDefinedStyles.add("Toc9",'{"type":"Paragraph","name":"Toc9","basedOn":"Normal","next":"Normal","paragraphFormat":{"leftIndent" :88.0,"afterSpacing":5.0}}')},e.prototype.clearDocumentItems=function(){this.headersFooters=[],this.fields=[],this.bookmarks.clear(),this.styles.clear(),this.characterFormat.clearFormat(),this.paragraphFormat.clearFormat()},e.prototype.getAbstractListById=function(e){if(!t.isNullOrUndefined(this.abstractLists))for(var i=0;i<this.abstractLists.length;i++){var r=this.abstractLists[i];if(r instanceof de&&r.abstractListId===e)return r}},e.prototype.getListById=function(e){if(!t.isNullOrUndefined(this.lists))for(var i=0;i<this.lists.length;i++)if(!t.isNullOrUndefined(this.lists[i])&&this.lists[i].listId===e)return this.lists[i]},e.getListLevelNumber=function(e){return e.ownerBase instanceof w?e.ownerBase.levelNumber:e.ownerBase instanceof de&&!t.isNullOrUndefined(e.ownerBase.levels)?e.ownerBase.levels.indexOf(e):-1},e.prototype.getBookmarks=function(e){for(var t=[],i=0;i<this.bookmarks.keys.length;i++){var r=this.bookmarks.keys[i];(e||0!==r.indexOf("_"))&&t.push(r)}return t},e.prototype.initializeComponents=function(){var e=this.owner.element;t.isNullOrUndefined(e)||(this.optionsPaneContainer=t.createElement("div",{className:"e-documenteditor-optionspane"}),e.appendChild(this.optionsPaneContainer),this.viewerContainer=t.createElement("div",{id:this.owner.containerId+"_viewerContainer"}),this.viewerContainer.style.cssText="position:relative;backgroundColor:#FBFBFB;overflow:auto",this.optionsPaneContainer.appendChild(this.viewerContainer),this.viewerContainer.tabIndex=0,this.viewerContainer.style.outline="none",this.pageContainer=t.createElement("div",{id:this.owner.containerId+"_pageContainer",className:"e-de-background"}),this.viewerContainer.appendChild(this.pageContainer),this.pageContainer.style.top="0px",this.pageContainer.style.left="0px",this.pageContainer.style.position="relative",this.pageContainer.style.pointerEvents="none",t.Browser.isDevice?this.createEditableDiv(e):this.createEditableIFrame(),this.owner.enableImageResizerMode&&this.owner.imageResizerModule.initializeImageResizer(),this.updateViewerSizeInternal(e),this.layout=new ce(this),this.textHelper=new ge(this),this.zoomModule=new ue(this),this.initTouchEllipse(),this.wireEvent())},e.prototype.createEditableDiv=function(e){this.editableDiv=document.createElement("div"),this.editableDiv.contentEditable="true",this.editableDiv.style.position="fixed",this.editableDiv.style.left="-150em",this.editableDiv.style.width="100%",this.editableDiv.style.height="100%",this.editableDiv.id=e.id+"_editableDiv",document.body.appendChild(this.editableDiv)},e.prototype.createEditableIFrame=function(){this.iframe=t.createElement("iframe",{attrs:{scrolling:"no",src:"javascript:false",style:"pointer-events:none;position:absolute;top:-10000px"},className:"e-de-text-target"});this.viewerContainer.appendChild(this.iframe),this.iframe.contentDocument.open(),this.iframe.contentDocument.write('<!DOCTYPE html><html><head></head><body spellcheck="false"style="background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;" ><div contenteditable="true" style="background-color:transparent;width:100%;height:100%;padding: 0px; margin: 0px;"></div></body></html>'),this.iframe.contentDocument.close(),this.editableDiv=this.iframe.contentDocument.body.children[0]},e.prototype.wireEvent=function(){t.isNullOrUndefined(this.selection)||this.selection.initCaret(),this.editableDiv.addEventListener("paste",this.onPaste),t.Browser.isDevice?this.editableDiv.addEventListener("input",this.onTextInputInternal):(this.editableDiv.addEventListener("keypress",this.onKeyPressInternal),"chrome"===t.Browser.info.name&&this.editableDiv.addEventListener("textInput",this.onTextInput)),this.editableDiv.addEventListener("blur",this.onFocusOut),this.editableDiv.addEventListener("keydown",this.onKeyDownInternal),this.editableDiv.addEventListener("compositionstart",this.compositionStart),this.editableDiv.addEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.addEventListener("compositionend",this.compositionEnd),this.viewerContainer.addEventListener("scroll",this.scrollHandler),this.viewerContainer.addEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.addEventListener("keydown",this.onKeyDownInternal),this.viewerContainer.addEventListener("mousemove",this.onMouseMoveInternal),this.viewerContainer.addEventListener("contextmenu",this.onContextMenu),this.viewerContainer.addEventListener("dblclick",this.onDoubleTap),this.viewerContainer.addEventListener("mouseup",this.onMouseUpInternal),window.addEventListener("resize",this.onWindowResize),window.addEventListener("keyup",this.onKeyUpInternal),window.addEventListener("mouseup",this.onImageResizer),window.addEventListener("touchend",this.onImageResizer),this.viewerContainer.addEventListener("touchstart",this.onTouchStartInternal),this.viewerContainer.addEventListener("touchmove",this.onTouchMoveInternal),this.viewerContainer.addEventListener("touchend",this.onTouchUpInternal),navigator.userAgent.match("Firefox")&&this.viewerContainer.addEventListener("DOMMouseScroll",this.zoomModule.onMouseWheelInternal),this.viewerContainer.addEventListener("mousewheel",this.zoomModule.onMouseWheelInternal)},e.prototype.getEditableDivTextContent=function(){return this.editableDiv.textContent},e.prototype.positionEditableTarget=function(){var e=this.selection.getRect(this.selection.start),t=this.selection.getSelectionPage(this.selection.start),i=(this.selection.updateCaretSize(this.owner.selection.start),t.bodyWidgets[0].sectionFormat),r=t.boundingRectangle.x+W.convertPointToPixel(i.leftMargin)*this.zoomFactor,n=e.y,o=i.pageWidth-i.leftMargin-i.rightMargin,a="left:"+r+"px;";a+="top:"+n+"px;",a+="width:"+W.convertPointToPixel(o)*this.zoomFactor+"px;",a+="height:250px;outline-style:none;position:absolute",this.iframe.setAttribute("style",a);var s="background-color:transparent;width:100%;height:250px;padding: 0px; margin: 0px;";s+="text-indent:"+(e.x-r)+"px;",s+="color:transparent;pointer-events:none;outline-style:none;",s+="font-size:"+W.convertPointToPixel(this.selection.characterFormat.fontSize)*this.zoomFactor+"px;",s+="font-family"+this.selection.characterFormat.fontFamily+";",s+="overflow:hidden;text-decoration:none;white-space:normal;",this.editableDiv.setAttribute("style",s)},e.prototype.initDialog=function(){this.dialogInternal||(this.dialogTarget=t.createElement("div",{className:"e-de-dlg-target"}),document.body.appendChild(this.dialogTarget),this.dialogInternal=new n.Dialog({target:document.body,showCloseIcon:!0,allowDragging:!0,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"center"},zIndex:20}),this.dialogInternal.open=this.selection.hideCaret,this.dialogInternal.beforeClose=this.updateFocus,this.dialogInternal.appendTo(this.dialogTarget))},e.prototype.initDialog2=function(){if(!this.dialogInternal2){var e=t.createElement("div",{className:"e-de-dlg-target"});document.body.appendChild(e),this.dialogInternal2=new n.Dialog({target:document.body,showCloseIcon:!0,allowDragging:!0,visible:!1,width:"1px",isModal:!0,position:{X:"center",Y:"Top"},zIndex:10}),this.dialogInternal2.appendTo(e)}},e.prototype.clearContent=function(){this.containerContext.clearRect(0,0,this.containerCanvas.width,this.containerCanvas.height),this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},e.prototype.onDocumentChanged=function(e){this.clearContent(),this.owner.editorModule&&(this.owner.editorModule.tocStyles={},this.owner.editorModule.tocBookmarkId=0),this.heightInfoCollection={},this.owner.isDocumentLoaded=!1;for(var i=0;i<this.pages.length;i++)this.pages[i].bodyWidgets[0].destroy();this.pages=[],t.isNullOrUndefined(this.renderedLists)||this.renderedLists.clear(),t.isNullOrUndefined(this.owner.editorHistory)||this.owner.editorHistory.destroy(),this.owner.isDocumentLoaded=!0,this.layout.isInitialLoad=!0,this.layout.layoutItems(e),this.owner.selection&&this.owner.selection.selectRange(this.owner.documentStart,this.owner.documentStart),this.owner.optionsPaneModule&&this.owner.optionsPaneModule.showHideOptionsPane(!1),this.owner.fireDocumentChange()},e.prototype.initTouchEllipse=function(){var e="height: 30px;width: 30px;position: absolute;background-color: transparent;margin: 0px;padding: 0px;z-index:5",i=" height: 12px;width: 12px;border-radius: 50%;background-color: white;position: absolute;margin: 0px 6px 0px 6px;border-width: 2px;border-style: solid;border-color: #000000;";this.touchStart=t.createElement("div",{className:"e-touch-ellipse",styles:e});var r=t.createElement("div",{styles:i});this.touchEnd=t.createElement("div",{className:"e-touch-ellipse",styles:e}),this.touchStart.style.display="none";var n=t.createElement("div",{styles:i});this.touchStart.appendChild(r),this.touchEnd.appendChild(n),this.touchEnd.style.display="none",this.viewerContainer.appendChild(this.touchStart),this.viewerContainer.appendChild(this.touchEnd)},e.prototype.updateTouchMarkPosition=function(){if("none"!==this.touchStart.style.display&&!t.isNullOrUndefined(this.selection))if(this.selection.isEmpty)this.selection.updateCaretPosition();else{var e=this.selection.getCaretBottom(this.selection.start,!1),i=this.selection.getPage(this.selection.start.paragraph),r=this,n=(i.boundingRectangle.y-r.pageGap*(this.pages.indexOf(i)+1))*this.zoomFactor+r.pageGap*(this.pages.indexOf(i)+1);this.touchStart.style.left=i.boundingRectangle.x+(Math.round(this.selection.start.location.x)*this.zoomFactor-14)+"px",this.touchStart.style.top=n+e*this.zoomFactor+"px",this.selection.isEmpty||(e=this.selection.getCaretBottom(this.selection.end,!1),i=this.selection.getPage(this.selection.end.paragraph)),this.touchEnd.style.left=i.boundingRectangle.x+(Math.round(this.selection.end.location.x)*this.zoomFactor-14)+"px",this.touchEnd.style.top=n+e*this.zoomFactor+"px"}},e.prototype.isSelectionInListText=function(e){var i=this.getLineWidget(e);if(!t.isNullOrUndefined(i)&&i.children[0]instanceof ne){var r=this.getLeftValue(i),n=i.children[0].width,o=i.children[0].height;if(this.isInsideRect(r,i.paragraph.y,n,o,e))return this.selectionLineWidget=i,!0}return!1},e.prototype.isInsideRect=function(e,t,i,r,n){return n.x>e&&n.x<=e+i&&n.y>t&&n.y<=t+r},e.prototype.getLeftValue=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.selection.isParagraphFirstLine(e)&&("Right"===i.textAlignment?(t-=W.convertPointToPixel(i.firstLineIndent),t-=W.convertPointToPixel(i.leftIndent)):t+=W.convertPointToPixel(i.firstLineIndent));var r=e.children[0];return r instanceof ne&&(t+=r.margin.left),t},e.prototype.isLeftButtonPressed=function(e){return this.isTouchInput=!1,1===(e.which||e.button)},e.prototype.getTouchOffsetValue=function(e){var i=this.viewerContainer.getBoundingClientRect(),r=e.touches[0];t.isNullOrUndefined(r)&&(r=e.changedTouches[0]);var n=r.pageX-i.left,o=r.pageY-i.top;return new T(n,o)},e.prototype.onPinchInInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor-.01;t<5&&t>2&&(t-=.01),t<.1&&(t=.1),this.zoomFactor=t},e.prototype.onPinchOutInternal=function(e){this.preZoomFactor=this.zoomFactor;var t=this.zoomFactor+.01;t>2&&(t+=.01),t>5&&(t=5),this.zoomFactor=t},e.prototype.getPageWidth=function(e){return e.boundingRectangle.width},e.prototype.removePage=function(e){this.currentPage===e&&(this.currentPage=void 0);var i=this.pages.indexOf(e);this.pages.splice(i,1);var r=this;if(!t.isNullOrUndefined(r.visiblePages)&&r.visiblePages.indexOf(e)>-1){var n=r.visiblePages.indexOf(e);r.visiblePages.splice(n,1)}for(var o=0,a=0;a<this.pages.length;a++)o+=this.pages[a].boundingRectangle.height;o-=e.boundingRectangle.height+20;var s=20;if(i>0&&(s+=this.pages[i-1].boundingRectangle.bottom),-1!==i)for(a=i;a<this.pages.length;a++)(e=this.pages[a]).boundingRectangle=new D(e.boundingRectangle.x,s,e.boundingRectangle.width,e.boundingRectangle.height),s=e.boundingRectangle.bottom+20,e.repeatHeaderRowTableWidget=!1},e.prototype.updateViewerSize=function(){var e=this,i=this.owner.getDocumentEditorElement();e.updateViewerSizeInternal(i),e.updateScrollBars(),t.isNullOrUndefined(this.selection)||this.selection.updateCaretPosition()},e.prototype.updateViewerSizeInternal=function(e){if(!t.isNullOrUndefined(e)){var i=e.getBoundingClientRect(),r=0,n=0;if(n=i.height>0?i.height:200,this.owner.optionsPaneModule&&this.owner.optionsPaneModule.isOptionsPaneShow){var o=this.owner.optionsPaneModule.optionsPane.getBoundingClientRect();r=i.width-o.width>0?i.width-o.width:200}else r=i.width>0?i.width:200;this.viewerContainer.style.height=n.toString()+"px",this.viewerContainer.style.width=Math.ceil(r)+"px",this.visibleBoundsIn=new D(0,0,r,n),this.containerCanvas.width=r,this.containerCanvas.height=n,this.selectionCanvas.width=r,this.selectionCanvas.height=n}},e.prototype.updateClientAreaForBlock=function(e,i,r){var n=W.convertPointToPixel(e.leftIndent),o=W.convertPointToPixel(e.rightIndent);if(i)if(e instanceof K&&r){var a=r[0];this.clientActiveArea.x=this.clientArea.x=a.x,this.clientActiveArea.width=this.clientArea.width=a.width,(a=r[r.length-1]).x=this.clientActiveArea.x,a.y=this.clientActiveArea.y,this.clientArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new D(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}else{if(e instanceof K&&!t.isNullOrUndefined(e.tableFormat)&&"Left"!==e.tableFormat.tableAlignment){e.isGridUpdated||(e.buildTableColumns(),e.isGridUpdated=!0);var s=e.getMaxRowWidth(e.getTableClientWidth(e.getOwnerWidth(!1)));this.owner.editor&&this.owner.editor.tableResize.currentResizingTable===e&&0===this.owner.editor.tableResize.resizerPosition&&(s=e.tableHolder.tableWidth),s=W.convertPointToPixel(s),n="Center"===e.tableFormat.tableAlignment?(this.clientArea.width-s)/2:this.clientArea.width-s,this.tableLefts.push(n)}this.clientActiveArea.x=this.clientArea.x=this.clientArea.x+n;l=this.clientArea.width-(n+o);this.clientActiveArea.width=this.clientArea.width=l>0?l:0,this.clientArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new D(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}else{e instanceof K&&"Left"!==e.tableFormat.tableAlignment&&this.tableLefts.length>0&&(n=this.tableLefts.pop()),this.clientActiveArea.x=this.clientArea.x=this.clientArea.x-n;var l=this.clientArea.width+n+o;this.clientActiveArea.width=this.clientArea.width=l>0?l:0,this.clientArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new D(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)}},e.prototype.cutFromLeft=function(e){e<this.clientActiveArea.x&&(e=this.clientActiveArea.x),e>this.clientActiveArea.right&&this.textWrap&&(e=this.clientActiveArea.right),this.clientActiveArea.width=this.clientActiveArea.right>e?this.clientActiveArea.right-e:0,this.clientActiveArea.x=e},e.prototype.cutFromTop=function(e){e<this.clientActiveArea.y&&(e=this.clientActiveArea.y),e>this.clientActiveArea.bottom&&(e=this.clientActiveArea.bottom),this.clientActiveArea.height=this.clientActiveArea.bottom-e,this.clientActiveArea.x=this.clientArea.x,this.clientActiveArea.width=this.clientArea.width,this.clientActiveArea.y=e},e.prototype.updateClientWidth=function(e){this.clientActiveArea.x-=e,this.clientActiveArea.width+e>0?this.clientActiveArea.width+=e:this.clientActiveArea.width=0},e.prototype.insertPage=function(e,t){this.pages.indexOf(t)>-1&&this.pages.splice(this.pages.indexOf(t),1),this.pages.splice(e,0,t);var i=20;e>0&&(i+=this.pages[e-1].boundingRectangle.bottom);for(var r=e;r<this.pages.length;r++)(t=this.pages[r]).boundingRectangle=new D(t.boundingRectangle.x,i,t.boundingRectangle.width,t.boundingRectangle.height),i=t.boundingRectangle.bottom+20},e.prototype.updateClientArea=function(e,i){var r=0,n=48,o=48,a=W.convertPointToPixel(e.pageHeight),s=W.convertPointToPixel(e.bottomMargin);t.isNullOrUndefined(e)||(r=W.convertPointToPixel(e.topMargin),n=W.convertPointToPixel(e.headerDistance),o=W.convertPointToPixel(e.footerDistance)),t.isNullOrUndefined(i.headerWidget)||(r=Math.min(Math.max(n+i.headerWidget.height,r),a/100*40));var l=.667+s;t.isNullOrUndefined(i.footerWidget)||(l=.667+Math.min(a/100*40,Math.max(o+i.footerWidget.height,s)));var d=0;t.isNullOrUndefined(e)||(d=W.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin)),d<0&&(d=0),this.clientArea=new D(W.convertPointToPixel(e.leftMargin),r,d,a-r-l),this.clientActiveArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},e.prototype.updateClientAreaTopOrLeft=function(e,t){t&&(this.clientActiveArea.y=this.clientActiveArea.y+e.topBorderWidth,this.clientActiveArea.x=this.clientActiveArea.x+e.leftBorderWidth)},e.prototype.updateClientAreaForTable=function(e){this.clientActiveArea.x=this.clientArea.x=e.x,this.clientActiveArea.width=this.clientArea.width=e.width},e.prototype.updateClientAreaForRow=function(e,t){var i=e.ownerTable;t||(this.clientActiveArea.x=this.clientArea.x=i.x,this.clientActiveArea.width=this.clientArea.width=i.width,this.clientArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new D(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},e.prototype.updateClientAreaForCell=function(e,t){var i=e.ownerRow,r=e;t?(this.clientActiveArea.x=this.clientArea.x=r.x,this.clientActiveArea.y=r.y,this.clientActiveArea.width=this.clientArea.width=r.width>0?r.width:0,this instanceof ve&&(this.clientActiveArea.height=Number.POSITIVE_INFINITY),this.clientArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new D(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height)):(this.clientActiveArea.x=this.clientArea.x=r.x+r.width+r.margin.right,i.x+i.width-this.clientArea.x<0?this.clientActiveArea.width=this.clientArea.width=0:this.clientActiveArea.width=this.clientArea.width=i.x+i.width-this.clientArea.x,this.clientActiveArea.y=r.y-r.margin.top-W.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing),e.ownerTable.isInsideTable||(this.clientActiveArea.height=this.clientArea.bottom-i.y>0?this.clientArea.bottom-i.y:0),this.clientArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height),this.clientActiveArea=new D(this.clientActiveArea.x,this.clientActiveArea.y,this.clientActiveArea.width,this.clientActiveArea.height))},e.prototype.updateClientAreaByWidget=function(e){this.clientArea.x=e.x,this.clientArea.y=e.y,this.clientActiveArea.x=e.x,this.clientActiveArea.y=e.y},e.prototype.updateClientAreaLocation=function(e,t){e.x=t.x,e.y=t.y,e.width=t.width},e.prototype.updateTextPositionForSelection=function(e,i){var r=this.getLineWidget(e);if(t.isNullOrUndefined(r)||this.selection.updateTextPosition(r,e),i>1){if(this.isMouseDown=!1,this.useTouchSelectionMark=!1,0===this.pages.length)return;t.isNullOrUndefined(this.currentPage)||t.isNullOrUndefined(this.owner.selection.start)||(i%2==0?this.owner.selection.selectCurrentWord():this.owner.selection.selectCurrentParagraph())}},e.prototype.scrollToPosition=function(e,i){if(!(this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizing||this.isMouseDownInFooterRegion||this.isRowOrCellResizing)){var r=this.selection.getLineWidgetInternal(i.currentWidget,i.offset,!0);if(!t.isNullOrUndefined(r)){this.selection.getTop(r);if(this.isMouseDown){var n=this.selection.getLineWidgetInternal(i.currentWidget,i.offset,!1),o=this.selection.getTop(n);n!==r&&i.location.y>=o&&(r=n)}r.height;var a=this.selection.getPage(r.paragraph);this.currentPage=a;var s=0,l=0,d=this;if(d instanceof ve){if(t.isNullOrUndefined(a))return;var h=a.boundingRectangle.width;(s=(this.visibleBounds.width-h*this.zoomFactor)/2)<30&&(s=30),l=a.boundingRectangle.y*this.zoomFactor+(this.pages.indexOf(a)+1)*d.pageGap*(1-this.zoomFactor)}var c=this.containerTop,p=this.containerLeft,g=this.visibleBounds.height,u=this.selection.updateCaretSize(this.owner.selection.end,!0),f=u.topMargin,m=u.height;s+=i.location.x*this.zoomFactor,c+20>(l+=(i.location.y+f)*this.zoomFactor)?this.viewerContainer.scrollTop=l-10:c+g<l+m?this.viewerContainer.scrollTop=l+m-g+10:this.selection.updateCaretToPage(e,a),this.selection.updateCaretToPage(e,a);var v=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth;p>s?this.viewerContainer.scrollLeft=s-d.pageContainer.offsetWidth/100*20:p+this.visibleBounds.width<s+v&&(this.viewerContainer.scrollLeft=p+d.pageContainer.offsetWidth/100*15+v)}}},e.prototype.getLineWidget=function(e){return this.getLineWidgetInternal(e,!1)},e.prototype.getLineWidgetInternal=function(e,i){var r=void 0;if(!t.isNullOrUndefined(this.currentPage)){var n=void 0;if(this.owner.enableHeaderAndFooter){var o=this.currentPage,a=(this.selection.getPageTop(o),o.boundingRectangle.height),s=Math.max(o.headerWidget.y+o.headerWidget.height,W.convertPointToPixel(o.bodyWidgets[0].sectionFormat.topMargin))*this.zoomFactor,l=W.convertPointToPixel(o.bodyWidgets[0].sectionFormat.footerDistance),d=o.boundingRectangle.height-Math.max(o.footerWidget.height+l,2*l);if(i?n=this.isBlockInHeader(this.selection.start.paragraph)?this.currentPage.headerWidget:this.currentPage.footerWidget:e.y<=a&&e.y>=d?n=this.currentPage.footerWidget:e.y>=0&&e.y<=s&&(n=this.currentPage.headerWidget),t.isNullOrUndefined(n))return;return this.selection.getLineWidgetBodyWidget(n,e)}for(var h=0;h<this.currentPage.bodyWidgets.length;h++){var c=this.currentPage.bodyWidgets[h];if(r=this.selection.getLineWidgetBodyWidget(c,e),!t.isNullOrUndefined(r))break}}return r},e.prototype.isBlockInHeader=function(e){for(;!(e.containerWidget instanceof q);){if(!e.containerWidget)return!1;e=e.containerWidget}return-1!==e.containerWidget.headerFooterType.indexOf("Header")},e.prototype.clearSelectionHighlight=function(){!this.isControlPressed||this.isMouseDown,this.owner.selection.clearSelectionHighlightInSelectedWidgets()&&this.selectionContext.clearRect(0,0,this.selectionCanvas.width,this.selectionCanvas.height)},e.prototype.removeEmptyPages=function(){for(var e=!1,t=this,i=0;i<this.pages.length;i++){var r=this.pages[i];0!==r.bodyWidgets.length&&0!==r.bodyWidgets[0].childWidgets.length||(i===this.pages.length-1&&t instanceof ve&&-1!==t.visiblePages.indexOf(this.pages[i])&&(e=!0),this.removePage(this.pages[i]),i--)}e&&this.scrollToBottom()},e.prototype.scrollToBottom=function(){if(this.selection.start.paragraph&&this.selection.start.paragraph.bodyWidget){var e=this.selection.start.paragraph.bodyWidget.page,t=this.visibleBounds.height;this.viewerContainer.scrollTop=e.boundingRectangle.bottom-t}},e.prototype.getFieldResult=function(e,i){if(!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(this.selection)){var r=this.selection.getFieldCode(e).split("*");if(r.length>1){var n=r[0].replace(/[^\w\s]/gi,"").trim().toLowerCase(),o=r[1].replace(/[^\w\s]/gi,"").trim();switch(n){case"page":return this.getFieldText(o,i.index+1);case"numpages":return this.getFieldText(o,i.viewer.pages.length)}}}return""},e.prototype.getFieldText=function(e,t){switch(e){case"ALPHABETIC":return this.layout.getAsLetter(t).toUpperCase();case"alphabetic":return this.layout.getAsLetter(t).toLowerCase();case"roman":return this.layout.getAsRoman(t).toLowerCase();case"ROMAN":return this.layout.getAsRoman(t).toUpperCase();default:return t.toString()}},e.prototype.destroy=function(){t.isNullOrUndefined(this.owner)||this.unWireEvent(),this.pages=[],this.pages=void 0,this.fieldStacks=[],this.fieldStacks=void 0,this.splittedCellWidgets=[],this.splittedCellWidgets=void 0,this.fields=[],this.fields=void 0,this.layout&&this.layout.destroy(),this.layout=void 0,t.isNullOrUndefined(this.render)||this.render.destroy(),this.render=void 0,this.dialogInternal&&this.dialogInternal.destroy(),this.dialogInternal=void 0,this.dialogTarget&&this.dialogTarget.parentElement&&this.dialogTarget.parentElement.removeChild(this.dialogTarget),this.dialogTarget=void 0,t.isNullOrUndefined(this.touchStart)||(this.touchStart.innerHTML=""),this.textHelper&&this.textHelper.destroy(),this.textHelper=void 0,this.touchStart=void 0,t.isNullOrUndefined(this.touchEnd)||(this.touchEnd.innerHTML=""),this.touchEnd=void 0,t.isNullOrUndefined(this.containerCanvasIn)||(this.containerCanvasIn.innerHTML=""),this.containerCanvasIn=void 0,t.isNullOrUndefined(this.selectionCanvasIn)||(this.selectionCanvasIn.innerHTML=""),this.selectionCanvasIn=void 0,t.isNullOrUndefined(this.editableDiv)||(this.editableDiv.innerHTML="",this.editableDiv.parentElement.removeChild(this.editableDiv)),this.editableDiv=void 0,t.isNullOrUndefined(this.pageContainer)||(this.pageContainer.innerHTML=""),this.pageContainer=void 0,t.isNullOrUndefined(this.viewerContainer)||(this.viewerContainer.innerHTML=""),this.viewerContainer=void 0,this.owner=void 0,this.heightInfoCollection=void 0},e.prototype.unWireEvent=function(){this.viewerContainer.removeEventListener("scroll",this.scrollHandler),this.viewerContainer.removeEventListener("mousedown",this.onMouseDownInternal),this.viewerContainer.removeEventListener("mousemove",this.onMouseMoveInternal),t.Browser.isDevice?this.editableDiv.removeEventListener("input",this.onTextInputInternal):(this.editableDiv.removeEventListener("keypress",this.onKeyPressInternal),"chrome"===t.Browser.info.name&&this.editableDiv.removeEventListener("textInput",this.onTextInput)),this.editableDiv.removeEventListener("paste",this.onPaste),this.viewerContainer.removeEventListener("contextmenu",this.onContextMenu),this.editableDiv.removeEventListener("blur",this.onFocusOut),this.editableDiv.removeEventListener("keydown",this.onKeyDownInternal),this.editableDiv.removeEventListener("compositionstart",this.compositionStart),this.editableDiv.removeEventListener("compositionupdate",this.compositionUpdated),this.editableDiv.removeEventListener("compositionend",this.compositionEnd),this.viewerContainer.removeEventListener("mouseup",this.onMouseUpInternal),this.viewerContainer.removeEventListener("dblclick",this.onDoubleTap),window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("keyup",this.onKeyUpInternal),window.removeEventListener("mouseup",this.onImageResizer),window.removeEventListener("touchend",this.onImageResizer)},e}(),ve=function(e){function i(i){var r=e.call(this,i)||this;return r.pageLeft=30,r.pageGap=20,r.visiblePages=[],t.isNullOrUndefined(i)||t.isNullOrUndefined(i.element),r}return fe(i,e),i.prototype.createNewPage=function(e,i){var r=this,n=this.pageGap;this.pages.length>0&&(n=this.pages[this.pages.length-1].boundingRectangle.bottom+this.pageGap);var o=new oe;o.viewer=this;var a=t.isNullOrUndefined(e.sectionFormat)?816:W.convertPointToPixel(e.sectionFormat.pageWidth),s=t.isNullOrUndefined(e.sectionFormat)?1056:W.convertPointToPixel(e.sectionFormat.pageHeight),l=(this.visibleBounds.width-a*this.zoomFactor)/2;return l<this.pageLeft&&(l=this.pageLeft),o.boundingRectangle=new D(l,n,a,s),t.isNullOrUndefined(i)?this.pages.push(o):this.pages.splice(i,0,o),this.updateClientArea(e.sectionFormat,o),o.bodyWidgets.push(e),o.bodyWidgets[o.bodyWidgets.length-1].page=o,this.layout.layoutHeaderFooter(e,r,o),this.updateClientArea(e.sectionFormat,o),o},i.prototype.updateCursor=function(e){var i,r,n,o=void 0,a=this.viewerContainer,s=new T(e.offsetX,e.offsetY),l=this.findFocusedPage(s,!0),d=this.getLineWidget(l),h=this.owner.isReadOnlyMode?void 0:this.owner.editorModule,c=!!h&&h.tableResize.isInRowResizerArea(l),p=!!h&&h.tableResize.isInCellResizerArea(l),g="";if(this.owner.enableImageResizerMode){var u=this.owner.imageResizerModule.getImagePoint(l);this.owner.imageResizerModule.selectedResizeElement=u.selectedElement,g=u.resizePosition}var f=0;if(t.isNullOrUndefined(d)||(f=this.selection.getLineStartLeft(d),o=this.selection.getHyperLinkFieldInCurrentSelection(d,l),i=this.selection.updateTextPositionIn(d,void 0,0,l,!0),r=this.selection.getLeft(d),n=this.selection.getTop(d),this.selection.setHyperlinkContentToToolTip(o,d,l.x)),!t.isNullOrUndefined(o)&&(e.ctrlKey&&this.owner.useCtrlClickToFollowHyperlink||!this.owner.useCtrlClickToFollowHyperlink))return void(a.style.cursor="pointer");l.x>=f&&e.offsetX<this.visibleBounds.width-(this.visibleBounds.width-this.viewerContainer.clientWidth)&&e.offsetY<this.visibleBounds.height-(this.visibleBounds.height-this.viewerContainer.clientHeight)?this.selection.isEmpty?a.style.cursor="text":a.style.cursor=this.selection.checkCursorIsInSelection(d,l)?"default":"text":a.style.cursor="default",t.isNullOrUndefined(g)||""===g?!t.isNullOrUndefined(i)&&i.isImageSelected&&r<l.x&&n<l.y&&r+d.width>l.x&&n+d.height>l.y&&(a.style.cursor="move"):a.style.cursor=g,c?a.style.cursor="row-resize":p&&(a.style.cursor="col-resize")},i.prototype.findFocusedPage=function(e,t){var i=new T(e.x,e.y);i.x+=this.viewerContainer.scrollLeft,i.y+=this.viewerContainer.scrollTop;for(var r=0;r<this.pages.length;r++){var n=this.pages[r],o=(n.boundingRectangle.y-this.pageGap*(r+1))*this.zoomFactor+this.pageGap*(r+1),a=n.boundingRectangle.height*this.zoomFactor+this.pageGap,s=n.boundingRectangle.x,l=(n.boundingRectangle.right-s)*this.zoomFactor+s;if(o<=i.y&&o+a>=i.y)return t&&(this.currentPage=n),i.y=(i.y-o)/this.zoomFactor,i.x>l?i.x=n.boundingRectangle.right:i.x<s?i.x=0:i.x=(i.x-s)/this.zoomFactor,i}return i},i.prototype.onPageFitTypeChanged=function(e){var i=this.visibleBounds.width,r=this.visibleBounds.height,n=this.visiblePages[0].bodyWidgets[0],o=W.convertPointToPixel(n.sectionFormat.pageWidth),a=W.convertPointToPixel(n.sectionFormat.pageHeight);switch(e){case"FitOnePage":if(r>0&&a>0){var s=(this.visibleBounds.height-2*this.pageGap-(this.pageGap-2))/a;s===this.zoomFactor?t.isNullOrUndefined(this.owner.selection)||t.isNullOrUndefined(this.owner.selection.start)||t.isNullOrUndefined(this.owner.selection.end)||this.scrollToPosition(this.owner.selection.start,this.owner.selection.end):this.zoomFactor=s}break;case"FitPageWidth":i>0&&o>0&&(this.zoomFactor=(this.visibleBounds.width-80)/o);break;default:this.zoomFactor=1}},i.prototype.handleZoom=function(){var e=this.preZoomFactor,i=null,r=0,n=!1;if(this.selection&&t.isNullOrUndefined(this.zoomX&&t.isNullOrUndefined(this.zoomY))){var o=0,a=0,s=this.selection.getPage(this.selection.end.currentWidget.paragraph);(o=(this.visibleBounds.width-s.boundingRectangle.width*e)/2)<30&&(o=30),a=s.boundingRectangle.y*e+(this.pages.indexOf(s)+1)*this.pageGap*(1-e);var l=this.selection.updateCaretSize(this.owner.selection.end,!0),d=l.topMargin;l.height;o+=this.selection.end.location.x*e,a+=(this.selection.end.location.y+d)*e,o>=this.containerLeft&&o<=this.visibleBounds.width&&a>=this.containerTop&&a<=this.containerTop+this.visibleBounds.height&&(n=!0)}for(c=0;c<this.pages.length;c++)r+=this.pages[c].boundingRectangle.height;for(var h=0,c=0;c<this.pages.length;c++)h<this.pages[c].boundingRectangle.width&&(h=this.pages[c].boundingRectangle.width);var p=r*this.zoomFactor+(this.pages.length+1)*this.pageGap*(1-this.zoomFactor)-this.visibleBounds.height,g=h*this.zoomFactor-this.visibleBounds.width;if(this.visibleBounds.width-h*this.zoomFactor<60&&(g+=60),p>0){y=this.containerTop;if(this.visiblePages.length>0){var u=((i=this.visiblePages[0]).boundingRectangle.y-(i.index+1)*this.pageGap)*e+(i.index+1)*this.pageGap,f=this.zoomY;t.isNullOrUndefined&&(f=this.visibleBounds.height/2);for(var m=y+f;m>u+i.boundingRectangle.height*e;){var v=i.index+1;if(v===this.pages.length)break;u=((i=this.pages[v]).boundingRectangle.y-(i.index+1)*this.pageGap)*e+(i.index+1)*this.pageGap}y=(i.boundingRectangle.y-(i.index+1)*this.pageGap)*this.zoomFactor+(i.index+1)*this.pageGap+(m-u<0?m-u:(m-u)*(this.zoomFactor/e))-f,f=this.visibleBounds.height/2}this.viewerContainer.scrollTop=y}else this.viewerContainer.scrollTop=0;if(g>0){var y=this.containerLeft;if(this.visiblePages.length>0){null===i&&(i=this.visiblePages[0]);var w=this.zoomX;t.isNullOrUndefined(w)&&(w=this.visibleBounds.width/2);var b=i.boundingRectangle.width*e/i.boundingRectangle.width,x=y+w;y=i.boundingRectangle.x+(x-i.boundingRectangle.x<0?x-i.boundingRectangle.x:(x-i.boundingRectangle.x)*(this.zoomFactor/b))-w,w=this.visibleBounds.width/2}this.viewerContainer.scrollLeft=y}else this.viewerContainer.scrollLeft=0;this.updateScrollBars(),n&&this.scrollToPosition(this.selection.start,this.selection.end)},i.prototype.getCurrentPageHeaderFooter=function(e,t){return this.getCurrentHeaderFooter(this.getHeaderFooterType(e,t),e.index)},i.prototype.getHeaderFooterType=function(e,t){var i;return i=t?"OddHeader":"OddFooter",!e.sectionFormat.differentFirstPage||1!==this.pages.length&&this.pages[this.pages.length-1].bodyWidgets[0].index===e.index?e.sectionFormat.differentOddAndEvenPages&&this.pages.length%2==0&&(i=t?"EvenHeader":"EvenFooter"):i=t?"FirstPageHeader":"FirstPageFooter",i},i.prototype.getCurrentHeaderFooter=function(e,t){if(this.headersFooters[t]){var i=this.getHeaderFooter(e),r=this.headersFooters[t][i];return r||(r=this.createHeaderFooterWidget(e),this.headersFooters[t][i]=r),r}if(t>0)return this.getCurrentHeaderFooter(e,t-1)},i.prototype.createHeaderFooterWidget=function(e){var t=new q(e),i=new G;return i.childWidgets.push(new J(i)),t},i.prototype.getHeaderFooter=function(e){switch(e){case"OddHeader":return 0;case"OddFooter":return 1;case"EvenHeader":return 2;case"EvenFooter":return 3;case"FirstPageHeader":return 4;case"FirstPageFooter":return 5}},i.prototype.updateHFClientArea=function(e,t){var i=W.convertPointToPixel(e.pageWidth-e.leftMargin-e.rightMargin);i<0&&(i=0),this.clientArea=t?new D(W.convertPointToPixel(e.leftMargin),W.convertPointToPixel(e.headerDistance),i,Number.POSITIVE_INFINITY):new D(W.convertPointToPixel(e.leftMargin),W.convertPointToPixel(e.pageHeight-e.footerDistance),i,Number.POSITIVE_INFINITY),this.clientActiveArea=new D(this.clientArea.x,this.clientArea.y,this.clientArea.width,this.clientArea.height)},i.prototype.updateHCFClientAreaWithTop=function(e,t,i){this.updateHFClientArea(e,t),t||i.footerWidget.y<this.clientActiveArea.y&&(this.clientActiveArea.y=i.footerWidget.y,this.clientActiveArea.height=Number.POSITIVE_INFINITY)},i.prototype.scrollToPage=function(e){for(var t=0,i=0;i<this.pages.length&&(t=this.pages[i].boundingRectangle.y-this.pageGap/2,i!==e);i++);this.viewerContainer.scrollTop=t,this.updateScrollBars()},i.prototype.updateScrollBars=function(){for(var e=0,t=0;t<this.pages.length;t++)e+=this.pages[t].boundingRectangle.height;for(var i=0,t=0;t<this.pages.length;t++)i<this.pages[t].boundingRectangle.width&&(i=this.pages[t].boundingRectangle.width);var r=i*this.zoomFactor+2*this.pageLeft,n=e*this.zoomFactor+(this.pages.length+1)*this.pageGap,o=this.visibleBounds.width,a=this.visibleBounds.height;this.visibleBounds.width!==this.viewerContainer.clientWidth?o-=this.visibleBounds.width-this.viewerContainer.clientWidth:n>a&&(o-=this.viewerContainer.offsetWidth-this.viewerContainer.clientWidth),r>o&&(a-=this.visibleBounds.height-this.viewerContainer.clientHeight),i=r>o?r:o,e=n>a?n:a,parseInt(this.pageContainer.style.width.replace("px",""),10)===i&&parseInt(this.pageContainer.style.height.replace("px",""),10)===i||(this.pageContainer.style.width=i.toString()+"px",this.pageContainer.style.height=e.toString()+"px");var s=Math.max(1,window.devicePixelRatio||1);this.containerCanvas.width===Math.floor(o*s)&&this.containerCanvas.height===Math.floor(a*s)||(this.containerCanvas.width=o*s,this.containerCanvas.height=a*s,this.containerCanvas.style.width=o+"px",this.containerCanvas.style.height=a+"px",this.containerContext.scale(s,s),this.selectionCanvas.width=o*s,this.selectionCanvas.height=a*s,this.selectionCanvas.style.width=o+"px",this.selectionCanvas.style.height=a+"px",this.selectionContext.scale(s,s)),this.containerContext.globalAlpha=1,this.selectionContext.globalAlpha=.4;for(t=0;t<this.pages.length;t++){var l=(i-this.pages[t].boundingRectangle.width*this.zoomFactor)/2;l>this.pageLeft?this.pages[t].boundingRectangle=new D(l,this.pages[t].boundingRectangle.y,this.pages[t].boundingRectangle.width,this.pages[t].boundingRectangle.height):this.pages[t].boundingRectangle=new D(this.pageLeft,this.pages[t].boundingRectangle.y,this.pages[t].boundingRectangle.width,this.pages[t].boundingRectangle.height)}this.updateScrollBarPosition(r,n,o,a,i,e)},i.prototype.updateScrollBarPosition=function(e,t,i,r,n,o){parseFloat(this.viewerContainer.style.height),parseFloat(this.pageContainer.style.height);this.containerTop=this.viewerContainer.scrollTop,this.containerCanvas.style.position="absolute",this.containerCanvas.style.top=this.containerTop.toString()+"px",this.selectionCanvas.style.position="absolute",this.selectionCanvas.style.top=this.containerTop.toString()+"px",this.containerLeft=this.viewerContainer.scrollLeft,this.containerCanvas.style.left=this.containerLeft+"px",this.selectionCanvas.style.left=this.containerLeft+"px",this.updateVisiblePages()},i.prototype.updateVisiblePages=function(){this.visiblePages=[];for(var e=this.visibleBounds.height,t=this.viewerContainer.scrollTop,i=0;i<this.pages.length;i++){var r=this.pages[i],n=(r.boundingRectangle.y-this.pageGap*(i+1))*this.zoomFactor+this.pageGap*(i+1),o=r.boundingRectangle.height*this.zoomFactor,a=r.boundingRectangle.x,s=n>=t&&n<=t+e,l=n+o>=t&&n+o<=t+e,d=n<=t&&n+o>=t+e;(s||l||d)&&this.addVisiblePage(r,a,n)}},i.prototype.addVisiblePage=function(e,t,i){var r=e.boundingRectangle.width*this.zoomFactor,n=e.boundingRectangle.height*this.zoomFactor;this.owner.enableImageResizerMode&&void 0!==this.owner.imageResizerModule.currentPage&&this.owner.imageResizerModule.currentPage===e&&this.owner.imageResizerModule.isImageResizerVisible&&this.owner.imageResizerModule.setImageResizerPositions(t,i,r,n),this.visiblePages.push(e),this.renderPage(e,t,i,r,n)},i.prototype.renderPage=function(e,t,i,r,n){this.render.renderWidgets(e,t-this.containerLeft,i-this.containerTop,r,n)},i.prototype.renderVisiblePages=function(){if(!(t.isNullOrUndefined(this.visiblePages)||this.visiblePages.length<1)){this.clearContent();for(var e=0;e<this.visiblePages.length;e++){var i=this.visiblePages[e],r=i.boundingRectangle.width*this.zoomFactor,n=i.boundingRectangle.height*this.zoomFactor,o=i.boundingRectangle.x,a=(i.boundingRectangle.y-this.pageGap*(e+1))*this.zoomFactor+this.pageGap*(e+1);this.renderPage(i,o,a,r,n)}}},i}(me),ye=function(){function e(e){this.viewer=void 0,this.viewer=e}return Object.defineProperty(e.prototype,"isPasting",{get:function(){return this.viewer&&this.viewer.owner.isPastingContent},enumerable:!0,configurable:!0}),e.prototype.convertJsonToDocument=function(e){var i=[],r=JSON.parse(e);return this.parseCharacterFormat(r.characterFormat,this.viewer.characterFormat),this.parseParagraphFormat(r.paragraphFormat,this.viewer.paragraphFormat),t.isNullOrUndefined(r.background)||(this.viewer.backgroundColor=this.getColor(r.background.color)),t.isNullOrUndefined(r.abstractLists)||this.parseAbstractList(r,this.viewer.abstractLists),t.isNullOrUndefined(r.lists)||this.parseList(r,this.viewer.lists),t.isNullOrUndefined(r.styles)||this.parseStyles(r,this.viewer.styles),t.isNullOrUndefined(r.sections)||this.parseSections(r.sections,i),i},e.prototype.parseStyles=function(e,i){for(var r=0;r<e.styles.length;r++)t.isNullOrUndefined(this.viewer.styles.findByName(e.styles[r].name))&&this.parseStyle(e,e.styles[r],i)},e.prototype.parseStyle=function(e,i,r){var n;if(!t.isNullOrUndefined(i.type)){if("Paragraph"===i.type&&((n=new N).type="Paragraph"),"Character"===i.type&&((n=new O).type="Character"),t.isNullOrUndefined(i.name)||(n.name=i.name),r.push(n),!t.isNullOrUndefined(i.basedOn)){var o=r.findByName(i.basedOn);if(t.isNullOrUndefined(o)){var a=this.getStyle(i.basedOn,e),s=void 0;s=t.isNullOrUndefined(a)||a.type!==n.type?"Paragraph"===n.type?JSON.parse('{"type":"Paragraph","name":"Normal","next":"Normal"}'):JSON.parse('{"type": "Character","name": "Default Paragraph Font"}'):a,this.parseStyle(e,s,r),n.basedOn=r.findByName(s.name)}else o.type===n.type&&(n.basedOn=o)}if(!t.isNullOrUndefined(i.link)){var l=r.findByName(i.link),d=this.getStyle(i.link,e),s=void 0;if(t.isNullOrUndefined(l)){if(t.isNullOrUndefined(d)){var h={};h.characterFormat=i.characterFormat,h.name=i.name+" Char",h.type="Character",h.basedOn="Normal"===i.basedOn?"Default Paragraph Font":i.basedOn+" Char",s=h}else s=d;this.parseStyle(e,s,r),n.link=t.isNullOrUndefined(r.findByName(s.name))?i.link:r.findByName(s.name)}else n.link=l}if(t.isNullOrUndefined(i.characterFormat)||this.parseCharacterFormat(i.characterFormat,n.characterFormat),t.isNullOrUndefined(i.paragraphFormat)||this.parseParagraphFormat(i.paragraphFormat,n.paragraphFormat),!t.isNullOrUndefined(i.next))if(i.next===i.name)n.next=n;else{var c=r.findByName(i.next);if(t.isNullOrUndefined(c)||c.type!==n.type){var p=this.getStyle(i.next,e);t.isNullOrUndefined(p)?n.next=n:(this.parseStyle(e,p,r),n.next=r.findByName(p.name))}else n.next=c}}},e.prototype.getStyle=function(e,t){for(var i=0;i<t.styles.length;i++)if(t.styles[i].name===e)return t.styles[i]},e.prototype.parseAbstractList=function(e,i){for(var r=0;r<e.abstractLists.length;r++){var n=new de,o=e.abstractLists[r];if(i.push(n),!t.isNullOrUndefined(o)&&(t.isNullOrUndefined(o.abstractListId)||(n.abstractListId=o.abstractListId),!t.isNullOrUndefined(o.levels)))for(var a=0;a<o.levels.length;a++){var s=o.levels[a];if(!t.isNullOrUndefined(s)){var l=this.parseListLevel(s,n);n.levels.push(l)}}}},e.prototype.parseListLevel=function(e,i){var r=new he(i);return"Bullet"===e.listLevelPattern?(r.listLevelPattern="Bullet",r.numberFormat=t.isNullOrUndefined(e.numberFormat)?"":e.numberFormat):(r.listLevelPattern=e.listLevelPattern,r.startAt=e.startAt,r.numberFormat=t.isNullOrUndefined(e.numberFormat)?"":e.numberFormat,e.restartLevel>=0?r.restartLevel=e.restartLevel:r.restartLevel=e.levelNumber),r.followCharacter=e.followCharacter,this.parseCharacterFormat(e.characterFormat,r.characterFormat),this.parseParagraphFormat(e.paragraphFormat,r.paragraphFormat),r},e.prototype.parseList=function(e,i){for(var r=0;r<e.lists.length;r++){var n=new b,o=e.lists[r];t.isNullOrUndefined(o.abstractListId)||(n.abstractListId=o.abstractListId,n.abstractList=this.viewer.getAbstractListById(o.abstractListId)),i.push(n),t.isNullOrUndefined(o.listId)||(n.listId=o.listId),o.hasOwnProperty("levelOverrides")&&this.parseLevelOverride(o.levelOverrides,n)}},e.prototype.parseLevelOverride=function(e,i){if(!t.isNullOrUndefined(e))for(var r=0;r<e.length;r++){var n=new w,o=e[r];n.startAt=o.startAt,n.levelNumber=o.levelNumber,t.isNullOrUndefined(o.overrideListLevel)||(n.overrideListLevel=this.parseListLevel(o.overrideListLevel,n)),i.levelOverrides.push(n)}},e.prototype.parseSections=function(e,i){for(var r=0;r<e.length;r++){var n=new V;n.sectionFormat=new y(n),n.index=r;var o=e[r];t.isNullOrUndefined(o.sectionFormat)||this.parseSectionFormat(o.sectionFormat,n.sectionFormat),t.isNullOrUndefined(o.headersFooters)&&(o.headersFooters={}),this.viewer.headersFooters.push(this.parseHeaderFooter(o.headersFooters,this.viewer.headersFooters)),this.parseTextBody(o.blocks,n);for(var a=0;a<n.childWidgets.length;a++)n.childWidgets[a].containerWidget=n;i.push(n)}},e.prototype.parseHeaderFooter=function(e,i){var r={};if(!t.isNullOrUndefined(e.header)){var n=new q("OddHeader");r[0]=n,this.parseTextBody(e.header.blocks,n)}if(!t.isNullOrUndefined(e.footer)){var o=new q("OddFooter");r[1]=o,this.parseTextBody(e.footer.blocks,o)}if(!t.isNullOrUndefined(e.evenHeader)){var a=new q("EvenHeader");r[2]=a,this.parseTextBody(e.evenHeader.blocks,a)}if(!t.isNullOrUndefined(e.evenFooter)){var s=new q("EvenFooter");r[3]=s,this.parseTextBody(e.evenFooter.blocks,s)}if(!t.isNullOrUndefined(e.firstPageHeader)){var l=new q("FirstPageHeader");r[4]=l,this.parseTextBody(e.firstPageHeader.blocks,l)}if(!t.isNullOrUndefined(e.firstPageFooter)){var d=new q("FirstPageFooter");r[5]=d,this.parseTextBody(e.firstPageFooter.blocks,d)}return r},e.prototype.parseTextBody=function(e,t){this.parseBody(e,t.childWidgets,t)},e.prototype.parseBody=function(e,i,r){if(!t.isNullOrUndefined(e))for(var n=0;n<e.length;n++){var o=e[n];if(o.hasOwnProperty("inlines")){var a=new G;a.characterFormat=new P(a),a.paragraphFormat=new F(a),this.parseCharacterFormat(o.characterFormat,a.characterFormat),this.parseParagraphFormat(o.paragraphFormat,a.paragraphFormat);var s=void 0;t.isNullOrUndefined(o.paragraphFormat)||t.isNullOrUndefined(o.paragraphFormat.styleName)||(s=this.viewer.styles.findByName(o.paragraphFormat.styleName,"Paragraph"),t.isNullOrUndefined(s)||a.paragraphFormat.ApplyStyle(s)),o.inlines.length>0&&this.parseParagraph(o.inlines,a,!1),i.push(a),a.index=n,a.containerWidget=r}else o.hasOwnProperty("rows")&&this.parseTable(o,i,n,r)}},e.prototype.parseTable=function(e,i,r,n){var o=new K;o.index=r,o.tableFormat=new R(o),t.isNullOrUndefined(e.tableFormat)||this.parseTableFormat(e.tableFormat,o.tableFormat),o.title=e.title,o.description=e.description;for(var a=0;a<e.rows.length;a++){var s=new X;s.rowFormat=new M(s);var l=e.rows[a];if(l.hasOwnProperty("rowFormat")){this.parseRowFormat(l.rowFormat,s.rowFormat),this.parseRowGridValues(l,s.rowFormat),this.parseRowGridValues(l.rowFormat,s.rowFormat),s.index=a;for(var d=0;d<e.rows[a].cells.length;d++){var h=new Y;h.cellFormat=new H(h),s.childWidgets.push(h),h.containerWidget=s,h.index=d,h.rowIndex=a,e.rows[a].cells[d].hasOwnProperty("cellFormat")&&this.parseCellFormat(e.rows[a].cells[d].cellFormat,h.cellFormat),this.parseTextBody(e.rows[a].cells[d].blocks,h)}}o.childWidgets.push(s),s.containerWidget=o}o.containerWidget=n,i.push(o),o.isGridUpdated=!1},e.prototype.parseRowGridValues=function(e,i){t.isNullOrUndefined(e.gridBefore)||(i.gridBefore=e.gridBefore),t.isNullOrUndefined(e.gridBeforeWidth)||(i.gridBeforeWidth=e.gridBeforeWidth),t.isNullOrUndefined(e.gridBeforeWidthType)||(i.gridBeforeWidthType=e.gridBeforeWidthType),t.isNullOrUndefined(e.gridAfter)||(i.gridAfter=e.gridAfter),t.isNullOrUndefined(e.gridAfterWidth)||(i.gridAfterWidth=e.gridAfterWidth),t.isNullOrUndefined(e.gridAfterWidthType)||(i.gridAfterWidthType=e.gridAfterWidthType)},e.prototype.parseParagraph=function(e,i,r){for(var n=new J(i),o=0;o<e.length;o++){var a=e[o];if(a.hasOwnProperty("text")){var s=void 0;if(this.viewer.isPageField?(s=new ee).fieldBegin=this.viewer.fieldStacks[this.viewer.fieldStacks.length-1]:s="\t"===a.text?new te:new Q,s.characterFormat=new P(s),this.parseCharacterFormat(a.characterFormat,s.characterFormat,r),!t.isNullOrUndefined(a.characterFormat)&&!t.isNullOrUndefined(a.characterFormat.styleName)){var l=this.viewer.styles.findByName(a.characterFormat.styleName,"Character");s.characterFormat.ApplyStyle(l)}s.text=a.text,s.line=n,n.children.push(s)}else if(a.hasOwnProperty("imageString")){var d=new re(e[o].isInlineImage);d.isMetaFile=e[o].isMetaFile,d.characterFormat=new P(d),d.line=n,n.children.push(d),d.imageString=a.imageString,d.width=W.convertPointToPixel(a.width),d.height=W.convertPointToPixel(a.height),this.parseCharacterFormat(a.characterFormat,d.characterFormat)}else if(a.hasOwnProperty("hasFieldEnd")||a.hasOwnProperty("fieldType")&&0===a.fieldType){var h=new $(0);h.hasFieldEnd=a.hasFieldEnd,this.viewer.fieldStacks.push(h),h.line=n,this.viewer.fields.push(h),n.children.push(h)}else if(a.hasOwnProperty("fieldType")){var c=void 0;if(2===a.fieldType){if(c=new $(2),this.fieldSeparator=c,this.viewer.fieldStacks.length>0){c.fieldBegin=this.viewer.fieldStacks[this.viewer.fieldStacks.length-1],c.fieldBegin.fieldSeparator=c;var p=n.children.length;p>=2&&n.children[p-2]instanceof $&&n.children[p-2].hasFieldEnd&&n.children[p-1]instanceof Q&&n.children[p-1].text.match("PAGE")&&(this.viewer.isPageField=!0)}}else 1===a.fieldType&&(c=new $(1),this.viewer.fieldStacks.length>0&&(c.fieldBegin=this.viewer.fieldStacks[this.viewer.fieldStacks.length-1],c.fieldBegin.fieldEnd=c),!t.isNullOrUndefined(c.fieldBegin)&&c.fieldBegin.fieldSeparator&&(c.fieldSeparator=c.fieldBegin.fieldSeparator,c.fieldBegin.fieldSeparator.fieldEnd=c),this.viewer.fieldStacks.splice(this.viewer.fieldStacks.length-1,1),this.fieldSeparator=void 0,this.viewer.isPageField=!1,this.viewer.fieldCollection.push(c.fieldBegin));c.line=n,n.children.push(c)}else if(a.hasOwnProperty("bookmarkType")){var g=void 0;if(g=new ie(a.bookmarkType),g.name=a.name,n.children.push(g),g.line=n,0===a.bookmarkType)this.viewer.bookmarks.add(g.name,g);else if(1===a.bookmarkType&&this.viewer.bookmarks.containsKey(g.name)){var u=this.viewer.bookmarks.get(g.name);u.reference=g,g.reference=u}}}i.childWidgets.push(n)},e.prototype.parseTableFormat=function(e,i){this.parseBorders(e.borders,i.borders),t.isNullOrUndefined(e.cellSpacing)||(i.cellSpacing=e.cellSpacing),t.isNullOrUndefined(e.leftMargin)||(i.leftMargin=e.leftMargin),t.isNullOrUndefined(e.topMargin)||(i.topMargin=e.topMargin),t.isNullOrUndefined(e.rightMargin)||(i.rightMargin=e.rightMargin),t.isNullOrUndefined(e.bottomMargin)||(i.bottomMargin=e.bottomMargin),t.isNullOrUndefined(e.leftIndent)||(i.leftIndent=e.leftIndent),this.parseShading(e.shading,i.shading),t.isNullOrUndefined(e.tableAlignment)||(i.tableAlignment=e.tableAlignment),t.isNullOrUndefined(e.preferredWidth)||(i.preferredWidth=e.preferredWidth),t.isNullOrUndefined(e.preferredWidthType)||(i.preferredWidthType=e.preferredWidthType)},e.prototype.parseCellFormat=function(e,i){t.isNullOrUndefined(e)||(this.parseBorders(e.borders,i.borders),e.isSamePaddingAsTable||this.parseCellMargin(e,i),t.isNullOrUndefined(e.cellWidth)||(i.cellWidth=e.cellWidth),t.isNullOrUndefined(e.columnSpan)||(i.columnSpan=e.columnSpan),t.isNullOrUndefined(e.rowSpan)||(i.rowSpan=e.rowSpan),this.parseShading(e.shading,i.shading),t.isNullOrUndefined(e.verticalAlignment)||(i.verticalAlignment=e.verticalAlignment),t.isNullOrUndefined(e.preferredWidthType)||(i.preferredWidthType=e.preferredWidthType),t.isNullOrUndefined(e.preferredWidth)||(i.preferredWidth=e.preferredWidth))},e.prototype.parseCellMargin=function(e,i){t.isNullOrUndefined(e.leftMargin)||(i.leftMargin=e.leftMargin),t.isNullOrUndefined(e.rightMargin)||(i.rightMargin=e.rightMargin),t.isNullOrUndefined(e.topMargin)||(i.topMargin=e.topMargin),t.isNullOrUndefined(e.bottomMargin)||(i.bottomMargin=e.bottomMargin)},e.prototype.parseRowFormat=function(e,i){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.allowBreakAcrossPages)||(i.allowBreakAcrossPages=e.allowBreakAcrossPages),t.isNullOrUndefined(e.isHeader)||(i.isHeader=e.isHeader),t.isNullOrUndefined(e.heightType)||(i.heightType=e.heightType),t.isNullOrUndefined(e.height)||(i.height=e.height),this.parseBorders(e.borders,i.borders))},e.prototype.parseBorders=function(e,i){t.isNullOrUndefined(e)||(this.parseBorder(e.left,i.left),this.parseBorder(e.right,i.right),this.parseBorder(e.top,i.top),this.parseBorder(e.bottom,i.bottom),this.parseBorder(e.vertical,i.vertical),this.parseBorder(e.horizontal,i.horizontal),this.parseBorder(e.diagonalDown,i.diagonalDown),this.parseBorder(e.diagonalUp,i.diagonalUp))},e.prototype.parseBorder=function(e,i){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.color)||(i.color=this.getColor(e.color)),t.isNullOrUndefined(e.lineStyle)||(i.lineStyle=e.lineStyle),t.isNullOrUndefined(e.lineWidth)||(i.lineWidth=e.lineWidth),t.isNullOrUndefined(e.hasNoneStyle)||(i.hasNoneStyle=e.hasNoneStyle))},e.prototype.parseShading=function(e,i){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.backgroundColor)||(i.backgroundColor=this.getColor(e.backgroundColor)),t.isNullOrUndefined(e.foregroundColor)||(i.foregroundColor=this.getColor(e.foregroundColor)),t.isNullOrUndefined(e.texture)&&t.isNullOrUndefined(e.textureStyle)||(i.textureStyle=t.isNullOrUndefined(e.texture)?e.textureStyle:e.texture))},e.prototype.parseCharacterFormat=function(e,i,r){if(!t.isNullOrUndefined(e)){if(r&&e.hasOwnProperty("inlineFormat"))return void this.parseCharacterFormat(e.inlineFormat,i);t.isNullOrUndefined(e.baselineAlignment)||(i.baselineAlignment=e.baselineAlignment),t.isNullOrUndefined(e.underline)||(i.underline=e.underline),t.isNullOrUndefined(e.strikethrough)||(i.strikethrough=e.strikethrough),t.isNullOrUndefined(e.fontSize)||(i.fontSize=e.fontSize),t.isNullOrUndefined(e.fontFamily)||(i.fontFamily=e.fontFamily),t.isNullOrUndefined(e.bold)||(i.bold=e.bold),t.isNullOrUndefined(e.italic)||(i.italic=e.italic),t.isNullOrUndefined(e.highlightColor)||(i.highlightColor=e.highlightColor),t.isNullOrUndefined(e.fontColor)||(i.fontColor=this.getColor(e.fontColor))}},e.prototype.getColor=function(e){return e||"#ffffff"},e.prototype.parseParagraphFormat=function(e,i){t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.leftIndent)||(i.leftIndent=e.leftIndent),t.isNullOrUndefined(e.rightIndent)||(i.rightIndent=e.rightIndent),t.isNullOrUndefined(e.firstLineIndent)||(i.firstLineIndent=e.firstLineIndent),t.isNullOrUndefined(e.afterSpacing)||(i.afterSpacing=e.afterSpacing),t.isNullOrUndefined(e.beforeSpacing)||(i.beforeSpacing=e.beforeSpacing),t.isNullOrUndefined(e.lineSpacing)||(i.lineSpacing=e.lineSpacing),t.isNullOrUndefined(e.lineSpacingType)||(i.lineSpacingType=e.lineSpacingType),t.isNullOrUndefined(e.textAlignment)||(i.textAlignment=e.textAlignment),t.isNullOrUndefined(e.outlineLevel)||(i.outlineLevel=e.outlineLevel),i.listFormat=new x,e.hasOwnProperty("listFormat")&&this.parseListFormat(e,i.listFormat),e.hasOwnProperty("tabs")&&this.parseTabStop(e.tabs,i.tabs))},e.prototype.parseListFormat=function(e,i){t.isNullOrUndefined(e.listFormat)||(t.isNullOrUndefined(e.listFormat.listId)||(i.listId=e.listFormat.listId,i.list=this.viewer.getListById(e.listFormat.listId)),t.isNullOrUndefined(e.listFormat.listLevelNumber)||(i.listLevelNumber=e.listFormat.listLevelNumber))},e.prototype.parseSectionFormat=function(e,i){t.isNullOrUndefined(e.pageWidth)||(i.pageWidth=e.pageWidth),t.isNullOrUndefined(e.pageHeight)||(i.pageHeight=e.pageHeight),t.isNullOrUndefined(e.leftMargin)||(i.leftMargin=e.leftMargin),t.isNullOrUndefined(e.topMargin)||(i.topMargin=e.topMargin),t.isNullOrUndefined(e.rightMargin)||(i.rightMargin=e.rightMargin),t.isNullOrUndefined(e.bottomMargin)||(i.bottomMargin=e.bottomMargin),t.isNullOrUndefined(e.headerDistance)||(i.headerDistance=e.headerDistance),t.isNullOrUndefined(e.footerDistance)||(i.footerDistance=e.footerDistance),t.isNullOrUndefined(e.differentFirstPage)||(i.differentFirstPage=e.differentFirstPage),t.isNullOrUndefined(e.differentOddAndEvenPages)||(i.differentOddAndEvenPages=e.differentOddAndEvenPages)},e.prototype.parseTabStop=function(e,t){for(var i=0;i<e.length;i++){var r=new C;r.position=e[i].position,r.tabLeader=e[i].tabLeader,r.deletePosition=e[i].deletePosition,r.tabJustification=e[i].tabJustification,t.push(r)}},e}(),we=function(){function e(e){this.boldIn=void 0,this.italicIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.fontSizeIn=0,this.fontColorIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.fontSizeIn},set:function(e){e!==this.fontSizeIn&&(this.fontSizeIn=e,this.notifyPropertyChanged("fontSize"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.fontFamilyIn},set:function(e){e!==this.fontFamilyIn&&(this.fontFamilyIn=e,this.notifyPropertyChanged("fontFamily"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontColor",{get:function(){return this.fontColorIn},set:function(e){e!==this.fontColorIn&&(this.fontColorIn=e,this.notifyPropertyChanged("fontColor"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{get:function(){return this.boldIn},set:function(e){e!==this.boldIn&&(this.boldIn=e,this.notifyPropertyChanged("bold"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"italic",{get:function(){return this.italicIn},set:function(e){e!==this.italic&&(this.italicIn=e,this.notifyPropertyChanged("italic"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikethrough",{get:function(){return this.strikeThroughIn},set:function(e){e!==this.strikeThroughIn&&(this.strikeThroughIn=e,this.notifyPropertyChanged("strikethrough"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"baselineAlignment",{get:function(){return this.baselineAlignmentIn},set:function(e){e!==this.baselineAlignmentIn&&(this.baselineAlignmentIn=e,this.notifyPropertyChanged("baselineAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{get:function(){return this.underlineIn},set:function(e){e!==this.underlineIn&&(this.underlineIn=e,this.notifyPropertyChanged("underline"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"highlightColor",{get:function(){return this.highlightColorIn},set:function(e){e!==this.highlightColorIn&&(this.highlightColorIn=e,this.notifyPropertyChanged("highlightColor"))},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"bold":return this.bold;case"italic":return this.italic;case"fontSize":if(this.fontSize>=1)return this.fontSize;return;case"fontFamily":return this.fontFamily;case"strikethrough":return this.strikethrough;case"baselineAlignment":return this.baselineAlignment;case"highlightColor":return this.highlightColor;case"underline":return this.underline;case"fontColor":return this.fontColor;default:return}},e.prototype.notifyPropertyChanged=function(e){if((t.isNullOrUndefined(this.selection)||!this.selection.isCleared&&!this.selection.owner.isReadOnlyMode&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!t.isNullOrUndefined(this.selection)&&!t.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var i=this.getPropertyValue(e);t.isNullOrUndefined(i)||this.selection.owner.editorModule.onApplyCharacterFormat(e,i)}},e.prototype.copyFormat=function(e){this.styleName=t.isNullOrUndefined(e.baseCharStyle)?"Default Paragraph Font":e.baseCharStyle.name,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.bold=e.bold,this.italic=e.italic,this.baselineAlignment=e.baselineAlignment,this.underline=e.underline,this.fontColor=e.fontColor,this.highlightColor=e.highlightColor,this.strikethrough=e.strikethrough},e.prototype.combineFormat=function(e){t.isNullOrUndefined(this.bold)||this.bold===e.bold||(this.bold=void 0),t.isNullOrUndefined(this.italic)||this.italic===e.italic||(this.italic=void 0),0!==this.fontSize&&this.fontSize!==e.fontSize&&(this.fontSize=0),t.isNullOrUndefined(this.fontFamily)||this.fontFamily===e.fontFamily||(this.fontFamily=void 0),t.isNullOrUndefined(this.highlightColor)||this.highlightColor===e.highlightColor||(this.highlightColor=void 0),t.isNullOrUndefined(this.baselineAlignment)||this.baselineAlignment===e.baselineAlignment||(this.baselineAlignment=void 0),t.isNullOrUndefined(this.fontColor)||this.fontColor===e.fontColor||(this.fontColor=void 0),t.isNullOrUndefined(this.underline)||this.underline===e.underline||(this.underline=void 0),t.isNullOrUndefined(this.strikethrough)||this.strikethrough===e.strikethrough||(this.strikethrough=void 0)},e.prototype.cloneFormat=function(e){this.bold=e.bold,this.italic=e.italic,this.underline=e.underline,this.strikethrough=e.strikethrough,this.baselineAlignment=e.baselineAlignment,this.highlightColor=e.highlightColor,this.fontSize=e.fontSize,this.fontFamily=e.fontFamily,this.fontColor=e.fontColor,this.styleName=e.styleName},e.prototype.isEqualFormat=function(e){return this.fontSize===e.fontSize&&this.strikethrough===e.strikethrough&&this.bold===e.bold&&this.fontFamily===e.fontFamily&&this.underline===e.underline&&this.highlightColor===e.highlightColor&&this.italic===e.italic&&this.baselineAlignment===e.baselineAlignment&&this.fontColor===e.fontColor},e.prototype.clearFormat=function(){this.fontSizeIn=0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.highlightColorIn=void 0,this.baselineAlignmentIn=void 0,this.styleName=void 0},e.prototype.destroy=function(){this.fontSizeIn=void 0,this.boldIn=void 0,this.italicIn=void 0,this.fontFamilyIn=void 0,this.fontColorIn=void 0,this.underlineIn=void 0,this.strikeThroughIn=void 0,this.baselineAlignmentIn=void 0,this.highlightColorIn=void 0,this.selection=void 0,this.styleName=void 0},e}(),be=function(){function e(e,t){this.leftIndentIn=0,this.rightIndentIn=0,this.beforeSpacingIn=0,this.afterSpacingIn=0,this.textAlignmentIn=void 0,this.firstLineIndentIn=0,this.lineSpacingIn=1,this.lineSpacingTypeIn=void 0,this.listLevelNumberIn=-1,this.selection=e,this.viewer=t}return Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightIndent",{get:function(){return this.rightIndentIn},set:function(e){e!==this.rightIndentIn&&(this.rightIndentIn=e,this.notifyPropertyChanged("rightIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"firstLineIndent",{get:function(){return this.firstLineIndentIn},set:function(e){e!==this.firstLineIndentIn&&(this.firstLineIndentIn=e,this.notifyPropertyChanged("firstLineIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textAlignment",{get:function(){return this.textAlignmentIn},set:function(e){e!==this.textAlignmentIn&&(this.textAlignmentIn=e,this.notifyPropertyChanged("textAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"afterSpacing",{get:function(){return this.afterSpacingIn},set:function(e){e!==this.afterSpacingIn&&(this.afterSpacingIn=e,this.notifyPropertyChanged("afterSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"beforeSpacing",{get:function(){return this.beforeSpacingIn},set:function(e){e!==this.beforeSpacingIn&&(this.beforeSpacingIn=e,this.notifyPropertyChanged("beforeSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacing",{get:function(){return this.lineSpacingIn},set:function(e){e!==this.lineSpacingIn&&(this.lineSpacingIn=e,this.notifyPropertyChanged("lineSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineSpacingType",{get:function(){return this.lineSpacingTypeIn},set:function(e){e!==this.lineSpacingTypeIn&&(this.lineSpacingTypeIn=e,this.notifyPropertyChanged("lineSpacingType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelNumber",{get:function(){return this.listLevelNumberIn},set:function(e){e!==this.listLevelNumberIn&&(this.listLevelNumberIn=e,this.notifyPropertyChanged("listLevelNumber"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listText",{get:function(){var e=void 0,t=this.viewer.getListById(this.listId);if(t instanceof b&&this.listLevelNumberIn>-1&&this.listLevelNumberIn<9){var i=t.getListLevel(this.listLevelNumber);if(i instanceof he)if("Bullet"===i.listLevelPattern)e=i.numberFormat;else{e=i.numberFormat;for(var r=0;r<9;r++){var n="%"+(r+1);if(e.indexOf(n)>-1){r===this.listLevelNumberIn||t.getListLevel(r);var o=this.selection.getListTextElementBox(this.selection.start.paragraph);e=o?o.text:""}}}}return e},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"leftIndent":return this.leftIndent;case"rightIndent":return this.rightIndent;case"firstLineIndent":return this.firstLineIndent;case"beforeSpacing":return this.beforeSpacing;case"afterSpacing":return this.afterSpacing;case"textAlignment":return this.textAlignment;case"lineSpacing":return this.lineSpacing;case"lineSpacingType":return this.lineSpacingType;default:return}},e.prototype.notifyPropertyChanged=function(e){if((t.isNullOrUndefined(this.selection)||!this.selection.owner.isReadOnlyMode&&this.selection.owner.isDocumentLoaded||this.selection.isRetrieveFormatting)&&!t.isNullOrUndefined(this.selection)&&!t.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var i=this.selection.owner.editorModule,r=this.getPropertyValue(e);if(!("leftIndent"!==e&&"rightIndent"!==e&&"firstLineIndent"!==e||r>=-1056&&r<1056))return;"listLevelNumber"===e?i.onApplyListInternal(this.viewer.getListById(this.listId),this.listLevelNumber):i.onApplyParagraphFormat(e,r,"textAlignment"===e,!1)}},e.prototype.copyFormat=function(e){this.styleName=t.isNullOrUndefined(e.baseStyle)?"Normal":e.baseStyle.name,this.leftIndent=e.leftIndent,this.rightIndent=e.rightIndent,this.firstLineIndent=e.firstLineIndent,this.afterSpacing=e.afterSpacing,this.beforeSpacing=e.beforeSpacing,this.lineSpacing=e.lineSpacing,this.lineSpacingType=e.lineSpacingType,this.textAlignment=e.textAlignment,t.isNullOrUndefined(e.listFormat)||t.isNullOrUndefined(e.listFormat.listId)?(this.listId=void 0,this.listLevelNumber=0):(this.listId=e.listFormat.listId,this.listLevelNumber=e.listFormat.listLevelNumber)},e.prototype.copyToFormat=function(e){t.isNullOrUndefined(e)||(t.isNullOrUndefined(this.afterSpacing)||(e.afterSpacing=this.afterSpacing),t.isNullOrUndefined(this.beforeSpacing)||(e.beforeSpacing=this.beforeSpacing),t.isNullOrUndefined(this.leftIndent)||(e.leftIndent=this.leftIndent),t.isNullOrUndefined(this.rightIndent)||(e.rightIndent=this.rightIndent),t.isNullOrUndefined(this.textAlignment)||(e.textAlignment=this.textAlignment),t.isNullOrUndefined(this.lineSpacing)||(e.lineSpacing=this.lineSpacing),t.isNullOrUndefined(this.lineSpacingType)||(e.lineSpacingType=this.lineSpacingType),t.isNullOrUndefined(this.firstLineIndent)||(e.firstLineIndent=this.firstLineIndent))},e.prototype.combineFormat=function(e){t.isNullOrUndefined(this.leftIndent)||this.leftIndent===e.leftIndent||(this.leftIndent=void 0),t.isNullOrUndefined(this.rightIndent)||this.rightIndent===e.rightIndent||(this.rightIndent=void 0),t.isNullOrUndefined(this.firstLineIndent)||this.firstLineIndent===e.firstLineIndent||(this.firstLineIndent=void 0),0!==this.lineSpacing&&this.lineSpacing!==e.lineSpacing&&(this.lineSpacing=0),-1!==this.beforeSpacing&&this.beforeSpacing!==e.beforeSpacing&&(this.beforeSpacing=-1),-1!==this.afterSpacing&&this.afterSpacing!==e.afterSpacing&&(this.afterSpacing=-1),t.isNullOrUndefined(this.lineSpacingType)||this.lineSpacingType===e.lineSpacingType||(this.lineSpacingType=void 0),t.isNullOrUndefined(this.textAlignment)||this.textAlignment===e.textAlignment||(this.textAlignment=void 0),this.listLevelNumber>=0&&!t.isNullOrUndefined(this.listId)&&(t.isNullOrUndefined(e.listFormat)||e.listFormat.listLevelNumber!==this.listLevelNumber)&&(this.listLevelNumber=-1),(t.isNullOrUndefined(e.listFormat)||t.isNullOrUndefined(e.listFormat.listId)||!t.isNullOrUndefined(this.listId)&&this.listId!==e.listFormat.listId)&&(this.listId=void 0)},e.prototype.clearFormat=function(){this.leftIndent=0,this.rightIndent=0,this.beforeSpacing=0,this.afterSpacing=0,this.firstLineIndent=0,this.lineSpacing=1,this.textAlignment=void 0,this.lineSpacingType=void 0,this.listId=void 0,this.listLevelNumber=-1,this.styleName=void 0},e.prototype.getList=function(){var e=this.viewer.getListById(this.listId);if(!t.isNullOrUndefined(e)){var i=new b,r=new de,n=this.viewer.getAbstractListById(e.abstractListId),o=this.selection.owner.editorModule;if(t.isNullOrUndefined(n))r.levels.push(new he(r));else for(s=0;s<n.levels.length;s++){var a=o.cloneListLevel(n.levels[s]);r.levels.push(a),a.ownerBase=r}if(!t.isNullOrUndefined(e.levelOverrides))for(var s=0;s<e.levelOverrides.length;s++){var l=o.cloneLevelOverride(e.levelOverrides[s]);i.levelOverrides.push(l)}return i.abstractList=r,i.abstractListId=r.abstractListId,i.sourceListId=e.listId,i}},e.prototype.setList=function(e){if(!this.viewer.owner.isReadOnlyMode&&this.viewer.owner.isDocumentLoaded){var i=this.viewer.getListById(this.listId),r=void 0,n=e?this.viewer.getAbstractListById(e.abstractListId):void 0;if(t.isNullOrUndefined(i)||t.isNullOrUndefined(e)||t.isNullOrUndefined(n)||e.sourceListId!==i.listId)t.isNullOrUndefined(e)?this.selection.owner.editorModule.onApplyList(void 0):(this.selection.owner.isLayoutEnabled=!1,t.isNullOrUndefined(n)||-1!==this.viewer.abstractLists.indexOf(n)||this.viewer.abstractLists.push(n),-1===this.viewer.lists.indexOf(e)&&this.viewer.lists.push(e),this.selection.owner.isLayoutEnabled=!0,this.selection.owner.editorModule.onApplyList(e));else{var o=this.viewer.owner.editorHistory;this.viewer.layout.getListLevel(i,1);this.selection.owner.isLayoutEnabled=!1,this.viewer.owner.editorModule.setOffsetValue(this.selection),o&&(r=o.updateListChangesInHistory(n,i)),this.viewer.owner.editorModule.updateListParagraphs(),o&&o.applyListChanges(this.selection,r),this.selection.owner.isLayoutEnabled=!0,this.viewer.renderedLists.clear(),this.viewer.owner.editorModule.layoutWholeDocument(),this.viewer.owner.editorModule.updateSelectionTextPosition(!1),o&&o.currentBaseHistoryInfo&&(o.currentBaseHistoryInfo.modifiedProperties.length>0&&o.currentBaseHistoryInfo.updateSelection(),o.updateHistory()),this.viewer.owner.editorModule.fireContentChange()}}},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.rightIndentIn=void 0,this.beforeSpacingIn=void 0,this.afterSpacingIn=void 0,this.firstLineIndentIn=void 0,this.lineSpacingIn=void 0,this.textAlignmentIn=void 0,this.lineSpacingTypeIn=void 0,this.listId=void 0,this.listLevelNumberIn=void 0,this.viewer=void 0,this.selection=void 0,this.styleName=void 0},e}(),xe=function(){function e(e){this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"pageHeight",{get:function(){return this.pageHeightIn},set:function(e){this.pageHeightIn=e,this.notifyPropertyChanged("pageHeight")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pageWidth",{get:function(){return this.pageWidthIn},set:function(e){this.pageWidthIn=e,this.notifyPropertyChanged("pageWidth")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){this.topMarginIn=e,this.notifyPropertyChanged("topMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerDistance",{get:function(){return this.headerDistanceIn},set:function(e){this.headerDistanceIn=e,this.notifyPropertyChanged("headerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"footerDistance",{get:function(){return this.footerDistanceIn},set:function(e){this.footerDistanceIn=e,this.notifyPropertyChanged("footerDistance")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentFirstPage",{get:function(){return this.differentFirstPageIn},set:function(e){this.differentFirstPageIn=e,this.notifyPropertyChanged("differentFirstPage")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"differentOddAndEvenPages",{get:function(){return this.differentOddAndEvenPagesIn},set:function(e){this.differentOddAndEvenPagesIn=e,this.notifyPropertyChanged("differentOddAndEvenPages")},enumerable:!0,configurable:!0}),e.prototype.copyFormat=function(e){this.pageHeight=e.pageHeight,this.pageWidth=e.pageWidth,this.leftMargin=e.leftMargin,this.topMargin=e.topMargin,this.rightMargin=e.rightMargin,this.bottomMargin=e.bottomMargin,this.headerDistance=e.headerDistance,this.footerDistance=e.footerDistance,this.differentFirstPage=e.differentFirstPage,this.differentOddAndEvenPages=e.differentOddAndEvenPages},e.prototype.notifyPropertyChanged=function(e){var i=this.selection;if((t.isNullOrUndefined(i)||!(i.isCleared||i.owner.isPastingContent||i.owner.isReadOnlyMode)&&i.owner.isDocumentLoaded||i.isRetrieveFormatting)&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(i.start)&&!i.isRetrieveFormatting){var r=this.getPropertyvalue(e);t.isNullOrUndefined(r)||i.owner.editorModule.onApplySectionFormat(e,r)}},e.prototype.getPropertyvalue=function(e){switch(e){case"pageHeight":if(this.pageHeight>0)return this.pageHeight;return;case"pageWidth":if(this.pageWidth>0)return this.pageWidth;return;case"leftMargin":if(this.leftMargin>=0)return this.leftMargin;return;case"rightMargin":if(this.rightMargin>=0)return this.rightMargin;return;case"topMargin":if(this.topMargin>=0)return this.topMargin;return;case"bottomMargin":if(this.bottomMargin>=0)return this.bottomMargin;return;case"differentFirstPage":if(!t.isNullOrUndefined(this.differentFirstPage))return this.differentFirstPage;return;case"differentOddAndEvenPages":if(!t.isNullOrUndefined(this.differentOddAndEvenPages))return this.differentOddAndEvenPages;return;case"headerDistance":return this.headerDistanceIn;case"footerDistance":return this.footerDistance;default:return}},e.prototype.combineFormat=function(e){this.pageHeight>0&&this.pageHeight!==e.pageHeight&&(this.pageHeight=0),this.pageWidth>0&&this.pageWidth!==e.pageWidth&&(this.pageWidth=0),this.leftMargin>-1&&this.leftMargin!==e.leftMargin&&(this.leftMargin=-1),this.topMargin>-1&&this.topMargin!==e.topMargin&&(this.topMargin=-1),this.rightMargin>-1&&this.rightMargin!==e.rightMargin&&(this.rightMargin=-1),this.bottomMargin>-1&&this.bottomMargin!==e.bottomMargin&&(this.bottomMargin=-1),0!==this.headerDistance&&this.headerDistance!==e.headerDistance&&(this.headerDistance=0),0!==this.footerDistance&&this.footerDistance!==e.footerDistance&&(this.footerDistance=0),t.isNullOrUndefined(this.differentFirstPage)||this.differentFirstPage===e.differentFirstPage||(this.differentFirstPage=void 0),t.isNullOrUndefined(this.differentOddAndEvenPages)||this.differentOddAndEvenPages===e.differentOddAndEvenPages||(this.differentOddAndEvenPages=void 0)},e.prototype.clearFormat=function(){this.headerDistance=0,this.footerDistance=0,this.pageHeight=0,this.pageWidth=0,this.leftMargin=-1,this.rightMargin=-1,this.topMargin=-1,this.bottomMargin=-1,this.differentFirstPage=void 0,this.differentOddAndEvenPages=void 0},e.prototype.destroy=function(){this.headerDistanceIn=void 0,this.footerDistanceIn=void 0,this.pageHeightIn=void 0,this.pageWidthIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.differentFirstPageIn=void 0,this.differentOddAndEvenPagesIn=void 0,this.selection=void 0},e}(),Ce=function(){function e(e){this.leftIndentIn=0,this.backgroundIn=void 0,this.tableAlignmentIn=void 0,this.cellSpacingIn=0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.preferredWidthIn=0,this.selection=e}return Object.defineProperty(e.prototype,"table",{get:function(){return this.tableIn},set:function(e){this.tableIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftIndent",{get:function(){return this.leftIndentIn},set:function(e){e!==this.leftIndentIn&&(this.leftIndentIn=e,this.notifyPropertyChanged("leftIndent"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableAlignment",{get:function(){return this.tableAlignmentIn},set:function(e){e!==this.tableAlignmentIn&&(this.tableAlignmentIn=e,this.notifyPropertyChanged("tableAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellSpacing",{get:function(){return this.cellSpacingIn},set:function(e){e!==this.cellSpacingIn&&(this.cellSpacingIn=e,this.notifyPropertyChanged("cellSpacing"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),e.prototype.getPropertyValue=function(e){switch(e){case"tableAlignment":return this.tableAlignment;case"leftIndent":return this.leftIndent;case"cellSpacing":return this.cellSpacing;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"background":var t=new E;return t.backgroundColor=this.background,t;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;default:return}},e.prototype.notifyPropertyChanged=function(e){if((t.isNullOrUndefined(this.selection)||!this.selection.isCleared&&this.selection.owner.isDocumentLoaded&&!this.selection.owner.isReadOnlyMode&&!this.selection.owner.isPastingContent||this.selection.isRetrieveFormatting)&&!t.isNullOrUndefined(this.selection)&&!t.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var i=this.getPropertyValue(e);"background"===e&&(e="shading"),t.isNullOrUndefined(i)||this.selection.owner.editorModule.onApplyTableFormat(e,i)}},e.prototype.copyFormat=function(e){this.leftIndent=e.leftIndent,this.background=e.shading.backgroundColor,this.tableAlignment=e.tableAlignment,this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.cellSpacing=e.cellSpacing,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},e.prototype.clearFormat=function(){this.table=void 0,this.leftIndent=0,this.background=void 0,this.leftIndent=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.bottomMargin=0,this.cellSpacing=0,this.tableAlignment=void 0},e.prototype.destroy=function(){this.leftIndentIn=void 0,this.backgroundIn=void 0,this.leftIndentIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.bottomMarginIn=void 0,this.cellSpacingIn=void 0,this.tableAlignmentIn=void 0,this.tableIn=void 0,this.selection=void 0},e}(),Fe=function(){function e(e){this.verticalAlignmentIn=void 0,this.leftMarginIn=0,this.rightMarginIn=0,this.topMarginIn=0,this.bottomMarginIn=0,this.backgroundIn=void 0,this.preferredWidthTypeIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"verticalAlignment",{get:function(){return this.verticalAlignmentIn},set:function(e){e!==this.verticalAlignmentIn&&(this.verticalAlignmentIn=e,this.notifyPropertyChanged("verticalAlignment"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftMargin",{get:function(){return this.leftMarginIn},set:function(e){e!==this.leftMarginIn&&(this.leftMarginIn=e,this.notifyPropertyChanged("leftMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightMargin",{get:function(){return this.rightMarginIn},set:function(e){e!==this.rightMarginIn&&(this.rightMarginIn=e,this.notifyPropertyChanged("rightMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topMargin",{get:function(){return this.topMarginIn},set:function(e){e!==this.topMarginIn&&(this.topMarginIn=e,this.notifyPropertyChanged("topMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomMargin",{get:function(){return this.bottomMarginIn},set:function(e){e!==this.bottomMarginIn&&(this.bottomMarginIn=e,this.notifyPropertyChanged("bottomMargin"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this.backgroundIn},set:function(e){e!==this.backgroundIn&&(this.backgroundIn=e,this.notifyPropertyChanged("background"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidthType",{get:function(){return this.preferredWidthTypeIn},set:function(e){e!==this.preferredWidthTypeIn&&(this.preferredWidthTypeIn=e,this.notifyPropertyChanged("preferredWidthType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"preferredWidth",{get:function(){return this.preferredWidthIn},set:function(e){e!==this.preferredWidthIn&&(this.preferredWidthIn=e,this.notifyPropertyChanged("preferredWidth"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var i=this.selection;if(!t.isNullOrUndefined(i)){if((i.isCleared||!i.owner.isDocumentLoaded||i.owner.isReadOnlyMode||i.owner.isPastingContent)&&!i.isRetrieveFormatting)return;if(!t.isNullOrUndefined(this.selection.start)&&!this.selection.isRetrieveFormatting){var r=this.getPropertyValue(e);"background"===e&&(e="shading"),t.isNullOrUndefined(r)||this.selection.owner.editorModule.onApplyTableCellFormat(e,r)}}},e.prototype.getPropertyValue=function(e){switch(e){case"verticalAlignment":return this.verticalAlignment;case"leftMargin":return this.leftMargin;case"rightMargin":return this.rightMargin;case"topMargin":return this.topMargin;case"bottomMargin":return this.bottomMargin;case"preferredWidth":return this.preferredWidth;case"preferredWidthType":return this.preferredWidthType;case"background":var t=new E;return t.backgroundColor=this.background,t;default:return}},e.prototype.copyFormat=function(e){this.leftMargin=e.leftMargin,this.rightMargin=e.rightMargin,this.topMargin=e.topMargin,this.bottomMargin=e.bottomMargin,this.background=e.shading.backgroundColor,this.verticalAlignment=e.verticalAlignment,this.preferredWidth=e.preferredWidth,this.preferredWidthType=e.preferredWidthType},e.prototype.clearCellFormat=function(){this.leftMargin=void 0,this.rightMargin=void 0,this.topMargin=void 0,this.bottomMargin=void 0,this.background=void 0,this.verticalAlignment=void 0},e.prototype.combineFormat=function(e){t.isNullOrUndefined(this.leftMargin)||this.leftMargin===e.leftMargin||(this.leftMargin=void 0),t.isNullOrUndefined(this.topMargin)||this.topMargin===e.topMargin||(this.topMargin=void 0),t.isNullOrUndefined(this.rightMargin)||this.rightMargin===e.rightMargin||(this.rightMargin=void 0),t.isNullOrUndefined(this.bottomMargin)||this.bottomMargin===e.bottomMargin||(this.bottomMargin=void 0),t.isNullOrUndefined(this.background)||this.background===e.shading.backgroundColor||(this.background=void 0),t.isNullOrUndefined(this.verticalAlignment)||this.verticalAlignment===e.verticalAlignment||(this.verticalAlignment=void 0),t.isNullOrUndefined(this.preferredWidth)||this.preferredWidth===e.preferredWidth||(this.preferredWidth=void 0),t.isNullOrUndefined(this.preferredWidthType)||this.preferredWidthType===e.preferredWidthType||(this.preferredWidthType=void 0)},e.prototype.clearFormat=function(){this.background=void 0,this.bottomMargin=0,this.leftMargin=0,this.rightMargin=0,this.topMargin=0,this.verticalAlignment=void 0},e.prototype.destroy=function(){this.backgroundIn=void 0,this.verticalAlignmentIn=void 0,this.bottomMarginIn=void 0,this.leftMarginIn=void 0,this.rightMarginIn=void 0,this.topMarginIn=void 0,this.selection=void 0},e}(),Pe=function(){function e(e){this.heightIn=void 0,this.heightTypeIn=void 0,this.isHeaderIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.selection=e}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){e!==this.heightIn&&(this.heightIn=e,this.notifyPropertyChanged("height"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"heightType",{get:function(){return this.heightTypeIn},set:function(e){e!==this.heightTypeIn&&(this.heightTypeIn=e,this.notifyPropertyChanged("heightType"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isHeader",{get:function(){return this.isHeaderIn},set:function(e){e!==this.isHeaderIn&&(this.isHeaderIn=e,this.notifyPropertyChanged("isHeader"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowBreakAcrossPages",{get:function(){return this.allowRowBreakAcrossPagesIn},set:function(e){e!==this.allowRowBreakAcrossPagesIn&&(this.allowRowBreakAcrossPagesIn=e,this.notifyPropertyChanged("allowBreakAcrossPages"))},enumerable:!0,configurable:!0}),e.prototype.notifyPropertyChanged=function(e){var i=this.selection;if((t.isNullOrUndefined(i)||!i.isCleared&&!i.owner.isReadOnlyMode&&i.owner.isDocumentLoaded&&!i.owner.isPastingContent||i.isRetrieveFormatting)&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(i.start)&&!i.isRetrieveFormatting){var r=this.getPropertyValue(e);t.isNullOrUndefined(r)||i.owner.editorModule.onApplyTableRowFormat(e,r)}},e.prototype.getPropertyValue=function(e){switch(e){case"height":return this.height;case"heightType":return this.heightType;case"isHeader":return this.isHeader;case"allowBreakAcrossPages":return this.allowBreakAcrossPages;default:return}},e.prototype.copyFormat=function(e){this.height=e.height,this.heightType=e.heightType,this.allowBreakAcrossPages=e.allowBreakAcrossPages,this.isHeader=e.isHeader},e.prototype.combineFormat=function(e){t.isNullOrUndefined(this.height)||this.height===e.height||(this.height=void 0),t.isNullOrUndefined(this.heightType)||this.heightType===e.heightType||(this.heightType=void 0),t.isNullOrUndefined(this.allowBreakAcrossPages)||this.allowBreakAcrossPages===e.allowBreakAcrossPages||(this.allowBreakAcrossPages=void 0),t.isNullOrUndefined(this.isHeader)||this.isHeader===e.isHeader||(this.isHeader=void 0)},e.prototype.clearRowFormat=function(){this.height=void 0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.clearFormat=function(){this.height=0,this.heightType=void 0,this.allowBreakAcrossPages=void 0,this.isHeader=void 0},e.prototype.destroy=function(){this.heightIn=void 0,this.heightTypeIn=void 0,this.allowRowBreakAcrossPagesIn=void 0,this.isHeaderIn=void 0,this.selection=void 0},e}(),We=function(){function e(e){this.selection=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this.image?this.image.width:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.image?this.image.height:0},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,t){this.updateImageFormat(e,t)},e.prototype.updateImageFormat=function(e,t){this.image&&this.selection.owner.editorModule&&this.selection.owner.editorModule.onImageFormat(this.image,e,t)},e.prototype.copyImageFormat=function(e){this.image=e},e.prototype.clearImageFormat=function(){this.image=void 0},e}(),Te=function(){function e(){this.document=void 0,this.fieldCheck=0}return e.prototype.writeHtml=function(e){this.document=e;for(var t="",i=0;i<e.sections.length;i++)t=this.serializeSection(e.sections[i]);return t},e.prototype.serializeSection=function(e){for(var t="",i=0;i<e.blocks.length;i++){var r=e.blocks[i];r.hasOwnProperty("inlines")?t+=this.serializeParagraph(r):t+=this.serializeTable(r)}return t},e.prototype.serializeParagraph=function(e){var t="",i=[];return i.push('style="'+this.serializeParagraphStyle(e,"",!1)+'"'),t+=this.createAttributesTag("p",i),0===e.inlines.length?t+="&nbsp;":t=this.serializeInlines(e,t),t+=this.endTag("p")},e.prototype.serializeInlines=function(e,i){for(var r=void 0,n=0;e.inlines.length>n;){if((r=e.inlines[n]).hasOwnProperty("imageString"))i+=this.serializeImageContainer(r);else if(r.hasOwnProperty("fieldType"))if(0===r.fieldType){this.fieldCheck=1;var o=[];o.push('style="'+this.serializeInlineStyle(r.characterFormat,"")+'"'),i+=this.createAttributesTag("a",o)}else 2===r.fieldType?this.fieldCheck=2:(i+=this.endTag("a"),this.fieldCheck=0);else{var a=t.isNullOrUndefined(r.text)?"":r.text;0===this.fieldCheck&&(i+=this.serializeSpan(a,r.characterFormat)),1===this.fieldCheck&&(i+=' href= "'+a.replace('"',"").replace("HYPERLINK","").trim(),i+='"',i+=">"),2===this.fieldCheck&&(i+=a)}n++}return i},e.prototype.serializeSpan=function(e,t){var i="";if(-1!==e.indexOf("\v"))return(i+="<br>").toString();var r=[];return this.serializeInlineStyle(t,""),r.push('style="'+this.serializeInlineStyle(t,"")+'"'),i+=this.createAttributesTag("span",r),i+=this.decodeHtmlNames(e.toString()),(i+=this.endTag("span")).toString()},e.prototype.serializeImageContainer=function(e){var i="",r=[];this.serializeInlineStyle(e.characterFormat,"");var n="";t.isNullOrUndefined(e.imageString)||(n=e.imageString);var o=W.convertPointToPixel(e.width),a=W.convertPointToPixel(e.height);return r.push('width="',o.toString()+'"'),r.push('height="',a.toString()+'"'),r.push('src="',n+'"'),i+=this.createAttributesTag("img",r),(i+=this.endTag("img")).toString()},e.prototype.serializeCell=function(e){var i="",r=[],n="";r=[],t.isNullOrUndefined(e.cellFormat)||(r.push('bgcolor="'+e.cellFormat.shading.backgroundColor+'"'),e.cellFormat.columnSpan>1&&r.push('colspan="'+e.cellFormat.columnSpan.toString()+'"'),e.cellFormat.rowSpan>1&&r.push('rowspan="'+e.cellFormat.rowSpan.toString()+'"'),0!==e.cellFormat.cellWidth&&r.push('width="'+e.cellFormat.cellWidth.toString()+'"'),"Top"!==e.cellFormat.verticalAlignment&&r.push('valign="'+e.cellFormat.verticalAlignment.toString().toLowerCase()+'"'),t.isNullOrUndefined(e.cellFormat.leftMargin)||0===e.cellFormat.leftMargin||(n+="padding-left:"+e.cellFormat.leftMargin.toString()+"pt;"),t.isNullOrUndefined(e.cellFormat.rightMargin)||0===e.cellFormat.rightMargin||(n+="padding-right:"+e.cellFormat.rightMargin.toString()+"pt;"),t.isNullOrUndefined(e.cellFormat.topMargin)||0===e.cellFormat.topMargin||(n+="padding-top:"+e.cellFormat.topMargin.toString()+"pt;"),t.isNullOrUndefined(e.cellFormat.bottomMargin)||0===e.cellFormat.bottomMargin||(n+="padding-bottom:"+e.cellFormat.bottomMargin.toString()+"pt;"),t.isNullOrUndefined(e.cellFormat.borders)||(n+=this.serializeCellBordersStyle(e.cellFormat.borders))),0!==n.length&&r.push('style="'+n+'"'),i+=this.createAttributesTag("td",r);for(var o=0;o<e.blocks.length;o++){var a=e.blocks[o];a.hasOwnProperty("rows")?i+=this.serializeTable(a):i+=this.serializeParagraph(a)}return i+=this.endTag("td")},e.prototype.serializeTable=function(e){var t="";t+=this.createTableStartTag(e);for(var i=0;i<e.rows.length;i++)t+=this.serializeRow(e.rows[i]);return t+=this.createTableEndTag()},e.prototype.serializeRow=function(e){var t="";t+=this.createRowStartTag(e);for(var i=0;i<e.cells.length;i++)t+=this.serializeCell(e.cells[i]);return t},e.prototype.serializeParagraphStyle=function(e,t,i){var r="";return r+=this.serializeCharacterFormat(e.characterFormat),r+=this.serializeParagraphFormat(e.paragraphFormat,i)},e.prototype.serializeInlineStyle=function(e,t){return this.serializeCharacterFormat(e)},e.prototype.serializeTableBorderStyle=function(e){var t="";return t+="border-left-style:"+this.convertBorderLineStyle(e.left.lineStyle),t+=";",t+="border-left-width:"+e.left.lineWidth.toString()+"pt",t+=";",t+="border-left-color:"+e.left.color,t+=";",t+="border-right-style:"+this.convertBorderLineStyle(e.right.lineStyle),t+=";",t+="border-right-width:"+e.right.lineWidth.toString()+"pt",t+=";",t+="border-right-color:"+e.right.color,t+=";",t+="border-top-style:"+this.convertBorderLineStyle(e.top.lineStyle),t+=";",t+="border-top-width:"+e.top.lineWidth.toString()+"pt",t+=";",t+="border-top-color:"+e.top.color,t+=";",t+="border-Bottom-style:"+this.convertBorderLineStyle(e.bottom.lineStyle),t+=";",t+="border-Bottom-width:"+e.bottom.lineWidth.toString()+"pt",t+=";",t+="border-Bottom-color:"+e.bottom.color,t+=";"},e.prototype.serializeCellBordersStyle=function(e){return"border:solid 1px;","border:solid 1px;"},e.prototype.serializeBorderStyle=function(e,t){var i="";return i+="border-"+t+"-style:"+this.convertBorderLineStyle(e.lineStyle),i+=";",e.lineWidth>0&&(i+="border-"+t+"-width:"+e.lineWidth.toString()+"pt;"),i+="border-"+t+"-color:"+e.color+";"},e.prototype.convertBorderLineStyle=function(e){switch(e){case"None":return"none";case"Single":return"solid";case"Dot":return"dotted";case"DashSmallGap":case"DashLargeGap":case"DashDot":case"DashDotDot":return"dashed";case"Double":case"Triple":case"ThinThickSmallGap":case"ThickThinSmallGap":case"ThinThickThinSmallGap":case"ThinThickMediumGap":case"ThickThinMediumGap":case"ThinThickThinMediumGap":case"ThinThickLargeGap":case"ThickThinLargeGap":case"ThinThickThinLargeGap":return"double";case"SingleWavy":return"solid";case"DoubleWavy":return"double";case"DashDotStroked":return"solid";case"Emboss3D":return"ridge";case"Engrave3D":return"groove";case"Outset":return"outset";case"Inset":return"inset";default:return"solid"}},e.prototype.serializeCharacterFormat=function(e){if(!t.isNullOrUndefined(e.inlineFormat))return this.serializeCharacterFormat(e.inlineFormat);var i,r="";return e.bold&&(r+="font-weight",r+=":",r+="bold",r+=";"),r+="font-style",r+=":",e.italic?r+="italic":r+="normal",r+=";","SingleStrike"!==e.strikethrough&&"DoubleStrike"!==e.strikethrough||(r+="text-decoration",r+=":",r+="line-through",r+=";"),"Superscript"!==e.baselineAlignment&&"Subscript"!==e.baselineAlignment||(r+="vertical-align",r+=":",r+="Superscript"===e.baselineAlignment?"super":"sub",r+=";"),t.isNullOrUndefined(e.highlightColor)||(r+="background-color",r+=":",r+=e.highlightColor.toString(),r+=";"),i=e.fontColor,t.isNullOrUndefined(i)||(r+="color",r+=":",r+=i,r+=";"),t.isNullOrUndefined(e.underline)||"None"===e.underline||(r+="text-decoration",r+=":",r+="underline",r+=";"),i=e.fontSize,t.isNullOrUndefined(i)||(r+="font-size",r+=":",r+=i.toString(),r+="pt",r+=";"),i=e.fontFamily,t.isNullOrUndefined(i)||(r+="font-family",r+=":",r+=i.toString(),r+=";"),r.toString()},e.prototype.serializeParagraphFormat=function(e,i){if(!t.isNullOrUndefined(e.inlineFormat))return this.serializeParagraphFormat(e.inlineFormat,i);var r,n="";return r=e.textAlignment,t.isNullOrUndefined(r)||(n+="text-align:"+r.toLowerCase()+";"),r=e.beforeSpacing,t.isNullOrUndefined(r)||(n+="margin-top:"+r.toString()+"pt; "),r=e.rightIndent,t.isNullOrUndefined(r)||(n+="margin-right:"+r.toString()+"pt; "),r=e.afterSpacing,t.isNullOrUndefined(r)||(n+="margin-bottom:"+r.toString()+"pt; "),r=e.leftIndent,i&&(t.isNullOrUndefined(r)?r=-48:r-=48),t.isNullOrUndefined(r)||(n+="margin-left:"+r.toString()+"pt; "),r=e.firstLineIndent,i&&(t.isNullOrUndefined(r)?r=24:r+=24),t.isNullOrUndefined(r)||0===r||(n+="text-indent:"+r.toString()+"pt;"),r=e.lineSpacing,t.isNullOrUndefined(r)||(n+="line-height:"+(r="Multiple"===e.lineSpacingType?(100*r).toString()+"%;":r.toString()+"pt;")),n.toString()},e.prototype.createAttributesTag=function(e,t){var i="";i+="<",i+=e;for(var r=0;r<t.length;r++)i+=" ",i+=t[r];return"a"!==e&&(i+=">"),i},e.prototype.createTag=function(e){var t="";return t+="<",t+=e,t+=">"},e.prototype.endTag=function(e){var t="";return t+="<",t+="/",t+=e,t+=">"},e.prototype.createTableStartTag=function(e){var i="",r="",n=[];return n.push('border="1"'),t.isNullOrUndefined(e.tableFormat)||(n.push('bgcolor="'+e.tableFormat.shading.backgroundColor+'"'),0!==e.tableFormat.leftIndent&&n.push('left-indent="'+e.tableFormat.leftIndent.toString()+"pt;"),e.tableFormat.cellSpacing>0?n.push('cellspacing="'+(72*e.tableFormat.cellSpacing/96*2).toString()+'"'):r+="border-collapse:collapse;",n.push('cellpadding="0"'),t.isNullOrUndefined(e.tableFormat.borders)||(r+=this.serializeTableBorderStyle(e.tableFormat.borders))),0!==r.length&&n.push('style="',r.toString()+'"'),i+=this.createAttributesTag("table",n)},e.prototype.createTableEndTag=function(){var e="";return e+=this.endTag("table")},e.prototype.createRowStartTag=function(e){var t="",i=[];return e.rowFormat.isHeader&&(t+=this.createTag("thead")),e.rowFormat.height>0&&i.push('height="'+e.rowFormat.height+'"'),t+this.createAttributesTag("tr",i)},e.prototype.createRowEndTag=function(e){var t="";return t+=this.endTag("tr"),e.rowFormat.isHeader&&(t+=this.endTag("thead")),t},e.prototype.decodeHtmlNames=function(e){if("\t"===e)return"&emsp;";var t=e.split(" "),i="";if(t.length>0){i=t[0];for(var r=0;r<t.length-1;r++)i+="&nbsp;"+t[r+1]}return i},e}(),Ie=function(){function e(e){this.location=new T(0,0),this.isUpdateLocation=!0,this.owner=e,this.viewer=this.owner.viewer}return Object.defineProperty(e.prototype,"paragraph",{get:function(){return this.currentWidget.paragraph},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphStart",{get:function(){return this.offset===this.owner.selection.getStartOffset(this.paragraph)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAtParagraphEnd",{get:function(){return this.owner.selection.isParagraphLastLine(this.currentWidget)&&this.offset===this.owner.selection.getLineLength(this.currentWidget)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){return this.owner.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hierarchicalPosition",{get:function(){return this.getHierarchicalIndexInternal()},enumerable:!0,configurable:!0}),e.prototype.clone=function(){var t=new e(this.owner);return t.currentWidget=this.currentWidget,t.offset=this.offset,t.location=this.location,t},e.prototype.setPositionForSelection=function(e,i,r,n){var o=!1;t.isNullOrUndefined(i)?this.currentWidget=e:(this.currentWidget=i.line,i.nextNode instanceof $&&r>i.length&&(o=this.selection.isLastRenderedInline(i,i.length))),this.location=n,this.offset=o?this.selection.getParagraphLength(this.currentWidget.paragraph)+1:this.currentWidget.getOffset(i,r)},e.prototype.setPositionFromLine=function(e,t,i){this.currentWidget=e,this.offset=t,i instanceof T&&this.location.copy(i)},e.prototype.setPosition=function(e,t){this.currentWidget=e,this.offset=t?this.selection.getStartOffset(e.paragraph):this.selection.getParagraphLength(e.paragraph)+1,this.updatePhysicalPosition(!0)},e.prototype.setPositionInternal=function(e){this.currentWidget=e.currentWidget,this.offset=e.offset,this.location=e.location},e.prototype.setPositionForCurrentIndex=function(e){var t={index:e},i=this.getParagraphWidget(t);this.offset=parseFloat(t.index),this.setPositionParagraph(i,this.offset)},e.prototype.getPage=function(e){var t=e.index.indexOf(";"),i="0";return t>=0&&(i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";","")),t=parseInt(i,10),this.viewer.pages[t]},e.prototype.getParagraphWidget=function(e){if(!t.isNullOrUndefined(e.index)){var i=this.getPage(e);return this.getLineWidget(void 0,e,i)}},e.prototype.getLineWidget=function(e,i,r){if(!t.isNullOrUndefined(i.index)){var n=i.index.indexOf(";"),o="0";if(n>=0&&(o=i.index.substring(0,n),i.index=i.index.substring(n).replace(";","")),"H"===o||"F"===o?e="H"===o?r.headerWidget:r.footerWidget:t.isNullOrUndefined(r)||(e=r.bodyWidgets[0]),n=parseInt(o,10),e instanceof _&&(n=i.index.indexOf(";"),o="0",o=i.index.substring(0,n),i.index=i.index.substring(n).replace(";",""),n=parseInt(o,10)),e instanceof X&&n>=e.childWidgets.length&&(i.index="0;0",n=e.childWidgets.length-1),n>=0&&n<e.childWidgets.length){var a=e.childWidgets[n];if(a instanceof J)return i.index.indexOf(";")>0&&(i.index="0"),a;if(a instanceof z){if(i.index.indexOf(";")>0)return this.getLineWidget(a,i);if(a instanceof K)return this.getLineWidget(this.selection.getFirstParagraphInFirstCell(a),i);if(a instanceof X&&-1===i.index.indexOf(";"))return this.selection.getFirstParagraphInFirstCell(a.ownerTable).childWidgets[0];return}}else if(e.nextRenderedWidget instanceof z)return i.index="0",e.nextRenderedWidget instanceof K?this.selection.getFirstParagraphInFirstCell(e.nextRenderedWidget).firstChild:this.getLineWidget(e.nextRenderedWidget,i)}},e.prototype.updatePhysicalPosition=function(e){this.currentWidget&&this.owner.isLayoutEnabled&&this.isUpdateLocation&&(this.location=this.selection.getPhysicalPositionInternal(this.currentWidget,this.offset,e))},e.prototype.isAtSamePosition=function(e){return this.currentWidget===e.currentWidget&&this.offset===e.offset},e.prototype.isInSameParagraph=function(e){if(t.isNullOrUndefined(e))throw new Error("textPosition is undefined.");return this.paragraph===e.paragraph},e.prototype.isExistBefore=function(e){if(t.isNullOrUndefined(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset<e.offset;var i=this.currentWidget.paragraph,r=e.currentWidget.paragraph;return i===r?i.childWidgets.indexOf(this.currentWidget)<r.childWidgets.indexOf(e.currentWidget):i.containerWidget===r.containerWidget?i.isInsideTable?i.associatedCell.childWidgets.indexOf(i)<r.associatedCell.childWidgets.indexOf(r):i.containerWidget.childWidgets.indexOf(i)<r.containerWidget.childWidgets.indexOf(r):this.owner.selection.isExistBefore(i,r)},e.prototype.isExistAfter=function(e){if(t.isNullOrUndefined(e))throw new Error("textPosition is undefined.");if(this.currentWidget===e.currentWidget)return this.offset>e.offset;if(this.currentWidget.paragraph===e.currentWidget.paragraph)return this.currentWidget.paragraph.childWidgets.indexOf(this.currentWidget)>e.currentWidget.paragraph.childWidgets.indexOf(e.currentWidget);var i=this.currentWidget.paragraph,r=e.currentWidget.paragraph;return i.containerWidget.index===r.containerWidget.index?i.isInsideTable?i.associatedCell.childWidgets.indexOf(i)>r.associatedCell.childWidgets.indexOf(r):i.containerWidget.childWidgets.indexOf(i)>r.containerWidget.childWidgets.indexOf(r):this.owner.selection.isExistAfter(i,r)},e.prototype.getHierarchicalIndexInternal=function(){return this.getHierarchicalIndex(this.currentWidget,this.offset.toString())},e.prototype.getHierarchicalIndex=function(e,t){var i=e;return i?i.getHierarchicalIndex(t):t},e.prototype.setPositionParagraph=function(e,t){this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.setPositionForLineWidget=function(e,t){var i=this.selection.getLineLength(e),r=e.paragraph.childWidgets.indexOf(e);if(e.isLastLine()&&(i+=1),t>i){var n=void 0;if(r>=e.paragraph.childWidgets.length-1){var o=this.selection.getNextRenderedBlock(e.paragraph);o&&o.index===e.paragraph.index&&(n=o.firstChild)}else n=e.paragraph.childWidgets[r+1];return void this.setPositionForLineWidget(n,t-i)}if(t<0){var a=e.paragraph.childWidgets[r-1],s=this.selection.getLineLength(a)+t;return void this.setPositionForLineWidget(a,s)}this.currentWidget=e,this.offset=t,this.updatePhysicalPosition(!0)},e.prototype.moveNextPosition=function(i){t.isNullOrUndefined(i)&&(i=!0);var r=this.selection.getNextStartInline(this.currentWidget,this.offset);if(r instanceof $&&0===r.fieldType&&!t.isNullOrUndefined(r.fieldEnd)){if(i)return this.moveNextPositionInternal(r),void this.moveNextPosition();var n=r.fieldEnd.line,o=r.fieldEnd,a=n.getOffset(o,1),s=this.getHierarchicalIndex(n,a.toString());if(e.isForwardSelection(this.selection.end.getHierarchicalIndexInternal(),s))return void this.selection.end.moveToInline(r.fieldEnd,1);this.moveToInline(r.fieldEnd,1)}var l=this.selection.getNextValidOffset(this.currentWidget,this.offset),d=this.paragraph.childWidgets.indexOf(this.currentWidget),h=0;if(l>this.offset){this.offset=l;var c=this.currentWidget.getInline(this.offset,h);if(r=c.element,h=c.index,!t.isNullOrUndefined(r)&&h===r.length&&r.nextNode instanceof $){var p=this.selection.getNextValidElement(r.nextNode);p instanceof $&&1===p.fieldType&&(r=p,this.offset=this.currentWidget.getOffset(r,1))}}else if(d+1<this.paragraph.childWidgets.length){var g=this.paragraph.childWidgets[d+1];g&&(this.currentWidget=g,this.offset=this.selection.getStartLineOffset(this.currentWidget));var u=this.currentWidget.getInline(this.offset,h);r=u.element,h=u.index,r instanceof $&&0===r.fieldType&&this.offset++}else this.updateOffsetToNextParagraph(h,!1);this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousParagraphInTable=function(e){var i,r=this.currentWidget.paragraph;i=r.isInsideTable?e.getPreviousSelectionCell(r.associatedCell):e.getPreviousParagraphBlock(r),t.isNullOrUndefined(i)||(this.currentWidget=i.childWidgets[i.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.updateOffsetToNextParagraph=function(e,i){var r,n=!1,o=void 0,a=this.paragraph.childWidgets.indexOf(this.currentWidget);if(i)if(a+1<this.paragraph.childWidgets.length){var s=this.paragraph.childWidgets[a+1];s&&(this.currentWidget=s,this.offset=0)}else o=this.selection.getNextSelectionBlock(this.paragraph),t.isNullOrUndefined(o)||o.containerWidget instanceof Y&&(n=!this.selection.start.paragraph.isInsideTable||!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,o.associatedCell).ownerTable.contains(o.associatedCell));else o=this.selection.getNextParagraphBlock(this.paragraph);!t.isNullOrUndefined(o)&&o.childWidgets.length>0&&(n?(this.currentWidget=o.childWidgets[o.childWidgets.length-1],this.offset=this.selection.getLineLength(this.currentWidget)+1):(this.currentWidget=o.firstChild,this.offset=i?1:this.selection.getStartLineOffset(this.currentWidget)));var l=this.currentWidget.getInline(this.offset,e);r=l.element,e=l.index,r instanceof $&&0===r.fieldType&&this.offset++},e.prototype.updateOffsetToPrevPosition=function(e,i){var r,n,o=this.paragraph.childWidgets.indexOf(this.currentWidget),a=this.selection.getPreviousValidOffset(this.currentWidget.paragraph,this.offset);if(this.offset>a)this.offset=a;else if(o>0){var s=this.paragraph.childWidgets[o-1];s&&(this.currentWidget=s,this.offset=this.currentWidget.getEndOffset())}else{var l=void 0,d=!1;i?(l=this.selection.getPreviousSelectionBlock(this.paragraph),t.isNullOrUndefined(l)||l.containerWidget instanceof Y&&(d=!this.selection.start.paragraph.isInsideTable||!this.selection.getContainerCellOf(this.selection.start.paragraph.associatedCell,l.associatedCell).ownerTable.contains(l.associatedCell))):l=this.selection.getPreviousParagraphBlock(this.paragraph),t.isNullOrUndefined(l)||(d?(this.currentWidget=l.firstChild,this.offset=this.selection.getStartLineOffset(this.currentWidget)):(this.currentWidget=l.childWidgets[l.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()))}if(e=0,r=this.currentWidget.getInline(this.offset,e),n=r.element,e=r.index,n instanceof $&&0===n.fieldType&&this.offset++,n instanceof $){var h=this.selection.getPreviousValidElement(n);t.isNullOrUndefined(h)||(n=h,this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,n.length),n instanceof $&&0===n.fieldType&&this.offset--)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphStartInternal=function(){var e=this.currentWidget.paragraph;t.isNullOrUndefined(this.selection.getNextParagraphBlock(e))||(this.currentWidget=this.selection.getNextParagraphBlock(e).firstChild,this.offset=this.selection.getStartOffset(e),this.updatePhysicalPosition(!0))},e.prototype.movePreviousPosition=function(){var e=0,i=this.currentWidget.getInline(this.offset,e),r=i.element;e=i.index;this.paragraph.childWidgets.indexOf(this.currentWidget);r instanceof $&&1===r.fieldType&&!t.isNullOrUndefined(r.fieldBegin)&&this.movePreviousPositionInternal(r),this.updateOffsetToPrevPosition(e,!1)},e.prototype.moveNextPositionInternal=function(e){var i;t.isNullOrUndefined(e.fieldSeparator)?i=e.fieldEnd:(i=e.fieldSeparator,this.currentWidget=i.line,this.currentWidget!==e.fieldEnd.line||this.selection.hasValidInline(this.paragraph,i,e.fieldEnd)||(i=e.fieldEnd)),this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,1)},e.prototype.moveBackward=function(){var i=0,r=this.currentWidget.getInline(this.offset,i),n=r.element;if(i=r.index,!this.owner.selection.isEmpty&&!t.isNullOrUndefined(n)){var o=this.selection.getNextRenderedElementBox(n,i);if(o instanceof $&&0===o.fieldType){var a=this.owner.selection.start.getHierarchicalIndexInternal(),s=o.fieldEnd.line.getOffset(o.fieldEnd,1),l=this.getHierarchicalIndex(o.fieldEnd.line,s.toString());if(!e.isForwardSelection(l,a))return void this.owner.selection.start.setPositionParagraph(o.fieldEnd.line,s)}}if(n instanceof $&&1===n.fieldType&&!t.isNullOrUndefined(n.fieldBegin)){var a=this.owner.selection.start.getHierarchicalIndexInternal(),s=n.line.getOffset(n,1),l=this.getHierarchicalIndex(n.line,s.toString());if(!e.isForwardSelection(a,l)){var d=n.fieldBegin.line.getOffset(n.fieldBegin,0);return this.currentWidget=n.fieldBegin.line,this.offset=d,void this.updatePhysicalPosition(!0)}this.movePreviousPositionInternal(n)}this.updateOffsetToPrevPosition(i,!0)},e.prototype.moveForward=function(){var i=0,r=this.currentWidget.getInline(this.offset,i),n=r.element;if(i=r.index,!t.isNullOrUndefined(n)){if(!this.owner.selection.isEmpty&&i===n.length&&n instanceof $&&1===n.fieldType){var o=this.owner.selection.start.getHierarchicalIndexInternal(),a=n.fieldBegin.line.getOffset(n.fieldBegin,0),s=this.getHierarchicalIndex(n.fieldBegin.line,a.toString());if(!e.isForwardSelection(o,s))return void this.owner.selection.start.setPositionParagraph(n.fieldBegin.line,a)}n=this.selection.getNextRenderedElementBox(n,i)}if(n instanceof $&&!t.isNullOrUndefined(n.fieldEnd)){var l=0,d=this.owner.selection.start.paragraph.getInline(this.owner.selection.start.offset,l),h=d.element;if(l=d.index,this.selection.getNextRenderedElementBox(h,l)!==n)return n=n.fieldEnd,this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,1),void this.updatePhysicalPosition(!0);this.moveNextPositionInternal(n)}else n instanceof $&&(0===n.fieldType||1===n.fieldType)&&(this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,1));i=0;var c=this.selection.getNextValidOffset(this.currentWidget,this.offset),p=this.selection.getLineLength(this.currentWidget),g=this.selection.isParagraphLastLine(this.currentWidget);if(this.offset<c){this.offset=c;var u=this.currentWidget.getInline(this.offset,i);if(n=u.element,i=u.index,!t.isNullOrUndefined(n)&&i===n.length&&n.nextNode instanceof $){var f=this.selection.getNextValidElement(n.nextNode);f instanceof $&&1===f.fieldType&&(n=f,this.offset=this.currentWidget.getOffset(n,1))}}else this.offset===c&&this.offset<p+1&&g?this.offset=p+1:this.updateOffsetToNextParagraph(i,!0);this.updatePhysicalPosition(!0)},e.prototype.moveToInline=function(e,t){this.currentWidget=e.line,this.offset=this.currentWidget.getOffset(e,t),this.updatePhysicalPosition(!0)},e.isForwardSelection=function(e,t){if(e===t)return!0;e=e.replace(/C;/g,""),t=t.replace(/C;/g,""),e=e.replace(/H;/g,""),t=t.replace(/H;/g,""),e=e.replace(/F;/g,""),t=t.replace(/F;/g,"");var i=e.split(";"),r=t.split(";"),n=i.length;n>r.length&&(n=r.length-1);for(var o=0;o<n;o++){var a=parseFloat(i[o]),s=parseFloat(r[o]);if(a!==s)return a<s}return!1},e.prototype.movePreviousPositionInternal=function(e){var i;i=t.isNullOrUndefined(e.fieldSeparator)?this.selection.getPreviousValidElement(e.fieldBegin):this.selection.getPreviousValidElement(e),this.currentWidget=i.line,this.offset=this.currentWidget.getOffset(i,i instanceof $?0:i.length)},e.prototype.moveToWordStartInternal=function(e){var i=this.currentWidget.getEndOffset(),r=this.currentWidget.paragraph,n=this.selection;if(2!==e||this.offset!==i&&this.offset!==i+1){if(this.offset===i+1)this.offset=i;else if(this.offset===n.getStartOffset(r)&&this.currentWidget===r.childWidgets[0]){var o=n.getPreviousParagraphBlock(r);if(t.isNullOrUndefined(o))return;this.currentWidget=o.childWidgets[o.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()}else{if(this.offset===n.getStartLineOffset(this.currentWidget)){var a=r.childWidgets.indexOf(this.currentWidget);a-1>=0&&(this.currentWidget=r.childWidgets[a-1],this.offset=this.currentWidget.getEndOffset())}var s=0,l=this.currentWidget.getInline(this.offset,s),d=l.element;s=l.index,this.getPreviousWordOffset(d,n,s,e,d instanceof $&&1===d.fieldType,!1,!1,this)}1===e&&this.calculateOffset(),this.updatePhysicalPosition(!0)}},e.prototype.getNextWordOffset=function(e,t,i,r,n,o,a){e instanceof Q?this.getNextWordOffsetSpan(e,t,i,r,n,o,a):e instanceof re?this.getNextWordOffsetImage(e,t,i,r,n,o,a):e instanceof $&&0===e.fieldType?this.getNextWordOffsetFieldBegin(e,t,i,r,n,o,a):e instanceof $&&2===e.fieldType||e instanceof ie?this.getNextWordOffsetFieldSeperator(e,t,i,r,n,o,a):e instanceof $&&1===e.fieldType&&this.getNextWordOffsetFieldEnd(e,t,i,r,n,o,a)},e.prototype.getNextWordOffsetFieldBegin=function(e,i,r,n,o,a,s){var l=e.line.getOffset(e,0);e.length;if(t.isNullOrUndefined(e.fieldSeparator))this.getNextWordOffsetFieldEnd(e.fieldEnd,0,r,n,o,a,s);else if(0===r)this.getNextWordOffsetFieldSeperator(e.fieldSeparator,0,r,n,o,a,s);else if(!t.isNullOrUndefined(e.fieldEnd)){var d=e.fieldSeparator;if(d.line.paragraph!==e.fieldEnd.line.paragraph||this.selection.hasValidInline(d.line.paragraph,d,e.fieldEnd)||(d=e.fieldEnd),this.getNextWordOffset(d,0,r,!(a.paragraph===e.line.paragraph&&a.offset===l),o,a,s),o&&!t.isNullOrUndefined(e.fieldSeparator)&&a.paragraph===e.line.paragraph&&a.offset===e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))return void a.setPositionParagraph(e.line,l);o||a.setPositionParagraph(e.fieldEnd.line,e.fieldEnd.line.getOffset(e.fieldEnd,e.fieldEnd.length))}},e.prototype.getNextWordOffsetImage=function(e,i,r,n,o,a,s){if(n)return a.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(o=!1);if(0===i){var l=e.line.getOffset(e,0);o=!0,a.offset===l?t.isNullOrUndefined(e.nextNode)?a.setPositionParagraph(e.line,l+e.length):this.getNextWordOffset(e.nextNode,0,r,n,o,a,s):a.setPositionParagraph(e.line,l)}else t.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,r,n,o,a,s)},e.prototype.getNextWordOffsetSpan=function(e,i,r,n,o,a,s){if("\t"===e.text||"\v"===e.text){if(n)return a.setPositionParagraph(e.line,e.line.getOffset(e,i)),void(o=!1);if(0===i){o=!0;var l=e.line.getOffset(e,0);a.offset===l?a.setPositionParagraph(e.line,l+e.length):a.setPositionParagraph(e.line,l)}else t.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,r,n,o,a,s)}else{var d=0;if(0===i&&o&&-1===W.wordSplitCharacters.indexOf(e.text[0])){if(a.setPositionParagraph(e.line,e.line.getOffset(e,i)),n)return}else if(i<e.length){var h=i>0&&e.text.length-1>=i?e.text.slice(i,e.length):e.text;if(-1!==(d=W.indexOfAny(h,W.wordSplitCharacters))){if(n)return void(o=!1);var c=e.line.getOffset(e,d+i);if((s||" "!==h[d])&&!o&&e.line.paragraph===a.paragraph&&c!==a.offset)return o=!0,void a.setPositionParagraph(e.line,c);for(d++;d<h.length&&-1!==W.wordSplitCharacters.indexOf(h[d])&&(" "===h[d]||"　"===h[d]);)d++;o=!0,d<h.length?a.setPositionParagraph(e.line,e.line.getOffset(e,d+i)):t.isNullOrUndefined(e.nextNode)?a.setPositionParagraph(e.line,e.line.getOffset(e,d+i)):this.getNextWordOffset(e.nextNode,0,r,n,o,a,s)}else t.isNullOrUndefined(e.nextNode)?a.setPositionParagraph(e.line,e.line.getEndOffset()):this.getNextWordOffset(e.nextNode,0,r,n,o,a,s)}else t.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,r,n,o,a,s)}},e.prototype.getNextWordOffsetFieldSeperator=function(e,i,r,n,o,a,s){t.isNullOrUndefined(e.nextNode)||this.getNextWordOffset(e.nextNode,0,r,n,o,a,s)},e.prototype.getNextWordOffsetFieldEnd=function(e,i,r,n,o,a,s){var l=e.line.getOffset(e,0),d=l+e.length;a.offset===l&&(a.setPositionParagraph(e.line,d),t.isNullOrUndefined(e.nextNode))||(t.isNullOrUndefined(e.nextNode)?a.setPositionParagraph(e.line,l):(this.getNextWordOffset(e.nextNode,0,r,!1,o,a,s),a.offset===d&&a.setPositionParagraph(e.line,l)),o=!0)},e.prototype.getPreviousWordOffset=function(e,t,i,r,n,o,a,s){e instanceof Q?this.getPreviousWordOffsetSpan(e,t,i,r,n,o,a,s):e instanceof re?this.getPreviousWordOffsetImage(e,t,i,r,n,o,a,s):e instanceof $&&0===e.fieldType?this.getPreviousWordOffsetFieldBegin(e,t,i,r,n,o,a,s):e instanceof $&&2===e.fieldType?this.getPreviousWordOffsetFieldSeparator(e,t,i,r,n,o,a,s):e instanceof $&&1===e.fieldType?this.getPreviousWordOffsetFieldEnd(e,t,i,r,n,o,a,s):e instanceof ie?this.getPreviousWordOffsetBookMark(e,t,i,r,n,o,a,s):e instanceof ne&&e.previousNode&&this.getPreviousWordOffsetSpan(e.previousNode,t,i,r,n,o,a,s)},e.prototype.getPreviousWordOffsetBookMark=function(e,t,i,r,n,o,a,s){if(e.previousNode){if(e.previousNode instanceof Q){var l=e.previousNode;W.lastIndexOfAny(l.text,W.wordSplitCharacters)!==l.text.length-1?this.getPreviousWordOffset(l,t,i,r,n,o,a,s):s.setPositionParagraph(e.line,e.line.getOffset(e,0))}}else s.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.getPreviousWordOffsetFieldEnd=function(e,i,r,n,o,a,s,l){var d=e.line.getOffset(e,0),h=d+e.length;if(t.isNullOrUndefined(e.fieldSeparator))this.getPreviousWordOffsetFieldBegin(e.fieldBegin,i,0,n,o,a,s,l);else if(0!==n||t.isNullOrUndefined(e.previousNode)){if(!t.isNullOrUndefined(e.fieldBegin)&&0!==n){c=e.previousNode;if((t.isNullOrUndefined(c)||c.line.paragraph===e.fieldBegin.line.paragraph&&!i.hasValidInline(c.line.paragraph,c,e.fieldBegin))&&(c=e.fieldBegin),this.getPreviousWordOffset(c,i,c.length,n,!(l.paragraph===e.line.paragraph&&l.offset===h),a,s,l),s&&l.paragraph===e.line.paragraph&&l.offset===d)return void l.setPositionParagraph(e.line,h);s||l.setPositionParagraph(e.fieldBegin.line,e.fieldBegin.line.getOffset(e.fieldBegin,0))}}else{var c=e.previousNode;this.getPreviousWordOffset(c,i,c.length,n,c instanceof $&&1===c.fieldType,a,s,l)}},e.prototype.getPreviousWordOffsetFieldSeparator=function(e,t,i,r,n,o,a,s){this.getPreviousWordOffsetFieldBegin(e.fieldBegin,t,e.fieldBegin.length,r,n,o,a,s)},e.prototype.getPreviousWordOffsetFieldBegin=function(e,i,r,n,o,a,s,l){var d=e.line.getOffset(e,0),h=d+e.length;l.offset===h&&l.setPositionParagraph(e.line,d),t.isNullOrUndefined(e.previousNode)?l.setPositionParagraph(e.line,i.getStartLineOffset(e.line)):(this.getPreviousWordOffset(e.previousNode,i,e.previousNode.length,n,!1,a,s,l),l.offset===d&&(0===n||t.isNullOrUndefined(e.fieldSeparator)||l.setPositionParagraph(e.line,e.fieldSeparator.line.getOffset(e.fieldSeparator,e.fieldSeparator.length))))},e.prototype.getPreviousWordOffsetImage=function(e,i,r,n,o,a,s,l){if(o)return l.setPositionParagraph(e.line,e.line.getOffset(e,r)),void(s=!1);if(r===e.length){var d=e.line.getOffset(e,e.length);d===l.offset?l.setPositionParagraph(e.line,d-e.length):l.setPositionParagraph(e.line,d)}else t.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,i,e.previousNode.length,n,o,a,s,l)},e.prototype.getPreviousWordOffsetSpan=function(e,i,r,n,o,a,s,l){if("\t"===e.text||"\v"===e.text){if(o)return void(s=!1);if(r===e.length){s=!0;var d=e.line.getOffset(e,e.length);d===l.offset?l.setPositionParagraph(e.line,d-e.length):l.setPositionParagraph(e.line,d)}else t.isNullOrUndefined(e.previousNode)||this.getPreviousWordOffset(e.previousNode,i,e.previousNode.length,n,o,a,s,l)}else{var h=0;if(!a){for(;r>0&&" "===e.text[r-1];)r--;l.setPositionParagraph(e.line,e.line.getOffset(e,r))}if(r>0){if(a=!0,0===r&&s&&-1===W.wordSplitCharacters.indexOf(e.text[0]))return l.setPositionParagraph(e.line,e.line.getOffset(e,r)),void(s=!0);var c=e.text.length>r?e.text.slice(0,r):e.text;if(-1!==(h=W.lastIndexOfAny(c,W.wordSplitCharacters))){if(o)return void(s=!1);for(;h>0&&s&&" "!==c[h]&&-1!==W.wordSplitCharacters.indexOf(c[h-1]);)h--;if(" "!==c[h]&&"　"!==c[h]&&s||h++,s=!0,h>0){var p=e.line.getOffset(e,h);e.line.paragraph===l.paragraph&&p===l.offset?this.getPreviousWordOffsetSpan(e,i,r,n,o,a,s,l):l.setPositionParagraph(e.line,p)}else e.previousNode instanceof Q?this.getPreviousWordOffset(e.previousNode,i,e.previousNode.length,n,o,a,s,l):l.setPositionParagraph(e.line,e.line.getOffset(e,0))}else this.setPreviousWordOffset(e,i,r,n,o,a,s,l)}else this.setPreviousWordOffset(e,i,r,n,o,a,s,l)}},e.prototype.setPreviousWordOffset=function(e,t,i,r,n,o,a,s){e.previousNode instanceof Z&&e.line===e.previousNode.line?this.getPreviousWordOffset(e.previousNode,t,e.previousNode.length,r,n,o,a,s):s.setPositionParagraph(e.line,t.getStartLineOffset(e.line))},e.prototype.validateForwardFieldSelection=function(i,r){var n=new e(this.owner);n.setPositionForCurrentIndex(i),n.isUpdateLocation=!1;for(var o=!1;i!==r&&e.isForwardSelection(i,r)&&(o||(n.moveNextPosition(!1),i!==n.getHierarchicalIndexInternal()));){var a=0,s=n.currentWidget.getInline(n.offset,a),l=s.element;if(a=s.index,!t.isNullOrUndefined(l)){var d=this.selection.start.getHierarchicalIndexInternal();if(a===l.length&&l instanceof $&&1===l.fieldType){if(l.line.getOffset(l,0)===this.offset)return;var h=l.fieldBegin.line,c=h.getOffset(l.fieldBegin,0),p=this.getHierarchicalIndex(h,c.toString());e.isForwardSelection(d,p)||this.selection.start.setPositionParagraph(h,c)}var g=this.selection.getNextRenderedElementBox(l,a);!t.isNullOrUndefined(g)&&g instanceof Z&&(l=g)}if(o=l instanceof $&&0===l.fieldType&&!t.isNullOrUndefined(l.fieldEnd)){if(l.line.getOffset(l,0)===this.offset)return;var u=l.fieldEnd,f=(u.line.paragraph,u.line.getOffset(u,1)),m=this.getHierarchicalIndex(u.line,f.toString());if(!e.isForwardSelection(m,r))return void this.moveToInline(l.fieldEnd,1);n.moveToInline(l.fieldEnd,1)}i=n.getHierarchicalIndexInternal()}},e.prototype.validateBackwardFieldSelection=function(i,r){var n=new e(this.owner);n.setPositionForCurrentIndex(i),n.isUpdateLocation=!1;for(var o=this.selection.start.getHierarchicalIndexInternal();i!==r&&e.isForwardSelection(r,i);){var a=0,s=n.currentWidget.getInline(n.offset,a),l=s.element;if(a=s.index,!t.isNullOrUndefined(l)){var d=this.selection.getNextRenderedElementBox(l,a);if(d instanceof $&&0===d.fieldType){var h=d.fieldEnd.line,c=h.getOffset(d.fieldEnd,1),p=this.getHierarchicalIndex(h,c.toString());e.isForwardSelection(p,o)||(this.selection.start.setPositionParagraph(h,c),o=p)}}if(l instanceof $&&1===l.fieldType&&!t.isNullOrUndefined(l.fieldBegin)){var g=l.fieldBegin.line,u=l.fieldBegin,f=g.getOffset(u,0),m=this.getHierarchicalIndex(g,f.toString());if(!e.isForwardSelection(r,m))return void this.moveToInline(l.fieldBegin,0);n.moveToInline(l.fieldBegin,0)}else n.movePreviousPosition();i=n.getHierarchicalIndexInternal()}},e.prototype.paragraphStartInternal=function(e,i){var r=e.getStartLineOffset(this.currentWidget);if(this.offset===r&&i){if(this.moveToNextParagraphInTableCheck())this.moveToPreviousParagraphInTable(e);else if(!t.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph))){var n=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=n.childWidgets[0],this.offset=e.getStartLineOffset(this.currentWidget)}}else this.currentWidget=this.currentWidget.paragraph.getSplitWidgets()[0].childWidgets[0],this.offset=r;this.calculateOffset()},e.prototype.calculateOffset=function(){var e=this.owner.selection.start.getHierarchicalIndexInternal(),t=this.getHierarchicalIndexInternal();e!==t&&this.validateBackwardFieldSelection(e,t),this.updatePhysicalPosition(!0)},e.prototype.moveToParagraphStartInternal=function(e,i){var r=e.getStartOffset(this.paragraph);this.offset===r&&i?this.moveToNextParagraphInTableCheck()?this.moveToPreviousParagraphInTable(e):t.isNullOrUndefined(e.getPreviousParagraphBlock(this.paragraph))||(this.currentWidget=e.getPreviousParagraphBlock(this.paragraph).firstChild,this.offset=e.getStartOffset(this.paragraph)):(this.currentWidget=this.paragraph.firstChild,this.offset=e.getStartLineOffset(this.currentWidget));var n=this.owner.selection.start.getHierarchicalIndexInternal(),o=this.getHierarchicalIndexInternal();n!==o&&this.validateBackwardFieldSelection(n,o),this.updatePhysicalPosition(!1)},e.prototype.moveToParagraphEndInternal=function(e,i){for(var r=this.currentWidget.paragraph;r.nextSplitWidget;)r=r.nextSplitWidget;this.currentWidget=r.childWidgets[r.childWidgets.length-1];var n=this.currentWidget.getEndOffset()+1;if(this.offset===n&&i){if(this.moveToNextParagraphInTableCheck())this.moveToNextParagraphInTable();else if(!t.isNullOrUndefined(e.getNextParagraphBlock(this.currentWidget.paragraph))){var o=e.getNextParagraphBlock(this.currentWidget.paragraph);this.currentWidget=o.childWidgets[o.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1}}else this.offset=n;this.calculateOffset()},e.prototype.moveUp=function(e,i){var r=this.currentWidget.paragraph;this.moveToLineStartInternal(e,!0),this.movePreviousPosition();var n=void 0,o=this.currentWidget.paragraph;if(r.isInsideTable&&r!==o&&r.associatedCell!==o.associatedCell&&!t.isNullOrUndefined(o.associatedCell)&&r.associatedCell.ownerRow===o.associatedCell.ownerRow){var a=o.associatedCell.ownerRow;if(a.previousRenderedWidget instanceof X){var s=e.getFirstCellInRegion(a.previousRenderedWidget,o.associatedCell,i,!0),l=e.getLastParagraph(s);this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}else{var d=a.ownerTable.previousRenderedWidget;do{d instanceof K&&(d=e.getLastBlockInLastCell(d))}while(d instanceof K);d instanceof G&&this.setPosition(d.childWidgets[d.childWidgets.length-1],!1)}n=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!r.isInsideTable&&this.currentWidget.paragraph.isInsideTable){var s=e.getFirstCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),l=e.getLastParagraph(s);this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}else if(r.isInsideTable&&!t.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&r.associatedCell.ownerRow.previousRenderedWidget!==r.associatedCell.ownerRow.previousSplitWidget&&r.associatedCell.ownerRow.previousRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){var s=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0),l=e.getLastParagraph(s);this.setPosition(l.childWidgets[l.childWidgets.length-1],!1)}n=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var h=e.getTop(n);e.updateTextPositionWidget(n,new T(i,h),this,!1)},e.prototype.moveDown=function(e,i){var r=this.currentWidget.paragraph;this.offset;this.moveToLineEndInternal(e,!0);var n=this.selection.getParagraphLength(this.currentWidget.paragraph);this.offset>n&&(this.offset=n),this.moveNextPosition();var o=void 0;if(r.isInsideTable&&r!==this.currentWidget.paragraph&&r.associatedCell!==this.currentWidget.paragraph.associatedCell&&!t.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&r.associatedCell.ownerRow===this.currentWidget.paragraph.associatedCell.ownerRow){var a=this.currentWidget.paragraph.associatedCell.ownerRow;if(r.isInsideTable&&this.currentWidget.paragraph.isInsideTable&&r.associatedCell.cellFormat.rowSpan>1&&r.associatedCell.cellFormat.rowSpan+r.associatedCell.ownerRow.rowIndex===r.associatedCell.ownerTable.childWidgets.length&&(a=this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets[this.currentWidget.paragraph.associatedCell.ownerTable.childWidgets.length-1]),a.nextRenderedWidget instanceof X){l=this.selection.getLastCellInRegion(a.nextRenderedWidget,this.currentWidget.paragraph.associatedCell,i,!1);this.setPosition(this.selection.getFirstParagraph(l).childWidgets[0],!0)}else{var s=this.selection.getNextRenderedBlock(a.ownerTable);do{s instanceof K&&(s=this.selection.getFirstBlockInFirstCell(s))}while(s instanceof K);s instanceof G&&this.setPosition(s.childWidgets[0],!0)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}else{if(!r.isInsideTable&&this.currentWidget.paragraph.isInsideTable){l=this.selection.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!1);this.setPosition(this.selection.getFirstParagraph(l).childWidgets[0],!0)}else if(r.isInsideTable&&!t.isNullOrUndefined(this.currentWidget.paragraph.associatedCell)&&r.associatedCell.ownerRow.nextRenderedWidget!==r.associatedCell.ownerRow.nextSplitWidget&&r.associatedCell.ownerRow.nextRenderedWidget===this.currentWidget.paragraph.associatedCell.ownerRow){var l=e.getLastCellInRegion(this.currentWidget.paragraph.associatedCell.ownerRow,this.currentWidget.paragraph.associatedCell,this.owner.selection.upDownSelectionLength,!0);this.setPosition(e.getFirstParagraph(l).childWidgets[0],!1)}o=e.getLineWidgetParagraph(this.offset,this.currentWidget)}var d=this.selection.getTop(o);this.selection.updateTextPositionWidget(o,new T(i,d),this,!1)},e.prototype.moveToLineStartInternal=function(e,i){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var r=e.getLineWidgetInternal(this.currentWidget,this.offset,i),n=e.getFirstElementInternal(r),o=e.getStartOffset(this.currentWidget.paragraph);if(t.isNullOrUndefined(n)&&this.offset>o){var a=0,s=(d=this.currentWidget.getInline(this.offset,a)).element;a=d.index,s instanceof Q&&"\v"!==s.text&&(this.offset=o)}else if(!t.isNullOrUndefined(n)){var l=e.getIndexInInline(n);this.currentWidget=n.line,this.offset=this.currentWidget.getOffset(n,l),l=0;var d=this.currentWidget.getInline(this.offset,l),s=d.element;if(l=d.index,s instanceof $){var h=e.getPreviousValidElement(s);t.isNullOrUndefined(h)||(s=h,this.currentWidget=s.line,this.offset=this.currentWidget.getOffset(s,s.length),s instanceof $&&this.offset--)}}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTableCheck=function(){return!(!this.selection.start.paragraph.isInsideTable&&!this.paragraph.isInsideTable||this.selection.start.paragraph.associatedCell===this.paragraph.associatedCell&&!this.selection.isCellSelected(this.selection.start.paragraph.associatedCell,this.selection.start,this))},e.prototype.moveToWordEndInternal=function(e,i){var r=0,n=this.currentWidget.getEndOffset();if(this.selection.isParagraphFirstLine(this.currentWidget)&&(this.currentWidget.children[0]instanceof ne&&(r=1),this.currentWidget.children[1]instanceof ne&&(r=2)),this.offset+r===n||this.offset===n+1)if(this.offset===n&&0!==e)this.setPositionParagraph(this.currentWidget,n+1);else{var o=this.selection.getNextParagraphBlock(this.currentWidget.paragraph);if(t.isNullOrUndefined(o))return;this.currentWidget=o.childWidgets[0],this.offset=this.selection.getStartLineOffset(this.currentWidget),1===e&&(this.moveToNextParagraphInTableCheck()?this.moveToNextParagraphInTable():this.moveToWordEndInternal(e,i))}else{var a=0,s=this.currentWidget.getInline(this.offset,a),l=s.element;a=s.index,this.getNextWordOffset(l,a,e,!1,!1,this,i)}if(0!==e){var d=this.owner.selection.start.getHierarchicalIndexInternal(),h=this.getHierarchicalIndexInternal();d!==h&&this.validateForwardFieldSelection(d,h)}this.updatePhysicalPosition(!0)},e.prototype.moveToNextParagraphInTable=function(){var e=this.currentWidget.paragraph,i=e.isInsideTable?this.selection.getNextSelectionCell(e.associatedCell):this.selection.getNextParagraphBlock(e);t.isNullOrUndefined(i)||(this.currentWidget=i.childWidgets[i.childWidgets.length-1],this.offset=this.currentWidget.getEndOffset()+1)},e.prototype.moveToPreviousParagraph=function(e){var i=e.getStartOffset(this.currentWidget.paragraph);if(this.offset!==i||t.isNullOrUndefined(e.getPreviousParagraphBlock(this.currentWidget.paragraph)))this.offset=e.getStartOffset(this.currentWidget.paragraph);else{var r=e.getPreviousParagraphBlock(this.currentWidget.paragraph);this.currentWidget=r.childWidgets[0],this.offset=e.getStartOffset(this.currentWidget.paragraph)}this.updatePhysicalPosition(!0)},e.prototype.moveToPreviousLine=function(e,t){var i=this.getHierarchicalIndexInternal(),r=e.getLineWidgetParagraph(this.offset,this.currentWidget);this.moveToLineStartInternal(e,!0),this.currentWidget.paragraph.isInsideTable?this.moveUpInTable(e):this.moveBackward();var n=e.getLineWidgetParagraph(this.offset,this.currentWidget),o=e.getLeft(n);if(e.getWidth(n,!0)+o>=t&&r!==n){var a=e.getTop(n),s=new T(t,a);e.updateTextPositionWidget(n,s,this,!0)}var l=this.getHierarchicalIndexInternal();this.validateBackwardFieldSelection(i,l)},e.prototype.moveToLineEndInternal=function(e,i){this.location.x>this.viewer.clientActiveArea.right&&(this.offset=this.offset-1);var r=e.getLineWidgetParagraph(this.offset,this.currentWidget),n=e.getFirstElementInternal(r);if(t.isNullOrUndefined(n)&&this.offset===e.getStartLineOffset(this.currentWidget))this.offset=e.getParagraphLength(this.paragraph)+1,this.updatePhysicalPosition(!0);else if(!t.isNullOrUndefined(n)){var o=r.children[r.children.length-1],a=0;if(a+=o instanceof Q?o.length:1,this.currentWidget=o.line,a===o.length&&t.isNullOrUndefined(o.nextNode)&&e.isParagraphLastLine(this.currentWidget)){var s=e.getLineLength(this.currentWidget);this.offset=i?s+1:s}else{for(var l=o;!t.isNullOrUndefined(l)&&l.length===a&&l.nextNode instanceof $;){var d=e.getNextValidElement(l.nextNode);if(l!==d&&(l=d,a=0),l instanceof $&&0===l.fieldType&&!t.isNullOrUndefined(l.fieldEnd)){var h=l;t.isNullOrUndefined(h.fieldSeparator)?l=h.fieldEnd:(l=h.fieldSeparator,this.currentWidget=l.line,this.currentWidget!==h.fieldEnd.line||e.hasValidInline(this.currentWidget.paragraph,l,h.fieldEnd)||(l=h.fieldEnd)),this.currentWidget=l.line}l instanceof $&&(a=1)}a===l.length&&t.isNullOrUndefined(l.nextNode)&&a++,!i&&l instanceof Z&&"\v"===l.text&&a--,this.offset=this.currentWidget.getOffset(l,a)}this.updatePhysicalPosition(i)}},e.prototype.moveToNextLine=function(i){var r=this.selection,n=new e(this.owner);n.setPositionInternal(this);var o=this.getHierarchicalIndexInternal();r.getLineWidgetParagraph(this.offset,this.currentWidget),this.offset;this.moveToLineEndInternal(r,!0);var a=!n.isAtSamePosition(this);n.setPositionInternal(this),this.currentWidget.paragraph.isInsideTable?this.moveDownInTable(r):(this.moveNextPosition(),this.moveForward());var s=r.getLineWidgetParagraph(this.offset,this.currentWidget),l=r.getLeft(s),d=r.getFirstElementInternal(s),h=t.isNullOrUndefined(d)?r.getWidth(s,!0):r.getLeftInternal(s,d,1)-l;if(l<i&&h/2<i-l){var c=r.getTop(s),p=new T(i,c);r.updateTextPositionWidget(s,p,this,!0),r.getWidth(s,!0)<i-l&&this.moveToLineEndInternal(r,!0)}else a&&this.currentWidget.paragraph.isInsideTable&&this.currentWidget===this.owner.selection.start.currentWidget?this.setPositionInternal(n):a||this.moveToLineEndInternal(r,!0);var g=this.getHierarchicalIndexInternal();this.validateForwardFieldSelection(o,g)},e.prototype.moveUpInTable=function(e){var i=!1,r=this.owner.selection.end,n=!this.owner.selection.isEmpty;if(i=r.paragraph.isInsideTable){var o=this.currentWidget.paragraph.associatedCell,a=r.paragraph.associatedCell,s=e.getContainerCellOf(a,o);if(i=s.ownerTable.contains(o)){a=e.getSelectedCell(a,s),o=e.getSelectedCell(o,s);var l=e.containsCell(s,this.currentWidget.paragraph.associatedCell),d=e.isCellSelected(s,this,r);if(d||(d=this.currentWidget.paragraph===e.getFirstParagraph(s)&&this.isAtParagraphStart),(l&&d||!l)&&!t.isNullOrUndefined(o.ownerRow.previousRenderedWidget)){var h=o.ownerRow.previousRenderedWidget,c=e.getFirstCellInRegion(h,s,this.owner.selection.upDownSelectionLength,!0),p=e.getLastParagraph(c);return void this.setPosition(p.childWidgets[0],!0)}if(l&&d&&t.isNullOrUndefined(o.ownerRow.previousRenderedWidget)||!l)if(n){o=o.ownerRow.childWidgets[0];p=e.getFirstParagraph(o);this.setPosition(p.childWidgets[0],!0)}else{o=o.ownerRow.childWidgets[o.ownerRow.childWidgets.length-1];p=e.getLastParagraph(o);this.setPosition(p.childWidgets[0],!1)}}}if(!i){c=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(n){c=c.ownerRow.childWidgets[0];p=e.getFirstParagraph(c);this.setPosition(p.childWidgets[0],!0)}else{c=c.ownerRow.childWidgets[c.ownerRow.childWidgets.length-1];p=e.getLastParagraph(c);this.setPosition(p.childWidgets[0],!1)}}this.moveBackward()},e.prototype.moveDownInTable=function(e){var i=!1,r=this.owner.selection.isEmpty||this.owner.selection.isForward;if(i=this.owner.selection.start.paragraph.isInsideTable){var n=this.owner.selection.start.paragraph.associatedCell,o=this.currentWidget.paragraph.associatedCell,a=e.getContainerCellOf(n,o);if(i=a.ownerTable.contains(o)){n=e.getSelectedCell(n,a),o=e.getSelectedCell(o,a);var s=e.containsCell(a,this.currentWidget.paragraph.associatedCell),l=e.isCellSelected(a,this.owner.selection.start,this);if((s&&l||!s)&&!t.isNullOrUndefined(o.ownerRow.nextRenderedWidget)){var d=o.ownerRow.nextRenderedWidget,h=e.getLastCellInRegion(d,a,this.owner.selection.upDownSelectionLength,!1),c=e.getLastParagraph(h);return void this.setPosition(c.childWidgets[c.childWidgets.length-1],!1)}if(s&&l&&t.isNullOrUndefined(o.ownerRow.nextRenderedWidget)||!s)if(r){o=o.ownerRow.childWidgets[o.ownerRow.childWidgets.length-1];c=e.getLastParagraph(o);this.setPosition(c.childWidgets[c.childWidgets.length-1],!1)}else{o=o.ownerRow.childWidgets[0];c=e.getFirstParagraph(o);this.setPosition(c.childWidgets[c.childWidgets.length-1],!0)}}}if(!i){h=e.getContainerCell(this.currentWidget.paragraph.associatedCell);if(r){h=h.ownerRow.childWidgets[h.ownerRow.childWidgets.length-1];c=e.getLastParagraph(h);this.setPosition(c.childWidgets[c.childWidgets.length-1],!1)}else if(h.ownerRow.nextRenderedWidget){h=h.ownerRow.nextRenderedWidget.childWidgets[0];c=e.getFirstParagraph(h);this.setPosition(c.childWidgets[c.childWidgets.length-1],!0)}}this.moveForward()},e.prototype.destroy=function(){this.offset=void 0,this.isUpdateLocation=void 0,t.isNullOrUndefined(this.location)||this.location.destroy(),this.location=void 0,this.currentWidget=void 0,this.owner=void 0,this.viewer=void 0},e}(),Se=function(){function e(e,t){this.leftIn=0,this.widthIn=0,this.leftIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftIn},set:function(e){this.leftIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.widthIn=void 0,this.leftIn=void 0},e}(),Ne=function(){function e(e,t){this.linkInternal="",this.localRef="",this.opensNewWindow=!1;var i=t.getFieldCode(e);"hyperlink"===i.toLowerCase().substring(0,9)&&this.parseFieldValues(i.substring(9).trim(),t)}return Object.defineProperty(e.prototype,"navigationLink",{get:function(){return this.linkInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"localReference",{get:function(){return this.localRef},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"linkType",{get:function(){return this.typeInternal},enumerable:!0,configurable:!0}),e.prototype.parseFieldValues=function(e,t){for(var i=e.split(" "),r=!1,n=0;n<i.length;n++){var o=i[n];o.length<1||("\\t"===o||"\\l"===o?r=!0:"\\n"===o?this.opensNewWindow=!0:(o=this.parseFieldValue(o,'"'===o[0]?'"':void 0),r?(this.localRef=o,r=!1):this.linkInternal=o))}this.setLinkType()},e.prototype.parseFieldValue=function(e,t){e=e.substring(1);var i=t?e.indexOf(t):-1;return i<0&&(i=e.length),e.substring(0,i).trim()},e.prototype.setLinkType=function(){if(t.isNullOrUndefined(this.linkInternal)||this.linkInternal.length<1)return void(this.typeInternal="Bookmark");"www."===this.linkInternal.substring(0,4)?this.linkInternal="http://"+this.navigationLink:"@"===this.linkInternal[0]&&(this.linkInternal="mailto:"+this.navigationLink),"http://"===this.linkInternal.substring(0,7)||"https://"===this.linkInternal.substring(0,8)?this.typeInternal="WebPage":"mailto:"===this.linkInternal.substring(0,7)?this.typeInternal="Email":this.typeInternal="File"},e.prototype.destroy=function(){this.linkInternal=void 0,this.localRef=void 0,this.typeInternal=void 0,this.opensNewWindow=void 0},e}(),Oe=function(){function e(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height}return e.prototype.destroy=function(){this.width=void 0,this.height=void 0},e}(),Le=function(){function e(e){var t=this;this.upDownSelectionLength=0,this.isSkipLayouting=!1,this.isImageSelected=!1,this.contextTypeInternal=void 0,this.caret=void 0,this.isRetrieveFormatting=!1,this.skipFormatRetrieval=!1,this.isMoveDownOrMoveUp=!1,this.selectedWidgets=void 0,this.hideCaret=function(){t.caret.style.display="none"},this.owner=e,this.viewer=this.owner.viewer,this.start=new Ie(this.owner),this.end=new Ie(this.owner),this.selectedWidgets=new c,this.characterFormatIn=new we(this),this.paragraphFormatIn=new be(this,this.viewer),this.sectionFormatIn=new xe(this),this.rowFormatIn=new Pe(this),this.cellFormatIn=new Fe(this),this.tableFormatIn=new Ce(this),this.imageFormatInternal=new We(this)}return Object.defineProperty(e.prototype,"htmlWriter",{get:function(){return t.isNullOrUndefined(this.htmlWriterIn)&&(this.htmlWriterIn=new Te),this.htmlWriterIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){if(!t.isNullOrUndefined(this.owner)&&!t.isNullOrUndefined(this.viewer))return t.isNullOrUndefined(this.startInternal)&&(this.startInternal=this.owner.documentStart),this.startInternal},set:function(e){this.startInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"characterFormat",{get:function(){return this.characterFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paragraphFormat",{get:function(){return this.paragraphFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sectionFormat",{get:function(){return this.sectionFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableFormat",{get:function(){return this.tableFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cellFormat",{get:function(){return this.cellFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowFormat",{get:function(){return this.rowFormatIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageFormat",{get:function(){return this.imageFormatInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endInternal},set:function(e){this.endInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startPage",{get:function(){return!this.owner.isDocumentLoaded||t.isNullOrUndefined(this.viewer)||t.isNullOrUndefined(this.viewer.selectionStartPage)?1:this.viewer.pages.indexOf(this.viewer.selectionStartPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPage",{get:function(){return!this.owner.isDocumentLoaded||t.isNullOrUndefined(this.viewer)||t.isNullOrUndefined(this.viewer.selectionEndPage)?1:this.viewer.pages.indexOf(this.viewer.selectionEndPage)+1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isForward",{get:function(){return this.start.isExistBefore(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEmpty",{get:function(){return!!t.isNullOrUndefined(this.start)||this.start.isAtSamePosition(this.end)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.getText(!1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextType",{get:function(){return this.contextTypeInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCleared",{get:function(){return t.isNullOrUndefined(this.end)},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Selection"},e.prototype.goToHeader=function(){this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.headerWidget)},e.prototype.goToFooter=function(){this.owner.enableHeaderAndFooter=!0,this.enableHeadersFootersRegion(this.start.paragraph.bodyWidget.page.footerWidget)},e.prototype.closeHeaderFooter=function(){this.disableHeaderFooter()},e.prototype.goToPage=function(e){if(e>=1&&e<=this.viewer.pages.length){var t=this.viewer.pages[e-1];this.updateTextPositionForBlockContainer(t.bodyWidgets[0])}},e.prototype.selectTable=function(){this.owner.enableSelection&&this.selectTableInternal()},e.prototype.selectRow=function(){this.owner.enableSelection&&this.selectTableRow()},e.prototype.selectColumn=function(){this.owner.enableSelection&&this.selectColumnInternal()},e.prototype.selectCell=function(){this.owner.enableSelection&&this.selectTableCell()},e.prototype.select=function(e){var t=new T(e.x,e.y),i=this.viewer.findFocusedPage(t,!0);e.extend?this.moveTextPosition(i,this.end):this.viewer.updateTextPositionForSelection(i,1)},e.prototype.toggleBold=function(){this.owner.editorModule&&this.owner.editorModule.toggleBold()},e.prototype.toggleItalic=function(){this.owner.editorModule&&this.owner.editorModule.toggleItalic()},e.prototype.toggleUnderline=function(e){this.owner.editor&&this.owner.editor.toggleUnderline(e)},e.prototype.toggleStrikethrough=function(e){this.owner.editor&&this.owner.editor.toggleStrikethrough(e)},e.prototype.toggleHighlightColor=function(e){this.owner.editor&&this.owner.editor.toggleHighlightColor(e)},e.prototype.toggleSubscript=function(){this.owner.editor&&this.owner.editor.toggleSubscript()},e.prototype.toggleSuperscript=function(){this.owner.editor&&this.owner.editor.toggleSuperscript()},e.prototype.toggleTextAlignment=function(e){this.owner.editor&&this.owner.editor.toggleTextAlignment(e)},e.prototype.increaseIndent=function(){this.owner.editor&&this.owner.editor.increaseIndent()},e.prototype.decreaseIndent=function(){this.owner.editor&&this.owner.editor.decreaseIndent()},e.prototype.navigateHyperlink=function(){var e=this.getHyperlinkField();e&&this.fireRequestNavigate(e)},e.prototype.fireRequestNavigate=function(e){var t=new Ne(e,this),i={isHandled:!1,navigationLink:t.navigationLink,linkType:t.linkType,localReference:t.localReference,source:this.owner};this.owner.trigger("requestNavigate",i),i.isHandled||this.viewer.selection.navigateBookmark(t.localReference,!0)},e.prototype.copyHyperlink=function(){var e=this.getHyperlinkField(),t=this.getLinkText(e);this.copyToClipboard(t)},e.prototype.highlightSelection=function(e){this.owner.enableImageResizerMode&&this.owner.imageResizerModule.hideImageResizer(),this.isEmpty?this.updateCaretPosition():(this.isForward?this.highlightSelectedContent(this.start,this.end):this.highlightSelectedContent(this.end,this.start),this.viewer.isComposingIME&&this.updateCaretPosition()),this.viewer.updateTouchMarkPosition(),e&&this.viewer.scrollToPosition(this.start,this.end)},e.prototype.createHighlightBorder=function(e,t,i,r){t<0&&(t=0);var n=this.getPage(e.paragraph),o=e.height,a=void 0;this.selectedWidgets.containsKey(e)||(a=new Se(i,t),this.selectedWidgets.add(e,a));var s=this.viewer,l=this.getPageTop(n),d=n.boundingRectangle.x;if(s.containerTop<=l||l<s.containerTop+s.selectionCanvas.height){var h=s.zoomFactor;this.clipSelection(n,l),this.viewer.isComposingIME?this.renderDashLine(s.selectionContext,n,e,d+i*h-s.containerLeft,r,t*h,o):(s.selectionContext.fillStyle="gray",s.selectionContext.globalAlpha=.4,s.selectionContext.fillRect(d+i*h-s.containerLeft,l+r*h-s.containerTop,t*h,o*h)),s.selectionContext.restore()}},e.prototype.createHighlightBorderInsideTable=function(e){var t=this.getPage(e),i=void 0,r=e.x-e.margin.left+e.leftBorderWidth,n=e.width+e.margin.left+e.margin.right-e.leftBorderWidth-e.rightBorderWidth,o=e.y,a=e.height,s=this.getPageTop(t),l=t.boundingRectangle.x,d=this.viewer.containerTop<=s||s<this.viewer.containerTop+this.viewer.selectionCanvas.height;if(this.selectedWidgets.containsKey(e)&&(i=this.selectedWidgets.get(e),d&&this.viewer.selectionContext.clearRect(l+i.left*this.viewer.zoomFactor-this.viewer.containerLeft,s+o*this.viewer.zoomFactor-this.viewer.containerTop,i.width*this.viewer.zoomFactor,a*this.viewer.zoomFactor)),i=new Se(r,n),this.selectedWidgets.add(e,i),d){this.viewer.selectionContext.fillStyle="gray",this.viewer.selectionContext.globalAlpha=.4;var h=this.viewer.zoomFactor;this.clipSelection(t,s),this.viewer.selectionContext.fillRect(l+r*h-this.viewer.containerLeft,s+o*h-this.viewer.containerTop,n*h,a*h),this.viewer.selectionContext.restore()}},e.prototype.clipSelection=function(e,t){var i=this.viewer,r=e.boundingRectangle.width*i.zoomFactor,n=e.boundingRectangle.height*i.zoomFactor,o=e.boundingRectangle.x;i.selectionContext.beginPath(),i.selectionContext.save(),i.selectionContext.rect(o-i.containerLeft,t-i.containerTop,r,n),i.selectionContext.clip()},e.prototype.addSelectionHighlight=function(e,t,i){if(this.selectedWidgets.containsKey(t)){var r=t.height,n=this.selectedWidgets.get(t),o=this.viewer.render.getScaledValue(n.width),a=this.viewer.render.getScaledValue(n.left,1),s=this.owner.selection.getPage(t.paragraph);this.owner.selection.clipSelection(s,this.owner.selection.getPageTop(s)),this.viewer.isComposingIME?this.renderDashLine(e,s,t,a,i,o,r):(r=this.viewer.render.getScaledValue(r),e.globalAlpha=.4,e.fillStyle="gray",e.fillRect(a,this.viewer.render.getScaledValue(i,2),o,r)),e.restore()}},e.prototype.renderDashLine=function(e,t,i,r,n,o,a){var s=this.characterFormat.fontColor,l=s?this.viewer.render.getColor(s):"#000000";e.globalAlpha=1;var d=this.owner.editor.copyInsertFormat(new P,!1),h=this.viewer.textHelper.getHeight(d),c=this.getPageTop(t),p=h.Height-h.BaselineOffset;n=this.viewer.render.getUnderlineYPosition(i)+n+4-p,this.viewer.render.renderDashLine(e,r,c-this.viewer.containerTop+n*this.viewer.zoomFactor,o,l,!0)},e.prototype.addSelectionHighlightTable=function(e,t){if(this.selectedWidgets.containsKey(t)){var i=this.selectedWidgets.get(t),r=this.viewer.render.getScaledValue(i.left,1),n=this.viewer.render.getScaledValue(t.y,2),o=this.viewer.render.getScaledValue(i.width),a=this.viewer.render.getScaledValue(t.height);e.fillStyle="gray";var s=this.owner.selection.getPage(t);this.owner.selection.clipSelection(s,this.owner.selection.getPageTop(s)),e.fillRect(r,n,o,a),e.restore()}},e.prototype.removeSelectionHighlight=function(e){var i=0,r=0,n=0,o=0,a=void 0;if(e instanceof J){var s=e,l=s.paragraph;if(a=t.isNullOrUndefined(l)?void 0:this.getPage(s.paragraph),t.isNullOrUndefined(a))return;r=this.getTop(s),o=s.height}else if(e instanceof Y){if(a=t.isNullOrUndefined(e)?void 0:this.getPage(e),t.isNullOrUndefined(a))return;r=e.y,o=e.height}if(!t.isNullOrUndefined(a)){var d=this.selectedWidgets.get(e);n=d.width,i=d.left;var h=a.boundingRectangle,c=this.viewer.pages.indexOf(a),p=this.viewer.pageGap,g=(h.y-p*(c+1))*this.viewer.zoomFactor+p*(c+1),u=h.x,f=this.viewer.zoomFactor;(this.viewer.containerTop<=g||g<this.viewer.containerTop+this.viewer.selectionCanvas.height)&&this.viewer.selectionContext.clearRect(u+i*f-this.viewer.containerLeft-.5,g+r*f-this.viewer.containerTop-.5,n*f+.5,o*f+.5)}},e.prototype.selectCurrentWord=function(){var e=this.start.clone(),t=this.end.clone();this.selectCurrentWordRange(e,t,!1),this.selectRange(e,t)},e.prototype.selectCurrentParagraph=function(){t.isNullOrUndefined(this.start)||(this.start.paragraphStartInternal(this,!1),this.end.moveToParagraphEndInternal(this,!1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.selectCurrentWordRange=function(e,i,r){if(!t.isNullOrUndefined(e)){if(e.offset>0){var n=e.clone(),o=0,a=e.currentWidget.getInline(e.offset,o),s=a.element;o=a.index,!t.isNullOrUndefined(s)&&s instanceof $&&1===s.fieldType?e.offset>2&&(!t.isNullOrUndefined(s.fieldSeparator)||t.isNullOrUndefined(s.fieldBegin))?(n.setPositionParagraph(n.currentWidget,e.offset-2),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset-1||e.moveToWordStartInternal(2)):e.offset>3&&t.isNullOrUndefined(s.fieldSeparator)&&(n.setPositionParagraph(n.currentWidget,e.offset-3),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2)):(n.setPositionParagraph(n.currentWidget,e.offset-1),n.moveToWordEndInternal(0,!1),n.paragraph===e.paragraph&&n.offset===e.offset||e.moveToWordStartInternal(2))}i.moveToWordEndInternal(2,r)}},e.prototype.extendToParagraphStart=function(){t.isNullOrUndefined(this.start)||(this.end.paragraphStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToParagraphEnd=function(){t.isNullOrUndefined(this.start)||(this.end.moveToParagraphEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.moveNextPosition=function(){t.isNullOrUndefined(this.start)||(this.isEmpty&&(this.start.moveNextPosition(),this.end.setPositionInternal(this.start)),this.updateForwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},e.prototype.moveToNextParagraph=function(){t.isNullOrUndefined(this.start)||(this.end.moveToNextParagraphStartInternal(),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.movePreviousPosition=function(){t.isNullOrUndefined(this.start)||(this.isEmpty&&(this.start.movePreviousPosition(),this.end.setPositionInternal(this.start)),this.updateBackwardSelection(),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},e.prototype.moveToPreviousParagraph=function(){t.isNullOrUndefined(this.start)||(this.end.moveToPreviousParagraph(this),this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToPreviousLine=function(){t.isNullOrUndefined(this.start)||(this.end.moveToPreviousLine(this,this.upDownSelectionLength),this.fireSelectionChanged(!0))},e.prototype.extendToLineEnd=function(){t.isNullOrUndefined(this.start)||(this.end.moveToLineEndInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToLineStart=function(){t.isNullOrUndefined(this.start)||(this.end.moveToLineStartInternal(this,!0),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.moveUp=function(){t.isNullOrUndefined(this.start)||(this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.start.location.x),this.upDownSelectionLength=this.start.location.x,this.start.moveUp(this,this.upDownSelectionLength),this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0))},e.prototype.moveDown=function(){t.isNullOrUndefined(this.start)||(this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x),this.start.moveDown(this,this.upDownSelectionLength),this.end.setPositionInternal(this.start),this.fireSelectionChanged(!0))},e.prototype.updateForwardSelection=function(){this.isEmpty||(this.isForward?this.start.setPositionInternal(this.end):this.end.setPositionInternal(this.start))},e.prototype.updateBackwardSelection=function(){this.isEmpty||(this.isForward?this.end.setPositionInternal(this.start):this.start.setPositionInternal(this.end))},e.prototype.getFirstBlockInFirstCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];if(t.childWidgets.length>0){var i=t.childWidgets[0];if(0===i.childWidgets.length)return;return i.childWidgets[0]}}},e.prototype.getFirstCellInRegion=function(e,i,r,n){var o=this.getCellLeft(e,i),a=o+i.cellFormat.cellWidth,s=!0;if(o<=r&&r<a)for(var l=0;l<e.childWidgets.length;l++){var d=this.getCellLeft(e,e.childWidgets[l]);if(W.round(o,2)<=W.round(d,2)&&W.round(d,2)<W.round(a,2))return s=!1,e.childWidgets[l]}else for(var h=0;h<e.childWidgets.length;h++){var c=this.getCellLeft(e,e.childWidgets[h]);if(c<=r&&c+e.childWidgets[h].cellFormat.cellWidth>r)return s=!1,e.childWidgets[h]}if(s){if(!t.isNullOrUndefined(e.previousRenderedWidget)&&n){var p=e.previousRenderedWidget;return this.getFirstCellInRegion(p,i,r,n)}if(!t.isNullOrUndefined(e.nextRenderedWidget)&&!n)return this.getFirstCellInRegion(e.nextRenderedWidget,i,r,n)}return e.childWidgets[0]},e.prototype.getFirstParagraph=function(e){for(;e.previousSplitWidget;)e=e.previousSplitWidget;var t=e.firstChild;return this.getFirstParagraphBlock(t)},e.prototype.getLastBlockInLastCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[e.childWidgets.length-1],i=t.childWidgets[t.childWidgets.length-1];return i.childWidgets[i.childWidgets.length-1]}},e.prototype.moveToLineStart=function(){t.isNullOrUndefined(this.start)||(this.updateBackwardSelection(),this.start.moveToLineStartInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},e.prototype.moveToLineEnd=function(){t.isNullOrUndefined(this.start)||(this.updateForwardSelection(),this.start.moveToLineEndInternal(this,!1),this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0))},e.prototype.getPageTop=function(e){return(e.boundingRectangle.y-this.viewer.pageGap*(this.viewer.pages.indexOf(e)+1))*this.viewer.zoomFactor+this.viewer.pageGap*(this.viewer.pages.indexOf(e)+1)},e.prototype.moveTextPosition=function(e,i){if(!t.isNullOrUndefined(this.start)){var r=this.viewer.getLineWidgetInternal(e,!0);t.isNullOrUndefined(r)||this.updateTextPositionWidget(r,e,i,!0),this.upDownSelectionLength=i.location.x;var n=this.start.getHierarchicalIndexInternal(),o=this.end.getHierarchicalIndexInternal();n!==o&&(Ie.isForwardSelection(n,o)?i.validateForwardFieldSelection(n,o):i.validateBackwardFieldSelection(n,o)),this.fireSelectionChanged(!0)}},e.prototype.getDocumentStart=function(){var e=this.viewer.pages[0].bodyWidgets[0].childWidgets[0];return this.setPositionForBlock(e,!0)},e.prototype.getDocumentEnd=function(){var e=void 0,i=this.owner.documentStart,r=this.viewer.pages[this.viewer.pages.length-1];if(!t.isNullOrUndefined(i)&&r.bodyWidgets[0].childWidgets.length>0){var n=void 0,o=r.bodyWidgets[0].childWidgets,a=o[o.length-1];a instanceof j&&(n=a),e=this.setPositionForBlock(n,!1)}return e},e.prototype.handleControlEndKey=function(){var e=void 0;t.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),t.isNullOrUndefined(e)||this.owner.selection.selectContent(e,!0),this.checkForCursorVisibility()},e.prototype.handleControlHomeKey=function(){var e=void 0;t.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),t.isNullOrUndefined(e)||this.owner.selection.selectContent(e,!0),this.checkForCursorVisibility()},e.prototype.handleControlLeftKey=function(){this.extendToWordStart(!0),this.checkForCursorVisibility()},e.prototype.handleControlRightKey=function(){this.extendToWordEnd(!0),this.checkForCursorVisibility()},e.prototype.handleControlDownKey=function(){this.moveToNextParagraph(),this.checkForCursorVisibility()},e.prototype.handleControlUpKey=function(){this.moveToPreviousParagraph(),this.checkForCursorVisibility()},e.prototype.handleShiftLeftKey=function(){this.extendBackward(),this.checkForCursorVisibility()},e.prototype.handleShiftUpKey=function(){this.extendToPreviousLine(),this.checkForCursorVisibility()},e.prototype.handleShiftRightKey=function(){this.extendForward(),this.checkForCursorVisibility()},e.prototype.handleShiftDownKey=function(){this.extendToNextLine(),this.checkForCursorVisibility()},e.prototype.handleControlShiftLeftKey=function(){this.extendToWordStart(!1),this.checkForCursorVisibility()},e.prototype.handleControlShiftUpKey=function(){this.extendToParagraphStart(),this.checkForCursorVisibility()},e.prototype.handleControlShiftRightKey=function(){this.extendToWordEnd(!1),this.checkForCursorVisibility()},e.prototype.handleControlShiftDownKey=function(){this.extendToParagraphEnd(),this.checkForCursorVisibility()},e.prototype.handleLeftKey=function(){this.movePreviousPosition(),this.checkForCursorVisibility()},e.prototype.handleUpKey=function(){this.isMoveDownOrMoveUp=!0,this.moveUp(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},e.prototype.handleRightKey=function(){this.moveNextPosition(),this.checkForCursorVisibility()},e.prototype.handleEndKey=function(){this.moveToLineEnd(),this.checkForCursorVisibility()},e.prototype.handleHomeKey=function(){this.moveToLineStart(),this.checkForCursorVisibility()},e.prototype.handleDownKey=function(){this.isMoveDownOrMoveUp=!0,this.moveDown(),this.isMoveDownOrMoveUp=!1,this.checkForCursorVisibility()},e.prototype.handleShiftEndKey=function(){this.extendToLineEnd(),this.checkForCursorVisibility()},e.prototype.handleShiftHomeKey=function(){this.extendToLineStart(),this.checkForCursorVisibility()},e.prototype.handleControlShiftEndKey=function(){var e=void 0;t.isNullOrUndefined(this.owner.documentEnd)||(e=this.owner.documentEnd),t.isNullOrUndefined(e)||(this.end.setPosition(e.currentWidget,!1),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},e.prototype.handleControlShiftHomeKey=function(){var e=void 0;t.isNullOrUndefined(this.owner.documentStart)||(e=this.owner.documentStart),t.isNullOrUndefined(e)||(this.end.setPositionInternal(e),this.fireSelectionChanged(!0)),this.checkForCursorVisibility()},e.prototype.handleTabKey=function(e,i){var r=this.start;t.isNullOrUndefined(r)||(r.paragraph.isInsideTable&&this.end.paragraph.isInsideTable&&(e||i)?i?this.selectPreviousCell():this.selectNextCell():!e&&!i||t.isNullOrUndefined(r)||r.offset!==this.getStartOffset(r.paragraph)||t.isNullOrUndefined(r.paragraph.paragraphFormat)||t.isNullOrUndefined(r.paragraph.paragraphFormat.listFormat)||-1===r.paragraph.paragraphFormat.listFormat.listId||this.owner.isReadOnlyMode?this.owner.isReadOnlyMode||this.owner.editorModule.handleTextInput("\t"):this.owner.editorModule.updateListLevel(!i),this.checkForCursorVisibility())},e.prototype.selectPreviousCell=function(){var e=this.start.paragraph.associatedCell,i=e.ownerRow;i.ownerTable;if(t.isNullOrUndefined(e.previousWidget)){if(!t.isNullOrUndefined(i.previousRenderedWidget)){var r=void 0;i.previousRenderedWidget instanceof X&&(r=i.previousRenderedWidget),this.selectTableCellInternal(r.childWidgets[r.childWidgets.length-1],!0)}}else{var n=void 0;e.previousWidget instanceof Y&&(n=e.previousWidget),this.selectTableCellInternal(n,!0)}},e.prototype.selectNextCell=function(){var e=this.start.paragraph.associatedCell,i=e.ownerRow;i.ownerTable;if(t.isNullOrUndefined(e.nextWidget))if(t.isNullOrUndefined(i.nextRenderedWidget)&&!this.owner.isReadOnlyMode)this.owner.editorModule.insertRow(!1);else{var r=void 0;i.nextRenderedWidget instanceof X&&(r=i.nextRenderedWidget),this.selectTableCellInternal(r.childWidgets[0],!0)}else{var n=void 0;e.nextRenderedWidget instanceof Y&&(n=e.nextRenderedWidget),this.selectTableCellInternal(n,!0)}},e.prototype.selectTableCellInternal=function(e,t){var i=this.getFirstParagraph(e),r=this.getLastParagraph(e);if(i===r&&r.isEmpty())this.selectParagraph(r,!0);else{var n=r.childWidgets[0];this.start.setPosition(i.childWidgets[0],!0),this.end.setPositionParagraph(n,n.getEndOffset()),this.fireSelectionChanged(!0)}},e.prototype.selectTableInternal=function(){var e=this.start,i=this.end;if(this.isForward||(e=this.end,i=this.start),!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(this.getTable(e,i))){var r=this.getContainerCellOf(e.paragraph.associatedCell,i.paragraph.associatedCell).ownerTable,n=this.getFirstParagraphBlock(r),o=this.getLastParagraphBlock(r),a=o.lastChild.getEndOffset();this.start.setPosition(n.childWidgets[0],!0),this.end.setPositionParagraph(o.lastChild,a+1)}this.selectPosition(this.start,this.end)},e.prototype.selectColumnInternal=function(){var e=this.start,i=this.end;if(this.isForward||(e=this.end,i=this.start),!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(this.getTable(e,i))){var r=this.getContainerCellOf(e.paragraph.associatedCell,i.paragraph.associatedCell);if(r.ownerTable.contains(i.paragraph.associatedCell)){var n=this.getSelectedCell(e.paragraph.associatedCell,r),o=this.getSelectedCell(i.paragraph.associatedCell,r);if(this.containsCell(r,i.paragraph.associatedCell)){n.ownerRow;var a=r.ownerTable.getColumnCellsForSelection(r,r);if(a.length>0){var s=this.getFirstParagraph(a[0]),l=this.getLastParagraph(a[a.length-1]);this.start.setPosition(s.firstChild,!0);c=l.lastChild;this.end.setPositionParagraph(c,c.getEndOffset()+1)}}else{var d=r.ownerTable.getColumnCellsForSelection(n,n),h=r.ownerTable.getColumnCellsForSelection(o,o);if(d.length>0&&h.length>0){var s=this.getFirstParagraph(d[0]),l=this.getLastParagraph(h[h.length-1]);this.start.setPosition(s.firstChild,!0);var c=l.lastChild;this.end.setPositionParagraph(c,c.getEndOffset()+1)}}}}this.selectPosition(this.start,this.end)},e.prototype.selectTableRow=function(){var e=this.start,i=this.end;if(this.isForward||(e=this.end,i=this.start),!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(this.getTable(e,i))){var r=void 0;if((r=this.getContainerCellOf(e.paragraph.associatedCell,i.paragraph.associatedCell)).ownerTable.contains(i.paragraph.associatedCell)){var n=this.getSelectedCell(e.paragraph.associatedCell,r),o=this.getSelectedCell(i.paragraph.associatedCell,r);if(this.containsCell(r,i.paragraph.associatedCell)){var a=n.ownerRow,s=this.getFirstParagraph(a.childWidgets[0]),l=this.getLastParagraph(a.childWidgets[a.childWidgets.length-1]);this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(l.lastChild,l.lastChild.getEndOffset()+1)}else{var s=this.getFirstParagraph(n.ownerRow.childWidgets[0]),l=void 0;l=this.getLastParagraph(o.ownerRow.childWidgets[o.ownerRow.childWidgets.length-1]),this.start.setPosition(s.firstChild,!0),this.end.setPositionParagraph(l.lastChild,l.lastChild.getEndOffset()+1)}}}this.selectPosition(this.start,this.end)},e.prototype.selectTableCell=function(){var e=this.start,i=this.end;if(this.isForward||(e=this.end,i=this.start),!t.isNullOrUndefined(this.getTable(e,i))){if(this.isEmpty)e.paragraph.isInsideTable&&!t.isNullOrUndefined(e.paragraph.associatedCell)&&((n=this.getFirstParagraph(e.paragraph.associatedCell))===(o=this.getLastParagraph(i.paragraph.associatedCell))?(this.start.setPosition(o.firstChild,!0),this.end.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1)):(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1)));else{var r=this.getContainerCell(e.paragraph.associatedCell);if(this.containsCell(r,e.paragraph.associatedCell)&&this.containsCell(r,i.paragraph.associatedCell)){var n=this.getFirstParagraph(r),o=this.getLastParagraph(r);t.isNullOrUndefined(n)||t.isNullOrUndefined(o)||(this.start.setPosition(n.firstChild,!0),this.end.setPositionParagraph(o.lastChild,o.lastChild.getEndOffset()+1))}}this.selectPosition(this.start,this.end)}},e.prototype.selectAll=function(){var e,i;if(this.owner.enableHeaderAndFooter){var r=this.getContainerWidget(this.start.paragraph);e=this.setPositionForBlock(r.firstChild,!0),i=this.setPositionForBlock(r.lastChild,!1)}else e=this.owner.documentStart,i=this.owner.documentEnd;t.isNullOrUndefined(e)||(this.start.setPositionInternal(e),this.end.setPositionParagraph(i.currentWidget,i.offset+1),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendBackward=function(){t.isNullOrUndefined(this.start)||(this.end.moveBackward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendForward=function(){t.isNullOrUndefined(this.start)||(this.end.moveForward(),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToWordStartEnd=function(){return!(!this.start.paragraph.isInsideTable&&!this.end.paragraph.isInsideTable||this.start.paragraph.associatedCell===this.end.paragraph.associatedCell&&!this.isCellSelected(this.start.paragraph.associatedCell,this.start,this.end))},e.prototype.extendToWordStart=function(e){t.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToPreviousParagraphInTable(this):this.end.moveToWordStartInternal(e?0:1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToWordEnd=function(e){t.isNullOrUndefined(this.start)||(this.extendToWordStartEnd()?this.end.moveToNextParagraphInTable():this.end.moveToWordEndInternal(e?0:1,!1),e&&this.start.setPositionInternal(this.end),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0))},e.prototype.extendToNextLine=function(){t.isNullOrUndefined(this.start)||(this.end.moveToNextLine(this.upDownSelectionLength),this.fireSelectionChanged(!0))},e.prototype.getTextPosition=function(e){var t=new Ie(this.owner);return t.setPositionForCurrentIndex(e),t},e.prototype.getText=function(e){if(!(t.isNullOrUndefined(this.start)||t.isNullOrUndefined(this.end)||t.isNullOrUndefined(this.start.paragraph)||t.isNullOrUndefined(this.end.paragraph))){var i=this.start,r=this.end;return i.isAtSamePosition(r)?"":this.getTextInternal(i,r,e)}},e.prototype.getTextInternal=function(e,i,r){if(e.isExistAfter(i)){var n=i;i=e,e=n}var o=e,a=i;if(!(t.isNullOrUndefined(e)||t.isNullOrUndefined(i)||t.isNullOrUndefined(e.paragraph)||t.isNullOrUndefined(i.paragraph))){var s=0,l=0,d=e.offset,h=i.offset,c=e.currentWidget.getInline(d,s);s=c.index;var p=c.element;if(p instanceof $&&!t.isNullOrUndefined(p.fieldEnd)){var g=this.getRenderedInline(p,s);p=g.element,s=g.index}var u=i.currentWidget.getInline(h,l),f=u.element;l=u.index;var m="";if(p instanceof re&&r&&0===s?m=Z.objectCharacter:p instanceof Q&&(m=t.isNullOrUndefined(p.text)||""===p.text||p.text.length<s?m:p.text.substring(s)),o.paragraph===a.paragraph)p instanceof Z&&(p===f&&p instanceof Q?m=m.length<l-s?m:m.substring(0,l-s):p.nextNode instanceof Z&&(m+=this.getTextInline(p.nextNode,a.paragraph,f,l,r)));else if(p instanceof Z&&p.nextNode instanceof Z)m+=this.getTextInline(p.nextNode,a.paragraph,void 0,0,r);else{var v=this.viewer.selection.getNextParagraphBlock(o.paragraph);for(m+="\r";!t.isNullOrUndefined(v)&&v.isEmpty();){if(m+="\r",v===a.paragraph)return m;v=this.viewer.selection.getNextParagraphBlock(v)}t.isNullOrUndefined(v)||v.isEmpty()||(m+=this.getTextInline(v.childWidgets[0].children[0],a.paragraph,f,l,r))}return h===a.currentWidget.getEndOffset()+1&&(m+="\r"),m}},e.prototype.getListTextElementBox=function(e){if(!t.isNullOrUndefined(e)){var i;if(!e.isEmpty()){var r=e.childWidgets[0];r.children.length>1&&r.children[0]instanceof ne&&(i=r.children[0])}return i}},e.prototype.getTextInline=function(e,i,r,n,o){var a="";do{if(e===r){if(e instanceof Q){var s=e;t.isNullOrUndefined(s.text)||""===s.text||(s.text.length<n?a+=s.text:a+=s.text.substring(0,n))}else e instanceof re&&o&&n===e.length&&(a+=Z.objectCharacter);return a}if(e instanceof Q?a+=e.text:e instanceof re&&o?a+=Z.objectCharacter:e instanceof $&&!t.isNullOrUndefined(e.fieldEnd)&&(e=t.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator),t.isNullOrUndefined(e.nextNode))break;e=e.nextNode}while(!t.isNullOrUndefined(e));if(i===e.line.paragraph)return a;for(var l=this.viewer.selection.getNextParagraphBlock(e.line.paragraph);!t.isNullOrUndefined(l)&&l.isEmpty();){if(a+="\r",l===i)return a;l=this.viewer.selection.getNextParagraphBlock(l)}if(!t.isNullOrUndefined(l)&&!l.isEmpty()){var d=l.childWidgets[0];a=a+"\r"+this.getTextInline(d.children[0],i,r,n,o)}return a},e.prototype.getFieldCode=function(e){var t="";if(!(e.fieldEnd instanceof $))return t;var i=e.paragraph,r=e.fieldEnd.paragraph;e.fieldSeparator instanceof $&&(r=e.fieldSeparator.paragraph);var n=e.line.indexInOwner,o=e.indexInOwner;do{if(t+=this.getFieldCodeInternal(i,n,o),i===r)break;i=this.getNextParagraphBlock(i),n=0,o=0}while(i instanceof G);return t.trim()},e.prototype.getFieldCodeInternal=function(e,t,i){for(var r="",n=t;n<e.childWidgets.length;n++){for(var o=e.childWidgets[n],a=i;a<o.children.length;a++){var s=o.children[a];if(s instanceof Q&&(r+=s.text),s instanceof $&&(2===s.fieldType||1===s.fieldType))return r}i=0}return r},e.prototype.getTocFieldInternal=function(){var e=this.start.paragraph;for(this.isEmpty||this.isForward||(e=this.end.paragraph);e instanceof G&&e.childWidgets.length>0;){var t=e.firstChild;if(t.children.length>0){var i=t.children[0],r=i.nextNode;if(i instanceof $&&0===i.fieldType&&r instanceof Q&&0===r.text.trim().toLowerCase().indexOf("toc"))return i}e=e.previousRenderedWidget}},e.prototype.getNextParagraph=function(e){if(e.nextRenderedWidget instanceof V){var t=e.nextRenderedWidget.childWidgets[0];return this.getFirstParagraphBlock(t)}},e.prototype.getPreviousParagraph=function(e){if(e.previousRenderedWidget instanceof V){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];return this.getLastParagraphBlock(i)}},e.prototype.getFirstParagraphInCell=function(e){var t=e.childWidgets[0];return t instanceof G?t:this.getFirstParagraphInFirstCell(t)},e.prototype.getFirstParagraphInFirstCell=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e.prototype.getLastParagraphInLastCell=function(e){if(e.childWidgets.length>0){var t=e.lastChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getLastParagraphInFirstRow=function(e){if(e.childWidgets.length>0){var t=e.firstChild.lastChild.lastChild;return this.getLastParagraphBlock(t)}},e.prototype.getNextStartInline=function(e,i){var r=0,n=e.getInline(i,r),o=n.element;if(r=n.index,!t.isNullOrUndefined(o)&&r===o.length&&o.nextNode instanceof $){var a=this.getNextValidElement(o.nextNode);a instanceof $&&0===a.fieldType&&(o=a)}return o},e.prototype.getPreviousTextInline=function(e){return e.previousNode instanceof Q?e.previousNode:e.previousNode instanceof $&&W.isLinkedFieldCharacter(e.previousNode)?0===e.previousNode.fieldType||1===e.previousNode.fieldType?e.previousNode:e.previousNode.fieldBegin:t.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextInline(e.previousNode)},e.prototype.getNextTextInline=function(e){return e.nextNode instanceof Q?e.nextNode:e.nextNode instanceof $&&W.isLinkedFieldCharacter(e.nextNode)?1===e.nextNode.fieldType||0===e.nextNode.fieldType?e.nextNode:e.nextNode.fieldEnd:t.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextInline(e.nextNode)},e.prototype.getContainerTable=function(e){if(e.isInsideTable&&(e=e.associatedCell.ownerTable.isInsideTable?this.getContainerTable(e.associatedCell.ownerTable):e.associatedCell.ownerTable),e instanceof K)return e},e.prototype.isExistBefore=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)<i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex<r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex<r.ownerRow.rowIndex;var n=this.getContainerCellOf(i,r);return n.ownerTable.contains(r)?(i=this.getSelectedCell(i,n),r=this.getSelectedCell(r,n),i===n?this.isExistBefore(e,r.ownerTable):r===n?this.isExistBefore(i.ownerTable,t):n.ownerRow===r.ownerRow?n.cellIndex<r.cellIndex:n.ownerTable===r.ownerTable?n.ownerRow.rowIndex<r.ownerRow.rowIndex:this.isExistBefore(i.ownerTable,r.ownerTable)):this.isExistBefore(n.ownerTable,this.getContainerTable(r.ownerTable))}o=this.getContainerTable(e);return this.isExistBefore(o,t)}if(t.isInsideTable){var o=this.getContainerTable(t);return this.isExistBefore(e,o)}return e.containerWidget===t.containerWidget?e.index<t.index:e.containerWidget instanceof V&&t.containerWidget instanceof V&&this.viewer.pages.indexOf(e.containerWidget.page)<this.viewer.pages.indexOf(t.containerWidget.page)},e.prototype.isExistAfter=function(e,t){if(e.isInsideTable){var i=e.associatedCell;if(t.isInsideTable){var r=t.associatedCell;if(i===r)return i.childWidgets.indexOf(e)>i.childWidgets.indexOf(t);if(i.ownerRow===r.ownerRow)return i.cellIndex>r.cellIndex;if(i.ownerTable===r.ownerTable)return i.ownerRow.rowIndex>r.ownerRow.rowIndex;var n=this.getContainerCellOf(i,r);return n.ownerTable.contains(r)?(i=this.getSelectedCell(i,n),r=this.getSelectedCell(r,n),i===n?this.isExistAfter(e,r.ownerTable):r===n?this.isExistAfter(i.ownerTable,t):n.ownerRow===r.ownerRow?n.cellIndex>r.cellIndex:n.ownerTable===r.ownerTable?n.ownerRow.rowIndex>r.ownerRow.rowIndex:this.isExistAfter(i.ownerTable,r.ownerTable)):this.isExistAfter(n.ownerTable,this.getContainerTable(r.ownerTable))}o=this.getContainerTable(e);return this.isExistAfter(o,t)}if(t.isInsideTable){var o=this.getContainerTable(t);return this.isExistAfter(e,o)}return e.containerWidget===t.containerWidget?e.index>t.index:e.containerWidget instanceof V&&t.containerWidget instanceof V&&this.viewer.pages.indexOf(e.containerWidget.page)>this.viewer.pages.indexOf(t.containerWidget.page)},e.prototype.isExistBeforeInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)<t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)<t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,r=t.line.paragraph;if(i.containerWidget===r.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)<r.associatedCell.childWidgets.indexOf(r);if(!(i.containerWidget instanceof q))return i.containerWidget.childWidgets.indexOf(i)<r.containerWidget.childWidgets.indexOf(r)}return this.isExistBefore(i,r)},e.prototype.isExistAfterInline=function(e,t){if(e.line===t.line)return e.line.children.indexOf(e)>t.line.children.indexOf(t);if(e.line.paragraph===t.line.paragraph)return e.line.paragraph.childWidgets.indexOf(e.line)>t.line.paragraph.childWidgets.indexOf(t.line);var i=e.line.paragraph,r=t.line.paragraph;if(i.containerWidget===r.containerWidget){if(i.isInsideTable)return i.associatedCell.childWidgets.indexOf(i)>r.associatedCell.childWidgets.indexOf(r);if(!(i.containerWidget instanceof q))return i.containerWidget.childWidgets.indexOf(i)>r.containerWidget.childWidgets.indexOf(r)}return this.isExistAfter(i,r)},e.prototype.getNextRenderedBlock=function(e){return t.isNullOrUndefined(e.nextWidget)?e.nextRenderedWidget:e.nextWidget},e.prototype.getPreviousRenderedBlock=function(e){return t.isNullOrUndefined(e.previousWidget)?e.previousRenderedWidget:e.previousWidget},e.prototype.getNextParagraphBlock=function(e){if(e.nextRenderedWidget instanceof G)return e.nextRenderedWidget;if(e.nextRenderedWidget instanceof K)return this.getFirstParagraphInFirstCell(e.nextRenderedWidget);if(e.containerWidget instanceof Y)return this.getNextParagraphCell(e.containerWidget);if(e.containerWidget instanceof V){e.containerWidget;return this.getNextParagraph(e.containerWidget)}return e.containerWidget instanceof q&&this.isMoveDownOrMoveUp?this.getFirstBlockInNextHeaderFooter(e):void 0},e.prototype.getFirstBlockInNextHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Header"))t=i.page.footerWidget.firstChild;else{if(!i.page.nextPage)return;t=i.page.nextPage.headerWidget.firstChild}return t instanceof G?t:this.getFirstBlockInFirstCell(t)},e.prototype.getLastBlockInPreviousHeaderFooter=function(e){var t,i=e.containerWidget;if(-1!==i.headerFooterType.indexOf("Footer"))t=i.page.headerWidget.lastChild;else{if(!i.page.previousPage)return;t=i.page.previousPage.footerWidget.lastChild}return t instanceof G?t:this.getFirstBlockInFirstCell(t)},e.prototype.getPreviousParagraphBlock=function(e){return e.previousRenderedWidget instanceof G?e.previousRenderedWidget:e.previousRenderedWidget instanceof K?this.getLastParagraphInLastCell(e.previousRenderedWidget):e.containerWidget instanceof Y?this.getPreviousParagraphCell(e.containerWidget):e.containerWidget instanceof V?this.getPreviousParagraph(e.containerWidget):e.containerWidget instanceof q&&this.isMoveDownOrMoveUp?this.getLastBlockInPreviousHeaderFooter(e):void 0},e.prototype.getFirstParagraphBlock=function(e){return e instanceof G?e:e instanceof K?this.getFirstParagraphInFirstCell(e):void 0},e.prototype.getLastParagraphBlock=function(e){return e instanceof G?e:e instanceof K?this.getLastParagraphInLastCell(e):void 0},e.prototype.hasValidInline=function(e,t,i){for(var r=e.childWidgets.indexOf(t.line);r<e.childWidgets.length;r++)for(var n=0;n<e.childWidgets[r].children.length;n++){var o=e.childWidgets[r].children[n];if(0!==o.length){if(o===i)return!1;if(o instanceof Q||o instanceof re||o instanceof $&&W.isLinkedFieldCharacter(o))return!0}}return!1},e.prototype.getParagraphLength=function(e,t,i){for(var r=0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(t instanceof J&&t===o){i&&(r+=this.getLineLength(o,i));break}r+=this.getLineLength(o)}return r},e.prototype.getLineLength=function(e,t){for(var i=0,r=0;r<e.children.length;r++){var n=e.children[r];if(!(n instanceof ne)){if(t&&t.element instanceof Z&&t.element===n){i+=t.index;break}i+=n.length}}return i},e.prototype.getLineInfo=function(e,t){for(var i=void 0,r=0,n=e.childWidgets.length,o=0;o<n&&(i=e.childWidgets[o],r=this.getLineLength(i),!(t<=r||o===n-1));o++)t-=r;return{line:i,offset:t}},e.prototype.getElementInfo=function(e,i){for(var r=void 0,n=0;n<e.children.length;n++)if(!((r=e.children[n])instanceof ne)){if(!(i>r.length)||i===r.length+1&&t.isNullOrUndefined(r.nextNode))break;i-=r.length}return{element:r,index:i}},e.prototype.getStartOffset=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[0];return this.getStartLineOffset(t)}return 0},e.prototype.getStartLineOffset=function(e){for(var t=0,i=0;i<e.children.length;i++){var r=e.children[i];if(0!==r.length){if(r instanceof Q||r instanceof re||r instanceof ie||r instanceof $&&W.isLinkedFieldCharacter(r))return t;r instanceof ne||(t+=r.length)}}return t},e.prototype.getPreviousSelectionCell=function(e){if(!t.isNullOrUndefined(e.previousRenderedWidget)){if(this.isForward){var i=e.previousRenderedWidget.childWidgets,r=i[i.length-1];return r instanceof G?r:this.getPreviousParagraphSelection(r.childWidgets[r.childWidgets.length-1])}return(r=e.previousRenderedWidget.childWidgets[0])instanceof G?r:this.getFirstParagraphInLastRow(r)}return this.getPreviousSelectionRow(e.ownerRow)},e.prototype.getPreviousSelectionRow=function(e){if(!t.isNullOrUndefined(e.previousRenderedWidget)){if(this.isForward)return this.getPreviousParagraphSelection(e.previousRenderedWidget);var i=e.previousRenderedWidget.childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(i)}return this.getPreviousSelectionBlock(e.ownerTable)},e.prototype.getNextSelectionBlock=function(e){return e.nextRenderedWidget instanceof G?e.nextRenderedWidget:e.nextRenderedWidget instanceof K?this.isEmpty||this.isForward?this.getLastParagraphInFirstRow(e.nextRenderedWidget):this.getNextParagraphSelection(e.nextRenderedWidget.childWidgets[0]):e.containerWidget instanceof Y?this.getNextSelectionCell(e.containerWidget):e.containerWidget instanceof V?this.getNextSelection(e.containerWidget):void 0},e.prototype.getNextSelectionCell=function(e){if(!t.isNullOrUndefined(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var i=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1];return this.getLastParagraphBlock(i)}return(i=e.nextRenderedWidget.childWidgets[0])instanceof G?i:this.getNextParagraphSelection(i.childWidgets[0])}return this.getNextSelectionRow(e.ownerRow)},e.prototype.getNextSelectionRow=function(e){if(!t.isNullOrUndefined(e.nextRenderedWidget)){if(this.isEmpty||this.isForward){var i=e.nextRenderedWidget.childWidgets[e.nextRenderedWidget.childWidgets.length-1],r=i.childWidgets[i.childWidgets.length-1];return this.getLastParagraphBlock(r)}return this.getNextParagraphSelection(e.nextRenderedWidget)}return this.getNextSelectionBlock(e.ownerTable)},e.prototype.getNextSelection=function(e){if(e.nextRenderedWidget instanceof V){var t=e.nextRenderedWidget.childWidgets[0];return t instanceof G?t:this.isEmpty||this.isForward?this.getLastParagraphInFirstRow(t):this.getNextParagraphSelection(t.childWidgets[0])}},e.prototype.getNextParagraphSelection=function(e){var t=e.childWidgets[0];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getFirstCellInRegion(e,i,this.upDownSelectionLength,!1)}var r=t.childWidgets[0];return this.getFirstParagraphBlock(r)},e.prototype.getPreviousSelectionBlock=function(e){return e.previousRenderedWidget instanceof G?e.previousRenderedWidget:e.previousRenderedWidget instanceof K?this.isForward?this.getPreviousParagraphSelection(e.previousRenderedWidget.childWidgets[e.previousRenderedWidget.childWidgets.length-1]):this.getFirstParagraphInLastRow(e.previousRenderedWidget):e.containerWidget instanceof Y?this.getPreviousSelectionCell(e.containerWidget):e.containerWidget instanceof V?this.getPreviousSelection(e.containerWidget):void 0},e.prototype.getPreviousSelection=function(e){if(e.previousRenderedWidget instanceof V){var t=e.previousRenderedWidget,i=t.childWidgets[t.childWidgets.length-1];if(i instanceof G)return i;if(this.isForward){var r=i;return this.getPreviousParagraphSelection(r.childWidgets[r.childWidgets.length-1])}return this.getFirstParagraphInLastRow(i)}},e.prototype.getPreviousParagraphSelection=function(e){var t=e.childWidgets[e.childWidgets.length-1];if(this.start.paragraph.isInsideTable&&e.ownerTable.contains(this.start.paragraph.associatedCell)){var i=this.getCellInTable(e.ownerTable,this.start.paragraph.associatedCell);t=this.getLastCellInRegion(e,i,this.upDownSelectionLength,!0)}var r=t.childWidgets[t.childWidgets.length-1];return this.getLastParagraphBlock(r)},e.prototype.getLastCellInRegion=function(e,i,r,n){var o=this.getCellLeft(e,i),a=o+i.cellFormat.cellWidth,s=!0;if(o<=r&&r<a)for(d=e.childWidgets.length-1;d>=0;d--){var l=this.getCellLeft(e,e.childWidgets[d]);if(W.round(o,2)<=W.round(l,2)&&W.round(l,2)<W.round(a,2))return s=!1,e.childWidgets[d]}else for(var d=e.childWidgets.length-1;d>=0;d--)if((l=this.getCellLeft(e,e.childWidgets[d]))<=r&&l+e.childWidgets[d].cellFormat.cellWidth>r)return s=!1,e.childWidgets[d];if(s){if(!t.isNullOrUndefined(e.previousRenderedWidget)&&n)return this.getLastCellInRegion(e.previousRenderedWidget,i,r,n);if(!t.isNullOrUndefined(e.nextRenderedWidget)&&!n)return this.getLastCellInRegion(e.nextRenderedWidget,i,r,n)}return e.childWidgets[e.childWidgets.length-1]},e.prototype.getCellInTable=function(e,t){for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable))return t;t=t.ownerTable.associatedCell}return t},e.prototype.getFirstParagraphInLastRow=function(e){if(e.childWidgets.length>0){var t=e.childWidgets[e.childWidgets.length-1].childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(t)}},e.prototype.getPreviousValidOffset=function(e,t){if(0===t)return 0;for(var i=0,r=0,n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],a=0;a<o.children.length;a++){var s=o.children[a];if(0!==s.length){if(t<=r+s.length)return t-1===r?i:t-1;(s instanceof Q||s instanceof re||s instanceof $&&W.isLinkedFieldCharacter(s))&&(i=r+s.length),r+=s.length}}return t-1===r?i:t-1},e.prototype.getNextValidOffset=function(e,t){for(var i=0,r=0;r<e.children.length;r++){var n=e.children[r];if(!(0===n.length||n instanceof ne)){if(t<i+n.length&&(n instanceof Q||n instanceof re||n instanceof $&&W.isLinkedFieldCharacter(n)))return(t>i?t:i)+1;i+=n.length}}return t},e.prototype.getParagraphMarkSize=function(e,t,i){var r=this.viewer.textHelper.getParagraphMarkSize(e.characterFormat),n=r.BaselineOffset,o=r.Height,a=n;if(e instanceof G){if(e.childWidgets.length>0)e.childWidgets[0];var s=this.viewer.layout.getLineSpacing(e,o),l=this.viewer.layout.getBeforeSpacing(e);t=a-n,i=o-a-(r.Height-n);var d=e.paragraphFormat.lineSpacingType;"Multiple"===d?s>o?i+=s-o:t+=s-o:"Exactly"===d?t+=s-(t+r.Height+i):s>t+r.Height+i&&(t+=s-(t+r.Height+i)),t+=l,i+=e.paragraphFormat.afterSpacing}return{width:r.Width,height:r.Height,topMargin:t,bottomMargin:i}},e.prototype.getPhysicalPositionInternal=function(e,t,i){if(e.paragraph.isEmpty()){var r=e.paragraph,n=r.x;if(r.childWidgets.length>0){var o=r.childWidgets[0];n=this.getLeft(o)}var a=this.getParagraphMarkSize(e.paragraph,0,0);return t>0&&(n+=a.width),new T(n,r.y+0)}var s=0,l=e.getInline(t,s),d=l.element;return s=l.index,this.getPhysicalPositionInline(d,s,i)},e.prototype.highlightSelectedContent=function(e,i){if(!e.paragraph.isInsideTable||i.paragraph.isInsideTable&&e.paragraph.associatedCell.equals(i.paragraph.associatedCell)&&!this.isCellSelected(e.paragraph.associatedCell,e,i)){var r=void 0,n=0;if(!this.owner.isReadOnlyMode&&e.paragraph===i.paragraph)if(e.offset+1===i.offset){var o=i.currentWidget.getInline(i.offset,n);r=o.element,n=o.index,r instanceof re&&e.currentWidget.getOffset(r,0)!==e.offset&&(r=void 0)}else{var a=0,s=e.currentWidget.getInline(e.offset,a),l=s.element;(a=s.index)===l.length&&(l=this.getNextRenderedElementBox(l,a));var d=i.currentWidget.getInline(i.offset,a),h=d.element;if(a=d.index,l instanceof $&&h instanceof $&&!t.isNullOrUndefined(l.fieldSeparator)){var c=l.fieldSeparator.nextNode;c instanceof re&&c.nextNode===h&&(r=c)}}if(!this.owner.isReadOnlyMode&&r instanceof re&&this.owner.isDocumentLoaded){var p=this.getElementBoxInternal(r,n),g=p.element;n=p.index,this.owner.enableImageResizerMode&&(this.owner.imageResizerModule.positionImageResizer(g),this.owner.imageResizerModule.showImageResizer()),this.viewer.isTouchInput&&(this.viewer.touchStart.style.display="none",this.viewer.touchEnd.style.display="none")}else this.highlight(e.paragraph,e,i)}else this.highlightCell(e.paragraph.associatedCell,this,e,i)},e.prototype.highlight=function(e,i,r){var n=0,o=0,a=void 0,s=void 0,l=void 0,d=void 0,h=this.getStartLineWidget(e,i,a,n);a=h.element,l=t.isNullOrUndefined(a)?e.childWidgets[0]:a.line,n=h.index;var c=this.getEndLineWidget(r,s,o);d=(s=c.element)?s.line:r.paragraph.childWidgets[r.paragraph.childWidgets.length-1],o=c.index;var p=0,g=0;if(t.isNullOrUndefined(l)||(p=this.getTop(l),g=this.getLeftInternal(l,a,n)),t.isNullOrUndefined(l)||l!==d){if(!t.isNullOrUndefined(l)){var u=l.paragraph.x;this.createHighlightBorder(l,this.getWidth(l,!0)-(g-u),g,p);var f=l.paragraph.childWidgets.indexOf(l);if(this.highlightParagraph(e,f+1,d,s,o),-1!==e.childWidgets.indexOf(r.currentWidget))return}this.highlightNextBlock(e,i,r)}else{var m=this.getLeftInternal(d,s,o);this.createHighlightBorder(l,m-g,g,p)}},e.prototype.highlightNextBlock=function(e,i,r){var n=e.nextRenderedWidget;t.isNullOrUndefined(n)||(n instanceof G?this.highlight(n,i,r):this.highlightTable(n,i,r))},e.prototype.getStartLineWidget=function(e,t,i,r){var n=e===t.paragraph?t.offset:this.getStartOffset(e),o=void 0;if(o=e===t.paragraph?t.currentWidget.getInline(n,r):e.firstChild.getInline(n,r),i=o.element,r=o.index,i instanceof $){var a=this.getRenderedInline(i,r);i=a.element,r=a.index}return n===this.getParagraphLength(t.paragraph)+1&&r++,{index:r,element:i}},e.prototype.getEndLineWidget=function(e,t,i){var r=e.currentWidget.getInline(e.offset,i);if(t=r.element,i=r.index,t instanceof $){var n=this.getRenderedInline(t,i);t=n.element,i=n.index}return e.paragraph.childWidgets.indexOf(e.currentWidget)===e.paragraph.childWidgets.length-1&&e.offset===this.getLineLength(e.currentWidget)+1&&(i=t?t.length+1:1),{index:i,element:t}},e.prototype.getLineWidgetInternal=function(e,t,i){var r=void 0;if(0===e.children.length&&e instanceof J)r=e;else{var n=0,o=e.getInline(t,n),a=o.element;n=o.index,r=a instanceof Z?a.line:this.getLineWidgetInternalInline(a,n,i)}return r},e.prototype.getLineWidgetParagraph=function(e,t){var i=void 0;if(0===t.children.length)i=t;else{var r=0,n=t.getInline(e,r),o=n.element;r=n.index,i=this.getLineWidget(o,r)}return i},e.prototype.highlightCells=function(e,t,i){var r=this.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),a=o+i.cellFormat.cellWidth;r>o&&(r=o),n<a&&(n=a),r>this.upDownSelectionLength&&(r=this.upDownSelectionLength),n<this.upDownSelectionLength&&(n=this.upDownSelectionLength);var s=e.getSplitWidgets(),l=s.indexOf(t.ownerRow.ownerTable),d=s.indexOf(i.ownerRow.ownerTable);if(l===d)for(var h=e.childWidgets.indexOf(i.ownerRow),c=e.childWidgets.indexOf(t.ownerRow);c<=h;c++)this.highlightRow(e.childWidgets[c],r,n);else for(var p=0,g=0,c=l;c<=d;c++){e=s[c],p=c===l?e.childWidgets.indexOf(t.ownerRow):0,g=c===d?e.childWidgets.indexOf(i.ownerRow):e.childWidgets.length-1;for(var u=p;u<=g;u++)this.highlightRow(e.childWidgets[u],r,n)}},e.prototype.highlightTable=function(e,t,i){this.highlightInternal(e.childWidgets[0],t,i),i.paragraph.isInsideTable&&e.contains(i.paragraph.associatedCell)||this.highlightNextBlock(e,t,i)},e.prototype.getCellLeft=function(e,t){var i=0;return i+=t.x-t.margin.left},e.prototype.getNextParagraphRow=function(e){if(!t.isNullOrUndefined(e.nextRenderedWidget)){var i=e.nextRenderedWidget.childWidgets[0].childWidgets[0];return this.getFirstParagraphBlock(i)}return this.getNextParagraphBlock(e.ownerTable)},e.prototype.getPreviousParagraphRow=function(e){if(!t.isNullOrUndefined(e.previousRenderedWidget)){var i=e.previousRenderedWidget.lastChild,r=i.lastChild?i.lastChild:i.previousSplitWidget.lastChild;return this.getLastParagraphBlock(r)}return this.getPreviousParagraphBlock(e.ownerTable)},e.prototype.containsRow=function(e,t){if(-1!==e.childWidgets.indexOf(t))return!0;for(;t.ownerTable.isInsideTable;){if(-1!==e.childWidgets.indexOf(t))return!0;t=t.ownerTable.associatedCell}return-1!==e.childWidgets.indexOf(t)},e.prototype.highlightRow=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){var n=this.getCellLeft(e,e.childWidgets[r]);W.round(t,2)<=W.round(n,2)&&W.round(n,2)<W.round(i,2)&&this.highlightCellWidget(e.childWidgets[r])}},e.prototype.highlightInternal=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.highlightCellWidget(e.childWidgets[r]);i.paragraph.isInsideTable&&this.containsRow(e,i.paragraph.associatedCell)||e.nextRenderedWidget instanceof X&&this.highlightInternal(e.nextRenderedWidget,t,i)},e.prototype.getLastParagraph=function(e){for(;e.nextSplitWidget&&e.nextSplitWidget.childWidgets.length>0;)e=e.nextSplitWidget;var t;return t=e.childWidgets.length>0?e.lastChild:e.previousSplitWidget.lastChild,this.getLastParagraphBlock(t)},e.prototype.containsCell=function(e,t){if(e.equals(t))return!0;for(;t.ownerTable.isInsideTable;){if(e.equals(t.ownerTable.associatedCell))return!0;t=t.ownerTable.associatedCell}return!1},e.prototype.isCellSelected=function(e,t,i){var r=this.getLastParagraph(e);return r===i.paragraph&&i.offset===this.getParagraphLength(r)+1||!this.containsCell(e,t.paragraph.associatedCell)||!this.containsCell(e,i.paragraph.associatedCell)},e.prototype.getContainerCellOf=function(e,t){for(;e.ownerTable.isInsideTable;){if(e.ownerTable.contains(t))return e;e=e.ownerTable.associatedCell}return e},e.prototype.getSelectedCell=function(e,t){if(e.ownerTable.equals(t.ownerTable))return e;for(;e.ownerTable.isInsideTable;){if(e.ownerTable.associatedCell.equals(t))return e;e=e.ownerTable.associatedCell}return e},e.prototype.getSelectedCells=function(){for(var e=[],t=0;t<this.selectedWidgets.keys.length;t++){var i=this.selectedWidgets.keys[t];i instanceof Y&&e.push(i)}return e},e.prototype.getNextParagraphCell=function(e){if(e.nextRenderedWidget&&e.nextRenderedWidget instanceof Y){var t=(e=e.nextRenderedWidget).firstChild;return t?this.getFirstParagraphBlock(t):this.getNextParagraphCell(e)}return this.getNextParagraphRow(e.containerWidget)},e.prototype.getPreviousParagraphCell=function(e){if(!t.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof Y){var i=(e=e.previousRenderedWidget).lastChild;return this.getLastParagraphBlock(i)}return this.getPreviousParagraphRow(e.ownerRow)},e.prototype.getContainerCell=function(e){for(;!t.isNullOrUndefined(e.ownerTable)&&e.ownerTable.isInsideTable;)e=e.ownerTable.associatedCell;return e},e.prototype.highlightCell=function(e,i,r,n){if(n.paragraph.isInsideTable){var o=this.getContainerCellOf(e,n.paragraph.associatedCell);if(o.ownerTable.contains(n.paragraph.associatedCell)){var a=this.getSelectedCell(e,o),s=this.getSelectedCell(n.paragraph.associatedCell,o);if(this.containsCell(o,n.paragraph.associatedCell))this.isCellSelected(o,r,n)?this.highlightCellWidget(o):a===o?this.highlight(r.paragraph,r,n):this.highlightContainer(a,r,n);else if(this.highlightCellWidget(o),o.ownerRow.equals(s.ownerRow))for(a=o;!t.isNullOrUndefined(a.nextRenderedWidget)&&(a=a.nextRenderedWidget,this.highlightCellWidget(a),a!==s););else this.highlightCells(o.ownerTable,o,s)}else this.highlightContainer(o,r,n)}else{var l=this.getContainerCell(e);this.highlightContainer(l,r,n)}},e.prototype.highlightContainer=function(e,t,i){this.highlightInternal(e.containerWidget,t,i),this.highlightNextBlock(e.ownerTable,t,i)},e.prototype.getPreviousValidElement=function(e){for(var i=void 0;e instanceof $;)W.isLinkedFieldCharacter(e)&&(e instanceof $&&0===e.fieldType?i=e:e instanceof $&&1===e.fieldType?(i=e,t.isNullOrUndefined(e.fieldSeparator)&&(i=e=e.fieldBegin)):i=e=e.fieldBegin),e=e.previousNode;return t.isNullOrUndefined(i)?e:i},e.prototype.getNextValidElement=function(e){for(var i=void 0;e instanceof $;){if(0===e.fieldType&&!t.isNullOrUndefined(e.fieldEnd))return t.isNullOrUndefined(i)?e:i;1!==e.fieldType||t.isNullOrUndefined(e.fieldBegin)||(i=e),e=e.nextNode}return t.isNullOrUndefined(i)?e:i},e.prototype.validateTextPosition=function(e,t){if(e.length===t&&e.nextNode instanceof $){var i=this.getNextValidElement(e.nextNode);i instanceof $&&1===i.fieldType&&(e=i,t=1)}else 0===t&&e.previousNode instanceof $&&(t=(e=this.getPreviousValidElement(e.previousNode))instanceof $?0:e.length,e instanceof $&&1===e.fieldType&&t++);return{element:e,index:t}},e.prototype.getPhysicalPositionInline=function(e,i,r){var n=void 0;n=this.getElementBox(e,i,r).element;var o=void 0;if(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.line))return e instanceof $||e instanceof ie?this.getFieldCharacterPosition(e):new T(0,0);var a=n.margin,s=0,l=0;if(n instanceof Q&&"\v"===n.text&&t.isNullOrUndefined(e.nextNode)?(o=this.getNextLineWidget(n.line.paragraph,n),i=0):o=n.line,s=this.getTop(o),n instanceof re){var d=n.line.paragraph.characterFormat,h=this.getPreviousTextElement(e);if(t.isNullOrUndefined(h)){var c=this.getNextTextElement(e);t.isNullOrUndefined(c)||(d=c.characterFormat)}else d=h.characterFormat;var p=this.viewer.textHelper.getHeight(d);n.margin.top+n.height-p.BaselineOffset>0&&(s+=n.margin.top+n.height-p.BaselineOffset)}else n instanceof $||(s+=a.top>0?a.top:0);return l=t.isNullOrUndefined(n)||t.isNullOrUndefined(o)?0:this.getLeftInternal(o,n,i),new T(l,s)},e.prototype.getFieldCharacterPosition=function(e){var i=this.getNextValidElementForField(e);if(t.isNullOrUndefined(i)){var r=e.line.paragraph;return this.getEndPosition(r)}return this.getPhysicalPositionInline(i,0,!0)},e.prototype.getNextValidElementForField=function(e){if(e instanceof $&&0===e.fieldType&&W.isLinkedFieldCharacter(e)){var i=e;e=t.isNullOrUndefined(i.fieldSeparator)?i.fieldEnd:i.fieldSeparator}var r=void 0;return t.isNullOrUndefined(e.nextNode)||(r=this.getNextValidElement(e.nextNode)),r},e.prototype.getEndPosition=function(e){var i=e.x,r=e.y,n=void 0;e.childWidgets.length>0&&(n=e.childWidgets[e.childWidgets.length-1],i+=this.getWidth(n,!1)),t.isNullOrUndefined(n)||(r=this.getTop(n));var o=this.getParagraphMarkSize(e,0,0);return new T(i,r+o.topMargin)},e.prototype.getElementBox=function(e,t,i){var r=void 0;return e instanceof $||e instanceof ie||(r=e),{element:r,index:t}},e.prototype.getPreviousTextElement=function(e){return e.previousNode instanceof Q?e.previousNode:t.isNullOrUndefined(e.previousNode)?void 0:this.getPreviousTextElement(e.previousNode)},e.prototype.getNextTextElement=function(e){return e.nextNode instanceof Q?e.nextNode:t.isNullOrUndefined(e.nextNode)?void 0:this.getNextTextElement(e.nextNode)},e.prototype.getNextRenderedElementBox=function(e,i){if(e instanceof $){if(0===(n=e).fieldType&&(e=this.getRenderedField(n),n===e))return n;i=1}for(;!t.isNullOrUndefined(e)&&i===e.length&&e.nextNode instanceof $;){var r=this.getNextValidElement(e.nextNode);if(r instanceof $&&0===r.fieldType){var n=r;if(e=this.getRenderedField(n),!t.isNullOrUndefined(e)&&n===e)return n;i=1}else e=r}return e},e.prototype.getElementBoxInternal=function(e,t){var i=void 0;return i=e,{element:i,index:t}},e.prototype.getLineWidget=function(e,t){return this.getLineWidgetInternalInline(e,t,!0)},e.prototype.getLineWidgetInternalInline=function(e,i,r){var n=this.getElementBox(e,i,r),o=n.element;if(i=n.index,!t.isNullOrUndefined(o))return r&&o instanceof Q&&"\v"===o.text&&1===i?this.getNextLineWidget(o.line.paragraph,o):o.line;var a=e,s=this.getNextValidElementForField(a);if(t.isNullOrUndefined(s)){var l=void 0,d=a.line.paragraph;return d.childWidgets.length>0&&(l=d.childWidgets[d.childWidgets.length-1]),l}return this.getLineWidget(s,0)},e.prototype.getNextLineWidget=function(e,t){var i=void 0,r=e;if(r.childWidgets.length>0){var n=r.childWidgets.indexOf(t.line);n===r.childWidgets.length-1?(r=e,n=-1):n>r.childWidgets.length-1?(r=this.getNextParagraphBlock(e),n=-1):n<0&&(n=(r=e).childWidgets.indexOf(t.line)),i=r.childWidgets[n+1]}return i},e.prototype.getCaretHeight=function(e,i,r,n,o,a){var s=this.getElementBox(e,i,!1).element,l=e;if(t.isNullOrUndefined(s))return l instanceof $?this.getFieldCharacterHeight(l,r,n,o,a):{height:this.viewer.textHelper.getHeight(r).Height,topMargin:o,isItalic:a};var d=s.margin,h=s.height,c=0;if(s instanceof re){var p=this.getPreviousTextElement(e),g=this.getNextTextElement(e);if(t.isNullOrUndefined(p)&&t.isNullOrUndefined(g)){var u=0,f=0,m=e.line.paragraph,v=this.getParagraphMarkSize(m,u,f);u=v.topMargin,f=v.bottomMargin,c=v.height,a=m.characterFormat.italic,n||(c+=m.paragraphFormat.afterSpacing)}else{if(t.isNullOrUndefined(p))return a=g.characterFormat.italic,this.getCaretHeight(g,0,g.characterFormat,n,o,a);if(t.isNullOrUndefined(g)||!(s instanceof re))return a=p.characterFormat.italic,this.getCaretHeight(p,p.length,p.characterFormat,n,o,a);var y=this.viewer.textHelper.getHeight(s.characterFormat),w=y.Height,b=y.BaselineOffset;c=s.margin.top<0&&b>s.margin.top+s.height?s.margin.top+s.height+w-b:w,n||(c+=s.margin.bottom)}}else{var x=r.baselineAlignment,C=h;"Normal"!==x&&n&&(C/=1.5,"Subscript"===x&&(o=h-C)),c=(d.top<0?d.top:0)+C,n||(c+=d.bottom)}if(!n)return{height:c,topMargin:o,isItalic:a};var F=this.viewer.textHelper.getHeight(r).Height;return F>c&&(F=c),{height:F,topMargin:o,isItalic:a}},e.prototype.getFieldCharacterHeight=function(e,i,r,n,o){var a=this.getNextValidElementForField(e);if(t.isNullOrUndefined(a)){var s=e.line.paragraph,l=this.viewer.textHelper.getParagraphMarkSize(i).Height,d=0,h=0,c=this.getParagraphMarkSize(s,d,h),p=c.height;return d=c.topMargin,h=c.bottomMargin,r?(l>p&&(l=p),{height:l,topMargin:n,isItalic:o}):(p+=h,{height:p,topMargin:n,isItalic:o})}return this.getCaretHeight(a,0,i,r,n,o)},e.prototype.getRenderedInline=function(e,i){for(var r=this.getPreviousValidElement(e);r instanceof $;)(r=this.getPreviousTextElement(r))instanceof $&&(r=r.previousNode);if(!t.isNullOrUndefined(r))return i=r.length,{element:r,index:i};i=0;var n=this.getNextRenderedElementBox(e,0);if(n instanceof $&&0===n.fieldType)for(n=(n=n.fieldSeparator).nextNode;n instanceof $;)n instanceof $&&0===n.fieldType&&W.isLinkedFieldCharacter(n)&&(n=t.isNullOrUndefined(n.fieldSeparator)?n.fieldEnd:n.fieldSeparator),n=n.nextNode;return{element:n,index:i}},e.prototype.getRenderedField=function(e){var i=e;if(t.isNullOrUndefined(e.fieldSeparator))i=e.fieldEnd;else{var r=(i=e.fieldSeparator).line.paragraph;if(r!==e.fieldEnd.line.paragraph||this.hasValidInline(r,i,e.fieldEnd))return i;i=e.fieldEnd}return i},e.prototype.isLastRenderedInline=function(e,i){for(;i===e.length&&e.nextNode instanceof $;){var r=this.getNextValidElement(e.nextNode);if(i=0,r instanceof $&&0===r.fieldType&&(e=r),e instanceof $&&0===e.fieldType&&!t.isNullOrUndefined(e.fieldEnd)){var n=e;if(t.isNullOrUndefined(n.fieldSeparator))e=n.fieldEnd,i=1;else{var o=(e=n.fieldSeparator).line.paragraph;if(i=1,o!==n.fieldEnd.line.paragraph||this.hasValidInline(o,e,n.fieldEnd))break;e=n.fieldEnd}}}return i===e.length&&t.isNullOrUndefined(e.nextNode)},e.prototype.getPage=function(e){var i=void 0;if(e.containerWidget instanceof _){e.containerWidget;i=e.containerWidget.page}else t.isNullOrUndefined(e.containerWidget)||(i=this.getPage(e.containerWidget));return i},e.prototype.clearSelectionHighlightInSelectedWidgets=function(){for(var e=!1,t=this.selectedWidgets.keys,i=0;i<t.length;i++)this.removeSelectionHighlight(t[i]),e=!0;return this.selectedWidgets.clear(),e},e.prototype.clearChildSelectionHighlight=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t]instanceof J?this.clearSelectionHighlightLineWidget(e.childWidgets[t]):e.childWidgets[t]instanceof Y?this.clearSelectionHighlight(e.childWidgets[t]):e.childWidgets[t]instanceof z&&this.clearChildSelectionHighlight(e.childWidgets[t])},e.prototype.getLineWidgetBodyWidget=function(e,i){for(var r=0;r<e.childWidgets.length;r++)if((a=e.childWidgets[r])instanceof z&&a.y<=i.y&&a.y+a.height>=i.y)return a instanceof G?this.getLineWidgetParaWidget(a,i):this.getLineWidgetTableWidget(a,i);var n=void 0;if(e.childWidgets.length>0){var o=e.childWidgets[0];if(o instanceof z&&o.y<=i.y)n=e.childWidgets[e.childWidgets.length-1]instanceof G?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],i):this.getLineWidgetTableWidget(e.childWidgets[e.childWidgets.length-1],i);else{var a=void 0;o instanceof z&&(a=o),t.isNullOrUndefined(a)||(n=a instanceof G?this.getLineWidgetParaWidget(o,i):this.getLineWidgetTableWidget(o,i))}}return n},e.prototype.getLineWidgetParaWidget=function(e,t){for(var i=e.childWidgets,r=e.y,n=0;n<i.length;n++){if(r<=t.y&&r+i[n].height>=t.y)return i[n];r+=i[n].height}var o=void 0;return i.length>0&&(o=e.y<=t.y?i[i.length-1]:i[0]),o},e.prototype.highlightParagraph=function(e,t,i,r,n){for(var o=0,a=t;a<e.childWidgets.length;a++){var s=e.childWidgets[a];a===t&&(o=this.getTop(s));var l=this.getLeft(s);if(s===i){var d=this.getLeftInternal(i,r,n);return void this.createHighlightBorder(s,d-l,l,o)}this.createHighlightBorder(s,this.getWidth(s,!0)-(l-e.x),l,o),o+=s.height}},e.prototype.getLineWidgetTableWidget=function(e,i){for(var r=void 0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(o instanceof X&&o.y<=i.y){r=this.getLineWidgetRowWidget(o,i);var a=void 0;!t.isNullOrUndefined(r)&&r.paragraph.containerWidget instanceof Y&&(a=r.paragraph.containerWidget);var s=0,l=0;if(!t.isNullOrUndefined(a)){u=a.ownerRow.containerWidget;s=W.convertPointToPixel(u.tableFormat.cellSpacing),l=a.cellFormat.rowSpan}var d=0,h=0,c=0,p=0;if(s>0){d=0===a.cellIndex?s:s/2,h=a.cellIndex===a.ownerRow.childWidgets.length-1?s:s/2;var g=void 0;a.containerWidget instanceof X&&(g=a.containerWidget);var u=void 0;a.containerWidget.containerWidget instanceof K&&(u=a.containerWidget.containerWidget),t.isNullOrUndefined(g)||t.isNullOrUndefined(u)||(c=0===a.ownerRow.rowIndex?s:s/2,p=a.ownerRow.rowIndex+l===a.ownerTable.childWidgets.length?s:s/2)}if(!t.isNullOrUndefined(r)&&r.paragraph.x<=i.x&&r.paragraph.x+r.width>=i.x&&r.paragraph.y<=i.y&&this.getTop(r)+r.height>=i.y||!t.isNullOrUndefined(a)&&a.x-a.margin.left-d<=i.x&&a.x+a.width+a.margin.right+h>=i.x&&a.y-a.margin.top-c<=i.y&&a.y+a.height+a.margin.bottom+p>=i.y)break}}return r},e.prototype.getLineWidgetRowWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++){var r=0,n=0,o=0;if((r=W.convertPointToPixel(e.ownerTable.tableFormat.cellSpacing))>0&&(n=0===e.childWidgets[i].columnIndex?r:r/2,o=e.childWidgets[i].cellIndex===e.childWidgets[i].ownerRow.childWidgets.length-1?r:r/2),e.childWidgets[i].x-e.childWidgets[i].margin.left-n<=t.x&&e.childWidgets[i].x+e.childWidgets[i].width+e.childWidgets[i].margin.right+o>=t.x)return this.getLineWidgetCellWidget(e.childWidgets[i],t)}var a=void 0;return e.childWidgets.length>0&&(a=e.childWidgets[0].x<=t.x?this.getLineWidgetCellWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetCellWidget(e.childWidgets[0],t)),a},e.prototype.getFirstBlock=function(e){if(e.childWidgets.length>0)return e.childWidgets[0]},e.prototype.highlightCellWidget=function(e){var t=[];e.previousSplitWidget||e.nextSplitWidget?t=e.getSplitWidgets():t.push(e);for(var i=0;i<t.length;i++)e=t[i],this.clearChildSelectionHighlight(e),this.createHighlightBorderInsideTable(e)},e.prototype.clearSelectionHighlight=function(e){this.selectedWidgets.containsKey(e)&&(this.removeSelectionHighlight(e),this.selectedWidgets.remove(e))},e.prototype.getLineWidgetCellWidget=function(e,t){for(var i=0;i<e.childWidgets.length;i++)if(e.childWidgets[i].y<=t.y&&e.childWidgets[i].y+e.childWidgets[i].height>=t.y)return e.childWidgets[i]instanceof G?this.getLineWidgetParaWidget(e.childWidgets[i],t):this.getLineWidgetTableWidget(e.childWidgets[i],t);var r=void 0;return e.childWidgets.length>0&&e.childWidgets[0].y<=t.y&&(r=e.childWidgets[e.childWidgets.length-1]instanceof G?this.getLineWidgetParaWidget(e.childWidgets[e.childWidgets.length-1],t):this.getLineWidgetTableWidget(e.childWidgets[0],t)),r},e.prototype.updateTextPosition=function(e,i){var r=i,n=void 0,o=0,a=!1,s=this.updateTextPositionIn(e,n,o,i,!1);t.isNullOrUndefined(s)||(n=s.element,o=s.index,r=s.caretPosition,a=s.isImageSelected,this.isImageSelected=a),a?(this.selectInternal(e,n,o,r),0===o?this.extendForward():this.extendBackward()):this.selectInternal(e,n,o,r)},e.prototype.updateTextPositionIn=function(e,i,r,n,o){var a=!1,s=this.getTop(e),l=e.paragraph.x,d=this.getFirstElement(e,l),h=d.element;if(l=d.left,t.isNullOrUndefined(h)){var c=0,p=0,g=this.getParagraphMarkSize(e.paragraph,c,p);c=g.topMargin,p=g.bottomMargin,(W=!(this.viewer.mouseDownOffset.y>=s&&this.viewer.mouseDownOffset.y<s+e.height)||this.viewer.mouseDownOffset.x<l+g.width)&&o&&n.x>l+g.width/2&&(l+=g.width,e.children.length>0&&(r=(i=e.children[e.children.length-1]).length),r++),n=new T(l,c>0?s+c:s)}else if(!t.isNullOrUndefined(h)){if(n.x>l+h.margin.left){for(v=e.children.indexOf(h);v<e.children.length&&(h=e.children[v],!(n.x<l+h.margin.left+h.width||v===e.children.length-1));v++)l+=h.margin.left+h.width;if(n.x>l+h.margin.left+h.width)r=h instanceof Q?h.length:1,l+=h.margin.left+h.width;else if(h instanceof Q){var u=n.x-l-h.margin.left;l+=h.margin.left;for(var f=0,m=0,v=1;v<=h.length;v++){P=0;if(P=v===h.length?h.width:this.viewer.textHelper.getWidth(h.text.substr(0,v),h.characterFormat),u<P||v===h.length){if(u-f>(P-f)/2)l+=P,m=v;else if(l+=f,m=v-1,1===v&&h!==e.children[0]){y=e.children.indexOf(h);e.children[y-1]instanceof ne||(m=(h=e.children[y-1])instanceof Q?h.length:1)}break}f=P}r=m}else if(a=h instanceof re,n.x-l-h.margin.left>h.width/2)r=1,l+=h.margin.left+h.width;else if(h!==e.children[0]&&!a){var y=e.children.indexOf(h);e.children[y-1]instanceof ne||(r=(h=e.children[y-1])instanceof Q?h.length:1)}h instanceof Q&&"\v"===h.text&&(r=0)}else l+=h.margin.left;if(h instanceof Q)s+=h.margin.top>0?h.margin.top:0;else{var w=this.viewer.textHelper.getHeight(h.characterFormat),b=h.height;h instanceof ie&&!this.viewer.layout.hasValidElement(h.line.paragraph)&&(b=w.Height),s+=h.margin.top+b-w.BaselineOffset}i=h;var x=this.validateTextPosition(i,r);i=x.element,r=x.index;var C=t.isNullOrUndefined(i.nextNode)&&r===i.length,F=t.isNullOrUndefined(i.nextNode)&&i instanceof Q&&"\v"===i.text;if(o&&i.nextNode instanceof $&&r===i.length&&(C=this.isLastRenderedInline(i,r)),o&&C||F){var P=0;if(C){P=this.viewer.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);var W=!(this.viewer.mouseDownOffset.y>=s&&this.viewer.mouseDownOffset.y<s+e.height)||this.viewer.mouseDownOffset.x<l+P;W&&n.x>l+P/2&&(l+=P,r=i.length+1)}else F&&(l+=P=h.width,r=i.length)}n=new T(l,s)}return{element:i,index:r,caretPosition:n,isImageSelected:a}},e.prototype.getLeft=function(e){var t=e.paragraph.x,i=e.paragraph.paragraphFormat;this.isParagraphFirstLine(e)&&"Right"!==i.textAlignment&&(t+=W.convertPointToPixel(i.firstLineIndent));for(var r=0;r<e.children.length;r++){var n=e.children[r];if(!(n instanceof ne)){t+=n.margin.left;break}t+=0===r?n.margin.left+n.width:n.width}return t},e.prototype.getTop=function(e){for(var t=e.paragraph.y,i=e.paragraph.childWidgets.indexOf(e),r=0;r<i;r++)t+=e.paragraph.childWidgets[r].height;return t},e.prototype.getFirstElement=function(e,t){var i=0;this.isParagraphFirstLine(e)&&(i=W.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),t+=i;for(var r=void 0,n=0;n<e.children.length&&(r=e.children[n])instanceof ne;n++)t+=r.margin.left+r.width,r=void 0;return{element:r,left:t}},e.prototype.getIndexInInline=function(e){var t=0;if(e instanceof Q)for(var i=e.line.children.indexOf(e),r=0;r<i;r++){var n=e.line.children[r];n instanceof $||n instanceof ne||(t+=n.length)}return t},e.prototype.isParagraphFirstLine=function(e){return!(!t.isNullOrUndefined(e.paragraph.previousSplitWidget)||e!==e.paragraph.firstChild)},e.prototype.isParagraphLastLine=function(e){return!(!t.isNullOrUndefined(e.paragraph.nextSplitWidget)||e!==e.paragraph.lastChild)},e.prototype.getWidth=function(e,i){var r=0;this.isParagraphFirstLine(e)&&(r+=W.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent));for(var n=0;n<e.children.length;n++)r+=e.children[n].margin.left+e.children[n].width;return i&&e.paragraph.childWidgets.indexOf(e)===e.paragraph.childWidgets.length-1&&t.isNullOrUndefined(e.paragraph.nextSplitWidget)&&(r+=this.viewer.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat)),r},e.prototype.getLeftInternal=function(e,i,r){var n=e.paragraph.x;this.isParagraphFirstLine(e)&&(n+=W.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent));var o=e.children.indexOf(i);(1===e.children.length&&e.children[0]instanceof ne||2===e.children.length&&e.children[0]instanceof ne&&e.children[1]instanceof ne)&&(o=e.children.length);for(var a=0;a<o;a++){e.children[a];1===a&&e.children[a]instanceof ne?n+=e.children[a].width:n+=e.children[a].margin.left+e.children[a].width}if(t.isNullOrUndefined(i)||(n+=i.margin.left),i instanceof Q)r===i.length?n+=i.width:r>i.length?n+=i.width+this.viewer.textHelper.getParagraphMarkWidth(i.line.paragraph.characterFormat):n+=this.viewer.textHelper.getWidth(i.text.substr(0,r),i.characterFormat);else if(r>0)if(t.isNullOrUndefined(i)||i instanceof ne)n+=this.viewer.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);else if(n+=i.width,2===r){var s=i.line.paragraph;n+=this.viewer.textHelper.getParagraphMarkWidth(s.characterFormat)}return n},e.prototype.getLineStartLeft=function(e){var t=e.paragraph.x;return this.isParagraphFirstLine(e)&&(t+=W.convertPointToPixel(e.paragraph.paragraphFormat.firstLineIndent)),e.children.length>0&&(t+=e.children[0].margin.left),t},e.prototype.updateTextPositionWidget=function(e,t,i,r){var n,o=t,a=void 0,s=0;a=(n=this.updateTextPositionIn(e,a,s,o,r)).element,s=n.index,o=n.caretPosition,i.setPositionForSelection(e,a,s,o)},e.prototype.clearSelectionHighlightLineWidget=function(e){!t.isNullOrUndefined(this.owner)&&this.selectedWidgets.length>0&&this.clearSelectionHighlight(this)},e.prototype.getFirstElementInternal=function(e){for(var t=void 0,i=0;i<e.children.length&&(t=e.children[i])instanceof ne;i++)t=void 0;return t},e.prototype.selectRange=function(e,t){this.start.setPositionInternal(e),this.end.setPositionInternal(t),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},e.prototype.selectParagraph=function(e,t){var i=e.firstChild;if(t)this.start.setPosition(i,t);else{var r=i.getEndOffset();this.start.setPositionParagraph(i,r)}this.end.setPositionInternal(this.start),this.upDownSelectionLength=this.start.location.x,this.fireSelectionChanged(!0)},e.prototype.setPositionForBlock=function(e,t){var i;if(e instanceof K&&(e=t?this.getFirstParagraphInFirstCell(e):this.getLastParagraphInLastCell(e)),e instanceof G)if(i=new Ie(this.owner),t)i.setPosition(e.firstChild,!0);else{var r=e.lastChild;i.setPositionParagraph(r,r.getEndOffset())}return i},e.prototype.selectContent=function(e,i){if(t.isNullOrUndefined(e))throw new Error("textPosition is undefined.");this.start.setPositionInternal(e),this.end.setPositionInternal(e),this.upDownSelectionLength=this.end.location.x,this.fireSelectionChanged(!0)},e.prototype.selectInternal=function(e,t,i,r){this.start.setPositionForSelection(e,t,i,r),this.end.setPositionInternal(this.start),this.upDownSelectionLength=r.x,this.fireSelectionChanged(!0)},e.prototype.selects=function(e,t,i){this.viewer.clearSelectionHighlight(),this.start.setPositionForLineWidget(e,t),this.end.setPositionInternal(this.start),i||this.fireSelectionChanged(!0)},e.prototype.selectPosition=function(e,i){if(t.isNullOrUndefined(e)||t.isNullOrUndefined(i))throw new Error("TextPosition cannot be undefined");if(t.isNullOrUndefined(e.paragraph)||e.offset>this.getParagraphLength(e.paragraph)+1)throw new Error("Start TextPosition is not valid.");if(t.isNullOrUndefined(i.paragraph)||i.offset>this.getParagraphLength(i.paragraph)+1)throw new Error("End TextPosition is not valid.");e.isAtSamePosition(i)?this.selectRange(e,e):(e.isExistBefore(i)?i.validateForwardFieldSelection(e.getHierarchicalIndexInternal(),i.getHierarchicalIndexInternal()):e.validateForwardFieldSelection(i.getHierarchicalIndexInternal(),e.getHierarchicalIndexInternal()),this.selectRange(e,i))},e.prototype.fireSelectionChanged=function(e){this.isEmpty||(this.isForward?(this.start.updatePhysicalPosition(!0),this.end.updatePhysicalPosition(!1)):(this.start.updatePhysicalPosition(!1),this.end.updatePhysicalPosition(!0))),this.skipFormatRetrieval||this.retrieveCurrentFormatProperties(),this.viewer.clearSelectionHighlight(),this.hideToolTip(),this.owner.isLayoutEnabled&&!this.owner.isShiftingEnabled&&this.highlightSelection(!0),e&&(this.start.paragraph.isInHeaderFooter&&!this.owner.enableHeaderAndFooter?this.owner.enableHeaderAndFooter=!0:!this.start.paragraph.isInHeaderFooter&&this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1),this.owner.fireSelectionChange()),this.viewer.updateFocus()},e.prototype.retrieveCurrentFormatProperties=function(){this.isRetrieveFormatting=!0;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start),this.retrieveImageFormat(e,t),this.retrieveCharacterFormat(e,t),this.retrieveParagraphFormat(e,t),this.retrieveSectionFormat(e,t),this.retrieveTableFormat(e,t),this.isImageSelected||this.imageFormat.clearImageFormat(),this.isRetrieveFormatting=!1,this.setCurrentContextType()},e.prototype.retrieveImageFormat=function(e,t){var i;if(e.currentWidget===t.currentWidget&&e.offset+1===t.offset){var r=t.currentWidget.getInline(t.offset,0);i=r.element;r.index;i instanceof re&&e.currentWidget.getOffset(i,0)!==e.offset&&(i=void 0)}i instanceof re?this.imageFormat.copyImageFormat(i):this.imageFormat.clearImageFormat()},e.prototype.setCurrentContextType=function(){var e=!!this.imageFormat.image,i=!t.isNullOrUndefined(this.tableFormat)&&!t.isNullOrUndefined(this.tableFormat.table),r=this.start.paragraph.paragraphFormat.baseStyle;if(r instanceof N&&0===r.name.toLowerCase().indexOf("toc")){var n=this.getTocFieldInternal();if(!t.isNullOrUndefined(n))return void(this.contextTypeInternal="TableOfContents")}if(this.start.paragraph.isInHeaderFooter){var o=-1!==this.start.paragraph.bodyWidget.headerFooterType.indexOf("Header");this.contextTypeInternal=i?e?o?"HeaderTableImage":"FooterTableImage":o?"HeaderTableText":"FooterTableText":e?o?"HeaderImage":"FooterImage":o?"HeaderText":"FooterText"}else this.contextTypeInternal=i?e?"TableImage":"TableText":e?"Image":"Text"},e.prototype.retrieveTableFormat=function(e,i){var r=this.getTable(e,i);t.isNullOrUndefined(r)?this.tableFormat.clearFormat():(this.tableFormat.copyFormat(r.tableFormat),this.tableFormat.table=r,this.retrieveCellFormat(e,i),this.retrieveRowFormat(e,i))},e.prototype.retrieveCellFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.cellFormat.copyFormat(e.paragraph.associatedCell.cellFormat),this.getCellFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.cellFormat.clearCellFormat()},e.prototype.retrieveRowFormat=function(e,t){e.paragraph.isInsideTable&&t.paragraph.isInsideTable?(this.rowFormat.copyFormat(e.paragraph.associatedCell.ownerRow.rowFormat),this.getRowFormat(e.paragraph.associatedCell.ownerTable,e,t)):this.rowFormat.clearRowFormat()},e.prototype.getCellFormat=function(e,t,i){if(!t.paragraph.associatedCell.equals(i.paragraph.associatedCell))for(var r=!1,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(o===t.paragraph.associatedCell.ownerRow&&(r=!0),r)for(var a=0;a<o.childWidgets.length;a++){var s=o.childWidgets[a];if(this.isCellSelected(s,t,i)&&this.cellFormat.combineFormat(s.cellFormat),s===i.paragraph.associatedCell)return void this.cellFormat.combineFormat(s.cellFormat)}}},e.prototype.getRowFormat=function(e,t,i){var r=t.paragraph.associatedCell.ownerRow;if(r!==i.paragraph.associatedCell.ownerRow)for(var n=e.childWidgets.indexOf(r)+1;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(this.rowFormat.combineFormat(o.rowFormat),o===i.paragraph.associatedCell.ownerRow)return}},e.prototype.getTable=function(e,i){if(!t.isNullOrUndefined(e.paragraph.associatedCell)&&!t.isNullOrUndefined(i.paragraph.associatedCell)){var r=e.paragraph.associatedCell.ownerTable,n=e.paragraph.associatedCell.ownerTable;if(r===n)return r;if(r.contains(e.paragraph.associatedCell))return r;if(n.contains(e.paragraph.associatedCell))return n;if(!r.isInsideTable||!n.isInsideTable)return;do{if((r=r.associatedCell.ownerTable)===n||r.contains(n.associatedCell))return r;if(n.contains(r.associatedCell))return n}while(!t.isNullOrUndefined(r.associatedCell))}},e.prototype.getContainerWidget=function(e){var t;if(e.containerWidget instanceof _)t=e.containerWidget;else for(t=e.containerWidget;!(t instanceof _);)t=t.containerWidget;return t},e.prototype.retrieveSectionFormat=function(e,i){var r=this.getContainerWidget(e.paragraph),n=this.getContainerWidget(i.paragraph);if(!t.isNullOrUndefined(r)){this.sectionFormat.copyFormat(r.sectionFormat);for(var o=this.viewer.pages.indexOf(r.page),a=this.viewer.pages.indexOf(n.page),s=o+1;s<=a;s++)this.sectionFormat.combineFormat(this.viewer.pages[s].bodyWidgets[0].sectionFormat)}},e.prototype.retrieveParagraphFormat=function(e,t){this.getParagraphFormatForSelection(e.paragraph,this,e,t)},e.prototype.getParagraphFormatForSelection=function(e,t,i,r){!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!this.isCellSelected(i.paragraph.associatedCell,i,r)?this.getParagraphFormatInternalInParagraph(e,i,r):this.getParagraphFormatInternalInCell(i.paragraph.associatedCell,i,r)},e.prototype.getParagraphFormatInternalInParagraph=function(e,i,r){if(i.paragraph===e?this.paragraphFormat.copyFormat(e.paragraphFormat):this.paragraphFormat.combineFormat(e.paragraphFormat),r.paragraph!==e){var n=this.getNextRenderedBlock(e);t.isNullOrUndefined(n)||this.getParagraphFormatInternalInBlock(n,i,r)}},e.prototype.getParagraphFormatInternalInBlock=function(e,t,i){e instanceof G?this.getParagraphFormatInternalInParagraph(e,t,i):this.getParagraphFormatInternalInTable(e,t,i)},e.prototype.getParagraphFormatInternalInTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getParagraphFormatInCell(n.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var a=this.getNextRenderedBlock(e);this.getParagraphFormatInternalInBlock(a,t,i)},e.prototype.getParagraphFormatInCell=function(e){for(var t=0;t<e.childWidgets.length;t++)this.getParagraphFormatInBlock(e.childWidgets[t])},e.prototype.getParagraphFormatInBlock=function(e){e instanceof G?this.getParagraphFormatInParagraph(e):this.getParagraphFormatInTable(e)},e.prototype.getParagraphFormatInTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++)this.getParagraphFormatInCell(i.childWidgets[r])},e.prototype.getParagraphFormatInParagraph=function(e){this.paragraphFormat.combineFormat(e.paragraphFormat)},e.prototype.getParagraphFormatInternalInCell=function(e,t,i){if(i.paragraph.isInsideTable){var r=this.getContainerCellOf(e,i.paragraph.associatedCell);if(r.ownerTable.contains(i.paragraph.associatedCell)){var n=this.getSelectedCell(e,r),o=this.getSelectedCell(i.paragraph.associatedCell,r);this.containsCell(r,i.paragraph.associatedCell)?this.isCellSelected(r,t,i)?this.getParagraphFormatInCell(r):n===r?this.getParagraphFormatInternalInParagraph(t.paragraph,t,i):this.getParagraphFormatInRow(n.ownerRow,t,i):this.getParaFormatForCell(r.ownerTable,r,o)}else this.getParagraphFormatInRow(r.ownerRow,t,i)}else{var a=this.getContainerCell(e);this.getParagraphFormatInRow(a.ownerRow,t,i)}},e.prototype.getParaFormatForCell=function(e,t,i){var r=this.getCellLeft(t.ownerRow,t),n=r+t.cellFormat.cellWidth,o=this.getCellLeft(i.ownerRow,i),a=o+i.cellFormat.cellWidth;r>o&&(r=o),n<a&&(n=a),r>this.upDownSelectionLength&&(r=this.upDownSelectionLength),r<this.upDownSelectionLength&&(r=this.upDownSelectionLength);for(var s=e.childWidgets.indexOf(i.ownerRow),l=e.childWidgets.indexOf(t.ownerRow);l<=s;l++)for(var d=e.childWidgets[l],h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h],p=this.getCellLeft(d,c);W.round(r,2)<=W.round(p,2)&&W.round(p,2)<W.round(n,2)&&this.getParagraphFormatInCell(c)}},e.prototype.getParagraphFormatInRow=function(e,t,i){for(var r=e.rowIndex;r<e.ownerTable.childWidgets.length;r++){for(var n=e.ownerTable.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getParagraphFormatInCell(n.childWidgets[o]);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var a=this.getNextRenderedBlock(e.ownerTable);this.getParagraphFormatInternalInBlock(a,t,i)},e.prototype.retrieveCharacterFormat=function(e,i){if(this.characterFormat.copyFormat(e.paragraph.characterFormat),e.paragraph!==i.paragraph||!e.currentWidget.isLastLine()||e.offset!==this.getLineLength(e.currentWidget)||e.offset+1!==i.offset){var r=e.paragraph;for(e.offset!==this.getParagraphLength(r)||this.isEmpty||(r=this.getNextParagraphBlock(r));!t.isNullOrUndefined(r)&&r!==i.paragraph&&r.isEmpty();)r=this.getNextParagraphBlock(r);var n=r===e.paragraph?e.offset:0;if(!t.isNullOrUndefined(r)&&!r.isEmpty()){var o=new Ie(this.owner),a=e.currentWidget.getInline(n,0),s=this.getPhysicalPositionInternal(e.currentWidget,n,!0);o.setPositionForSelection(e.currentWidget,a.element,a.index,s),this.getCharacterFormatForSelection(r,this,o,i)}}},e.prototype.getCharacterFormatForSelection=function(e,t,i,r){i.paragraph instanceof G&&i.paragraph.isInsideTable&&(!r.paragraph.isInsideTable||i.paragraph.associatedCell!==r.paragraph.associatedCell||this.isCellSelected(i.paragraph.associatedCell,i,r))?this.getCharacterFormatInTableCell(i.paragraph.associatedCell,t,i,r):this.getCharacterFormat(e,i,r)},e.prototype.getCharacterFormatForTableRow=function(e,t,i){for(var r=e.rowIndex;r<e.ownerTable.childWidgets.length;r++){for(var n=e.ownerTable.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(n.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var a=this.getNextRenderedBlock(e.ownerTable);this.getCharacterFormatForBlock(a,t,i)},e.prototype.getCharacterFormatInTableCell=function(e,t,i,r){if(r.paragraph.isInsideTable){var n=this.getContainerCellOf(e,r.paragraph.associatedCell);if(n.ownerTable.contains(r.paragraph.associatedCell)){var o=this.getSelectedCell(e,n),a=this.getSelectedCell(r.paragraph.associatedCell,n);this.containsCell(n,r.paragraph.associatedCell)?this.isCellSelected(n,i,r)?this.getCharacterFormatForSelectionCell(n,i,r):o===n?this.getCharacterFormat(i.paragraph,i,r):this.getCharacterFormatForTableRow(o.ownerRow,i,r):this.getCharacterFormatInternalInTable(n.ownerTable,n,a,i,r)}else this.getCharacterFormatForTableRow(n.ownerRow,i,r)}else{var s=this.getContainerCell(e);this.getCharacterFormatForTableRow(s.ownerRow,i,r)}},e.prototype.getCharacterFormatInternalInTable=function(e,t,i,r,n){var o=this.getCellLeft(t.ownerRow,t),a=o+t.cellFormat.cellWidth,s=this.getCellLeft(i.ownerRow,i),l=s+i.cellFormat.cellWidth;o>s&&(o=s),a<l&&(a=l),o>this.upDownSelectionLength&&(o=this.upDownSelectionLength),a<this.upDownSelectionLength&&(a=this.upDownSelectionLength);for(var d=e.childWidgets.indexOf(i.ownerRow),h=e.childWidgets.indexOf(t.ownerRow);h<=d;h++)for(var c=e.childWidgets[h],p=0;p<c.childWidgets.length;p++){var g=c.childWidgets[p],u=this.getCellLeft(c,g);W.round(o,2)<=W.round(u,2)&&W.round(u,2)<W.round(a,2)&&this.getCharacterFormatForSelectionCell(g,r,n)}},e.prototype.getCharacterFormat=function(e,i,r){if(e!==i.paragraph&&e!==r.paragraph)return void this.getCharacterFormatInternal(e,this);if(r.paragraph!==e||i.paragraph===e||0!==r.offset){var n=0,o=this.getParagraphLength(e);if(e!==i.paragraph||(n=i.offset,!this.setCharacterFormat(e,i,r,o))){var a=-1!==e.childWidgets.indexOf(i.currentWidget)?e.childWidgets.indexOf(i.currentWidget):0,s=-1!==e.childWidgets.indexOf(r.currentWidget)?e.childWidgets.indexOf(r.currentWidget):e.childWidgets.length-1,l=r.offset;e!==r.paragraph&&(l=o);for(var d=!1,h=a;h<=s;h++){var c=e.childWidgets[h];h!==a&&(n=this.getStartLineOffset(c)),l=c===r.currentWidget?r.offset:this.getLineLength(c);for(var p=0,g=0;g<c.children.length;g++){var u=c.children[g];if(n>=p+u.length)p+=u.length;else{if(u instanceof $&&0===u.fieldType&&W.isLinkedFieldCharacter(u)){var f=t.isNullOrUndefined(u.fieldSeparator)?u.fieldEnd:u.fieldSeparator;do{p+=u.length,u=u.nextNode,h++}while(!t.isNullOrUndefined(u)&&u!==f);d=!0}if(u instanceof $&&1===u.fieldType&&W.isLinkedFieldCharacter(u)&&d){var m=u.fieldBegin;do{this.characterFormat.combineFormat(m.characterFormat),m=m.nextNode}while(!(m instanceof $))}if(u instanceof Q&&this.characterFormat.combineFormat(u.characterFormat),t.isNullOrUndefined(u)||l<=p+u.length)break;p+=u.length}}}if(r.paragraph!==e){var v=this.getNextRenderedBlock(e);t.isNullOrUndefined(v)||this.getCharacterFormatForBlock(v,i,r)}}}},e.prototype.setCharacterFormat=function(e,i,r,n){var o=0,a=i.offset,s=i.currentWidget.getInline(a,o);o=s.index;var l=s.element;if(t.isNullOrUndefined(l)){i.paragraph.childWidgets.indexOf(i.currentWidget);if(i.currentWidget.previousLine)return l=i.currentWidget.previousLine.children[i.currentWidget.previousLine.children.length-1],this.characterFormat.copyFormat(l.characterFormat),!0}if(a<n){if(this.isEmpty){if(l instanceof Q||l instanceof $&&(0===l.fieldType||1===l.fieldType)){var d=this.getPreviousTextElement(l);0===a&&d&&(l=d),this.characterFormat.copyFormat(l.characterFormat)}else t.isNullOrUndefined(this.getPreviousTextElement(l))?t.isNullOrUndefined(this.getNextTextElement(l))?this.characterFormat.copyFormat(e.characterFormat):this.characterFormat.copyFormat(this.getNextTextElement(l).characterFormat):this.characterFormat.copyFormat(this.getPreviousTextElement(l).characterFormat);return!0}o!==l.length||t.isNullOrUndefined(l.nextNode)?l instanceof Q?this.characterFormat.copyFormat(l.characterFormat):l instanceof $&&this.characterFormat.copyFormat(this.getNextValidCharacterFormatOfField(l)):this.characterFormat.copyFormat(this.getNextValidCharacterFormat(l))}else if(n===r.offset)return l instanceof Q||l instanceof $?this.characterFormat.copyFormat(l.characterFormat):t.isNullOrUndefined(l)?this.characterFormat.copyFormat(e.characterFormat):(l=this.getPreviousTextElement(l),t.isNullOrUndefined(l)||this.characterFormat.copyFormat(l.characterFormat)),!0;return!1},e.prototype.getCharacterFormatForBlock=function(e,t,i){e instanceof G?this.getCharacterFormat(e,t,i):this.getCharacterFormatInTable(e,t,i)},e.prototype.getCharacterFormatInTable=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){for(var n=e.childWidgets[r],o=0;o<n.childWidgets.length;o++)this.getCharacterFormatForSelectionCell(n.childWidgets[o],t,i);if(i.paragraph.isInsideTable&&this.containsRow(n,i.paragraph.associatedCell))return}var a=this.getNextRenderedBlock(e);this.getCharacterFormatForBlock(a,t,i)},e.prototype.getCharacterFormatForSelectionCell=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++)this.getCharacterFormatForBlock(e.childWidgets[r],t,i)},e.prototype.getCharacterFormatInternal=function(e,t){for(var i=0;i<e.childWidgets.length;i++)for(var r=e.childWidgets[i],n=0;n<r.children.length;n++){var o=r.children[n];o instanceof re||o instanceof $||t.characterFormat.combineFormat(o.characterFormat)}},e.prototype.getNextValidCharacterFormat=function(e){var i=this.getNextTextElement(e);if(t.isNullOrUndefined(i))return e.characterFormat;var r=void 0;return i instanceof $&&0===r.fieldType&&(r=i),t.isNullOrUndefined(r)?i.characterFormat:this.getNextValidCharacterFormatOfField(r)},e.prototype.getNextValidCharacterFormatOfField=function(e){var i=e;W.isLinkedFieldCharacter(e)&&(i=t.isNullOrUndefined(e.fieldSeparator)?e.fieldEnd:e.fieldSeparator);var r=void 0;return t.isNullOrUndefined(i.nextNode)||(r=this.getNextValidElement(i.nextNode)),t.isNullOrUndefined(r)?i.characterFormat:r.characterFormat},e.prototype.checkCursorIsInSelection=function(e,i){if(t.isNullOrUndefined(this.start)||this.isEmpty||t.isNullOrUndefined(e))return!1;var r=!1;do{if(this.selectedWidgets.containsKey(e)){var n=void 0;e instanceof J?(n=this.owner.selection.getTop(e),this.owner.selection.getLeft(e)):(n=e.y,e.x);var o=this.selectedWidgets.get(e);r=o.left<=i.x&&n<=i.y&&n+e.height>=i.y&&o.left+o.width>=i.x}e=e instanceof J?e.paragraph:e.containerWidget}while(!t.isNullOrUndefined(e)&&!r);return r},e.prototype.copySelectionParagraphFormat=function(){var e=new F;return this.paragraphFormat.copyToFormat(e),e},e.prototype.getHyperlinkDisplayText=function(e,i,r,n,o){var a=e;if(a!==r.line.paragraph)return n=!0,{displayText:"<<Selection in Document>>",isNestedField:n,format:o};for(var s="",l=a.childWidgets.indexOf(i.line),d=a.childWidgets[l].children.indexOf(i),h=l;h<a.childWidgets.length;h++){var c=a.childWidgets[h];h!==l&&(d=-1);for(var p=d+1;p<c.children.length;p++){var g=c.children[p];if(g===r)return{displayText:s,isNestedField:n,format:o};if(g instanceof Q)s+=g.text,o=g.characterFormat;else{if(!(g instanceof $))return n=!0,{displayText:"<<Selection in Document>>",isNestedField:n,format:o};g instanceof $&&0===g.fieldType&&!t.isNullOrUndefined(g.fieldEnd)&&(d=t.isNullOrUndefined(g.fieldSeparator)?c.children.indexOf(g.fieldEnd):c.children.indexOf(g.fieldSeparator))}}}return{displayText:s,isNestedField:n,format:o}},e.prototype.navigateHyperLinkOnEvent=function(e,i){var r=this,n=this.viewer.getLineWidget(e);if(!t.isNullOrUndefined(n)){var o=this.getHyperLinkFieldInCurrentSelection(n,e);t.isNullOrUndefined(o)||(this.viewer.updateTextPositionForSelection(e,1),this.fireRequestNavigate(o),setTimeout(function(){r.viewer&&(r.viewer.isTouchInput=i,r.viewer.updateFocus(),r.viewer.isTouchInput=!1)}))}},e.prototype.getLinkText=function(e){var i=new Ne(e,this),r=i.navigationLink;return i.localReference.length>0&&("_"!==i.localReference[0]||!t.isNullOrUndefined(r)&&0!==r.length?r+="#"+i.localReference:r="Current Document"),i.destroy(),r},e.prototype.setHyperlinkContentToToolTip=function(e,i,r){if(e){if(this.owner.contextMenuModule&&"block"===this.owner.contextMenuModule.contextMenuInstance.element.style.display)return;this.toolTipElement||(this.toolTipElement=t.createElement("div",{className:"e-de-tooltip"}),this.viewer.viewerContainer.appendChild(this.toolTipElement)),this.toolTipElement.style.display="block";var n=new t.L10n("documenteditor",this.owner.defaultLocale);n.setLocale(this.owner.locale);var o=n.getConstant("Click to follow link");this.owner.useCtrlClickToFollowHyperlink&&(o="Ctrl+"+o);var a=this.getLinkText(e);this.toolTipElement.innerHTML=a+"</br><b>"+o+"</b>";var s=this.getTop(i)*this.viewer.zoomFactor,l=this.getPage(i.paragraph),d=this.viewer.viewerContainer.getBoundingClientRect().width+this.viewer.viewerContainer.scrollLeft,h=l.boundingRectangle.x+r*this.viewer.zoomFactor;h+this.toolTipElement.clientWidth+10>d&&(h-=this.toolTipElement.clientWidth-(d-h)+15);var c=this.getPageTop(l)+(s-this.toolTipElement.offsetHeight);c=c>this.viewer.viewerContainer.scrollTop?c:c+i.height+this.toolTipElement.offsetHeight,this.showToolTip(h,c),t.isNullOrUndefined(this.toolTipField)||e===this.toolTipField||(this.toolTipObject.position={X:h,Y:c}),this.toolTipObject.show(),this.toolTipField=e}else this.hideToolTip()},e.prototype.showToolTip=function(e,t){this.toolTipObject||(this.toolTipObject=new n.Popup(this.toolTipElement,{height:"auto",width:"auto",relateTo:this.viewer.viewerContainer.parentElement,position:{X:e,Y:t}}))},e.prototype.hideToolTip=function(){this.toolTipField=void 0,this.toolTipObject&&(this.toolTipObject.hide(),this.toolTipObject.destroy(),this.toolTipObject=void 0,this.toolTipElement.style.display="none")},e.prototype.getHyperLinkFieldInCurrentSelection=function(e,i){var r=void 0,n=this.getTop(e),o=this.getLineStartLeft(e);if(!(i.y<n||i.y>n+e.height||i.x<o||i.x>o+e.paragraph.width)){var a=e.paragraph.x,s=this.getFirstElement(e,a);a=s.left;var l=s.element;if(t.isNullOrUndefined(l)){p=this.viewer.textHelper.getParagraphMarkWidth(e.paragraph.characterFormat);if(i.x<=o+p||i.x>=o+p){var d=[],h=this.getHyperLinkFields(e.paragraph,d);return d=[],d=void 0,h}}else{if(i.x>a+l.margin.left)for(var c=e.children.indexOf(l);c<e.children.length&&(l=e.children[c],!(i.x<a+l.margin.left+l.width||c===e.children.length-1));c++)a+=l.margin.left+l.width;r=l;var p=l.margin.left+l.width;if(t.isNullOrUndefined(r.nextNode)&&(p+=this.viewer.textHelper.getParagraphMarkWidth(r.line.paragraph.characterFormat)),i.x<=a+p){var d=[],h=this.getHyperLinkFieldInternal(r.line.paragraph,r,d);return d=[],d=void 0,h}}}},e.prototype.getHyperlinkField=function(){if(!t.isNullOrUndefined(this.end)){var e=0,i=this.end.currentWidget.getInline(this.end.offset,e);e=i.index;var r=i.element,n=[],o=void 0;if(t.isNullOrUndefined(r))o=this.getHyperLinkFields(this.end.paragraph,n);else{var a=r.line.paragraph;o=this.getHyperLinkFieldInternal(a,r,n)}return n=[],o}},e.prototype.getHyperLinkFields=function(e,i){for(var r=0;r<this.viewer.fields.length;r++)if(-1===i.indexOf(this.viewer.fields[r])&&!t.isNullOrUndefined(this.viewer.fields[r].fieldSeparator)){i.push(this.viewer.fields[r]);var n=this.getFieldCode(this.viewer.fields[r]);if((n=n.trim().toLowerCase()).match("hyperlink ")&&this.paragraphIsInFieldResult(this.viewer.fields[r],e))return this.viewer.fields[r]}},e.prototype.getHyperLinkFieldInternal=function(e,i,r){for(var n=0;n<this.viewer.fields.length;n++)if(-1===r.indexOf(this.viewer.fields[n])&&!t.isNullOrUndefined(this.viewer.fields[n].fieldSeparator)){r.push(this.viewer.fields[n]);var o=this.getFieldCode(this.viewer.fields[n]);if((o=o.trim().toLowerCase()).match("hyperlink ")&&(this.inlineIsInFieldResult(this.viewer.fields[n],i)||this.isImageField()))return this.viewer.fields[n]}if(e.containerWidget instanceof V&&!(e instanceof q))return this.getHyperLinkFieldInternal(e.containerWidget,i,r)},e.prototype.getBlock=function(e){if(""!==e&&!t.isNullOrUndefined(e)){var i={index:e},r=this.start.getPage(i),n=i.index.indexOf(";"),o=i.index.substring(0,n);i.index=i.index.substring(n).replace(";","");var a=r.bodyWidgets[parseInt(o,10)];return this.getBlockInternal(a,i.index)}},e.prototype.getBlockInternal=function(e,i){if(""!==i&&!t.isNullOrUndefined(i)){var r=i.indexOf(";"),n=i.substring(0,r);i=i.substring(r).replace(";","");var o=e;if(!((r=parseInt(n,10))>=0&&r<e.childWidgets.length))return o;var a=e.childWidgets[r];return i.indexOf(";")>=0?a instanceof G?(i.indexOf(";")>=0&&(i="0"),a):a instanceof j?this.getBlockInternal(a,i):o:a}},e.prototype.inlineIsInFieldResult=function(e,i){return!(t.isNullOrUndefined(e.fieldEnd)||t.isNullOrUndefined(e.fieldSeparator)||!this.isExistBeforeInline(e.fieldSeparator,i))&&this.isExistAfterInline(e.fieldEnd,i)},e.prototype.paragraphIsInFieldResult=function(e,i){if(!t.isNullOrUndefined(e.fieldEnd)&&!t.isNullOrUndefined(e.fieldSeparator)){var r=e.fieldSeparator.line.paragraph;if(e.fieldSeparator.line.paragraph===i||this.isExistBefore(r,i))return e.fieldEnd.line.paragraph!==i&&this.isExistAfter(r,i)}return!1},e.prototype.isImageField=function(){if(this.start.paragraph.isEmpty()||this.end.paragraph.isEmpty())return!1;var e=this.start,t=this.end;this.isForward||(e=this.end,t=this.start);var i=0,r=e.paragraph.getInline(e.offset,i),n=r.element;(i=r.index)===n.length&&(n=this.getNextRenderedElementBox(n,i));var o=(r=t.paragraph.getInline(t.offset,i)).element;if(i=r.index,n instanceof $&&0===n.fieldType&&o instanceof $&&1===o.fieldType&&n.fieldSeparator){var a=n.fieldSeparator.nextNode;if(a instanceof re&&a.nextNode===o)return!0}return!1},e.prototype.selectListText=function(){var e=this.viewer.selectionLineWidget.getHierarchicalIndex("0"),t=this.getTextPosition(e),i=this.getTextPosition(e);this.selectRange(t,i),this.highlightListText(this.viewer.selectionLineWidget),this.contextTypeInternal="List"},e.prototype.highlightListText=function(e){var t=e.children[0].width,i=this.viewer.getLeftValue(e),r=e.paragraph.y;this.createHighlightBorder(e,t,i,r),this.viewer.isListTextSelected=!0},e.prototype.updateImageSize=function(e){this.owner.isShiftingEnabled=!0;var t=this.start,i=this.end;this.isForward||(t=this.end,i=this.start);var r=null,n=0,o=t.paragraph;if(o===i.paragraph&&t.offset+1===i.offset){var a=o.getInline(i.offset,n);r=a.element,n=a.index}if(r instanceof re){var s=r.width,l=r.height;if(r.width=e.width,r.height=e.height,e.width=s,e.height=l,null!=o&&null!=o.containerWidget&&this.owner.editorModule){var d=o.childWidgets.indexOf(r.line),h=r.line.children.indexOf(r);this.viewer.layout.reLayoutParagraph(o,d,h),this.highlightSelection(!1)}}},e.prototype.getSelectedCellsInTable=function(e,t,i){for(var r=t.columnIndex,n=i.columnIndex+i.cellFormat.columnSpan-1,o=t.ownerRow.index,a=i.ownerRow.index,s=[],l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[l];if(d.index>=o&&d.index<=a)for(var h=0;h<d.childWidgets.length;h++){var c=d.childWidgets[h];c.columnIndex>=r&&c.columnIndex<=n&&s.push(c)}if(d.index>a)break}return s},e.prototype.copy=function(){this.isEmpty||this.copySelectedContent(!1)},e.prototype.copySelectedContent=function(e){if(!t.isNullOrUndefined(this.owner.sfdtExportModule)){var i=this.start,r=this.end;this.isForward||(i=this.end,r=this.start);var n=this.owner.sfdtExportModule.write(i.currentWidget,i.offset,r.currentWidget,r.offset,!0);this.owner.editorModule&&(this.owner.editorModule.copiedData=JSON.stringify(n));var o=this.htmlWriter.writeHtml(n);this.copyToClipboard(o),e&&this.owner.editorModule&&this.owner.editorModule.handleCut(this),this.viewer.updateFocus()}},e.prototype.copyToClipboard=function(e){window.getSelection().removeAllRanges();var t=document.createElement("div");t.style.left="-10000px",t.style.top="-10000px",t.innerHTML=e,document.body.appendChild(t);var i=document.createRange();i.selectNodeContents(t),window.getSelection().addRange(i);var r=!1;try{r=document.execCommand("copy")}catch(e){}finally{window.getSelection().removeAllRanges(),t.parentNode.removeChild(t),this.viewer.viewerContainer.focus()}return r},e.prototype.showCaret=function(){var e=t.isNullOrUndefined(this.viewer.currentPage)?this.viewer.currentRenderingPage:this.viewer.currentPage;if(!(t.isNullOrUndefined(e)||this.viewer.isRowOrCellResizing||this.owner.enableImageResizerMode&&this.owner.imageResizerModule.isImageResizerVisible)){var i=e.boundingRectangle.x,r=e.boundingRectangle.width*this.viewer.zoomFactor+i;if(!this.owner.enableImageResizerMode||!this.owner.imageResizerModule.isImageResizerVisible)if(!this.isEmpty||this.owner.isReadOnlyMode&&!this.owner.enableCursorOnReadOnly)this.isImageSelected&&!this.owner.enableImageResizerMode?this.caret.style.display="block":("block"===this.caret.style.display||t.isNullOrUndefined(this))&&(this.viewer.isComposingIME||(this.caret.style.display="none"));else{var n=parseInt(this.caret.style.left.replace("px",""),10);this.caret.style.display=n<i||n>r?"none":"block"}if(t.isNullOrUndefined(this)||!this.viewer.isTouchInput||this.owner.isReadOnlyMode)this.viewer.touchStart.style.display="none",this.viewer.touchEnd.style.display="none";else{var o=parseInt(this.viewer.touchStart.style.left.replace("px",""),10)+14,a=parseInt(this.viewer.touchEnd.style.left.replace("px",""),10)+14,s=this.getSelectionPage(this.start);s&&(this.viewer.touchEnd.style.display=a<i||a>r?"none":"block",this.isEmpty||(i=s.boundingRectangle.x,r=s.boundingRectangle.width*this.viewer.zoomFactor+i),this.viewer.touchStart.style.display=o<i||o>r?"none":"block")}}},e.prototype.setEditableDivCaretPosition=function(e){this.viewer.editableDiv.focus();var t=this.viewer.editableDiv.childNodes[this.viewer.editableDiv.childNodes.length-1];if(t){var i=document.createRange();i.setStart(t,e),i.collapse(!0),window.getSelection().removeAllRanges(),window.getSelection().addRange(i)}},e.prototype.initCaret=function(){this.caret=t.createElement("div",{styles:"position:absolute",className:"e-de-blink-cursor e-de-cursor-animation"}),this.viewer.viewerContainer.appendChild(this.caret)},e.prototype.updateCaretPosition=function(){var e=this.end.location,t=this.getSelectionPage(this.end);if(t){this.caret.style.left=t.boundingRectangle.x+Math.round(e.x)*this.viewer.zoomFactor+"px";var i=this.updateCaretSize(this.owner.selection.end),r=i.topMargin,n=(i.height,this.viewer),o=(t.boundingRectangle.y-n.pageGap*(this.viewer.pages.indexOf(t)+1))*this.viewer.zoomFactor+n.pageGap*(this.viewer.pages.indexOf(t)+1);this.caret.style.top=o+Math.round(e.y+r)*this.viewer.zoomFactor+"px","Subscript"===this.owner.selection.characterFormat.baselineAlignment&&(this.caret.style.top=parseFloat(this.caret.style.top)+parseFloat(this.caret.style.height)/2+"px"),(this.viewer.isTouchInput||"none"!==this.viewer.touchStart.style.display)&&(this.viewer.touchStart.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.viewer.zoomFactor-14)+"px",this.viewer.touchStart.style.top=o+(e.y+i.height)*this.viewer.zoomFactor+"px",this.viewer.touchEnd.style.left=t.boundingRectangle.x+(Math.round(e.x)*this.viewer.zoomFactor-14)+"px",this.viewer.touchEnd.style.top=o+(e.y+i.height)*this.viewer.zoomFactor+"px")}},e.prototype.getRect=function(e){var t=e.location,i=this.getSelectionPage(e);if(i){var r=this.viewer,n=i.boundingRectangle.x+Math.round(t.x)*r.zoomFactor,o=r.pageGap,a=(i.boundingRectangle.y-o*(i.index+1))*r.zoomFactor+o*(i.index+1)+Math.round(t.y)*r.zoomFactor;return new T(n,a)}return new T(0,0)},e.prototype.getSelectionPage=function(e){var t=this.getLineWidgetInternal(e.currentWidget,e.offset,!0);if(t)return this.getPage(t.paragraph)},e.prototype.updateCaretSize=function(e,i){var r,n=0,o=!1,a=0,s=0;if(this.characterFormat.italic&&(o=this.characterFormat.italic),e.paragraph.isEmpty()){var l=e.paragraph,d=0,h=this.getParagraphMarkSize(l,n,d);n=h.topMargin,d=h.bottomMargin;var c=h.height;s=n<0?n+c:c,i||(this.caret.style.height=s*this.viewer.zoomFactor+"px"),n=0}else{var p=e.currentWidget.getInline(e.offset,a);a=p.index;var g=p.element;t.isNullOrUndefined(g)||(s=(r=this.getCaretHeight(g,a,g.characterFormat,!0,n,o)).height,i||(this.caret.style.height=r.height*this.viewer.zoomFactor+"px"))}return i||(this.caret.style.transform=o?"rotate(13deg)":""),{topMargin:n,height:s}},e.prototype.updateCaretToPage=function(e,i){if(!t.isNullOrUndefined(i))if(this.viewer.selectionEndPage=i,this.owner.selection.isEmpty)this.viewer.selectionStartPage=i;else{var r=this.getLineWidgetParagraph(e.offset,e.paragraph.childWidgets[0]),n=this.getPage(r.paragraph);t.isNullOrUndefined(n)||(this.viewer.selectionStartPage=n)}this.checkForCursorVisibility()},e.prototype.getCaretBottom=function(e,t){var i=e.location.y;if(e.paragraph.isEmpty()){var r=e.paragraph,n=0,o=0,a=this.getParagraphMarkSize(r,n,o);n=a.topMargin,o=a.bottomMargin,i+=a.height,i+=n,t||(i+=o)}else{var s=0,l=e.paragraph.getInline(e.offset,s),d=l.element;s=l.index;var n=0,h=!1,c=this.getCaretHeight(d,s,d.characterFormat,!1,n,h);n=c.topMargin,h=c.isItalic,i+=c.height,t&&(i-=W.convertPointToPixel(e.paragraph.paragraphFormat.afterSpacing))}return i},e.prototype.checkForCursorVisibility=function(){this.showCaret()},e.prototype.onKeyDownInternal=function(e,i,r,n){var o=e.which||e.keyCode;if(!i||r||n)if(!r||i||n)if(r&&i&&!n)switch(o){case 35:this.handleControlShiftEndKey();break;case 36:this.handleControlShiftHomeKey();break;case 37:this.handleControlShiftLeftKey();break;case 38:this.handleControlShiftUpKey();break;case 39:this.handleControlShiftRightKey();break;case 40:this.handleControlShiftDownKey()}else switch(o){case 33:e.preventDefault(),this.viewer.viewerContainer.scrollTop-=this.viewer.visibleBounds.height;break;case 34:e.preventDefault(),this.viewer.viewerContainer.scrollTop+=this.viewer.visibleBounds.height;break;case 35:this.handleEndKey(),e.preventDefault();break;case 36:this.handleHomeKey(),e.preventDefault();break;case 37:this.handleLeftKey(),e.preventDefault();break;case 38:this.handleUpKey(),e.preventDefault();break;case 39:this.handleRightKey(),e.preventDefault();break;case 40:this.handleDownKey(),e.preventDefault()}else switch(o){case 35:this.handleShiftEndKey(),e.preventDefault();break;case 36:this.handleShiftHomeKey(),e.preventDefault();break;case 37:this.handleShiftLeftKey(),e.preventDefault();break;case 38:this.handleShiftUpKey(),e.preventDefault();break;case 39:this.handleShiftRightKey(),e.preventDefault();break;case 40:this.handleShiftDownKey(),e.preventDefault()}else switch(this.viewer.isControlPressed=!0,o){case 35:this.handleControlEndKey();break;case 36:this.handleControlHomeKey();break;case 37:this.handleControlLeftKey();break;case 38:this.handleControlUpKey();break;case 39:this.handleControlRightKey();break;case 40:this.handleControlDownKey();break;case 65:this.owner.selection.selectAll();break;case 67:e.preventDefault(),this.copy();break;case 70:e.preventDefault(),t.isNullOrUndefined(this.owner.optionsPaneModule)||this.owner.optionsPaneModule.showHideOptionsPane(!0)}this.owner.isReadOnlyMode||this.owner.editorModule.onKeyDownInternal(e,i,r,n),this.owner.searchModule&&!t.isNullOrUndefined(this.owner.searchModule.searchHighlighters)&&this.owner.searchModule.searchHighlighters.length>0&&this.owner.searchModule.searchResults.clear(),27!==e.keyCode&&27!==e.which||(t.isNullOrUndefined(this.owner.optionsPaneModule)||this.owner.optionsPaneModule.showHideOptionsPane(!1),this.owner.enableHeaderAndFooter&&this.disableHeaderFooter())},e.prototype.checkAndEnableHeaderFooter=function(e,t){var i=this.viewer.currentPage;if(this.isCursorInsidePageRect(e,i)){if(this.isCursorInHeaderRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.headerWidget);if(this.isCursorInFooterRegion(e,i))return!this.owner.enableHeaderAndFooter&&this.enableHeadersFootersRegion(i.footerWidget)}return!!this.owner.enableHeaderAndFooter&&(this.owner.enableHeaderAndFooter=!1,this.viewer.updateTextPositionForSelection(t,1),!0)},e.prototype.isCursorInsidePageRect=function(e,t){return this.viewer.containerLeft+e.x>=t.boundingRectangle.x&&this.viewer.containerLeft+e.x<=t.boundingRectangle.x+t.boundingRectangle.width*this.viewer.zoomFactor},e.prototype.isCursorInHeaderRegion=function(e,t){var i=this.getPageTop(t),r=0;t.headerWidget&&(r=t.headerWidget.y+t.headerWidget.height);var n=Math.max(r,W.convertPointToPixel(t.bodyWidgets[0].sectionFormat.topMargin))*this.viewer.zoomFactor;return this.viewer.containerTop+e.y>=i&&this.viewer.containerTop+e.y<=i+n},e.prototype.isCursorInFooterRegion=function(e,t){var i=t.boundingRectangle,r=this.getPageTop(t),n=r+i.height*this.viewer.zoomFactor,o=W.convertPointToPixel(t.bodyWidgets[0].sectionFormat.footerDistance),a=0;t.footerWidget&&(a=t.footerWidget.height);var s=(i.height-Math.max(a+o,W.convertPointToPixel(t.bodyWidgets[0].sectionFormat.bottomMargin)))*this.viewer.zoomFactor;return this.viewer.containerTop+e.y<=n&&this.viewer.containerTop+e.y>=r+s},e.prototype.enableHeadersFootersRegion=function(e){return this.owner.enableHeaderAndFooter=!0,this.updateTextPositionForBlockContainer(e),!0},e.prototype.updateTextPositionForBlockContainer=function(e){var t=e.firstChild;t instanceof K&&(t=this.getFirstBlockInFirstCell(t)),this.selectParagraph(t,!0)},e.prototype.disableHeaderFooter=function(){var e=this.getPage(this.start.paragraph);this.updateTextPositionForBlockContainer(e.bodyWidgets[0]),this.owner.enableHeaderAndFooter=!1},e.prototype.destroy=function(){t.isNullOrUndefined(this.contextTypeInternal)||(this.contextTypeInternal=void 0),this.caret=void 0,this.contextTypeInternal=void 0,this.upDownSelectionLength=void 0,this.viewer=void 0,this.owner=void 0},e.prototype.navigateBookmark=function(e,t){var i=this.viewer.bookmarks;if(i.containsKey(e)){var r=i.get(e),n=r.line.getOffset(r,1),o=new Ie(this.viewer.owner);if(o.setPositionParagraph(r.line,n),t)this.viewer.selection.selectRange(o,o);else{var a=r.reference,s=a.line.getOffset(a,0),l=new Ie(this.viewer.owner);l.setPositionParagraph(a.line,s),this.viewer.selection.selectRange(o,l)}}},e.prototype.selectBookmark=function(e){this.navigateBookmark(e)},e.prototype.getTocField=function(){for(var e=this.start.paragraph,t=void 0;void 0!==e&&this.isTocStyle(e);)t=e,e=e.previousRenderedWidget;if(void 0!==t){var i=t.childWidgets[0];if(void 0!==i)return i.children[0]}},e.prototype.isTocStyle=function(e){var t=e.paragraphFormat.baseStyle;return void 0!==t&&-1!==t.name.toLowerCase().indexOf("toc")},e}(),ke=function(){function e(e){this.wordBefore="\\b",this.wordAfter="\\b",this.isHeader=!1,this.isFooter=!1,this.owner=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.find=function(e,t){return this.findNext(e,t,"0;0;0")},e.prototype.findNext=function(e,t,i){"string"==typeof e&&(e=this.stringToRegex(e,t)),void 0===i&&(i="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var r=this.owner.searchModule.textSearchResults;return this.findDocument(r,e,!0,t,i),r.length,r.currentSearchResult},e.prototype.stringToRegex=function(e,t){return e.indexOf("\\")>-1&&(e=e.split("\\").join("\\\\")),e.indexOf(".")>-1&&(e="\\"+e),"WholeWord"!==t&&"CaseSensitiveWholeWord"!==t||(e=this.wordBefore+e+this.wordAfter),new RegExp(e,"CaseSensitive"===t||"CaseSensitiveWholeWord"===t?"g":"ig")},e.prototype.isPatternEmpty=function(e){var t=this.wordBefore+this.wordAfter,i=e.toString();return 0===i.length||i===t},e.prototype.findAll=function(e,i,r){"string"==typeof e&&(e=this.stringToRegex(e,i)),void 0===r&&(r="0;0;0"),this.owner.searchModule.textSearchResults.clearResults();var n=this.owner.searchModule.textSearchResults;if(this.findDocument(n,e,!1,i,r),n.length>0&&n.currentIndex<0&&(n.currentIndex=0),!t.isNullOrUndefined(n.currentSearchResult)){var o={source:this.viewer.owner};return this.viewer.owner.trigger("searchResultsChange",o),n}},e.prototype.findDocument=function(e,i,r,n,o){if(!this.isPatternEmpty(i)){void 0===n&&(n="None");var a=void 0,s=void 0;if(void 0!==o&&(s=this.owner.selection.end),void 0!==o&&r&&void 0!==s&&void 0!==s.paragraph&&s.paragraph instanceof G){var l=0,d=s.currentWidget.getInline(this.owner.selection.start.offset,l);if(a=d.element,l=d.index,!t.isNullOrUndefined(a)){var h=void 0;for(h=this.findInline(a,i,n,l,r,e,s);0===e.length&&!t.isNullOrUndefined(h);){for(;!t.isNullOrUndefined(h)&&0===h.childWidgets.length;)h=this.owner.selection.getNextParagraph(h.containerWidget);if(t.isNullOrUndefined(h))break;var c=h.childWidgets[0];if(a=c.children[0]instanceof ne?c.children[2]instanceof Q?c.children[2]:void 0:c.children[0],t.isNullOrUndefined(a))break;h=this.findInline(a,i,n,0,r,e,s)}if(e.length>0)return}}var p;for(p=this.viewer.pages[0].bodyWidgets[0];!t.isNullOrUndefined(p)&&0===p.childWidgets.length;)p=p.nextWidget;if(!t.isNullOrUndefined(p)&&0!==p.childWidgets.length){this.isHeader=!1,this.isFooter=!1,this.findInlineText(p,i,n,r,e,s);for(u=0;u<this.viewer.pages.length;u++){var g=this.viewer.pages[u].headerWidget;t.isNullOrUndefined(g)||(this.isHeader=!0,this.isFooter=!1,this.findInlineText(g,i,n,r,e,s))}for(var u=0;u<this.viewer.pages.length;u++){var f=this.viewer.pages[u].footerWidget;t.isNullOrUndefined(f)||(this.isHeader=!1,this.isFooter=!0,this.findInlineText(f,i,n,r,e,s))}r&&!t.isNullOrUndefined(e)&&e.length}}},e.prototype.findInlineText=function(e,i,r,n,o,a){for(var s=this.owner.selection.getFirstParagraphBlock(e.childWidgets[0]);!t.isNullOrUndefined(s)&&1===s.childWidgets.length&&0===s.childWidgets[0].children.length;)s=this.owner.selection.getNextParagraphBlock(s);for(;!t.isNullOrUndefined(s)&&s.childWidgets.length>0;){var l=s.childWidgets[0].children[0];if(t.isNullOrUndefined(l))break;for(this.findInline(l,i,r,0,n,o,a),s=this.owner.selection.getNextParagraphBlock(s);!t.isNullOrUndefined(s)&&1===s.childWidgets.length&&0===s.childWidgets[0].children.length;)s=this.owner.selection.getNextParagraphBlock(s)}n&&!t.isNullOrUndefined(o)&&o.length},e.prototype.findInline=function(e,i,r,n,o,a,s){for(var l=e,d="",h=new c;;){if(e instanceof Q&&!t.isNullOrUndefined(e.text)&&""!==e.text)h.add(e,d.length),d+=e===l?e.text.substring(n):e.text;else if(e instanceof $){var p=e;t.isNullOrUndefined(p.fieldEnd)||(e=t.isNullOrUndefined(p.fieldSeparator)?p.fieldEnd:p.fieldSeparator)}if(!t.isNullOrUndefined(e)&&t.isNullOrUndefined(e.nextNode))break;t.isNullOrUndefined(e)||(e=e.nextNode)}for(var g,u=d.toString(),f=[];!t.isNullOrUndefined(g=i.exec(u));)f.push(g);for(var m=0;m<f.length;m++){for(var v=f[m],y=a.addResult(),w=h.keys,b=0;b<w.length;b++){var x=w[b],C=h.get(x),F=x.length;if(x===l&&(F-=n),t.isNullOrUndefined(y.start)&&v.index<C+F){P=v.index-C;x===l&&(P+=n);W=x.line.getOffset(x,P);y.start=this.getTextPosition(x.line,W.toString()),y.start.location=this.owner.selection.getPhysicalPositionInternal(x.line,W,!0),y.start.setPositionParagraph(x.line,W)}if(v.index+v[0].length<=C+F){var P=v.index+v[0].length-C;x===l&&(P+=n);var W=x.line.getOffset(x,P);y.end=this.getTextPosition(x.line,W.toString()),y.end.location=this.owner.selection.getPhysicalPositionInternal(x.line,W,!0),y.end.setPositionParagraph(x.line,W);break}}if(y.isHeader=this.isHeader,y.isFooter=this.isFooter,o)return void(a.currentIndex=0);a.currentIndex<0&&s.isExistBefore(y.start)&&(a.currentIndex=a.indexOf(y))}return this.owner.selection.getNextParagraphBlock(e.line.paragraph)},e.prototype.getTextPosition=function(e,t){var i=new Ie(this.owner),r=i.getHierarchicalIndex(e,t);return i.setPositionForCurrentIndex(r),i},e}(),Be=function(){function e(e,t){this.leftInternal=0,this.widthInternal=0,this.leftInternal=e,this.widthInternal=t}return Object.defineProperty(e.prototype,"left",{get:function(){return this.leftInternal},set:function(e){this.leftInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthInternal},set:function(e){this.widthInternal=e},enumerable:!0,configurable:!0}),e}(),Ee=function(){function e(e){this.startIn=void 0,this.endIn=void 0,this.owner=e}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.startIn},set:function(e){this.startIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.endIn},set:function(e){this.endIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"text",{get:function(){return this.viewer.selection.getTextInternal(this.start,this.end,!1)},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.start=void 0,this.end=void 0},e}(),Re=function(){function e(e){this.currentIndex=-1,this.owner=e}return Object.defineProperty(e.prototype,"length",{get:function(){return void 0===this.innerList?0:this.innerList.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentSearchResult",{get:function(){if(!(void 0===this.innerList||this.currentIndex<0||this.currentIndex>=this.length))return this.innerList[this.currentIndex]},enumerable:!0,configurable:!0}),e.prototype.addResult=function(){var e=new Ee(this.owner);return t.isNullOrUndefined(this.innerList)&&(this.innerList=[]),this.innerList.push(e),e},e.prototype.clearResults=function(){if(this.currentIndex=-1,!t.isNullOrUndefined(this.innerList))for(var e=this.innerList.length-1;e>=0;e--)this.innerList[e].destroy(),this.innerList.splice(e,1)},e.prototype.indexOf=function(e){return t.isNullOrUndefined(this.innerList)?-1:this.innerList.indexOf(e)},e.prototype.destroy=function(){t.isNullOrUndefined(this.innerList)||this.clearResults(),this.innerList=void 0},e}(),Me=function(){function e(e){this.searchModule=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.searchModule.textSearchResults.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this.searchModule.textSearchResults.currentIndex},set:function(e){0===this.length||e<0||e>this.searchModule.textSearchResults.length-1||(this.searchModule.textSearchResults.currentIndex=e,this.navigate(e))},enumerable:!0,configurable:!0}),e.prototype.replace=function(e){-1!==this.index&&this.searchModule.replaceInternal(e)},e.prototype.replaceAll=function(e){-1!==this.index&&this.searchModule.replaceAllInternal(e)},e.prototype.navigate=function(e){this.searchModule.navigate(this.searchModule.textSearchResults.currentSearchResult),this.searchModule.highlight(this.searchModule.textSearchResults)},e.prototype.clear=function(){this.searchModule.textSearchResults.clearResults(),this.searchModule.clearSearchHighlight(),this.searchModule.viewer.renderVisiblePages()},e}(),He=function(){function e(e){this.searchHighlighters=void 0,this.isHandledOddPageHeader=void 0,this.isHandledEvenPageHeader=void 0,this.isHandledOddPageFooter=void 0,this.isHandledEvenPageFooter=void 0,this.owner=e,this.searchHighlighters=new c,this.textSearch=new ke(this.owner),this.textSearchResults=new Re(this.owner),this.searchResultsInternal=new Me(this)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"searchResults",{get:function(){return this.searchResultsInternal},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Search"},e.prototype.find=function(e,i){t.isNullOrUndefined(i)&&(i="None");var r=this.textSearch.find(e,i);t.isNullOrUndefined(r)||this.navigate(r)},e.prototype.findAll=function(e,i){if(!t.isNullOrUndefined(e||""===e)){t.isNullOrUndefined(i)&&(i="None");var r=this.textSearch.findAll(e,i);!t.isNullOrUndefined(r)&&r.length>0&&(this.navigate(r.innerList[r.currentIndex]),this.highlight(r))}},e.prototype.replace=function(e,i,r){if(t.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||t.isNullOrUndefined(r))return 0;t.isNullOrUndefined(this.viewer)||this.clearSearchHighlight(),this.navigate(i);var n=this.viewer.selection.start;if(r.indexOf(i)<0)return 0;this.owner.editorModule.insertText(e,!0);var o=i.end,a=new Ie(this.viewer.owner);a.setPositionParagraph(o.currentWidget,n.offset-e.length),this.viewer.selection.selectRange(n,a);var s={source:this.viewer.owner};return this.viewer.owner.trigger("searchResultsChange",s),1},e.prototype.replaceInternal=function(e,i){if(""!==e&&!t.isNullOrUndefined(e)){t.isNullOrUndefined(i)&&(i="None");var r=this.textSearchResults.currentSearchResult.text,n=this.viewer.owner.searchModule.textSearch.stringToRegex(r,i),o=this.owner.selection.end.getHierarchicalIndexInternal(),a=this.viewer.owner.searchModule.textSearch.findNext(n,i,o);t.isNullOrUndefined(a)||(this.navigate(a),this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=a,this.replace(e,a,this.textSearchResults),o=this.owner.selection.end.getHierarchicalIndexInternal(),(a=this.textSearch.findNext(r,i,o))&&(this.textSearchResults.addResult(),this.textSearchResults.innerList[0]=a,this.navigate(a)))}},e.prototype.replaceAll=function(e,i){if(t.isNullOrUndefined(this.viewer.owner)||this.viewer.owner.isReadOnlyMode||t.isNullOrUndefined(i))return 0;this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(this.owner.selection,"ReplaceAll");var r=i.length;this.viewer.owner.isLayoutEnabled=!1;for(var n=r-1;n>=0;n--){var o=i.innerList[n];this.navigate(i.innerList[n]),this.owner.editorModule.insertText(e,!0),(o.isHeader||o.isFooter)&&this.viewer.layout.updateHeaderFooterToParent(this.viewer.selection.start.paragraph.bodyWidget),i.innerList[n].destroy()}return this.owner.editorHistory&&!t.isNullOrUndefined(this.owner.editorHistory.currentHistoryInfo)?this.owner.editorHistory.updateComplexHistory():this.owner.editorModule.updateComplexWithoutHistory(2),this.searchResults.clear(),r},e.prototype.replaceAllInternal=function(e,i){""===e||t.isNullOrUndefined(e)||(t.isNullOrUndefined(i)&&(i="None"),this.textSearchResults.length>0&&(this.navigate(this.textSearchResults.innerList[this.textSearchResults.currentIndex]),this.highlight(this.textSearchResults),this.replaceAll(e,this.textSearchResults)))},e.prototype.navigate=function(e){if(e){var i=e.start,r=e.end;t.isNullOrUndefined(this.owner)||t.isNullOrUndefined(this.owner.selection)||t.isNullOrUndefined(i)||t.isNullOrUndefined(r)||t.isNullOrUndefined(i.paragraph)||t.isNullOrUndefined(r.paragraph)||this.owner.selection.selectRange(i,r)}},e.prototype.highlight=function(e){this.searchHighlighters=new c;for(var t=0;t<e.innerList.length;t++){var i=e.innerList[t];this.highlightResult(i)}this.viewer.renderVisiblePages()},e.prototype.highlightResult=function(e){this.highlightSearchResult(e.start.paragraph,e.start,e.end)},e.prototype.highlightSearchResult=function(e,i,r){var n=0,o=0,a=null,s=null,l=this.viewer.selection.getStartLineWidget(e,i,a,n);n=l.index;var d=(a=l.element)?a.line:e.childWidgets[0],h=this.viewer.selection.getEndLineWidget(r,s,o);o=h.index;var c=(s=h.element)?s.line:r.paragraph.childWidgets[r.paragraph.childWidgets.length-1],p=this.viewer.selection.getTop(d),g=this.viewer.selection.getLeftInternal(d,a,n);if(t.isNullOrUndefined(d)||d!==c){if(!t.isNullOrUndefined(d)){e!==d.paragraph&&(e=d.paragraph),this.createHighlightBorder(d,this.viewer.selection.getWidth(d,!0)-(g-d.paragraph.x),g,p);for(var u=d.paragraph.childWidgets.indexOf(d),f=0;f<e.childWidgets.length;f++){if(e===d.paragraph&&(u+=1),this.highlightSearchResultParaWidget(e,u,c,s,o),e===c.paragraph)return;u=0}}}else{var m=this.viewer.selection.getLeftInternal(c,s,o);this.createHighlightBorder(d,m-g,g,p)}},e.prototype.createHighlightBorder=function(e,t,i,r){var n=this.addSearchHighlightBorder(e),o=this.viewer.owner.selection.getPage(e.paragraph);o.boundingRectangle.y,o.boundingRectangle.x;n.left=Math.ceil(i),r=Math.ceil(r),n.width=Math.floor(t);Math.floor(e.height),this.viewer.containerContext},e.prototype.addSearchHighlightBorder=function(e){var t=void 0;this.searchHighlighters.containsKey(e)?t=this.searchHighlighters.get(e):(t=[],this.searchHighlighters.add(e,t));var i=new Be(0,0);return t.push(i),i},e.prototype.highlightSearchResultParaWidget=function(e,t,i,r,n){for(var o=0,a=t;a<e.childWidgets.length;a++){var s=e.childWidgets[a];a===t&&(o=this.viewer.selection.getTop(s));var l=this.viewer.selection.getLeft(s);if(s===i){var d=this.viewer.selection.getLeftInternal(i,r,n);return void this.createHighlightBorder(s,d-l,l,o)}this.createHighlightBorder(s,this.viewer.selection.getWidth(s,!0)-(l-e.x),l,o),o+=s.height}},e.prototype.addSearchResultItems=function(e){t.isNullOrUndefined(e)||""===e||(t.isNullOrUndefined(this.owner.findResultsList)&&(this.owner.findResultsList=[]),this.owner.findResultsList.push(e))},e.prototype.addFindResultView=function(e){for(var t=0;t<e.innerList.length;t++){var i=e.innerList[t];this.addFindResultViewForSearch(i)}this.isHandledOddPageHeader=!0,this.isHandledOddPageFooter=!0,this.isHandledEvenPageHeader=!0,this.isHandledEvenPageFooter=!0},e.prototype.addFindResultViewForSearch=function(e){if(null!=e.start&&null!=e.end&&null!=e.start.paragraph&&null!=e.end.paragraph){var i=void 0,r=0,n=e.start.currentWidget.getInline(e.start.offset,r),o=n.element;r=n.index;var a="",s=0;if(o instanceof $){var l=this.owner.selection.getRenderedInline(o,r);l.element.nextNode instanceof Q?(o=l.element.nextNode,r=l.index):(o=l.element,r=l.index)}var d=this.owner.selection.getElementBoxInternal(o,r),h=d.element;if(r=d.index,null!=h){h instanceof Q&&r>0&&(a=h.text.substring(0,r));f=h.line.children.indexOf(h);for(s=a.lastIndexOf(" ");s<0&&f>0&&h.line.children[f-1]instanceof Q;)a=h.line.children[f-1].text+a,f--,s=a.lastIndexOf(" ")}var c=a.lastIndexOf("\v");c>0?a=a.substring(0,c):(s=a.lastIndexOf(" "))<0?a:a.substring(s+1),e.text;var p=0,g=e.end.currentWidget.getInline(e.end.offset,p),u=g.element;if(p=g.index,i="",null!=d&&(h=(d=this.owner.selection.getElementBoxInternal(u,p)).element,p=d.index),null!=h){h instanceof Q&&p<h.length&&(i=h.text.substring(p));for(var f=h.line.children.indexOf(h);f+1<h.line.children.length&&h.line.children[f+1]instanceof Q||h.line.children[f+1]instanceof $;)h.line.children[f+1]instanceof $?f+=2:(i+=h.line.children[f+1].text,f+=1)}s=i.lastIndexOf(" "),i="\v"===i?i="":i;var m="";e.isHeader?m='<span class="e-de-header-footer-list">Header: </span>':e.isFooter?m='<span class="e-de-header-footer-list">Footer: </span>':(m="",m="",this.isHandledOddPageHeader=!0,this.isHandledEvenPageHeader=!0,this.isHandledOddPageFooter=!0,this.isHandledEvenPageFooter=!0);var v="",y=e.viewer.selection.getPage(e.start.paragraph);t.isNullOrUndefined(this.isHandledEvenPageHeader)&&t.isNullOrUndefined(this.isHandledEvenPageFooter)?(this.isHandledEvenPageHeader=!0,this.isHandledEvenPageFooter=!0):t.isNullOrUndefined(this.isHandledOddPageHeader)&&t.isNullOrUndefined(this.isHandledOddPageFooter)&&(this.isHandledOddPageHeader=!0,this.isHandledOddPageFooter=!0),e.isHeader?"FirstPageHeader"===y.headerWidget.headerFooterType&&y.bodyWidgets[0].sectionFormat.differentFirstPage?v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+a+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>":"EvenHeader"===y.headerWidget.headerFooterType&&this.isHandledEvenPageHeader?(v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+a+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>",this.isHandledEvenPageHeader=!1):"OddHeader"===y.headerWidget.headerFooterType&&this.isHandledOddPageHeader&&(v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+a+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>",this.isHandledOddPageHeader=!1):e.isFooter?"FirstPageFooter"===y.footerWidget.headerFooterType&&y.bodyWidgets[0].sectionFormat.differentFirstPage?v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+a+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>":"EvenFooter"===y.footerWidget.headerFooterType&&this.isHandledEvenPageFooter?(v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+a+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>",this.isHandledEvenPageFooter=!1):"OddFooter"===y.footerWidget.headerFooterType&&this.isHandledOddPageFooter&&(v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+a+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>",this.isHandledOddPageFooter=!1):e.isHeader||e.isFooter||(v='<li tabindex=0 class="e-de-search-result-item e-de-op-search-txt">'+m+a+'<span class="e-de-op-search-word" style="pointer-events:none">'+e.text+"</span>"+i+"</li>"),this.addSearchResultItems(v)}},e.prototype.clearSearchHighlight=function(){t.isNullOrUndefined(this.searchHighlighters)||(this.searchHighlighters.clear(),this.searchHighlighters=void 0);var e={source:this.viewer.owner};this.viewer.owner.trigger("searchResultsChange",e)},e.prototype.destroy=function(){this.textSearchResults&&this.textSearchResults.destroy()},e}(),Ue=function(){function e(e){var i=this;this.isOptionsPaneShow=!1,this.findOption="None",this.matchCase=void 0,this.wholeWord=void 0,this.searchText="Navigation",this.resultsText="Results",this.messageDivText="No matches",this.replaceButtonText="Replace",this.replaceAllButtonText="Replace All",this.focusedIndex=-1,this.focusedElement=[],this.isOptionsPane=!0,this.replacePaneText="Replace",this.findPaneText="Find",this.matchDivReplaceText="No matches",this.tabInstance=void 0,this.isReplace=!1,this.selectedTabItem=function(e){if(e.previousIndex!==e.selectedIndex){var r=document.querySelector("#e-content_"+e.previousIndex),n=document.querySelector("#e-content_"+e.selectedIndex);n.insertBefore(r.firstElementChild,n.firstChild)}0!==e.selectedIndex||t.isNullOrUndefined(document.querySelector("#e-content_"+e.selectedIndex))||(i.isOptionsPane=!0,i.onFindPane()),1!==e.selectedIndex||t.isNullOrUndefined(document.querySelector("#e-content_"+e.selectedIndex))||(i.isOptionsPane=!1,i.onReplacePane())},this.searchOptionChange=function(){i.clearSearchResultItems(),i.viewer.owner.searchModule.clearSearchHighlight();var e=i.searchInput.value;if(""!==e){var t=i.viewer.owner.searchModule.textSearch.stringToRegex(e,i.findOption),r=i.viewer.selection.end.getHierarchicalIndexInternal();i.results=i.viewer.owner.searchModule.textSearch.findAll(t,i.findOption,r),null!=i.results&&i.results.length>0?i.navigateSearchResult():(i.viewer.renderVisiblePages(),i.messageDiv.innerHTML=i.localeValue.getConstant("No matches"),i.resultContainer.style.display="block",i.resultsListBlock.style.display="none",i.clearFocusElement(),i.resultsListBlock.innerHTML="")}},this.wholeWordsChange=function(e){i.matchInput.checked&&i.wholeInput.checked?i.findOption="CaseSensitiveWholeWord":i.matchInput.checked&&!i.wholeInput.checked?i.findOption="CaseSensitive":!i.matchInput.checked&&i.wholeInput.checked?i.findOption="WholeWord":i.findOption="None",i.searchOptionChange()},this.matchChange=function(e){i.matchInput.checked&&i.wholeInput.checked?i.findOption="CaseSensitiveWholeWord":!i.matchInput.checked&&i.wholeInput.checked?i.findOption="WholeWord":i.matchInput.checked&&!i.wholeInput.checked?i.findOption="CaseSensitive":i.findOption="None",i.searchOptionChange()},this.onWireEvents=function(){i.searchIcon.addEventListener("click",i.searchIconClickInternal),i.navigateToNextResult.addEventListener("click",i.navigateNextResultButtonClick),i.navigateToPreviousResult.addEventListener("click",i.navigatePreviousResultButtonClick),i.searchInput.addEventListener("keydown",i.onKeyDown),i.searchInput.addEventListener("keyup",i.onEnableDisableReplaceButton),i.resultsListBlock.addEventListener("click",i.resultListBlockClick),i.closeButton.addEventListener("click",i.close),i.replaceButton.addEventListener("click",i.onReplaceButtonClick),i.replaceAllButton.addEventListener("click",i.onReplaceAllButtonClick)},this.onFindPane=function(){i.replaceDiv.style.display="none",i.occurrenceDiv.style.display="none",t.isNullOrUndefined(i.results)||0!==i.results.length||(i.resultsListBlock.innerHTML="",i.resultsListBlock.style.display="none",i.messageDiv.innerHTML=i.localeValue.getConstant("No matches")),i.resultsListBlock.style.height=i.resultsListBlock.offsetHeight+i.replaceTabContentDiv.offsetHeight+"px",i.replaceTabContentDiv.style.display="none",i.findDiv.style.display="block",i.messageDiv.style.display="block",i.focusedElement=[],i.focusedElement.push(i.closeButton,i.findTabButtonHeader,i.replaceTabButtonHeader,i.searchInput,i.searchIcon,i.navigateToPreviousResult,i.navigateToNextResult,i.matchInput,i.wholeInput),i.focusedIndex=3,i.searchInput.select(),i.getMessageDivHeight()},this.onEnableDisableReplaceButton=function(){0!==i.searchInput.value.length?(i.replaceButton.disabled=!1,i.replaceAllButton.disabled=!1):(i.replaceButton.disabled=!0,i.replaceAllButton.disabled=!0)},this.onReplacePane=function(){i.findDiv.style.display="block",i.replaceDiv.style.display="block",i.replaceTabContentDiv.style.display="block",i.resultsListBlock.style.height=i.resultsListBlock.offsetHeight-i.replaceTabContentDiv.offsetHeight+"px",i.isOptionsPane=!1,0!==i.searchInput.value.length?(i.replaceButton.disabled=!1,i.replaceAllButton.disabled=!1):(i.replaceButton.disabled=!0,i.replaceAllButton.disabled=!0),i.focusedElement=[],i.focusedElement.push(i.closeButton,i.findTabButtonHeader,i.replaceTabButtonHeader,i.searchInput,i.searchIcon,i.navigateToPreviousResult,i.navigateToNextResult,i.matchInput,i.wholeInput,i.replaceWith,i.replaceButton,i.replaceAllButton),i.focusedIndex=9,""===i.searchInput.value?i.searchInput.select():i.replaceWith.select(),i.getMessageDivHeight()},this.onKeyDownOnOptionPane=function(e){if(9===e.keyCode){e.preventDefault();var r=void 0;r=e.shiftKey?0===i.focusedIndex||t.isNullOrUndefined(i.focusedIndex)?i.focusedElement.length-1:i.focusedIndex-1:i.focusedElement.length-1===i.focusedIndex||t.isNullOrUndefined(i.focusedIndex)?0:i.focusedIndex+1,(a=i.focusedElement[r]).focus(),a instanceof HTMLInputElement&&a.select(),i.focusedIndex=r,a instanceof HTMLLIElement&&i.scrollToPosition(a)}else if(13===e.keyCode){if(e.target!==i.searchInput&&e.target!==i.closeButton&&(e.preventDefault(),-1!==(o=i.focusedElement.indexOf(e.target)))){var n=i.focusedElement[o];n.click(),n.focus(),i.focusedIndex=o}}else if((40===e.keyCode||38===e.keyCode)&&"none"!==i.resultsListBlock.style.display){var o=void 0,a=void 0;40===e.keyCode?i.focusedIndex>7?i.focusedIndex+1<i.focusedElement.length&&((a=i.focusedElement[i.focusedIndex+1]).focus(),i.focusedIndex=i.focusedIndex+1):(o=i.focusedElement.length-i.resultsListBlock.children.length+i.results.currentIndex+1)<i.focusedElement.length&&((a=i.focusedElement[o]).focus(),i.focusedIndex=o):i.focusedIndex>8&&(o=i.focusedIndex-1,(a=i.focusedElement[o]).focus(),i.focusedIndex=o)}},this.onReplaceButtonClick=function(){i.optionsPane;var e=i.searchInput.value,r=i.replaceWith.value,n=i.viewer.owner.searchModule.textSearchResults;if(""!==e&&!t.isNullOrUndefined(e)&&null!=i.viewer.owner.selection){var o=i.viewer.owner.selection.text;if(i.viewer.owner.selection.isEmpty||(i.viewer.owner.selection.isForward?i.viewer.owner.selection.selectContent(i.viewer.owner.selection.start,!0):i.viewer.owner.selection.selectContent(i.viewer.owner.selection.end,!0)),t.isNullOrUndefined(n)||t.isNullOrUndefined(n.currentSearchResult))i.messageDiv.style.display="block",i.messageDiv.innerHTML=i.localeValue.getConstant(i.matchDivReplaceText);else{var a=n.currentSearchResult;if(i.viewer.owner.searchModule.navigate(a),a.text===o){var s=t.isNullOrUndefined(r)?"":r;i.viewer.owner.searchModule.replace(s,a,n);var l=i.viewer.owner.searchModule.textSearch.stringToRegex(e,i.findOption),d=i.viewer.selection.end.getHierarchicalIndexInternal();i.viewer.owner.searchModule.textSearchResults=i.viewer.owner.searchModule.textSearch.findAll(l,i.findOption,d),i.results=i.viewer.owner.searchModule.textSearchResults,t.isNullOrUndefined(i.results)||t.isNullOrUndefined(i.results.currentSearchResult)?(i.messageDiv.style.display="block",i.messageDiv.innerHTML=i.localeValue.getConstant(i.matchDivReplaceText)):i.viewer.owner.searchModule.navigate(i.results.currentSearchResult),i.viewer.owner.findResultsList=[],!t.isNullOrUndefined(i.results)&&i.results.innerList.length>0?i.navigateSearchResult():i.resultsListBlock.innerHTML=""}}}},this.onReplaceAllButtonClick=function(){i.replaceAll(),i.resultsListBlock.style.display="none",i.messageDiv.innerHTML=""},this.searchIconClickInternal=function(){var e=document.getElementById(i.viewer.owner.containerId+"_option_search_text_box"),t=e.value;if(""!==t){if(i.searchIcon.classList.contains("e-de-op-search-close-icon"))return i.searchIcon.classList.add("e-de-op-search-icon"),i.searchIcon.classList.remove("e-de-op-search-close-icon"),e.value="",i.messageDiv.innerHTML=i.localeValue.getConstant("No matches"),i.resultContainer.style.display="block",i.resultsListBlock.style.display="none",i.matchDiv.style.display="none",i.occurrenceDiv.style.display="none",i.onEnableDisableReplaceButton(),i.clearFocusElement(),i.resultsListBlock.innerHTML="",i.clearSearchResultItems(),i.viewer.owner.searchModule.clearSearchHighlight(),void i.viewer.renderVisiblePages();i.searchIcon.classList.contains("e-de-op-search-icon")&&t.length>=1&&(i.searchIcon.classList.add("e-de-op-search-close-icon"),i.searchIcon.classList.remove("e-de-op-search-icon"),i.onEnableDisableReplaceButton()),i.clearSearchResultItems(),i.viewer.owner.searchModule.clearSearchHighlight();var r=i.viewer.owner.searchModule.textSearch.stringToRegex(t,i.findOption),n=i.viewer.selection.end.getHierarchicalIndexInternal();if(i.results=i.viewer.owner.searchModule.textSearch.findAll(r,i.findOption,n),null!=i.results&&i.results.length>0){i.navigateSearchResult(),i.getMessageDivHeight();var o=i.viewer.owner.getDocumentEditorElement().offsetHeight-215;i.resultsListBlock.style.height=o+"px"}else i.messageDiv.innerHTML=i.localeValue.getConstant("No matches"),i.resultContainer.style.display="block",i.resultsListBlock.style.display="none",i.clearFocusElement(),i.resultsListBlock.innerHTML=""}},this.navigateNextResultButtonClick=function(){if(null!=document.getElementById(i.viewer.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(i.viewer.owner.containerId+"_list_box_container").style.display){if(i.results.currentIndex<i.results.length-1){i.results.currentIndex=i.results.currentIndex+1;n=i.results.innerList[i.results.currentIndex];i.messageDiv.innerHTML=i.localeValue.getConstant("Result")+" "+(i.results.currentIndex+1)+" "+i.localeValue.getConstant("of")+" "+i.resultsListBlock.children.length;for(var e=0;e<i.resultsListBlock.children.length;e++){var t=i.resultsListBlock.children[e];t.classList.contains("e-de-search-result-hglt")&&(t.classList.remove("e-de-search-result-hglt"),t.children[0].classList.remove("e-de-op-search-word-text"),t.classList.add("e-de-search-result-item"))}var r=i.resultsListBlock.children[i.results.currentIndex];r.classList.contains("e-de-search-result-item")&&(r.classList.remove("e-de-search-result-item"),r.classList.add("e-de-search-result-hglt"),r.children[0].classList.add("e-de-op-search-word-text"),i.scrollToPosition(r)),i.viewer.owner.searchModule.navigate(n),i.viewer.owner.searchModule.highlight(i.results)}else{var n=i.results.innerList[0];i.results.currentIndex=0,i.messageDiv.innerHTML=i.localeValue.getConstant("Result")+" "+(i.results.currentIndex+1)+" "+i.localeValue.getConstant("of")+" "+i.resultsListBlock.children.length;for(var o=0;o<i.resultsListBlock.children.length;o++){var a=i.resultsListBlock.children[o];a.classList.contains("e-de-search-result-hglt")&&(a.classList.remove("e-de-search-result-hglt"),a.children[0].classList.remove("e-de-op-search-word-text"),a.classList.add("e-de-search-result-item"))}var s=i.resultsListBlock.children[i.results.currentIndex];s.classList.contains("e-de-search-result-item")&&(s.classList.remove("e-de-search-result-item"),s.classList.add("e-de-search-result-hglt"),s.children[0].classList.add("e-de-op-search-word-text"),i.scrollToPosition(s)),i.viewer.owner.searchModule.navigate(n),i.viewer.owner.searchModule.highlight(i.results)}i.focusedIndex=i.focusedElement.indexOf(i.navigateToNextResult)}},this.navigatePreviousResultButtonClick=function(){if(null!=document.getElementById(i.viewer.owner.containerId+"_list_box_container")&&"none"!==document.getElementById(i.viewer.owner.containerId+"_list_box_container").style.display){if(0===i.results.currentIndex){i.results.currentIndex=i.results.length-1,i.messageDiv.innerHTML=i.localeValue.getConstant("Result")+" "+i.results.length+" "+i.localeValue.getConstant("of")+" "+i.resultsListBlock.children.length;for(var e=0;e<i.resultsListBlock.children.length;e++)(n=i.resultsListBlock.children[e]).classList.contains("e-de-search-result-hglt")&&(n.classList.remove("e-de-search-result-hglt"),n.children[0].classList.remove("e-de-op-search-word-text"),n.classList.add("e-de-search-result-item"));var t=i.resultsListBlock.children[i.results.currentIndex];t.classList.contains("e-de-search-result-item")&&(t.classList.remove("e-de-search-result-item"),t.classList.add("e-de-search-result-hglt"),t.children[0].classList.add("e-de-op-search-word-text"),i.scrollToPosition(t));a=i.results.innerList[i.results.currentIndex];i.viewer.owner.searchModule.navigate(a),i.viewer.owner.searchModule.highlight(i.results)}else{i.messageDiv.innerHTML=i.localeValue.getConstant("Result")+" "+i.results.currentIndex+" "+i.localeValue.getConstant("of")+" "+i.resultsListBlock.children.length,i.results.currentIndex=i.results.currentIndex-1;for(var r=0;r<i.resultsListBlock.children.length;r++){var n=i.resultsListBlock.children[r];n.classList.contains("e-de-search-result-hglt")&&(n.classList.remove("e-de-search-result-hglt"),n.children[0].classList.remove("e-de-op-search-word-text"),n.classList.add("e-de-search-result-item"))}var o=i.resultsListBlock.children[i.results.currentIndex];o.classList.contains("e-de-search-result-item")&&(o.classList.remove("e-de-search-result-item"),o.classList.add("e-de-search-result-hglt"),o.children[0].classList.add("e-de-op-search-word-text"),i.scrollToPosition(o));var a=i.results.innerList[i.results.currentIndex];i.viewer.owner.searchModule.navigate(a),i.viewer.owner.searchModule.highlight(i.results)}i.focusedIndex=i.focusedElement.indexOf(i.navigateToPreviousResult)}},this.onKeyDown=function(e){var t=e.which||e.keyCode;13===t&&9!==e.keyCode&&40!==e.keyCode?(e.preventDefault(),i.findDiv.style.height="",i.onKeyDownInternal()):8===t&&0===i.searchInput.value.length?i.resultContainer.style.display="block":9!==e.keyCode&&40!==e.keyCode&&27!==e.keyCode?(i.viewer.owner.searchModule.clearSearchHighlight(),i.clearSearchResultItems(),i.viewer.renderVisiblePages(),i.resultsListBlock.style.display="none",i.messageDiv.innerHTML=i.localeValue.getConstant("No matches"),i.resultContainer.style.display="none",i.clearFocusElement(),i.resultsListBlock.innerHTML="",i.searchIcon.classList.contains("e-de-op-search-close-icon")&&(i.searchIcon.classList.add("e-de-op-search-icon"),i.searchIcon.classList.remove("e-de-op-search-close-icon"))):27===t&&27===e.keyCode&&i.showHideOptionsPane(!1)},this.close=function(){i.clearFocusElement(),i.showHideOptionsPane(!1),i.resultsListBlock.innerHTML="",i.focusedIndex=1,i.isOptionsPane=!0},this.resultListBlockClick=function(e){for(var t=e.target,r=i.resultsListBlock.children,n=0,o=0;o<r.length;o++){var a=r[o];a.classList.contains("e-de-search-result-hglt")&&(a.classList.remove("e-de-search-result-hglt"),a.children[0].classList.remove("e-de-op-search-word-text"),a.classList.add("e-de-search-result-item"))}for(var s,o=0;o<r.length;o++)t===r[o]&&(n=o,(s=r[o]).classList.contains("e-de-search-result-item")&&(s.classList.remove("e-de-search-result-item"),s.classList.add("e-de-search-result-hglt"),s.children[0].classList.add("e-de-op-search-word-text"),i.focusedIndex=i.focusedElement.indexOf(s)));var l=i.results.innerList[n];i.results.currentIndex=n,i.messageDiv.innerHTML=i.localeValue.getConstant("Result")+" "+(n+1)+" "+i.localeValue.getConstant("of")+" "+i.resultsListBlock.children.length,i.viewer.owner.searchModule.navigate(l),i.viewer.owner.searchModule.highlight(i.results),s.focus()},this.viewer=e}return e.prototype.getModuleName=function(){return"OptionsPane"},e.prototype.initOptionsPane=function(e){this.viewer;this.localeValue=e,this.optionsPane=t.createElement("div",{className:"e-de-op",styles:"display:none;"}),this.optionsPane.addEventListener("keydown",this.onKeyDownOnOptionPane),this.searchDiv=t.createElement("div",{className:this.viewer.owner.containerId+"_searchDiv e-de-op-header",innerHTML:e.getConstant(this.searchText)}),this.optionsPane.appendChild(this.searchDiv),this.closeButton=t.createElement("button",{className:"e-de-op-close-button e-de-op-icon-btn e-btn e-flat e-icon-btn",id:"close"}),this.optionsPane.appendChild(this.closeButton);var i=t.createElement("span",{className:"e-de-op-close-icon e-btn-icon e-icons"});this.closeButton.appendChild(i),this.focusedElement.push(this.closeButton),this.findTab=t.createElement("div",{id:this.viewer.owner.containerId+"_findTabDiv",className:"e-de-op-tab"}),this.optionsPane.appendChild(this.findTab);var n=t.createElement("div",{className:"e-tab-header"});this.findTab.appendChild(n),this.findTabButton=t.createElement("div",{innerHTML:e.getConstant(this.findPaneText)}),this.focusedElement.push(this.findTabButtonHeader),n.appendChild(this.findTabButton),this.replaceTabButton=t.createElement("div",{innerHTML:e.getConstant(this.replacePaneText)}),this.focusedElement.push(this.replaceTabButtonHeader),n.appendChild(this.replaceTabButton);var a=t.createElement("div",{className:"e-content"}),s=t.createElement("div",{id:"findTabContent"});a.appendChild(s),this.findTabContentDiv=t.createElement("div",{className:"e-de-search-tab-content"}),this.searchTextBoxContainer=t.createElement("div",{className:"e-input-group e-de-op-input-group"}),this.findTabContentDiv.appendChild(this.searchTextBoxContainer),this.searchInput=t.createElement("input",{className:"e-input e-de-search-input",id:this.viewer.owner.containerId+"_option_search_text_box",attrs:{placeholder:"Search for"},styles:"font-size:14px;"}),this.searchTextBoxContainer.appendChild(this.searchInput),this.searchIcon=t.createElement("span",{className:"e-de-op-icon e-de-op-search-icon e-input-group-icon e-icon",id:this.viewer.owner.containerId+"_search-icon"}),this.searchIcon.tabIndex=0,this.searchTextBoxContainer.appendChild(this.searchIcon),this.focusedElement.push(this.searchIcon),this.navigateToPreviousResult=t.createElement("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-up e-spin-up e-btn-icon e-icon e-input-group-icon"}),this.navigateToPreviousResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToPreviousResult),this.focusedElement.push(this.navigateToPreviousResult),this.navigateToNextResult=t.createElement("span",{className:"e-de-op-icon e-de-op-nav-btn e-arrow-down e-spin-down e-btn-icon e-icon e-input-group-icon"}),this.navigateToNextResult.tabIndex=0,this.searchTextBoxContainer.appendChild(this.navigateToNextResult),this.focusedElement.push(this.navigateToNextResult);var l=t.createElement("div",{className:"e-de-op-more-less"});this.matchInput=t.createElement("input",{attrs:{type:"checkbox"},id:this.viewer.owner.containerId+"_matchCase"}),l.appendChild(this.matchInput),this.matchCase=new o.CheckBox({label:"Match case",checked:!1,change:this.matchChange}),this.matchCase.appendTo(this.matchInput),this.focusedElement.push(this.matchInput),this.matchInput.tabIndex=0,this.wholeInput=t.createElement("input",{attrs:{type:"checkbox"},id:this.viewer.owner.containerId+"_wholeWord"}),l.appendChild(this.wholeInput),this.wholeWord=new o.CheckBox({label:"Whole words",checked:!1,change:this.wholeWordsChange}),this.wholeWord.appendTo(this.wholeInput),this.focusedElement.push(this.wholeInput),this.wholeInput.tabIndex=0,this.findTabContentDiv.appendChild(l);var d=t.createElement("div");a.appendChild(d),this.replaceTabContentDiv=t.createElement("div",{className:"e-de-op-replacetabcontentdiv",styles:"display:none;"}),a.appendChild(this.replaceTabContentDiv),this.findTabContentDiv.appendChild(this.replaceTabContentDiv),this.createReplacePane(),this.findDiv=t.createElement("div",{className:"findDiv",styles:"height:250px;display:block;"}),s.appendChild(this.findTabContentDiv),this.resultContainer=t.createElement("div",{styles:"width:85%;display:block;",className:"e-de-op-result-container"}),this.findDiv.appendChild(this.resultContainer),this.messageDiv=t.createElement("div",{className:this.viewer.owner.containerId+"_messageDiv e-de-op-msg",innerHTML:this.localeValue.getConstant(this.messageDivText),id:this.viewer.owner.containerId+"_search_status"}),this.resultContainer.appendChild(this.messageDiv),this.resultsListBlock=t.createElement("div",{id:this.viewer.owner.containerId+"_list_box_container",styles:"display:none;width:270px;list-style:none;padding-right:5px;overflow:auto;",className:"e-de-result-list-block"}),this.findDiv.appendChild(this.resultsListBlock),this.findTabContentDiv.appendChild(this.findDiv),this.findTab.appendChild(a),this.tabInstance=new r.Tab({selected:this.selectedTabItem}),this.tabInstance.appendTo(this.findTab);var h=this.tabInstance.element.getElementsByClassName("e-item e-toolbar-item")[0];this.findTabButtonHeader=h.getElementsByClassName("e-tab-wrap")[0],this.findTabButtonHeader.classList.add("e-de-op-find-tab-header"),this.findTabButtonHeader.tabIndex=0;var c=this.tabInstance.element.getElementsByClassName("e-item e-toolbar-item")[1];this.replaceTabButtonHeader=c.getElementsByClassName("e-tab-wrap")[0],this.replaceTabButtonHeader.classList.add("e-de-op-replace-tab-header"),this.replaceTabButtonHeader.tabIndex=0,this.onWireEvents()},e.prototype.createReplacePane=function(){this.replaceDiv=t.createElement("div"),this.replaceTabContentDiv.appendChild(this.replaceDiv),this.replaceWith=t.createElement("input",{className:"e-de-op-replacewith e-input",styles:"font-size:14px;",attrs:{placeholder:"Replace with"}}),this.replaceDiv.appendChild(this.replaceWith);var e=t.createElement("div",{styles:"text-align:right;",className:"e-de-op-dlg-footer"});this.replaceDiv.appendChild(e),this.replaceButton=t.createElement("button",{className:"e-control e-btn e-flat e-replace",styles:"font-size:12px;margin-right:10px;",innerHTML:this.localeValue.getConstant(this.replaceButtonText)}),e.appendChild(this.replaceButton),this.replaceAllButton=t.createElement("button",{className:"e-control e-btn e-flat e-replaceall",styles:"font-size:12px;",innerHTML:this.localeValue.getConstant(this.replaceAllButtonText)}),e.appendChild(this.replaceAllButton),this.matchDiv=t.createElement("div",{styles:"display:none;padding-top:10px;"}),this.replaceDiv.appendChild(this.matchDiv);var i=t.createElement("div",{className:"e-de-op-search-replacediv"});this.replaceDiv.appendChild(i),this.occurrenceDiv=t.createElement("div",{styles:"display:none;"}),this.replaceDiv.appendChild(this.occurrenceDiv)},e.prototype.navigateSearchResult=function(){this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.viewer.owner.searchModule.highlight(this.results),this.viewer.owner.searchModule.addFindResultView(this.results),this.resultsListBlock.style.display="block",this.resultContainer.style.display="block";for(var e=this.viewer.owner.findResultsList,t="",i=0;i<e.length;i++)t+=e[i];this.clearFocusElement(),this.resultsListBlock.innerHTML=t;for(i=0;i<this.resultsListBlock.children.length;i++)this.focusedElement.push(this.resultsListBlock.children[i]);var r=this.results.currentIndex;this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(r+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var n=this.resultsListBlock.children[r];n.classList.contains("e-de-search-result-item")&&(n.classList.remove("e-de-search-result-item"),n.classList.add("e-de-search-result-hglt"),n.children[0].classList.add("e-de-op-search-word-text"),this.scrollToPosition(n))},e.prototype.onKeyDownInternal=function(){var e=document.getElementById(this.viewer.owner.containerId+"_option_search_text_box");e.blur();var i=e.value;if(""!==i){i.length>=1&&this.searchIcon.classList.contains("e-de-op-search-icon")&&(this.searchIcon.classList.add("e-de-op-search-close-icon"),this.searchIcon.classList.remove("e-de-op-search-icon"));var r=this.viewer.owner.getDocumentEditorElement().offsetHeight-215;this.clearSearchResultItems(),this.viewer.owner.searchModule.clearSearchHighlight();var n=this.viewer.owner.searchModule.textSearch.stringToRegex(i,this.findOption),o=this.viewer.selection.end.getHierarchicalIndexInternal();this.results=this.viewer.owner.searchModule.textSearch.findAll(n,this.findOption,o);var a=this.results;if(t.isNullOrUndefined(a)&&this.viewer.renderVisiblePages(),null!=a&&a.length>0){-1===this.focusedElement.indexOf(this.navigateToPreviousResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToPreviousResult),-1===this.focusedElement.indexOf(this.navigateToNextResult)&&this.isOptionsPane&&this.focusedElement.push(this.navigateToNextResult),this.viewer.owner.searchModule.navigate(this.results.innerList[this.results.currentIndex]),this.viewer.owner.searchModule.highlight(a),this.viewer.owner.searchModule.addFindResultView(a),this.resultsListBlock.style.display="block",this.resultsListBlock.style.height=r+"px",this.resultContainer.style.display="block";var s=this.viewer.owner.findResultsList,l="";this.clearFocusElement(),this.resultsListBlock.innerHTML="";for(d=0;d<s.length;d++)l+=s[d];this.resultsListBlock.innerHTML=l;for(var d=0;d<this.resultsListBlock.children.length;d++)this.focusedElement.push(this.resultsListBlock.children[d]);this.resultsListBlock.children;var h=this.results.currentIndex;this.messageDiv.innerHTML=this.localeValue.getConstant("Result")+" "+(h+1)+" "+this.localeValue.getConstant("of")+" "+this.resultsListBlock.children.length;var c=this.resultsListBlock.children[h];c.classList.contains("e-de-search-result-item")&&(c.classList.remove("e-de-search-result-item"),c.classList.add("e-de-search-result-hglt"),c.children[0].classList.add("e-de-op-search-word-text")),this.navigateToNextResult.focus(),this.focusedIndex=6,this.getMessageDivHeight()}else this.messageDiv.innerHTML=this.localeValue.getConstant("No matches"),this.resultContainer.style.display="block",this.resultsListBlock.style.display="none",this.clearFocusElement(),this.resultsListBlock.innerHTML=""}},e.prototype.getMessageDivHeight=function(){!this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-msg")?(this.messageDiv.classList.add("e-de-op-replace-messagediv"),this.messageDiv.classList.remove("e-de-op-msg")):this.isOptionsPane&&this.messageDiv.classList.contains("e-de-op-replace-messagediv")&&(this.messageDiv.classList.add("e-de-op-msg"),this.messageDiv.classList.remove("e-de-op-replace-messagediv"))},e.prototype.replaceAll=function(){this.optionsPane;var e=this.searchInput.value,i=this.replaceWith.value;if(""!==e&&!t.isNullOrUndefined(e)){var r=this.viewer.owner.searchModule.textSearch.stringToRegex(e,this.findOption),n=this.viewer.selection.end.getHierarchicalIndexInternal(),o=this.viewer.owner.searchModule.textSearch.findAll(r,this.findOption,n),a=t.isNullOrUndefined(i)?"":i,s=t.isNullOrUndefined(o)?0:o.length;this.viewer.owner.searchModule.replaceAll(a,o),this.matchDiv.style.display="block",this.matchDiv.innerHTML=this.localeValue.getConstant("All Done")+"!",this.occurrenceDiv.style.display="block",this.occurrenceDiv.innerHTML=this.localeValue.getConstant("We replaced all")+" "+s+" "+this.localeValue.getConstant("instances")+" "+this.localeValue.getConstant("of")+' "'+e+'" '+this.localeValue.getConstant("with")+' "'+i+'" '}},e.prototype.scrollToPosition=function(e){var t,i=e.getBoundingClientRect();i.top>0?(t=i.top-e.parentElement.getBoundingClientRect().top,e.parentElement.offsetHeight-t<=e.offsetHeight?(Math.ceil(t+e.offsetHeight)===e.parentElement.scrollHeight&&(e.parentElement.scrollTop=t),e.parentElement.scrollTop=e.parentElement.scrollTop+e.parentElement.offsetHeight/100*30):t<0&&(e.parentElement.scrollTop=e.parentElement.scrollTop-e.parentElement.offsetHeight/100*30)):e.parentElement.scrollTop=0},e.prototype.clearFocusElement=function(){for(var e=0;e<this.resultsListBlock.children.length;e++){var t=this.focusedElement.indexOf(this.resultsListBlock.children[e]);-1!==t&&this.focusedElement.splice(t,1)}this.focusedIndex=0},e.prototype.showHideOptionsPane=function(e){if(!t.isNullOrUndefined(this.viewer.owner.selectionModule))if(e){this.localeValue=new t.L10n("documenteditor",this.viewer.owner.defaultLocale),this.localeValue.setLocale(this.viewer.owner.locale),t.setCulture(this.viewer.owner.locale),t.isNullOrUndefined(this.optionsPane)&&(this.initOptionsPane(this.localeValue),this.viewer.optionsPaneContainer.setAttribute("style","display:inline-flex"),this.viewer.optionsPaneContainer.insertBefore(this.viewer.owner.optionsPaneModule.optionsPane,this.viewer.viewerContainer)),this.optionsPane.style.display="block",this.viewer.owner.isReadOnlyMode?this.tabInstance.hideTab(1):this.tabInstance.hideTab(1,!1),this.isReplace&&!this.viewer.owner.isReadOnlyMode?(this.tabInstance.select(1),this.isReplace=!1,this.isOptionsPane=!1):this.tabInstance.select(0),this.searchDiv.innerHTML=this.localeValue.getConstant(this.searchText),this.isOptionsPaneShow=!0;var i=document.getElementById(this.viewer.owner.getDocumentEditorElement().id+"_option_search_text_box"),r=this.viewer.owner.selection.text;if(!t.isNullOrUndefined(r)){var n=["\v","\r"],o=W.indexOfAny(r,n);r=o<0?r:r.substring(0,o)}i.value=r,i.select(),this.messageDiv.innerHTML="",this.searchIcon.classList.contains("e-de-op-search-close-icon")&&(this.searchIcon.classList.add("e-de-op-search-icon"),this.searchIcon.classList.remove("e-de-op-search-close-icon")),this.viewer.selection.caret.style.display="none",this.focusedIndex=3,this.focusedElement=[],this.isOptionsPane?this.focusedElement.push(this.closeButton,this.findTabButtonHeader,this.replaceTabButtonHeader,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput):this.focusedElement.push(this.closeButton,this.findTabButtonHeader,this.replaceTabButtonHeader,this.searchInput,this.searchIcon,this.navigateToPreviousResult,this.navigateToNextResult,this.matchInput,this.wholeInput,this.replaceWith,this.replaceButton,this.replaceAllButton),this.viewer.updateViewerSize()}else{if(!t.isNullOrUndefined(this.optionsPane)){this.clearSearchResultItems(),this.viewer.owner.searchModule.clearSearchHighlight(),this.isOptionsPaneShow=!1;var a=document.getElementById(this.viewer.owner.containerId+"_list_box_container"),s=document.getElementById(this.viewer.owner.containerId+"_search_status");t.isNullOrUndefined(a)||t.isNullOrUndefined(s)||(a.style.display="none",this.clearFocusElement(),a.innerHTML="",s.innerHTML=this.localeValue.getConstant("No matches"))}this.viewer.updateViewerSize(),t.isNullOrUndefined(this.optionsPane)||"none"!==this.optionsPane.style.display&&(this.viewer.selection.updateCaretPosition(),this.optionsPane.style.display="none"),this.viewer.updateFocus(),this.viewer.selection.caret.style.display="block"}},e.prototype.clearSearchResultItems=function(){t.isNullOrUndefined(this.viewer.owner.findResultsList)||(this.viewer.owner.findResultsList=[])},e.prototype.destroy=function(){this.optionsPane&&(this.optionsPane.innerHTML="",this.optionsPane=void 0),this.resultsListBlock&&(this.resultsListBlock.innerHTML="",this.resultsListBlock=void 0),this.messageDiv&&(this.messageDiv.innerHTML="",this.messageDiv=void 0),this.resultContainer&&(this.resultContainer.innerHTML=""),this.resultContainer=void 0,this.searchInput&&(this.searchInput.value="",this.searchInput=void 0),this.searchDiv&&(this.searchDiv.innerHTML="",this.searchDiv=void 0),this.searchTextBoxContainer&&(this.searchTextBoxContainer.innerHTML="",this.searchTextBoxContainer=void 0),this.replaceWith&&(this.replaceWith.innerHTML="",this.replaceWith=void 0),this.findDiv&&(this.findDiv.innerHTML="",this.findDiv=void 0),this.replaceButton&&(this.replaceButton.innerHTML="",this.replaceButton=void 0),this.replaceAllButton&&(this.replaceAllButton.innerHTML="",this.replaceAllButton=void 0),this.matchInput&&(this.matchInput.innerHTML="",this.matchCase=void 0),this.wholeInput&&(this.wholeInput.innerHTML="",this.wholeWord=void 0),t.isNullOrUndefined(this.results)||this.results.destroy(),this.focusedElement&&(this.focusedElement=[]),this.focusedElement=void 0,this.destroyInternal()},e.prototype.destroyInternal=function(){this.searchText&&(this.searchText=void 0),this.resultsText&&(this.resultsText=void 0),this.messageDivText&&(this.messageDivText=void 0),this.replaceButtonText&&(this.replaceButtonText=void 0),this.replaceAllButtonText&&(this.replaceAllButtonText=void 0)},e}(),De=function(){function e(e){this.resizeNode=0,this.resizerPosition=0,this.currentResizingTable=void 0,this.owner=e,this.startingPoint=new T(0,0)}return Object.defineProperty(e.prototype,"viewer",{get:function(){return this.owner.viewer},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableResizer"},e.prototype.updateResizingHistory=function(e){this.owner.editorHistory&&this.owner.editorHistory.updateResizingHistory(e,this),this.viewer.isRowOrCellResizing=!1,this.resizerPosition=-1},e.prototype.handleResize=function(e){this.owner.viewer.isRowOrCellResizing=!0,this.startingPoint.x=e.x,this.startingPoint.y=e.y,this.owner.editorHistory.initResizingHistory(e,this)},e.prototype.isInRowResizerArea=function(e){var t=this.getRowReSizerPosition(void 0,e);return-1!==t&&(this.resizeNode=1,this.resizerPosition=t,!0)},e.prototype.isInCellResizerArea=function(e){var t=this.getCellReSizerPosition(e);return-1!==t&&(this.resizeNode=0,this.resizerPosition=t,!0)},e.prototype.getCellReSizerPosition=function(e){var i=-1,r=this.getTableWidget(e),n=this.getTableCellWidget(e),o=t.isNullOrUndefined(r)?0:r.tableFormat.cellSpacing;if(r&&o>0){if(this.currentResizingTable=r,this.viewer.isInsideRect(r.x-W.convertPointToPixel(r.leftBorderWidth)-.25,r.y,W.convertPointToPixel(r.leftBorderWidth)+.5,r.height,e))return i=0;for(var a=r.x,s=0;s<r.tableHolder.columns.length;s++){var l=W.convertPointToPixel(r.tableHolder.columns[s].preferredWidth);if(this.viewer.isInsideRect(a-1,r.y,r.leftBorderWidth+2,r.height,e))return i=s>0?s:0;if(s>0&&this.viewer.isInsideRect(a+l-1,r.y,2,r.height,e))return i=s+1;a+=l}}else if(!t.isNullOrUndefined(n)){if(this.currentResizingTable=n.ownerTable,this.viewer.isInsideRect(n.x-n.margin.left-1,n.y-n.margin.top,2,n.height,e))return i=n.columnIndex;if(t.isNullOrUndefined(n.nextRenderedWidget)&&this.viewer.isInsideRect(n.x+n.margin.right+n.width-1,n.y-n.margin.top,2,n.height,e))return i=n.columnIndex+n.cellFormat.columnSpan;if(n.childWidgets.length>0)return this.getCellReSizerPositionInternal(n,e)}return i},e.prototype.getCellReSizerPositionInternal=function(e,i){var r=-1,n=this.getTableWidgetFromWidget(i,e),o=void 0;if(!t.isNullOrUndefined(n)&&n.tableFormat.cellSpacing>0){if(this.currentResizingTable=n,this.viewer.isInsideRect(n.x-n.leftBorderWidth-.25,n.y,n.leftBorderWidth+.5,n.height,i))return r=0;for(var a=n.x,s=0;s<n.tableHolder.columns.length;s++){var l=W.convertPointToPixel(n.tableHolder.columns[s].preferredWidth);if(this.viewer.isInsideRect(a-1,n.y,n.leftBorderWidth+2,n.height,i))return r=s>0?s:0;if(s>0&&this.viewer.isInsideRect(a+l-1,n.y,2,n.height,i))return r=s+1;a+=l}}else if(t.isNullOrUndefined(n)||(o=n.getTableCellWidget(i)),!t.isNullOrUndefined(o)){if(this.currentResizingTable=o.ownerTable,this.viewer.isInsideRect(o.x-o.margin.left-1,o.y-o.margin.top,2,o.height,i))return r=o.columnIndex;if(t.isNullOrUndefined(o.nextRenderedWidget)&&this.viewer.isInsideRect(o.x+o.margin.right+o.width-1,o.y-o.margin.top,2,o.height,i))return r=o.columnIndex+o.cellFormat.columnSpan;if(o.childWidgets.length>0)return this.getCellReSizerPositionInternal(o,i)}return r},e.prototype.getRowReSizerPosition=function(e,i){var r=void 0,n=void 0;t.isNullOrUndefined(e)?(r=this.getTableWidget(i),n=this.getTableCellWidget(i)):r=this.getTableWidgetFromWidget(i,e);var o=t.isNullOrUndefined(r)?0:r.tableFormat.cellSpacing;if(r&&o>0){if(this.currentResizingTable=r,this.owner.viewer.isInsideRect(r.x,r.y+r.height-o,this.getActualWidth(r.lastChild),t.isNullOrUndefined(r.nextSplitWidget)?r.bottomBorderWidth+o:0,i))return r.lastChild.rowIndex;for(var a=0;a<r.childWidgets.length;a++){var s=r.childWidgets[a];if(r.childWidgets.indexOf(s)>-1&&this.owner.viewer.isInsideRect(s.x,s.y+s.height+o/2,this.getActualWidth(s),o/2,i))return s.rowIndex}}else if(r&&n&&(n=this.getTableCellWidget(i)),n){var l=0;if(l=(s=n.containerWidget).rowIndex===s.ownerTable.childWidgets.length-1?s.bottomBorderWidth+2:s.nextRenderedWidget.topBorderWidth+2,this.owner.viewer.isInsideRect(s.x,s.y+s.height-l,s.width,2*l,i))return this.currentResizingTable=s.ownerTable,s.rowIndex;if(n.childWidgets.length>0)return this.getRowReSizerPosition(n,i)}return-1},e.prototype.handleResizing=function(e){var t=0;0===this.resizeNode?(t=e.x-this.startingPoint.x,this.resizeTableCellColumn(t)):(t=e.y-this.startingPoint.y,this.resizeTableRow(t))},e.prototype.resizeTableRow=function(e){var i=this.currentResizingTable;if(!t.isNullOrUndefined(i)&&0!==e){var r=this.owner.selection;if(i.isInsideTable&&(this.owner.isLayoutEnabled=!1),this.resizerPosition>-1){var n=i.childWidgets[this.resizerPosition];this.updateRowHeight(n,e),r.selectPosition(r.start,r.end)}if(i.isInsideTable){var o=this.owner.viewer.layout.getParentTable(i);this.owner.isLayoutEnabled=!0,i=o}this.startingPoint.y+=W.convertPointToPixel(e),this.owner.viewer.layout.reLayoutTable(i),this.owner.editorModule.reLayout(this.owner.selection)}},e.prototype.getTableWidget=function(e){var i=void 0,r=this.owner.viewer.currentPage;if(!t.isNullOrUndefined(r))for(var n=0;n<r.bodyWidgets.length;n++){var o=r.bodyWidgets[n];if(i=this.getTableWidgetFromWidget(e,o),!t.isNullOrUndefined(i))break}return i},e.prototype.getTableWidgetFromWidget=function(e,t){for(var i=0;i<t.childWidgets.length;i++)if(t.childWidgets[i]instanceof K){var r=t.childWidgets[i];if(r.y<=e.y&&r.y+r.height>=e.y)return r}},e.prototype.getTableCellWidget=function(e){var i=void 0,r=this.owner.viewer.currentPage;if(!t.isNullOrUndefined(r))for(var n=0;n<r.bodyWidgets.length&&(i=r.bodyWidgets[n].getTableCellWidget(e),t.isNullOrUndefined(i));n++);return i},e.prototype.updateRowHeight=function(e,t){var i=e.rowFormat;if("Auto"===i.heightType){i.heightType="AtLeast";var r=i.ownerBase,n=this.owner.viewer.layout.getRowHeight(r,[r]);n+t>=2.7&&i.height!==n+t&&(i.height=n+t)}else i.height+t>=2.7&&i.height!==i.height+t&&(i.height=i.height+t)},e.prototype.resizeTableCellColumn=function(e){var i=this.currentResizingTable;if(!t.isNullOrUndefined(i)&&0!==e&&!t.isNullOrUndefined(i.childWidgets)){var r=!0,n=this.owner.selection;this.owner.editor.setOffsetValue(n),i=i.combineWidget(this.viewer),this.owner.isLayoutEnabled=!1,this.setPreferredWidth(i);var o=i.getOwnerWidth(!0),a=i.leftIndent,s=i.tableFormat.tableAlignment;if(n.isEmpty||(r=this.resizeColumnWithSelection(n,i,e)),!r)return void(this.owner.isLayoutEnabled=!0);if(0===this.resizerPosition){var l=this.resizerPosition,d=i.tableHolder.columns[l],h=d.preferredWidth;if(e>0){c=e;do{if((p=W.round(d.preferredWidth-e,1))>=d.minWidth){d.preferredWidth=p,a=(a=i.leftIndent+e)>=-1440?a<=1440?a:1440:-1440;break}c=e,e+=p-d.minWidth}while(e!==c)}else{var c=e;do{var p=W.round(d.preferredWidth-e,1);if(p<=2112){d.preferredWidth=p,a=(a=i.leftIndent+e)>=-1440?a<=1440?a:1440:-1440;break}c=e,e-=p-2112}while(e!==c)}var g=e;"Left"!==s&&i.tableHolder.getTotalWidth()>o&&"Auto"===i.tableFormat.preferredWidthType&&(i.tableHolder.isFitColumns(o,i.tableHolder.tableWidth,"Auto"===i.tableFormat.preferredWidthType)?i.tableHolder.fitColumns(o,i.tableHolder.tableWidth,"Auto"===i.tableFormat.preferredWidthType):d.preferredWidth=h,g=0),"Center"===s&&(i.tableHolder.getTotalWidth()<o||"Auto"!==i.tableFormat.preferredWidthType)&&(g/=2),i.tableFormat.leftIndent="Left"===s?a:0,i.tableHolder.tableWidth=i.tableHolder.getTotalWidth(),this.updateCellPreferredWidths(i),this.updateGridValue(i,!0,g)}else if(null!==i&&this.resizerPosition===i.tableHolder.columns.length)this.resizeColumnAtLastColumnIndex(i,e,o);else{if(-1===this.resizerPosition)return void(this.owner.isLayoutEnabled=!0);this.resizeCellAtMiddle(i,e)}this.owner.isLayoutEnabled=!0,n.selectPosition(n.start,n.end)}},e.prototype.resizeColumnWithSelection=function(e,t,i){t.leftIndent;var r=this.getTableCellWidget(this.startingPoint);if(r&&(e.selectedWidgets.containsKey(r)||r.previousWidget&&e.selectedWidgets.containsKey(r.previousWidget))){var n=e.getSelectedCells();if(0===this.resizerPosition)this.resizeColumnAtStart(t,i,n);else if(null!==t&&this.resizerPosition===t.tableHolder.columns.length){for(var o=this.getColumnCells(t,this.resizerPosition,!0),a=0;a<o.length;a++){var s=o[a];-1!==n.indexOf(s)&&this.increaseOrDecreaseWidth(s,i,!0)}this.updateRowsGridAfterWidth(t),t.updateWidth(i),this.updateGridValue(t,!0,i)}else{if(-1===this.resizerPosition)return!1;var l=this.resizerPosition,o=this.getColumnCells(t,l,!0),d=this.getColumnCells(t,l,!1),h=this.isColumnSelected(t,l);if(o.length>0&&!h)for(a=0;a<o.length;a++)-1===n.indexOf(o[a])&&(o.splice(a,1),a--);if(d.length>0&&!h)for(a=0;a<d.length;a++)-1===n.indexOf(d[a])&&(d.splice(a,1),a--);if(0===o.length&&d.length>0)for(a=0;a<d.length;a++)(s=d[a]).previousWidget&&o.push(s.previousWidget);else if(0===d.length&&o.length>0)for(a=0;a<o.length;a++)(s=o[a]).nextWidget&&d.push(s.nextWidget);this.changeWidthOfCells(t,o,d,i,!0),this.updateGridValue(t,!0,i)}e.selectPosition(e.start,e.end)}return!1},e.prototype.resizeColumnAtStart=function(e,t,i){var r=e.leftIndent,n=(this.getColumnCells(e,this.resizerPosition,!1),i[0].ownerRow),o=n.rowFormat;if(o.beforeWidth>0){var a=o.beforeWidth+t;if(a>0)this.updateGridBefore(n,t);else if(a<(s=this.getLeastGridBefore(e,n))&&0!==a){r=e.leftIndent+a,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440;for(l=0;l<e.childWidgets.length;l++)n!==(d=e.childWidgets[l])&&this.updateGridBefore(d,-a)}}else if(t<0)r=e.leftIndent+t,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(e,i,t);else{var s=this.getLeastGridBefore(e,n);if(0===e.tableFormat.leftIndent)for(l=0;l<e.childWidgets.length;l++){d=e.childWidgets[l];-1!==i.indexOf(d.childWidgets[0])&&(this.updateGridBefore(d,t),this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1))}else if(s-t>0)r=e.leftIndent+t,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440,this.updateWidthForCells(e,i,t);else{r=e.leftIndent+s,e.tableFormat.leftIndent=r>=-1440?r<=1440?r:1440:-1440;for(var l=0;l<e.childWidgets.length;l++){var d=e.childWidgets[l];-1!==i.indexOf(d.childWidgets[0])?(this.increaseOrDecreaseWidth(d.childWidgets[0],t,!1),this.updateGridBefore(d,t-s)):this.updateGridBefore(d,-s)}}}this.updateGridValue(e,!0,t)},e.prototype.updateWidthForCells=function(e,t,i){for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];-1!==t.indexOf(n.childWidgets[0])?this.increaseOrDecreaseWidth(n.childWidgets[0],i,!1):this.updateGridBefore(n,-i)}},e.prototype.resizeColumnAtLastColumnIndex=function(e,t,i){for(var r=e.tableFormat.tableAlignment,n=e.tableFormat.preferredWidth,o=this.resizerPosition,a=e.tableHolder.columns[o-1],s=0;t!==s;){var l=W.round(a.preferredWidth+t,1);l>=a.minWidth?(a.preferredWidth=l,s=t):(s=t,t-=l-a.minWidth)}this.updateCellPreferredWidths(e),(n||e.tableHolder.getTotalWidth()>i)&&(e.updateWidth(t),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth());var d=t;"Right"===r?d=0:"Center"===r&&(d/=2),this.updateGridValue(e,!0,d)},e.prototype.resizeCellAtMiddle=function(e,t){var i=this.resizerPosition,r=e.tableHolder.columns[i-1],n=e.tableHolder.columns[i];if(t>0)for(o=!0;o;)(a=W.round(n.preferredWidth-t,1))>=n.minWidth?(n.preferredWidth=a,r.preferredWidth=r.preferredWidth+t,o=!1):t+=a-n.minWidth;else for(var o=!0;o;){var a=W.round(r.preferredWidth+t,1);a>=r.minWidth?(r.preferredWidth=a,n.preferredWidth=n.preferredWidth-t,o=!1):t-=a-r.minWidth}this.updateCellPreferredWidths(e),e.tableHolder.tableWidth=e.tableHolder.getTotalWidth(),this.updateGridValue(e,!1,t)},e.prototype.updateGridValue=function(e,t,i){if(t&&(e.calculateGrid(),e.isGridUpdated=!1),e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.owner.isLayoutEnabled=!0,e.isInsideTable){var r=this.viewer.layout.getParentTable(e);this.viewer.layout.reLayoutTable(r)}else this.viewer.layout.reLayoutTable(e);this.owner.editor.getOffsetValue(this.viewer.selection),this.owner.editorModule.reLayout(this.owner.selection),i&&(this.startingPoint.x+=W.convertPointToPixel(i),this.resizerPosition=this.getCellReSizerPosition(this.startingPoint))},e.prototype.getColumnCells=function(e,t,i){for(var r=[],n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],a=0;a<o.childWidgets.length;a++){var s=o.childWidgets[a];i?s.columnIndex+s.cellFormat.columnSpan===t&&r.push(s):s.columnIndex===t&&r.push(s)}return r},e.prototype.updateGridBefore=function(e,t){e.rowFormat.beforeWidth+t!==e.rowFormat.beforeWidth&&(e.rowFormat.beforeWidth=e.rowFormat.beforeWidth+t,e.rowFormat.gridBeforeWidth=e.rowFormat.beforeWidth)},e.prototype.getLeastGridBefore=function(e,t){for(var i=0,r=0,n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o!==t&&(0===r&&(i=o.rowFormat.beforeWidth,r++),o.rowFormat.beforeWidth<=i&&(i=o.rowFormat.beforeWidth))}return i},e.prototype.increaseOrDecreaseWidth=function(e,t,i){var r=e.cellFormat.preferredWidth;"Auto"===e.cellFormat.preferredWidthType&&(r=e.cellFormat.cellWidth,e.cellFormat.preferredWidthType="Point");var n=e.ownerColumn.minWidth;"Percent"===e.cellFormat.preferredWidthType&&(n=e.convertPointToPercent(n)),e.cellFormat.preferredWidth=i?r+t>n?r+t:n:r-t>n?r-t:n},e.prototype.changeWidthOfCells=function(e,t,i,r,n){if(t.length>0){for(var o=!1,a=0;a<t.length;a++){var s=t[a];this.increaseOrDecreaseWidth(s,r,!0),s.cellIndex===s.ownerRow.childWidgets.length-1&&(o=!0)}o&&this.updateRowsGridAfterWidth(e)}if(i.length>0){for(var l=0,a=0;a<i.length;a++){if(0===(s=i[a]).cellIndex){var d=s.ownerRow.rowFormat.beforeWidth+r;d>=0?this.updateGridBefore(s.ownerRow,r):(l!==d&&(l=d),s.ownerRow.rowFormat.gridBeforeWidth=0,s.ownerRow.rowFormat.gridBeforeWidthType="Auto")}this.increaseOrDecreaseWidth(s,r,!1)}if(0!==l){var h=e.leftIndent+l;e.tableFormat.leftIndent=h>=-1440?h<=1440?h:1440:-1440;for(var c=0;c<e.childWidgets.length;c++){var p=e.childWidgets[c];-1===i.indexOf(p.childWidgets[0])&&this.updateGridBefore(p,l>0?l:-l)}}}},e.prototype.updateRowsGridAfterWidth=function(e){for(var t=this.getMaxRowWidth(e,!0),i=0;i<e.childWidgets.length;i++){var r=e.childWidgets[i],n=this.getRowWidth(r,!0);if(t>=n&&r.rowFormat.afterWidth!==t-n){var o=t-n;r.rowFormat.gridAfterWidth=o,r.rowFormat.afterWidth=o}}},e.prototype.getRowWidth=function(e,t){var i=0;t&&(i+=e.rowFormat.beforeWidth);for(var r=0;r<e.childWidgets.length;r++)i+=e.childWidgets[r].cellFormat.cellWidth;return i},e.prototype.getMaxRowWidth=function(e,t){for(var i=0,r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r],o=0;t&&(o+=n.rowFormat.beforeWidth);for(var a=0;a<n.childWidgets.length;a++)o+=n.childWidgets[a].cellFormat.cellWidth;i<o&&(i=o)}return i},e.prototype.isColumnSelected=function(e,t){for(var i=this.owner.selection.getSelectedCells(),r=this.getColumnCells(e,t,!0),n=this.getColumnCells(e,t,!1),o=!1,a=0;a<r.length;a++){s=r[a];o=-1!==i.indexOf(s)}if(!o)for(a=0;a<n.length;a++){var s=n[a];o=-1!==i.indexOf(s)}return o},e.prototype.applyProperties=function(e,i){if(!t.isNullOrUndefined(i)){e=e,i.tableHolder&&(e.tableHolder=i.tableHolder.clone()),null!==i.tableFormat&&(e.tableFormat.leftIndent=i.tableFormat.leftIndent,e.tableFormat.preferredWidth=i.tableFormat.preferredWidth,e.tableFormat.preferredWidthType=i.tableFormat.preferredWidthType);for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r],o=i.rows[r];n.rowFormat.gridBefore=o.gridBefore,n.rowFormat.gridBeforeWidth=o.gridBeforeWidth,n.rowFormat.gridBeforeWidthType=o.gridBeforeWidthType,n.rowFormat.gridAfter=o.gridAfter,n.rowFormat.gridAfterWidth=o.gridAfterWidth,n.rowFormat.gridAfterWidthType=o.gridAfterWidthType;for(var a=0;a<n.childWidgets.length;a++){var s=n.childWidgets[a],l=o.cells[a];s.columnIndex=l.columnIndex,s.cellFormat.columnSpan=l.columnSpan,s.cellFormat.preferredWidth=l.preferredWidth,s.cellFormat.preferredWidthType=l.preferredWidthType}}var d=e.getOwnerWidth(!0),h=e.getTableClientWidth(d);e.setWidthToCells(h,"Auto"===e.tableFormat.preferredWidthType)}},e.prototype.getActualWidth=function(e){var t=0;if(e.childWidgets.length>0)for(var i=0;i<e.childWidgets.length;i++)t+=e.childWidgets[i].cellFormat.cellWidth;return t},e.prototype.setPreferredWidth=function(e){for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t],r=i.rowFormat;r.gridBefore>0&&(r.gridBeforeWidth=r.beforeWidth,r.gridBeforeWidthType="Point");for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[n];o.cellFormat.preferredWidth=o.cellFormat.cellWidth,o.cellFormat.preferredWidthType="Point"}r.gridAfter>0&&(r.gridAfterWidth=r.afterWidth,r.gridAfterWidthType="Point")}},e.prototype.updateCellPreferredWidths=function(e){for(var t=e.tableHolder.tableWidth,i="Auto"===e.tableFormat.preferredWidthType,r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n.rowFormat.gridBefore>0){var o=e.tableHolder.getCellWidth(0,n.rowFormat.gridBefore,t,i);this.updateGridBeforeWidth(o,n)}for(var a=0;a<n.childWidgets.length;a++){var s=n.childWidgets[a];s.updateWidth(e.tableHolder.getCellWidth(s.columnIndex,s.cellFormat.columnSpan,t,i))}n.rowFormat.gridAfter>0&&this.updateGridAfterWidth(e.tableHolder.getCellWidth(n.childWidgets.length,n.rowFormat.gridAfter,t,i),n)}},e.prototype.updateGridBeforeWidth=function(e,t){var i=t.rowFormat;if(e!==i.beforeWidth)if(i.beforeWidth=e,"Auto"===i.gridBeforeWidthType&&(i.gridBeforeWidthType="Point"),"Point"===i.gridBeforeWidthType)i.gridBeforeWidth=i.beforeWidth;else{var r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),n=t.ownerTable.convertPointToPercent(i.beforeWidth,r);i.gridBeforeWidth=n}},e.prototype.updateGridAfterWidth=function(e,t){var i=t.rowFormat;if(e!==i.afterWidth&&(i.afterWidth=e),"Auto"===i.gridAfterWidthType&&(i.gridAfterWidthType="Point"),"Point"===i.gridAfterWidthType)i.gridAfterWidth=i.afterWidth;else{var r=t.ownerTable.getTableClientWidth(t.ownerTable.getOwnerWidth(!0)),n=t.ownerTable.convertPointToPercent(i.afterWidth,r);i.gridAfterWidth=n}},e}(),Ae=function(){function e(e){var i=this;this.nodes=[],this.editHyperlinkInternal=!1,this.startParagraph=void 0,this.endParagraph=void 0,this.isHandledComplex=!1,this.tableResize=void 0,this.tocStyles={},this.refListNumber=void 0,this.incrementListNumber=-1,this.removedBookmarkElements=[],this.tocBookmarkId=0,this.copiedData=void 0,this.pageRefFields={},this.isInsertingTOC=!1,this.isBordersAndShadingDialog=!1,this.onTextInputInternal=function(e){if(t.Browser.isDevice){var r=i.viewer,n=new RegExp(String.fromCharCode(160),"g"),o=new RegExp(String.fromCharCode(10),"g");r.prefix=r.prefix.replace(n," ").replace(o," ");var a=(s=r.editableDiv.textContent.replace(n," ").replace(o," ")).substring(2);if(r.isCompositionStart&&r.isCompositionUpdated)return r.isCompositionUpdated=!1,void(!r.owner.isReadOnlyMode&&r.owner.isDocumentLoaded&&r.prefix.substring(2)!==a&&(i.selection.isEmpty?(i.selection.start.setPositionForLineWidget(r.selection.start.currentWidget,i.selection.start.offset-(r.prefix.length-2)),i.handleTextInput(a),r.prefix="@"+String.fromCharCode(160)+a):(i.handleTextInput(a),r.prefix="@"+String.fromCharCode(160)+a)));if(r.isCompositionStart&&r.isCompositionEnd&&""===r.suffix)return r.prefix.substring(2)!==a?i.selection.isEmpty&&r.isCompositionStart?(r.isCompositionStart=!1,i.selection.start.setPositionForLineWidget(r.selection.start.currentWidget,i.selection.start.offset-r.prefix.substring(2).length),i.selection.retrieveCurrentFormatProperties(),""!==r.suffix&&""!==a||i.handleTextInput(a)):i.selection.isEmpty||(r.isCompositionStart=!1,i.handleTextInput(a)):""===a?(r.isCompositionStart=!1,i.handleBackKey()):r.prefix.substring(2)===a&&""===r.suffix&&(r.isCompositionStart=!1,i.handleTextInput(" ")),void(r.isCompositionEnd=!1);if(r.isCompositionEnd||r.isCompositionStart&&!r.isCompositionUpdated){if(a.length<r.prefix.length&&a===r.prefix.substring(2,r.prefix.length-1)||r.editableDiv.innerText.length<2)return void i.handleBackKey();if(""!==r.suffix&&r.editableDiv.innerText[r.editableDiv.innerText.length-1]!==String.fromCharCode(160))return r.isCompositionStart=!1,i.selection.start.setPositionForLineWidget(r.selection.start.currentWidget,i.selection.start.offset-(r.prefix.length-2)),i.selection.end.setPositionForLineWidget(r.selection.end.currentWidget,i.selection.end.offset+r.suffix.length),i.selection.retrieveCurrentFormatProperties(),void i.handleTextInput(a)}"\r"===s||"\b"===s||""===s||r.owner.isReadOnlyMode||!1!==r.isControlPressed||("@"===s||"@"!==s[0]||""===s||s.length<r.prefix.length&&a===r.prefix.substring(2,r.prefix.length-1)?(i.handleBackKey(),r.editableDiv.innerText.length<2&&i.predictText()):0===s.indexOf(r.prefix)&&s.length>r.prefix.length?i.handleTextInput(s.substring(r.prefix.length)):-1===s.indexOf(r.prefix)&&s[s.length-1]!==String.fromCharCode(160)&&" "!==s[s.length-1]?(a.charAt(0).toLowerCase()+a.slice(1)===r.prefix.substring(2)&&i.selection.start.setPositionParagraph(r.selection.start.currentWidget,i.selection.start.offset-(r.prefix.length-2)),i.handleTextInput(a)):2!==s.length&&i.handleTextInput(" "))}else{var s=i.viewer.editableDiv.innerText;s!==String.fromCharCode(160)?"\r"===s||"\b"===s||""===s||i.owner.isReadOnlyMode||!1!==i.viewer.isControlPressed||i.handleTextInput(s):i.handleTextInput(" "),i.viewer.editableDiv.innerText=""}},this.onPaste=function(e){i.owner.isReadOnlyMode||i.pasteInternal(e),e.preventDefault()},this.viewer=e,this.tableResize=new De(this.viewer.owner)}return Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.viewer.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selection",{get:function(){if(this.viewer)return this.viewer.selection},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"owner",{get:function(){return this.viewer.owner},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"Editor"},e.prototype.insertField=function(e,i){var r=e;if(t.isNullOrUndefined(i)&&"MERGEFIELD"===(r=W.trimStart(r)).substring(0,10)){var n=(r=r.substring(10).trim()).indexOf("\\*");i="«"+r.substring(0,n).trim()+"»"}var o=new G,a=new J(o),s=new $(0);a.children.push(s);var l=new Q;l.text=e,a.children.push(l);var d=new $(2);d.fieldBegin=s,s.fieldSeparator=d,a.children.push(d);var h=new Q;h.text=i,a.children.push(h);var c=new $(1);c.fieldSeparator=d,c.fieldBegin=s,s.fieldEnd=c,d.fieldEnd=c,a.children.push(c),s.line=a,o.childWidgets.push(a),this.viewer.fields.push(s);var p=[];p.push(o),this.pasteContentsInternal(p)},e.prototype.applyStyle=function(e,i){(i=!t.isNullOrUndefined(i)&&i)&&(this.initComplexHistory("ApplyStyle"),this.clearFormatting());var r=this.viewer.styles.findByName(e);void 0!==r?this.onApplyParagraphFormat("styleName",r,!1,!0):(this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.viewer.preDefinedStyles.get(e)),this.viewer.styles),this.applyStyle(e)),this.editorHistory&&this.editorHistory.currentHistoryInfo&&"ApplyStyle"===this.editorHistory.currentHistoryInfo.action&&this.editorHistory.updateComplexHistory()},e.prototype.cut=function(){this.owner.isReadOnlyMode||this.selection.isEmpty||this.selection.copySelectedContent(!0)},e.prototype.fireContentChange=function(){this.viewer.owner.isLayoutEnabled&&!this.viewer.owner.isShiftingEnabled&&this.viewer.owner.fireContentChange()},e.prototype.updateSelectionTextPosition=function(e){this.getOffsetValue(this.selection),this.selection.start.updatePhysicalPosition(!0),this.selection.isEmpty?this.selection.end.setPositionInternal(this.selection.start):this.selection.end.updatePhysicalPosition(!0),this.selection.upDownSelectionLength=this.selection.end.location.x,this.selection.fireSelectionChanged(e)},e.prototype.predictText=function(){this.viewer.suffix="",this.selection.start.paragraph.isEmpty()||0===this.selection.start.offset&&this.selection.start.currentWidget.isFirstLine()||0===this.selection.end.offset&&this.selection.end.currentWidget.isFirstLine()?this.viewer.prefix="":this.getPrefixAndSuffix(),this.viewer.prefix="@"+String.fromCharCode(160)+this.viewer.prefix,this.viewer.editableDiv.innerText=this.viewer.prefix,this.viewer.selection.setEditableDivCaretPosition(this.viewer.prefix.length)},e.prototype.getPrefixAndSuffix=function(){var e=this.viewer;if(""!==this.selection.text)return void(e.prefix="");var i=0,r=this.selection.start.currentWidget.getInline(this.selection.start.offset,i),n=r.element;if(i=r.index,void 0!==n){var o=this.selection.getElementBoxInternal(n,i),a=o.element;i=o.index;var s=0;if(!t.isNullOrUndefined(a)){var l=!1;for(a instanceof Q&&i>0&&a.line.isFirstLine()&&(e.prefix=""),n instanceof Q||(n=this.selection.getPreviousTextElement(n));(s=e.prefix.lastIndexOf(" "))<0&&n instanceof Q;)if(n.previousNode instanceof Q&&-1===e.prefix.indexOf(" ")){if(l?e.prefix=n.text+e.prefix:(e.prefix=n.text.substring(0,i),l=!0),(n=n.previousNode)instanceof ne)break;n instanceof Q||(n=this.selection.getPreviousTextElement(n))}else if(!(n.previousNode instanceof Q)){l?e.prefix=n.text+e.prefix:(e.prefix=n.text.substring(0,i),l=!0);break}e.prefix.length>1&&" "===e.prefix[e.prefix.length-1]&&"."===e.prefix[e.prefix.length-2]?(s=-1,e.prefix=""):s=e.prefix.lastIndexOf(" "),e.prefix=s<0?e.prefix:e.prefix.substring(s),0===e.prefix.indexOf(" ")&&e.prefix.length>=1&&(e.prefix=e.prefix.substring(1));var d=0,h=this.selection.end.currentWidget.getInline(this.selection.end.offset,d),c=h.element;if(d=h.index,o=this.selection.getElementBoxInternal(c,d),a=o.element,d=o.index,a){var p=!1;for(a instanceof Q&&d<a.length&&(e.suffix="");(s=e.suffix.indexOf(" "))<0&&c instanceof Q;)if(c.nextNode instanceof Q&&-1===e.suffix.indexOf(" "))p?e.suffix=e.suffix+c.text:(e.suffix=a.text.substring(d),p=!0),c=c.nextNode;else if(!(c.nextNode instanceof Q)){p?e.suffix=e.suffix+c.text:(e.suffix=a.text.substring(d),p=!0);break}s=e.suffix.indexOf(" "),e.suffix=s<0?e.suffix:e.suffix.substring(0,s)}}}},e.prototype.onKeyDownInternal=function(e,t,i,r){var n=e.which||e.keyCode;if(!t||i||r)if(!i||t||r)if(i&&t&&!r)switch(n){case 68:this.owner.isReadOnlyMode||this.owner.selection.toggleUnderline("Double");break;case 77:this.owner.isReadOnlyMode||this.owner.selection.decreaseIndent(),e.preventDefault();break;case 188:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 190:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Superscript")}else if(!i&&t&&r)switch(n){case 72:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&this.toggleHighlightColor()}else switch(n){case 8:e.preventDefault(),this.handleBackKey();break;case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!0,!1);break;case 13:e.preventDefault(),this.handleEnterKey();break;case 46:this.handleDelete(),e.preventDefault()}else switch(n){case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!0);break;case 13:this.handleShiftEnter(),e.preventDefault()}else switch(this.viewer.isControlPressed=!0,n){case 9:e.preventDefault(),this.owner.acceptTab&&this.selection.handleTabKey(!1,!1);break;case 13:e.preventDefault(),this.insertPageBreak();break;case 48:e.preventDefault(),this.onApplyParagraphFormat("beforeSpacing",0,!1,!1);break;case 49:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyParagraphFormat("lineSpacing",1,!1,!1);break;case 50:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyParagraphFormat("lineSpacing",2,!1,!1);break;case 53:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyParagraphFormat("lineSpacing",1.5,!1,!1);break;case 66:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBold();break;case 68:e.preventDefault(),!this.owner.isReadOnlyMode&&this.owner.fontDialogModule&&this.owner.fontDialogModule.showFontDialog();break;case 69:this.owner.isReadOnlyMode||this.toggleTextAlignment("Center"),e.preventDefault();break;case 72:e.preventDefault(),!this.owner.isReadOnly&&this.owner.optionsPaneModule&&(this.owner.optionsPaneModule.isReplace=!0,this.owner.optionsPaneModule.showHideOptionsPane(!0));break;case 73:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleItalic();break;case 74:this.owner.isReadOnlyMode||this.toggleTextAlignment("Justify"),e.preventDefault();break;case 75:e.preventDefault(),this.owner.hyperlinkDialogModule&&!this.owner.isReadOnlyMode&&this.owner.hyperlinkDialogModule.show();break;case 76:this.owner.isReadOnlyMode||this.toggleTextAlignment("Left"),e.preventDefault();break;case 77:this.owner.isReadOnlyMode||this.owner.selection.increaseIndent(),e.preventDefault();break;case 78:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.openBlank();break;case 82:this.owner.isReadOnlyMode||this.toggleTextAlignment("Right"),e.preventDefault();break;case 85:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.selection.toggleUnderline("Single");break;case 88:e.preventDefault(),this.owner.isReadOnlyMode||this.owner.editor.cut();break;case 89:this.owner.enableEditorHistory&&(this.editorHistory.redo(),e.preventDefault());break;case 90:this.owner.enableEditorHistory&&(this.editorHistory.undo(),e.preventDefault());break;case 219:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","decrement",!0);break;case 221:e.preventDefault(),this.owner.isReadOnlyMode||this.onApplyCharacterFormat("fontSize","increment",!0);break;case 187:e.preventDefault(),this.owner.isReadOnlyMode||this.toggleBaselineAlignment("Subscript")}},e.prototype.handleShiftEnter=function(){this.owner.isReadOnlyMode||this.handleTextInput("\v"),this.selection.checkForCursorVisibility()},e.prototype.handleBackKey=function(){this.owner.isReadOnlyMode||this.owner.editorModule.onBackSpace(),this.selection.checkForCursorVisibility()},e.prototype.handleDelete=function(){this.owner.isReadOnlyMode||this.owner.editorModule.onDelete(),this.selection.checkForCursorVisibility()},e.prototype.handleEnterKey=function(){this.owner.isReadOnlyMode||(t.Browser.isDevice&&(this.viewer.isCompositionStart=!1),this.owner.editorModule.onEnter()),this.selection.checkForCursorVisibility()},e.prototype.handleTextInput=function(e){var i=this;this.owner.isReadOnlyMode||(this.animationTimer&&clearTimeout(this.animationTimer),t.classList(this.selection.caret,[],["e-de-cursor-animation"]),this.owner.editorModule.insertText(e,!1),this.animationTimer=setTimeout(function(){i.animationTimer&&clearTimeout(i.animationTimer),i.selection&&i.selection.caret&&t.classList(i.selection.caret,["e-de-cursor-animation"],[])},600)),this.selection.checkForCursorVisibility()},e.prototype.copyInsertFormat=function(e,i){var r=new P,n=this.selection.characterFormat;return i&&r.copyFormat(e),t.isNullOrUndefined(n.bold)||e.bold===n.bold||(r.bold=n.bold),t.isNullOrUndefined(n.italic)||e.italic===n.italic||(r.italic=n.italic),n.fontSize>0&&e.fontSize!==n.fontSize&&(r.fontSize=n.fontSize),t.isNullOrUndefined(n.fontFamily)||e.fontFamily===n.fontFamily||(r.fontFamily=n.fontFamily),t.isNullOrUndefined(n.highlightColor)||e.highlightColor===n.highlightColor||(r.highlightColor=n.highlightColor),t.isNullOrUndefined(n.baselineAlignment)||e.baselineAlignment===n.baselineAlignment||(r.baselineAlignment=n.baselineAlignment),t.isNullOrUndefined(n.fontColor)||e.fontColor===n.fontColor||(r.fontColor=n.fontColor),t.isNullOrUndefined(n.underline)||e.underline===n.underline||(r.underline=n.underline),t.isNullOrUndefined(n.strikethrough)||e.strikethrough===n.strikethrough||(r.strikethrough=n.strikethrough),r},e.prototype.insertText=function(e,i){var r,n=this.viewer.selection,o=!0;this.isListTextSelected(),this.initHistory("Insert");var a=this.getParagraphInfo(n.start);if(this.viewer.selection.editPosition=this.getHierarchicalIndex(a.paragraph,a.offset.toString()),(!n.isEmpty&&!this.viewer.selection.isImageSelected||this.viewer.isListTextSelected&&"List"===n.contextType)&&(n.isSkipLayouting=!0,n.skipFormatRetrieval=!0,o=this.removeSelectedContents(n),n.skipFormatRetrieval=!1,n.isSkipLayouting=!1),a=this.getParagraphInfo(n.start),o){if(n.owner.isShiftingEnabled=!0,this.updateInsertPosition(),(r=n.start).paragraph.isEmpty()){var s=new Q,l=this.copyInsertFormat(r.paragraph.characterFormat,!0);s.characterFormat.copyFormat(l),s.text=e,s.line=r.paragraph.childWidgets[0],s.margin=new A(0,0,0,0),s.line.children.push(s),"Center"!==r.paragraph.paragraphFormat.textAlignment&&"Right"!==r.paragraph.paragraphFormat.textAlignment||-1!==r.paragraph.paragraphFormat.listFormat.listId||(r.paragraph.x=this.viewer.clientActiveArea.x),this.viewer.layout.reLayoutParagraph(r.paragraph,0,0)}else{var d=0,h=r.currentWidget.getInline(r.offset,d),c=h.element;if(d=h.index,(l=this.copyInsertFormat(c.characterFormat,!0)).isSameFormat(c.characterFormat))this.insertTextInline(c,n,e,d);else{var p=new Q;p.text=e,p.line=c.line,p.characterFormat.copyFormat(l);var g=c.indexInOwner;if(d===c.length)c.line.children.splice(g+1,0,p);else if(0===d)c.line.children.splice(g,0,p);else{if(c instanceof Q){var u=new Q;u.line=c.line,u.characterFormat.copyFormat(c.characterFormat),u.text=c.text.substring(d),c.text=c.text.slice(0,d),c.line.children.splice(g+1,0,u)}c.line.children.splice(g+1,0,p)}this.viewer.layout.reLayoutParagraph(r.paragraph,c.line.indexInOwner,0)}}this.setPositionParagraph(a.paragraph,a.offset+e.length,!0),this.updateEndPosition(),t.isNullOrUndefined(this.editorHistory)||t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||"ListSelect"!==this.editorHistory.currentHistoryInfo.action||!this.viewer.isListTextSelected||(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()),this.reLayout(n)}if(!i&&o&&(" "===e||"\t"===e||"\v"===e)){var f=n.getHyperlinkField(),m=!t.isNullOrUndefined(f),v=!1;if("\v"!==e&&(v=this.checkAndConvertList(n,"\t"===e)),m)return;v||this.checkAndConvertToHyperlink(n,!1)}},e.prototype.insertIMEText=function(e,t){if(this.viewer.lastComposedText!==e||!t){var i=this.getParagraphInfo(this.selection.start),r=this.getHierarchicalIndex(i.paragraph,i.offset.toString());this.insertText(e,!1),this.viewer.lastComposedText=e;var n=this.selection.start;this.setPositionForCurrentIndex(n,r);var o=new Ie(this.owner);o.setPositionForLineWidget(n.currentWidget,n.offset+e.length),this.selection.selectPosition(t?n:o,o)}},e.prototype.insertSectionBreak=function(){var e=this.viewer.selection;t.isNullOrUndefined(e)||this.owner.isReadOnlyMode||e.start.paragraph.isInHeaderFooter||(this.initHistory("SectionBreak"),e.isEmpty||e.selectContent(e.isForward?e.start:e.end,!0),this.viewer.owner.isShiftingEnabled=!0,this.updateInsertPosition(),this.insertSection(e,!0),this.updateEndPosition(),this.reLayout(e,!0))},e.prototype.insertSection=function(e,i){var r,n,o=this.selection.start.paragraph.bodyWidget.sectionFormat.cloneFormat();if(e.start.paragraph.isInsideTable){var a=this.viewer.layout.getParentTable(e.start.paragraph);a=a.combineWidget(this.viewer);var s=!1;0===e.start.paragraph.associatedCell.rowIndex&&(s=!0);var l=new G,d=a.previousRenderedWidget;s?r=a:(r=this.splitTable(a,e.start.paragraph.associatedCell.ownerRow),this.viewer.layout.layoutBodyWidgetCollection(r.index,r.containerWidget,r,!1),r=r.getSplitWidgets().pop());var h=0;!t.isNullOrUndefined(d)&&d.bodyWidget.equals(r.bodyWidget)||!s?(h=r.indexInOwner+1,l.index=r.index+1):(h=0,l.index=0),r.containerWidget.childWidgets.splice(h,0,l),l.containerWidget=r.containerWidget,this.updateNextBlocksIndex(l,!0),this.viewer.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1),r=l}else{var c=this.getParagraphInfo(e.start),p=this.getHierarchicalIndex(c.paragraph,c.offset.toString());this.splitParagraphInternal(e,e.start.paragraph,e.start.currentWidget,e.start.offset),this.setPositionForCurrentIndex(e.start,p),r=e.start.paragraph.getSplitWidgets().pop()}return(n=this.splitBodyWidget(r.bodyWidget,o,r).firstChild)instanceof K&&n.updateRowIndex(0),this.viewer.layout.layoutBodyWidgetCollection(n.index,n.containerWidget,n,!1),n instanceof K&&(n=e.getFirstParagraphInFirstCell(n)),i&&e.selectParagraph(n,!0),n},e.prototype.splitBodyWidget=function(e,t,i){var r=this.viewer.layout.moveBlocksToNextPage(i);return this.updateSectionIndex(t,r,!0),this.insertRemoveHeaderFooter(r.sectionIndex,!0),this.viewer.layout.layoutHeaderFooter(r,this.viewer,r.page),this.updateBlockIndex(0,r.firstChild),this.viewer.updateClientArea(r.sectionFormat,r.page),r},e.prototype.insertRemoveHeaderFooter=function(e,t){this.viewer.headersFooters[e]||(this.viewer.headersFooters[e]={})},e.prototype.updateBlockIndex=function(e,i){var r,n=i.bodyWidget.sectionIndex;do{r=i.getSplitWidgets();for(var o=0;o<r.length;o++)r[o].index=e;e++,i=r.pop().nextRenderedWidget}while(!t.isNullOrUndefined(i)&&i.bodyWidget.sectionIndex===n)},e.prototype.updateSectionIndex=function(e,t,i){var r=t.sectionIndex,n=t;do{n.index===r&&e&&(n.sectionFormat=e),i?n.index++:n.index--,n=n.nextRenderedWidget}while(n)},e.prototype.checkAndConvertList=function(e,i){var r=e.paragraphFormat.getList();if(!t.isNullOrUndefined(r))return!1;var n=!1,o=!1,a=0,s=e.start.currentWidget.getInline(e.start.offset-1,a),l=s.element;if(a=s.index,!(l instanceof Q))return!1;for(var d=l,h=d.text.substring(0,a),c=0,p=0;!t.isNullOrUndefined(d.previousNode);){if(!(d.previousNode instanceof Q)||"\t"!==d.previousNode.text&&0!==d.previousNode.text.trim().length)return!1;"\t"===d.previousNode.text?c+=36:p=2.5*d.previousNode.text.length,d=d.previousNode}d=l;var g=0,u=h.lastIndexOf("\t");for(g=u>=0?u+1:h.lastIndexOf(" ")+1;d.previousNode instanceof Q&&0===g;){var f=(d=d.previousNode).text;g=(u=f.lastIndexOf("\t"))>=0?u+1:f.lastIndexOf(" ")+1,h=(h=d.text+h).substring(g)}var m=(h=W.trimStart(h)).substring(1,2),v=this.getListLevelPattern(h.substring(0,1));if("None"!==v&&this.checkNumberFormat(m,"Bullet"===v,h)?n=!0:this.checkLeadingZero(h)&&(o=!0,n=!0),n){this.initComplexHistory("AutoList");var y=l.paragraph;e.start.setPositionParagraph(y.childWidgets[0],y.childWidgets[0].getOffset(l,a+1)),e.end.setPositionParagraph(y.childWidgets[0],0),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!1);var w=i?"Tab":"Space";m=o?"%1"+h.substring(h.length-1,h.length):"%1"+m;var b=h.substring(h.length-3,h.length-1);v=o?this.getListLevelPattern(b):v;var x=new he(void 0);x.listLevelPattern=v,"Bullet"===v?"*"===h?(x.numberFormat="",x.characterFormat.fontFamily="Symbol"):"-"===h&&(x.numberFormat="-"):x.numberFormat=m,x.followCharacter=w;var C=e.paragraphFormat.leftIndent;x.paragraphFormat.leftIndent=0!==c||0!==p?C+18+c+p:a>2?C+2.5*(a-2)+18:C>0?C+18:36,x.paragraphFormat.firstLineIndent=-18,!o&&"0"===h.substring(0,1)||"00"===b?x.startAt=0:x.startAt=1,this.autoConvertList(e,x),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)?this.editorHistory.updateComplexHistory():this.reLayout(e)}return n},e.prototype.getListLevelPattern=function(e){switch(e){case"0":case"1":return"Arabic";case"I":return"UpRoman";case"i":return"LowRoman";case"A":return"UpLetter";case"a":return"LowLetter";case"*":case"-":return"Bullet";case"00":case"01":return"LeadingZero";default:return"None"}},e.prototype.autoConvertList=function(e,t){e.start;e.isForward||e.end;var i=new b;this.viewer.lists.length>0?i.listId=this.viewer.lists[this.viewer.lists.length-1].listId+1:i.listId=0;var r=new de,n=this.viewer;n.abstractLists.length>0?r.abstractListId=n.abstractLists[n.abstractLists.length-1].abstractListId+1:r.abstractListId=0,i.abstractListId=r.abstractListId,i.abstractList=r,n.abstractLists.push(r),r.levels.push(t),t.ownerBase=r,e.paragraphFormat.setList(i),e.paragraphFormat.listLevelNumber=0},e.prototype.checkNumberFormat=function(e,t,i){if(t)return""===e;var r=i.indexOf(e);return("."===e||")"===e||">"===e||"-"===e)&&""===i.substring(r,i.length-1)},e.prototype.checkLeadingZero=function(e){for(var t,i=!1,r=0;r<=e.length-1;r++){if("0"!==e.charAt(r)){t=r;break}i=!0}var n=void 0;return n="1"===e.charAt(t)?e.charAt(t+1):e.charAt(t),i&&this.checkNumberFormat(n,!1,e)},e.prototype.getPageFromBlockWidget=function(e){var t=void 0;return e.containerWidget instanceof V?t=e.containerWidget.page:e.containerWidget instanceof q?t=e.containerWidget.page:e.containerWidget instanceof Y&&(t=e.containerWidget.bodyWidget.page),t},e.prototype.insertTextInline=function(e,t,i,r){if(e instanceof Q){e.text=W.insert(e.text,r,i);var n=e.line.paragraph,o=n.childWidgets.indexOf(e.line),a=e.line.children.indexOf(e);this.viewer.layout.reLayoutParagraph(n,o,a)}else e instanceof re?this.insertImageText(e,t,i,r):e instanceof $?0===e.fieldType?this.insertFieldBeginText(e,t,i,r):2===e.fieldType?this.insertFieldSeparatorText(e,t,i,r):this.insertFieldEndText(e,t,i,r):e instanceof ie&&this.insertBookMarkText(e,t,i,r)},e.prototype.insertFieldBeginText=function(e,t,i,r){var n=new Q;n.text=i;var o=e.line.paragraph.childWidgets.indexOf(e.line),a=e.line.children.indexOf(e);n.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(a,0,n),n.line=e.line,this.viewer.layout.reLayoutParagraph(e.line.paragraph,o,a)},e.prototype.insertBookMarkText=function(e,t,i,r){var n=new Q;n.text=i;var o=e.line.paragraph.childWidgets.indexOf(e.line),a=e.line.children.indexOf(e);n.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(a,0,n),n.line=e.line,this.viewer.layout.reLayoutParagraph(e.line.paragraph,o,a)},e.prototype.insertFieldSeparatorText=function(e,i,r,n){var o=i.getPreviousTextInline(e),a=i.getNextTextInline(e),s=new Q;s.text=r;var l=e.line.children.indexOf(e);n===e.length&&l++,t.isNullOrUndefined(o)&&t.isNullOrUndefined(a)?s.characterFormat.copyFormat(e.line.paragraph.characterFormat):t.isNullOrUndefined(o)?s.characterFormat.copyFormat(a.characterFormat):s.characterFormat.copyFormat(o.characterFormat),e.line.children.splice(l,0,s),s.line=e.line;var d=e.line.paragraph.childWidgets.indexOf(e.line);this.viewer.layout.reLayoutParagraph(e.line.paragraph,d,l)},e.prototype.insertFieldEndText=function(e,t,i,r){var n=new Q;n.text=i;var o=e.line.children.indexOf(e);n.characterFormat.copyFormat(e.characterFormat),e.line.children.splice(o+1,0,n),n.line=e.line;var a=e.line.paragraph.childWidgets.indexOf(e.line);this.viewer.layout.reLayoutParagraph(e.line.paragraph,a,o)},e.prototype.insertImageText=function(e,i,r,n){var o=i.getPreviousTextInline(e),a=i.getNextTextInline(e),s=e.line,l=new Q,d=s.paragraph,h=d.childWidgets.indexOf(s);l.text=r;var c=s.children.indexOf(e);n===e.length&&c++,t.isNullOrUndefined(o)&&t.isNullOrUndefined(a)?l.characterFormat.copyFormat(d.characterFormat):t.isNullOrUndefined(o)?l.characterFormat.copyFormat(a.characterFormat):l.characterFormat.copyFormat(o.characterFormat),s.children.splice(c,0,l),l.line=s,this.viewer.layout.reLayoutParagraph(d,h,c)},e.prototype.isListTextSelected=function(){this.viewer.isListTextSelected&&(this.initComplexHistory("ListSelect"),this.viewer.selection.start.paragraph.paragraphFormat.listFormat&&-1!==this.viewer.selection.start.paragraph.paragraphFormat.listFormat.listId&&this.onApplyList(void 0))},e.prototype.checkAndConvertToHyperlink=function(e,t,i){var r,n;if(t)r=(n=i.lastChild.children[i.lastChild.children.length-1]).text;else{var o=0,a=e.start.currentWidget.getInline(e.start.offset-1,o),s=a.element;if(o=a.index,!(s instanceof Q))return;r=(n=s).text.substring(0,o)}var l=0,d=r.lastIndexOf("\t");for(l=d>=0?d+1:r.lastIndexOf(" ")+1;n.previousNode instanceof Q&&0===l;){var h=(n=n.previousNode).text;l=(d=h.lastIndexOf("\t"))>=0?d+1:h.lastIndexOf(" ")+1,r=n.text+r}var c=(r=r.substring(l)).toLowerCase(),p=!1;if("file:///"===c.substring(0,8)||"http://"===c.substring(0,7)&&c.length>7||"https://"===c.substring(0,8)&&c.length>8||"www."===c.substring(0,4)&&c.length>4||"\\"===c.substring(0,3)&&c.length>3||"mailto:"===c.substring(0,7)&&c.length>7)p=!0,"www."===c.substring(0,4)&&c.length>4&&(r="http://"+r);else{var g=r.indexOf("@"),u=r.indexOf(".");g>0&&g<u&&u<r.length-1&&(p=!0,r="mailto:"+r)}if(p){var f=new Ie(this.viewer.owner);f.setPositionParagraph(n.line,n.line.getOffset(n,l));var m=new Ie(this.viewer.owner);if(t)m.setPositionParagraph(n.line,n.line.getEndOffset());else if(0===e.end.currentWidget.children.length&&0===e.end.offset){var v=e.end.currentWidget.previousLine;m.setPositionParagraph(v,v.getEndOffset())}else m.setPositionParagraph(e.end.currentWidget,e.end.offset-1);this.autoFormatHyperlink(e,r,f,m)}},e.prototype.autoFormatHyperlink=function(e,t,i,r){this.initComplexHistory("AutoFormatHyperlink");var n=this.getParagraphInfo(i),o=this.getHierarchicalIndex(n.paragraph,n.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=o),e.start.setPositionInternal(i),e.end.setPositionInternal(r);var a=this.getCharacterFormat(e),s=new P;s.copyFormat(a);var l=this.createHyperlinkElement(t,i,r,s);e.start.setPositionParagraph(l.line,l.line.getOffset(l,1)),e.start.moveNextPosition(),e.end.setPositionInternal(e.start),n=this.getParagraphInfo(e.end);var d=this.getHierarchicalIndex(n.paragraph,n.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=d,this.editorHistory.updateComplexHistory(),this.reLayout(e)):this.updateComplexWithoutHistory(0,o,d)},e.prototype.appylingHyperlinkFormat=function(e){this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","Single",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor","#0563c1",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1)},e.prototype.createHyperlinkElement=function(e,t,i,r){var n=this.selection;this.viewer.layout.allowLayout=!1,this.appylingHyperlinkFormat(n),this.viewer.layout.allowLayout=!0;var o=new $(1);o.characterFormat.copyFormat(r),o.line=n.end.currentWidget,n.start.setPositionInternal(n.end),this.initInsertInline(o),n.start.setPositionInternal(t),n.end.setPositionInternal(n.start);var a=this.insertHyperlinkfield(n,r,e),s=n.start.paragraph.childWidgets.indexOf(a.line),l=a.line.children.indexOf(a);return o.linkFieldCharacter(this.viewer),this.viewer.layout.reLayoutParagraph(n.start.paragraph,s,l),o},e.prototype.insertHyperlinkfield=function(e,t,i,r){var n=new $(0);n.characterFormat.copyFormat(t),n.line=e.start.currentWidget,this.initInsertInline(n);var o=new Q;o.characterFormat.copyFormat(t),o.text=r?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',o.line=e.start.currentWidget,this.initInsertInline(o);var a=new $(2);return a.characterFormat.copyFormat(t),a.line=e.start.currentWidget,this.initInsertInline(a),n},e.prototype.unLinkFieldCharacter=function(e){if(e instanceof $&&0===e.fieldType&&e.fieldEnd&&(this.viewer&&(this.viewer.fieldToLayout=e,this.viewer.fieldEndParagraph=e.line.paragraph),e.fieldEnd=void 0),e instanceof $&&2===e.fieldType)t.isNullOrUndefined(e.fieldEnd)||(this.viewer&&(this.viewer.fieldToLayout=e.fieldBegin,this.viewer.fieldEndParagraph=e.line.paragraph),e.fieldBegin.fieldSeparator=void 0,e.fieldEnd.fieldSeparator=void 0);else if(e instanceof $&&1===e.fieldType&&e.fieldBegin){t.isNullOrUndefined(this.viewer)||(this.viewer.fieldToLayout=e.fieldBegin,this.viewer.fieldEndParagraph=e.line.paragraph);var i=this.viewer.fields.indexOf(e.fieldBegin);-1!==i&&this.viewer.fields.splice(i,1),e.fieldBegin=void 0}},e.prototype.getCharacterFormat=function(e){return e.start.paragraph.isEmpty()?e.start.paragraph.characterFormat:e.start.currentWidget.getInline(e.start.offset,0).element.characterFormat},e.prototype.insertHyperlink=function(e,t,i,r){var n=this.viewer.selection;if(n.start.paragraph.associatedCell===n.end.paragraph.associatedCell)if(i)this.insertHyperlinkInternal(n,e,t,r);else{var o=n.start,a=n.end;n.isForward||(o=n.end,a=n.start);var s=new Ie(this.viewer.owner);s.setPositionInternal(o);var l=this.getCharacterFormat(n),d=new P(void 0);d.copyFormat(l),this.initComplexHistory("InsertHyperlink");var h=this.getParagraphInfo(o),c=this.getHierarchicalIndex(h.paragraph,h.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo&&(this.editorHistory.currentHistoryInfo.insertPosition=this.getHierarchicalIndex(h.paragraph,h.offset.toString())),this.appylingHyperlinkFormat(n),this.viewer.layout.allowLayout=!0,o.setPositionInternal(a);var p=new $(1);p.characterFormat.copyFormat(d),p.line=n.end.currentWidget,o.setPositionInternal(a),this.initInsertInline(p),o.setPositionInternal(s),a.setPositionInternal(o);var g=this.insertHyperlinkfield(n,d,e,r);p.linkFieldCharacter(this.viewer);var u=n.start.paragraph.childWidgets.indexOf(g.line),f=g.line.children.indexOf(g);this.viewer.layout.reLayoutParagraph(n.start.paragraph,u,f);var m=p.line;n.selects(m,m.getOffset(p,p.length),!0),h=this.getParagraphInfo(a);var v=this.getHierarchicalIndex(h.paragraph,h.offset.toString());this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.currentHistoryInfo.endPosition=this.getHierarchicalIndex(h.paragraph,h.offset.toString()),this.editorHistory.updateComplexHistory()):this.updateComplexWithoutHistory(1,c,v)}},e.prototype.insertHyperlinkInternal=function(e,i,r,n){if(!t.isNullOrUndefined(e.start)&&!this.editHyperlink(e,i,r)){this.initHistory("InsertHyperlink");var o=!0;if(e.isEmpty||(o=this.removeSelectedContents(e)),o){var a=this.getCharacterFormat(e),s=new P;s.copyFormat(a),this.insertHyperlinkByFormat(e,i,r,s,n)}}},e.prototype.insertHyperlinkByFormat=function(e,i,r,n,o){this.updateInsertPosition(),e.owner.isShiftingEnabled=!0;var a=[],s=new $(0);a.push(s);var l=new Q;l.text=o?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',a.push(l);var d=new $(2);a.push(d),t.isNullOrUndefined(r)||""===r||((l=new Q).characterFormat.underline="Single",l.characterFormat.fontColor="#0563c1",l.text=r,a.push(l));var h=new $(1);a.push(h),this.insertElement(a);e.start.paragraph;h.linkFieldCharacter(this.viewer),-1===this.viewer.fields.indexOf(s)&&this.viewer.fields.push(s);h.line.getOffset(h,1);e.selects(h.line,h.line.getOffset(h,h.length),!0),this.updateEndPosition(),this.reLayout(e,!0)},e.prototype.initInsertInline=function(e,t){this.initHistory("InsertInline"),this.insertInlineInSelection(this.viewer.selection,e),this.editorHistory&&this.editorHistory.updateHistory()},e.prototype.insertElementInCurrentLine=function(e,t,i){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertElement([t]),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.editHyperlink=function(e,i,r,n){var o=e.getHyperlinkField();if(t.isNullOrUndefined(o))return!1;this.initHistory("InsertHyperlink"),this.editHyperlinkInternal=t.isNullOrUndefined(this.editorHistory)||this.editorHistory&&t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo);var a="",s=!1,l=this.getCharacterFormat(e),d=new P;d.copyFormat(l);var h=void 0;if(!t.isNullOrUndefined(o.fieldSeparator)){h=o.fieldSeparator;var c=e.getHyperlinkDisplayText(o.fieldSeparator.line.paragraph,o.fieldSeparator,o.fieldEnd,s,d);a=c.displayText,s=c.isNestedField,d=c.format}var p=o.line.getOffset(o,0);if(e.start.setPositionParagraph(o.line,p),p=o.fieldEnd.line.getOffset(o.fieldEnd,1),e.end.setPositionParagraph(o.fieldEnd.line,p),this.deleteSelectedContents(e,!1),!s&&a!==r||t.isNullOrUndefined(h))this.insertHyperlinkByFormat(e,i,r,d,n);else{this.updateInsertPosition();var g=new $(0);g.characterFormat.copyFormat(o.characterFormat),g.line=e.start.currentWidget,this.insertInlineInternal(g);var u=new Q;u.characterFormat.copyFormat(o.characterFormat),u.text=n?' HYPERLINK \\l "'+i+'" ':' HYPERLINK "'+i+'" ',u.line=e.start.currentWidget,this.insertInlineInternal(u);var f=this.editorHistory&&this.editorHistory.currentBaseHistoryInfo?this.editorHistory.currentBaseHistoryInfo.removedNodes:this.nodes;this.insertClonedFieldResult(e,f,h),e.end.currentWidget.getInline(e.end.offset,0).element.linkFieldCharacter(this.viewer);var m=g.line.paragraph,v=g.line.paragraph.childWidgets.indexOf(g.line),y=g.line.children.indexOf(g);this.viewer.layout.reLayoutParagraph(m,v,y),e.selects(g.fieldEnd.line,p,!0),this.updateEndPosition(),this.reLayout(e,!0)}return this.editHyperlinkInternal=!1,this.nodes=[],!0},e.prototype.insertClonedFieldResult=function(e,t,i){for(var r=!1,n=t.length-1;n>-1;n--){var o=t[n];if(!r){if(i!==o){if(o instanceof G&&o===i.line.paragraph){r=!0;var a=void 0;if(n===t.length-1){a=e.start.paragraph;var s=i.line.paragraph;this.getClonedFieldResultWithSel(s,e,i)}else a=this.getClonedFieldResult(i.line.paragraph,i),this.insertParagraph(a,!0);e.selectParagraph(e.getNextParagraphBlock(a),!0)}continue}r=!0}o instanceof Z?this.insertInlineInternal(o.clone()):o instanceof j&&this.insertBlock(o.clone())}},e.prototype.getClonedFieldResultWithSel=function(e,t,i){for(var r=e.childWidgets.indexOf(i.line),n=e.childWidgets[r].children.indexOf(i),o=r;o<e.childWidgets.length;o++){var a=e.childWidgets[o];o!==r&&(n=0);for(var s=n;s<a.children.length;s++)this.insertInlineInternal(a.children[s].clone())}},e.prototype.getClonedFieldResult=function(e,t){var i=new G;i.characterFormat.copyFormat(e.characterFormat),i.paragraphFormat.copyFormat(e.paragraphFormat);for(var r=e.childWidgets.indexOf(t.line),n=e.childWidgets[r].children.indexOf(t),o=r;o<e.childWidgets.length;o++){var a=e.childWidgets[o];o!==r&&(n=0);for(var s=n;s<a.children.length;s++)i.childWidgets[0].children.push(a.children[s])}return i},e.prototype.removeHyperlink=function(){if(!this.owner.isReadOnlyMode){var e=this.selection,i=e.getHyperlinkField();if(!t.isNullOrUndefined(i)){var r=i.fieldEnd,n=i.fieldSeparator,o=new Ie(e.owner);o.setPositionParagraph(i.line,i.line.getOffset(i,0));var a=new Ie(e.owner);a.setPositionParagraph(n.line,n.line.getOffset(n,n.length)),this.initComplexHistory("RemoveHyperlink"),e.start.setPositionParagraph(r.line,r.line.getOffset(r,0)),e.end.setPositionInternal(e.start),this.onDelete(),e.start.setPositionInternal(a),this.initHistory("Underline"),this.updateCharacterFormatWithUpdate(e,"underline","None",!1),this.editorHistory&&this.editorHistory.updateHistory(),this.initHistory("FontColor"),this.updateCharacterFormatWithUpdate(e,"fontColor",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.reLayout(e,!1),e.end.setPositionInternal(e.start),e.start.setPositionInternal(o),this.initHistory("Delete"),this.deleteSelectedContents(e,!1),this.reLayout(e,!0),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory()}}},e.prototype.pasteInternal=function(e,i){if(this.viewer.owner.enableLocalPaste)this.pasteLocal();else{t.isNullOrUndefined(i)&&(i=window);var r="";""!==(r=(i.clipboardData?i.clipboardData:e.clipboardData).getData("Text"))&&(this.pasteContents(r),this.viewer.editableDiv.innerHTML="")}this.viewer.updateFocus()},e.prototype.pasteLocal=function(){if(this.copiedData&&this.owner.enableLocalPaste){var e=JSON.parse(this.copiedData);this.pasteContents(e)}},e.prototype.getBlocks=function(e){var t=[];if("string"==typeof e){var i=this.selection.start.paragraph;this.selection.isForward||(i=this.selection.end.paragraph);var r=[],n=e;r=(n=n.replace(/\r\n/g,"\r")).split("\r");for(h=0;h<r.length;h++){var o=this.copyInsertFormat(i.characterFormat,!1),a=this.viewer.selection.copySelectionParagraphFormat(),s=new G;s.paragraphFormat.copyFormat(a);var l=new J(s);if(r[h].length>0){var d=new Q;d.characterFormat.copyFormat(o),d.text=r[h],l.children.push(d),d.line=l}s.childWidgets.push(l),t.push(s)}}else for(var h=0;h<e.sections.length;h++)this.viewer.owner.parser.parseBody(e.sections[h].blocks,t);return t},e.prototype.pasteContents=function(e){this.pasteContentsInternal(this.getBlocks(e))},e.prototype.pasteContentsInternal=function(e){var t=this.viewer.selection,i=!0;if(this.initComplexHistory("Paste"),this.viewer.isListTextSelected){var r=t.start.paragraph;r.paragraphFormat.listFormat&&-1!==r.paragraphFormat.listFormat.listId&&this.onApplyList(void 0)}this.initHistory("Paste"),t.isEmpty&&!this.viewer.isListTextSelected||(i=this.removeSelectedContentInternal(t,t.start,t.end)),i?this.pasteContent(e):this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0),this.editorHistory&&this.editorHistory.currentHistoryInfo?(this.editorHistory.updateHistory(),this.editorHistory.updateComplexHistory()):this.reLayout(t,t.isEmpty)},e.prototype.pasteContent=function(e){this.viewer.owner.isShiftingEnabled=!0,this.updateInsertPosition(),this.viewer.owner.isLayoutEnabled=!0,this.viewer.owner.isPastingContent=!0,this.pasteCopiedData(e),this.updateEndPosition(),this.viewer.owner.isPastingContent=!1,this.viewer.selection.fireSelectionChanged(!0)},e.prototype.pasteCopiedData=function(e){for(var t=0;t<e.length;t++){var i=e[t];if(i instanceof G&&0===i.childWidgets.length&&(i.childWidgets[0]=new J(i)),t===e.length-1&&i instanceof G){var r=i;r.childWidgets.length>0&&r.childWidgets[0].children.length>0&&this.insertElement(r.childWidgets[0].children)}else if(i instanceof j){var n=this.selection.start.paragraph;if(i instanceof K&&n.isInsideTable){var o=i,a=n.getContainerWidth();o.fitCellsToClientArea(a)}i instanceof K&&n.isEmpty()&&n.previousWidget instanceof K?this.insertTableRows(i,n.previousWidget):this.insertBlockInternal(i)}}},e.prototype.insertTableInternal=function(e,t,i){var r=e.getIndex();if(i)for(var n=0,o=0;n<e.childWidgets.length;n++,o++){var a=e.childWidgets[n];t.childWidgets.splice(o,0,a),a.containerWidget=t,e.childWidgets.splice(n,1),n--}var s=e.containerWidget;this.removeBlock(e),s.childWidgets.splice(r,0,t),t.index=e.index,e.containerWidget=void 0,t.containerWidget=s,t.isGridUpdated=!1,t.buildTableColumns(),t.isGridUpdated=!0,this.viewer.layout.clearTableWidget(t,!0,!0),this.updateNextBlocksIndex(t,!0),this.viewer.layout.linkFieldInTable(t),this.viewer.layout.layoutBodyWidgetCollection(t.index,s,t,!1)},e.prototype.insertBlockTable=function(e,t,i){var r=e.start.offset;e.start.paragraph.childWidgets.indexOf(e.start.currentWidget);t instanceof G&&r>0&&(this.moveInlines(e.start.paragraph,t,0,0,e.start.paragraph.firstChild,r,e.start.currentWidget),e.selectParagraph(e.start.paragraph,!0),this.checkInsertPosition(e)&&this.updateHistoryPosition(this.getHierarchicalIndex(t,r.toString()),!0)),r>0&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.start,!0);var n=i.indexInOwner;if(i.containerWidget.childWidgets.splice(n,0,t),t.containerWidget=i.containerWidget,t.index=i.index,this.updateNextBlocksIndex(t,!0),this.viewer.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.checkInsertPosition(e)){var o=void 0;t instanceof G&&(o=t),t instanceof K&&(o=e.getFirstParagraphInFirstCell(t)),this.updateHistoryPosition(this.getHierarchicalIndex(o,"0"),!0)}},e.prototype.handleCut=function(e){var t=e.start,i=e.end;e.isForward||(t=e.end,i=e.start);var r=this.getParagraphInfo(t);if(e.editPosition=this.getHierarchicalIndex(r.paragraph,r.offset.toString()),t.paragraph===i.paragraph&&t.offset+1===i.offset)t.paragraph.getInline(i.offset,0).element;this.initHistory("Cut"),e.owner.isShiftingEnabled=!0,this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkInsertPosition(e)&&this.updateHistoryPosition(e.editPosition,!0),this.deleteSelectedContent(i.paragraph,e,t,i,3);var n=new Ie(e.owner);this.setPositionForCurrentIndex(n,e.editPosition),e.selectContent(n,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)},e.prototype.insertInlineInternal=function(e){var t=this.selection,i=e.length,r=this.getParagraphInfo(t.start);if(t.start.paragraph.isEmpty()){var n=t.start.paragraph;"Center"!==n.paragraphFormat.textAlignment&&"Right"!==n.paragraphFormat.textAlignment||-1!==n.paragraphFormat.listFormat.listId||(n.x=this.viewer.clientActiveArea.x),n.childWidgets[0].children.push(e),e.line=n.childWidgets[0],e.linkFieldCharacter(this.viewer),this.viewer.layout.reLayoutParagraph(n,0,0)}else{var o=0,a=t.start.currentWidget.getInline(t.start.offset,o),s=a.element;o=a.index,this.insertElementInternal(s,e,o,!0)}this.setPositionParagraph(r.paragraph,r.offset+i,!0)},e.prototype.insertElement=function(e){var i=this.selection,r=0,n=void 0,o=-1,a=void 0,s=0,l=this.getParagraphInfo(i.start);if(i.start.paragraph.isEmpty())a=(n=i.start.paragraph).childWidgets[0],o=0;else{var d=0,h=i.start.currentWidget.getInline(i.start.offset,d),c=h.element;if(d=h.index,n=c.line.paragraph,o=n.childWidgets.indexOf(c.line),s=c.indexInOwner,a=c.line,d===c.length)s++;else if(0===d)t.isNullOrUndefined(c.previousNode)&&(s=0);else{s++;var p=new Q;p.characterFormat.copyFormat(c.characterFormat),p.text=c.text.substring(d),c.text=c.text.substr(0,d),a.children.splice(s,0,p),p.line=c.line}}for(var g=0;g<e.length;g++)r+=e[g].length,a.children.splice(s,0,e[g]),e[g].line=a,e[g].linkFieldCharacter(this.viewer),s++;this.viewer.layout.reLayoutParagraph(n,o,0),this.setPositionParagraph(l.paragraph,l.offset+r,!0)},e.prototype.insertElementInternal=function(e,i,r,n){var o=e.line,a=o.paragraph,s=o.indexInOwner,l=e.indexInOwner;if(r===e.length)l++,o.children.splice(l,0,i);else if(0===r)t.isNullOrUndefined(e.previousNode)?(e.line.children.splice(0,0,i),l=0):e.line.children.splice(l,0,i);else{l++;var d=new Q;d.characterFormat.copyFormat(e.characterFormat),d.text=e.text.substring(r),e.text=e.text.substr(0,r),o.children.splice(l,0,d),d.line=e.line,o.children.splice(l,0,i),l-=1}i.line=e.line,i.linkFieldCharacter(this.viewer),n&&this.viewer.layout.reLayoutParagraph(a,s,l)},e.prototype.insertBlock=function(e){var t=!0,i=this.selection;if(i.isEmpty||(t=this.removeSelectedContents(i)),t||i.selectContent(i.start,!1),this.insertBlockInternal(e),this.checkInsertPosition(i)){var r=void 0;r=e instanceof G?e:this.selection.getFirstParagraphInFirstCell(e),this.updateHistoryPosition(this.getHierarchicalIndex(r,"0"),!0)}this.fireContentChange()},e.prototype.insertBlockInternal=function(e){var i=this.selection,r=this.selection.start.paragraph;if(!i.start.isAtParagraphStart){if(e instanceof G)return void this.insertNewParagraphWidget(e,!1);this.updateInsertPosition(),r=r.combineWidget(this.viewer),this.splitParagraph(r,r.firstChild,0,i.start.currentWidget,i.start.offset,!1),i.selectParagraph(this.selection.start.paragraph,!0)}var n=i.start.paragraph.containerWidget,o=i.start.paragraph.index,a=n.childWidgets.indexOf(i.start.paragraph);t.isNullOrUndefined(n)||(n.childWidgets.splice(a,0,e),e.containerWidget=n,e.index=o,e.height=0,e instanceof K&&(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0),this.updateNextBlocksIndex(e,!0),this.viewer.layout.layoutBodyWidgetCollection(o,n,e,!1))},e.prototype.insertImage=function(e,i,r){this.owner.isReadOnlyMode||(t.isNullOrUndefined(i)&&(i=100),t.isNullOrUndefined(r)&&(r=100),this.insertPicture(e,i,r))},e.prototype.insertTable=function(e,t){var i=this.selection.start;if(!this.owner.isReadOnlyMode){e=e||1,t=t||1;var r=this.createTable(e,t),n=i.paragraph.getContainerWidth();r.splitWidthToTableCells(n);var o=i.paragraph.previousWidget;if(i.currentWidget.isFirstLine()&&0===i.offset&&o instanceof K)return this.insertTableRows(r,o),void r.destroy();this.initHistory("InsertTable"),this.viewer.owner.isShiftingEnabled=!0,this.insertBlock(r);var a=this.selection.getFirstParagraphInFirstCell(r).childWidgets[0];i.setPosition(a,!0),this.selection.end.setPositionInternal(i);var s=this.selection.getLastParagraphInLastCell(r),l=s.getLength()+1;this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.getHierarchicalIndex(s,l.toString())),this.reLayout(this.selection)}},e.prototype.insertRow=function(e,i){var r=e?"Above":"Below";if(!this.owner.isReadOnlyMode){var n=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(n.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Above"===r?"InsertRowAbove":"InsertRowBelow"),this.viewer.owner.isShiftingEnabled=!0;var o=this.getOwnerCell(this.selection.isForward).getSplitWidgets()[0],a=this.getOwnerCell(!this.selection.isForward).getSplitWidgets()[0],s=o.ownerTable.combineWidget(this.viewer),l="Below"===r?a.ownerRow:o.ownerRow;if(this.editorHistory)this.cloneTableToHistoryInfo(s);var d=i||this.getRowCountToInsert(),h=[],c=l.rowIndex;if("Below"===r){c++;var p=t.isNullOrUndefined(a.previousWidget)||a.columnIndex===a.previousWidget.columnIndex+1;a.cellIndex!==a.columnIndex&&p&&l.rowIndex+o.cellFormat.rowSpan-1===a.ownerRow.rowIndex||a.cellFormat.rowSpan>1&&!t.isNullOrUndefined(l.nextWidget)&&l.nextWidget instanceof X&&(a.cellFormat.rowSpan+=d,l=l.nextWidget)}for(var g=0;g<d;g++){var u=this.updateRowspan(l,"Below"===r?a:o,r),f=this.createRowAndColumn(u.count,g);f.rowFormat.copyFormat(l.rowFormat),this.updateCellFormatForInsertedRow(f,u.cellFormats),h.push(f)}s.insertTableRowsInternal(h,c);var m=void 0,v=void 0;if(s.childWidgets[c]instanceof X)m=s.childWidgets[c].firstChild,v=this.selection.getFirstParagraph(m);else{for(var y=void 0;!(y instanceof K);)y=s.nextRenderedWidget;v=this.selection.getFirstParagraphInFirstCell(y)}this.viewer.layout.reLayoutTable(s),this.selection.selectParagraph(v,!0)}this.reLayout(this.selection,!0)}},e.prototype.updateCellFormatForInsertedRow=function(e,t){for(var i=0;i<e.childWidgets.length;i++)e.childWidgets[i].cellFormat.copyFormat(t[i]),e.childWidgets[i].cellFormat.rowSpan=1},e.prototype.updateRowspan=function(e,i,r){for(var n=e.getPreviousRowSpannedCells(!0),o=0,a=[],s=0;s<e.childWidgets.length;s++){for(var l=e.childWidgets[s],d=!1,h=t.isNullOrUndefined(l.previousWidget)||l.columnIndex!==l.previousWidget.columnIndex+1,c=0;c<n.length;c++)if(h){var p=n[c],g=p.ownerRow.rowIndex+p.cellFormat.rowSpan-1;if(l.columnIndex<p.columnIndex&&l.cellIndex!==l.columnIndex&&(d=!0,o++,a.push(l.cellFormat)),1===i.cellFormat.rowSpan)if(g>l.ownerRow.rowIndex){if("Above"===r&&p.ownerRow===i.ownerRow)continue;p.cellFormat.rowSpan+=1,n.splice(c,1),c--}else l.cellIndex!==l.columnIndex&&h&&g===l.ownerRow.rowIndex&&("Above"===r?(p.cellFormat.rowSpan+=1,n.splice(c,1),c--):(o++,a.push(p.cellFormat),n.splice(c,1),c--));else if(p!==i){if("Above"===r&&(p.ownerRow===i.ownerRow||p.columnIndex===i.columnIndex))continue;p.columnIndex!==i.columnIndex&&p.ownerRow.rowIndex!==l.ownerRow.rowIndex&&(g>i.ownerRow.rowIndex||"Above"===r&&g===i.ownerRow.rowIndex)&&(p.cellFormat.rowSpan+=1,n.splice(c,1),c--)}}-1===n.indexOf(l)&&l.cellFormat.rowSpan>1&&(d=!0),d||(o++,a.push(l.cellFormat))}return{count:o,cellFormats:a}},e.prototype.insertTableRows=function(e,t){if(this.initHistory("InsertRowBelow"),e.containerWidget=t.containerWidget,t=t.combineWidget(this.viewer),this.editorHistory)this.cloneTableToHistoryInfo(t);var i=t.childWidgets[t.childWidgets.length-1];t.insertTableRowsInternal(e.childWidgets,t.childWidgets.length);var r=this.selection.getFirstParagraph(i.nextWidget.childWidgets[0]);this.viewer.layout.reLayoutTable(t),this.selection.selectParagraph(r,!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.updateHistoryPosition(this.selection.start,!0),this.updateHistoryPosition(this.selection.end,!1)),this.reLayout(this.selection)},e.prototype.insertColumn=function(e,i){if(!this.owner.isReadOnlyMode){var r=e?"Left":"Right";if(this.selection.start.paragraph.isInsideTable){this.checkIsNotRedoing()&&this.initHistory("Left"===r?"InsertColumnLeft":"InsertColumnRight"),this.selection.owner.isShiftingEnabled=!0;var n=this.getOwnerCell(this.selection.isForward),o=this.getOwnerCell(!this.selection.isForward),a=n.ownerRow.ownerTable.combineWidget(this.viewer);if(this.editorHistory)this.cloneTableToHistoryInfo(a);this.selection.owner.isLayoutEnabled=!1;var s=n.columnIndex;"Right"===r&&(s=o.columnIndex+o.cellFormat.columnSpan);for(var l=void 0,d=void 0,h=i||this.getColumnCountToInsert(),c=[],p=0;p<h;p++)for(var g=0;g<a.childWidgets.length;g++){var u=a.childWidgets[g];if(d=this.createColumn(this.selection.getLastParagraph(n)),d.index=g,d.rowIndex=u.rowIndex,d.containerWidget=u,d.cellFormat.copyFormat(n.cellFormat),d.cellFormat.rowSpan=1,t.isNullOrUndefined(l)&&(l=this.selection.getFirstParagraph(d)),0===s)u.childWidgets.splice(s,0,d);else{for(var f=!1,m=0;m<u.childWidgets.length;m++){var v=u.childWidgets[m];if(v.cellFormat.rowSpan>1&&c.push(v),v.columnIndex+v.cellFormat.columnSpan===s?(u.childWidgets.splice(v.cellIndex+1,0,d),f=!0):s>v.columnIndex&&v.columnIndex+v.cellFormat.columnSpan>s&&s<v.columnIndex+v.cellFormat.columnSpan&&(u.childWidgets.splice(v.cellIndex,0,d),f=!0),f)break}if(!f&&c.length>0)for(var y=0;y<c.length;y++){var w=c[y];if(w.ownerRow!==u&&u.rowIndex<=w.ownerRow.rowIndex+w.cellFormat.rowSpan-1&&(w.columnIndex+w.cellFormat.columnSpan===s?(w.cellIndex>u.childWidgets.length?u.childWidgets.push(d):u.childWidgets.splice(w.cellIndex,0,d),f=!0):s>w.columnIndex&&w.columnIndex+w.cellFormat.columnSpan>s&&s<w.columnIndex+w.cellFormat.columnSpan&&(u.childWidgets.splice(w.columnIndex,0,d),f=!0)),f)break}}}a.updateRowIndex(0);var b=this.viewer.layout.getParentTable(a);b?b.fitChildToClientArea():a.fitChildToClientArea(),this.selection.owner.isLayoutEnabled=!0,a.isGridUpdated=!1,a.buildTableColumns(),a.isGridUpdated=!0,this.viewer.layout.reLayoutTable(a),this.selection.start.setPosition(l.firstChild,!0),this.selection.end.setPosition(this.selection.getLastParagraph(d).firstChild,!1),(this.checkIsNotRedoing()||t.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)}}},e.prototype.createTable=function(e,t){this.selection.start.paragraph;var i=new K;i.tableFormat=new R(i),i.tableFormat.preferredWidthType="Auto",i.tableFormat.initializeTableBorders();for(var r=0;r<e;){var n=this.createRowAndColumn(t,r);n.rowFormat.heightType="Auto",n.containerWidget=i,i.childWidgets.push(n),r++}return i},e.prototype.createRowAndColumn=function(e,t){var i=this.selection.start.paragraph,r=new X;r.rowFormat=new M(r),r.index=t;for(var n=0;n<e;n++){var o=this.createColumn(i);o.index=n,o.rowIndex=t,o.containerWidget=r,r.childWidgets.push(o)}return r},e.prototype.createColumn=function(e){var t=new Y,i=new G;return i.paragraphFormat.copyFormat(e.paragraphFormat),i.characterFormat.copyFormat(e.characterFormat),i.containerWidget=t,t.childWidgets.push(i),t.cellFormat=new H(t),t},e.prototype.getColumnCountToInsert=function(){var e=1,t=this.selection.start,i=this.selection.end;if(this.selection.isForward||(t=this.selection.end,i=this.selection.start),t&&i&&this.selection.getTable(t,i)){if(t.paragraph.associatedCell===i.paragraph.associatedCell)return e=1;if(t.paragraph.associatedCell.ownerRow===i.paragraph.associatedCell.ownerRow)return e=e+i.paragraph.associatedCell.cellIndex-t.paragraph.associatedCell.cellIndex;e=0;for(var r=t.paragraph.associatedCell.ownerTable.getColumnCellsForSelection(t.paragraph.associatedCell,i.paragraph.associatedCell),n=0;n<r.length;n++)t.paragraph.associatedCell.ownerRow===r[n].ownerRow&&e++}return 0===e?1:e},e.prototype.getRowCountToInsert=function(){var e=1,i=this.selection.start,r=this.selection.end;return this.selection.isForward||(i=this.selection.end,r=this.selection.start),t.isNullOrUndefined(i)||t.isNullOrUndefined(r)||t.isNullOrUndefined(this.selection.getTable(i,r))?0===e?1:e:e=i.paragraph.associatedCell===r.paragraph.associatedCell||i.paragraph.associatedCell.ownerRow===r.paragraph.associatedCell.ownerRow?1:e+this.getOwnerRow(!this.selection.isForward).rowIndex-this.getOwnerRow(this.selection.isForward).rowIndex},e.prototype.getOwnerCell=function(e){for(var i=void 0,r=e?this.selection.start.paragraph.associatedCell:this.selection.end.paragraph.associatedCell,n=e?this.selection.end.paragraph.associatedCell:this.selection.start.paragraph.associatedCell,o=(i=r).ownerTable;!t.isNullOrUndefined(o)&&o.containerWidget instanceof Y&&o!==n.ownerTable;)o=(i=o.containerWidget).ownerTable;return i},e.prototype.getOwnerRow=function(e){for(var i,r=e?this.selection.start.paragraph.associatedCell.ownerRow:this.selection.end.paragraph.associatedCell.ownerRow,n=e?this.selection.end.paragraph.associatedCell.ownerRow:this.selection.start.paragraph.associatedCell.ownerRow,o=(i=r).ownerTable;!t.isNullOrUndefined(o)&&o.containerWidget instanceof Y&&o!==n.ownerTable;)o=(i=o.containerWidget.ownerRow).ownerTable;return i},e.prototype.getOwnerTable=function(e){var t=void 0,i=this.selection.start.paragraph.associatedCell.ownerTable,r=this.selection.end.paragraph.associatedCell.ownerTable;for(t=e?i:r;t.containerWidget instanceof Y&&t!==(e?r:i);)t=t.containerWidget.ownerTable;return t},e.prototype.mergeSelectedCellsInTable=function(){if(this.canMergeCells()){this.checkIsNotRedoing()&&this.initHistory("MergeCells"),this.selection.owner.isShiftingEnabled=!0;this.selection.start;var e=this.selection.end;this.selection.isForward||(this.selection.end,e=this.selection.start);var i=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),n=this.selection.getContainerCellOf(i,r);if(n.ownerTable.contains(r)&&!this.selection.containsCell(n,r)){var o=i.ownerTable.combineWidget(this.viewer);i=this.selection.getSelectedCell(i,n),r=this.selection.getSelectedCell(r,n);var a=this.mergeSelectedCells(o,i,r),s=this.selection.getLastParagraph(a);e.setPosition(s.lastChild,!1)}(this.checkIsNotRedoing()||t.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection,!1)}},e.prototype.mergeSelectedCells=function(e,i,r){this.cloneTableToHistoryInfo(e);this.selection.owner.isLayoutEnabled=!1;var n=this.selection.getCellLeft(i.ownerRow,i),o=n+i.cellFormat.cellWidth,a=this.selection.getCellLeft(r.ownerRow,r),s=a+r.cellFormat.cellWidth,l=this.updateSelectedCellsInTable(n,o,a,s);n=l.start,o=l.end;for(var d=e.childWidgets.indexOf(r.ownerRow),h=e.childWidgets.indexOf(i.ownerRow),c=void 0,p=h;p<=d;p++){for(var g=e.childWidgets[p],u=0;u<g.childWidgets.length;u++){var f=g.childWidgets[u],m=this.selection.getCellLeft(g,f);if(W.round(n,2)<=W.round(m,2)&&W.round(m,2)<W.round(o,2))if(t.isNullOrUndefined(c))c=f;else{p===h&&(c.cellFormat.preferredWidth+=f.cellFormat.preferredWidth,c.cellFormat.columnSpan+=f.cellFormat.columnSpan,this.mergeBorders(c,f));for(var v=0;v<f.childWidgets.length;v++){var y=f.childWidgets[v];if(1===f.childWidgets.length&&y instanceof G&&0===y.childWidgets.length)break;c.childWidgets.push(y.clone())}g.childWidgets.splice(u,1),f.destroy(),u--}}if(0===g.childWidgets.length){var w=e.childWidgets.indexOf(g);g.updateRowBySpannedCells(),e.childWidgets.splice(w,1),g.destroy(),d--,p--}}return!t.isNullOrUndefined(c)&&h<d&&(c.cellFormat.rowSpan=d-h+1),this.updateBlockIndexAfterMerge(c),e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.layout.reLayoutTable(e),this.selection.owner.isLayoutEnabled=!0,c},e.prototype.mergeBorders=function(e,i){var r=void 0,n=null;if(t.isNullOrUndefined(e.cellFormat.borders)||(r=e.cellFormat.borders),t.isNullOrUndefined(i.cellFormat.borders)||(n=i.cellFormat.borders),!t.isNullOrUndefined(r)||!t.isNullOrUndefined(n))if(t.isNullOrUndefined(r))(r=new B(e.cellFormat)).copyFormat(n);else{if(t.isNullOrUndefined(n))return;e.ownerRow.rowIndex===i.ownerRow.rowIndex&&(r.top=e.getBorderBasedOnPriority(r.top,n.bottom),r.bottom=e.getBorderBasedOnPriority(r.bottom,n.bottom))}},e.prototype.updateBlockIndexAfterMerge=function(e){for(var t=0;t<e.childWidgets.length;t++)e.childWidgets[t].index=t},e.prototype.canMergeCells=function(){if(this.selection.isEmpty||!this.selection.start.paragraph.isInsideTable||!this.selection.end.paragraph.isInsideTable)return!1;this.selection.start,this.selection.end;this.selection.isForward||(this.selection.end,this.selection.start);var e=this.getOwnerCell(this.selection.isForward),i=this.getOwnerCell(!this.selection.isForward),r=this.selection.getContainerCellOf(e,i);if(r.ownerTable.contains(i)&&!this.selection.containsCell(r,i)){e=this.selection.getSelectedCell(e,r),i=this.selection.getSelectedCell(i,r);var n=1;if(e.ownerRow===i.ownerRow){for(var o=e.ownerRow.childWidgets.indexOf(e),a=o;a<=e.ownerRow.childWidgets.indexOf(i);a++){var s=e.ownerRow.childWidgets[a],l=s.previousWidget;if(a!==o){if(s.cellFormat.rowSpan!==n)return!1;if(!t.isNullOrUndefined(l)&&s.columnIndex!==l.cellFormat.columnSpan+l.columnIndex)return!1}n=s.cellFormat.rowSpan}return!0}return this.canMergeSelectedCellsInTable(e.ownerTable,e,i)}return!1},e.prototype.canMergeSelectedCellsInTable=function(e,i,r){var n=e.childWidgets.indexOf(r.ownerRow),o=e.childWidgets.indexOf(i.ownerRow),a=this.selection.getCellLeft(i.ownerRow,i),s=a+i.cellFormat.cellWidth,l=this.selection.getCellLeft(r.ownerRow,r),d=l+r.cellFormat.cellWidth,h=this.updateSelectedCellsInTable(a,s,l,d);a=h.start,s=h.end;for(var c=0,p=0,g=!1,u=!1,f=[],m=o;m<=n;m++){for(var v=e.childWidgets[m],y=0,w=0,b=!1,x=0;x<v.childWidgets.length;x++){var C=v.childWidgets[x],F=this.selection.getCellLeft(v,C);if(this.checkCellWithInSelection(a,s,F)){g=!1,u=!1,C.cellFormat.rowSpan>1&&f.push(C),b||(y=F,w=F,b=!0);var P=C.previousWidget;0!==w&&W.round(w,0)!==W.round(F,0)&&(w=F),w+=W.convertPointToPixel(C.cellFormat.cellWidth);var T=this.checkPrevOrNextCellIsWithinSel(a,s,C,!0),I=this.checkPrevOrNextCellIsWithinSel(a,s,C,!1),S=0===f.length||1===f.length&&f[0]===C,N=this.checkCurrentCell(f,C,T,I);if(m===n&&!t.isNullOrUndefined(P)&&C.cellFormat.rowSpan>P.cellFormat.rowSpan&&!N)return!1;if(m!==o)for(var O=0;O<f.length;O++){var L=f[O].ownerRow.rowIndex+f[O].cellFormat.rowSpan-1;if(L>=v.rowIndex){if(f[O].columnIndex>C.columnIndex?u=!0:g=!0,m===n&&f[O]!==C&&L>C.ownerRow.rowIndex+C.cellFormat.rowSpan-1)return!1;L!==v.rowIndex||this.checkPrevOrNextCellIsWithinSel(a,s,C,!1)||f.splice(f.indexOf(f[O]),1)}}if(T&&!t.isNullOrUndefined(P)&&S&&C.columnIndex!==P.columnIndex+1&&this.checkCellWidth(C))return!1}}if(m===o)c=y,p=w;else{if(w>0&&y>0&&(!g&&Math.round(c)!==Math.round(y)||!u&&Math.round(p)!==Math.round(w)))return!1;if(m===n)return!0}}return!1},e.prototype.checkCellWidth=function(e){var t=e.previousWidget,i=this.viewer.selection.getCellLeft(e.ownerRow,e),r=this.viewer.selection.getCellLeft(e.ownerRow,t)+W.convertPointToPixel(t.cellFormat.cellWidth);return W.round(r,2)!==W.round(i,2)},e.prototype.checkCellWithInSelection=function(e,t,i){return W.round(e,2)<=W.round(i,2)&&W.round(i,2)<W.round(t,2)},e.prototype.checkPrevOrNextCellIsWithinSel=function(e,i,r,n){var o=n?r.previousWidget:r.nextWidget,a=0;return!t.isNullOrUndefined(o)&&(a=this.viewer.selection.getCellLeft(o.ownerRow,o),this.checkCellWithInSelection(e,i,a))},e.prototype.checkCurrentCell=function(e,t,i,r){var n=t.ownerRow;if(e.length>0)for(var o=0;o<e.length;o++){var a=e[o].ownerRow,s=a.rowIndex+e[o].cellFormat.rowSpan-1;if(e[o]===t&&(1===e.length||this.checkRowSpannedCells(e,t))&&!r&&!i)return!0;if(e[o]!==t&&a.rowIndex<n.rowIndex&&s===n.rowIndex+t.cellFormat.rowSpan-1)return!0}return!1},e.prototype.checkRowSpannedCells=function(e,t){for(var i=0;i<e.length;i++)if(e[i]!==t&&e[i].columnIndex===t.columnIndex)return!0;return!1},e.prototype.insertNewParagraphWidget=function(e,i){if(this.updateInsertPosition(),this.insertParagraph(e,i),!i){var r=void 0,n=e;do{n=r=this.selection.getNextParagraphBlock(n)}while(r&&r.equals(e));t.isNullOrUndefined(r)?this.selection.selectParagraph(e,!0):this.selection.selectParagraph(r,!0)}this.fireContentChange()},e.prototype.insertParagraph=function(e,t){var i=this.selection.start.currentWidget,r=this.selection.start.offset,n=this.selection.start.paragraph;if(n=n.combineWidget(this.viewer),t){var o=this.selection.getLineLength(n.lastChild),a=e.firstChild?e.firstChild.children.length:0;this.moveInlines(n,e,a,r,i,o,n.lastChild)}else r>0&&this.moveInlines(n,e,0,0,n.firstChild,r,i);var s=n.getSplitWidgets(),l=(n=t?s[s.length-1]:s[0]).containerWidget.childWidgets.indexOf(n);t&&l++;var d=n.containerWidget;e.index=n.index,e.containerWidget=d,d.childWidgets.splice(l,0,e),this.updateNextBlocksIndex(t?n:e,!0),e.height=0,this.viewer.layout.layoutBodyWidgetCollection(e.index,d,e,!1)},e.prototype.moveInlines=function(e,t,i,r,n,o,a){if(0===t.childWidgets.length){var s=new J(t);t.childWidgets.push(s)}var l=!1;this.viewer.layout.clearListElementBox(e),this.viewer.layout.clearListElementBox(t);for(var d=0;d<e.childWidgets.length;d++){var h=e.childWidgets[d];if(n===h&&a===h){i=this.moveContent(h,r,o,i,t);break}if(a===h){i=this.moveContent(h,0,o,i,t);break}n===h?(l=!0,i=this.moveContent(h,r,this.viewer.selection.getLineLength(h),i,t)):l&&(i=this.moveContent(h,0,this.viewer.selection.getLineLength(h),i,t))}this.removeEmptyLine(e),e.isInsideTable||this.viewer.layout.reLayoutParagraph(e,0,0)},e.prototype.moveContent=function(e,t,i,r,n){for(var o=0,a=(e.paragraph.childWidgets.indexOf(e),0);a<e.children.length;a++){var s=e.children[a];if(t>=o+s.length||s instanceof ne)s instanceof ne||(o+=s.length);else{var l=0;t>o&&(l=t-o);var d=i-o;if(d>s.length&&(d=s.length),l>0&&(o+=l),0===l&&d===s.length)n.firstChild.children.splice(r,0,s),s.line=n.firstChild,r++,e.children.splice(a,1),a--;else if(s instanceof Q){var h=new Q;h.characterFormat.copyFormat(s.characterFormat),h.text=s.text.substr(l,d-l),n.firstChild.children.splice(r,0,h),h.line=n.firstChild,r++,s.text=s.text.slice(0,l)+s.text.slice(d)}if(i<=o+d-l)break;o+=d-l}}return r},e.prototype.updateComplexWithoutHistory=function(e,t,i){var r=this.viewer.selection;if(0===e){n=new Ie(r.owner);this.setPositionForCurrentIndex(n,t),this.viewer.layout.reLayoutParagraph(n.paragraph,0,0),this.setPositionForCurrentIndex(r.start,i),this.setPositionForCurrentIndex(r.end,i)}if(1===e){var n=new Ie(r.owner);this.setPositionForCurrentIndex(n,t);var o=new Ie(r.owner);this.setPositionForCurrentIndex(o,i),this.viewer.layout.reLayoutParagraph(n.paragraph,0,0),o.paragraph!==n.paragraph&&this.viewer.layout.reLayoutParagraph(o.paragraph,0,0)}r.owner.isShiftingEnabled&&(this.viewer.layout.shiftLayoutedItems(),this.viewer.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget()),r.owner.isShiftingEnabled=!1,r.start.updatePhysicalPosition(!0),r.isEmpty?r.end.setPositionInternal(r.start):r.end.updatePhysicalPosition(!0),r.upDownSelectionLength=r.end.location.x,r.fireSelectionChanged(!0),this.viewer.updateFocus(),this.viewer.updateScrollBars(),this.fireContentChange(),this.isHandledComplex=!0},e.prototype.reLayout=function(e,i){if(!this.viewer.isComposingIME&&this.editorHistory&&this.editorHistory.isHandledComplexHistory())return(t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||this.editorHistory.currentBaseHistoryInfo&&"ClearCharacterFormat"!==this.editorHistory.currentBaseHistoryInfo.action&&"ClearParagraphFormat"!==this.editorHistory.currentBaseHistoryInfo.action)&&(this.startParagraph=void 0,this.endParagraph=void 0),void(this.isHandledComplex=!1);t.isNullOrUndefined(this.viewer.blockToShift)&&(this.viewer.removeEmptyPages(),this.viewer.layout.updateFieldElements(),this.viewer.updateScrollBars(),e.owner.isShiftingEnabled||(e.fireSelectionChanged(!0),this.startParagraph=void 0,this.endParagraph=void 0)),t.isNullOrUndefined(i)&&(i=e.isEmpty),e.owner.isShiftingEnabled&&(e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,this.viewer.layout.shiftLayoutedItems(),this.viewer.owner.enableHeaderAndFooter&&this.updateHeaderFooterWidget(),this.getOffsetValue(e),e.upDownSelectionLength=e.end.location.x,e.fireSelectionChanged(!0),this.viewer.updateFocus(),this.startParagraph=void 0,this.endParagraph=void 0,this.viewer.layout.allowLayout=!0),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&("RowResizing"!==this.editorHistory.currentBaseHistoryInfo.action&&"CellResizing"!==this.editorHistory.currentBaseHistoryInfo.action||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(this.editorHistory.currentBaseHistoryInfo.modifiedProperties.length>0&&this.editorHistory.currentBaseHistoryInfo.updateSelection(),this.editorHistory.updateHistory()),this.fireContentChange()},e.prototype.updateHeaderFooterWidget=function(){this.updateHeaderFooterWidgetToPage(this.selection.start.paragraph.bodyWidget),this.shiftPageContent(this.selection.start.paragraph.bodyWidget)},e.prototype.updateHeaderFooterWidgetToPage=function(e){for(var t=e.page,i="EvenHeader"===(e=this.viewer.layout.updateHeaderFooterToParent(e)).headerFooterType||"EvenFooter"===e.headerFooterType,r=0;r<this.viewer.pages.length;r++){var n=this.viewer.pages[r];if(r+1===1&&n.bodyWidgets[0].sectionFormat.differentFirstPage&&-1!==e.headerFooterType.indexOf("FirstPage"))return;0===n.index&&n.bodyWidgets[0].sectionFormat.differentFirstPage&&-1===e.headerFooterType.indexOf("FirstPage")||t!==n&&(n.bodyWidgets[0].sectionFormat.differentOddAndEvenPages?i&&(r+1)%2==0?this.updateHeaderFooterWidgetToPageInternal(n,e,-1!==e.headerFooterType.indexOf("Header")):i||(r+1)%2==0||n.bodyWidgets[0].sectionFormat.differentFirstPage&&r+1!==1&&this.updateHeaderFooterWidgetToPageInternal(n,e,-1!==e.headerFooterType.indexOf("Header")):this.updateHeaderFooterWidgetToPageInternal(n,e,-1!==e.headerFooterType.indexOf("Header")))}},e.prototype.updateHeaderFooterWidgetToPageInternal=function(e,t,i){if(t.page!==e){var r=t.clone();r.page=e,this.viewer.updateHFClientArea(r.sectionFormat,i),r=this.viewer.layout.layoutHeaderFooterItems(this.viewer,r);var n=void 0;i?(n=e.headerWidget,e.headerWidget=r):(n=e.footerWidget,e.footerWidget=r),this.removeFieldInWidget(n),n.destroy()}},e.prototype.removeFieldInWidget=function(e){for(var t=0;t<e.childWidgets.length;t++)this.removeFieldInBlock(e.childWidgets[t])},e.prototype.removeFieldInBlock=function(e){e instanceof K?this.removeFieldTable(e):this.removeField(e)},e.prototype.removeFieldTable=function(e){for(var t=0;t<e.childWidgets.length;t++)for(var i=e.childWidgets[t],r=0;r<i.childWidgets.length;r++)this.removeFieldInWidget(i.childWidgets[r])},e.prototype.shiftPageContent=function(e){var t,i=e.headerFooterType;"FirstPageHeader"===i||"FirstPageFooter"===i?t=0:e.sectionFormat.differentOddAndEvenPages?t=e.sectionFormat.differentFirstPage?"EvenHeader"===i||"EvenFooter"===i?1:2:-1===i.indexOf("Even")?0:1:1===(t=e.sectionFormat.differentFirstPage?1:0)&&1===this.viewer.pages.length&&(t=0);var r=this.viewer.pages[t];if(-1!==i.indexOf("Header")){var n=r.bodyWidgets[0].firstChild,o=W.convertPointToPixel(e.sectionFormat.topMargin),a=W.convertPointToPixel(e.sectionFormat.headerDistance);if(o=Math.max(a+r.headerWidget.height,o),n.y!==o){this.viewer.updateClientArea(r.bodyWidgets[0].sectionFormat,r);var s=(n=n.combineWidget(this.viewer)).previousRenderedWidget;s&&(this.viewer.cutFromTop(s.y+s.height),n.containerWidget!==s.containerWidget&&this.viewer.layout.updateContainerWidget(n,s.containerWidget,s.indexInOwner+1,!1)),this.viewer.blockToShift=n}}else this.checkAndShiftFromBottom(r,e);this.viewer.blockToShift&&(this.viewer.renderedLists.clear(),this.viewer.layout.shiftLayoutedItems())},e.prototype.checkAndShiftFromBottom=function(e,t){for(var i,r=e.bodyWidgets[0],n=0;n<r.childWidgets.length;n++){var o=r.childWidgets[n];if(o.y+o.height>t.y){i=o;break}if(r.childWidgets.length-1===n&&o.y+o.height<t.y){i=o;break}}this.viewer.updateClientArea(r.sectionFormat,e),this.viewer.cutFromTop(i.y),this.viewer.blockToShift=i},e.prototype.onApplyCharacterFormat=function(e,i,r){var n=this.viewer.selection;if(!n.owner.isReadOnlyMode&&n.owner.isDocumentLoaded){r=!t.isNullOrUndefined(r)&&r;var o=e[0].toUpperCase()+e.slice(1),a=n.start.paragraph;a.childWidgets[a.childWidgets.length-1];if(n.isEmpty&&"List"!==n.contextType)return n.skipFormatRetrieval=!0,n.end.isAtParagraphEnd?(this.initHistory(o),this.viewer.owner.isShiftingEnabled=!0,this.applyCharFormatValue(a.characterFormat,e,i,r),this.reLayout(this.viewer.selection),this.viewer.updateFocus()):n.fireSelectionChanged(!0),void(n.skipFormatRetrieval=!1);this.setOffsetValue(n),this.initHistory(o),"List"===n.contextType?this.applyCharacterFormatForListText(n,e,i,r):this.updateSelectionCharacterFormatting(e,i,r)}},e.prototype.applyCharacterFormatForListText=function(e,i,r,n){var o=this.getListLevel(e.start.paragraph);if(!t.isNullOrUndefined(o)){var a=o.characterFormat;switch(i){case"bold":this.applyListCharacterFormatByValue(e,a,"bold",!a.bold);break;case"italic":this.applyListCharacterFormatByValue(e,a,"italic",!a.italic);break;case"fontColor":this.applyListCharacterFormatByValue(e,a,"fontColor",r);break;case"fontFamily":this.applyListCharacterFormatByValue(e,a,"fontFamily",r);break;case"fontSize":this.applyListCharacterFormatByValue(e,a,"fontSize",r);break;case"highlightColor":this.applyListCharacterFormatByValue(e,a,"highlightColor",r);break;case"baselineAlignment":a.baselineAlignment===r&&(r="Normal"),this.applyListCharacterFormatByValue(e,a,"baselineAlignment",r);break;case"strikethrough":a.strikethrough===r&&(r="None"),this.applyListCharacterFormatByValue(e,a,"strikethrough",r);break;case"underline":a.underline===r&&(r="None"),this.applyListCharacterFormatByValue(e,a,"underline",r);break;case"characterFormat":this.applyListCharacterFormatByValue(e,a,void 0,r)}}},e.prototype.applyListCharacterFormatByValue=function(e,t,i,r){this.initHistory("ListCharacterFormat"),this.applyCharFormatValue(t,i,r,!1),this.editorHistory.updateHistory(),this.reLayout(e),this.fireContentChange()},e.prototype.updateListCharacterFormat=function(e,t,i){this.updateListTextSelRange(e,t,i,!1)},e.prototype.updateListTextSelRange=function(e,t,i,r){this.viewer.owner.isShiftingEnabled=!0;var n=e.start,o=e.end;e.isForward||(n=e.end,o=e.start),this.initHistoryPosition(e,n);var a=this.getListLevel(e.start.paragraph);this.applyCharFormatValue(a.characterFormat,t,i,r),this.startSelectionReLayouting(n.paragraph,e,n,o)},e.prototype.getListLevel=function(e){var i=void 0,r=0;if(t.isNullOrUndefined(e.paragraphFormat)||t.isNullOrUndefined(e.paragraphFormat.listFormat)||(i=this.viewer.getListById(e.paragraphFormat.listFormat.listId),r=e.paragraphFormat.listFormat.listLevelNumber),!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(this.viewer.getAbstractListById(i.abstractListId))&&!t.isNullOrUndefined(this.viewer.getAbstractListById(i.abstractListId).levels))return this.viewer.layout.getListLevel(i,r)},e.prototype.updateInsertPosition=function(){var e=this.viewer.selection,i=e.start;e.isForward||(i=e.end),!this.editorHistory||t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||t.isNullOrUndefined(i)||t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&this.updateHistoryPosition(i,!0)},e.prototype.setOffsetValue=function(e){var t=this.getParagraphInfo(e.start);this.startParagraph=t.paragraph,this.startOffset=t.offset,t=this.getParagraphInfo(e.end),this.endParagraph=t.paragraph,this.endOffset=t.offset},e.prototype.toggleHighlightColor=function(e){var i=this.viewer.selection;(t.isNullOrUndefined(e)||"NoColor"===e)&&(e="Yellow"),i.characterFormat.highlightColor===e&&(e="NoColor"),this.selection.characterFormat.highlightColor=e},e.prototype.toggleSubscript=function(){if(!this.owner.isReadOnlyMode){var e="Subscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Subscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.toggleSuperscript=function(){if(!this.owner.isReadOnlyMode){var e="Superscript"===this.selection.characterFormat.baselineAlignment?"Normal":"Superscript";this.selection.characterFormat.baselineAlignment=e}},e.prototype.increaseIndent=function(){this.owner.isReadOnlyMode||this.onApplyParagraphFormat("leftIndent",this.viewer.defaultTabWidth,!0,!1)},e.prototype.decreaseIndent=function(){this.owner.isReadOnlyMode||this.onApplyParagraphFormat("leftIndent",-this.viewer.defaultTabWidth,!0,!1)},e.prototype.clearList=function(){this.selection.owner.editorModule.onApplyList(void 0)},e.prototype.applyBullet=function(e,t){this.owner.isReadOnlyMode||this.applyBulletOrNumbering(e,"Bullet",t)},e.prototype.applyNumbering=function(e,t){this.owner.isReadOnlyMode||this.applyBulletOrNumbering(e,t,"Verdana")},e.prototype.toggleBaselineAlignment=function(e){this.updateProperty(2,e)},e.prototype.clearFormatting=function(){var e=this.viewer.selection;this.initComplexHistory("ClearFormat"),e.isEmpty&&(e.start.moveToParagraphStartInternal(e,!1),e.end.moveToParagraphEndInternal(e,!1)),this.setOffsetValue(e),this.editorHistory&&this.editorHistory.initializeHistory("ClearCharacterFormat"),this.updateSelectionCharacterFormatting("ClearCharacterFormat",void 0,!1),this.getOffsetValue(e),this.editorHistory&&this.editorHistory.updateHistory(),this.setOffsetValue(e),this.editorHistory&&this.editorHistory.initializeHistory("ClearParagraphFormat"),this.updateParagraphFormatInternal("ClearParagraphFormat",void 0,!1),this.editorHistory&&this.editorHistory.updateHistory(),this.getOffsetValue(e),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&this.editorHistory.updateComplexHistory(),this.startParagraph=void 0,this.endParagraph=void 0},e.prototype.updateProperty=function(e,i){var r=this.selection;if(!r.owner.isReadOnlyMode&&r.owner.isDocumentLoaded){var n=r.start;r.end;r.isForward||(n=r.end,r.start);var o=0,a=n.currentWidget.getInline(n.offset,o),s=a.element;o=a.index;var l=n.paragraph;if(t.isNullOrUndefined(s)||s.length!==o||this.selection.isEmpty||(s=s.nextNode),1===e){var d="None";t.isNullOrUndefined(s)?t.isNullOrUndefined(l)||(d=l.characterFormat.underline):d=s.characterFormat.underline,this.selection.characterFormat.underline=i===d?"None":i}else{var h="Normal";t.isNullOrUndefined(s)?t.isNullOrUndefined(l)||(h=l.characterFormat.baselineAlignment):h=s.characterFormat.baselineAlignment,h===i&&(i="Normal"),this.selection.characterFormat.baselineAlignment=i}}},e.prototype.getCompleteStyles=function(){for(var e='{"styles":[',t=0,i=this.viewer.preDefinedStyles.getItem();t<i.length;t++){var r=i[t];e+=this.viewer.preDefinedStyles.get(r)+","}return e.slice(0,-1)+"]}"},e.prototype.intializeDefaultStyles=function(){for(var e=this.owner.getStyleNames("Paragraph"),t=0,i=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"].filter(function(t){return-1===e.indexOf(t)});t<i.length;t++){var r=i[t];this.createStyle(this.viewer.preDefinedStyles.get(r))}},e.prototype.createStyle=function(e){this.createStyleIn(e)},e.prototype.createStyleIn=function(e){var t=JSON.parse(e);return void 0!==this.viewer.styles.findByName(t.name)&&(t.name=this.getUniqueStyleName(t.name)),this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),t,this.viewer.styles),this.viewer.styles.findByName(t.name)},e.prototype.getUniqueStyleName=function(e){for(var i=this.getUniqueName(e),r=this.viewer.styles.findByName(i);!t.isNullOrUndefined(r);)i=this.getUniqueStyleName(r.name),r=this.viewer.styles.findByName(i);return i},e.prototype.getUniqueName=function(e){var i=e.match(/\d+$/);return!t.isNullOrUndefined(i)&&i.length>0?e.replace(i[0],(parseInt(i[0],10)+1).toString()):e+"_1"},e.prototype.updateSelectionCharacterFormatting=function(e,i,r){switch(t.isNullOrUndefined(e)&&(e="CharacterFormat"),e){case"bold":this.updateCharacterFormat("bold",i);break;case"italic":this.updateCharacterFormat("italic",i);break;case"fontColor":this.updateCharacterFormat("fontColor",i);break;case"fontFamily":this.updateCharacterFormat("fontFamily",i);break;case"fontSize":this.updateCharacterFormatWithUpdate(this.viewer.selection,"fontSize",i,r);break;case"highlightColor":this.updateCharacterFormat("highlightColor",i);break;case"baselineAlignment":this.updateCharacterFormat("baselineAlignment",i);break;case"strikethrough":this.updateCharacterFormat("strikethrough",i);break;case"underline":this.updateCharacterFormat("underline",i);break;case"styleName":this.updateCharacterFormatWithUpdate(this.viewer.selection,"styleName",i,!0);break;case"CharacterFormat":case"ClearCharacterFormat":this.updateCharacterFormat(void 0,i)}this.reLayout(this.viewer.selection)},e.prototype.updateCharacterFormat=function(e,t){this.updateCharacterFormatWithUpdate(this.viewer.selection,e,t,!1)},e.prototype.updateCharacterFormatWithUpdate=function(e,t,i,r){this.viewer.owner.isShiftingEnabled=!0;var n=e.start,o=e.end;e.isForward||(n=e.end,o=e.start),this.applyCharFormatSelectedContent(n.paragraph,e,n,o,t,i,r)},e.prototype.applyCharFormatSelectedContent=function(e,t,i,r,n,o,a){if(!i.paragraph.isInsideTable||r.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!t.isCellSelected(i.paragraph.associatedCell,i,r))this.applyCharFormat(e,t,i,r,n,o,a);else{var s=void 0;i.paragraph.associatedCell.ownerTable.combineWidget(this.viewer),this.checkInsertPosition(t)&&this.updateHistoryPosition(i,!0),s=i.paragraph.associatedCell,this.applyCharFormatCell(s,t,i,r,n,o,a);var l=s.ownerTable;this.viewer.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}},e.prototype.applyCharFormatForSelectedPara=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++)for(var a=e.childWidgets[o],s=0;s<a.children.length;s++){var l=a.children[s];this.applyCharFormatValue(l.characterFormat,i,r,n)}this.applyCharFormatValue(e.characterFormat,i,r,n)},e.prototype.splittedLastParagraph=function(e){var t=e.getSplitWidgets();return t[t.length-1]},e.prototype.getNextParagraphForCharacterFormatting=function(e,i,r,n,o,a){var s=e.getSplitWidgets();e=s[s.length-1],e=this.viewer.selection.getNextRenderedBlock(e),t.isNullOrUndefined(e)||(e instanceof G?this.applyCharFormat(e,this.viewer.selection,i,r,n,o,a):this.applyCharFormatForTable(0,e,this.viewer.selection,i,r,n,o,a))},e.prototype.applyCharFormat=function(e,i,r,n,o,a,s){e=e.combineWidget(this.viewer);var l=0,d=i.getParagraphLength(e),h=-1!==e.childWidgets.indexOf(r.currentWidget)?e.childWidgets.indexOf(r.currentWidget):0,c=n.offset,p=-1!==e.childWidgets.indexOf(n.currentWidget)?e.childWidgets.indexOf(n.currentWidget):e.childWidgets.length-1;if(t.isNullOrUndefined(i)||e===r.paragraph&&(l=r.offset),e.equals(n.paragraph)){var g=e.childWidgets[e.childWidgets.length-1];i.isParagraphLastLine(g)&&n.currentWidget===g&&(c===i.getLineLength(g)+1||i.isEmpty&&i.end.isAtParagraphEnd)&&this.applyCharFormatValue(e.characterFormat,o,a,s)}else this.applyCharFormatValue(e.characterFormat,o,a,s),c=d;for(var u=h;u<=p;u++){var f=e.childWidgets[u];u!==h&&(l=i.getStartLineOffset(f)),c=f===n.currentWidget?n.offset:i.getLineLength(f);for(var m=0,v=0;v<f.children.length;v++){var y=f.children[v];if(!(y instanceof ne))if(l>=m+y.length)m+=y.length;else{var w=0;l>m&&(w=l-m);var b=c-m,x=y.length;if(b>x&&(b=x),v+=this.applyCharFormatInline(y,i,w,b,o,a,s),c<=m+x)break;m+=x}}}var C=n.paragraph;this.viewer.layout.reLayoutParagraph(e,h,0),e.equals(C)||this.getNextParagraphForCharacterFormatting(e,r,n,o,a,s)},e.prototype.toggleBold=function(){if(!this.viewer.owner.isReadOnlyMode){var e=this.getCurrentSelectionValue("bold");this.selection.characterFormat.bold=e}},e.prototype.toggleItalic=function(){if(!this.viewer.owner.isReadOnlyMode){var e=this.getCurrentSelectionValue("italic");this.selection.characterFormat.italic=e}},e.prototype.getCurrentSelectionValue=function(e){var i=!1;if("bold"===e||"italic"===e){var r=0,n=this.selection.start;this.selection.isForward||(n=this.selection.end);var o=n.currentWidget,a=o.getInline(n.offset,r),s=a.element;r=a.index;var l=o.paragraph.characterFormat;t.isNullOrUndefined(s)||(l=this.selection.isEmpty||r!==s.length?s.characterFormat:t.isNullOrUndefined(s.nextNode)?o.paragraph.characterFormat:s.nextNode.characterFormat),"bold"===e&&(i=!l.bold),"italic"===e&&(i=!l.italic)}return i},e.prototype.toggleUnderline=function(e){this.owner.isReadOnlyMode||this.updateProperty(1,e)},e.prototype.toggleStrikethrough=function(e){if(!this.owner.isReadOnlyMode){var i=void 0;i=t.isNullOrUndefined(e)?"SingleStrike"===this.selection.characterFormat.strikethrough?"None":"SingleStrike":e,this.selection.characterFormat.strikethrough=i}},e.prototype.updateFontSize=function(e,t){if("number"==typeof t&&!(t<0&&1===e.fontSize))return e.fontSize+t;var i=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];if("string"==typeof t&&"increment"===t){if(e.fontSize<8)return e.fontSize+1;if(e.fontSize>=72&&e.fontSize<80)return 80;if(e.fontSize>=80)return e.fontSize+10;for(r=0;r<i.length;r++)if(e.fontSize<i[r])return i[r]}else if("string"==typeof t&&"decrement"===t&&e.fontSize>1){if(e.fontSize<=8)return e.fontSize-1;if(e.fontSize>72&&e.fontSize<=80)return 72;if(e.fontSize>80)return e.fontSize-10;for(var r=0;r<i.length;r++)if(e.fontSize<=i[r])return i[r-1]}return e.fontSize},e.prototype.applyCharFormatInline=function(e,t,i,r,n,o,a){return 0===i&&r===e.length?(this.applyCharFormatValue(e.characterFormat,n,o,a),0):e instanceof Q?this.formatInline(e,t,i,r,n,o,a):0},e.prototype.formatInline=function(e,t,i,r,n,o,a){var s,l=0,d=e,h=e.line.children.indexOf(d);e.paragraph.childWidgets.indexOf(e.line);return i>0&&((s=new Q).characterFormat.copyFormat(e.characterFormat),s.line=e.line,s.text=e.text.substr(i,r-i),this.applyCharFormatValue(s.characterFormat,n,o,a),h++,d.line.children.splice(h,0,s),l++),r<d.length&&((s=new Q).characterFormat.copyFormat(e.characterFormat),s.text=d.text.substring(r),s.line=e.line,h++,d.line.children.splice(h,0,s),l++),0===i?(e.text=e.text.substr(0,r),this.applyCharFormatValue(e.characterFormat,n,o,a)):e.text=e.text.substr(0,i),l},e.prototype.applyCharFormatCell=function(e,t,i,r,n,o,a){if(r.paragraph.isInsideTable){var s=t.getContainerCellOf(e,r.paragraph.associatedCell);if(s.ownerTable.contains(r.paragraph.associatedCell)){var l=t.getSelectedCell(e,s),d=t.getSelectedCell(r.paragraph.associatedCell,s);t.containsCell(s,r.paragraph.associatedCell)?t.isCellSelected(s,i,r)?(o=this.getCharacterFormatValueOfCell(e,t,o,n),this.applyCharFormatForSelectedCell(s,t,n,o,a)):l===s?this.applyCharFormat(i.paragraph,t,i,r,n,o,a):this.applyCharFormatRow(l.ownerRow,t,i,r,n,o,a):this.applyCharFormatForTableCell(s.ownerTable,t,s,d,n,o,a)}else this.applyCharFormatRow(s.ownerRow,t,i,r,n,o,a)}else{var h=t.getContainerCell(e);this.applyCharFormatRow(h.ownerRow,t,i,r,n,o,a)}},e.prototype.applyCharFormatForSelectedCell=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++){var a=e.childWidgets[o];a instanceof G?this.applyCharFormatForSelectedPara(a,t,i,r,n):this.applyCharFormatForSelTable(a,t,i,r,n)}},e.prototype.applyCharFormatRow=function(e,t,i,r,n,o,a){o=this.getCharacterFormatValueOfCell(e.childWidgets[0],t,o,n),this.applyCharFormatForTable(e.rowIndex,e.ownerTable,t,i,r,n,o,a)},e.prototype.applyCharFormatForTable=function(e,t,i,r,n,o,a,s){t=t.combineWidget(this.viewer);for(var l=e;l<t.childWidgets.length;l++){for(var d=t.childWidgets[l],h=0;h<d.childWidgets.length;h++)this.applyCharFormatForSelectedCell(d.childWidgets[h],i,o,a,s);if(n.paragraph.isInsideTable&&i.containsRow(d,n.paragraph.associatedCell))return void this.viewer.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)}this.viewer.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1),this.getNextParagraphForCharacterFormatting(t,r,n,o,a,s)},e.prototype.applyCharFormatForSelTable=function(e,t,i,r,n){for(var o=0;o<e.childWidgets.length;o++)for(var a=e.childWidgets[o],s=0;s<a.childWidgets.length;s++)this.applyCharFormatForSelectedCell(a.childWidgets[s],t,i,r,n)},e.prototype.applyCharFormatForTableCell=function(e,t,i,r,n,o,a){var s=t.getCellLeft(i.ownerRow,i),l=s+i.cellFormat.cellWidth,d=t.getCellLeft(r.ownerRow,r),h=d+r.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(s,l,d,h);s=c.start,l=c.end;for(var p=e.childWidgets.indexOf(r.ownerRow),g=!1,u=e.childWidgets.indexOf(i.ownerRow);u<=p;u++)for(var f=e.childWidgets[u],m=0;m<f.childWidgets.length;m++){var v=t.getCellLeft(f,f.childWidgets[m]);W.round(s,2)<=W.round(v,2)&&W.round(v,2)<W.round(l,2)&&(g||(o=this.getCharacterFormatValueOfCell(f.childWidgets[m],t,o,n),g=!0),this.applyCharFormatForSelectedCell(f.childWidgets[m],t,n,o,a))}},e.prototype.updateSelectedCellsInTable=function(e,t,i,r){var n=this.viewer.selection;return e>i&&(e=i),t<r&&(t=r),e>n.upDownSelectionLength&&(e=n.upDownSelectionLength),t<n.upDownSelectionLength&&(t=n.upDownSelectionLength),{start:e,end:t}},e.prototype.getCharacterFormatValueOfCell=function(e,t,i,r){if("boolean"==typeof i||void 0===i&&("bold"===r||"italic"===r)){var n=t.getFirstParagraph(e),o=n.characterFormat;n.childWidgets.length>0&&n.childWidgets[0].children.length>0&&(o=n.childWidgets[0].children[0].characterFormat),i=!o.getPropertyValue(r)}return i},e.prototype.applyCharFormatValueInternal=function(e,t,i,r){this.applyCharFormatValue(t,i,r,!1)},e.prototype.copyInlineCharacterFormat=function(e,t){t.uniqueCharacterFormat=e.uniqueCharacterFormat,t.baseCharStyle=e.baseCharStyle},e.prototype.applyCharFormatValue=function(e,i,r,n){return n&&"fontSize"===i&&(r=this.updateFontSize(e,r)),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(r=this.editorHistory.currentBaseHistoryInfo.addModifiedProperties(e,i,r)),r instanceof P?void(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyInlineCharacterFormat(r,e):e.copyFormat(r)):t.isNullOrUndefined(r)?void e.clearFormat():void("bold"===i?e.bold=r:"italic"===i?e.italic=r:"fontColor"===i?e.fontColor=r:"fontFamily"===i?e.fontFamily=r:"fontSize"===i?e.fontSize=r:"highlightColor"===i?e.highlightColor=r:"baselineAlignment"===i?e.baselineAlignment=r:"strikethrough"===i?e.strikethrough=r:"underline"===i?e.underline=r:"styleName"===i&&(e.baseCharStyle=r))},e.prototype.onImageFormat=function(e,t,i){var r=new Oe(e);this.editorHistory&&(this.editorHistory.initializeHistory("ImageResizing"),this.editorHistory.currentBaseHistoryInfo.modifiedProperties.push(r)),this.setOffsetValue(this.selection),e.width=t,e.height=i,this.viewer.layout.reLayoutParagraph(e.line.paragraph,e.line.indexInOwner,0),this.reLayout(this.selection,!1),this.viewer.owner.imageResizerModule&&this.viewer.owner.imageResizerModule.positionImageResizer(e)},e.prototype.toggleTextAlignment=function(e){!this.viewer.owner.isReadOnlyMode&&this.viewer.owner.isDocumentLoaded&&(t.isNullOrUndefined(this.viewer.selection.paragraphFormat.textAlignment)||this.viewer.selection.paragraphFormat.textAlignment!==e?this.onApplyParagraphFormat("textAlignment",e,!1,!0):"Left"===e?this.onApplyParagraphFormat("textAlignment","Justify",!1,!0):this.onApplyParagraphFormat("textAlignment","Left",!1,!0))},e.prototype.onApplyParagraphFormat=function(e,t,i,r){var n=e[0].toUpperCase()+e.slice(1);this.viewer.owner.isShiftingEnabled=!0;var o=this.viewer.selection;if(this.initHistory(n),!this.viewer.owner.isReadOnlyMode&&this.viewer.owner.isDocumentLoaded){if("leftIndent"===e&&-1!==o.paragraphFormat.listId&&i)return void this.updateListLevel(t>0);if(o.isEmpty){this.setOffsetValue(o),i&&"leftIndent"===e&&(t=this.getIndentIncrementValue(o.start.paragraph,t));var a=o.start.paragraph.combineWidget(this.viewer);this.applyParaFormatProperty(a,e,t,i),this.layoutItemBlock(a,!1)}else this.setOffsetValue(o),this.updateSelectionParagraphFormatting(e,t,i);this.reLayout(o)}},e.prototype.updateListLevel=function(e){var i,r=this.viewer,n=(this.viewer.selection.start.paragraph.paragraphFormat.listFormat,this.viewer.selection.start.paragraph.paragraphFormat),o=r.getListById(n.listFormat.listId);r.layout.getListLevel(o,n.listFormat.listLevelNumber);i=e?n.listFormat.listLevelNumber+1:n.listFormat.listLevelNumber-1;var a=r.layout.getListLevel(o,i);t.isNullOrUndefined(a)||(this.onApplyListInternal(o,i),r.selection.start.updatePhysicalPosition(!0),r.selection.end.updatePhysicalPosition(!0),r.selection.updateCaretPosition())},e.prototype.onApplyListInternal=function(e,i){this.viewer.selection;var r=new x;!t.isNullOrUndefined(e)&&i>=0&&i<9&&(r.listId=e.listId,r.listLevelNumber=i),this.onApplyParagraphFormat("listFormat",r,!1,!1)},e.prototype.updateSelectionParagraphFormatting=function(e,i,r){var n=this.viewer.selection;"leftIndent"===e&&r&&(i=!t.isNullOrUndefined(n.start)&&n.start.isExistBefore(n.end)?this.getIndentIncrementValue(n.start.paragraph,i):this.getIndentIncrementValue(n.end.paragraph,i)),this.updateParagraphFormatInternal(e,i,r)},e.prototype.getIndentIncrementValue=function(e,t){var i=e.paragraphFormat.leftIndent;if(i<0){if(t<0||i+t>=0)return-i;var r=-this.getIndentIncrementValueInternal(-i,-t);return r%t==0?r:r+t}return this.getIndentIncrementValueInternal(i,t)},e.prototype.getIndentIncrementValueInternal=function(e,t){var i=Math.abs(t);if(0===e||0===i)return t>0?i:0;var r=100*Math.round(e)%(100*Math.round(i))/100,n=(Math.round(e)-r)/Math.round(i)*i;return t>0&&(n+=i),n-e==0?t:n-e},e.prototype.updateParagraphFormatInternal=function(e,i,r){switch(t.isNullOrUndefined(e)&&(e="ParagraphFormat"),e){case"afterSpacing":this.updateParagraphFormat("afterSpacing",i,!1);break;case"beforeSpacing":this.updateParagraphFormat("beforeSpacing",i,!1);break;case"rightIndent":this.updateParagraphFormat("rightIndent",i,!1);break;case"leftIndent":this.updateParagraphFormat("leftIndent",i,r);break;case"firstLineIndent":this.updateParagraphFormat("firstLineIndent",i,!1);break;case"lineSpacing":this.updateParagraphFormat("lineSpacing",i,!1);break;case"lineSpacingType":this.updateParagraphFormat("lineSpacingType",i,!1);break;case"textAlignment":this.updateParagraphFormat("textAlignment",i,!1);break;case"listFormat":this.updateParagraphFormat("listFormat",i,!1);break;case"ParagraphFormat":this.updateParagraphFormat(void 0,i,!1);break;case"styleName":this.updateParagraphFormat("styleName",i,!1);break;case"ClearParagraphFormat":this.updateParagraphFormat(void 0,i,!1)}},e.prototype.updateParagraphFormat=function(e,t,i){var r=this.viewer.selection,n=r.start,o=r.end;r.isForward||(n=r.end,o=r.start),this.applyParaFormatSelectedContent(n,o,e,t,i)},e.prototype.applyParaFormatSelectedContent=function(e,i,r,n,o){var a=this.viewer.selection;if(!e.paragraph.isInsideTable||i.paragraph.isInsideTable&&e.paragraph.associatedCell===i.paragraph.associatedCell&&!a.isCellSelected(e.paragraph.associatedCell,e,i)){if(!t.isNullOrUndefined(n)&&!this.selection.isEmpty&&"styleName"===r&&this.applyCharacterStyle(e.paragraph,e,i,r,n,o))return;this.applyParaFormat(e.paragraph,e,i,r,n,o)}else{var s=void 0;e.paragraph.associatedCell.ownerTable.combineWidget(this.viewer),this.checkInsertPosition(a)&&this.updateHistoryPosition(e,!0),s=e.paragraph.associatedCell,this.applyParaFormatInCell(s,e,i,r,n,o);var l=s.ownerTable;this.viewer.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}},e.prototype.applyParaFormatProperty=function(e,i,r,n){var o=e.paragraphFormat;if(n&&"leftIndent"===i&&(r=o.leftIndent+r),"listFormat"===i&&r instanceof x){var a=r;a.hasValue("listLevelNumber")||(a.listLevelNumber=o.listFormat.listLevelNumber)}if(this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(r=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForParagraphFormat(o,i,r)),r instanceof F&&(t.isNullOrUndefined(i)?this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)?this.copyParagraphFormat(r,o):o.copyFormat(r):"listFormat"===i&&(o.listFormat=r.listFormat)),t.isNullOrUndefined(r))return o.clearFormat(),void this.viewer.layout.reLayoutParagraph(o.ownerBase,0,0);if("afterSpacing"===i)o.afterSpacing=r;else if("beforeSpacing"===i)o.beforeSpacing=r;else if("leftIndent"===i)o.leftIndent=r;else if("lineSpacingType"===i)o.lineSpacingType=r;else if("lineSpacing"===i)o.lineSpacing=r;else if("rightIndent"===i)o.rightIndent=r;else if("firstLineIndent"===i)o.firstLineIndent=r;else if("textAlignment"===i)o.textAlignment=r,this.viewer.layout.allowLayout=!1;else if("styleName"===i)"string"==typeof r&&(r=this.viewer.styles.findByName(r)),o.ApplyStyle(r);else if("listFormat"===i)return r instanceof F&&(this.copyFromListLevelParagraphFormat(o,r),r=r.listFormat),o.listFormat.copyFormat(r),this.viewer.layout.clearListElementBox(o.ownerBase),this.onListFormatChange(o.ownerBase,r,o),void this.layoutItemBlock(o.ownerBase,!1)},e.prototype.copyParagraphFormat=function(e,t){t.uniqueParagraphFormat=e.uniqueParagraphFormat,t.listFormat=e.listFormat,t.baseStyle=e.baseStyle},e.prototype.onListFormatChange=function(e,t,i){t instanceof x&&this.updateListParagraphFormat(e,t)},e.prototype.updateListParagraphFormat=function(e,i){var r=this.viewer.getListById(i.listId),n=void 0;t.isNullOrUndefined(r)||(n=this.viewer.layout.getListLevel(r,i.listLevelNumber)),(!this.editorHistory||this.editorHistory&&!this.editorHistory.isUndoing)&&(e instanceof G&&!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(n.paragraphFormat)&&!t.isNullOrUndefined(e.containerWidget)?this.copyFromListLevelParagraphFormat(e.paragraphFormat,n.paragraphFormat):t.isNullOrUndefined(r)&&(e.paragraphFormat.leftIndent=void 0,e.paragraphFormat.firstLineIndent=void 0))},e.prototype.copyFromListLevelParagraphFormat=function(e,i){t.isNullOrUndefined(i.leftIndent)||(e.leftIndent=i.leftIndent),t.isNullOrUndefined(i.firstLineIndent)||(e.firstLineIndent=i.firstLineIndent)},e.prototype.applyContinueNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("ContinueNumbering"),this.applyContinueNumberingInternal(e)},e.prototype.applyContinueNumberingInternal=function(e){var t=e.start.paragraph,i=this.getContinueNumberingInfo(t),r=this.getParagraphFormat(t,i.listLevelNumber,i.listPattern);this.changeListId(i.currentList,t,r,i.listLevelNumber,i.listPattern),this.reLayout(e,!1),this.viewer.updateFocus()},e.prototype.getContinueNumberingInfo=function(e){var i=void 0,r=0,n="None";t.isNullOrUndefined(e.paragraphFormat)||t.isNullOrUndefined(e.paragraphFormat.listFormat)||(i=this.viewer.getListById(e.paragraphFormat.listFormat.listId),r=e.paragraphFormat.listFormat.listLevelNumber);var o=this.viewer;if(0!==r&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(o.getAbstractListById(i.abstractListId))&&!t.isNullOrUndefined(o.getAbstractListById(i.abstractListId).levels[r])){var a=this.viewer.layout.getListLevel(i,r);t.isNullOrUndefined(a)||(n=a.listLevelPattern)}return{currentList:i,listLevelNumber:r,listPattern:n}},e.prototype.revertContinueNumbering=function(e,i){var r=e.start.paragraph,n=this.getContinueNumberingInfo(r);this.changeListId(n.currentList,r,i,n.listLevelNumber,n.listPattern),this.reLayout(e,!1),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.editorHistory.updateHistory()},e.prototype.changeListId=function(e,i,r,n,o){if(!t.isNullOrUndefined(i)){if(i instanceof G&&e.listId===i.paragraphFormat.listFormat.listId&&n===i.paragraphFormat.listFormat.listLevelNumber){if(this.editorHistory){var a=this.editorHistory.currentBaseHistoryInfo;t.isNullOrUndefined(a)||(r=a.addModifiedPropertiesForContinueNumbering(i.paragraphFormat,r))}i.paragraphFormat.copyFormat(r),this.viewer.layout.reLayoutParagraph(i,0,0)}return this.changeListId(e,i.nextRenderedWidget,r,n,o)}},e.prototype.getParagraphFormat=function(e,i,r){if(!t.isNullOrUndefined(e.previousRenderedWidget)&&e.previousRenderedWidget instanceof G){if(t.isNullOrUndefined(e.previousRenderedWidget.paragraphFormat.listFormat)||-1===e.previousRenderedWidget.paragraphFormat.listFormat.listId)return this.getParagraphFormat(e.previousRenderedWidget,i,r);var n=this.getListLevel(e.previousRenderedWidget);return 0===i?e.previousRenderedWidget.paragraphFormat:r===n.listLevelPattern||this.checkNumberArabic(r,n.listLevelPattern)?e.previousRenderedWidget.paragraphFormat:this.getParagraphFormat(e.previousRenderedWidget,i,r)}},e.prototype.checkNumberArabic=function(e,t){return"Number"===e&&"Arabic"===t||"Number"===t&&"Arabic"===e},e.prototype.applyRestartNumbering=function(e){this.editorHistory&&this.editorHistory.initializeHistory("RestartNumbering"),this.restartListAt(e)},e.prototype.restartListAt=function(e){var t=this.getListLevel(e.start.paragraph),i=new b;i.listId=this.viewer.lists[this.viewer.lists.length-1].listId+1;var r=new de;r.abstractListId=this.viewer.abstractLists[this.viewer.abstractLists.length-1].abstractListId+1,i.abstractListId=r.abstractListId,i.abstractList=r,this.viewer.abstractLists.push(r),this.createListLevels(r,t,i),this.viewer.lists.push(i),this.restartListAtInternal(e,i.listId)},e.prototype.restartListAtInternal=function(e,t){var i=this.getContinueNumberingInfo(e.start.paragraph);this.changeRestartNumbering(i.currentList,e.start.paragraph,t),this.reLayout(e,!1),this.incrementListNumber=-1,this.refListNumber=void 0,this.viewer.updateFocus()},e.prototype.changeRestartNumbering=function(e,i,r){if(!t.isNullOrUndefined(i)){if(i instanceof G&&e.listId===i.paragraphFormat.listFormat.listId){if(this.editorHistory){var n=this.editorHistory.currentBaseHistoryInfo;t.isNullOrUndefined(n)||(r=n.addModifiedPropertiesForRestartNumbering(i.paragraphFormat.listFormat,r))}i.paragraphFormat.listFormat.listId=r,this.refListNumber!==i.paragraphFormat.listFormat.listLevelNumber&&(this.incrementListNumber+=1,this.refListNumber=i.paragraphFormat.listFormat.listLevelNumber),i.paragraphFormat.listFormat.listLevelNumber=this.incrementListNumber,this.viewer.layout.reLayoutParagraph(i,0,0)}return this.changeRestartNumbering(e,i.nextRenderedWidget,r)}},e.prototype.createListLevels=function(e,i,r){for(var n=i.listLevelPattern,o=[],a=i.ownerBase,s=0;s<3;s++){h=a.levels[s];t.isNullOrUndefined(h)||o.push(h.listLevelPattern)}for(var l=-1===o.indexOf(n)?0:o.indexOf(n),d=i.numberFormat.charAt(i.numberFormat.length-1),s=0;s<a.levels.length;s++){var h=new he(e);0===s?h.listLevelPattern=n:(0===l||l<o.length-1?l++:l=0,h.listLevelPattern=o[l]),h.numberFormat="%"+(s+1)+d,h.startAt=1,h.characterFormat.copyFormat(i.characterFormat),h.paragraphFormat.copyFormat(i.paragraphFormat),h.restartLevel=s,e.levels.push(h)}},e.prototype.applyParaFormat=function(e,t,i,r,n,o){this.setOffsetValue(this.selection),e=e.combineWidget(this.viewer),this.applyParaFormatProperty(e,r,n,o),this.layoutItemBlock(e,!1),this.getOffsetValue(this.selection),e.equals(i.paragraph)||this.getNextParagraphForFormatting(e,t,i,r,n,o)},e.prototype.applyCharacterStyle=function(e,t,i,r,n,o){var a=e.getSplitWidgets();if((i.paragraph===e||-1!==a.indexOf(i.paragraph))&&("Paragraph"===n.type&&n.link instanceof O||"Character"===n.type)){var s="Character"===n.type?n:n.link;return this.updateSelectionCharacterFormatting(r,s,o),!0}return!1},e.prototype.applyParaFormatInCell=function(e,t,i,r,n,o){var a=this.viewer.selection;if(i.paragraph.isInsideTable){var s=a.getContainerCellOf(e,i.paragraph.associatedCell);if(s.ownerTable.contains(i.paragraph.associatedCell)){var l=a.getSelectedCell(e,s),d=a.getSelectedCell(i.paragraph.associatedCell,s);a.containsCell(s,i.paragraph.associatedCell)?a.isCellSelected(s,t,i)?(n=this.getParaFormatValueInCell(s,r,n),this.applyParaFormatCellInternal(s,r,n,o)):l===s?this.applyParaFormat(t.paragraph,t,i,r,n,o):this.applyParagraphFormatRow(l.ownerRow,t,i,r,n,o):this.applyParaFormatTableCell(s.ownerTable,s,d,r,n,o)}else this.applyParagraphFormatRow(s.ownerRow,t,i,r,n,o)}else{var h=a.getContainerCell(e);this.applyParagraphFormatRow(h.ownerRow,t,i,r,n,o)}},e.prototype.applyParaFormatCellInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];o instanceof G?this.applyParaFormatProperty(o,t,i,r):this.applyParagraphFormatTableInternal(o,t,i,r)}},e.prototype.getParaFormatValueInCell=function(e,t,i){return"boolean"==typeof i&&(i=!this.viewer.selection.getFirstParagraph(e).paragraphFormat.getPropertyValue(t)),i},e.prototype.applyParagraphFormatRow=function(e,t,i,r,n,o){n=this.getParaFormatValueInCell(e.childWidgets[0],r,n);for(var a=e.rowIndex;a<e.ownerTable.childWidgets.length;a++){for(var s=e.ownerTable.childWidgets[a],l=0;l<s.childWidgets.length;l++)this.applyParaFormatCellInternal(s.childWidgets[l],r,n,o);if(i.paragraph.isInsideTable&&this.viewer.selection.containsRow(s,i.paragraph.associatedCell))return}this.getNextParagraphForFormatting(e.ownerTable,t,i,r,n,o)},e.prototype.applyParaFormatTableCell=function(e,t,i,r,n,o){var a=this.viewer.selection,s=a.getCellLeft(t.ownerRow,t),l=s+t.cellFormat.cellWidth,d=a.getCellLeft(i.ownerRow,i),h=d+i.cellFormat.cellWidth,c=this.updateSelectedCellsInTable(s,l,d,h);s=c.start,l=c.end;for(var p=e.childWidgets.indexOf(i.ownerRow),g=!1,u=e.childWidgets.indexOf(t.ownerRow);u<=p;u++)for(var f=e.childWidgets[u],m=0;m<f.childWidgets.length;m++){var v=a.getCellLeft(f,f.childWidgets[m]);Math.round(s)<=Math.round(v)&&Math.round(v)<Math.round(l)&&(g||(n=this.getParaFormatValueInCell(f.childWidgets[m],r,n),g=!0),this.applyParaFormatCellInternal(f.childWidgets[m],r,n,o))}},e.prototype.applyParaFormatTable=function(e,t,i,r,n,o){e=e.combineWidget(this.viewer);for(var a=this.viewer.selection,s=0;s<e.childWidgets.length;s++){for(var l=e.childWidgets[s],d=0;d<l.childWidgets.length;d++)this.applyParaFormatCellInternal(l.childWidgets[d],r,n,o);if(i.paragraph.isInsideTable&&a.containsRow(l,i.paragraph.associatedCell))return void this.viewer.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1)}this.viewer.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),this.getNextParagraphForFormatting(e,t,i,r,n,o)},e.prototype.getNextParagraphForFormatting=function(e,i,r,n,o,a){var s=e.getSplitWidgets();e=s[s.length-1],e=this.viewer.selection.getNextRenderedBlock(e),t.isNullOrUndefined(e)||(e instanceof G?this.applyParaFormat(e,i,r,n,o,a):this.applyParaFormatTable(e,i,r,n,o,a))},e.prototype.applyParagraphFormatTableInternal=function(e,t,i,r){for(var n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],a=0;a<o.childWidgets.length;a++)this.applyParaFormatCellInternal(o.childWidgets[a],t,i,r)},e.prototype.onApplySectionFormat=function(e,i){if(t.isNullOrUndefined(e))this.initHistory("SectionFormat");else{var r=e[0].toUpperCase()+e.slice(1);this.initHistory(r)}this.updateSectionFormat(e,i)},e.prototype.updateSectionFormat=function(e,t){var i=this.viewer.selection;i.owner.isShiftingEnabled=!0;var r=i.start,n=i.end;i.isForward||(r=i.end,n=i.start);var o,a;this.viewer.clearContent();for(var s=r.paragraph.containerWidget.index,l=n.paragraph.containerWidget.index,d=0;d<this.viewer.pages.length;d++)if(this.viewer.pages[d].bodyWidgets[0].index===s){o=d;break}for(d=o;d<this.viewer.pages.length;d++){var h=this.viewer.pages[d].bodyWidgets[0];if(a=d,h.index!==s&&!(h.index>=s&&h.index<=l)){a=d-1;break}}for(var c=!0,p=0,d=o;d<=a;d++)p===this.viewer.pages[d].bodyWidgets[0].index||c||(c=!0),this.applyPropertyValueForSection(this.viewer.pages[d].bodyWidgets[0].sectionFormat,e,t,c),p=this.viewer.pages[d].bodyWidgets[0].index,c=!1;this.layoutWholeDocument(),this.fireContentChange()},e.prototype.onApplyTableFormat=function(e,t){var i=this.getTableFormatAction(e);this.viewer.owner.isShiftingEnabled=!0;var r=this.viewer.selection,n=r.start.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.viewer),r.isEmpty?(this.initHistory(i),this.applyTablePropertyValue(r,e,t,n)):this.updateSelectionTableFormat(this.selection,i,t),n.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.viewer.layout.reLayoutTable(n),this.reLayout(r,!1)},e.prototype.getTableFormatAction=function(e){switch(e){case"tableAlignment":return"TableAlignment";case"leftIndent":return"TableLeftIndent";case"leftMargin":return"DefaultCellLeftMargin";case"rightMargin":return"DefaultCellRightMargin";case"bottomMargin":return"DefaultCellBottomMargin";case"topMargin":return"DefaultCellTopMargin";case"preferredWidth":return"TablePreferredWidth";case"preferredWidthType":return"TablePreferredWidthType";case"shading":return"Shading";default:return"DefaultCellSpacing"}},e.prototype.onApplyTableRowFormat=function(e,t){var i=this.getRowAction(e);this.viewer.owner.isShiftingEnabled=!0;var r=this.viewer.selection;if(r.isEmpty){this.initHistory(i);r.start.paragraph.associatedCell.ownerRow.ownerTable;this.applyRowPropertyValue(r,e,t,r.start.paragraph.associatedCell.ownerRow)}else this.updateSelectionTableFormat(this.selection,i,t);this.reLayout(r,!1)},e.prototype.getRowAction=function(e){switch(e){case"height":return"RowHeight";case"heightType":return"RowHeightType";case"isHeader":return"RowHeader";default:return"AllowBreakAcrossPages"}},e.prototype.onApplyTableCellFormat=function(e,t){var i=this.getTableCellAction(e);this.viewer.owner.isShiftingEnabled=!0;var r=this.viewer.selection,n=r.start.paragraph.associatedCell.ownerTable;n=n.combineWidget(this.viewer),r.isEmpty?(this.initHistory(i),this.applyCellPropertyValue(r,e,t,r.start.paragraph.associatedCell.cellFormat),n.calculateGrid(),this.selection.owner.isLayoutEnabled=!0,this.viewer.layout.reLayoutTable(n)):this.updateSelectionTableFormat(this.selection,i,t),this.reLayout(r,!1)},e.prototype.getTableCellAction=function(e){switch(e){case"verticalAlignment":return"CellContentVerticalAlignment";case"leftMargin":return"CellLeftMargin";case"rightMargin":return"CellRightMargin";case"bottomMargin":return"CellBottomMargin";case"topMargin":return"CellTopMargin";case"preferredWidth":return"CellPreferredWidth";case"shading":return"Shading";default:return"CellPreferredWidthType"}},e.prototype.applyPropertyValueForSection=function(e,i,r,n){this.viewer.selection;if(n&&this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(r=this.editorHistory.currentBaseHistoryInfo.addModifiedPropertiesForSection(e,i,r)),!t.isNullOrUndefined(r))return r instanceof y?void(t.isNullOrUndefined(i)&&e.copyFormat(r,this.editorHistory)):void("pageHeight"===i?e.pageHeight=r:"pageWidth"===i?e.pageWidth=r:"leftMargin"===i?e.leftMargin=r:"rightMargin"===i?e.rightMargin=r:"topMargin"===i?e.topMargin=r:"bottomMargin"===i?e.bottomMargin=r:"differentFirstPage"===i?e.differentFirstPage=r:"differentOddAndEvenPages"===i?e.differentOddAndEvenPages=r:"headerDistance"===i?e.headerDistance=r:"footerDistance"===i&&(e.footerDistance=r))},e.prototype.layoutWholeDocument=function(){var e=this.viewer.selection.start,t=this.viewer.selection.end;e.isExistAfter(t)&&(e=this.viewer.selection.end,t=this.viewer.selection.start);var i=this.getParagraphInfo(e),r=this.getParagraphInfo(e),n=this.getHierarchicalIndex(i.paragraph,i.offset.toString()),o=this.getHierarchicalIndex(r.paragraph,r.offset.toString());this.viewer.renderedLists.clear();var a=this.combineSection();this.viewer.clearContent(),this.viewer.layout.layoutItems(a),this.viewer.owner.isShiftingEnabled=!1,this.setPositionForCurrentIndex(e,n),this.setPositionForCurrentIndex(t,o),this.viewer.selection.selectPosition(e,t),this.reLayout(this.viewer.selection)},e.prototype.combineSection=function(){var e=[],t=this.viewer.pages[0].bodyWidgets[0];do{t=this.combineSectionChild(t,e)}while(t);return e},e.prototype.combineSectionChild=function(e,t){var i=e,r=new V;r.sectionFormat=e.sectionFormat,r.index=i.index;do{i=e,e.lastChild&&e.lastChild.combineWidget(this.viewer),e=e.nextRenderedWidget;for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[n];o instanceof K?this.viewer.layout.clearTableWidget(o,!0,!0):(o.x=0,o.y=0,o.width=0,o.height=0),r.childWidgets.push(o),i.childWidgets.splice(n,1),n--,o.containerWidget=r}i.page.destroy()}while(e&&i.equals(e));return t.push(r),e},e.prototype.updateSelectionTableFormat=function(e,t,i){switch(t){case"TableAlignment":this.editorHistory.initializeHistory("TableAlignment"),this.updateTableFormat(e,"tableAlignment",i);break;case"TableLeftIndent":this.editorHistory.initializeHistory("TableLeftIndent"),this.updateTableFormat(e,"leftIndent",i);break;case"DefaultCellSpacing":this.editorHistory.initializeHistory("DefaultCellSpacing"),this.updateTableFormat(e,"cellSpacing",i);break;case"DefaultCellLeftMargin":this.editorHistory.initializeHistory("DefaultCellLeftMargin"),this.updateTableFormat(e,"leftMargin",i);break;case"DefaultCellRightMargin":this.editorHistory.initializeHistory("DefaultCellRightMargin"),this.updateTableFormat(e,"rightMargin",i);break;case"DefaultCellTopMargin":this.editorHistory.initializeHistory("DefaultCellTopMargin"),this.updateTableFormat(e,"topMargin",i);break;case"TablePreferredWidth":this.editorHistory.initializeHistory("TablePreferredWidth"),this.updateTableFormat(e,"preferredWidth",i);break;case"TablePreferredWidthType":this.editorHistory.initializeHistory("TablePreferredWidthType"),this.updateTableFormat(e,"preferredWidthType",i);break;case"DefaultCellBottomMargin":this.editorHistory.initializeHistory("DefaultCellBottomMargin"),this.updateTableFormat(e,"bottomMargin",i);break;case"CellContentVerticalAlignment":this.editorHistory.initializeHistory("CellContentVerticalAlignment"),this.updateCellFormat(e,"verticalAlignment",i);break;case"CellLeftMargin":this.editorHistory.initializeHistory("CellLeftMargin"),this.updateCellFormat(e,"leftMargin",i);break;case"CellRightMargin":this.editorHistory.initializeHistory("CellRightMargin"),this.updateCellFormat(e,"rightMargin",i);break;case"CellTopMargin":this.editorHistory.initializeHistory("CellTopMargin"),this.updateCellFormat(e,"topMargin",i);break;case"CellBottomMargin":this.editorHistory.initializeHistory("CellBottomMargin"),this.updateCellFormat(e,"bottomMargin",i);break;case"CellPreferredWidth":this.editorHistory.initializeHistory("CellPreferredWidth"),this.updateCellFormat(e,"preferredWidth",i);break;case"CellPreferredWidthType":this.editorHistory.initializeHistory("CellPreferredWidthType"),this.updateCellFormat(e,"preferredWidthType",i);break;case"Shading":this.editorHistory.initializeHistory("Shading"),this.updateCellFormat(e,"shading",i);break;case"RowHeight":this.editorHistory.initializeHistory("RowHeight"),this.updateRowFormat(e,"height",i);break;case"RowHeightType":this.editorHistory.initializeHistory("RowHeightType"),this.updateRowFormat(e,"heightType",i);break;case"RowHeader":this.editorHistory.initializeHistory("RowHeader"),this.updateRowFormat(e,"isHeader",i);break;case"AllowBreakAcrossPages":this.editorHistory.initializeHistory("AllowBreakAcrossPages"),this.updateRowFormat(e,"allowBreakAcrossPages",i)}},e.prototype.updateTableFormat=function(e,t,i){var r=e.start;e.end;e.isForward||(r=e.end,e.start),this.initHistoryPosition(e,r),this.applyTablePropertyValue(e,t,i,r.paragraph.associatedCell.ownerTable)},e.prototype.updateCellFormat=function(e,t,i){e.owner.isShiftingEnabled=!0;var r=e.start;e.end;e.isForward||(r=e.end,e.start),this.initHistoryPosition(e,r),this.updateFormatForCell(e,t,i)},e.prototype.updateRowFormat=function(e,t,i){var r=e.start,n=e.end;e.isForward||(r=e.end,n=e.start),this.initHistoryPosition(e,r),this.applyRowFormat(r.paragraph.associatedCell.ownerRow,r,n,t,i)},e.prototype.initHistoryPosition=function(e,i){this.viewer.owner.editorHistoryModule&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(t.isNullOrUndefined(i)?t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.start.getHierarchicalIndexInternal()):t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=i.getHierarchicalIndexInternal()))},e.prototype.startSelectionReLayouting=function(e,t,i,r){if(t.owner.isLayoutEnabled=!0,i.paragraph.isInsideTable){for(var n=i.paragraph.associatedCell.ownerTable;n.isInsideTable;)n=n.associatedCell.ownerTable;this.reLayoutSelectionOfTable(n,t,i,r)}else this.reLayoutSelection(e,t,i,r)},e.prototype.reLayoutSelectionOfTable=function(e,i,r,n){var o=!1;if(this.viewer.layout.layoutBodyWidgetCollection(e.index,e.containerWidget,e,!1),!t.isNullOrUndefined(n.paragraph.associatedCell)&&e.contains(n.paragraph.associatedCell))return!0;var a=i.getNextRenderedBlock(e);return t.isNullOrUndefined(a)||(o=this.reLayoutSelectionOfBlock(a,i,r,n)),o},e.prototype.reLayoutSelection=function(e,i,r,n){if(r.paragraph===e){r.offset,i.getParagraphLength(e);var o=0,a=0,s=e.getInline(r.offset,o),l=s.element;o=s.index,t.isNullOrUndefined(l)||(o!==l.length||t.isNullOrUndefined(l.nextNode)||(l=l.nextNode),a=l.line.children.indexOf(l));var d=0;r.currentWidget.paragraph===e&&(d=e.childWidgets.indexOf(r.currentWidget),a=r.currentWidget.children.indexOf(l)),l instanceof Q&&!l.line&&a>0?this.viewer.layout.reLayoutParagraph(e,d,a-1):this.viewer.layout.reLayoutParagraph(e,d,a)}else this.viewer.layout.reLayoutParagraph(e,0,0);if(n.paragraph===e)return!0;var h=i.getNextRenderedBlock(e);return!t.isNullOrUndefined(h)&&this.reLayoutSelectionOfBlock(h,i,r,n)},e.prototype.reLayoutSelectionOfBlock=function(e,t,i,r){return e instanceof G?this.reLayoutSelection(e,t,i,r):void 0},e.prototype.layoutItemBlock=function(e,i){var r=void 0;if(e.containerWidget instanceof _){(r=e.containerWidget).childWidgets.indexOf(e);!t.isNullOrUndefined(this.viewer.owner)&&this.viewer.owner.isLayoutEnabled&&this.viewer.layout.layoutBodyWidgetCollection(e.index,r,e,!1)}else if(e.containerWidget instanceof Y){var n=e.containerWidget;n=this.viewer.selection.getContainerCell(n),!t.isNullOrUndefined(this.viewer.owner)&&this.viewer.owner.isLayoutEnabled&&this.viewer.layout.reLayoutTable(e)}},e.prototype.removeSelectedContents=function(e){return this.removeSelectedContentInternal(e,e.start,e.end)},e.prototype.removeSelectedContentInternal=function(e,t,i){var r=t,n=i;if(t.isExistBefore(i)||(r=i,n=t),r.paragraph===n.paragraph&&r.paragraph.childWidgets.indexOf(r.currentWidget)===r.paragraph.childWidgets.length-1&&r.offset===e.getParagraphLength(r.paragraph)&&r.offset+1===n.offset)return e.owner.isShiftingEnabled=!0,e.selectContent(r,!0),!0;var o=this.getParagraphInfo(r);e.editPosition=this.getHierarchicalIndex(o.paragraph,o.offset.toString());var a=this.removeSelectedContent(n.paragraph,e,r,n),s=new Ie(e.owner);return this.setPositionForCurrentIndex(s,e.editPosition),e.selectContent(s,!0),a},e.prototype.removeSelectedContent=function(e,t,i,r){return!(r.paragraph.isInsideTable&&r.paragraph!==t.getLastParagraphInLastCell(r.paragraph.associatedCell.ownerTable)&&(!i.paragraph.isInsideTable||i.paragraph.associatedCell.ownerTable!==r.paragraph.associatedCell.ownerTable))&&(t.owner.isShiftingEnabled=!0,this.deleteSelectedContent(e,t,i,r,2),!0)},e.prototype.deleteSelectedContent=function(e,t,i,r,n){var o=0,a=i.currentWidget.getInline(i.offset,o);a.element;if(o=a.index,o=0,a=r.currentWidget.getInline(r.offset,o),a.element,o=a.index,r.paragraph!==e)return void this.deleteSelectedContent(r.paragraph,t,i,r,n);!r.paragraph.isInsideTable||i.paragraph.isInsideTable&&i.paragraph.associatedCell===r.paragraph.associatedCell&&!t.isCellSelected(r.paragraph.associatedCell,i,r)?this.deletePara(e,i,r,n):(r.paragraph.associatedCell.ownerTable.combineWidget(this.viewer),this.deleteTableCell(r.paragraph.associatedCell,t,i,r,n))},e.prototype.mergeCells=function(){!this.owner.isReadOnlyMode&&this.owner.isDocumentLoaded&&(t.isNullOrUndefined(this.viewer)||this.selection.isEmpty||this.mergeSelectedCellsInTable())},e.prototype.deleteTable=function(){if(!this.owner.isReadOnlyMode){var e=this.selection.isForward?this.selection.start:this.selection.end;if(e.paragraph.isInsideTable){var i=this.getOwnerTable(this.selection.isForward).combineWidget(this.viewer);this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&(this.initHistory("DeleteTable"),this.updateHistoryPosition(e,!0));var r=this.getParagraphForSelection(i);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i.clone()),this.removeBlock(i),this.selection.selectParagraph(r,!0),(this.checkIsNotRedoing()||t.isNullOrUndefined(this.editorHistory))&&this.reLayout(this.selection)}}},e.prototype.deleteColumn=function(){if(!this.owner.isReadOnlyMode){var e=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(e.paragraph.isInsideTable){this.selection.owner.isShiftingEnabled=!0,this.checkIsNotRedoing()&&this.initHistory("DeleteColumn");var i=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward),n=i.ownerTable.combineWidget(this.viewer);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(n);var o=void 0;if(r.nextWidget){var a=r.nextWidget;o=this.selection.getFirstParagraph(a)}else if(i.previousWidget){var s=i.previousWidget;o=this.selection.getFirstParagraph(s)}t.isNullOrUndefined(o)&&(o=this.getParagraphForSelection(n));for(var l=n.getColumnCellsForSelection(i,r),d=0;d<n.childWidgets.length;d++){var h=n.childWidgets[d];if(1===h.childWidgets.length)l.indexOf(h.childWidgets[0])>=0&&(n.childWidgets.splice(n.childWidgets.indexOf(h),1),h.destroy(),d--);else{for(var c=0;c<h.childWidgets.length;c++){var p=h.childWidgets[c];l.indexOf(p)>=0&&(h.childWidgets.splice(c,1),p.destroy(),c--)}0===h.childWidgets.length&&(n.childWidgets.splice(n.childWidgets.indexOf(h),1),h.destroy(),d--)}}0===n.childWidgets.length?(o=this.getParagraphForSelection(n),this.removeBlock(n),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),n.destroy()):(n.isGridUpdated=!1,n.buildTableColumns(),n.isGridUpdated=!0,this.viewer.layout.reLayoutTable(n)),this.selection.selectParagraph(o,!0),(t.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}}},e.prototype.deleteRow=function(){if(!this.owner.isReadOnlyMode){var e=this.selection.isForward?this.selection.start:this.selection.end;this.selection.isForward?this.selection.end:this.selection.start;if(e.paragraph.isInsideTable){var i=this.getOwnerCell(this.selection.isForward),r=this.getOwnerCell(!this.selection.isForward);this.checkIsNotRedoing()&&this.initHistory("DeleteRow"),this.selection.owner.isShiftingEnabled=!0;var n=i.ownerTable.combineWidget(this.viewer),o=this.getOwnerRow(!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&this.cloneTableToHistoryInfo(n);var a=void 0;if(o.nextWidget){d=o.nextWidget.childWidgets[0];a=this.selection.getFirstParagraph(d)}if(t.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(n)),this.selection.isEmpty)this.removeRow(o);else{var s=this.selection.getContainerCellOf(i,r);if(s.ownerTable.contains(r))if(i=this.selection.getSelectedCell(i,s),r=this.selection.getSelectedCell(r,s),this.selection.containsCell(s,r))o=i.ownerRow,this.removeRow(o);else{o=i.ownerRow;var l=r.ownerRow;if(a=void 0,l.nextWidget){var d=l.nextWidget.childWidgets[0];a=this.selection.getFirstParagraph(d)}t.isNullOrUndefined(a)&&(a=this.getParagraphForSelection(n));for(var h=0;h<n.childWidgets.length;h++){var c=n.childWidgets[h];c.rowIndex>=o.rowIndex&&c.rowIndex<=l.rowIndex&&(n.childWidgets.splice(h,1),c.destroy(),h--)}0===n.childWidgets.length?(this.removeBlock(n),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="DeleteTable"),n.destroy()):this.updateTable(n)}}this.selection.selectParagraph(a,!0),(t.isNullOrUndefined(this.editorHistory)||this.checkIsNotRedoing())&&this.reLayout(this.selection,!0)}}},e.prototype.removeRow=function(e){var t=e.ownerTable;1===t.childWidgets.length?(this.removeBlock(t),this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(this.editorHistory.currentBaseHistoryInfo.action="Delete"),t.destroy()):(t.childWidgets.splice(t.childWidgets.indexOf(e),1),e.destroy(),this.updateTable(t))},e.prototype.updateTable=function(e){e.updateRowIndex(0),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.layout.reLayoutTable(e)},e.prototype.getParagraphForSelection=function(e){var t=void 0,i=e.nextWidget?e.nextWidget:e.nextRenderedWidget,r=e.previousWidget?e.previousWidget:e.previousRenderedWidget;return i?t=i instanceof G?i:this.selection.getFirstParagraphInFirstCell(i):r&&(t=r instanceof G?r:this.selection.getLastParagraphInLastCell(r)),t},e.prototype.deletePara=function(e,i,r,n){e=e.combineWidget(this.viewer);var o=this.viewer.selection,a=o.getStartOffset(e),s=o.getStartOffset(r.paragraph),l=a,d=0,h=!1,c=this.selection.getLineLength(e.lastChild),p=e,g=e.bodyWidget instanceof V?e.bodyWidget:void 0,u=void 0,f=void 0;e===i.paragraph?(l=i.offset,u=i.currentWidget,r.paragraph.isInsideTable&&(h=this.isEndInAdjacentTable(e,r.paragraph))):u=e.firstChild,e!==i.paragraph&&o.isSkipLayouting&&(o.isSkipLayouting=!1),e===r.paragraph?(f=r.currentWidget,d=r.offset):(f=e.lastChild,d=this.viewer.selection.getLineLength(e.lastChild));var m=e.previousRenderedWidget;if((l>a&&i.currentWidget===e.lastChild&&l===c&&(e===r.paragraph&&r.offset===l+1||e.nextRenderedWidget===r.paragraph&&r.offset===s)||this.editorHistory&&this.editorHistory.isUndoing&&this.editorHistory.currentHistoryInfo&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&m&&m.isPageBreak()&&(0===l&&!i.currentWidget.isFirstLine||l>0))&&(h=!0),r.paragraph===e&&r.currentWidget!==e.lastChild||r.currentWidget===e.lastChild&&r.offset<=o.getLineLength(e.lastChild)){var v=i.paragraph===e;(r.currentWidget.isFirstLine()&&r.offset>a||!r.currentWidget.isFirstLine())&&this.removeInlines(e,u,l,f,d,n),t.isNullOrUndefined(m)||v||((F=m.bodyWidget instanceof V?m.bodyWidget:void 0)&&!g.equals(F)&&g.index!==F.index&&this.deleteSection(o,F,g,n),this.deleteBlock(m,o,i,r,n))}else{if(i.paragraph===e&&(i.currentWidget!==e.firstChild||i.currentWidget===e.firstChild&&l>a))return 4===n?void 0:(p=this.splitParagraph(e,e.firstChild,0,u,l,!0),this.insertParagraphPaste(e,p,i,r,h,n),void this.addRemovedNodes(e));var y=void 0,w=e.previousWidget,b=w instanceof G?w:void 0,x=e.nextRenderedWidget;if(n<4)if(y=this.checkAndInsertBlock(e,i,r,n,b),this.removeBlock(e),this.viewer.blockToShift===e&&(this.viewer.blockToShift=void 0),this.addRemovedNodes(e),t.isNullOrUndefined(y)){if(e===i.paragraph&&t.isNullOrUndefined(x)&&!t.isNullOrUndefined(b)){C=this.selection.getParagraphLength(b);o.editPosition=this.getHierarchicalIndex(b,C.toString()),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(o.editPosition,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=o.editPosition)}}else{o.editPosition=this.getHierarchicalIndex(y,"0");var C=o.getParagraphLength(y)+1;this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=this.getHierarchicalIndex(y,C.toString()))}if(i.paragraph!==e&&!t.isNullOrUndefined(m)){var F=m.bodyWidget instanceof V?m.bodyWidget:void 0;this.deleteBlock(m,o,i,r,n)}}this.insertParagraphPaste(e,p,i,r,h,n)},e.prototype.deleteSection=function(e,t,i,r){r<4&&this.combineSectionInternal(e,t,i),r>2&&t.sectionFormat.copyFormat(i.sectionFormat)},e.prototype.combineSectionInternal=function(e,t,i){var r=t.getSplitWidgets()[0],n=[];this.combineSectionChild(r,n);var o=(r=n[0]).lastChild.index;this.updateBlockIndex(o+1,i.firstChild);for(var a=0,s=i,l=0;l<r.childWidgets.length;l++){var d=r.childWidgets.splice(l,1)[0];s.childWidgets.splice(a,0,d),d.containerWidget=s,this.viewer.layout.layoutBodyWidgetCollection(d.index,d.bodyWidget,d,!1),s=(d=d.getSplitWidgets().pop()).containerWidget,a=d.indexInOwner+1,l--}this.updateSectionIndex(void 0,i,!1),this.addRemovedNodes(r)},e.prototype.checkAndInsertBlock=function(e,i,r,n,o){if(e instanceof G&&e===i.paragraph||e instanceof K){var a=void 0;return t.isNullOrUndefined(e.nextWidget)&&(t.isNullOrUndefined(o)||o.nextRenderedWidget instanceof K)&&(a=new G,1===n&&e instanceof G&&(a.characterFormat.copyFormat(e.characterFormat),a.paragraphFormat.copyFormat(e.paragraphFormat)),a.index=e.index+1,a.containerWidget=e.containerWidget,this.viewer.layout.layoutBodyWidgetCollection(a.index,a.bodyWidget,a,!1),e.containerWidget instanceof z&&e.containerWidget.childWidgets.push(a)),a}},e.prototype.splitParagraph=function(e,t,i,r,n,o){var a=new G;a.paragraphFormat=new F(a),a.characterFormat=new P(a),a.paragraphFormat.copyFormat(e.paragraphFormat),a.characterFormat.copyFormat(e.characterFormat);var s=new J(a);a.childWidgets.push(s);var l=e.index,d=e.indexInOwner;return this.moveInlines(e,a,0,i,t,n,r),e.containerWidget.childWidgets.splice(d,0,a),a.index=l,a.containerWidget=e.containerWidget,this.updateNextBlocksIndex(a,!0),o&&this.removeBlock(e),this.viewer.layout.layoutBodyWidgetCollection(l,a.containerWidget,a,!1),a},e.prototype.removeBlock=function(e){var t,i;this.removeFieldInBlock(e),e.isInsideTable?(i=e.associatedCell,t=e.associatedCell.childWidgets.indexOf(e),e.associatedCell.childWidgets,this.updateNextBlocksIndex(e,!1),e.associatedCell.childWidgets.splice(t,1),e.containerWidget=void 0,this.viewer.layout.layoutBodyWidgetCollection(e.index,i,e,!1)):(t=(i=e.containerWidget).childWidgets.indexOf(e),i.childWidgets,this.updateNextBlocksIndex(e,!1),i.childWidgets.splice(t,1),e.containerWidget=void 0,i.height-=e.height,this.viewer.layout.layoutBodyWidgetCollection(e.index,i,e,!1))},e.prototype.removeField=function(e){for(var t=0;t<this.viewer.fields.length;t++)this.viewer.fields[t].line.paragraph===e&&(this.viewer.fields.splice(t,1),t--)},e.prototype.addRemovedNodes=function(e){e instanceof $&&0===e.fieldType&&-1!==this.viewer.fields.indexOf(e)&&this.viewer.fields.splice(this.viewer.fields.indexOf(e),1),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)?this.editorHistory.currentBaseHistoryInfo.removedNodes.push(e):this.editHyperlinkInternal&&this.nodes.push(e)},e.prototype.deleteBlock=function(e,t,i,r,n){e instanceof G?this.deletePara(e,i,r,n):this.deleteTableBlock(e,t,i,r,n)},e.prototype.deleteTableCell=function(e,i,r,n,o){var a=!(r.paragraph.isInsideTable&&e.ownerTable.contains(r.paragraph.associatedCell)),s=e.ownerTable.previousRenderedWidget;if(r.paragraph.isInsideTable){var l=i.getContainerCellOf(e,r.paragraph.associatedCell);if(l.ownerTable.contains(r.paragraph.associatedCell)){var d=i.getSelectedCell(e,l);i.getSelectedCell(r.paragraph.associatedCell,l);i.containsCell(l,r.paragraph.associatedCell)?i.isCellSelected(l,r,n)?(this.updateEditPosition(l,i),1===o?this.deleteCellsInTable(e.ownerRow.ownerTable,i,r,n,o):!this.deleteCell(l,i,o,!0)&&2!==o&&this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)):d===l?this.deletePara(n.paragraph,r,n,o):this.deleteContainer(d,i,r,n,o):2===o?this.deleteCell(e,i,2,!1):this.deleteCellsInTable(l.ownerTable,i,r,n,o)}else this.deleteContainer(l,i,r,n,o)}else{var h=i.getContainerCell(e);this.deleteContainer(h,i,r,n,o)}if(a){s.bodyWidget instanceof V&&s.bodyWidget;t.isNullOrUndefined(s)||this.deleteBlock(s,i,r,n,o)}},e.prototype.deleteCellsInTable=function(e,i,r,n,o){var a=!1,s="Delete",l=r.paragraph.associatedCell,d=n.paragraph.associatedCell;this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(s=this.editorHistory.currentBaseHistoryInfo.action,a="BackSpace"===this.editorHistory.currentBaseHistoryInfo.action||"DeleteCells"===this.editorHistory.currentBaseHistoryInfo.action||"InsertTable"===this.editorHistory.currentBaseHistoryInfo.action||t.isNullOrUndefined(l.ownerRow.previousWidget)&&t.isNullOrUndefined(d.ownerRow.nextWidget)&&"Cut"===this.editorHistory.currentBaseHistoryInfo.action,this.editorHistory.currentBaseHistoryInfo.action=a?"DeleteCells":"ClearCells",this.cloneTableToHistoryInfo(e),i.owner.isLayoutEnabled=!1);for(var h=l.columnIndex,c=d.columnIndex+d.cellFormat.columnSpan-1,p=l.rowIndex,g=d.rowIndex,u=!1,f=0;f<e.childWidgets.length;f++){var m=e.childWidgets[f];if(m.index>=p&&m.index<=g){for(var v=0;v<m.childWidgets.length;v++){var y=m.childWidgets[v];if(y.columnIndex>=h&&y.columnIndex<=c)if(u||(this.updateEditPosition(y,i),u=!0),a){var w=m.childWidgets[v];this.updateNextBlocksIndex(w,!1),m.childWidgets.splice(v,1),v--}else o<4&&this.deleteCell(y,i,o,!1)}0===m.childWidgets.length&&(this.updateNextBlocksIndex(e.childWidgets[f],!1),e.childWidgets.splice(f,1),f--,g--)}}i.owner.isLayoutEnabled=!0,0===e.childWidgets.length?(i.editPosition=this.getHierarchicalIndex(e,"0"),this.setActionInternal(i,s),this.removeBlock(e)):(e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.viewer.layout.reLayoutTable(e))},e.prototype.deleteCell=function(e,t,i,r){var n=e.childWidgets[0];if(1===e.childWidgets.length&&n instanceof G&&n.isEmpty())return!1;for(var o=0;o<e.childWidgets.length;o++)if(n=e.childWidgets[o],i<4){if(n instanceof G&&1===e.childWidgets.length){for(var a=n,s=0;s<a.childWidgets.length;s++){for(var l=a.childWidgets[s],d=0;d<l.children.length;d++){var h=l.children[d];this.unLinkFieldCharacter(h),l.children.splice(d,1),d--,this.checkClearCells(t)&&this.addRemovedNodes(h)}a.childWidgets.length>1&&(a.childWidgets.splice(s,1),s--)}this.checkClearCells(t)&&(t.editPosition=this.getHierarchicalIndex(a,"0"),this.updateHistoryPosition(t.editPosition,!0));break}this.removeBlock(n),o--,this.checkClearCells(t)&&this.addRemovedNodes(n)}return!0},e.prototype.deleteContainer=function(e,t,i,r,n){var o=e.ownerTable;if(t.containsRow(o.lastChild,r.paragraph.associatedCell))this.deleteContent(o,t,n);else for(var a=0;a<o.childWidgets.length;a++){var s=o.childWidgets[a];if(n<4&&(this.updateNextBlocksIndex(s,!1),o.childWidgets.splice(a,1),this.addRemovedNodes(s),a--),r.paragraph.isInsideTable&&t.containsRow(s,r.paragraph.associatedCell))return void this.viewer.layout.reLayoutTable(o)}},e.prototype.deleteTableBlock=function(e,i,r,n,o){if(e=e.combineWidget(this.viewer),r.paragraph.isInsideTable&&e.contains(r.paragraph.associatedCell)){var a=e.previousRenderedWidget,s=this.checkAndInsertBlock(e,r,n,o,a instanceof G?a:void 0);if(i.containsRow(e.firstChild,r.paragraph.associatedCell))this.deleteContent(e,i,o);else{var l=this.splitTable(e,r.paragraph.associatedCell.ownerRow);this.deleteContent(e,i,o),this.viewer.layout.layoutBodyWidgetCollection(l.index,l.containerWidget,l,!1)}t.isNullOrUndefined(s)||(i.editPosition=this.getHierarchicalIndex(s,"0"),this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.endPosition=i.editPosition))}else{var d=e.previousRenderedWidget;e.bodyWidget instanceof V&&e.bodyWidget;this.deleteContent(e,i,o),t.isNullOrUndefined(d)||this.deleteBlock(d,i,r,n,o)}},e.prototype.splitTable=function(e,t){var i=new K;i.tableFormat.copyFormat(e.tableFormat),i.index=e.index;for(var r=0;r<e.childWidgets.length;r++){var n=e.childWidgets[r];if(n===t)break;i.childWidgets.push(n),n.containerWidget=i,e.childWidgets.splice(r,1),r--}var o=e.getIndex();return e.containerWidget.childWidgets.splice(o,0,i),i.containerWidget=e.containerWidget,this.updateNextBlocksIndex(i,!0),i},e.prototype.updateEditPosition=function(e,t){var i=t.getFirstParagraphInCell(e);t.editPosition=this.getHierarchicalIndex(i,"0")},e.prototype.deleteContent=function(e,t,i){i<4&&(this.removeBlock(e),this.addRemovedNodes(e))},e.prototype.setActionInternal=function(e,i){this.viewer.owner.enableHistoryMode&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.editorHistory.currentBaseHistoryInfo.action=i)},e.prototype.checkClearCells=function(e){return this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&"ClearCells"!==this.editorHistory.currentBaseHistoryInfo.action},e.prototype.isEndInAdjacentTable=function(e,t){var i=this.getHierarchicalIndex(e,""),r=this.getHierarchicalIndex(t,""),n=i.split(";"),o=r.split(";");return n.length<o.length},e.prototype.cloneTableToHistoryInfo=function(e){if(this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var i=e.clone();return this.editorHistory.currentBaseHistoryInfo.removedNodes.push(i),this.viewer.selection.start.paragraph.isInsideTable&&this.viewer.selection.start.paragraph.associatedCell.ownerTable===e&&this.updateHistoryPosition(this.getHierarchicalIndex(e,"0"),!0),i}},e.prototype.insertParagraphPaste=function(e,t,i,r,n,o){if(this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var a=this.selection.getNextParagraphBlock(t);if(a&&i.offset>0&&a===r.paragraph&&e===i.paragraph&&"Paste"===this.editorHistory.currentBaseHistoryInfo.action){var s=0;this.removeBlock(t),this.viewer.layout.clearListElementBox(a),this.viewer.layout.clearListElementBox(t);for(var l=0;l<t.childWidgets.length;l++){var d=t.childWidgets[l];a.childWidgets.splice(s,0,d),t.childWidgets.splice(l,1),l--,s++,d.paragraph=a}this.viewer.layout.reLayoutParagraph(a,0,0),n=!1;var h=this.selection.editPosition.substring(this.selection.editPosition.lastIndexOf(";")+1);this.selection.editPosition=this.getHierarchicalIndex(a,h)}}n&&this.deleteParagraphMark(t,this.selection,o)},e.prototype.removeInlines=function(e,t,i,r,n,o){var a=!1;this.viewer.layout.clearListElementBox(e);e.childWidgets.indexOf(t);for(var s=e.childWidgets.length-1;s>=0;s--){var l=e.childWidgets[s];if(t===l&&r===l){this.removeContent(l,i,n),a=!0;break}if(r===l)a=!0,this.removeContent(l,0,n);else{if(t===l){this.removeContent(l,i,this.viewer.selection.getLineLength(l));break}a&&this.removeContent(l,0,this.viewer.selection.getLineLength(l))}}a&&(this.removeEmptyLine(e),this.viewer.layout.reLayoutParagraph(e,0,0))},e.prototype.removeContent=function(e,t,i){for(var r=this.selection.getLineLength(e),n=e.children.length-1;n>=0;n--){var o=e.children[n];if(i<=r-o.length)r-=o.length;else{var a=o.length;r>i&&r-a<i&&(a=i-(r-o.length));var s=0;if(r-o.length<t&&(s=t-(r-o.length)),r>i&&(r-=o.length-a),0===s&&a===o.length)this.editorHistory&&(this.editorHistory.isUndoing||this.editorHistory.isRedoing)||o instanceof ie&&this.removedBookmarkElements.push(o),this.unLinkFieldCharacter(o),this.addRemovedNodes(e.children[n]),e.children.splice(n,1);else if(o instanceof Q){var l=new Q;l.characterFormat.copyFormat(o.characterFormat),l.text=o.text.substr(s,a-s),this.addRemovedNodes(l),o.text=o.text.slice(0,s)+o.text.slice(a)}if(t>=r-(a-s))break;r-=a-s}}},e.prototype.removeEmptyLine=function(e){if(e.childWidgets.length>1)for(var t=0;t<e.childWidgets.length;t++)0===e.childWidgets[t].children.length&&e.childWidgets.length>1&&(e.childWidgets.splice(t,1),t--)},e.prototype.cloneListLevel=function(e){var t=new he(void 0);return this.copyListLevel(t,e),t},e.prototype.copyListLevel=function(e,i){t.isNullOrUndefined(i.paragraphFormat)||(e.paragraphFormat=new F(e),e.paragraphFormat.copyFormat(i.paragraphFormat)),t.isNullOrUndefined(i.characterFormat)||(e.characterFormat=new P(e),e.characterFormat.copyFormat(i.characterFormat)),t.isNullOrUndefined(i.followCharacter)||(e.followCharacter=i.followCharacter),t.isNullOrUndefined(i.listLevelPattern)||(e.listLevelPattern=i.listLevelPattern),t.isNullOrUndefined(i.numberFormat)||(e.numberFormat=i.numberFormat),t.isNullOrUndefined(i.restartLevel)||(e.restartLevel=i.restartLevel),t.isNullOrUndefined(i.startAt)||(e.startAt=i.startAt)},e.prototype.cloneLevelOverride=function(e){var i=new w;return t.isNullOrUndefined(e.startAt)||(i.startAt=e.startAt),t.isNullOrUndefined(e.overrideListLevel)||(i.overrideListLevel=e.overrideListLevel),t.isNullOrUndefined(e.levelNumber)||(i.levelNumber=e.levelNumber),i},e.prototype.updateListParagraphs=function(){this.viewer.listParagraphs=[];for(var e=0;e<this.viewer.pages.length;e++)for(var t=this.viewer.pages[e].bodyWidgets[0],i=0;i<t.childWidgets.length;i++)this.updateListParagraphsInBlock(t.childWidgets[i])},e.prototype.updateListParagraphsInBlock=function(e){if(e instanceof G)t.isNullOrUndefined(e.paragraphFormat)||t.isNullOrUndefined(e.paragraphFormat.listFormat)||t.isNullOrUndefined(e.paragraphFormat.listFormat.listId)||(t.isNullOrUndefined(this.viewer.listParagraphs)&&(this.viewer.listParagraphs=[]),this.viewer.listParagraphs.push(e));else if(e instanceof K)for(var i=0;i<e.childWidgets.length;i++)for(var r=0;r<e.childWidgets[i].childWidgets.length;r++)for(var n=e.childWidgets[i].childWidgets[r],o=0;o<n.childWidgets.length;o++)this.updateListParagraphsInBlock(n.childWidgets[o])},e.prototype.onApplyList=function(e){var i=this.viewer.selection;this.setOffsetValue(this.viewer.selection),this.initHistory("ListFormat");var r=new x;t.isNullOrUndefined(e)||(r.listId=e.listId),this.viewer.owner.isShiftingEnabled=!0,i.isEmpty?(this.applyParaFormatProperty(i.start.paragraph,"listFormat",r,!1),this.layoutItemBlock(i.start.paragraph,!1)):this.updateSelectionParagraphFormatting("listFormat",r,!1),this.reLayout(i)},e.prototype.applyBulletOrNumbering=function(e,i,r){var n=this.viewer.selection,o=n.paragraphFormat.getList(),a=!1,s=n.start;n.isForward||(s=n.end);var l=s.paragraph;if(t.isNullOrUndefined(o)){for(;!t.isNullOrUndefined(l.previousWidget)&&l.previousWidget instanceof G&&l.previousWidget.isEmpty()&&-1===l.previousWidget.paragraphFormat.listFormat.listId;)l=l.previousWidget;l.previousWidget&&l.previousWidget instanceof G&&-1!==l.previousWidget.paragraphFormat.listFormat.listId&&(l=l.previousWidget,o=this.viewer.getListById(l.paragraphFormat.listFormat.listId),a=!0)}var d=void 0;if(!t.isNullOrUndefined(o)){var h=this.viewer.getListById(l.paragraphFormat.listFormat.listId);d=this.viewer.layout.getListLevel(h,l.paragraphFormat.listFormat.listLevelNumber)}if(t.isNullOrUndefined(o)||!t.isNullOrUndefined(o)&&(d.listLevelPattern!==i||d.numberFormat!==e||d.characterFormat.fontFamily!==r&&"Bullet"===d.listLevelPattern)){a=!1,o=new b,this.viewer.lists.length>0?o.listId=this.viewer.lists[this.viewer.lists.length-1].listId+1:o.listId=0;var c=new de;if(this.viewer.abstractLists.length>0?c.abstractListId=this.viewer.abstractLists[this.viewer.abstractLists.length-1].abstractListId+1:c.abstractListId=0,o.abstractListId=c.abstractListId,o.abstractList=c,this.viewer.abstractLists.push(c),"bullet"===e||"multiLevel"===e||"numbering"===e)this.addListLevels(c,e,n);else{var p=new he(c);p.listLevelPattern=i,p.numberFormat=e,"Bullet"!==i?p.startAt=1:p.characterFormat.fontFamily=r,p.paragraphFormat.leftIndent=36,p.paragraphFormat.firstLineIndent=-18,c.levels.push(p),n.paragraphFormat.listLevelNumber=0}n.paragraphFormat.setList(o)}else!t.isNullOrUndefined(o)&&a?n.paragraphFormat.setList(o):n.paragraphFormat.setList(void 0)},e.prototype.addListLevels=function(e,t,i){for(var r=["","","","",""],n=e.levels.length;n<9;n++){var o=new he(e);if(t.match("bullet"))o.listLevelPattern="Bullet",o.numberFormat=r[n<5?n%5:n%5+1],o.characterFormat.fontFamily=n<3||5===n?"Wingdings":"Symbol";else{if(t.match("multiLevel")){for(var a=0;a<n+1;a++)o.numberFormat+="%"+(a+1).toString()+".";o.listLevelPattern="Number"}else o.numberFormat="%"+(n+1).toString()+")",o.listLevelPattern=n%3==0?"Number":n%3==1?"LowLetter":"LowRoman";o.startAt=1,o.restartLevel=n}o.paragraphFormat.leftIndent=0===n?36:36*n,o.paragraphFormat.firstLineIndent=-18,e.levels.push(o),i.paragraphFormat.listLevelNumber=n}},e.prototype.insertPageBreak=function(){if(!this.owner.isReadOnlyMode){if(this.viewer.selection.start.paragraph.isInsideTable||this.viewer.selection.start.paragraph.isInHeaderFooter)return;this.initComplexHistory("PageBreak"),this.onEnter(!0),this.editorHistory&&null!=this.editorHistory.currentHistoryInfo&&this.editorHistory.updateComplexHistory(),this.selection.checkForCursorVisibility()}},e.prototype.onEnter=function(e){var i=this.viewer.selection;if(i.isEmpty){var r=i.getHyperlinkField();if(!t.isNullOrUndefined(r))return void i.fireRequestNavigate(r);if((p=i.start.paragraph).isEmpty()&&-1!==p.paragraphFormat.listFormat.listId)return void this.onApplyListInternal(this.viewer.getListById(p.paragraphFormat.listFormat.listId),p.paragraphFormat.listFormat.listLevelNumber-1)}this.initHistory("Enter");var n=!0;if(i.isEmpty||(n=this.removeSelectedContents(i)),n){i.owner.isShiftingEnabled=!0,this.updateInsertPosition();var o=this.getParagraphInfo(i.start),a=this.getHierarchicalIndex(o.paragraph,o.offset.toString());if(this.splitParagraphInternal(i,i.start.paragraph,i.start.currentWidget,i.start.offset),this.setPositionForCurrentIndex(i.start,a),e){var s=i.start.paragraph,l=new G;l.characterFormat.copyFormat(s.characterFormat),l.paragraphFormat.copyFormat(s.paragraphFormat);var d=new Q;d.text="\f";var h=new J(l);h.children.push(d),d.line=h,l.childWidgets.push(h),this.insertParagraph(l,!0),i.selectParagraph(l,!0)}var c=i.start.paragraph.nextWidget;t.isNullOrUndefined(c)&&(c=i.getNextRenderedBlock(i.start.paragraph)),i.selectParagraph(c,!0),this.updateEndPosition(),e&&this.editorHistory&&this.owner.editorHistory.updateHistory(),this.reLayout(i);var p=i.start.paragraph.previousWidget;!t.isNullOrUndefined(p)&&!p.isEmpty()&&p.lastChild.children[p.lastChild.children.length-1]instanceof Q&&this.checkAndConvertToHyperlink(i,!0,p)}},e.prototype.splitParagraphInternal=function(e,t,i,r){var n=0,o=t.index,a=new G,s=new J(a);a.childWidgets.push(s),a.paragraphFormat.ownerBase=a,i===t.lastChild&&r===e.getLineLength(i)?(t.paragraphFormat.baseStyle&&"Normal"!==t.paragraphFormat.baseStyle.name&&t.paragraphFormat.baseStyle.next instanceof N?(t.paragraphFormat.baseStyle.name===t.paragraphFormat.baseStyle.next.name?(a.paragraphFormat.copyFormat(t.paragraphFormat),a.characterFormat.copyFormat(t.characterFormat)):a.paragraphFormat.baseStyle=t.paragraphFormat.baseStyle.next,this.selection.skipFormatRetrieval=!1):(a.paragraphFormat.copyFormat(t.paragraphFormat),a.characterFormat.copyFormat(t.characterFormat)),n++,o++):(a.paragraphFormat.copyFormat(t.paragraphFormat),a.characterFormat.copyFormat(t.characterFormat),(r>0||!i.isFirstLine())&&(t=t.combineWidget(this.viewer),this.moveInlines(t,a,0,0,t.firstChild,r,i)),t=t.getSplitWidgets()[0]),n+=t.getIndex();var l=t.containerWidget;l.childWidgets.splice(n,0,a),a.containerWidget=l,a.index=o,this.updateNextBlocksIndex(a,!0),this.viewer.layout.layoutBodyWidgetCollection(o,l,a,!1)},e.prototype.updateNextBlocksIndex=function(e,t){var i=e.containerWidget.childWidgets.indexOf(e)+1;if(e.containerWidget instanceof V)for(var r=e.containerWidget.index,n=this.viewer.pages.indexOf(e.containerWidget.page);n<this.viewer.pages.length;n++){var o=this.viewer.pages[n];if(o.bodyWidgets[0].index!==r)return;for(var a=i;a<o.bodyWidgets[0].childWidgets.length;a++){var s=o.bodyWidgets[0].childWidgets[a];this.updateIndex(s,t)}i=0}else if(e.containerWidget instanceof Y)for(var l=e.containerWidget.getSplitWidgets(),d=l.indexOf(e.containerWidget),h=d;h<l.length;h++){for(var c=l[h].childWidgets,p=i;p<c.length;p++)this.updateIndex(c[p],t);d=0,i=0}else if(e.containerWidget instanceof X)for(f=i;f<e.containerWidget.childWidgets.length;f++){var g=e.containerWidget.childWidgets[f];g.rowIndex===e.containerWidget.index&&this.updateIndex(g,t)}else if(e.containerWidget instanceof K)for(f=i;f<e.containerWidget.childWidgets.length;f++){var u=e.containerWidget.childWidgets[f];this.updateIndex(u,t);for(n=0;n<u.childWidgets.length;n++)u.childWidgets[n].rowIndex=u.index}else if(e.containerWidget instanceof q)for(var f=i;f<e.containerWidget.childWidgets.length;f++){var m=e.containerWidget.childWidgets[f];this.updateIndex(m,t)}},e.prototype.updateIndex=function(e,t){t?e.index++:e.index--},e.prototype.updateEndPosition=function(){var e=this.viewer.selection;this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&this.updateHistoryPosition(e.start,!1)},e.prototype.onBackSpace=function(){var e=this.viewer.selection;if(e.isEmpty)this.singleBackspace(e,!1);else{this.initHistory("BackSpace");var t=this.deleteSelectedContents(e,!0);this.editorHistory&&this.editorHistory.currentBaseHistoryInfo&&(t?this.editorHistory.currentBaseHistoryInfo=void 0:(this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),this.reLayout(e)))}},e.prototype.insertRemoveBookMarkElements=function(){for(var e=!1,t=0;t<this.removedBookmarkElements.length;t++){var i=this.removedBookmarkElements[t];if(0===i.bookmarkType){var r=i;if(r&&r.reference&&-1!==this.removedBookmarkElements.indexOf(r.reference)){var n=this.removedBookmarkElements.indexOf(r.reference),o=this.removedBookmarkElements.indexOf(r);this.removedBookmarkElements.splice(n,1),this.removedBookmarkElements.splice(o,1)}else this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory(),this.initInsertInline(r.clone()),this.editorHistory.updateComplexHistory(),e=!0}else{var a=i;if(a&&a.reference&&-1!==this.removedBookmarkElements.indexOf(a.reference)){var n=this.removedBookmarkElements.indexOf(a.reference),o=this.removedBookmarkElements.indexOf(a);this.removedBookmarkElements.splice(n,1),this.removedBookmarkElements.splice(o,1)}else this.initComplexHistory(this.editorHistory.currentBaseHistoryInfo.action),this.editorHistory.updateHistory(),this.initInsertInline(a.clone()),this.editorHistory.updateComplexHistory(),e=!0}}return this.removedBookmarkElements=[],e},e.prototype.deleteSelectedContents=function(e,t){var i=this.deleteSelectedContentInternal(e,t,e.start,e.end),r=new Ie(e.owner),n=this.getParagraph({index:e.editPosition}),o=this.getLineInfo(n.paragraph,n.offset);return r.setPositionForLineWidget(o.line,o.offset),e.selectContent(r,!0),i},e.prototype.singleBackspace=function(e,t){var i=this.editorHistory;if(i&&!t&&!i.canRedo()&&i.canUndo()){var r=i.undoStack[i.undoStack.length-1],n=this.getParagraphInfo(e.start),o=this.getParagraphInfo(e.end);if("AutoFormatHyperlink"===r.action&&r.insertPosition===this.getHierarchicalIndex(n.paragraph,n.offset.toString())&&r.endPosition===this.getHierarchicalIndex(o.paragraph,o.offset.toString()))return void i.undo()}var a=e.start.paragraph,s=e.start.currentWidget,l=e.start.offset,d=0,h=s.getInline(l,d),c=h.element;if(d=h.index,c instanceof $&&2===c.fieldType&&W.isLinkedFieldCharacter(c)){var p=c.fieldBegin,g=c.fieldEnd;return e.start.setPositionParagraph(p.line,p.line.getOffset(p,0)),e.end.setPositionParagraph(g.line,g.line.getOffset(g,0)+1),void e.fireSelectionChanged(!0)}if(c instanceof $&&1===c.fieldType){var u=e.getPreviousValidElement(c);if(u instanceof $)return c=u.fieldBegin,a=c.line.paragraph,l=c.line.getOffset(c,0),e.end.setPositionParagraph(c.line,l),void e.fireSelectionChanged(!0);u!==c&&(a=(c=u).line.paragraph,l=c.line.getOffset(c,c.length))}if(c&&(c instanceof ie&&1===c.bookmarkType||c.previousNode instanceof ie)&&(c instanceof ie&&(a=(c=c.previousNode).line.paragraph,l=c.line.getOffset(c,c.length)),1===c.length&&c.nextNode instanceof ie&&c.previousNode instanceof ie)){var p=c.previousNode,g=c.nextNode;return e.start.setPositionParagraph(p.line,p.line.getOffset(p,0)),e.end.setPositionParagraph(g.line,g.line.getOffset(g,0)+1),this.initHistory("BackSpace"),this.deleteSelectedContents(e,!0),this.checkEndPosition(e)&&this.updateHistoryPosition(e.end,!1),void this.reLayout(e)}if(t||this.initHistory("BackSpace"),l===e.getStartOffset(a)&&e.start.currentWidget.isFirstLine()){if(a.paragraphFormat.listFormat&&-1!==a.paragraphFormat.listFormat.listId)return void this.onApplyList(void 0);if(0!==a.paragraphFormat.firstLineIndent)return void this.onApplyParagraphFormat("firstLineIndent",0,!1,!1);if(0!==a.paragraphFormat.leftIndent)return void this.onApplyParagraphFormat("leftIndent",0,!1,!1);if("Left"!==a.paragraphFormat.textAlignment)return void this.onApplyParagraphFormat("textAlignment","Left",!1,!0);if(a.previousRenderedWidget instanceof G){e.owner.isShiftingEnabled=!0;var f=a.previousRenderedWidget;if(f.isEmpty())this.removeBlock(f),this.addRemovedNodes(f);else{this.removeBlock(a);var m=this.viewer.selection.getLineLength(f.lastChild),v=f.childWidgets.length-1,y=void 0;if(!a.isEmpty())for(var w=0;w<a.childWidgets.length;w++)y=a.childWidgets[w],f.childWidgets.push(y),a.childWidgets.splice(w,1),w--,y.paragraph=f;this.viewer.layout.reLayoutParagraph(f,v,0),e.selects(f.childWidgets[v],m,!0),this.addRemovedNodes(a)}this.setPositionForHistory(),this.reLayout(e)}else this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo=void 0)}else{t||(e.owner.isShiftingEnabled=!0);var b=this.getParagraphInfo(e.start),y=e.start.currentWidget,x=l-1;x<0&&(y=y.previousLine,x=this.viewer.selection.getLineLength(y)+x),this.removeAtOffset(y,e,x),this.setPositionParagraph(b.paragraph,b.offset-1,!1),this.setPositionForHistory(),t?this.fireContentChange():this.reLayout(e)}},e.prototype.setPositionForHistory=function(e){var i=this.viewer.selection;this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(t.isNullOrUndefined(e)?(this.updateHistoryPosition(i.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition):(this.editorHistory.currentBaseHistoryInfo.insertPosition=e,this.editorHistory.currentBaseHistoryInfo.endPosition=e))},e.prototype.removeAtOffset=function(e,t,i){for(var r=0,n=e.paragraph.childWidgets.indexOf(e),o=0;o<e.children.length;o++){var a=e.children[o];if(!(a instanceof ne)){if(i<r+a.length){var s=i-r;if(i===r&&1===a.length)this.unLinkFieldCharacter(a),e.children.splice(o,1),this.viewer.layout.reLayoutParagraph(e.paragraph,n,o),this.addRemovedNodes(a);else{var l=new Q;l.characterFormat.copyFormat(a.characterFormat),l.text=a.text.substr(s,1),a.text=W.remove(a.text,s,1),this.viewer.layout.reLayoutParagraph(e.paragraph,n,o),this.addRemovedNodes(l)}break}r+=a.length}}},e.prototype.onDelete=function(){var e=this.viewer.selection;if(e.isEmpty)this.singleDelete(e,!1);else{this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var t=new Ie(e.owner);this.setPositionForCurrentIndex(t,e.editPosition),e.selectContent(t,!0),this.reLayout(e)}},e.prototype.singleDelete=function(e,i){var r=e.start.paragraph,n=e.start.offset,o=0,a=r.getInline(e.start.offset,o),s=a.element;if(o=a.index,r.paragraphFormat.listFormat&&-1!==r.paragraphFormat.listFormat.listId&&this.viewer.isListTextSelected&&"List"===e.contextType)return void this.onApplyList(void 0);if(t.isNullOrUndefined(s)||o!==s.length||t.isNullOrUndefined(s.nextNode)||(s=s.nextNode,o=0),!t.isNullOrUndefined(s)){var l=void 0,d=e.getNextValidElement(s);if(d instanceof Z&&(l=d),!t.isNullOrUndefined(l)&&l instanceof $&&0===l.fieldType)return s=l.fieldEnd,r=s.line.paragraph,n=s.line.getOffset(s,1),e.end.setPositionParagraph(s.line,n),void e.fireSelectionChanged(!0);s!==l&&(r=(s=l).line.paragraph,n=s.line.getOffset(s,0),s instanceof $&&1===s.fieldType&&n++)}if(s&&(s instanceof ie&&0===s.bookmarkType||s.nextNode instanceof ie)&&(s instanceof ie&&(r=(s=s.nextNode).line.paragraph,n=s.line.getOffset(s,0)),1===s.length&&s.nextNode instanceof ie&&s.previousNode instanceof ie)){var h=s.previousNode,c=s.nextNode;e.start.setPositionParagraph(h.line,h.line.getOffset(h,0)),e.end.setPositionParagraph(c.line,c.line.getOffset(c,0)+1),this.initHistory("Delete"),this.deleteSelectedContentInternal(e,!1,e.start,e.end);var p=new Ie(e.owner);return this.setPositionForCurrentIndex(p,e.editPosition),e.selectContent(p,!0),void this.reLayout(e)}if(e.start.currentWidget.isLastLine()&&n===this.viewer.selection.getLineLength(e.start.currentWidget)){if(r.isInsideTable&&t.isNullOrUndefined(r.nextWidget))return;var g=void 0,u=e.getNextParagraphBlock(r);if(t.isNullOrUndefined(u)){if(n>0)return;if(r.previousWidget instanceof G&&(g=r.previousWidget),r.previousWidget instanceof K)return;if(t.isNullOrUndefined(g))return}i||this.initHistory("Delete");var f=this.getParagraphInfo(e.start);if(e.editPosition=this.getHierarchicalIndex(f.paragraph,f.offset.toString()),this.checkInsertPosition(e)&&this.setPositionForHistory(e.editPosition),e.owner.isShiftingEnabled=!0,r.isEmpty())if(this.removeBlock(r),this.addRemovedNodes(r),t.isNullOrUndefined(u))if(t.isNullOrUndefined(g)){var m=e.getParagraphLength(void 0)+1;this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.getHierarchicalIndex(void 0,m.toString()))}else e.selectParagraph(g,!1),this.setPositionForHistory();else e.selectParagraph(u,!0);else{r=r.combineWidget(this.viewer);var v=this.splitParagraph(r,r.firstChild,0,e.start.currentWidget,e.start.offset,!0);this.deleteParagraphMark(v,e,0),this.addRemovedNodes(r),this.setPositionForCurrentIndex(e.start,e.editPosition),e.selectContent(e.start,!0)}this.reLayout(e)}else this.singleDeleteInternal(e,i,r)},e.prototype.singleDeleteInternal=function(e,t,i){t||(e.owner.isShiftingEnabled=!0,this.initHistory("Delete")),this.checkInsertPosition(e)&&(this.updateHistoryPosition(e.start,!0),this.editorHistory.currentBaseHistoryInfo.endPosition=this.editorHistory.currentBaseHistoryInfo.insertPosition);var r=this.getParagraphInfo(e.start),n=e.start.currentWidget,o=e.start.offset,a=e.getLineLength(e.start.currentWidget);o>=a&&(n=n.nextLine,o-=a),this.removeAtOffset(n,e,o),this.setPositionParagraph(r.paragraph,r.offset,!1),t?this.fireContentChange():this.reLayout(e)},e.prototype.deleteParagraphMark=function(e,i,r){if(!t.isNullOrUndefined(e.containerWidget)){e=e.combineWidget(this.viewer);var n=i.getNextParagraphBlock(e);if(!(e.isInsideTable&&t.isNullOrUndefined(e.nextWidget)||t.isNullOrUndefined(n))){e.containerWidget instanceof V&&e.containerWidget;var o=void 0;if(o=i.getNextRenderedBlock(e)instanceof K?i.getNextRenderedBlock(e):void 0,n.isInsideTable&&!t.isNullOrUndefined(o)&&o.contains(n.associatedCell)){if(r<4){var a=0;this.removeBlock(e),this.viewer.layout.clearListElementBox(n),this.viewer.layout.clearListElementBox(e);for(h=e.childWidgets.length-1;h>=0;h--)for(var s=e.childWidgets[h],l=s.children.length-1;l>=0;l--){var d=s.children[l];a+=d.length,n.firstChild.children.unshift(d),d.line=n.firstChild}this.viewer.layout.reLayoutParagraph(n,0,0),a>0&&(i.editPosition=this.getHierarchicalIndex(n,a.toString()))}}else if(r<4){e.childWidgets.length,n.getSplitWidgets();n=n.combineWidget(this.viewer),this.viewer.layout.clearListElementBox(n),this.viewer.layout.clearListElementBox(e),this.updateEditPositionOnMerge(e,n);for(var h=0;h<n.childWidgets.length;h++){var c=n.childWidgets[h];n.childWidgets.splice(h,1),e.childWidgets.push(c),c.paragraph=e,h--}0===n.childWidgets.length&&n.childWidgets.push(new J(n)),this.removeBlock(n),this.viewer.layout.reLayoutParagraph(e,0,0),this.addRemovedNodes(n)}}}},e.prototype.updateEditPositionOnMerge=function(e,t){this.viewer.selection.editPosition===this.getHierarchicalIndex(t,"0")&&void 0===t.nextRenderedWidget&&(this.viewer.selection.editPosition=this.getHierarchicalIndex(e,this.viewer.selection.getLineLength(e.lastChild).toString()))},e.prototype.checkEndPosition=function(e){return this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.endPosition)},e.prototype.checkInsertPosition=function(e){return this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)&&t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo.insertPosition)},e.prototype.checkIsNotRedoing=function(){return this.viewer.owner.enableHistoryMode&&!this.editorHistory.isRedoing},e.prototype.deleteSelectedContentInternal=function(e,i,r,n){var o=r,a=n;r.isExistBefore(n)||(o=n,a=r);var s=this.getParagraphInfo(o);e.editPosition=this.getHierarchicalIndex(s.paragraph,s.offset.toString());var l=!1;if(i&&o.isInSameParagraph(a)&&(o.offset<a.offset&&o.offset===e.getParagraphLength(a.paragraph)&&(l=e.getNextRenderedBlock(o.paragraph)instanceof K),!(1===a.offset&&a.offset>e.getParagraphLength(a.paragraph))||a.paragraph.isInsideTable&&t.isNullOrUndefined(a.paragraph.nextWidget)||(i=!1)),!l){e.owner.isShiftingEnabled=!0,this.checkInsertPosition(e)&&(this.editorHistory.currentBaseHistoryInfo.insertPosition=e.editPosition);var d=i?1:0;this.deleteSelectedContent(a.paragraph,e,o,a,d)}return l},e.prototype.initHistory=function(e){this.viewer.owner.enableHistoryMode&&this.editorHistory.initializeHistory(e)},e.prototype.initComplexHistory=function(e){this.viewer.owner.enableHistoryMode&&this.editorHistory.initComplexHistory(this.viewer.selection,e)},e.prototype.insertPicture=function(e,t,i){var r=new re(!0);r.imageString=e,r.width=t,r.height=i,this.insertPictureInternal(r)},e.prototype.insertPictureInternal=function(e){var t=this.viewer.selection;this.initHistory("InsertInline"),this.fitImageToPage(t,e),this.insertInlineInSelection(t,e),this.reLayout(t)},e.prototype.fitImageToPage=function(e,t){var i=e.start.paragraph.bodyWidget,r=i.sectionFormat.pageWidth-i.sectionFormat.leftMargin-i.sectionFormat.rightMargin,n=i.sectionFormat.pageHeight-i.sectionFormat.topMargin-i.sectionFormat.topMargin;t.width>r&&(t.height=t.height*r/t.width,t.width=r),t.height>n&&(t.width=t.width*n/t.height,t.height=n)},e.prototype.insertInlineInSelection=function(e,t){this.checkIsNotRedoing()&&(e.owner.isShiftingEnabled=!0),e.isEmpty||this.removeSelectedContents(e),this.updateInsertPosition(),this.insertInlineInternal(t),this.checkEndPosition(e)&&this.updateHistoryPosition(e.start,!1),this.fireContentChange()},e.prototype.onPortrait=function(){var e=new y,t=this.viewer.selection.sectionFormat.pageWidth,i=this.viewer.selection.sectionFormat.pageHeight;t>i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.onLandscape=function(){var e=new y,t=this.viewer.selection.sectionFormat.pageWidth,i=this.viewer.selection.sectionFormat.pageHeight;t<i&&(e.pageWidth=i,e.pageHeight=t),this.onApplySectionFormat(void 0,e)},e.prototype.copyValues=function(){var e=new y;return e.bottomMargin=this.viewer.selection.sectionFormat.bottomMargin,e.topMargin=this.viewer.selection.sectionFormat.topMargin,e.leftMargin=this.viewer.selection.sectionFormat.leftMargin,e.rightMargin=this.viewer.selection.sectionFormat.rightMargin,e.pageHeight=this.viewer.selection.sectionFormat.pageHeight,e.pageWidth=this.viewer.selection.sectionFormat.pageWidth,e.footerDistance=this.viewer.selection.sectionFormat.footerDistance,e.headerDistance=this.viewer.selection.sectionFormat.headerDistance,e},e.prototype.changeMarginValue=function(e){var t=this.copyValues();"lastCustomSetting"===e||"normal"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=72,t.rightMargin=72):"narrow"===e?(t.topMargin=36,t.bottomMargin=36,t.leftMargin=36,t.rightMargin=36):"moderate"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=54,t.rightMargin=54):"wide"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=144,t.rightMargin=144):"mirrored"===e?(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=72):"office2003Default"===e&&(t.topMargin=72,t.bottomMargin=72,t.leftMargin=90,t.rightMargin=90),this.onApplySectionFormat(void 0,t)},e.prototype.onPaperSize=function(e){var t=this.copyValues(),i=this.viewer.selection.sectionFormat.pageWidth,r=this.viewer.selection.sectionFormat.pageHeight;"letter"===e?i<r?(t.pageWidth=611.9,t.pageHeight=791.9):(t.pageWidth=791.9,t.pageHeight=611.9):"tabloid"===e?i<r?(t.pageWidth=791.9,t.pageHeight=1223.9):(t.pageWidth=1223.9,t.pageHeight=791.9):"legal"===e?i<r?(t.pageWidth=611.9,t.pageHeight=1007.9):(t.pageWidth=1007.9,t.pageHeight=611.9):"statement"===e?i<r?(t.pageWidth=396,t.pageHeight=611.9):(t.pageWidth=611.9,t.pageHeight=396):"executive"===e?i<r?(t.pageWidth=521.9,t.pageHeight=755.9):(t.pageWidth=755.9,t.pageHeight=521.9):"a3"===e?i<r?(t.pageWidth=841.8,t.pageHeight=1190.4):(t.pageWidth=1190.4,t.pageHeight=841.8):"a4"===e?i<r?(t.pageWidth=595.2,t.pageHeight=841.8):(t.pageWidth=841.8,t.pageHeight=595.2):"a5"===e?i<r?(t.pageWidth=419.5,t.pageHeight=595.2):(t.pageWidth=595.2,t.pageHeight=419.5):"b4"===e?i<r?(t.pageWidth=728.4,t.pageHeight=1031.7):(t.pageWidth=1031.7,t.pageHeight=728.4):"b5"===e&&(i<r?(t.pageWidth=515.8,t.pageHeight=728.4):(t.pageWidth=728.4,t.pageHeight=515.8)),this.onApplySectionFormat(void 0,t)},e.prototype.updateListItemsTillEnd=function(e,i){for(var r=i?this.viewer.selection.getNextRenderedBlock(e):e;!t.isNullOrUndefined(r);)this.updateRenderedListItems(r),r=r.getSplitWidgets().pop().nextRenderedWidget},e.prototype.updateWholeListItems=function(e){this.viewer.renderedLists.clear();for(var t,i=e.bodyWidget.index,r=0;r<this.viewer.pages.length;r++){var n=this.viewer.pages[r];if(n.bodyWidgets[0].index===i){t=n.bodyWidgets[0].firstChild;break}}do{if(this.updateListItems(t,e))break;t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)},e.prototype.updateListItems=function(e,t){return e instanceof G?this.updateListItemsForPara(e,t):this.updateListItemsForTable(e,t)},e.prototype.updateListItemsForTable=function(e,t){if(t instanceof K&&e.equals(t))return!0;var i=e.firstChild;do{if(this.updateListItemsForRow(i,t))return!0;i=i.getSplitWidgets().pop().nextRenderedWidget}while(i);return!1},e.prototype.updateListItemsForRow=function(e,t){if(t.isInsideTable&&-1!==e.childWidgets.indexOf(this.viewer.selection.getContainerCell(t.associatedCell)))return!0;var i=e.firstChild;do{this.updateListItemsForCell(i,t),i=i.nextRenderedWidget}while(i);return!1},e.prototype.updateListItemsForCell=function(e,t){if(0!==e.childWidgets.length){var i=e.firstChild;do{this.updateListItems(i,t),i=i.getSplitWidgets().pop().nextRenderedWidget}while(i)}},e.prototype.updateRenderedListItems=function(e){e instanceof G?this.updateRenderedListItemsForPara(e):this.updateRenderedListItemsForTable(e)},e.prototype.updateRenderedListItemsForTable=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForRow(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForRow=function(e){var t=e.firstChild;do{this.updateRenderedListItemsForCell(t),t=t.nextRenderedWidget}while(t)},e.prototype.updateRenderedListItemsForCell=function(e){if(0!==e.childWidgets.length){var t=e.firstChild;do{this.updateRenderedListItems(t),t=t.getSplitWidgets().pop().nextRenderedWidget}while(t)}},e.prototype.updateListItemsForPara=function(e,i){if(e.equals(i))return!0;var r=void 0,n=0;return t.isNullOrUndefined(e.paragraphFormat)||t.isNullOrUndefined(e.paragraphFormat.listFormat)||(r=this.viewer.getListById(e.paragraphFormat.listFormat.listId),n=e.paragraphFormat.listFormat.listLevelNumber),t.isNullOrUndefined(r)||t.isNullOrUndefined(this.viewer.getAbstractListById(r.abstractListId))||t.isNullOrUndefined(this.viewer.getAbstractListById(r.abstractListId).levels[n])||"Bullet"!==this.viewer.layout.getListLevel(r,n).listLevelPattern&&this.viewer.layout.getListNumber(e.paragraphFormat.listFormat),!1},e.prototype.updateRenderedListItemsForPara=function(e){if(!t.isNullOrUndefined(this.viewer.getListById(e.paragraphFormat.listFormat.listId))){var i=this.viewer.getListById(e.paragraphFormat.listFormat.listId),r=e.paragraphFormat.listFormat.listLevelNumber;if(!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(this.viewer.getAbstractListById(i.abstractListId))&&!t.isNullOrUndefined(this.viewer.getAbstractListById(i.abstractListId).levels[e.paragraphFormat.listFormat.listLevelNumber])&&"Bullet"!==this.viewer.layout.getListLevel(i,r).listLevelPattern){var n=void 0;if(e.childWidgets.length>0){var o=e.childWidgets[0];o.children.length>0&&(n=o.children[0])}t.isNullOrUndefined(n)||(n.text=this.viewer.layout.getListNumber(e.paragraphFormat.listFormat))}}},e.prototype.getParagraphInfo=function(e){return this.getParagraphInfoInternal(e.currentWidget,e.offset)},e.prototype.getParagraphInfoInternal=function(e,t){for(var i=e.paragraph,r=this.selection.getParagraphLength(i,e)+t,n=i.previousSplitWidget;n instanceof G;)i=n,r+=this.viewer.selection.getParagraphLength(i),n=i.previousSplitWidget;return{paragraph:i,offset:r}},e.prototype.getOffsetValue=function(e){if(this.startParagraph){t=this.getLineInfo(this.startParagraph,this.startOffset);e.start.setPositionFromLine(t.line,t.offset)}if(e.start.updatePhysicalPosition(!0),e.isEmpty)e.end.setPositionInternal(e.start);else{if(this.endParagraph){var t=this.getLineInfo(this.endParagraph,this.endOffset);e.end.setPositionFromLine(t.line,t.offset)}e.end.updatePhysicalPosition(!0)}},e.prototype.getLineInfo=function(e,i){var r=this.selection.getParagraphLength(e),n=e.nextSplitWidget;for(i>r+1&&t.isNullOrUndefined(n)&&(i=r);i>r&&n instanceof G;)i-=r,e=n,r=this.selection.getParagraphLength(e),n=e.nextSplitWidget;return this.selection.getLineInfo(e,i)},e.prototype.setPositionParagraph=function(e,t,i){var r=this.viewer.selection,n=this.getLineInfo(e,t);r.start.setPositionFromLine(n.line,n.offset),r.end.setPositionInternal(r.start),i||r.fireSelectionChanged(!0)},e.prototype.setPositionForCurrentIndex=function(e,t){var i=this.getParagraph({index:t}),r=this.getLineInfo(i.paragraph,i.offset);e.setPositionForLineWidget(r.line,r.offset)},e.prototype.insertPageNumber=function(e){var i="PAGE "+(e=t.isNullOrUndefined(e)?"":" \\*"+e)+" \\* MERGEFORMAT";this.createFields(i)},e.prototype.insertPageCount=function(e){var i="NUMPAGES "+(e=t.isNullOrUndefined(e)?"":" *"+e)+" * MERGEFORMAT";this.createFields(i)},e.prototype.createFields=function(e){var t=new G,i=new J(t),r=new $(0);i.children.push(r);var n=new ee;n.fieldBegin=r,n.text="1";var o=new Q;o.text=e,i.children.push(o);var a=new $(2);a.fieldBegin=r,r.fieldSeparator=a,i.children.push(a),i.children.push(n);var s=new $(1);s.fieldBegin=r,s.fieldSeparator=a,a.fieldEnd=s,r.fieldEnd=s,i.children.push(s),r.line=i,t.childWidgets.push(i);var l=[];l.push(t),this.viewer.fields.push(r),this.pasteContentsInternal(l)},e.prototype.insertBookmark=function(e){var t=new ie(0);t.name=e;var i=new ie(1);i.name=e,t.reference=i,i.reference=t,this.viewer.bookmarks.add(e,t),this.initComplexHistory("InsertBookmark"),this.insertElements([i],[t]),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal(),this.selection.start.setPositionForSelection(t.line,t,1,this.selection.start.location),this.selection.end.setPositionForSelection(i.line,i,0,this.selection.end.location),this.selection.fireSelectionChanged(!0),this.fireContentChange()},e.prototype.deleteBookmark=function(e){var t=this.viewer.bookmarks.get(e);if(t instanceof ie){t.reference;this.initHistory("DeleteBookmark"),this.editorHistory&&(this.editorHistory.currentBaseHistoryInfo.setBookmarkInfo(t),this.editorHistory.updateHistory()),this.deleteBookmarkInternal(t)}this.fireContentChange()},e.prototype.deleteBookmarkInternal=function(e){this.viewer.bookmarks.remove(e.name),e.line.children.splice(e.indexInOwner,1),e.reference.line.children.splice(e.reference.indexInOwner,1)},e.prototype.getSelectionInfo=function(){var e=this.selection.start,t=this.selection.end,i=this.selection.isEmpty;this.selection.isForward||(e=this.selection.end,t=this.selection.start);var r=e.currentWidget.getInline(e.offset,0),n=t.currentWidget.getInline(t.offset,0);return{start:e.clone(),end:t.clone(),startElementInfo:r,endElementInfo:n,isEmpty:i}},e.prototype.insertElements=function(e,i){var r=this.getSelectionInfo();t.isNullOrUndefined(i)||this.insertElementsInternal(r.start,i),t.isNullOrUndefined(e)||this.insertElementsInternal(r.end,e)},e.prototype.insertElementsInternal=function(e,t){this.selection.selectPosition(e,e),this.initHistory("InsertElements"),this.updateInsertPosition();var i=0,r=this.getParagraphInfo(this.selection.start);if(this.selection.start.paragraph.isEmpty()){var n=this.selection.start.paragraph;n.childWidgets[0].children.push(t[0]),t[0].line=n.childWidgets[0],t[0].linkFieldCharacter(this.viewer),this.viewer.layout.reLayoutParagraph(n,0,0),this.setPositionParagraph(r.paragraph,r.offset+length,!0),e.setPositionForSelection(t[0].line,t[0],t[0].length,this.selection.start.location),this.selection.selectPosition(e,e)}else{var o=this.selection.start.currentWidget.getInline(this.viewer.selection.start.offset,i),a=o.element;i=o.index;var s=t[0];this.insertElementInternal(a,s,i,!0);for(var l=s.indexInOwner,d=s,h=1;h<t.length;h++)d=t[h],s.line.children.splice(l+h,0,d);e.setPositionForSelection(d.line,d,d.length,this.selection.start.location),this.selection.selectPosition(e,e)}this.editorHistory&&(this.checkEndPosition()&&this.updateHistoryPosition(this.selection.start,!1),this.editorHistory.updateHistory())},e.prototype.getHierarchicalIndex=function(e,t){var i;if(e){if(e instanceof q){var r=-1!==e.headerFooterType.indexOf("Header")?"H":"F",n=e.page.index.toString();this.viewer.getHeaderFooter(e.headerFooterType).toString();i=e.page.sectionIndex+";"+r+";"+n+";"+t}else i=e.index+";"+t;if(e.containerWidget)return e instanceof Y&&e.rowIndex!==e.containerWidget.index&&(i=e.rowIndex+";"+i,e=e.containerWidget),this.getHierarchicalIndex(e.containerWidget,i)}return i},e.prototype.getBlock=function(e){var t=this.getBodyWidget(e);return this.getBlockInternal(t,e)},e.prototype.getBlockInternal=function(e,i){if(""!==i.index&&!t.isNullOrUndefined(i)){var r=i.index.indexOf(";"),n=i.index.substring(0,r);i.index=i.index.substring(r).replace(";","");var o=e;r=parseInt(n,10);var a=this.getBlockByIndex(e,r);if(!a)return{node:o,position:i};var s=a;if(!(i.index.indexOf(";")>=0))return{node:s,position:i};if(s instanceof G)return i.index.indexOf(";")>=0&&(i.index="0"),{node:s,position:i};if(s instanceof z){var l=this.getBlockInternal(s,i);return{node:t.isNullOrUndefined(l)?void 0:l.node,position:t.isNullOrUndefined(l)?void 0:l.position}}return{node:o,position:i}}},e.prototype.getParagraph=function(e){return{paragraph:this.getParagraphInternal(this.getBodyWidget(e),e),offset:parseInt(e.index,10)}},e.prototype.getParagraphInternal=function(e,i){if(!t.isNullOrUndefined(i.index)){var r=i.index.indexOf(";"),n="0";r>=0&&(n=i.index.substring(0,r),i.index=i.index.substring(r).replace(";","")),r=parseInt(n,10),e instanceof X&&r>=e.childWidgets.length&&(i.index="0;0",r=e.childWidgets.length-1);var o=this.getBlockByIndex(e,r);if(o){var a=o;if(a instanceof G)return i.index.indexOf(";")>0&&(i.index="0"),a;if(a instanceof z){if(i.index.indexOf(";")>0)return this.getParagraphInternal(a,i);if(a instanceof K)return this.viewer.selection.getFirstParagraphInFirstCell(a);return}}else if(e){var s=e.getSplitWidgets().pop().nextRenderedWidget;if(s instanceof z)return i.index="0",s instanceof K?this.viewer.selection.getFirstParagraphInFirstCell(s):s}}},e.prototype.getBodyWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r=parseInt(i,10);return t=parseInt(i,10),t=e.index.indexOf(";"),"H"===(i=e.index.substring(0,t))||"F"===i?this.getHeaderFooterWidget(e):(t=parseInt(i,10),this.getBodyWidgetInternal(r,t))},e.prototype.getHeaderFooterWidget=function(e){var t=e.index.indexOf(";"),i=e.index.substring(0,t);e.index=e.index.substring(t).replace(";","");var r="H"===i;t=e.index.indexOf(";"),i=e.index.substring(0,t),e.index=e.index.substring(t).replace(";",""),t=parseInt(i,10);var n=this.viewer.pages[t];return r?n.headerWidget:n.footerWidget},e.prototype.getBodyWidgetInternal=function(e,t){for(var i=0;i<this.viewer.pages.length;i++){var r=this.viewer.pages[i].bodyWidgets[0];if(r.index===e&&r.firstChild.index<=t&&r.lastChild.index>=t)return r;if(r.index>e)break}},e.prototype.getBlockByIndex=function(e,t){var i;if(e){for(var r=0;r<e.childWidgets.length;r++)if(e.childWidgets[r].index===t){i=e.childWidgets[r];break}if(!(i||e instanceof q))return this.getBlockByIndex(e.nextSplitWidget,t)}return i},e.prototype.updateHistoryPosition=function(e,i){if(this.editorHistory&&!t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)){var r=void 0;if(e instanceof Ie){var n=this.getParagraphInfo(e);r=this.getHierarchicalIndex(n.paragraph,n.offset.toString())}else r=e;i?this.editorHistory.currentBaseHistoryInfo.insertPosition=r:this.editorHistory.currentBaseHistoryInfo.endPosition=r}},e.prototype.applyBorders=function(e){this.initHistory("Borders");var t=this.selection.isForward?this.selection.start:this.selection.end,i=this.selection.isForward?this.selection.end:this.selection.start,r=t.paragraph.associatedCell.ownerTable;if(r=r.combineWidget(this.viewer),this.editorHistory)this.cloneTableToHistoryInfo(r);t.paragraph.associatedCell;var n,o=i.paragraph.associatedCell,a=this.getBorder(e.borderColor,e.lineWidth,e.borderStyle);if(this.selection.isEmpty)"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"LeftBorder"!==e.type||o.cellFormat.borders.left.copyFormat(a),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"TopBorder"!==e.type||o.cellFormat.borders.top.copyFormat(a),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"RightBorder"!==e.type||o.cellFormat.borders.right.copyFormat(a),"OutsideBorders"!==e.type&&"AllBorders"!==e.type&&"BottomBorder"!==e.type||o.cellFormat.borders.bottom.copyFormat(a),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type||o.cellFormat.borders.vertical.copyFormat(a),"AllBorders"!==e.type&&"InsideBorders"!==e.type&&"InsideHorizontalBorder"!==e.type||o.cellFormat.borders.horizontal.copyFormat(a),"NoBorder"===e.type&&this.clearAllBorderValues(o.cellFormat.borders);else{if("OutsideBorders"===e.type||"TopBorder"===e.type)for(var s=this.getTopBorderCellsOnSelection(),l=0;l<s.length;l++)s[l].cellFormat.borders.top.copyFormat(a);if("OutsideBorders"===e.type||"LeftBorder"===e.type)for(var s=this.getLeftBorderCellsOnSelection(),l=0;l<s.length;l++)s[l].cellFormat.borders.left.copyFormat(a);if("OutsideBorders"===e.type||"RightBorder"===e.type)for(var s=this.getRightBorderCellsOnSelection(),l=0;l<s.length;l++)s[l].cellFormat.borders.right.copyFormat(a);if("OutsideBorders"===e.type||"BottomBorder"===e.type)for(var s=this.getBottomBorderCellsOnSelection(),l=0;l<s.length;l++)s[l].cellFormat.borders.bottom.copyFormat(a)}if("BottomBorder"===e.type||"AllBorders"===e.type||"OutsideBorders"===e.type||"NoBorder"===e.type){n=this.getAdjacentCellToApplyBottomBorder();for(l=0;l<n.length;l++){d=n[l];"NoBorder"===e.type?d.cellFormat.borders.top.copyFormat(this.clearBorder()):d.cellFormat.borders.top.copyFormat(a)}}if("AllBorders"===e.type||"OutsideBorders"===e.type||"RightBorder"===e.type||"NoBorder"===e.type){n=this.getAdjacentCellToApplyRightBorder();for(l=0;l<n.length;l++){var d=n[l];"NoBorder"===e.type?d.cellFormat.borders.left.copyFormat(this.clearBorder()):d.cellFormat.borders.left.copyFormat(a)}}"AllBorders"!==e.type&&"NoBorder"!==e.type||this.applyAllBorders(a,e.type),"InsideBorders"!==e.type&&"InsideVerticalBorder"!==e.type&&"InsideHorizontalBorder"!==e.type&&"NoBorder"!==e.type||this.applyInsideBorders(a,e.type,r),this.updateGridForTableDialog(r,!1),this.reLayout(this.selection,!1),this.editorHistory.updateHistory()},e.prototype.applyAllBorders=function(e,t){for(var i=this.selection.getSelectedCells(),r=0;r<i.length;r++)"NoBorder"===t?(i[r].cellFormat.borders.left.copyFormat(this.clearBorder()),i[r].cellFormat.borders.right.copyFormat(this.clearBorder()),i[r].cellFormat.borders.top.copyFormat(this.clearBorder()),i[r].cellFormat.borders.bottom.copyFormat(this.clearBorder())):(i[r].cellFormat.borders.left.copyFormat(e),i[r].cellFormat.borders.right.copyFormat(e),i[r].cellFormat.borders.top.copyFormat(e),i[r].cellFormat.borders.bottom.copyFormat(e))},e.prototype.applyInsideBorders=function(e,t,i){for(var r=this.selection.getSelectedCells(),n=0;n<r.length;n++){var o=r[n],a=o.ownerRow===r[r.length-1].ownerRow,s=o.columnIndex+o.cellFormat.columnSpan-1===r[r.length-1].columnIndex;if("NoBorder"===t?(o.cellFormat.borders.right.copyFormat(this.clearBorder()),o.cellFormat.borders.bottom.copyFormat(this.clearBorder())):(s||"InsideHorizontalBorder"===t||o.cellFormat.borders.right.copyFormat(e),a||"InsideVerticalBorder"===t||o.cellFormat.borders.bottom.copyFormat(e)),!a&&"InsideVerticalBorder"!==t){var l=o.ownerRow.rowIndex+o.cellFormat.rowSpan,d=i.childWidgets[l];if(d)for(var h=this.getAdjacentBottomBorderOnEmptyCells(d,o,!0),c=0;c<h.length;c++)"NoBorder"===t?h[c].cellFormat.borders.top.copyFormat(this.clearBorder()):h[c].cellFormat.borders.top.copyFormat(e)}if(!s&&"InsideHorizontalBorder"!==t)for(var p=this.getSelectedCellsNextWidgets(o,i),g=0;g<p.length;g++)"NoBorder"===t?p[g].cellFormat.borders.left.copyFormat(this.clearBorder()):p[g].cellFormat.borders.left.copyFormat(e)}},e.prototype.getTopBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=[],i=this.selection.getSelectedCells(),r=0;r<i.length;r++)i[r].ownerRow===e.ownerRow&&t.push(i[r]);return t},e.prototype.getLeftBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.start:this.selection.end).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],r=0;r<t.length;r++)t[r].columnIndex===e.columnIndex&&i.push(t[r]);return i},e.prototype.getRightBorderCellsOnSelection=function(){for(var e=this.selection.getSelectedCells(),t=[],i=0;i<e.length;i++)e[i].columnIndex+e[i].cellFormat.columnSpan-1===e[e.length-1].columnIndex&&t.push(e[i]);return t},e.prototype.getBottomBorderCellsOnSelection=function(){for(var e=(this.selection.isForward?this.selection.end:this.selection.start).paragraph.associatedCell,t=this.selection.getSelectedCells(),i=[],r=0;r<t.length;r++)t[r].ownerRow===e.ownerRow&&i.push(t[r]);return i},e.prototype.clearAllBorderValues=function(e){var t=this.clearBorder();e.bottom.copyFormat(t),e.left.copyFormat(t),e.right.copyFormat(t),e.top.copyFormat(t),e.vertical.copyFormat(t),e.horizontal.copyFormat(t)},e.prototype.clearBorder=function(){var e=new k;return e.lineStyle="Cleared",e},e.prototype.getAdjacentCellToApplyBottomBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=t.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.viewer);var n=t.paragraph.associatedCell,o=i.paragraph.associatedCell,a=o.ownerRow.rowIndex+o.cellFormat.rowSpan,s=r.childWidgets[a];if(s)if(o.cellFormat.columnSpan>1)for(l=o.columnIndex;l<o.columnIndex+o.cellFormat.columnSpan;l++)e.push(s.childWidgets[l]);else if(e=this.getAdjacentBottomBorderOnEmptyCells(s,o),!this.selection.isEmpty)for(var l=0;l<s.childWidgets.length;l++){var d=s.childWidgets[l].columnIndex;d>=n.columnIndex&&d<=o.columnIndex&&e.push(s.childWidgets[l])}return e},e.prototype.getAdjacentBottomBorderOnEmptyCells=function(e,t,i){var r=[];if(t.cellFormat.columnSpan>1)for(n=t.columnIndex;n<t.columnIndex+t.cellFormat.columnSpan;n++)r.push(e.childWidgets[n]);else if(this.selection.isEmpty||i)for(var n=0;n<e.childWidgets.length;n++)e.childWidgets[n].columnIndex===t.columnIndex&&r.push(e.childWidgets[n]);return r},e.prototype.getAdjacentCellToApplyRightBorder=function(){var e=[],t=this.selection.start,i=this.selection.end;this.selection.isForward||(t=this.selection.end,i=this.selection.start);var r=t.paragraph.associatedCell.ownerTable;r=r.combineWidget(this.viewer);t.paragraph.associatedCell,i.paragraph.associatedCell;if(this.selection.isEmpty){var n=t.paragraph.associatedCell;e=this.getSelectedCellsNextWidgets(n,r)}else for(var o=this.getRightBorderCellsOnSelection(),a=0;a<o.length;a++){var s=o[a];e=e.concat(this.getSelectedCellsNextWidgets(s,r))}return e},e.prototype.getSelectedCellsNextWidgets=function(e,t){var i=[];if(e.nextWidget&&i.push(e.nextWidget),e.cellFormat.rowSpan>1)for(var r=e.ownerRow.rowIndex+e.cellFormat.rowSpan,n=e.ownerRow.rowIndex+1;n<r;n++){var o=t.childWidgets[n];if(o)for(var a=0;a<o.childWidgets.length;a++)o.childWidgets[a].columnIndex===e.nextWidget.columnIndex&&i.push(o.childWidgets[a])}return i},e.prototype.getBorder=function(e,t,i){var r=new k;return r.color=e||"#000000",r.lineWidth=t||1,r.lineStyle=i||"Single",r},e.prototype.applyBordersInternal=function(e,i){t.isNullOrUndefined(e)||t.isNullOrUndefined(e)||(t.isNullOrUndefined(e.top)||this.applyBorder(e.top,i.top),t.isNullOrUndefined(e.bottom)||this.applyBorder(e.bottom,i.bottom),t.isNullOrUndefined(e.left)||this.applyBorder(e.left,i.left),t.isNullOrUndefined(e.right)||this.applyBorder(e.right,i.right),t.isNullOrUndefined(e.horizontal)||this.applyBorder(e.horizontal,i.horizontal),t.isNullOrUndefined(e.vertical)||this.applyBorder(e.vertical,i.vertical),t.isNullOrUndefined(e.diagonalUp)||this.applyBorder(e.diagonalUp,i.diagonalUp),t.isNullOrUndefined(e.diagonalDown)||this.applyBorder(e.diagonalDown,i.diagonalDown))},e.prototype.applyShading=function(e,i){t.isNullOrUndefined(i)||t.isNullOrUndefined(e)||(t.isNullOrUndefined(i.backgroundColor)||e.backgroundColor===i.backgroundColor||(e.backgroundColor=i.backgroundColor),t.isNullOrUndefined(i.foregroundColor)||e.foregroundColor===i.foregroundColor||(e.foregroundColor=i.foregroundColor),t.isNullOrUndefined(i.textureStyle)||e.textureStyle===i.textureStyle||(e.textureStyle=i.textureStyle))},e.prototype.applyBorder=function(e,i){t.isNullOrUndefined(e)||t.isNullOrUndefined(i)||(t.isNullOrUndefined(i.color)||e.color===i.color||(e.color=i.color),t.isNullOrUndefined(i.lineStyle)||e.lineStyle===i.lineStyle||(e.lineStyle=i.lineStyle),t.isNullOrUndefined(i.lineWidth)||e.lineWidth===i.lineWidth||(e.lineWidth=i.lineWidth),t.isNullOrUndefined(i.shadow)||e.shadow===i.shadow||(e.shadow=i.shadow),t.isNullOrUndefined(i.space)||e.space===i.space||(e.space=i.space))},e.prototype.onTableFormat=function(e){if(!t.isNullOrUndefined(this.selection.tableFormat)){this.viewer.owner.isShiftingEnabled=!0,this.editorHistory.initializeHistory("TableFormat");var i=this.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);this.applyTableFormat(i,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyTableFormat=function(e,t,i){this.applyTablePropertyValue(this.viewer.selection,void 0,i,e)},e.prototype.applyTablePropertyValue=function(e,i,r,n){var o=n.tableFormat;if(t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(r=this.editorHistory.currentBaseHistoryInfo.addModifiedTableProperties(o,i,r)),r instanceof R)return void(t.isNullOrUndefined(i)&&this.handleTableFormat(o,r));"preferredWidth"===i?o.preferredWidth=r:"leftIndent"===i?o.leftIndent=r:"tableAlignment"===i?o.tableAlignment=r:"cellSpacing"===i?o.cellSpacing=r:"leftMargin"===i?o.leftMargin=r:"rightMargin"===i?o.rightMargin=r:"topMargin"===i?o.topMargin=r:"bottomMargin"===i?o.bottomMargin=r:"preferredWidthType"===i&&(o.preferredWidthType=r),"shading"===i?o.shading=r:"borders"===i&&(o.borders=r)},e.prototype.handleTableFormat=function(e,i){(this.isBordersAndShadingDialog||this.editorHistory.isUndoing||this.editorHistory.isRedoing)&&(t.isNullOrUndefined(e.borders)||this.applyBordersInternal(e.borders,i.borders),t.isNullOrUndefined(e.shading)||this.applyShading(e.shading,i.shading)),this.isBordersAndShadingDialog||(i.hasValue("preferredWidth")&&i.preferredWidth!==e.preferredWidth&&(e.preferredWidth=i.preferredWidth),i.hasValue("preferredWidthType")&&i.preferredWidthType!==e.preferredWidthType&&(e.preferredWidthType=i.preferredWidthType),i.hasValue("tableAlignment")&&i.tableAlignment!==e.tableAlignment&&(e.tableAlignment=i.tableAlignment),i.hasValue("leftIndent")&&i.leftIndent!==e.leftIndent&&(e.leftIndent=i.leftIndent)),this.updateGridForTableDialog(e.ownerBase,!1)},e.prototype.updateGridForTableDialog=function(e,t){e.tableHolder&&(e.updateRowIndex(0),e.calculateGrid(),e.isGridUpdated=!1),this.viewer.layout.reLayoutTable(e)},e.prototype.onRowFormat=function(e){if(!t.isNullOrUndefined(this.selection)&&!t.isNullOrUndefined(e)){this.editorHistory.initializeHistory("RowFormat"),this.viewer.owner.isShiftingEnabled=!0;var i=this.selection.isForward?this.selection.start:this.selection.end,r=this.selection.isForward?this.selection.end:this.selection.start;i.paragraph.associatedCell.ownerTable.combineWidget(this.viewer);this.applyRowFormat(i.paragraph.associatedCell.ownerRow,i,r,void 0,e),this.reLayout(this.selection,!1)}},e.prototype.applyRowFormat=function(e,i,r,n,o){if(this.applyRowPropertyValue(this.viewer.selection,n,o,e),r.paragraph.associatedCell.ownerRow!==e){var a=e.nextWidget;t.isNullOrUndefined(a)||this.applyRowFormat(a,i,r,n,o)}},e.prototype.applyRowPropertyValue=function(e,i,r,n){var o=n.rowFormat;if(t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(r=this.editorHistory.currentBaseHistoryInfo.addModifiedRowProperties(o,i,r)),r instanceof M)return void(t.isNullOrUndefined(i)&&this.handleRowFormat(r,o));"heightType"===i?o.heightType=r:"height"===i?o.height=r:"isHeader"===i?o.isHeader=r:"allowBreakAcrossPages"===i&&(o.allowBreakAcrossPages=r),t.isNullOrUndefined(n.ownerTable)||this.layoutItemBlock(n.ownerTable,!0)},e.prototype.handleRowFormat=function(e,t){e.hasValue("allowBreakAcrossPages")&&e.allowBreakAcrossPages!==t.allowBreakAcrossPages&&(t.allowBreakAcrossPages=e.allowBreakAcrossPages),e.hasValue("isHeader")&&e.isHeader!==t.isHeader&&(t.isHeader=e.isHeader),e.hasValue("heightType")&&e.heightType!==t.heightType&&(t.heightType=e.heightType),e.hasValue("height")&&e.height!==t.height&&(t.height=e.height),this.updateGridForTableDialog(t.ownerBase.ownerTable,!0)},e.prototype.onCellFormat=function(e){t.isNullOrUndefined(this.selection)||t.isNullOrUndefined(e)||(this.editorHistory.initializeHistory("CellFormat"),this.updateFormatForCell(this.selection,void 0,e),this.reLayout(this.selection,!1))},e.prototype.updateCellMargins=function(e,t){var i=e.start,r=e.end;e.isForward||(i=e.end,r=e.start),this.initHistoryPosition(e,i),this.viewer.owner.cellOptionsDialogModule.applyCellmarginsValue(i.paragraph.associatedCell.ownerRow,i,r,t)},e.prototype.updateFormatForCell=function(e,t,i){var r=e.start,n=e.end;e.isForward||(r=e.end,n=e.start);for(var o,a=r.paragraph.associatedCell,s=n.paragraph.associatedCell,l=a.ownerTable.combineWidget(this.viewer),d=a.columnIndex;d<=s.columnIndex;d++){o=this.getSelectedCellInColumn(a.ownerTable,a.ownerRow.rowIndex,d,s.ownerRow.rowIndex);for(var h=0;h<o.length;h++)this.applyCellPropertyValue(this.viewer.selection,t,i,o[h].cellFormat)}this.updateGridForTableDialog(l,!1)},e.prototype.getSelectedCellInColumn=function(e,t,i,r){for(var n=[],o=t;o<=r;o++)for(var a=e.childWidgets[o],s=0;s<a.childWidgets.length;s++)a.childWidgets[s].columnIndex===i&&n.push(a.childWidgets[s]);return n},e.prototype.getColumnCells=function(e,t,i){for(var r=[],n=0;n<e.childWidgets.length;n++)for(var o=e.childWidgets[n],a=0;a<o.childWidgets.length;a++){var s=o.childWidgets[a];i?s.columnIndex+s.cellFormat.columnSpan===t&&r.push(s):s.columnIndex===t&&r.push(s)}return r},e.prototype.getTableWidth=function(e){return 0!==e.tableFormat.preferredWidth||"Percent"===e.tableFormat.preferredWidthType?"Auto"===e.tableFormat.preferredWidthType||"Point"===e.tableFormat.preferredWidthType?e.tableFormat.preferredWidth:0===e.tableFormat.preferredWidth?0:W.convertPixelToPoint(this.viewer.clientArea.width)/100*e.tableFormat.preferredWidth:W.convertPixelToPoint(this.viewer.layout.getTableWidth(e))},e.prototype.applyCellPropertyValue=function(e,i,r,n){if(t.isNullOrUndefined(this.editorHistory.currentBaseHistoryInfo)||(r=this.editorHistory.currentBaseHistoryInfo.addModifiedCellProperties(n,i,r)),r instanceof H)return t.isNullOrUndefined(i)&&this.handleCellFormat(r,n),r;"leftMargin"===i?n.leftMargin=r:"topMargin"===i?n.topMargin=r:"rightMargin"===i?n.rightMargin=r:"bottomMargin"===i?n.bottomMargin=r:"preferredWidth"===i?(n.preferredWidth=r,n.cellWidth=r):"cellWidth"===i?n.cellWidth=r:"columnSpan"===i?n.columnSpan=r:"rowSpan"===i?n.rowSpan=r:"preferredWidthType"===i?n.preferredWidthType=r:"verticalAlignment"===i&&(n.verticalAlignment=r),"shading"===i?n.shading=r:"borders"===i&&(n.borders=r)},e.prototype.handleCellFormat=function(e,i){t.isNullOrUndefined(e)||t.isNullOrUndefined(i)||(this.isBordersAndShadingDialog?(t.isNullOrUndefined(e.borders)||this.applyBordersInternal(i.borders,e.borders),t.isNullOrUndefined(e.shading)||this.applyShading(i.shading,e.shading)):(e.hasValue("preferredWidth")&&i.preferredWidth!==e.preferredWidth&&(i.preferredWidth=e.preferredWidth),e.hasValue("preferredWidthType")&&i.preferredWidthType!==e.preferredWidthType&&(i.preferredWidthType=e.preferredWidthType),e.hasValue("verticalAlignment")&&i.verticalAlignment!==e.verticalAlignment&&(i.verticalAlignment=e.verticalAlignment)))},e.prototype.destroy=function(){this.viewer=void 0,this.nodes=[]},e.prototype.isTocField=function(e){if(e instanceof $){var t=e.nextNode;if(e instanceof $&&0===e.fieldType&&t instanceof Q&&0===t.text.trim().toLowerCase().indexOf("toc"))return!0}return!1},e.prototype.updateToc=function(e){if(t.isNullOrUndefined(e)&&(e=this.selection.getTocFieldInternal()),this.isTocField(e)){var i=this.selection.getFieldCode(e);-1!==i.toLocaleLowerCase().indexOf("toc")&&this.insertTableOfContents(this.validateTocSettings(this.getTocSettings(i,e)))}},e.prototype.getTocSettings=function(e,i){var r={};if(r.includePageNumber=!0,r.rightAlign=!0,"toc \\mergeformat"===e.toLowerCase())r.startLevel=1,r.endLevel=3;else for(var n=e.split("\\"),o=0;o<n.length;o++){var a=n[o];if(0!==a.length)switch(a[0]){case"o":if(t.isNullOrUndefined(a.match(/\d+/g)))r.startLevel=1,r.endLevel=9;else{var s=a.match(/\d+/g).map(Number);r.startLevel=s[0],r.endLevel=s[1]}break;case"h":r.includeHyperlink=!0;break;case"n":r.includePageNumber=!1;break;case"p":r.rightAlign=!1;break;case"u":r.includeOutlineLevels=!0;break;case"t":this.decodeTSwitch(r,a)}}var l=i.paragraph.paragraphFormat.getUpdatedTabs();return l.length>0&&(r.tabLeader=l[l.length-1].tabLeader),r.rightAlign&&t.isNullOrUndefined(r.tabLeader)&&(r.tabLeader="Dot"),r},e.prototype.decodeTSwitch=function(e,t){e.levelSettings={};for(var i=(t=(t=(t=(t=t.replace("t","")).replace('"',"")).replace('"',"")).trim()).split(","),r=0;r<i.length;r++)e.levelSettings[i[r]]=parseInt(i[r+1],10),r++},e.prototype.insertTableOfContents=function(e){this.isInsertingTOC=!0,this.initComplexHistory("TOC"),t.isNullOrUndefined(e)&&((e={}).startLevel=1,e.endLevel=3,e.includeHyperlink=!0,e.includeOutlineLevels=!0,e.includePageNumber=!0,e.rightAlign=!0,e.tabLeader="Dot");var i=void 0,r=void 0;"TableOfContents"===this.selection.contextType&&(i=this.selection.getTocFieldInternal()),i instanceof $&&(this.selection.start.setPositionForSelection(i.line,i,0,this.selection.start.location),this.selection.end.setPositionForSelection(i.fieldEnd.line,i.fieldEnd,2,this.selection.end.location),this.onDelete()),r=this.constructTocFieldCode(e);var n=this.selection.start.isAtParagraphStart,o=this.getParagraphInfo(this.selection.start),a=this.getHierarchicalIndex(o.paragraph,o.offset.toString()),s=this.buildToc(this.validateTocSettings(e),r,!0,n);if(s.length>0){var l=new G,d=new J(l);l.childWidgets.push(d);var h=0;n||(h=1);var c=s[h].childWidgets[0].children[0];this.appendEndField(c,d),s.push(l),this.appendEmptyPara(s)}this.setPositionForCurrentIndex(this.selection.start,a),this.selection.end.setPositionInternal(this.selection.start),this.pasteContentsInternal(s),this.isInsertingTOC=!1,this.updatePageRef(),this.editorHistory&&this.editorHistory.updateComplexHistoryInternal()},e.prototype.appendEmptyPara=function(e){var t=new G,i=new J(t);t.childWidgets.push(i),e.push(t)},e.prototype.constructTocFieldCode=function(e){var i="TOC";t.isNullOrUndefined(e.startLevel)||0===e.startLevel||t.isNullOrUndefined(e.endLevel)||0===e.endLevel||(i=i+' \\o "'+e.startLevel+"-"+e.endLevel+'"'),e.includePageNumber&&!e.rightAlign&&(i+=' \\p " "'),e.includePageNumber||(i+=" \\n"),e.includeHyperlink&&(i+=" \\h \\z"),e.includeOutlineLevels&&(i+=" \\u");var r=this.constructTSwitch(e);return r.length>6&&(i+=r),i},e.prototype.constructTSwitch=function(e){var i="";if(!t.isNullOrUndefined(e.levelSettings))for(var r=0,n=Object.keys(e.levelSettings);r<n.length;r++){var o=n[r];i=i+o+","+e.levelSettings[o].toString()+","}return i=i.slice(0,-1),i=' \\t "'+i+'"'},e.prototype.appendEndField=function(e,t){var i=new $(1);i.fieldSeparator=e.fieldSeparator,e.fieldSeparator.fieldEnd=i,i.fieldBegin=e,i.fieldBegin.fieldEnd=i,i.line=t,t.children.push(i)},e.prototype.validateTocSettings=function(e){return(t.isNullOrUndefined(e.startLevel)||e.startLevel<1)&&(e.startLevel=1),(t.isNullOrUndefined(e.endLevel)||e.endLevel<e.endLevel)&&(e.endLevel=e.startLevel>3?e.startLevel:3),t.isNullOrUndefined(e.includeHyperlink)&&(e.includeHyperlink=!1),t.isNullOrUndefined(e.includePageNumber)&&(e.includePageNumber=!1),t.isNullOrUndefined(e.rightAlign)&&(e.rightAlign=!1),t.isNullOrUndefined(e.levelSettings)&&(e.levelSettings={}),e},e.prototype.buildToc=function(e,t,i,r){var n=this.viewer.pages[0].bodyWidgets[0],o=[];this.createHeadingLevels(e),e.includeOutlineLevels&&this.createOutlineLevels(e);for(var a=n.childWidgets[0];void 0!==a;){if(a instanceof G&&(this.isHeadingStyle(a)||e.includeOutlineLevels&&this.isOutlineLevelStyle(a))){var s=this.insertTocBookmark(a);this.createTOCWidgets(a,o,t,s,e,i,r),i=!1}a=this.selection.getNextParagraphBlock(a)}return this.tocStyles={},o},e.prototype.createOutlineLevels=function(e){for(var i=e.startLevel;i<=e.endLevel;i++){var r="Level"+i.toString();t.isNullOrUndefined(this.tocStyles[r])&&(this.tocStyles[r]=i)}},e.prototype.createHeadingLevels=function(e){for(var i=e.startLevel;i<=e.endLevel;i++){var r="Heading "+i.toString();t.isNullOrUndefined(this.tocStyles[r])&&(this.tocStyles[r]=i)}if(!t.isNullOrUndefined(e.levelSettings))for(var n=0,o=Object.keys(e.levelSettings);n<o.length;n++){var a=o[n];this.tocStyles[a]=e.levelSettings[a]}},e.prototype.isHeadingStyle=function(e){var i=e.paragraphFormat.baseStyle;return void 0!==i&&!t.isNullOrUndefined(this.tocStyles[i.name])},e.prototype.isOutlineLevelStyle=function(e){var i=e.paragraphFormat.outlineLevel;return!t.isNullOrUndefined(this.tocStyles[i])},e.prototype.createTocFieldElement=function(e,t){var i=new $(0);i.hasFieldEnd=!0,i.line=e,e.children.push(i);var r=new Q;r.text=t,r.line=e,e.children.push(r);var n=new $(2);return n.fieldBegin=i,n.fieldBegin.fieldSeparator=n,n.line=e,e.children.push(n),i},e.prototype.createTOCWidgets=function(e,i,r,n,o,a,s){var l=void 0,d=void 0,h=void 0;if(1!==i.length||3!==i[0].childWidgets[0].children.length||t.isNullOrUndefined(a)||a){d=new G;var c=void 0,p=e.paragraphFormat.baseStyle.name;c=o.includeOutlineLevels&&t.isNullOrUndefined(this.tocStyles[p])?e.paragraphFormat.outlineLevel:p;var g="Toc"+this.tocStyles[c],u=this.viewer.styles.findByName(g,"Paragraph");if(t.isNullOrUndefined(u)&&(this.viewer.owner.parser.parseStyle(JSON.parse(this.getCompleteStyles()),JSON.parse(this.viewer.preDefinedStyles.get(g)),this.viewer.styles),u=this.viewer.styles.findByName(g,"Paragraph")),d.paragraphFormat.ApplyStyle(u),o.rightAlign&&o.includePageNumber){var f=new C;f.position=W.convertPixelToPoint(this.viewer.clientArea.width),f.tabLeader=o.tabLeader,f.deletePosition=0,f.tabJustification="Right",d.paragraphFormat.tabs.push(f)}h=new J(d),d.childWidgets.push(h)}else h=i[0].childWidgets[0];void 0!==a&&a&&(t.isNullOrUndefined(s)||s||this.appendEmptyPara(i),this.createTocFieldElement(h,r));for(var m="",v=0;v<e.childWidgets.length;v++)for(var y=e.childWidgets[v],w=0;w<y.children.length;w++){var b=y.children[w];if(b instanceof Q||b instanceof ne){var x=b.text;-1!==x.indexOf("\t")&&(x=x.replace(new RegExp("\t","g")," ")),m+=x}}if(""!==m){if(o.includeHyperlink&&void 0!==n)l=this.insertTocHyperlink(h,n,m);else{var F=new Q;F.text=m,F.line=h,h.children.push(F)}if(o.includePageNumber&&void 0!==n){if(o.rightAlign){var P=new te;P.text="\t",P.line=h,h.children.push(P)}var T=this.insertTocPageNumber(n,h,o.rightAlign,e);this.appendEndField(T,h)}o.includeHyperlink&&void 0!==l&&this.appendEndField(l,h)}t.isNullOrUndefined(d)||""===m&&!a||i.push(d)},e.prototype.insertTocHyperlink=function(e,t,i){var r=' HYPERLINK \\l "'+t+'" ',n=this.createTocFieldElement(e,r),o=new Q;return o.text=i,o.line=e,e.children.push(o),n},e.prototype.insertTocPageNumber=function(e,t,i,r){var n=" PAGEREF"+e+" \\h ",o=this.createTocFieldElement(t,n),a=(this.viewer.pages.indexOf(r.bodyWidget.page)+1).toString(),s=new ee;return s.fieldBegin=o,i||(a=" "+a),s.text=a,s.line=t,t.children.push(s),this.pageRefFields[e]=s,o},e.prototype.updatePageRef=function(){for(var e=0,t=Object.keys(this.pageRefFields);e<t.length;e++){var i=t[e],r=(this.viewer.bookmarks.get(i).paragraph.bodyWidget.page.index+1).toString(),n=this.pageRefFields[i];if(r!==n.text){n.text=r;var o=n.paragraph,a=o.childWidgets.indexOf(n.line),s=n.line.children.indexOf(n);this.viewer.layout.reLayoutParagraph(o,a,s)}}},e.prototype.insertTocBookmark=function(e){var i=void 0,r=e.childWidgets.length;if(r>0){var n=e.childWidgets[0],o=e.childWidgets[r-1];if(void 0!==n&&void 0!==o){var a=n.children[0];if(!t.isNullOrUndefined(a)&&a instanceof ie&&0===a.bookmarkType&&a.name.toLowerCase().match("^_toc"))return a.name;var s=o.children[o.children.length-1];void 0!==a&&void 0!==s&&(this.selection.start.setPositionForSelection(n,a,0,this.selection.start.location),this.selection.end.setPositionForSelection(o,s,s.length,this.selection.end.location),i=this.generateBookmarkName(),this.insertBookmark(i))}}return i},e.prototype.generateBookmarkName=function(){for(var e=10-(++this.tocBookmarkId).toString().length,t="";e-1>0;)t="0"+t,e--;return"_Toc"+t+this.tocBookmarkId},e.prototype.onCellContentAlignment=function(e,i){this.owner.isShiftingEnabled=!0;var r=this.owner.selection;if(r.isEmpty&&r.start.paragraph.isInsideTable){this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(r,"MultiSelection"),r.selectTableCell(),this.initHistory("CellContentVerticalAlignment");var n=r.start.paragraph.associatedCell.cellFormat;this.applyCellPropertyValue(r,"verticalAlignment",e,n),this.reLayout(r,!1),this.initHistory("TextAlignment"),this.updateParagraphFormat("textAlignment",i,!1),this.reLayout(this.owner.selection,!1),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()}else this.owner.editorHistory&&this.owner.editorHistory.initComplexHistory(r,"MultiSelection"),t.isNullOrUndefined(r.getTable(r.start,r.end))||(this.updateSelectionTableFormat(r,"CellContentVerticalAlignment",e),this.reLayout(this.owner.selection,!1),this.initHistory("TextAlignment"),this.updateSelectionParagraphFormatting("textAlignment",i,!1),this.reLayout(r,!1)),this.owner.editorHistory&&this.owner.editorHistory.updateComplexHistory()},e}(),ze=function(){function e(e,t){this.ownerListLevelIn=void 0,this.modifiedListLevelIn=void 0,this.ownerListLevel=e,this.modifiedListLevel=t}return Object.defineProperty(e.prototype,"ownerListLevel",{get:function(){return this.ownerListLevelIn},set:function(e){this.ownerListLevelIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedListLevel",{get:function(){return this.modifiedListLevelIn},set:function(e){this.modifiedListLevelIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerListLevel=void 0,this.modifiedListLevel=void 0},e}(),_e=function(){function e(e,t){this.ownerFormatIn=void 0,this.modifiedFormatIn=void 0,this.ownerFormat=e,this.modifiedFormat=t}return Object.defineProperty(e.prototype,"ownerFormat",{get:function(){return this.ownerFormatIn},set:function(e){this.ownerFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedFormat",{get:function(){return this.modifiedFormatIn},set:function(e){this.modifiedFormatIn=e},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.ownerFormat=void 0,this.modifiedFormat.destroy(),this.modifiedFormat=void 0},e}(),Ve=function(){function e(e,t){this.startingPoint=e,this.rowFormat=t,this.rowHeightType=t.heightType}return e.prototype.revertChanges=function(e,t){var i=this.rowFormat.heightType;t.editorModule.tableResize.updateRowHeight(this.rowFormat.ownerBase,e?this.displacement:-this.displacement),t.viewer.layout.reLayoutTable(this.rowFormat.ownerBase.ownerTable),this.rowFormat.heightType!==this.rowHeightType&&(this.rowFormat.heightType=this.rowHeightType),this.rowHeightType=i},e}(),qe=function(){function e(e,t){this.tableHolder=new ae,this.tableFormat=new je,this.rows=[],this.owner=t,this.copyProperties(e)}return e.prototype.copyProperties=function(e){e.tableHolder&&(this.tableHolder=e.tableHolder.clone()),e.tableFormat&&(this.tableFormat.leftIndent=e.tableFormat.leftIndent,this.tableFormat.preferredWidth=e.tableFormat.preferredWidth,this.tableFormat.preferredWidthType=e.tableFormat.preferredWidthType);for(var t=0;t<e.childWidgets.length;t++){var i=e.childWidgets[t],r=new Ge;r.gridBefore=i.rowFormat.gridBefore,r.gridBeforeWidth=i.rowFormat.gridBeforeWidth,r.gridBeforeWidthType=i.rowFormat.gridBeforeWidthType,r.gridAfter=i.rowFormat.gridAfter,r.gridAfterWidth=i.rowFormat.gridAfterWidth,r.gridAfterWidthType=i.rowFormat.gridAfterWidthType;for(var n=0;n<i.childWidgets.length;n++){var o=i.childWidgets[n],a=new Ke;a.columnIndex=o.columnIndex,a.columnSpan=o.cellFormat.columnSpan,a.preferredWidth=o.cellFormat.preferredWidth,a.preferredWidthType=o.cellFormat.preferredWidthType,r.cells.push(a)}this.rows.push(r)}this.tableHierarchicalIndex=this.owner.editorModule.getHierarchicalIndex(e,"0")},e.prototype.destroy=function(){this.tableHierarchicalIndex=void 0,this.tableHolder&&(this.tableHolder.destroy(),this.tableHolder=void 0),this.tableFormat&&(this.tableFormat=null),this.rows&&(this.rows=[],this.rows=void 0)},e}(),je=function(){function e(){}return e}(),Ge=function(){function e(){this.cells=[]}return e}(),Ke=function(){function e(){}return e}(),Xe=function(){function e(e){this.startingPoint=e}return e}(),Ye=function(){function e(e){this.ownerIn=e,this.viewer=e.viewer,this.modifiedPropertiesIn=[],this.modifiedNodeLength=[],this.removedNodesIn=[]}return Object.defineProperty(e.prototype,"owner",{get:function(){return this.ownerIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editorHistory",{get:function(){return this.owner.editorHistory},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this.actionIn},set:function(e){this.actionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"modifiedProperties",{get:function(){return this.modifiedPropertiesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"removedNodes",{get:function(){return this.removedNodesIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionStart",{get:function(){return this.selectionStartIn},set:function(e){this.selectionStartIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectionEnd",{get:function(){return this.selectionEndIn},set:function(e){this.selectionEndIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"insertPosition",{get:function(){return this.insertPositionIn},set:function(e){this.insertPositionIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endPosition",{get:function(){return this.endPositionIn},set:function(e){this.endPositionIn=e},enumerable:!0,configurable:!0}),e.prototype.updateSelection=function(){var e=this.owner.editorModule.getParagraphInfo(this.owner.selection.start);this.selectionStart=this.owner.editorModule.getHierarchicalIndex(e.paragraph,e.offset.toString()),e=this.owner.editorModule.getParagraphInfo(this.owner.selection.end),this.selectionEnd=this.owner.editorModule.getHierarchicalIndex(e.paragraph,e.offset.toString())},e.prototype.setBookmarkInfo=function(e){this.removedNodes.push({bookmark:e,startIndex:e.indexInOwner,endIndex:e.reference.indexInOwner})},e.prototype.revertBookmark=function(){var e=this.removedNodes[0],t=e.bookmark;this.editorHistory.isUndoing?(this.viewer.bookmarks.add(t.name,t),t.line.children.splice(e.startIndex,0,t),t.reference.line.children.splice(e.endIndex,0,t.reference),this.editorHistory.recordChanges(this)):(this.owner.editorModule.deleteBookmarkInternal(t),this.editorHistory.undoStack.push(this))},e.prototype.revert=function(){if("DeleteBookmark"===this.action)return void this.revertBookmark();this.owner.isShiftingEnabled=!0;var e=void 0,i=void 0,r=this.selectionStart,n=this.selectionEnd,o=Ie.isForwardSelection(r,n);if(this.modifiedProperties.length>0||"Selection"===this.action||"ClearCharacterFormat"===this.action||"ClearParagraphFormat"===this.action)e=this.getTextPosition(r),i=this.getTextPosition(n),this.revertModifiedProperties(e,i);else{var a=this.removedNodes;this.removedNodesIn=[];var s=Ie.isForwardSelection(this.insertPosition,this.endPosition),l=this.getTextPosition(s?this.insertPosition:this.endPosition),d=this.getTextPosition(s?this.endPosition:this.insertPosition);if(l.isAtSamePosition(d)?this.owner.selection.selectContent(l,!0):this.owner.selection.selectPosition(l,d),"InsertHyperlink"===this.action&&this.editorHistory.isRedoing){var h=this.owner.selection.getHyperlinkField();if(!t.isNullOrUndefined(h)){var c=h.line.getOffset(h,0);l.setPositionParagraph(h.line,c),this.owner.selection.start.setPositionInternal(l),c=h.fieldEnd.line.getOffset(h.fieldEnd,1),d.setPositionParagraph(h.fieldEnd.line,c)}}this.editorHistory.currentBaseHistoryInfo=this,this.selectionStart=this.insertPosition,this.insertPosition=void 0,this.selectionEnd=this.endPosition,this.endPosition=void 0;var p=!1;l.isAtSamePosition(d)||(p="BackSpace"===this.action||"Delete"===this.action||"ClearCells"===this.action||"DeleteCells"===this.action)||"MergeCells"===this.action||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action||"DeleteTable"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||(this.owner.selection.end.setPositionInternal(d),this.owner.selection.isEmpty||(this.editorHistory.isRedoing?this.owner.editorModule.removeSelectedContents(this.owner.selection):this.owner.editorModule.deleteSelectedContents(this.owner.selection,!0),!t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action&&this.viewer.blockToShift&&this.viewer.layout.shiftLayoutedItems()));var g=this.editorHistory.isRedoing&&!p;this.revertModifiedNodes(a,g,o?r:n,r===n),p&&this.removeContent(l,d)}var u=!1;(this.editorHistory.isUndoing&&t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)||("InsertRowAbove"===this.action||"Borders"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"InsertColumnRight"===this.action)&&(this.editorHistory.isRedoing||"Paste"===this.editorHistory.currentHistoryInfo.action))&&(e=this.getTextPosition(r),i=this.getTextPosition(n),this.owner.selection.selectRange(e,i),u=!0),this.insertPosition=r,this.endPosition=n,this.owner.editorModule.reLayout(this.owner.selection,this.owner.selection.isEmpty),u&&this.viewer.scrollToPosition(this.owner.selection.start,this.owner.selection.end),this.highlightListText()},e.prototype.highlightListText=function(){if(!t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&("ListCharacterFormat"===this.action||"ListSelect"===this.editorHistory.currentHistoryInfo.action&&"ListFormat"===this.action)){var e=this.getTextPosition(this.selectionStart).currentWidget;this.viewer.selection.highlightListText(e)}},e.prototype.removeContent=function(e,i){if(!t.isNullOrUndefined(e.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof V&&!t.isNullOrUndefined(i.paragraph.containerWidget)&&i.paragraph.containerWidget instanceof V||!t.isNullOrUndefined(e.paragraph.containerWidget)&&!t.isNullOrUndefined(i.paragraph.containerWidget)&&e.paragraph.containerWidget instanceof Y&&i.paragraph.containerWidget instanceof Y&&!t.isNullOrUndefined(e.paragraph.bodyWidget)){this.owner.selection.selectRange(e,i);var r="BackSpace"===this.action;this.owner.editorModule.deleteSelectedContents(this.owner.selection,r)}},e.prototype.revertModifiedProperties=function(e,t){"CellFormat"!==this.action&&"CellOptions"!==this.action&&"TableOptions"!==this.action||(this.owner.isShiftingEnabled=!1),this.owner.selection.selectRange(e,t),"RowResizing"===this.action||"CellResizing"===this.action?this.revertResizing():"CellOptions"===this.action||"TableOptions"===this.action?this.revertTableDialogProperties(this.action):"Selection"!==this.action&&this.revertProperties()},e.prototype.redoAction=function(){var e=this.owner.editorModule;switch(this.action){case"BackSpace":e.singleBackspace(this.owner.selection,!0);break;case"Delete":e.singleDelete(this.owner.selection,!0);break;case"DeleteTable":e.deleteTable();break;case"DeleteColumn":e.deleteColumn();break;case"DeleteRow":e.deleteRow();break;case"MergeCells":e.mergeSelectedCellsInTable();break;case"InsertRowAbove":e.insertRow(!0);break;case"InsertRowBelow":e.insertRow(!1);break;case"InsertColumnLeft":case"InsertColumnRight":e.insertColumn(!0);break;case"SectionBreak":e.insertSection(this.owner.selection,!0)}},e.prototype.revertModifiedNodes=function(e,i,r,n){if((!i||"BackSpace"!==this.action&&"Delete"!==this.action&&"DeleteTable"!==this.action&&"DeleteColumn"!==this.action&&"DeleteRow"!==this.action&&"InsertRowAbove"!==this.action&&"InsertRowBelow"!==this.action&&"InsertColumnLeft"!==this.action&&"InsertColumnRight"!==this.action&&"MergeCells"!==this.action&&"SectionBreak"!==this.action||(this.redoAction(),"SectionBreak"!==this.action))&&e.length>0)if(this.editorHistory.isUndoing&&("DeleteCells"===this.action||"DeleteColumn"===this.action||"DeleteRow"===this.action||"MergeCells"===this.action)||"InsertRowAbove"===this.action||"InsertRowBelow"===this.action||"InsertColumnLeft"===this.action||"ClearCells"===this.action||"InsertColumnRight"===this.action||"Borders"===this.action){var o=this.selectionStart,a=this.owner.editorModule.getBlock({index:o}).node,s=e[e.length-1];(a instanceof K||a.previousRenderedWidget instanceof K||a.isInsideTable)&&s instanceof K?(a instanceof G&&!a.isInsideTable&&(a=a.previousRenderedWidget),a=a.combineWidget(this.viewer),this.owner.editorModule.insertTableInternal(a,s,!1),e.splice(e.indexOf(s),1)):s instanceof K&&this.owner.editorModule.insertBlock(s)}else{var l=r,a=this.owner.editorModule.getBlock({index:l}).node;if(e.length>0&&("BackSpace"===this.action&&n||!(a instanceof K)&&!(a instanceof q))){s=e[0];if(("SectionBreak"===this.action&&s instanceof V||!t.isNullOrUndefined(this.editorHistory.currentHistoryInfo)&&"PageBreak"===this.editorHistory.currentHistoryInfo.action)&&(s=e[1]),s instanceof G&&this.owner.selection.start.offset>0&&(this.owner.editorModule.insertNewParagraphWidget(s,!0),e.splice(e.indexOf(s),1),t.isNullOrUndefined(a))){h=this.viewer.selection.getNextParagraphBlock(s.getSplitWidgets().pop());this.owner.selection.getNextRenderedBlock(s),t.isNullOrUndefined(h)&&this.owner.selection.selectParagraph(s,!0)}if(s instanceof K&&this.owner.selection.start.offset>0){var d=e[e.length-1];if(d instanceof G&&(this.owner.editorModule.insertNewParagraphWidget(d,!0),e.splice(e.indexOf(d),1),t.isNullOrUndefined(a))){var h=this.viewer.selection.getNextParagraphBlock(d.getSplitWidgets().pop());t.isNullOrUndefined(h)&&this.owner.selection.selectParagraph(d,!0)}}}if(e.length>0){var c=e[e.length-1];if(a instanceof K&&(a=a.combineWidget(this.viewer),c instanceof K)){this.owner.editorModule.insertTableInternal(a,c,!0),e.splice(e.indexOf(c),1),this.insertPosition=r;var p=c.getSplitWidgets().pop();p.nextRenderedWidget instanceof K?a=p.nextRenderedWidget:(l=r,a=this.owner.editorModule.getBlock({index:l}).node)}if(c instanceof G&&this.owner.selection.start.offset>0&&this.owner.selection.start.offset===this.owner.selection.getLineLength(this.owner.selection.start.paragraph.lastChild)){var g=this.owner.editorModule;g.insertNewParagraphWidget(c,!1),e.splice(e.indexOf(c),1),"Paste"!==this.action&&g.removeBlock(this.owner.selection.start.paragraph);var u=this.viewer.selection.getNextParagraphBlock(c.getSplitWidgets().pop());t.isNullOrUndefined(u)||this.owner.selection.selectParagraph(u,!0)}else if(e[0]instanceof K&&1!==e.length){var f=e[1];f instanceof G&&f.isEmpty()&&e.splice(e.indexOf(f),1)}}e.length>0&&(a instanceof K&&(a=a.combineWidget(this.viewer)),this.insertRemovedNodes(e,a))}},e.prototype.insertRemovedNodes=function(e,t){for(var i=e.length-1;i>-1;i--){var r=e[i];r instanceof Z?this.owner.editorModule.insertInlineInSelection(this.owner.selection,r):r instanceof j?r instanceof X?t instanceof K&&(t.childWidgets.splice(0,0,r),this.owner.editorModule.updateNextBlocksIndex(r,!0),0!==i&&e[i-1]instanceof X||this.viewer.layout.layoutBodyWidgetCollection(t.index,t.containerWidget,t,!1)):t instanceof K?this.owner.editorModule.insertBlockTable(this.owner.selection,r,t):this.owner.editorModule.insertBlock(r):r instanceof V&&this.owner.editorModule.insertSection(this.owner.selection,!1)}e=[]},e.prototype.revertResizing=function(){if(this.editorHistory.currentBaseHistoryInfo=this,"RowResizing"===this.action)this.modifiedProperties[0]instanceof Ve&&this.modifiedProperties[0].revertChanges(this.editorHistory.isRedoing,this.owner);else if(this.modifiedProperties[0]instanceof qe){0===this.owner.selection.selectedWidgets.length&&this.owner.selection.highlightSelection(!0);var e=this.modifiedProperties[0],t=e.tableHierarchicalIndex,i=this.owner.editorModule.getBlock({index:t}).node;if(i instanceof K){var r=this.owner.editorModule.tableResize;if(this.owner.editor.setOffsetValue(this.owner.selection),i=i.combineWidget(this.owner.viewer),r.currentResizingTable=i,this.modifiedProperties.splice(0,1),this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=new qe(i,this.owner);this.modifiedProperties.splice(0,0,n),this.owner.isLayoutEnabled=!1,r.applyProperties(r.currentResizingTable,e),r.currentResizingTable.isGridUpdated=!0,this.owner.isLayoutEnabled=!0,r.updateGridValue(r.currentResizingTable,!1),e.destroy(),e=void 0}}}},e.prototype.revertTableDialogProperties=function(e){if(this.owner.isShiftingEnabled=!1,this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0,"CellOptions"===e){var t=this.owner.selection,i=this.modifiedProperties[0];this.owner.editorModule.updateCellMargins(t,i)}else"TableOptions"===e&&this.owner.tableOptionsDialogModule.applyTableOptionsHelper(this.modifiedProperties[0]);this.currentPropertyIndex=0,this.owner.isShiftingEnabled=!0},e.prototype.getTextPosition=function(e){var t=new Ie(this.owner),i=this.owner.editorModule.getParagraph({index:e}),r=this.owner.editorModule.getLineInfo(i.paragraph,i.offset);return t.setPositionForLineWidget(r.line,r.offset),t},e.prototype.addModifiedPropertiesForSection=function(e,i,r){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.modifiedProperties,o=this.currentPropertyIndex<n.length?n[this.currentPropertyIndex]:n[n.length-1];t.isNullOrUndefined(i)?(r=o,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()):(r=o.getPropertyValue(i),o.copyFormat(e)),this.currentPropertyIndex++}else if(t.isNullOrUndefined(i))this.modifiedProperties.push(e.cloneFormat());else{var a=new y;a.copyFormat(e),this.modifiedProperties.push(a)}return r},e.prototype.addModifiedProperties=function(e,i,r){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],o=!1;if(e.ownerBase instanceof Z){var a=this.modifiedNodeLength[this.currentPropertyIndex];if(e.ownerBase.length<a){o=!0,this.modifiedNodeLength[this.currentPropertyIndex]=e.ownerBase.length,this.modifiedNodeLength.splice(this.currentPropertyIndex+1,0,a-e.ownerBase.length);var s=new P(void 0);s.copyFormat(n),this.modifiedProperties.splice(this.currentPropertyIndex+1,0,s)}}"ClearCharacterFormat"===this.action?this.editorHistory.isUndoing?(r=n,o||(this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--)):this.modifiedProperties.push(e.cloneFormat()):(r=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat()),this.currentPropertyIndex++}else{if(t.isNullOrUndefined(i))this.modifiedProperties.push(e.cloneFormat());else{var l=new P(void 0);l.copyFormat(e),this.modifiedProperties.push(l)}e.ownerBase instanceof Z?this.modifiedNodeLength.push(e.ownerBase.length):this.modifiedNodeLength.push(0)}return r},e.prototype.addModifiedPropertiesForParagraphFormat=function(e,i,r){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if("ClearParagraphFormat"===this.action)return this.editorHistory.isUndoing?(r=n,this.modifiedProperties.splice(this.currentPropertyIndex,1),this.currentPropertyIndex--):this.modifiedProperties.push(e.cloneFormat()),this.currentPropertyIndex++,r;if(t.isNullOrUndefined(i))return r=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,r;if("listFormat"===i)return(r=new F(void 0)).copyFormat(n),n.listFormat=new x,n.listFormat.copyFormat(e.listFormat),this.currentPropertyIndex++,r;if("styleName"===i)return t.isNullOrUndefined(n.baseStyle)?void 0:((r=new N).copyStyle(n.baseStyle),this.currentPropertyIndex++,r);r=n.getPropertyValue(i),n.copyFormat(e),this.currentPropertyIndex++}else if(t.isNullOrUndefined(i))this.modifiedProperties.push(e.cloneFormat());else{var o=new F(void 0);o.copyFormat(e),this.modifiedProperties.push(o)}return r},e.prototype.addModifiedPropertiesForContinueNumbering=function(e,t){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing)return t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,t;var i=new F;return i.copyFormat(e),this.modifiedProperties.push(i),t},e.prototype.addModifiedPropertiesForRestartNumbering=function(e,t){return this.editorHistory.isUndoing||this.editorHistory.isRedoing?(t=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.listId:this.modifiedProperties[this.modifiedProperties.length-1]=e.listId,this.currentPropertyIndex++,t):(this.modifiedProperties.push(e.listId),t)},e.prototype.addModifiedPropertiesForList=function(e){var t;if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];t=i,i=new ze(e,this.owner.editorModule.cloneListLevel(e)),this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=i:this.modifiedProperties[this.modifiedProperties.length-1]=i,this.currentPropertyIndex++}else this.modifiedProperties.push(new ze(e,this.owner.editorModule.cloneListLevel(e))),t=e;return t},e.prototype.revertProperties=function(){this.editorHistory.currentBaseHistoryInfo=this,this.currentPropertyIndex=0;var e=this.getProperty();if(this.viewer.owner.editorModule.setOffsetValue(this.viewer.selection),"ClearCharacterFormat"===this.action||this.modifiedProperties[0]instanceof P){if("ListCharacterFormat"===this.action)return void this.owner.editorModule.updateListCharacterFormat(this.viewer.selection,e,void 0);this.owner.editorModule.updateSelectionCharacterFormatting(e,void 0,!1)}else if("ClearParagraphFormat"===this.action||this.modifiedProperties[0]instanceof F){if("ContinueNumbering"===this.action)return void this.owner.editorModule.revertContinueNumbering(this.owner.selection,this.modifiedProperties[0]);if("StyleName"===this.action&&this.modifiedProperties[0]instanceof F)return void this.owner.editorModule.updateSelectionParagraphFormatting(e,this.modifiedProperties[0].baseStyle,!1);this.owner.editorModule.updateSelectionParagraphFormatting(e,void 0,!1)}else if(this.modifiedProperties[0]instanceof y)this.owner.editorModule.updateSectionFormat(e,void 0);else{if("RestartNumbering"===this.action)return void this.owner.editorModule.restartListAtInternal(this.owner.selection,this.modifiedProperties[0]);if(this.modifiedProperties[0]instanceof Oe)this.owner.selection.updateImageSize(this.modifiedProperties[0]);else if(this.modifiedProperties[0]instanceof ze){for(var t=new c,i=0;i<this.modifiedProperties.length;i++){var r=this.modifiedProperties[i];t.add(i,r)}this.editorHistory.updateListChanges(t),t.destroy(),t=void 0}else this.modifiedProperties[0]instanceof R?this.owner.editorModule.updateTableFormat(this.owner.selection,e,void 0):this.modifiedProperties[0]instanceof H?(this.owner.isShiftingEnabled=!0,this.owner.editorModule.updateCellFormat(this.owner.selection,e,void 0)):this.modifiedProperties[0]instanceof M&&this.owner.editorModule.updateRowFormat(this.owner.selection,e,void 0)}this.currentPropertyIndex=0,"ClearCharacterFormat"!==this.action&&"ClearParagraphFormat"!==this.action||this.owner.editorModule.getOffsetValue(this.viewer.selection)},e.prototype.addModifiedCellOptions=function(e,i,r){var n;return n=t.isNullOrUndefined(e.bottomMargin)&&t.isNullOrUndefined(e.topMargin)&&t.isNullOrUndefined(e.rightMargin)&&t.isNullOrUndefined(e.leftMargin)?this.copyCellOptions(r.tableFormat):this.copyCellOptions(e),this.editorHistory.isUndoing||this.editorHistory.isRedoing?(i=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1],this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=this.copyCellOptions(e):this.modifiedProperties[this.modifiedProperties.length-1]=this.copyCellOptions(e),this.currentPropertyIndex++,i):(this.modifiedProperties.push(n),i)},e.prototype.copyCellOptions=function(e){var t=new H;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t},e.prototype.addModifiedTableOptions=function(e){var t=this.copyTableOptions(e);if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties.splice(this.currentPropertyIndex,1,t):this.modifiedProperties.splice(this.modifiedProperties.length-1,1,t),this.currentPropertyIndex++}else this.modifiedProperties.push(t)},e.prototype.copyTableOptions=function(e){var t=new R;return t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.bottomMargin=e.bottomMargin,t.leftMargin=e.leftMargin,t.cellSpacing=e.cellSpacing,t},e.prototype.getProperty=function(){switch(this.action){case"Bold":return"bold";case"Italic":return"italic";case"FontColor":return"fontColor";case"FontFamily":return"fontFamily";case"FontSize":return"fontSize";case"HighlightColor":return"highlightColor";case"BaselineAlignment":return"baselineAlignment";case"Strikethrough":return"strikethrough";case"Underline":return"underline";case"AfterSpacing":return"afterSpacing";case"BeforeSpacing":return"beforeSpacing";case"LeftIndent":return"leftIndent";case"RightIndent":return"rightIndent";case"FirstLineIndent":return"firstLineIndent";case"LineSpacingType":return"lineSpacingType";case"LineSpacing":return"lineSpacing";case"TextAlignment":return"textAlignment";case"ListFormat":return"listFormat";case"PageHeight":return"pageHeight";case"PageWidth":return"pageWidth";case"TableAlignment":return"tableAlignment";case"TableLeftIndent":return"leftIndent";case"DefaultCellSpacing":return"cellSpacing";case"LeftMargin":case"CellLeftMargin":case"DefaultCellLeftMargin":return"leftMargin";case"RightMargin":case"CellRightMargin":case"DefaultCellRightMargin":return"rightMargin";case"TopMargin":case"CellTopMargin":case"DefaultCellTopMargin":return"topMargin";case"BottomMargin":case"CellBottomMargin":case"DefaultCellBottomMargin":return"bottomMargin";case"CellContentVerticalAlignment":return"verticalAlignment";case"RowHeight":return"height";case"RowHeightType":return"heightType";case"RowHeader":return"isHeader";case"AllowBreakAcrossPages":return"allowBreakAcrossPages";case"TablePreferredWidth":case"CellPreferredWidth":return"preferredWidth";case"TablePreferredWidthType":case"CellPreferredWidthType":return"preferredWidthType";case"Shading":return"shading";case"StyleName":return"styleName"}},e.prototype.getCharacterPropertyValue=function(e,t){var i;return"bold"===e?i=t.bold:"italic"===e?i=t.italic:"fontColor"===e?i=t.fontColor:"fontFamily"===e?i=t.fontFamily:"fontSize"===e?i=t.fontSize:"highlightColor"===e?i=t.highlightColor:"baselineAlignment"===e?i=t.baselineAlignment:"strikethrough"===e?i=t.strikethrough:"underline"===e&&(i=t.underline),i},e.prototype.addModifiedTableProperties=function(e,i,r){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(t.isNullOrUndefined(i))return r=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,r;r="shading"===i?n.shading:n.getPropertyValue(i),n.copyFormat(e),this.currentPropertyIndex++}else{var o=new R;o.copyFormat(e),this.modifiedProperties.push(o)}return r},e.prototype.addModifiedRowProperties=function(e,i,r){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(t.isNullOrUndefined(i))return r=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,r;r=n.getPropertyValue(i),n.copyFormat(e),this.currentPropertyIndex++}else{var o=new M;o.copyFormat(e),this.modifiedProperties.push(o)}return r},e.prototype.addModifiedCellProperties=function(e,i,r){if(this.editorHistory.isUndoing||this.editorHistory.isRedoing){var n=this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]:this.modifiedProperties[this.modifiedProperties.length-1];if(t.isNullOrUndefined(i))return r=n,this.currentPropertyIndex<this.modifiedProperties.length?this.modifiedProperties[this.currentPropertyIndex]=e.cloneFormat():this.modifiedProperties[this.modifiedProperties.length-1]=e.cloneFormat(),this.currentPropertyIndex++,r;r="shading"===i?n.shading:n.getPropertyValue(i),n.copyFormat(e),this.currentPropertyIndex++}else{var o=new H;o.copyFormat(e),this.modifiedProperties.push(o)}return r},e.prototype.destroy=function(){if(this.selectionStart=void 0,this.selectionEnd=void 0,this.insertPosition=void 0,this.endPosition=void 0,t.isNullOrUndefined(this.modifiedNodeLength)||(this.modifiedNodeLength=[],this.modifiedNodeLength=void 0),!t.isNullOrUndefined(this.modifiedProperties)){for(i=0;i<this.modifiedProperties.length;i++){var e=this.modifiedProperties[i];e instanceof P?e.destroy():e instanceof F?e.destroy():e instanceof y?e.destroy():e instanceof ze&&e.destroy(),this.modifiedProperties.splice(this.modifiedProperties.indexOf(e),1),i--}this.modifiedPropertiesIn=void 0}if(!t.isNullOrUndefined(this.removedNodes)){for(var i=0;i<this.removedNodes.length;i++){var r=this.removedNodes[i];r instanceof G?r.destroyInternal(this.viewer):r instanceof Z&&r.destroy(),this.removedNodes.splice(this.removedNodes.indexOf(r),1),i--}this.removedNodesIn=void 0}this.ownerIn=void 0},e}(),Je=function(){function e(e,i){this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.topLeftRectParent=void 0,this.topMiddleRectParent=void 0,this.topRightRectParent=void 0,this.bottomLeftRectParent=void 0,this.bottomMiddleRectParent=void 0,this.bottomRightRectParent=void 0,this.leftMiddleRectParent=void 0,this.rightMiddleRectParent=void 0,this.resizeMarkSizeIn=7,this.selectedImageWidget=void 0,this.baseHistoryInfo=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.isImageMoveToNextPage=!1,this.selectedResizeElement=void 0,this.topValue=void 0,this.leftValue=void 0,this.owner=e,this.selectedImageWidget=new c,this.viewer=i,this.imageResizerPoints=new Ze,t.isNullOrUndefined(this.imageResizerDiv)&&this.viewer&&this.viewer.pageContainer&&this.initializeImageResizer()}return Object.defineProperty(e.prototype,"currentImageElementBox",{get:function(){return this.currentImageElementBoxIn},set:function(e){this.currentImageElementBoxIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resizeMarkSize",{get:function(){return this.resizeMarkSizeIn},set:function(e){this.resizeMarkSizeIn=e},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ImageResizer"},e.prototype.setImageResizerPositions=function(e,t,i,r){this.imageResizerDivElement.style.top=t.toString()+"px",this.imageResizerDivElement.style.left=e.toString()+"px",this.imageResizerDivElement.style.borderWidth="0px",this.imageResizerDivElement.style.height=r+"px",this.imageResizerDivElement.style.width=i+"px",this.imageResizerDivElement.style.backgroundColor="transparent",this.imageResizerDivElement.style.overflow="hidden",this.imageResizerDivElement.style.position="absolute"},e.prototype.initializeImageResizer=function(){this.imageResizerDivElement=document.createElement("div"),this.imageResizerDivElement.style.zIndex="1",this.imageResizerDivElement.style.display="none",this.viewer.pageContainer.appendChild(this.imageResizerDivElement)},e.prototype.positionImageResizer=function(e){this.selectedImageWidget.clear();var i;t.isNullOrUndefined(this.viewer.currentPage)||(i=this.imageResizerDivElement),t.isNullOrUndefined(i)||i.contains(this.imageResizerDiv)||(this.imageResizerDiv=this.initResizeMarks(i,this)),this.imageResizerDiv.style.width=e.width+"px",this.imageResizerDiv.style.height=e.height+"px",this.currentImageElementBox=e;var r=e.line,n=this.viewer.selection.getTop(r)+e.margin.top,o=this.viewer.selection.getLeftInternal(r,e,0),a=this.viewer.selection.getPage(r.paragraph);this.currentPage=a;var s=0;t.isNullOrUndefined(i)||(this.imageResizerDivElement.style.display="block",i.style.width=a.boundingRectangle.width+"px",i.style.height=a.boundingRectangle.height+"px",i.style.left=a.boundingRectangle.x+"px",i.style.top=a.boundingRectangle.y+"px",i.style.borderWidth="0px",i.style.backgroundColor="transparent",i.style.overflow="hidden",i.style.position="absolute");var l=0,d=this.viewer.getPageWidth(a);this.viewer;l=parseFloat(this.imageResizerDivElement.style.width),(s=(this.viewer.visibleBounds.width-l*this.viewer.zoomFactor)/2)<30&&(s=30),d<l&&(s+=(l-d)*this.viewer.zoomFactor/2),a.boundingRectangle.y,this.viewer.zoomFactor,this.viewer.pages.indexOf(a),this.viewer.zoomFactor;var h=this.imageResizerDivElement,c=parseFloat(h.style.width),p=parseFloat(h.style.height),g=parseFloat(this.imageResizerDiv.style.width),u=parseFloat(this.imageResizerDiv.style.height),f=(this.resizeMarkSize-1)/2,m=g+2*f,v=u+2*f;if(m>(c-o)*this.viewer.zoomFactor+f&&(m=(c-o)*this.viewer.zoomFactor),v>(p-n)*this.viewer.zoomFactor+f&&(v=(p-n)*this.viewer.zoomFactor),this.imageResizerDivElement.style.width=parseInt(this.imageResizerDivElement.style.width.replace("px",""),10)*this.viewer.zoomFactor+"px",this.imageResizerDivElement.style.height=parseInt(this.imageResizerDivElement.style.height.replace("px",""),10)*this.viewer.zoomFactor+"px",v=this.viewer.render.getScaledValue(e.height),m=this.viewer.render.getScaledValue(e.width),o=this.viewer.render.getScaledValue(o),n=this.viewer.render.getScaledValue(n),this.setImageResizerPosition(o,n,m,v,this),!this.selectedImageWidget.containsKey(r)){var y=new $e(e.height,e.width);this.selectedImageWidget.add(r,y)}},e.prototype.showImageResizer=function(){t.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display=""),t.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display=""),t.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="",this.bottomLeftRectParent.style.display=""),t.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="",this.bottomRightRectParent.style.display=""),t.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="",this.bottomMiddleRectParent.style.display=""),t.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="",this.rightMiddleRectParent.style.display=""),t.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="",this.topRightRectParent.style.display=""),t.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="",this.topLeftRectParent.style.display=""),t.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="",this.leftMiddleRectParent.style.display=""),t.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="",this.topMiddleRectParent.style.display=""),this.isImageResizerVisible=!0},e.prototype.hideImageResizer=function(){t.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.style.display="none"),t.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.style.display="none"),t.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.style.display="none",this.bottomLeftRectParent.style.display="none"),t.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.style.display="none",this.bottomRightRectParent.style.display="none"),t.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.style.display="none",this.bottomMiddleRectParent.style.display="none"),t.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.style.display="none",this.rightMiddleRectParent.style.display="none"),t.isNullOrUndefined(this.topRightRect)||(this.topRightRect.style.display="none",this.topRightRectParent.style.display="none"),t.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.style.display="none",this.topLeftRectParent.style.display="none"),t.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.style.display="none",this.leftMiddleRectParent.style.display="none"),t.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.style.display="none",this.topMiddleRectParent.style.display="none"),this.isImageResizerVisible=!1,this.currentPage=void 0},e.prototype.initResizeMarks=function(e,t){return this.initResizeContainerDiv(t),e.appendChild(t.resizeContainerDiv),t.topRightRectParent=document.createElement("div"),t.topRightRectParent.style.cursor="ne-resize",t.topRightRectParent.id=this.viewer.owner.containerId+"_TopRightRectParent",this.applyProperties(t.topRightRectParent),t.topRightRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.topRightRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.topRightRectParent.style.opacity="-1",e.appendChild(t.topRightRectParent),t.topRightRect=document.createElement("div"),t.topRightRect.id=this.viewer.owner.containerId+"_TopRightRect",t.topRightRect.style.cursor="ne-resize",this.applyProperties(t.topRightRect),e.appendChild(t.topRightRect),t.topLeftRectParent=document.createElement("div"),t.topLeftRectParent.style.cursor="nw-resize",t.topLeftRectParent.id=this.viewer.owner.containerId+"_TopLeftRectParent",this.applyProperties(t.topLeftRectParent),t.topLeftRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.topLeftRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.topLeftRectParent.style.opacity="-1",e.appendChild(t.topLeftRectParent),t.topLeftRect=document.createElement("div"),t.topLeftRect.id=this.viewer.owner.containerId+"_TopLeftRect",t.topLeftRect.style.cursor="nw-resize",this.applyProperties(t.topLeftRect),e.appendChild(t.topLeftRect),t.topMiddleRectParent=document.createElement("div"),t.topMiddleRectParent.style.cursor="n-resize",t.topMiddleRectParent.id=this.viewer.owner.containerId+"_TopMiddleRectParent",this.applyProperties(t.topMiddleRectParent),t.topMiddleRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.topMiddleRectParent.style.opacity="-1",e.appendChild(t.topMiddleRectParent),t.topMiddleRect=document.createElement("div"),t.topMiddleRect.id=this.viewer.owner.containerId+"_TopMiddleRect",t.topMiddleRect.style.cursor="n-resize",this.applyProperties(t.topMiddleRect),e.appendChild(t.topMiddleRect),t.bottomRightRectParent=document.createElement("div"),t.bottomRightRectParent.style.cursor="se-resize",t.bottomRightRectParent.id=this.viewer.owner.containerId+"_BottomRightRectParent",this.applyProperties(t.bottomRightRectParent),t.bottomRightRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.bottomRightRectParent.style.opacity="-1",e.appendChild(t.bottomRightRectParent),t.bottomRightRect=document.createElement("div"),t.bottomRightRect.id=this.viewer.owner.containerId+"_BottomRightRect",t.bottomRightRect.style.cursor="se-resize",this.applyProperties(t.bottomRightRect),e.appendChild(t.bottomRightRect),t.bottomLeftRectParent=document.createElement("div"),t.bottomLeftRectParent.style.cursor="sw-resize",t.bottomLeftRectParent.id=this.viewer.owner.containerId+"_BottomLeftRectParent",this.applyProperties(t.bottomLeftRectParent),t.bottomLeftRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.bottomLeftRectParent.style.opacity="-1",e.appendChild(t.bottomLeftRectParent),t.bottomLeftRect=document.createElement("div"),t.bottomLeftRect.id=this.viewer.owner.containerId+"_BottomLeftRect",t.bottomLeftRect.style.cursor="sw-resize",this.applyProperties(t.bottomLeftRect),e.appendChild(t.bottomLeftRect),t.bottomMiddleRectParent=document.createElement("div"),t.bottomMiddleRectParent.style.cursor="s-resize",t.bottomMiddleRectParent.id=this.viewer.owner.containerId+"_BottomMiddleRectParent",this.applyProperties(t.bottomMiddleRectParent),t.bottomMiddleRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.bottomMiddleRectParent.style.opacity="-1",e.appendChild(t.bottomMiddleRectParent),t.bottomMiddleRect=document.createElement("div"),t.bottomMiddleRect.id=this.viewer.owner.containerId+"_BottomMiddleRect",t.bottomMiddleRect.style.cursor="s-resize",this.applyProperties(t.bottomMiddleRect),e.appendChild(t.bottomMiddleRect),t.rightMiddleRectParent=document.createElement("div"),t.rightMiddleRectParent.style.cursor="e-resize",t.rightMiddleRectParent.id=this.viewer.owner.containerId+"_RightMiddleRectParent",this.applyProperties(t.rightMiddleRectParent),t.rightMiddleRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.rightMiddleRectParent.style.opacity="-1",e.appendChild(t.rightMiddleRectParent),t.rightMiddleRect=document.createElement("div"),t.rightMiddleRect.id=this.viewer.owner.containerId+"_RightMiddleRect",t.rightMiddleRect.style.cursor="e-resize",this.applyProperties(t.rightMiddleRect),e.appendChild(t.rightMiddleRect),t.leftMiddleRectParent=document.createElement("div"),t.leftMiddleRectParent.style.cursor="w-resize",t.leftMiddleRectParent.id=this.viewer.owner.containerId+"_LeftMiddleRectParent",this.applyProperties(t.leftMiddleRectParent),t.leftMiddleRectParent.style.width=this.viewer.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.height=this.viewer.isTouchInput?"30px":"14px",t.leftMiddleRectParent.style.opacity="-1",e.appendChild(t.leftMiddleRectParent),t.leftMiddleRect=document.createElement("div"),t.leftMiddleRect.id=this.viewer.owner.containerId+"_LeftMiddleRect",t.leftMiddleRect.style.cursor="w-resize",this.applyProperties(t.leftMiddleRect),e.appendChild(t.leftMiddleRect),t.resizeContainerDiv},e.prototype.setImageResizerPosition=function(e,t,i,r,n){n.resizeContainerDiv.style.width=i+"px",n.resizeContainerDiv.style.height=r+"px",n.resizeContainerDiv.style.left=e-1+"px",n.resizeContainerDiv.style.top=t+"px",n.topRightRect.style.left=e+i-5+"px",n.topRightRect.style.top=t-4+"px",n.topLeftRect.style.left=e-5+"px",n.topLeftRect.style.top=t-4+"px",n.topMiddleRect.style.left=parseFloat(n.topLeftRect.style.left)+i/2-4+"px",n.topMiddleRect.style.top=t-4+"px",n.bottomRightRect.style.left=n.topRightRect.style.left,n.bottomRightRect.style.top=parseFloat(n.topRightRect.style.top)+r+"px",n.bottomLeftRect.style.left=n.topLeftRect.style.left,n.bottomLeftRect.style.top=parseFloat(n.topLeftRect.style.top)+r+"px",n.bottomMiddleRect.style.left=n.topMiddleRect.style.left,n.bottomMiddleRect.style.top=parseFloat(n.topMiddleRect.style.top)+r+"px",n.rightMiddleRect.style.left=e+i-4+"px",n.rightMiddleRect.style.top=parseFloat(n.topRightRect.style.top)+r/2+"px",n.leftMiddleRect.style.left=n.topLeftRect.style.left,n.leftMiddleRect.style.top=parseFloat(n.topLeftRect.style.top)+r/2+"px",n.topRightRectParent.style.left=this.viewer.isTouchInput?e+i-15+"px":e+i-8+"px",n.topRightRectParent.style.top=this.viewer.isTouchInput?t-15+"px":t-7+"px",n.topLeftRectParent.style.left=this.viewer.isTouchInput?e-15+"px":e-8+"px",n.topLeftRectParent.style.top=this.viewer.isTouchInput?t-15+"px":t-7+"px",n.topMiddleRectParent.style.left=parseFloat(n.topLeftRectParent.style.left)+i/2-4+"px",n.topMiddleRectParent.style.top=this.viewer.isTouchInput?t-15+"px":t-7+"px",n.bottomRightRectParent.style.left=n.topRightRectParent.style.left,n.bottomRightRectParent.style.top=parseFloat(n.topRightRectParent.style.top)+r+"px",n.bottomLeftRectParent.style.left=n.topLeftRectParent.style.left,n.bottomLeftRectParent.style.top=parseFloat(n.topLeftRectParent.style.top)+r+"px",n.bottomMiddleRectParent.style.left=n.topMiddleRectParent.style.left,n.bottomMiddleRectParent.style.top=parseFloat(n.topMiddleRectParent.style.top)+r+"px",n.rightMiddleRectParent.style.left=this.viewer.isTouchInput?e+i-15+"px":e+i-7+"px",n.rightMiddleRectParent.style.top=parseFloat(n.topRightRectParent.style.top)+r/2+"px",n.leftMiddleRectParent.style.left=n.topLeftRectParent.style.left,n.leftMiddleRectParent.style.top=parseFloat(n.topLeftRectParent.style.top)+r/2+"px",this.setImageResizingPoints(n),this.viewer.isTouchInput?this.applyPropertiesForTouch():this.applyPropertiesForMouse()},e.prototype.setImageResizingPoints=function(e){this.imageResizerPoints.resizeContainerDiv.x=parseFloat(e.resizeContainerDiv.style.left),this.imageResizerPoints.resizeContainerDiv.y=parseFloat(e.resizeContainerDiv.style.top),this.imageResizerPoints.bottomLeftRectParent.x=parseFloat(e.bottomLeftRectParent.style.left),this.imageResizerPoints.bottomLeftRectParent.y=parseFloat(e.bottomLeftRectParent.style.top),this.imageResizerPoints.bottomRightRectParent.x=parseFloat(e.bottomRightRectParent.style.left),this.imageResizerPoints.bottomRightRectParent.y=parseFloat(e.bottomRightRectParent.style.top),this.imageResizerPoints.bottomMiddleRectParent.x=parseFloat(e.bottomMiddleRectParent.style.left),this.imageResizerPoints.bottomMiddleRectParent.y=parseFloat(e.bottomMiddleRectParent.style.top),this.imageResizerPoints.topLeftRectParent.x=parseFloat(e.topLeftRectParent.style.left),this.imageResizerPoints.topLeftRectParent.y=parseFloat(e.topLeftRectParent.style.top),this.imageResizerPoints.topRightRectParent.x=parseFloat(e.topRightRectParent.style.left),this.imageResizerPoints.topRightRectParent.y=parseFloat(e.topRightRectParent.style.top),this.imageResizerPoints.topMiddleRectParent.x=parseFloat(e.topMiddleRectParent.style.left),this.imageResizerPoints.topMiddleRectParent.y=parseFloat(e.topMiddleRectParent.style.top),this.imageResizerPoints.leftMiddleRectParent.x=parseFloat(e.leftMiddleRectParent.style.left),this.imageResizerPoints.leftMiddleRectParent.y=parseFloat(e.leftMiddleRectParent.style.top),this.imageResizerPoints.rightMiddleRectParent.x=parseFloat(e.rightMiddleRectParent.style.left),this.imageResizerPoints.rightMiddleRectParent.y=parseFloat(e.rightMiddleRectParent.style.top)},e.prototype.initResizeContainerDiv=function(e){e.resizeContainerDiv=document.createElement("div"),e.resizeContainerDiv.id=this.viewer.owner.containerId+"_ResizeDivElement",e.resizeContainerDiv.style.position="absolute",e.resizeContainerDiv.style.border="1px solid #bfbfbf",e.resizeContainerDiv.style.zIndex="30",e.resizeContainerDiv.style.backgroundColor="transparent",e.resizeContainerDiv.style.display="block"},e.prototype.applyProperties=function(e){e.style.position="absolute",e.style.width="8px",e.style.height="8px",e.style.fontSize="0px",e.style.zIndex=" 551",e.style.backgroundColor="#ffffff",e.style.border="1px solid #bfbfbf",e.style.boxShadow="0 1px 2px 0 #bfbfbf 0.35",e.style.color="#000000"},e.prototype.handleImageResizing=function(e,i,r){i/=this.viewer.zoomFactor,r/=this.viewer.zoomFactor,this.leftValue=t.isNullOrUndefined(this.leftValue)?i:this.leftValue,this.topValue=t.isNullOrUndefined(this.topValue)?r:this.topValue;var n;switch(this.selectedResizeElement.id.split("_")[1]){case"TopRightRectParent":i=(n=this.topRightResizing(e)).left,r=n.top;break;case"TopLeftRectParent":i=-(n=this.topLeftResizing(e)).left,r=-n.top;break;case"TopMiddleRectParent":i=0,r=this.topMiddleResizing(e);break;case"BottomRightRectParent":i=(n=this.bottomRightResizing(e)).left,r=n.top;break;case"BottomLeftRectParent":i=-(n=this.bottomLeftResizing(e)).left,r=-n.top;break;case"BottomMiddleRectParent":r=e.y-r,i=0;break;case"RightMiddleRectParent":i=e.x-i,r=0;break;case"LeftMiddleRectParent":i=this.leftMiddleResizing(e),r=0}if(0!==i||0!==r){var o=this.currentImageElementBox.line.paragraph,a=this.currentImageElementBox;if(!t.isNullOrUndefined(o)&&o.isInsideTable){var s=o.containerWidget;if(!t.isNullOrUndefined(s)){var l=s.containerWidget,d=W.convertPointToPixel(a.height),h=l.height-d;r>0&&l.y+h+d+r>this.viewer.clientArea.bottom&&(this.isImageMoveToNextPage=!0)}}if(this.owner.enableHistoryMode&&this.initHistoryForImageResizer(this.currentImageElementBox),!t.isNullOrUndefined(this.currentImageElementBox)){var c=this.currentImageElementBox.width+i>10?this.currentImageElementBox.width+i:10,p=this.currentImageElementBox.height+r>10?this.currentImageElementBox.height+r:10;"BottomRightRectParent"!==this.selectedResizeElement.id.split("_")[1]&&"TopRightRectParent"!==this.selectedResizeElement.id.split("_")[1]&&"BottomLeftRectParent"!==this.selectedResizeElement.id.split("_")[1]&&"TopLeftRectParent"!==this.selectedResizeElement.id.split("_")[1]||(p=this.currentImageElementBox.height/this.currentImageElementBox.width*c,c=this.currentImageElementBox.width/this.currentImageElementBox.height*p),this.currentImageElementBox.width=c,this.currentImageElementBox.height=p;this.currentImageElementBox.line.paragraph;this.positionImageResizer(this.currentImageElementBox)}this.isImageResizing=!0}},e.prototype.handleImageResizingOnMouse=function(e){if(!t.isNullOrUndefined(this.selectedResizeElement)){var i=parseFloat(this.selectedResizeElement.style.left),r=parseFloat(this.selectedResizeElement.style.top),n=new T(e.offsetX,e.offsetY),o=this.viewer.findFocusedPage(n,!0);this.handleImageResizing(o,i,r)}},e.prototype.topMiddleResizing=function(e){var t;return this.topValue>=e.y?(t=this.topValue/e.y,this.topValue=e.y,this.viewer instanceof ve&&this.topValue<=this.viewer.pageGap&&(t=1)):(t=-e.y/this.topValue,this.topValue=e.y,0===this.topValue&&(t=-1)),t},e.prototype.leftMiddleResizing=function(e){var t;return this.leftValue>=e.x?(t=this.leftValue/e.x,this.leftValue=e.x,0===this.leftValue&&(t=1,this.leftValue=parseFloat(this.selectedResizeElement.style.left))):(t=-e.x/this.leftValue,this.leftValue=e.x),t},e.prototype.topRightResizing=function(e){return this.leftValue<=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.topLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue>=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomRightResizing=function(e){return this.leftValue<=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.bottomLeftResizing=function(e){return this.leftValue>=e.x&&this.topValue<=e.y?this.getOuterResizingPoint(e):this.getInnerResizingPoint(e)},e.prototype.getOuterResizingPoint=function(e){var t,i;return t=e.x-this.leftValue,this.leftValue=e.x,i=e.y-this.topValue,this.topValue=e.y,{left:t,top:i}},e.prototype.getInnerResizingPoint=function(e){var t,i;return t=-(this.leftValue-e.x),this.leftValue=e.x,i=-(this.topValue-e.y),this.topValue=e.y,{left:t,top:i}},e.prototype.handleImageResizingOnTouch=function(e){if(!t.isNullOrUndefined(this.selectedResizeElement)){var i=parseFloat(this.selectedResizeElement.style.left)+24,r=parseFloat(this.selectedResizeElement.style.top)+24,n=e.touches,o=new T(n[0].clientX,n[0].clientY),a=this.viewer.findFocusedPage(o,!0);if(t.isNullOrUndefined(this.currentImageElementBox)||t.isNullOrUndefined(this.currentImageElementBox))return;this.handleImageResizing(a,i,r)}},e.prototype.getImagePoint=function(e){var i=this.viewer.render.getScaledValue(e.x,1),r=this.viewer.render.getScaledValue(e.y,2);e=new T(i,r);var n=this.imageResizerPoints,o="",a=void 0,s=n.bottomMiddleRectParent,l=n.bottomRightRectParent,d=n.bottomLeftRectParent,h=n.topMiddleRectParent,c=n.topRightRectParent,p=n.topLeftRectParent,g=n.rightMiddleRectParent,u=n.leftMiddleRectParent;return t.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+15&&e.y>s.y&&e.y<=s.y+15?(a=this.bottomMiddleRectParent,o="s-resize"):e.x>l.x&&e.x<=l.x+15&&e.y>l.y&&e.y<=l.y+15?(a=this.bottomRightRectParent,o="se-resize"):e.x>d.x&&e.x<=d.x+15&&e.y>d.y&&e.y<=d.y+15?(a=this.bottomLeftRectParent,o="sw-resize"):e.x>h.x&&e.x<=h.x+15&&e.y>h.y&&e.y<=h.y+15?(a=this.topMiddleRectParent,o="n-resize"):e.x>c.x&&e.x<=c.x+15&&e.y>c.y&&e.y<=c.y+15?(a=this.topRightRectParent,o="ne-resize"):e.x>p.x&&e.x<=p.x+15&&e.y>p.y&&e.y<=p.y+15?(a=this.topLeftRectParent,o="nw-resize"):e.x>u.x&&e.x<=u.x+15&&e.y>u.y&&e.y<=u.y+15?(a=this.leftMiddleRectParent,o="w-resize"):e.x>g.x&&e.x<=g.x+15&&e.y>g.y&&e.y<=g.y+15?(a=this.rightMiddleRectParent,o="e-resize"):!t.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(o="move")),{selectedElement:a,resizePosition:o}},e.prototype.applyPropertiesForMouse=function(){t.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="14px",this.bottomMiddleRectParent.style.height="14px",this.bottomRightRectParent.style.width="14px",this.bottomRightRectParent.style.height="14px",this.bottomLeftRectParent.style.width="14px",this.bottomLeftRectParent.style.height="14px",this.topMiddleRectParent.style.width="14px",this.topMiddleRectParent.style.height="14px",this.topRightRectParent.style.width="14px",this.topRightRectParent.style.height="14px",this.topLeftRectParent.style.width="14px",this.topLeftRectParent.style.height="14px",this.leftMiddleRectParent.style.width="14px",this.leftMiddleRectParent.style.height="14px",this.rightMiddleRectParent.style.width="14px",this.rightMiddleRectParent.style.height="14px")},e.prototype.getImagePointOnTouch=function(e){var i=this.viewer.render.getScaledValue(e.x,1),r=this.viewer.render.getScaledValue(e.y,2);e=new T(i,r);var n=this.imageResizerPoints,o="",a=void 0,s=n.bottomMiddleRectParent,l=n.bottomRightRectParent,d=n.bottomLeftRectParent,h=n.topMiddleRectParent,c=n.topRightRectParent,p=n.topLeftRectParent,g=n.rightMiddleRectParent,u=n.leftMiddleRectParent;return t.isNullOrUndefined(this.bottomMiddleRectParent)||"none"===this.bottomMiddleRectParent.style.display||(e.x>s.x&&e.x<=s.x+25&&e.y>s.y&&e.y<=s.y+25?(a=this.bottomMiddleRectParent,o="s-resize"):e.x>l.x&&e.x<=l.x+25&&e.y>l.y&&e.y<=l.y+25?(a=this.bottomRightRectParent,o="se-resize"):e.x>d.x&&e.x<=d.x+25&&e.y>d.y&&e.y<=d.y+25?(a=this.bottomLeftRectParent,o="sw-resize"):e.x>h.x&&e.x<=h.x+25&&e.y>h.y&&e.y<=h.y+25?(a=this.topMiddleRectParent,o="n-resize"):e.x>c.x&&e.x<=c.x+25&&e.y>c.y&&e.y<=c.y+25?(a=this.topRightRectParent,o="ne-resize"):e.x>p.x&&e.x<=p.x+25&&e.y>p.y&&e.y<=p.y+25?(a=this.topLeftRectParent,o="nw-resize"):e.x>u.x&&e.x<=u.x+25&&e.y>u.y&&e.y<=u.y+25?(a=this.leftMiddleRectParent,o="w-resize"):e.x>g.x&&e.x<=g.x+25&&e.y>g.y&&e.y<=g.y+25?(a=this.rightMiddleRectParent,o="e-resize"):!t.isNullOrUndefined(this.resizeContainerDiv)&&e.x>parseFloat(this.resizeContainerDiv.style.left)&&e.x<=parseFloat(this.resizeContainerDiv.style.left)+parseFloat(this.resizeContainerDiv.style.width)&&e.y>parseFloat(this.resizeContainerDiv.style.top)&&e.y<=parseFloat(this.resizeContainerDiv.style.top)+parseFloat(this.resizeContainerDiv.style.height)&&(o="move")),{selectedElement:a,resizePosition:o}},e.prototype.applyPropertiesForTouch=function(){t.isNullOrUndefined(this.bottomLeftRectParent)||(this.bottomMiddleRectParent.style.width="30px",this.bottomMiddleRectParent.style.height="30px",this.bottomRightRectParent.style.width="30px",this.bottomRightRectParent.style.height="30px",this.bottomLeftRectParent.style.width="30px",this.bottomLeftRectParent.style.height="30px",this.topMiddleRectParent.style.width="30px",this.topMiddleRectParent.style.height="30px",this.topRightRectParent.style.width="30px",this.topRightRectParent.style.height="30px",this.topLeftRectParent.style.width="30px",this.topLeftRectParent.style.height="30px",this.leftMiddleRectParent.style.width="30px",this.leftMiddleRectParent.style.height="30px",this.rightMiddleRectParent.style.width="30px",this.rightMiddleRectParent.style.height="30px")},e.prototype.mouseUpInternal=function(){this.currentImageElementBox.width=parseFloat(this.imageResizerDiv.style.width)/this.viewer.zoomFactor,this.currentImageElementBox.height=parseFloat(this.imageResizerDiv.style.height)/this.viewer.zoomFactor,this.owner.isShiftingEnabled=!0,this.owner.editorModule.setOffsetValue(this.owner.selection),this.viewer.layout.reLayoutParagraph(this.currentImageElementBox.line.paragraph,0,0),this.owner.editorModule.reLayout(this.owner.selection,!0),this.viewer.updateScrollBars()},e.prototype.initHistoryForImageResizer=function(e){!t.isNullOrUndefined(this.owner)&&t.isNullOrUndefined(this.baseHistoryInfo)&&(this.baseHistoryInfo=new Ye(this.owner),this.baseHistoryInfo.action="ImageResizing",this.baseHistoryInfo.updateSelection(),this.baseHistoryInfo.modifiedProperties.push(new Oe(e)))},e.prototype.updateHistoryForImageResizer=function(){if(!t.isNullOrUndefined(this.owner)&&!t.isNullOrUndefined(this.baseHistoryInfo)){var e=this.baseHistoryInfo.modifiedProperties[0];this.currentImageElementBox.width===e.width&&this.currentImageElementBox.height===e.height?this.baseHistoryInfo.modifiedProperties.pop():this.owner.editorHistory.recordChanges(this.baseHistoryInfo),this.baseHistoryInfo=void 0}},e.prototype.updateImageResizerPosition=function(){if(!t.isNullOrUndefined(this.currentImageElementBox)){var e=this.currentImageElementBox,i=e.line,r=this.viewer.selection.getTop(i)+e.margin.top,n=this.viewer.selection.getLeftInternal(i,e,0),o=r*this.viewer.zoomFactor,a=n*this.viewer.zoomFactor,s=this.viewer.render.getScaledValue(e.height,2),l=this.viewer.render.getScaledValue(e.width,1);this.setImageResizerPosition(a,o,l,s,this)}},e.prototype.destroy=function(){t.isNullOrUndefined(this.resizeContainerDiv)||(this.resizeContainerDiv.innerHTML=""),t.isNullOrUndefined(this.topLeftRect)||(this.topLeftRect.innerHTML=""),t.isNullOrUndefined(this.topMiddleRect)||(this.topMiddleRect.innerHTML=""),t.isNullOrUndefined(this.topRightRect)||(this.topRightRect.innerHTML=""),t.isNullOrUndefined(this.bottomLeftRect)||(this.bottomLeftRect.innerHTML=""),t.isNullOrUndefined(this.bottomMiddleRect)||(this.bottomMiddleRect.innerHTML=""),t.isNullOrUndefined(this.bottomRightRect)||(this.bottomRightRect.innerHTML=""),t.isNullOrUndefined(this.leftMiddleRect)||(this.leftMiddleRect.innerHTML=""),t.isNullOrUndefined(this.rightMiddleRect)||(this.rightMiddleRect.innerHTML=""),t.isNullOrUndefined(this.imageResizerDiv)||(this.imageResizerDiv.innerHTML=""),t.isNullOrUndefined(this.selectedImageWidget)||this.selectedImageWidget.destroy(),t.isNullOrUndefined(this.imageResizerDivElement)||(this.imageResizerDivElement.innerHTML=""),this.imageResizerDivElement=void 0,this.resizeContainerDiv=void 0,this.topLeftRect=void 0,this.topMiddleRect=void 0,this.topRightRect=void 0,this.bottomLeftRect=void 0,this.bottomMiddleRect=void 0,this.bottomRightRect=void 0,this.leftMiddleRect=void 0,this.rightMiddleRect=void 0,this.imageResizerDiv=void 0,this.selectedImageWidget=void 0,this.isImageResizing=!1,this.isImageResizerVisible=!1,this.currentImageElementBoxIn=void 0,this.resizeMarkSizeIn=void 0,this.viewer=void 0,this.owner=void 0},e}(),Ze=function(){function e(){this.resizeContainerDiv=new T(0,0),this.topLeftRectParent=new T(0,0),this.topMiddleRectParent=new T(0,0),this.topRightRectParent=new T(0,0),this.bottomLeftRectParent=new T(0,0),this.bottomMiddleRectParent=new T(0,0),this.bottomRightRectParent=new T(0,0),this.leftMiddleRectParent=new T(0,0),this.rightMiddleRectParent=new T(0,0)}return e}(),$e=function(){function e(e,t){this.heightIn=0,this.widthIn=0,this.heightIn=e,this.widthIn=t}return Object.defineProperty(e.prototype,"height",{get:function(){return this.heightIn},set:function(e){this.heightIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.widthIn},set:function(e){this.widthIn=e},enumerable:!0,configurable:!0}),e}(),Qe=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),et=function(e){function i(t,i){var r=e.call(this,t)||this;return r.isChildHistoryInfo=!1,r.isChildHistoryInfo=i,r}return Qe(i,e),Object.defineProperty(i.prototype,"hasAction",{get:function(){return!t.isNullOrUndefined(this.modifiedActions)},enumerable:!0,configurable:!0}),i.prototype.addModifiedAction=function(e){this.editorHistory.isUndoing||this.editorHistory.isRedoing||(t.isNullOrUndefined(this.modifiedActions)&&(this.modifiedActions=[]),this.modifiedActions.push(e))},i.prototype.revert=function(){if(this.editorHistory.currentHistoryInfo=this,"BordersAndShading"===this.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),!t.isNullOrUndefined(this.modifiedActions))if(this.editorHistory.isUndoing)for(e=this.modifiedActions.length;e>0;)(i=this.modifiedActions[e-1]).revert(),e-=1;else for(var e=0;e<this.modifiedActions.length;){var i=this.modifiedActions[e];i.revert(),e+=1}this.isChildHistoryInfo?this.editorHistory.updateComplexHistoryInternal():this.editorHistory.updateComplexHistory()},i.prototype.destroy=function(){if(!t.isNullOrUndefined(this.modifiedActions)){for(;this.modifiedActions.length>0;){var i=this.modifiedActions[this.modifiedActions.length-1];i.destroy(),this.modifiedActions.splice(this.modifiedActions.indexOf(i),1)}this.modifiedActions=void 0}e.prototype.destroy.call(this)},i}(Ye),tt=function(){function e(e){this.undoStackIn=[],this.redoStackIn=[],this.historyInfoStack=[],this.isUndoing=!1,this.isRedoing=!1,this.owner=e,this.viewer=e.viewer,this.modifiedParaFormats=new c,this.undoLimitIn=500,this.redoLimitIn=500}return Object.defineProperty(e.prototype,"currentHistoryInfo",{get:function(){return this.historyInfoStack&&this.historyInfoStack.length>0?this.historyInfoStack[this.historyInfoStack.length-1]:void 0},set:function(e){e instanceof et?this.historyInfoStack.push(e):this.historyInfoStack.pop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoStack",{get:function(){return this.undoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoStack",{get:function(){return this.redoStackIn},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"undoLimit",{get:function(){return t.isNullOrUndefined(this.undoLimitIn)?0:this.undoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.undoLimitIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"redoLimit",{get:function(){return t.isNullOrUndefined(this.redoLimitIn)?0:this.redoLimitIn},set:function(e){if(e<0)throw new Error("The limit should be greater than or equal to zero.");this.redoLimitIn=e},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"EditorHistory"},e.prototype.canUndo=function(){return!t.isNullOrUndefined(this.undoStack)&&this.undoStack.length>0},e.prototype.canRedo=function(){return!t.isNullOrUndefined(this.redoStack)&&this.redoStack.length>0},e.prototype.initializeHistory=function(e){this.currentBaseHistoryInfo=new Ye(this.owner),this.currentBaseHistoryInfo.action=e,this.currentBaseHistoryInfo.updateSelection()},e.prototype.initComplexHistory=function(e,i){this.currentHistoryInfo=new et(e.owner,!t.isNullOrUndefined(this.currentHistoryInfo)),this.currentHistoryInfo.action=i,this.currentHistoryInfo.updateSelection()},e.prototype.initResizingHistory=function(e,i){if(1===i.resizeNode)this.initializeHistory("RowResizing"),t.isNullOrUndefined(this.currentBaseHistoryInfo)||this.currentBaseHistoryInfo.modifiedProperties.push(new Ve(e,i.currentResizingTable.childWidgets[i.resizerPosition].rowFormat));else if(this.initializeHistory("CellResizing"),this.currentBaseHistoryInfo){i.currentResizingTable=i.currentResizingTable.combineWidget(this.viewer);var r=new qe(i.currentResizingTable,this.owner);r.startingPoint=e,this.currentBaseHistoryInfo.modifiedProperties.push(r)}},e.prototype.updateResizingHistory=function(e,i){if(1===i.resizeNode){if(!t.isNullOrUndefined(this.currentBaseHistoryInfo)){var r=this.currentBaseHistoryInfo.modifiedProperties[0];r.startingPoint.y===e.y?this.currentBaseHistoryInfo.modifiedProperties.length=0:(r.displacement=W.convertPixelToPoint(e.y-r.startingPoint.y),this.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}}else if(!t.isNullOrUndefined(this.currentBaseHistoryInfo)){var n=this.currentBaseHistoryInfo.modifiedProperties[0];n.startingPoint.x===e.x?this.currentBaseHistoryInfo.modifiedProperties.length=0:(n.displacement=W.convertPixelToPoint(e.x-n.startingPoint.x),n.endIndex=i.getCellReSizerPosition(e),this.owner.editorHistory.recordChanges(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)}},e.prototype.recordChanges=function(e){if(this.owner.enableHistoryMode)if(this.isUndoing){if(t.isNullOrUndefined(this.redoStack)&&(this.redoStackIn=[]),this.redoStack.length===this.redoLimit&&this.redoLimit>0){i=this.undoLimit>20?10:1;this.redoStackIn.splice(0,i)}this.redoStack.length<this.redoLimit&&this.redoStack.push(e)}else{if(this.isRedoing||this.clearRedoStack(),t.isNullOrUndefined(this.undoStack)&&(this.undoStackIn=[]),this.undoStack.length===this.undoLimit&&this.undoLimit>0){var i=this.undoLimit>20?10:1;this.undoStackIn.splice(0,i)}this.undoStack.length<this.undoLimit&&this.undoStackIn.push(e)}},e.prototype.updateHistory=function(){this.viewer.owner.enableHistoryMode&&!t.isNullOrUndefined(this.currentBaseHistoryInfo)&&(!t.isNullOrUndefined(this.currentBaseHistoryInfo)&&t.isNullOrUndefined(this.currentBaseHistoryInfo.endPosition)&&(this.currentBaseHistoryInfo.endPosition=this.currentBaseHistoryInfo.insertPosition),t.isNullOrUndefined(this.currentHistoryInfo)?this.recordChanges(this.currentBaseHistoryInfo):this.currentHistoryInfo.addModifiedAction(this.currentBaseHistoryInfo),this.currentBaseHistoryInfo=void 0)},e.prototype.isHandledComplexHistory=function(){var e=!1;return this.isUndoing||this.isRedoing||(e=this.owner.editorModule.insertRemoveBookMarkElements()),this.viewer.owner.enableHistoryMode&&!t.isNullOrUndefined(this.currentHistoryInfo)?(this.updateHistory(),e=!0):this.owner.editorModule.isHandledComplex&&(e=!0),e},e.prototype.updateComplexHistory=function(){var e=this.viewer.selection;if(this.currentHistoryInfo.hasAction){if("AutoFormatHyperlink"===this.currentHistoryInfo.action){t=new Ie(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition),e.owner.editorHistory.isUndoing?(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.selectionStart),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.selectionEnd)):(this.owner.editorModule.setPositionForCurrentIndex(e.start,this.currentHistoryInfo.endPosition),this.owner.editorModule.setPositionForCurrentIndex(e.end,this.currentHistoryInfo.endPosition))}if("InsertHyperlink"===this.currentHistoryInfo.action){var t=new Ie(e.owner);this.owner.editorModule.setPositionForCurrentIndex(t,this.currentHistoryInfo.insertPosition);var i=new Ie(e.owner);this.owner.editorModule.setPositionForCurrentIndex(i,this.currentHistoryInfo.endPosition),this.viewer.layout.reLayoutParagraph(t.paragraph,0,0),i.paragraph!==t.paragraph&&this.viewer.layout.reLayoutParagraph(i.paragraph,0,0)}"ReplaceAll"===this.currentHistoryInfo.action?this.owner.editorModule.layoutWholeDocument():e.owner.isShiftingEnabled&&(this.viewer.layout.shiftLayoutedItems(),this.owner.enableHeaderAndFooter&&this.owner.editorModule.updateHeaderFooterWidget(),this.viewer.removeEmptyPages())}e.owner.isShiftingEnabled=!1,e.owner.isLayoutEnabled=!0,e.start.updatePhysicalPosition(!0),e.isEmpty?e.end.setPositionInternal(e.start):e.end.updatePhysicalPosition(!0),e.upDownSelectionLength=e.end.location.x,this.viewer.updateScrollBars(),e.fireSelectionChanged(!0),this.viewer.updateFocus(),this.updateComplexHistoryInternal(),this.owner.editorModule.fireContentChange()},e.prototype.updateComplexHistoryInternal=function(){t.isNullOrUndefined(this.currentHistoryInfo)||(t.isNullOrUndefined(this.currentHistoryInfo.endPosition)&&(this.currentHistoryInfo.endPosition=this.currentHistoryInfo.insertPosition),this.historyInfoStack.length>1?this.historyInfoStack[this.historyInfoStack.length-2].addModifiedAction(this.currentHistoryInfo):this.recordChanges(this.currentHistoryInfo),this.currentHistoryInfo=void 0)},e.prototype.updateListChangesInHistory=function(e,i){this.currentBaseHistoryInfo=new Ye(this.viewer.owner),this.currentBaseHistoryInfo.action="List",this.currentBaseHistoryInfo.updateSelection();for(var r=new c,n=0;n<e.levels.length;n++){var o=this.viewer.getAbstractListById(i.abstractListId).levels[n],a=(this.currentBaseHistoryInfo.addModifiedPropertiesForList(o),new ze(o,e.levels[n]));t.isNullOrUndefined(o)||this.viewer.owner.editorModule.copyListLevel(o,e.levels[n]),r.add(n,a)}return r},e.prototype.applyListChanges=function(e,i){t.isNullOrUndefined(this.modifiedParaFormats)&&(this.modifiedParaFormats=new c);for(var r=[],n=0;n<this.viewer.listParagraphs.length;n++){var o=this.viewer.listParagraphs[n].paragraphFormat,a=this.viewer.getListById(o.listFormat.listId),s=this.viewer.layout.getListLevel(a,o.listFormat.listLevelNumber);if(i.containsKey(o.listFormat.listLevelNumber)&&i.get(o.listFormat.listLevelNumber).ownerListLevel===s){var l=new F(null);l.leftIndent=o.leftIndent,l.firstLineIndent=o.firstLineIndent;var d=new _e(o,l);r.push(d),this.owner.editorModule.copyFromListLevelParagraphFormat(o,s.paragraphFormat)}}this.modifiedParaFormats.add(this.currentBaseHistoryInfo,r)},e.prototype.updateListChanges=function(e){this.viewer.owner.isLayoutEnabled=!1,this.owner.editorModule.updateListParagraphs();for(var i=0;i<e.keys.length;i++){var r=e.keys[0],n=e.get(r);t.isNullOrUndefined(this.currentBaseHistoryInfo)||(n=this.currentBaseHistoryInfo.addModifiedPropertiesForList(n.ownerListLevel)),this.owner.editorModule.copyListLevel(n.ownerListLevel,n.modifiedListLevel)}this.revertListChanges(),this.viewer.owner.isLayoutEnabled=!0,this.viewer.renderedLists.clear(),this.viewer.pages=[],this.viewer.layout.layout();var o=this.viewer.selection;o.start.updatePhysicalPosition(!0),o.isEmpty?o.end.setPositionInternal(o.start):o.end.updatePhysicalPosition(!0),o.upDownSelectionLength=o.end.location.x,o.fireSelectionChanged(!1),this.updateHistory()},e.prototype.revertListChanges=function(){if(!t.isNullOrUndefined(this.currentBaseHistoryInfo)&&this.viewer.owner.editorHistory.modifiedParaFormats.containsKey(this.currentBaseHistoryInfo))for(var e=this.modifiedParaFormats.get(this.currentBaseHistoryInfo),i=0;i<e.length;i++){var r=new F(null);r.leftIndent=e[i].ownerFormat.leftIndent,r.firstLineIndent=e[i].ownerFormat.firstLineIndent,e[i].ownerFormat.copyFormat(e[i].modifiedFormat),e[i].modifiedFormat.leftIndent=r.leftIndent,e[i].modifiedFormat.firstLineIndent=r.firstLineIndent}},e.prototype.undo=function(){if(!this.owner.isReadOnlyMode&&this.canUndo()&&this.owner.enableHistoryMode){var e=this.undoStack.pop();this.isUndoing=!0,e.revert(),this.isUndoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.redo=function(){if(!this.owner.isReadOnlyMode&&this.canRedo()&&this.owner.enableHistoryMode){var e=this.redoStack.pop();"BordersAndShading"===e.action&&(this.owner.editorModule.isBordersAndShadingDialog=!0),this.isRedoing=!0,e.revert(),this.isRedoing=!1,this.owner.selection.checkForCursorVisibility(),this.owner.editorModule.isBordersAndShadingDialog=!1}},e.prototype.destroy=function(){this.clearHistory(),this.undoStackIn=void 0,this.redoStackIn=void 0},e.prototype.clearHistory=function(){this.clearUndoStack(),this.clearRedoStack()},e.prototype.clearUndoStack=function(){if(this.canUndo())for(;this.undoStack.length>0;){var e=this.undoStack.pop();e.destroy(),e=void 0}},e.prototype.clearRedoStack=function(){if(this.canRedo())for(;this.redoStack.length>0;){var e=this.redoStack.pop();e.destroy(),e=void 0}},e}(),it=function(){function e(){this.documentPath="word/document.xml",this.stylePath="word/styles.xml",this.numberingPath="word/numbering.xml",this.settingsPath="word/settings.xml",this.headerPath="word/header",this.footerPath="word/footer",this.imagePath="word/media/image",this.appPath="docProps/app.xml",this.corePath="docProps/core.xml",this.contentTypesPath="[Content_Types].xml",this.generalRelationPath="_rels/.rels",this.wordRelationPath="word/_rels/document.xml.rels",this.headerRelationPath="word/_rels/header",this.footerRelationPath="word/_rels/footer",this.xmlContentType="application/xml",this.fontContentType="application/vnd.openxmlformats-officedocument.obfuscatedFont",this.documentContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml",this.settingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml",this.footerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",this.headerContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",this.numberingContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml",this.stylesContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml",this.webSettingsContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.webSettings+xml",this.appContentType="application/vnd.openxmlformats-officedocument.extended-properties+xml",this.coreContentType="application/vnd.openxmlformats-package.core-properties+xml",this.customContentType="application/vnd.openxmlformats-officedocument.custom-properties+xml",this.customXmlContentType="application/vnd.openxmlformats-officedocument.customXmlProperties+xml",this.relationContentType="application/vnd.openxmlformats-package.relationships+xml",this.tableStyleContentType="application/vnd.openxmlformats-officedocument.presentationml.tableStyles+xml",this.settingsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings",this.footerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",this.headerRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",this.documentRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",this.numberingRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering",this.stylesRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",this.fontRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",this.tableStyleRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/tableStyles",this.coreRelType="http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",this.appRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",this.customRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",this.imageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",this.hyperlinkRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",this.controlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/control",this.packageRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/package",this.customXmlRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",this.customUIRelType="http://schemas.microsoft.com/office/2006/relationships/ui/extensibility",this.attachedTemplateRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/attachedTemplate",this.wNamespace="http://schemas.openxmlformats.org/wordprocessingml/2006/main",this.wpNamespace="http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",this.pictureNamespace="http://schemas.openxmlformats.org/drawingml/2006/picture",this.aNamespace="http://schemas.openxmlformats.org/drawingml/2006/main",this.a14Namespace="http://schemas.microsoft.com/office/drawing/2010/main",this.rNamespace="http://schemas.openxmlformats.org/officeDocument/2006/relationships",this.rpNamespace="http://schemas.openxmlformats.org/package/2006/relationships",this.vNamespace="urn:schemas-microsoft-com:vml",this.oNamespace="urn:schemas-microsoft-com:office:office",this.xmlNamespace="http://www.w3.org/XML/1998/namespace",this.w10Namespace="urn:schemas-microsoft-com:office:word",this.cpNamespace="http://schemas.openxmlformats.org/package/2006/metadata/core-properties",this.dcNamespace="http://purl.org/dc/elements/1.1/",this.docPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",this.veNamespace="http://schemas.openxmlformats.org/markup-compatibility/2006",this.mNamespace="http://schemas.openxmlformats.org/officeDocument/2006/math",this.wneNamespace="http://schemas.microsoft.com/office/word/2006/wordml",this.customPropsNamespace="http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",this.vtNamespace="http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",this.chartNamespace="http://schemas.openxmlformats.org/drawingml/2006/chart",this.slNamespace="http://schemas.openxmlformats.org/schemaLibrary/2006/main",this.dtNamespace="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",this.wmlNamespace="http://schemas.microsoft.com/office/word/2003/wordml",this.w14Namespace="http://schemas.microsoft.com/office/word/2010/wordml",this.wpCanvasNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",this.wpDrawingNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",this.wpGroupNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",this.wpInkNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingInk",this.wpShapeNamespace="http://schemas.microsoft.com/office/word/2010/wordprocessingShape",this.w15Namespace="http://schemas.microsoft.com/office/word/2012/wordml",this.diagramNamespace="http://schemas.openxmlformats.org/drawingml/2006/diagram",this.eNamespace="http://schemas.microsoft.com/office/2006/encryption",this.pNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/password",this.certNamespace="http://schemas.microsoft.com/office/2006/keyEncryptor/certificate",this.cRelationshipsTag="Relationships",this.cRelationshipTag="Relationship",this.cIdTag="Id",this.cTypeTag="Type",this.cTargetTag="Target",this.cUserShapesTag="userShapes",this.cExternalData="externalData",this.twipsInOnePoint=20,this.twentiethOfPoint=20,this.borderMultiplier=8,this.percentageFactor=50,this.emusPerPoint=12700,this.cConditionalTableStyleTag="tblStylePr",this.cTableFormatTag="tblPr",this.cTowFormatTag="trPr",this.cCellFormatTag="tcPr",this.cParagraphFormatTag="pPr",this.cCharacterFormatTag="rPr",this.packageType="http://schemas.microsoft.com/office/2006/xmlPackage",this.relsPartPath="/_rels/.rels",this.documentRelsPartPath="/word/_rels/document.xml.rels",this.webSettingsPath="/word/webSettings.xml",this.wordMLDocumentPath="/word/document.xml",this.wordMLStylePath="/word/styles.xml",this.wordMLNumberingPath="/word/numbering.xml",this.wordMLSettingsPath="/word/settings.xml",this.wordMLHeaderPath="/word/header",this.wordMLFooterPath="/word/footer",this.wordMLCommentsPath="/word/comments.xml",this.wordMLImagePath="/word/media/image",this.wordMLFootnotesPath="/word/footnotes.xml",this.wordMLEndnotesPath="/word/endnotes.xml",this.wordMLAppPath="/docProps/app.xml",this.wordMLCorePath="/docProps/core.xml",this.wordMLCustomPath="/docProps/custom.xml",this.wordMLFontTablePath="/word/fontTable.xml",this.wordMLChartsPath="/word/charts/",this.wordMLDefaultEmbeddingPath="/word/embeddings/",this.wordMLEmbeddingPath="/word/embeddings/",this.wordMLDrawingPath="/word/drawings/",this.wordMLThemePath="/word/theme/theme1.xml",this.wordMLFontsPath="/word/fonts/",this.wordMLDiagramPath="/word/diagrams/",this.wordMLControlPath="/word/activeX/",this.wordMLVbaProject="/vbaProject.bin",this.wordMLVbaData="/vbaData.xml",this.wordMLVbaProjectPath="/word/vbaProject.bin",this.wordMLVbaDataPath="/word/vbaData.xml",this.wordMLWebSettingsPath="/word/webSettings.xml",this.wordMLCustomItemProp1Path="/customXml/itemProps1.xml",this.wordMLFootnoteRelPath="/word/_rels/footnotes.xml.rels",this.wordMLEndnoteRelPath="/word/_rels/endnotes.xml.rels",this.wordMLSettingsRelPath="/word/_rels/settings.xml.rels",this.wordMLNumberingRelPath="/word/_rels/numbering.xml.rels",this.wordMLFontTableRelPath="/word/_rels/fontTable.xml.rels",this.wordMLCustomXmlPropsRelType="http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",this.wordMLControlRelType="http://schemas.microsoft.com/office/2006/relationships/activeXControlBinary",this.wordMLDiagramContentType="application/vnd.ms-office.drawingml.diagramDrawing+xml",this.lastSection=!1,this.mRelationShipID=0,this.mDocPrID=0,this.mDifferentFirstPage=!1,this.mBookmarks=void 0}return e.prototype.getModuleName=function(){return"WordExport"},Object.defineProperty(e.prototype,"bookmarks",{get:function(){return t.isNullOrUndefined(this.mBookmarks)&&(this.mBookmarks=[]),this.mBookmarks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentImages",{get:function(){return void 0===this.mDocumentImages&&(this.mDocumentImages=new c),this.mDocumentImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"externalImages",{get:function(){return void 0===this.mExternalLinkImages&&(this.mExternalLinkImages=new c),this.mExternalLinkImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headerFooterImages",{get:function(){return void 0===this.mHeaderFooterImages&&(this.mHeaderFooterImages=new c),this.mHeaderFooterImages},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"headersFooters",{get:function(){return void 0===this.mHeaderFooterColl&&(this.mHeaderFooterColl=new c),this.mHeaderFooterColl},enumerable:!0,configurable:!0}),e.prototype.save=function(e,t){this.serialize(e),this.mArchive.save(t+".docx").then(function(e){e.destroy()}),this.close()},e.prototype.saveAsBlob=function(e){var t=this;return this.serialize(e),new Promise(function(e,i){t.mArchive.saveAsBlob().then(function(i){t.mArchive.destroy(),i=new Blob([i],{type:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),e(i)})})},e.prototype.destroy=function(){this.clearDocument(),this.mRelationShipID=void 0,this.mDocPrID=void 0,this.mDifferentFirstPage=void 0,this.mArchive&&(this.mArchive.destroy(),this.mArchive=void 0)},e.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write();this.setDocument(t),this.mArchive=new a.ZipArchive,this.mArchive.compressionLevel="Normal",this.mVerticalMerge=new c,this.mGridSpans=new c;this.serializeDocument(),this.serializeStyles(),this.serializeNumberings(),this.serializeSettings(),this.serializeCoreProperties(),this.serializeAppProperties(),this.serializeFontTable(void 0),this.serializeSettingsRelation(),this.serializeHeaderFooters(),this.serializeDocumentRelations(),this.serializeGeneralRelations(),this.serializeContentTypes(void 0),this.clearDocument()},e.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections,this.mLists=e.lists,this.mAbstractLists=e.abstractLists,this.defCharacterFormat=e.characterFormat,this.defParagraphFormat=e.paragraphFormat,this.defaultTabWidthValue=e.defaultTabWidth,this.mStyles=e.styles},e.prototype.clearDocument=function(){this.section=void 0,this.lastSection=void 0,this.blockOwner=void 0,this.paragraph=void 0,this.table=void 0,this.row=void 0,this.headerFooter=void 0,this.document=void 0,this.mSections=void 0,this.mLists=void 0,this.mAbstractLists=void 0,this.defCharacterFormat=void 0,this.defParagraphFormat=void 0,this.defaultTabWidthValue=void 0,this.mRelationShipID=0,this.mDocPrID=0,this.mDifferentFirstPage=!1,this.mHeaderFooterColl&&(this.mHeaderFooterColl.destroy(),this.mHeaderFooterColl=void 0),this.mVerticalMerge&&(this.mVerticalMerge.destroy(),this.mVerticalMerge=void 0),this.mGridSpans&&(this.mGridSpans.destroy(),this.mGridSpans=void 0),this.mDocumentImages&&(this.mDocumentImages.destroy(),this.mDocumentImages=void 0),this.mExternalLinkImages&&(this.mExternalLinkImages.destroy(),this.mExternalLinkImages=void 0),this.mHeaderFooterImages&&(this.mHeaderFooterImages.destroy(),this.mHeaderFooterImages=void 0)},e.prototype.serializeDocument=function(){var e=new i.XmlWriter;e.writeStartElement("w","document",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeDocumentBody(e),e.writeEndElement();var t=new a.ZipArchiveItem(e.buffer,this.documentPath);this.mArchive.addItem(t)},e.prototype.writeCommonAttributeStrings=function(e){e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15 wp14")},e.prototype.writeDup=function(e){e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","wpg",void 0,this.wpGroupNamespace),e.writeAttributeString("xmlns","wpi",void 0,this.wpInkNamespace)},e.prototype.writeCustom=function(e){e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","v",void 0,this.vNamespace)},e.prototype.serializeDocumentBody=function(e){e.writeStartElement(void 0,"body",this.wNamespace);for(var t=this.document.sections.length,i=0;i<t;i++)this.section=this.document.sections[i],this.lastSection=i===t-1,this.serializeSection(e,this.section,i===t-1),this.section=void 0;e.writeEndElement()},e.prototype.serializeSection=function(e,t,i){this.blockOwner=t,this.serializeBodyItems(e,t.blocks,i),i&&this.serializeSectionProperties(e,t),this.blockOwner=void 0},e.prototype.serializeSectionProperties=function(e,t){e.writeStartElement("w","sectPr",this.wNamespace),t.headersFooters&&this.serializeHFReference(e,t.headersFooters),this.serializeSectionType(e,"nextPage"),this.serializePageSetup(e,t.sectionFormat),this.serializeColumns(e,t),void 0!==t.sectionFormat&&t.sectionFormat.differentFirstPage&&(e.writeStartElement(void 0,"titlePg",this.wNamespace),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeColumns=function(e,t){e.writeStartElement(void 0,"cols",this.wNamespace),e.writeAttributeString(void 0,"equalWidth",this.wNamespace,"1"),e.writeAttributeString(void 0,"space",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializePageSetup=function(e,t){void 0!==t&&(this.serializePageSize(e,t),this.serializePageMargins(e,t)),e.writeStartElement(void 0,"pgBorders",this.wNamespace),e.writeEndElement()},e.prototype.serializePageSize=function(e,t){e.writeStartElement(void 0,"pgSz",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(t.pageWidth*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"h",this.wNamespace,this.roundToTwoDecimal(t.pageHeight*this.twentiethOfPoint).toString()),e.writeEndElement()},e.prototype.serializePageMargins=function(e,t){e.writeStartElement(void 0,"pgMar",this.wNamespace);var i=Math.round(t.topMargin*this.twentiethOfPoint);e.writeAttributeString(void 0,"top",this.wNamespace,i.toString()),i=Math.round(t.rightMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"right",this.wNamespace,i.toString()),i=Math.round(t.bottomMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"bottom",this.wNamespace,i.toString()),i=Math.round(t.leftMargin*this.twentiethOfPoint),e.writeAttributeString(void 0,"left",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"header",this.wNamespace,this.roundToTwoDecimal(t.headerDistance*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"footer",this.wNamespace,this.roundToTwoDecimal(t.footerDistance*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"gutter",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeSectionType=function(e,t){e.writeStartElement("w","type",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,t),e.writeEndElement()},e.prototype.serializeHFReference=function(e,t){var i="";if(void 0!==t){this.mDifferentFirstPage=this.section.sectionFormat.differentOddAndEvenPages;var r=t.firstPageHeader;r&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"FirstPageHeader",i),e.writeEndElement()),(r=t.firstPageFooter)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"first"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"FirstPageFooter",i),e.writeEndElement()),(r=t.evenHeader)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"EvenHeader",i),e.writeEndElement()),(r=t.evenFooter)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"even"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"EvenFooter",i),e.writeEndElement()),(r=t.header)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"headerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"OddHeader",i),e.writeEndElement()),(r=t.footer)&&r.blocks&&r.blocks.length>0&&(e.writeStartElement(void 0,"footerReference",this.wNamespace),e.writeAttributeString(void 0,"type",this.wNamespace,"default"),i=this.getNextRelationShipID(),e.writeAttributeString(void 0,"id",this.rNamespace,i),this.addHeaderFooter(r,"OddFooter",i),e.writeEndElement())}},e.prototype.addHeaderFooter=function(e,t,i){var r=new c;this.headersFooters.add(t,r),this.headersFooters.get(t).add(i,e)},e.prototype.serializeBodyItems=function(e,t,i){for(var r=0;r<t.length;r++)this.serializeBodyItem(e,t[r],i)},e.prototype.serializeBodyItem=function(e,i,r){if(t.isNullOrUndefined(i))throw new Error("BodyItem should not be undefined");if(i.hasOwnProperty("inlines"))this.paragraph=i,this.serializeParagraph(e,i,r),this.paragraph=void 0;else for(var n=i,o=0;o<n.rows.length;o++)if(n.rows[o].cells.length>0){this.serializeTable(e,n);break}},e.prototype.serializeParagraph=function(e,i,r){if(t.isNullOrUndefined(i))throw new Error("Paragraph should not be undefined");var n=this.blockOwner;!r&&n.hasOwnProperty("sectionFormat")&&n.blocks.indexOf(i)===n.blocks.length-1&&(e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeSectionProperties(e,n),e.writeEndElement(),e.writeEndElement()),e.writeStartElement("w","p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,i.paragraphFormat,i),e.writeEndElement(),this.serializeParagraphItems(e,i.inlines),e.writeEndElement()},e.prototype.serializeParagraphItems=function(e,t){for(var i=void 0,r=0;r<t.length;r++){var n=t[r];n.hasOwnProperty("fieldType")?this.serializeFieldCharacter(e,n):n.hasOwnProperty("imageString")?this.serializePicture(e,n):n.hasOwnProperty("bookmarkType")?this.serializeBookMark(e,n):this.serializeTextRange(e,n,i),i=n}},e.prototype.serializeBookMark=function(e,t){var i=this.getBookmarkId(t.name),r=t.name;0===t.bookmarkType?(e.writeStartElement("w","bookmarkStart",this.wNamespace),e.writeAttributeString("w","name",this.wNamespace,r)):1===t.bookmarkType&&e.writeStartElement("w","bookmarkEnd",this.wNamespace),e.writeAttributeString("w","id",this.wNamespace,i.toString()),e.writeEndElement()},e.prototype.getBookmarkId=function(e){var t=this.bookmarks.indexOf(e);return t<0&&(t=this.bookmarks.length,this.bookmarks.push(e)),t},e.prototype.serializePicture=function(e,t){t.width>=0&&t.height>=0&&(e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),this.serializeDrawing(e,t),e.writeEndElement())},e.prototype.serializeDrawing=function(e,t){e.writeStartElement(void 0,"drawing",this.wNamespace),this.serializeInlinePicture(e,t),e.writeEndElement()},e.prototype.serializeInlinePicture=function(e,t){e.writeStartElement(void 0,"inline",this.wpNamespace),e.writeStartElement(void 0,"extent",this.wpNamespace);var i=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,i.toString());var r=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,r.toString()),e.writeEndElement(),this.serializeDrawingGraphics(e,t),e.writeEndElement()},e.prototype.startsWith=function(e,t){return t.length>0&&e.substring(0,t.length)===t},e.prototype.serializeDrawingGraphics=function(e,t){var i="";i=this.updateShapeId(t),e.writeStartElement("wp","docPr",this.wpNamespace),e.writeAttributeString(void 0,"id",void 0,(this.mDocPrID++).toString()),e.writeAttributeString(void 0,"name",void 0,"1".toString()),e.writeAttributeString(void 0,"title",void 0,""),e.writeEndElement(),e.writeStartElement("a","graphic",this.aNamespace),e.writeStartElement("a","graphicData",this.aNamespace),e.writeAttributeString(void 0,"uri",void 0,this.pictureNamespace),e.writeStartElement("pic","pic",this.pictureNamespace),e.writeStartElement("pic","nvPicPr",this.pictureNamespace),e.writeStartElement("pic","cNvPr",this.pictureNamespace),e.writeAttributeString(void 0,"id",void 0,"0"),e.writeAttributeString(void 0,"name",void 0,""),e.writeAttributeString(void 0,"descr",void 0,""),e.writeEndElement(),e.writeStartElement("pic","cNvPicPr",this.pictureNamespace),e.writeStartElement("a","picLocks",this.aNamespace),e.writeAttributeString(void 0,"noChangeAspect",void 0,"1"),e.writeAttributeString(void 0,"noChangeArrowheads",void 0,"1"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","blipFill",this.pictureNamespace),e.writeStartElement("a","blip",this.aNamespace),this.startsWith(t.imageString,"data:image")?e.writeAttributeString("r","embed",this.rNamespace,i):this.documentImages.containsKey(i)&&(this.documentImages.remove(i),this.externalImages.add(i,t.imageString),e.writeAttributeString(void 0,"link",this.rNamespace,i)),e.writeEndElement(),e.writeStartElement("a","srcRect",this.aNamespace),e.writeEndElement(),e.writeStartElement("a","stretch",this.aNamespace),e.writeStartElement("a","fillRect",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("pic","spPr",this.pictureNamespace),e.writeAttributeString(void 0,"bwMode",void 0,"auto"),e.writeStartElement("a","xfrm",this.aNamespace),e.writeStartElement("a","off",this.aNamespace),e.writeAttributeString(void 0,"x",void 0,"0"),e.writeAttributeString(void 0,"y",void 0,"0"),e.writeEndElement(),e.writeStartElement("a","ext",this.aNamespace);var r=Math.round(t.width*this.emusPerPoint);e.writeAttributeString(void 0,"cx",void 0,r.toString());var n=Math.round(t.height*this.emusPerPoint);e.writeAttributeString(void 0,"cy",void 0,n.toString()),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("a","prstGeom",this.aNamespace),e.writeAttributeString(void 0,"prst",void 0,"rect"),e.writeStartElement("a","avLst",this.aNamespace),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement(),e.writeEndElement()},e.prototype.updateShapeId=function(e){var t="",i=this.paragraph;return this.headerFooter?t=this.updateHFImageRels(this.headerFooter,e):""===t&&(i.hasOwnProperty("sectionFormat")||i.hasOwnProperty("inlines"))&&(t=this.addImageRelation(this.documentImages,e)),t},e.prototype.addImageRelation=function(e,t){var i="";return i=this.getNextRelationShipID(),e.add(i,t),i},e.prototype.updateHFImageRels=function(e,t){for(var i="",r="",n=this.headersFooters.keys,o=0;o<n.length;o++)for(var a=this.headersFooters.get(n[o]),s=a.keys,l=0;l<s.length;l++)if(a.get(s[l])===e){r=s[l];var d=void 0;this.headerFooterImages.containsKey(r)?(d=this.headerFooterImages.get(r),i=this.addImageRelation(d,t)):(d=new c,i=this.addImageRelation(d,t),this.headerFooterImages.add(r,d))}return i},e.prototype.serializeTable=function(e,t){if(!(t.rows.length<=0)){var i=this.table;this.table=t,e.writeStartElement(void 0,"tbl",this.wNamespace);var r=t.rows[0].rowFormat;this.serializeTableFormat(e,r,t),this.serializeTableGrid(e,t),this.serializeTableRows(e,t.rows),e.writeEndElement(),this.table=i}},e.prototype.serializeTableGrid=function(e,t){e.writeStartElement(void 0,"tblGrid",this.wNamespace),0!==t.grid.length&&this.serializeGridColumns(e,t.grid),e.writeEndElement()},e.prototype.serializeTableRows=function(e,t){if(t.length>0)for(var i=0;i<t.length;i++){var r=t[i];r.cells.length>0&&this.serializeRow(e,r)}},e.prototype.serializeRow=function(e,t){var i=this.row;this.row=t,e.writeStartElement(void 0,"tr",this.wNamespace),this.serializeRowFormat(e,t),this.serializeCells(e,t.cells),e.writeEndElement(),this.row=i},e.prototype.serializeRowFormat=function(e,t){if(e.writeStartElement(void 0,"trPr",this.wNamespace),t.rowFormat.height>0){e.writeStartElement(void 0,"trHeight",this.wNamespace),"Exactly"===t.rowFormat.heightType?e.writeAttributeString("w","hRule",this.wNamespace,"exact"):"AtLeast"===t.rowFormat.heightType&&e.writeAttributeString("w","hRule",this.wNamespace,"atLeast");var i=this.roundToTwoDecimal(t.rowFormat.height*this.twentiethOfPoint).toString();e.writeAttributeString("w","val",this.wNamespace,i),e.writeEndElement()}var r=t.rowFormat,n=r.gridBefore;n>0&&(e.writeStartElement(void 0,"gridBefore",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,n.toString()),e.writeEndElement());var o=r.gridAfter;if(o>0&&(e.writeStartElement(void 0,"gridAfter",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,o.toString()),e.writeEndElement()),n>0){switch(e.writeStartElement(void 0,"wBefore",this.wNamespace),r.gridBeforeWidthType){case"Percent":a=this.roundToTwoDecimal(r.gridBeforeWidth*this.percentageFactor).toString();e.writeAttributeString("w","val",this.wNamespace,a),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":s=this.roundToTwoDecimal(r.gridBeforeWidth*this.twipsInOnePoint).toString();e.writeAttributeString("w","val",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}if(o>0){switch(e.writeStartElement(void 0,"wAfter",this.wNamespace),r.gridAfterWidthType){case"Percent":var a=this.roundToTwoDecimal(r.gridAfterWidth*this.percentageFactor).toString();e.writeAttributeString("w","val",this.wNamespace,a),e.writeAttributeString("w","type",this.wNamespace,"pct");break;case"Point":var s=this.roundToTwoDecimal(r.gridAfterWidth*this.twipsInOnePoint).toString();e.writeAttributeString("w","val",this.wNamespace,s),e.writeAttributeString("w","type",this.wNamespace,"dxa")}e.writeEndElement()}r.allowBreakAcrossPages||(e.writeStartElement(void 0,"cantSplit",this.wNamespace),e.writeEndElement()),r.isHeader&&(e.writeStartElement(void 0,"tblHeader",this.wNamespace),e.writeEndElement()),e.writeEndElement()},e.prototype.serializeCells=function(e,t){for(var i=0;i<t.length;i++)this.serializeCell(e,t[i])},e.prototype.serializeCell=function(e,t){var i=this.blockOwner;if(this.blockOwner=t,e.writeStartElement(void 0,"tc",this.wNamespace),this.serializeCellFormat(e,t.cellFormat),t.blocks.length>0)for(var r=0,n=void 0;r<t.blocks.length;)n=t.blocks[r],this.serializeBodyItem(e,n,!1),r+=1;else e.writeStartElement(void 0,"p",this.wNamespace),e.writeStartElement(void 0,"pPr",this.wNamespace),e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"Normal"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();e.writeEndElement(),this.blockOwner=i},e.prototype.serializeCellFormat=function(e,t){var i=this.blockOwner;this.table.tableFormat,this.row.rowFormat;e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.serializeCellMerge(e,t),this.serializeGridSpan(e,i),e.writeStartElement(void 0,"tcBorders",this.wNamespace),this.serializeBorders(e,t.borders,8),e.writeEndElement(),this.serializeShading(e,i.cellFormat.shading),this.serializeTableCellDirection(e,t),this.serializeCellVerticalAlign(e,t.verticalAlignment),e.writeEndElement()},e.prototype.serializeCellWidth=function(e,t){var i=t.cellFormat;e.writeStartElement(void 0,"tcW",this.wNamespace),"Percent"===i.preferredWidthType?(e.writeAttributeString(void 0,"type",this.wNamespace,"pct"),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(i.preferredWidth*this.percentageFactor).toString())):"Point"===i.preferredWidthType?(e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(i.preferredWidth*this.twipsInOnePoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")):(e.writeAttributeString(void 0,"type",this.wNamespace,"auto"),e.writeAttributeString(void 0,"w",this.wNamespace,"0")),e.writeEndElement()},e.prototype.serializeCellMerge=function(e,t){var i,r=this.blockOwner,n=!1,o=r.columnIndex,a=this.row.cells.indexOf(r),s=a>0?this.row.cells[a-1].columnIndex:r.columnIndex;if(r.columnIndex===a?(i=r.columnIndex,n=!0):n=!1,!n){0===a&&(o=r.columnIndex,s=-1);for(var l=s;l<o;l++)i=s+1,s+=1,this.mVerticalMerge.containsKey(i)&&this.createMerge(e,i,r)}t.rowSpan>1?(e.writeStartElement(void 0,"vMerge",this.wNamespace),this.mVerticalMerge.add(i,t.rowSpan-1),t.columnSpan>1&&this.mGridSpans.add(i,t.columnSpan),e.writeAttributeString("w","val",this.wNamespace,"restart"),e.writeEndElement()):this.mVerticalMerge.containsKey(i)&&n?this.createMerge(e,i,r):this.mVerticalMerge.containsKey(a+1)&&n&&void 0===r.nextNode&&(i=r.columnIndex+1,e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeColumnSpan(i,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),this.checkMergeCell(i))},e.prototype.createMerge=function(e,t,i){this.serializeColumnSpan(t,e),e.writeStartElement(void 0,"vMerge",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"continue"),e.writeEndElement(),e.writeEndElement(),e.writeStartElement("w","p",this.wNamespace),e.writeEndElement(),e.writeEndElement(),e.writeStartElement(void 0,"tc",this.wNamespace),e.writeStartElement(void 0,"tcPr",this.wNamespace),this.serializeCellWidth(e,i),this.checkMergeCell(t)},e.prototype.serializeColumnSpan=function(e,t){this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&(t.writeStartElement(void 0,"gridSpan",this.wNamespace),t.writeAttributeString("w","val",this.wNamespace,this.mGridSpans.get(e).toString()),t.writeEndElement())},e.prototype.checkMergeCell=function(e){this.mVerticalMerge.get(e)-1==0?(this.mVerticalMerge.remove(e),this.mGridSpans.keys.length>0&&this.mGridSpans.containsKey(e)&&this.mGridSpans.remove(e)):this.mVerticalMerge.set(e,this.mVerticalMerge.get(e)-1)},e.prototype.serializeGridSpan=function(e,t){if(t.cellFormat.columnSpan>1){var i=t.cellFormat.columnSpan;e.writeStartElement(void 0,"gridSpan",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.toString()),e.writeEndElement()}},e.prototype.serializeTableCellDirection=function(e,t){},e.prototype.serializeCellVerticalAlign=function(e,t){switch(e.writeStartElement(void 0,"vAlign",this.wNamespace),t){case"Top":e.writeAttributeString("w","val",this.wNamespace,"top");break;case"Center":e.writeAttributeString("w","val",this.wNamespace,"center");break;default:e.writeAttributeString("w","val",this.wNamespace,"bottom")}e.writeEndElement()},e.prototype.serializeGridColumns=function(e,t){for(var i=1,r=t.length;i<r;i++){var n=Math.round(20*t[i]);e.writeStartElement(void 0,"gridCol",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,n.toString()),e.writeEndElement()}},e.prototype.serializeTableFormat=function(e,i,r){e.writeStartElement(void 0,"tblPr",this.wNamespace),this.serializeTableWidth(e,r),this.serializeTableAlignment(e,r.tableFormat),this.serializeCellSpacing(e,r.tableFormat),this.serializeTableIndentation(e,r.tableFormat),this.serializeTableBorders(e,r.tableFormat),this.serializeShading(e,r.tableFormat.shading),this.serializeTblLayout(e,r.tableFormat),t.isNullOrUndefined(r)||e.writeEndElement()},e.prototype.serializeShading=function(e,t){e.writeStartElement(void 0,"shd",this.wNamespace),e.writeAttributeString(void 0,"fill",this.wNamespace,this.getColor(t.backgroundColor)),"empty"===t.foregroundColor?e.writeAttributeString(void 0,"color",this.wNamespace,"auto"):e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.foregroundColor)),e.writeAttributeString("w","val",this.wNamespace,this.getTextureStyle(t.textureStyle)),e.writeEndElement()},e.prototype.getTextureStyle=function(e){switch(e){case"Texture5Percent":case"Texture2Pt5Percent":case"Texture7Pt5Percent":return"pct5";case"Texture10Percent":return"pct10";case"Texture12Pt5Percent":return"pct12";case"Texture15Percent":case"Texture17Pt5Percent":return"pct15";case"Texture20Percent":case"Texture22Pt5Percent":return"pct20";case"Texture25Percent":case"Texture27Pt5Percent":return"pct25";case"Texture30Percent":case"Texture32Pt5Percent":return"pct30";case"Texture35Percent":return"pct35";case"Texture37Pt5Percent":return"pct37";case"Texture40Percent":case"Texture42Pt5Percent":return"pct40";case"Texture45Percent":case"Texture47Pt5Percent":return"pct45";case"Texture50Percent":case"Texture52Pt5Percent":return"pct50";case"Texture55Percent":case"Texture57Pt5Percent":return"pct55";case"Texture60Percent":return"pct60";case"Texture62Pt5Percent":return"pct62";case"Texture65Percent":case"Texture67Pt5Percent":return"pct65";case"Texture70Percent":case"Texture72Pt5Percent":return"pct70";case"Texture75Percent":case"Texture77Pt5Percent":return"pct75";case"Texture80Percent":case"Texture82Pt5Percent":return"pct80";case"Texture85Percent":return"pct85";case"Texture87Pt5Percent":return"pct87";case"Texture90Percent":case"Texture92Pt5Percent":return"pct90";case"Texture95Percent":case"Texture97Pt5Percent":return"pct95";case"TextureCross":return"thinHorzCross";case"TextureDarkCross":return"horzCross";case"TextureDarkDiagonalCross":return"diagCross";case"TextureDarkDiagonalDown":return"reverseDiagStripe";case"TextureDarkDiagonalUp":return"diagStripe";case"TextureDarkHorizontal":return"horzStripe";case"TextureDarkVertical":return"vertStripe";case"TextureDiagonalCross":return"thinDiagCross";case"TextureDiagonalDown":return"thinReverseDiagStripe";case"TextureDiagonalUp":return"thinDiagStripe";case"TextureHorizontal":return"thinHorzStripe";case"TextureSolid":return"solid";case"TextureVertical":return"thinVertStripe";default:return"clear"}},e.prototype.serializeTableBorders=function(e,t){t.borders;e.writeStartElement(void 0,"tblBorders",this.wNamespace),this.serializeBorders(e,t.borders,8),e.writeEndElement()},e.prototype.serializeBorders=function(e,t,i){this.serializeBorder(e,t.top,"top",i),this.serializeBorder(e,t.left,"left",i),this.serializeBorder(e,t.bottom,"bottom",i),this.serializeBorder(e,t.right,"right",i),this.serializeBorder(e,t.horizontal,"insideH",i),this.serializeBorder(e,t.vertical,"insideV",i),this.serializeBorder(e,t.diagonalDown,"tl2br",i),this.serializeBorder(e,t.diagonalUp,"tr2bl",i)},e.prototype.serializeTblLayout=function(e,t){},e.prototype.serializeBorder=function(e,t,i,r){var n=t.lineStyle,o=t.lineWidth*r,a=t.space;if("Cleared"===n)return e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"nil"),void e.writeEndElement();"None"===n&&!t.hasNoneStyle||o<=0||(e.writeStartElement(void 0,i,this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getBorderStyle(n)),e.writeAttributeString(void 0,"color",this.wNamespace,this.getColor(t.color)),e.writeAttributeString(void 0,"sz",this.wNamespace,this.roundToTwoDecimal(o).toString()),e.writeAttributeString(void 0,"space",this.wNamespace,a.toString()),t.shadow&&e.writeAttributeString(void 0,"shadow",this.wNamespace,"on"),e.writeEndElement())},e.prototype.getBorderStyle=function(e){switch(e){case"Cleared":return"cleared";case"DashSmallGap":return"dashSmallGap";case"Triple":return"triple";case"Dot":return"dotted";case"DashDot":return"dotDash";case"DashLargeGap":return"dashed";case"DashDotDot":return"dotDotDash";case"Double":return"double";case"ThinThickSmallGap":return"thinThickSmallGap";case"ThickThinSmallGap":return"thickThinSmallGap";case"ThinThickThinSmallGap":return"thinThickThinSmallGap";case"ThickThinMediumGap":return"thickThinMediumGap";case"ThinThickMediumGap":return"thinThickMediumGap";case"ThinThickThinMediumGap":return"thinThickThinMediumGap";case"ThickThinLargeGap":return"thickThinLargeGap";case"ThinThickLargeGap":return"thinThickLargeGap";case"ThinThickThinLargeGap":return"thinThickThinLargeGap";case"Thick":return"thick";case"SingleWavy":return"wave";case"DoubleWavy":return"doubleWave";case"DashDotStroked":return"dashDotStroked";case"Engrave3D":return"threeDEngrave";case"Emboss3D":return"threeDEmboss";case"Outset":return"outset";case"Inset":return"inset";default:return"single"}},e.prototype.serializeTableIndentation=function(e,t){e.writeStartElement(void 0,"tblInd",this.wNamespace);var i=Math.round(t.leftIndent*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement()},e.prototype.serializeCellSpacing=function(e,i){!t.isNullOrUndefined(i.cellSpacing)&&i.cellSpacing>=0&&(e.writeStartElement(void 0,"tblCellSpacing",this.wNamespace),e.writeAttributeString(void 0,"w",this.wNamespace,this.roundToTwoDecimal(i.cellSpacing*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa"),e.writeEndElement())},e.prototype.serializeTableWidth=function(e,t){if(e.writeStartElement(void 0,"tblW",this.wNamespace),"Percent"===t.tableFormat.preferredWidthType)e.writeAttributeString(void 0,"w",this.wNamespace,(t.tableFormat.preferredWidth*this.percentageFactor).toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"pct");else if("Point"===t.tableFormat.preferredWidthType){var i=Math.round(t.tableFormat.preferredWidth*this.twipsInOnePoint);e.writeAttributeString(void 0,"w",this.wNamespace,i.toString()),e.writeAttributeString(void 0,"type",this.wNamespace,"dxa")}else e.writeAttributeString(void 0,"w",this.wNamespace,"0"),e.writeAttributeString(void 0,"type",this.wNamespace,"auto");e.writeEndElement()},e.prototype.serializeTableAlignment=function(e,t){switch(e.writeStartElement(void 0,"jc",this.wNamespace),t.tableAlignment){case"Right":e.writeAttributeString("w","val",this.wNamespace,"right");break;case"Center":e.writeAttributeString("w","val",this.wNamespace,"center");break;default:e.writeAttributeString("w","val",this.wNamespace,"left")}e.writeEndElement()},e.prototype.serializeFieldCharacter=function(e,t){e.writeStartElement(void 0,"r",this.wNamespace),this.serializeCharacterFormat(e,t.characterFormat),e.writeStartElement(void 0,"fldChar",this.wNamespace);var i=0===t.fieldType?"begin":1===t.fieldType?"end":"separate";e.writeAttributeString(void 0,"fldCharType",this.wNamespace,i),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeTextRange=function(e,i,r){if(e.writeStartElement("w","r",this.wNamespace),this.serializeCharacterFormat(e,i.characterFormat),"\t"===i.text)e.writeElementString(void 0,"tab",this.wNamespace,void 0);else if("\v"===i.text)e.writeElementString(void 0,"br",this.wNamespace,void 0);else if("\f"===i.text)e.writeStartElement(void 0,"br",this.wNamespace),e.writeAttributeString("w","type",this.wNamespace,"page"),e.writeEndElement();else{var n=!t.isNullOrUndefined(r)&&r.hasOwnProperty("fieldType")&&2!==r.fieldType;e.writeStartElement(void 0,n?"instrText":"t",this.wNamespace),e.writeAttributeString("xml","space",this.xmlNamespace,"preserve"),e.writeString(i.text),e.writeEndElement()}e.writeEndElement()},e.prototype.serializeParagraphFormat=function(e,i,r){t.isNullOrUndefined(i.styleName)||(e.writeStartElement(void 0,"pStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.styleName),e.writeEndElement()),t.isNullOrUndefined(r)?this.serializeListFormat(e,i.listFormat):this.serializeListFormat(e,r.paragraphFormat.listFormat),this.serializeParagraphSpacing(e,i),this.serializeIndentation(e,i),this.serializeParagraphAlignment(e,i.textAlignment),!t.isNullOrUndefined(i.tabs)&&i.tabs.length>0&&this.serializeTabs(e,i.tabs)},e.prototype.serializeTabs=function(e,t){e.writeStartElement("w","tabs",this.wNamespace);for(var i=0;i<t.length;i++)this.serializeTab(e,t[i]);e.writeEndElement()},e.prototype.serializeTab=function(e,i){var r=0;e.writeStartElement("w","tab",this.wNamespace),0===i.position&&0!==i.deletePosition?(r=i.deletePosition*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,"clear")):(r=i.position*this.twentiethOfPoint,e.writeAttributeString("w","val",this.wNamespace,this.getTabJustification(i.tabJustification))),t.isNullOrUndefined(i.tabLeader)||"None"===i.tabLeader||e.writeAttributeString("w","leader",this.wNamespace,this.getTabLeader(i.tabLeader)),e.writeAttributeString("w","pos",this.wNamespace,r.toString()+""),e.writeEndElement()},e.prototype.getTabLeader=function(e){switch(e){case"Dot":return"dot";case"Hyphen":return"hyphen";case"Underscore":return"underscore";default:return"none"}},e.prototype.getTabJustification=function(e){switch(e){case"Bar":return"bar";case"Center":return"center";case"Decimal":return"decimal";case"Left":return"left";case"List":return"num";case"Right":return"right";default:return"clear"}},e.prototype.serializeListFormat=function(e,i){t.isNullOrUndefined(i.listId)&&t.isNullOrUndefined(i.listLevelNumber)||(e.writeStartElement(void 0,"numPr",this.wNamespace),t.isNullOrUndefined(i.listLevelNumber)||-1===i.listLevelNumber||(e.writeStartElement(void 0,"ilvl",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.listLevelNumber.toString()),e.writeEndElement()),t.isNullOrUndefined(i.listId)||-1===i.listId||(e.writeStartElement(void 0,"numId",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,(i.listId+1).toString()),e.writeEndElement()),e.writeEndElement())},e.prototype.serializeParagraphAlignment=function(e,i){if(!t.isNullOrUndefined(i)){e.writeStartElement(void 0,"jc",this.wNamespace);var r=void 0;switch(i){case"Center":r="center";break;case"Right":r="right";break;case"Justify":r="both";break;default:r="left"}e.writeAttributeString("w","val",this.wNamespace,r),e.writeEndElement()}},e.prototype.serializeParagraphSpacing=function(e,i){switch(e.writeStartElement(void 0,"spacing",this.wNamespace),t.isNullOrUndefined(i.beforeSpacing)||e.writeAttributeString(void 0,"before",this.wNamespace,this.roundToTwoDecimal(i.beforeSpacing*this.twentiethOfPoint).toString()),t.isNullOrUndefined(i.afterSpacing)||e.writeAttributeString(void 0,"after",this.wNamespace,this.roundToTwoDecimal(i.afterSpacing*this.twentiethOfPoint).toString()),e.writeAttributeString(void 0,"line",this.wNamespace,"240"),i.lineSpacingType){case"AtLeast":e.writeAttributeString(void 0,"lineRule",this.wNamespace,"atLeast");break;case"Exactly":e.writeAttributeString(void 0,"lineRule",this.wNamespace,"exact");break;default:e.writeAttributeString(void 0,"lineRule",this.wNamespace,"auto")}e.writeEndElement()},e.prototype.serializeIndentation=function(e,i){e.writeStartElement(void 0,"ind",this.wNamespace),t.isNullOrUndefined(i.leftIndent)||e.writeAttributeString(void 0,"left",this.wNamespace,this.roundToTwoDecimal(i.leftIndent*this.twipsInOnePoint).toString()),t.isNullOrUndefined(i.rightIndent)||e.writeAttributeString(void 0,"right",this.wNamespace,this.roundToTwoDecimal(i.rightIndent*this.twipsInOnePoint).toString()),t.isNullOrUndefined(i.firstLineIndent)||(i.firstLineIndent<0?e.writeAttributeString(void 0,"hanging",this.wNamespace,this.roundToTwoDecimal(-1*i.firstLineIndent*this.twipsInOnePoint).toString()):e.writeAttributeString(void 0,"firstLine",this.wNamespace,this.roundToTwoDecimal(i.firstLineIndent*this.twipsInOnePoint).toString())),e.writeEndElement()},e.prototype.serializeStyles=function(){var e=new i.XmlWriter;e.writeStartElement("w","styles",this.wNamespace),e.writeAttributeString("xmlns","mc",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","w",void 0,this.wNamespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),this.serializeDefaultStyles(e),this.serializeDocumentStyles(e),e.writeEndElement();var t=new a.ZipArchiveItem(e.buffer,this.stylePath);this.mArchive.addItem(t)},e.prototype.serializeDefaultStyles=function(e){e.writeStartElement(void 0,"docDefaults",this.wNamespace),e.writeStartElement(void 0,"rPrDefault",this.wNamespace),this.serializeCharacterFormat(e,this.defCharacterFormat),e.writeEndElement(),e.writeStartElement(void 0,"pPrDefault",this.wNamespace),t.isNullOrUndefined(this.defParagraphFormat)||(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,this.defParagraphFormat,void 0),e.writeEndElement()),e.writeEndElement(),e.writeEndElement()},e.prototype.serializeDocumentStyles=function(e){for(var i=0;i<this.mStyles.length;i++){var r=this.mStyles[i];e.writeStartElement(void 0,"style",this.wNamespace);var n="Paragraph"===r.type?"paragraph":"character";e.writeAttributeString("w","type",this.wNamespace,n),e.writeAttributeString("w","styleId",this.wNamespace,r.name),e.writeStartElement(void 0,"name",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r.name),e.writeEndElement(),t.isNullOrUndefined(r.basedOn)||(e.writeStartElement(void 0,"basedOn",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r.basedOn),e.writeEndElement()),t.isNullOrUndefined(r.next)||(e.writeStartElement(void 0,"next",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r.next),e.writeEndElement()),t.isNullOrUndefined(r.link)||(e.writeStartElement(void 0,"link",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,r.link),e.writeEndElement()),"Paragraph"===r.type&&(e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,r.paragraphFormat,void 0),e.writeEndElement()),this.serializeCharacterFormat(e,r.characterFormat),e.writeEndElement()}},e.prototype.serializeCharacterFormat=function(e,i){if(e.writeStartElement(void 0,"rPr",this.wNamespace),t.isNullOrUndefined(i.styleName)||(e.writeStartElement(void 0,"rStyle",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,i.styleName),e.writeEndElement()),t.isNullOrUndefined(i.fontFamily)||(e.writeStartElement(void 0,"rFonts",this.wNamespace),e.writeAttributeString(void 0,"ascii",this.wNamespace,i.fontFamily),e.writeAttributeString(void 0,"hAnsi",this.wNamespace,i.fontFamily),e.writeAttributeString(void 0,"eastAsia",this.wNamespace,i.fontFamily),e.writeAttributeString(void 0,"cs",this.wNamespace,i.fontFamily),e.writeEndElement()),t.isNullOrUndefined(i.bold)||this.serializeBoolProperty(e,"b",i.bold),t.isNullOrUndefined(i.italic)||this.serializeBoolProperty(e,"i",i.italic),!t.isNullOrUndefined(i.strikethrough))switch(i.strikethrough){case"SingleStrike":this.serializeBoolProperty(e,"strike",!0);break;case"DoubleStrike":this.serializeBoolProperty(e,"dstrike",!0);break;default:this.serializeBoolProperty(e,"strike",!1),this.serializeBoolProperty(e,"dstrike",!1)}if(t.isNullOrUndefined(i.fontColor)||(e.writeStartElement(void 0,"color",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getColor(i.fontColor)),e.writeEndElement()),t.isNullOrUndefined(i.fontSize)||(e.writeStartElement(void 0,"sz",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.roundToTwoDecimal(2*i.fontSize).toString()),e.writeEndElement()),t.isNullOrUndefined(i.highlightColor)||"NoColor"===i.highlightColor||(e.writeStartElement(void 0,"highlight",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getHighlightColor(i.highlightColor)),e.writeEndElement()),t.isNullOrUndefined(i.underline)||"None"===i.underline||(e.writeStartElement(void 0,"u",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,this.getUnderlineStyle(i.underline)),e.writeEndElement()),!t.isNullOrUndefined(i.baselineAlignment)){switch(e.writeStartElement(void 0,"vertAlign",this.wNamespace),i.baselineAlignment){case"Subscript":e.writeAttributeString("w","val",this.wNamespace,"subscript");break;case"Superscript":e.writeAttributeString("w","val",this.wNamespace,"superscript");break;default:e.writeAttributeString("w","val",this.wNamespace,"baseline")}e.writeEndElement()}e.writeEndElement()},e.prototype.getColor=function(e){return e.length>0&&("#"===e[0]&&(e=e.substr(1)),e.length>6&&(e=e.substr(0,6))),e},e.prototype.getUnderlineStyle=function(e){switch(e){case"DotDotDashHeavy":return"dashDotDotHeavy";case"DotDashHeavy":return"dashDotHeavy";case"DashHeavy":return"dashedHeavy";case"DashLong":return"dashLong";case"DashLongHeavy":return"dashLongHeavy";case"DotDash":return"dotDash";case"DotDotDash":return"dotDotDash";case"Dotted":return"dotted";case"DottedHeavy":return"dottedHeavy";case"Double":return"double";case"Single":return"single";case"Thick":return"thick";case"Wavy":return"wave";case"WavyDouble":return"wavyDouble";case"WavyHeavy":return"wavyHeavy";case"Words":return"words";default:return"dash"}},e.prototype.getHighlightColor=function(e){switch(e){case"BrightGreen":return"green";case"Turquoise":return"cyan";case"Pink":return"magenta";case"Blue":return"blue";case"Red":return"red";case"DarkBlue":return"darkBlue";case"Teal":return"darkCyan";case"Green":return"darkGreen";case"Violet":return"darkMagenta";case"DarkRed":return"darkRed";case"DarkYellow":return"darkYellow";case"Gray50":return"darkGray";case"Gray25":return"lightGray";case"Black":return"black";default:return"yellow"}},e.prototype.serializeBoolProperty=function(e,t,i){e.writeStartElement(void 0,t,this.wNamespace),i||e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()},e.prototype.serializeNumberings=function(){if(0!==this.document.lists.length){var e=new i.XmlWriter;e.writeStartElement("w","numbering",this.wNamespace),this.writeCommonAttributeStrings(e),this.serializeAbstractListStyles(e,this.document.abstractLists),this.serializeListInstances(e,this.document.lists),e.writeEndElement();var t=new a.ZipArchiveItem(e.buffer,this.numberingPath);this.mArchive.addItem(t)}},e.prototype.serializeAbstractListStyles=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e.writeStartElement(void 0,"abstractNum",this.wNamespace),e.writeAttributeString(void 0,"abstractNumId",this.wNamespace,r.abstractListId.toString()),e.writeStartElement(void 0,"nsid",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.generateHex()),e.writeEndElement();for(var n=0,o=r.levels.length;n<o;n++)this.serializeListLevel(e,r.levels[n],n);e.writeEndElement()}},e.prototype.serializeListInstances=function(e,t){for(var i=0;i<t.length;i++){var r=t[i];e.writeStartElement(void 0,"num",this.wNamespace),e.writeAttributeString(void 0,"numId",this.wNamespace,(r.listId+1).toString()),e.writeStartElement(void 0,"abstractNumId",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,r.abstractListId.toString()),e.writeEndElement(),e.writeEndElement()}},e.prototype.generateHex=function(){return(Math.floor(373e7*Math.random())+27e7).toString(16).toUpperCase()},e.prototype.roundToTwoDecimal=function(e){return Math.round(e)},e.prototype.serializeListLevel=function(e,t,i){e.writeStartElement(void 0,"lvl",this.wNamespace),e.writeAttributeString(void 0,"ilvl",this.wNamespace,i.toString()),e.writeStartElement(void 0,"start",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.startAt.toString()),e.writeEndElement(),e.writeStartElement(void 0,"numFmt",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,this.getLevelPattern(t.listLevelPattern)),e.writeEndElement(),t.restartLevel>0&&(e.writeStartElement(void 0,"lvlRestart",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,"0"),e.writeEndElement()),this.serializeLevelFollow(e,t),this.serializeLevelText(e,t,i+1),e.writeStartElement(void 0,"pPr",this.wNamespace),this.serializeParagraphFormat(e,t.paragraphFormat,void 0),e.writeEndElement(),this.serializeCharacterFormat(e,t.characterFormat),e.writeEndElement()},e.prototype.getLevelPattern=function(e){var t;switch(e){case"Arabic":t="decimal";break;case"UpRoman":t="upperRoman";break;case"LowRoman":t="lowerRoman";break;case"UpLetter":t="upperLetter";break;case"LowLetter":t="lowerLetter";break;default:t="bullet"}return t},e.prototype.serializeLevelText=function(e,t,i){e.writeStartElement(void 0,"lvlText",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,t.numberFormat),e.writeEndElement()},e.prototype.serializeLevelFollow=function(e,t){var i;i="Tab"===t.followCharacter?"tab":"Space"===t.followCharacter?"space":"nothing",e.writeStartElement(void 0,"suff",this.wNamespace),e.writeAttributeString(void 0,"val",this.wNamespace,i),e.writeEndElement()},e.prototype.serializeSettings=function(){var e=new i.XmlWriter;e.writeStartElement("w","settings",this.wNamespace),this.writeCustom(e),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","w14",void 0,this.w14Namespace),e.writeAttributeString("xmlns","w15",void 0,this.w15Namespace),e.writeAttributeString("xmlns","sl",void 0,this.slNamespace),e.writeAttributeString("mc","Ignorable",void 0,"w14 w15"),e.writeStartElement("w","zoom",this.wNamespace),e.writeAttributeString("w","val",this.wNamespace,"none"),e.writeAttributeString("w","percent",this.wNamespace,"100"),e.writeEndElement(),e.writeStartElement(void 0,"displayBackgroundShape",this.wNamespace),e.writeEndElement(),e.writeStartElement(void 0,"defaultTabStop",this.wNamespace);var t=Math.round(this.defaultTabWidthValue*this.twipsInOnePoint);e.writeAttributeString(void 0,"val",this.wNamespace,t.toString()),e.writeEndElement(),this.mDifferentFirstPage&&(e.writeStartElement(void 0,"evenAndOddHeaders",this.wNamespace),e.writeEndElement()),e.writeStartElement(void 0,"compat",this.wNamespace),e.writeStartElement(void 0,"compatSetting",this.wNamespace),e.writeAttributeString(void 0,"name",this.wNamespace,"compatibilityMode"),e.writeAttributeString(void 0,"uri",this.wNamespace,"http://schemas.microsoft.com/office/word"),e.writeAttributeString(void 0,"val",this.wNamespace,"15"),e.writeEndElement(),e.writeEndElement(),e.writeEndElement();var r=new a.ZipArchiveItem(e.buffer,this.settingsPath);this.mArchive.addItem(r)},e.prototype.serializeCoreProperties=function(){},e.prototype.serializeAppProperties=function(){},e.prototype.serializeFontTable=function(e){},e.prototype.serializeSettingsRelation=function(){},e.prototype.serializeHeaderFooters=function(){this.serializeHeaderFooter("EvenFooter"),this.serializeHeaderFooter("EvenHeader"),this.serializeHeaderFooter("FirstPageFooter"),this.serializeHeaderFooter("FirstPageHeader"),this.serializeHeaderFooter("OddFooter"),this.serializeHeaderFooter("OddHeader")},e.prototype.serializeHeaderFooter=function(e){if(0!==this.headersFooters.length){var t,i;if(this.headersFooters.containsKey(e))for(var r=this.headersFooters.get(e),n=void 0,o=0;o<r.keys.length;o++){var a=r.keys[o];n=r.get(a),"EvenHeader"===e||"FirstPageHeader"===e||"OddHeader"===e?(t=this.headerPath+a.replace("rId","")+".xml",i=this.headerRelationPath+a.replace("rId","")+".xml.rels",this.serializeHeader(n,a,t,i)):(t=this.footerPath+a.replace("rId","")+".xml",i=this.footerRelationPath+a.replace("rId","")+".xml.rels",this.serializeFooter(n,a,t,i))}}},e.prototype.serializeHeader=function(e,t,r,n){this.headerFooter=e;var o=new i.XmlWriter;o.writeStartElement("w","hdr",this.wNamespace),this.writeHFCommonAttributes(o);var s=this.blockOwner;this.blockOwner=e,this.serializeBodyItems(o,e.blocks,!0),this.blockOwner=s,o.writeEndElement();var l=new a.ZipArchiveItem(o.buffer,r);this.mArchive.addItem(l),this.serializeHFRelations(t,n),this.headerFooter=void 0},e.prototype.serializeHFRelations=function(e,t){if(this.headerFooterImages.containsKey(e)){var r=new i.XmlWriter;r.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeImagesRelations(this.headerFooterImages.get(e),r),r.writeEndElement();var n=new a.ZipArchiveItem(r.buffer,t);this.mArchive.addItem(n)}},e.prototype.writeHFCommonAttributes=function(e){e.writeAttributeString("xmlns","v",void 0,this.vNamespace),e.writeAttributeString("xmlns","w10",void 0,this.w10Namespace),e.writeAttributeString("xmlns","o",void 0,this.oNamespace),e.writeAttributeString("xmlns","ve",void 0,this.veNamespace),e.writeAttributeString("xmlns","r",void 0,this.rNamespace),e.writeAttributeString("xmlns","m",void 0,this.mNamespace),e.writeAttributeString("xmlns","wne",void 0,this.wneNamespace),e.writeAttributeString("xmlns","a",void 0,this.aNamespace),e.writeAttributeString("xmlns","pic",void 0,this.pictureNamespace),e.writeAttributeString("xmlns","wp",void 0,this.wpNamespace),e.writeAttributeString("xmlns","wpc",void 0,this.wpCanvasNamespace),e.writeAttributeString("xmlns","wp14",void 0,this.wpDrawingNamespace),this.writeDup(e),e.writeAttributeString("xmlns","wps",void 0,this.wpShapeNamespace),e.writeAttributeString("ve","Ignorable",void 0,"w14 w15 wp14")},e.prototype.serializeFooter=function(e,t,r,n){this.headerFooter=e;var o=new i.XmlWriter;o.writeStartElement("w","ftr",this.wNamespace),this.writeHFCommonAttributes(o),this.serializeBodyItems(o,e.blocks,!0),o.writeEndElement();var s=new a.ZipArchiveItem(o.buffer,r);this.mArchive.addItem(s),this.serializeHFRelations(t,n)},e.prototype.serializeDocumentRelations=function(){var e=new i.XmlWriter;e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.stylesRelType,"styles.xml"),this.serializeRelationShip(e,this.getNextRelationShipID(),this.settingsRelType,"settings.xml"),this.document.lists.length>0&&this.serializeRelationShip(e,this.getNextRelationShipID(),this.numberingRelType,"numbering.xml"),this.serializeHeaderFooterRelations(e),this.serializeImagesRelations(this.documentImages,e),e.writeEndElement();var t=new a.ZipArchiveItem(e.buffer,this.wordRelationPath);this.mArchive.addItem(t),this.headerFooter=void 0},e.prototype.serializeImagesRelations=function(e,i){if(e.length>0)for(var r="",n=void 0,o=e.keys,s=0;s<o.length;s++)if(n=e.get(o[s]).imageString,t.isNullOrUndefined(n))r=this.imagePath+"/0.jpeg",this.serializeRelationShip(i,o[s],this.imageRelType,r.replace("word/",""));else{var l="",d="";this.startsWith(n,"data:image/bmp;base64,")?(l=".bmp",d=n.replace("data:image/bmp;base64,","")):this.startsWith(n,"data:image/x-emf;base64,")?(l=".emf",d=n.replace("data:image/x-emf;base64,","")):this.startsWith(n,"data:image/exif;base64,")?(l=".exif",d=n.replace("data:image/exif;base64,","")):this.startsWith(n,"data:image/gif;base64,")?(l=".gif",d=n.replace("data:image/gif;base64,","")):this.startsWith(n,"data:image/icon;base64,")?(l=".ico",d=n.replace("data:image/icon;base64,","")):this.startsWith(n,"data:image/jpeg;base64,")?(l=".jpeg",d=n.replace("data:image/jpeg;base64,","")):this.startsWith(n,"data:image/jpg;base64,")?(l=".jpg",d=n.replace("data:image/jpg;base64,","")):this.startsWith(n,"data:image/png;base64,")?(l=".png",d=n.replace("data:image/png;base64,","")):this.startsWith(n,"data:image/tiff;base64,")?(l=".tif",d=n.replace("data:image/tiff;base64,","")):this.startsWith(n,"data:image/x-wmf;base64,")?(l=".wmf",d=n.replace("data:image/x-wmf;base64,","")):l=".jpeg",r=this.imagePath+o[s]+l,this.serializeRelationShip(i,o[s],this.imageRelType,r.replace("word/",""));var h=new Blob([this.encodedString(d)]),c=new a.ZipArchiveItem(h,r);this.mArchive.addItem(c)}},e.prototype.encodedString=function(e){var t,i,r,n,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,d=0,h=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&h--,e.charAt(e.length-2)===s.charAt(64)&&h--,h%1!=0)throw new Error("Invalid base64 input, bad content length.");for(var c=new Uint8Array(0|h);l<e.length;)t=s.indexOf(e.charAt(l++))<<2|(n=s.indexOf(e.charAt(l++)))>>4,i=(15&n)<<4|(o=s.indexOf(e.charAt(l++)))>>2,r=(3&o)<<6|(a=s.indexOf(e.charAt(l++))),c[d++]=t,64!==o&&(c[d++]=i),64!==a&&(c[d++]=r);return c},e.prototype.serializeExternalLinkImages=function(e){for(var t=this.externalImages.keys,i=0;i<this.externalImages.keys.length;i++)this.serializeRelationShip(e,t[i],this.imageRelType,this.externalImages.get(t[i]))},e.prototype.serializeHeaderFooterRelations=function(e){this.serializeHFRelation(e,"EvenFooter"),this.serializeHFRelation(e,"EvenHeader"),this.serializeHFRelation(e,"FirstPageFooter"),this.serializeHFRelation(e,"FirstPageHeader"),this.serializeHFRelation(e,"OddFooter"),this.serializeHFRelation(e,"OddHeader")},e.prototype.serializeHFRelation=function(e,t){var i,r="";if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),o=0;o<n.keys.length;o++){var a=n.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(r="header"+a.replace("rId","")+".xml",i=this.headerRelType):(r="footer"+a.replace("rId","")+".xml",i=this.footerRelType),this.serializeRelationShip(e,a,i,r)}},e.prototype.serializeRelationShip=function(e,t,i,r){e.writeStartElement(void 0,"Relationship",void 0),e.writeAttributeString(void 0,"Id",void 0,t),e.writeAttributeString(void 0,"Type",void 0,i),e.writeAttributeString(void 0,"Target",void 0,r.replace("\\","/").replace("\v","")),(i===this.hyperlinkRelType||this.startsWith(r,"http://")||this.startsWith(r,"https://")||this.startsWith(r,"file:///"))&&e.writeAttributeString(void 0,"TargetMode",void 0,"External"),e.writeEndElement()},e.prototype.getNextRelationShipID=function(){return"rId"+ ++this.mRelationShipID},e.prototype.serializeGeneralRelations=function(){var e=new i.XmlWriter;this.resetRelationShipID(),e.writeStartElement(void 0,"Relationships",this.rpNamespace),this.serializeRelationShip(e,this.getNextRelationShipID(),this.documentRelType,this.documentPath),e.writeEndElement();var t=new a.ZipArchiveItem(e.buffer,this.generalRelationPath);this.mArchive.addItem(t)},e.prototype.serializeContentTypes=function(e){var t=new i.XmlWriter;t.writeStartElement(void 0,"Types","http://schemas.openxmlformats.org/package/2006/content-types"),this.serializeDefaultContentType(t,"rels",this.relationContentType),this.serializeDefaultContentType(t,"xml",this.xmlContentType),(this.documentImages.length>0||this.externalImages.length>0||this.headerFooterImages.length>0)&&(this.serializeDefaultContentType(t,"png","image/png"),this.serializeDefaultContentType(t,"bmp","image/bmp"),this.serializeDefaultContentType(t,"emf","image/x-emf"),this.serializeDefaultContentType(t,"wmf","image/x-wmf"),this.serializeDefaultContentType(t,"gif","image/gif"),this.serializeDefaultContentType(t,"ico","image/x-icon"),this.serializeDefaultContentType(t,"tif","image/tiff"),this.serializeDefaultContentType(t,"tiff","image/tiff"),this.serializeDefaultContentType(t,"jpeg","image/jpeg"),this.serializeDefaultContentType(t,"jpg","image/jpeg"),this.serializeDefaultContentType(t,"svg","image/svg+xml")),this.serializeOverrideContentType(t,this.documentPath,this.documentContentType),this.serializeOverrideContentType(t,this.numberingPath,this.numberingContentType),this.serializeOverrideContentType(t,this.stylePath,this.stylesContentType),this.serializeOverrideContentType(t,this.settingsPath,this.settingsContentType),this.serializeHFContentTypes(t),t.writeEndElement();var r=new a.ZipArchiveItem(t.buffer,this.contentTypesPath);this.mArchive.addItem(r)},e.prototype.serializeHFContentTypes=function(e){this.serializeHeaderFootersContentType(e,"EvenFooter"),this.serializeHeaderFootersContentType(e,"EvenHeader"),this.serializeHeaderFootersContentType(e,"FirstPageFooter"),this.serializeHeaderFootersContentType(e,"FirstPageHeader"),this.serializeHeaderFootersContentType(e,"OddFooter"),this.serializeHeaderFootersContentType(e,"OddHeader")},e.prototype.serializeHeaderFootersContentType=function(e,t){var i,r;if(this.headersFooters.containsKey(t))for(var n=this.headersFooters.get(t),o=0;o<n.keys.length;o++){var a=n.keys[o];"EvenHeader"===t||"FirstPageHeader"===t||"OddHeader"===t?(r=this.headerPath+a.replace("rId","")+".xml",i=this.headerContentType):(r=this.footerPath+a.replace("rId","")+".xml",i=this.footerContentType),this.serializeOverrideContentType(e,r,i)}},e.prototype.serializeOverrideContentType=function(e,t,i){e.writeStartElement(void 0,"Override",void 0),e.writeAttributeString(void 0,"PartName",void 0,"/"+t.replace("\\","/")),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.serializeDefaultContentType=function(e,t,i){e.writeStartElement(void 0,"Default",void 0),e.writeAttributeString(void 0,"Extension",void 0,t),e.writeAttributeString(void 0,"ContentType",void 0,i),e.writeEndElement()},e.prototype.resetRelationShipID=function(){this.mRelationShipID=0},e.prototype.close=function(){},e}(),rt=function(){function e(){this.text="",this.curSectionIndex=0,this.inField=!1}return e.prototype.getModuleName=function(){return"TextExport"},e.prototype.save=function(e,t){this.serialize(e);var r=new i.StreamWriter;this.writeInternal(r),r.save(t+".txt")},e.prototype.saveAsBlob=function(e){this.serialize(e);var t=new i.StreamWriter;this.writeInternal(t);var r=t.buffer;return t.destroy(),new Promise(function(e,t){e(r)})},e.prototype.serialize=function(e){var t=e.owner.sfdtExportModule.write();this.setDocument(t)},e.prototype.setDocument=function(e){this.document=e,this.mSections=e.sections},e.prototype.writeInternal=function(e){var t=void 0,i=this.document.sections.length-1,r=!1;this.updateLastParagraph();for(var n=0;n<=i;n++)t=this.document.sections[n],r=n===i,this.writeBody(e,t.blocks),this.writeNewLine(e),this.writeSectionEnd(t,r);for(var o=0;o<=i;o++)t=this.document.sections[o],this.writeHeadersFooters(e,t)},e.prototype.writeBody=function(e,t){for(var i=t.length-1,r=void 0,n=0;n<=i;n++)if((r=t[n]).hasOwnProperty("inlines")){var o=r===this.lastPara;this.writeParagraph(e,r,o)}else this.writeTable(e,r)},e.prototype.writeParagraph=function(e,t,i){for(var r=0;r<t.inlines.length;r++){var n=t.inlines[r];n.hasOwnProperty("fieldType")?this.inField=0===n.fieldType:n.hasOwnProperty("text")&&!this.inField&&this.writeText(e,n.text)}i||this.writeNewLine(e)},e.prototype.writeTable=function(e,t){for(var i=0;i<t.rows.length;i++)for(var r=t.rows[i],n=0;n<r.cells.length;n++){var o=r.cells[n];this.writeBody(e,o.blocks)}},e.prototype.writeHeadersFooters=function(e,i){var r=i.headersFooters;t.isNullOrUndefined(r)||(this.writeHeaderFooter(e,i.headersFooters.header),this.writeHeaderFooter(e,i.headersFooters.footer),this.writeHeaderFooter(e,i.headersFooters.evenFooter),this.writeHeaderFooter(e,i.headersFooters.evenHeader),this.writeHeaderFooter(e,i.headersFooters.firstPageHeader),this.writeHeaderFooter(e,i.headersFooters.firstPageFooter))},e.prototype.writeHeaderFooter=function(e,t){t&&t.blocks&&this.writeBody(e,t.blocks)},e.prototype.writeSectionEnd=function(e,t){this.curSectionIndex++},e.prototype.writeNewLine=function(e){e.writeLine("")},e.prototype.writeText=function(e,t){e.write(t)},e.prototype.updateLastParagraph=function(){var e,i=this.document.sections.length;if(i>0&&(e=this.document.sections[i-1]),!t.isNullOrUndefined(e)){for(var r=[],n=0;n<e.blocks.length;n++)e.blocks[n].hasOwnProperty("inlines")&&r.push(e.blocks[n]);var o=r.length;o>0&&(this.lastPara=r[o-1])}},e.prototype.destroy=function(){this.document=void 0,this.lastPara=void 0,this.mSections=void 0,this.sections=void 0},e}(),nt=function(){function e(e){this.endLine=void 0,this.endOffset=void 0,this.endCell=void 0,this.startColumnIndex=void 0,this.endColumnIndex=void 0,this.lists=void 0,this.viewer=void 0,this.document=void 0,this.writeInlineStyles=void 0,this.viewer=e}return e.prototype.getModuleName=function(){return"SfdtExport"},e.prototype.clear=function(){this.writeInlineStyles=void 0,this.endLine=void 0,this.lists=void 0,this.document=void 0},e.prototype.serialize=function(){return JSON.stringify(this.write())},e.prototype.saveAsBlob=function(e){var t=new i.StreamWriter;t.write(this.serialize());var r=t.buffer;return t.destroy(),new Promise(function(e,t){e(r)})},e.prototype.write=function(e,i,r,n,o){if(o&&(this.writeInlineStyles=!0),this.lists=[],this.document={},this.document.sections=[],this.document.characterFormat=this.writeCharacterFormat(this.viewer.characterFormat),this.document.paragraphFormat=this.writeParagraphFormat(this.viewer.paragraphFormat),e instanceof J&&r instanceof J){var a=e.paragraph,s=r.paragraph,l=a.associatedCell,d=s.associatedCell,h=(a.bodyWidget,this.createSection(e.paragraph.bodyWidget));if(this.document.sections.push(h),l===d||t.isNullOrUndefined(d))this.endLine=r,this.endOffset=n;else if(l instanceof Y){var c=l.getContainerTable(),p=d.getContainerTable();c.tableFormat===p.tableFormat&&(this.endCell=d,this.endColumnIndex=this.endCell.columnIndex+this.endCell.cellFormat.columnSpan,this.startColumnIndex=l.columnIndex)}else this.endCell=d;if(l===d||t.isNullOrUndefined(l)){var g=this.createParagraph(e.paragraph);h.blocks.push(g),this.writeParagraph(e.paragraph,g,h.blocks,e.indexInOwner,i)}else{var u=this.createTable(l.ownerTable);h.blocks.push(u),this.writeTable(l.ownerTable,u,l.ownerRow.indexInOwner,h.blocks)}}else if(this.viewer.pages.length>0){var f=this.viewer.pages[0];f.bodyWidgets.length>0&&this.writeBodyWidget(f.bodyWidgets[0],0)}this.writeStyles(this.viewer),this.writeLists(this.viewer);var m=this.document;return this.clear(),m},e.prototype.writeBodyWidget=function(e,t){if(!(e instanceof V))return!0;var i=this.createSection(e);if(this.document.sections.push(i),this.writeHeaderFooters(this.viewer.headersFooters[e.index],i),this.writeBlock(e.childWidgets[t],0,i.blocks))return!0;var r=e;do{e=r,r=r.nextRenderedWidget}while(r instanceof V&&r.index===e.index);return this.writeBodyWidget(r,t)},e.prototype.writeHeaderFooters=function(e,i){t.isNullOrUndefined(e)||(i.headersFooters.header=this.writeHeaderFooter(e[0]),i.headersFooters.footer=this.writeHeaderFooter(e[1]),i.headersFooters.evenHeader=this.writeHeaderFooter(e[2]),i.headersFooters.evenFooter=this.writeHeaderFooter(e[3]),i.headersFooters.firstPageHeader=this.writeHeaderFooter(e[4]),i.headersFooters.firstPageFooter=this.writeHeaderFooter(e[5]))},e.prototype.writeHeaderFooter=function(e){if(!t.isNullOrUndefined(e)){var i={};return e&&e.childWidgets&&e.childWidgets.length>0&&(i.blocks=[],this.writeBlock(e.firstChild,0,i.blocks)),i}},e.prototype.createSection=function(e){var t={};return t.sectionFormat={},t.sectionFormat.pageWidth=e.sectionFormat.pageWidth,t.sectionFormat.pageHeight=e.sectionFormat.pageHeight,t.sectionFormat.leftMargin=e.sectionFormat.leftMargin,t.sectionFormat.rightMargin=e.sectionFormat.rightMargin,t.sectionFormat.topMargin=e.sectionFormat.topMargin,t.sectionFormat.bottomMargin=e.sectionFormat.bottomMargin,t.sectionFormat.differentFirstPage=e.sectionFormat.differentFirstPage,t.sectionFormat.differentOddAndEvenPages=e.sectionFormat.differentOddAndEvenPages,t.sectionFormat.headerDistance=e.sectionFormat.headerDistance,t.sectionFormat.footerDistance=e.sectionFormat.footerDistance,t.blocks=[],t.headersFooters={},t},e.prototype.writeBlock=function(e,t,i){if(!(e instanceof j))return!0;if(e instanceof G){var r=this.createParagraph(e);if(i.push(r),this.writeParagraph(e,r,i))return!0}else{var n=e,o=this.createTable(n);if(i.push(o),this.writeTable(n,o,0,i))return!0}return!1},e.prototype.writeNextBlock=function(e,t){var i=e.nextRenderedWidget;return i instanceof j&&i.containerWidget.index===e.containerWidget.index&&this.writeBlock(e.nextRenderedWidget,0,t)},e.prototype.writeParagraph=function(e,i,r,n,o){t.isNullOrUndefined(n)&&(n=0),t.isNullOrUndefined(o)&&(o=0);for(var a=e;a instanceof G;){if(this.writeLines(a,n,o,i.inlines))return!0;n=0,o=0,a=(e=a).nextSplitWidget}return this.writeNextBlock(e,r)},e.prototype.writeInlines=function(e,i){for(var r=0;r<e.children.length;r++){var n=e.children[r];if(!(n instanceof ne)){var o=this.writeInline(n);t.isNullOrUndefined(o)||i.push(o)}}},e.prototype.writeInline=function(e){var t={};return t.characterFormat=this.writeCharacterFormat(e.characterFormat),e instanceof $?t.fieldType=e.fieldType:e instanceof re?(t.imageString=e.imageString,t.width=W.convertPixelToPoint(e.width),t.height=W.convertPixelToPoint(e.height)):e instanceof ie?(t.bookmarkType=e.bookmarkType,t.name=e.name):e instanceof Q?t.text=e.text:t=void 0,t},e.prototype.writeLines=function(e,t,i,r){for(var n=t,o=this.endLine instanceof J&&this.endLine.paragraph===e,a=o?this.endLine.indexInOwner:e.childWidgets.length-1,s=n;s<=a;s++){var l=e.childWidgets[s];this.endLine===l||t===s&&0!==i?this.writeLine(l,i,r):this.writeInlines(l,r)}return o},e.prototype.writeLine=function(e,t,i){for(var r=e===this.endLine,n=!1,o=!1,a=0,s=0;s<e.children.length;s++){var l=e.children[s];if(!(l instanceof ne)){var d=void 0;if(a+=l.length,n=a>t,o=r&&a>=this.endOffset,n){if(d=this.writeInline(l),i[i.length]=d,a>t||o){if(d.hasOwnProperty("text")){var h=a-l.length,c=t-h,p=o?this.endOffset-h:l.length;d.text=d.text.substring(c,p)}t=-1}if(o)break}}}},e.prototype.createParagraph=function(e){var t={};return t.paragraphFormat=this.writeParagraphFormat(e.paragraphFormat),t.characterFormat=this.writeCharacterFormat(e.characterFormat),t.inlines=[],t},e.prototype.writeCharacterFormat=function(e,t){var i={};return W.writeCharacterFormat(i,t,e),this.writeInlineStyles&&!t&&(i.inlineFormat=this.writeCharacterFormat(e,!0)),i},e.prototype.writeParagraphFormat=function(e,i){var r={};return r.leftIndent=i?e.leftIndent:e.getValue("leftIndent"),r.rightIndent=i?e.rightIndent:e.getValue("rightIndent"),r.firstLineIndent=i?e.firstLineIndent:e.getValue("firstLineIndent"),r.textAlignment=i?e.textAlignment:e.getValue("textAlignment"),r.beforeSpacing=i?e.beforeSpacing:e.getValue("beforeSpacing"),r.afterSpacing=i?e.afterSpacing:e.getValue("afterSpacing"),r.lineSpacing=i?e.lineSpacing:e.getValue("lineSpacing"),r.lineSpacingType=i?e.lineSpacingType:e.getValue("lineSpacingType"),r.styleName=t.isNullOrUndefined(e.baseStyle)?void 0:e.baseStyle.name,r.outlineLevel=i?e.outlineLevel:e.getValue("outlineLevel"),r.listFormat=this.writeListFormat(e.listFormat,i),r.tabs=this.writeTabs(e.tabs),this.writeInlineStyles&&!i&&(r.inlineFormat=this.writeParagraphFormat(e,!0)),r},e.prototype.writeTabs=function(e){if(!(t.isNullOrUndefined(e)||e.length<1)){for(var i=[],r=0;r<e.length;r++){var n=e[r],o={};o.position=n.position,o.deletePosition=n.deletePosition,o.tabJustification=n.tabJustification,o.tabLeader=n.tabLeader,i.push(o)}return i}},e.prototype.writeListFormat=function(e,i){var r={},n=e.getValue("listId");return!t.isNullOrUndefined(n)&&n>-1&&(r.listId=n,r.listLevelNumber=e.getValue("listLevelNumber"),this.lists.indexOf(e.listId)<0&&this.lists.push(e.listId)),r},e.prototype.writeTable=function(e,t,i,r){var n=e.childWidgets[i];if(n instanceof X&&this.writeRow(n,t.rows))return!0;var o=e;do{o=(e=o).nextSplitWidget}while(o instanceof j);return this.writeNextBlock(e,r)},e.prototype.writeRow=function(e,i){if(!(e instanceof X))return!1;var r=this.createRow(e);i.push(r);for(var n=0;n<e.childWidgets.length;n++){var o=e.childWidgets[n];if(o instanceof Y&&e.index===o.rowIndex&&(t.isNullOrUndefined(this.startColumnIndex)||o.columnIndex>=this.startColumnIndex)&&(t.isNullOrUndefined(this.endColumnIndex)||o.columnIndex<this.endColumnIndex)&&this.writeCell(o,r.cells))return!0}var a=e;do{a=(e=a).nextRenderedWidget}while(a instanceof X&&a.index===e.index);return this.writeRow(a,i)},e.prototype.writeCell=function(e,t){var i=this.createCell(e);return t.push(i),!!this.writeBlock(e.firstChild,0,i.blocks)||this.endCell instanceof Y&&this.endCell.cellFormat===e.cellFormat},e.prototype.createTable=function(e){var t={};t.rows=[],t.grid=[];for(var i=0;i<e.tableHolder.columns.length;i++)t.grid[i]=e.tableHolder.columns[i].preferredWidth;return t.tableFormat=this.writeTableFormat(e.tableFormat),t.description=e.description,t.title=e.title,t},e.prototype.createRow=function(e){var t={};return t.cells=[],t.rowFormat=this.writeRowFormat(e.rowFormat),t},e.prototype.createCell=function(e){var t={};return t.blocks=[],t.cellFormat=this.writeCellFormat(e.cellFormat),t.columnIndex=e.columnIndex,t},e.prototype.writeShading=function(e){var t={};return t.backgroundColor=e.backgroundColor,t.foregroundColor=e.foregroundColor,t.textureStyle=e.textureStyle,t},e.prototype.writeBorder=function(e){var t={};return t.color=e.color,t.hasNoneStyle=e.hasNoneStyle,t.lineStyle=e.lineStyle,t.lineWidth=e.lineWidth,t.shadow=e.shadow,t.space=e.space,t},e.prototype.writeBorders=function(e){var t={};return t.top=this.writeBorder(e.top),t.left=this.writeBorder(e.left),t.right=this.writeBorder(e.right),t.bottom=this.writeBorder(e.bottom),t.diagonalDown=this.writeBorder(e.diagonalDown),t.diagonalUp=this.writeBorder(e.diagonalUp),t.horizontal=this.writeBorder(e.horizontal),t.vertical=this.writeBorder(e.vertical),t},e.prototype.writeCellFormat=function(e){var t={};return t.borders=this.writeBorders(e.borders),t.shading=this.writeShading(e.shading),t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.leftMargin=e.leftMargin,t.bottomMargin=e.bottomMargin,t.preferredWidth=e.preferredWidth,t.preferredWidthType=e.preferredWidthType,t.cellWidth=e.cellWidth,t.columnSpan=e.columnSpan,t.rowSpan=e.rowSpan,t.verticalAlignment=e.verticalAlignment,t},e.prototype.writeRowFormat=function(e){var t={};return t.height=e.height,t.allowBreakAcrossPages=e.allowBreakAcrossPages,t.heightType=e.heightType,t.isHeader=e.isHeader,t.borders=this.writeBorders(e.borders),t.gridBefore=e.gridBefore,t.gridBeforeWidth=e.gridBeforeWidth,t.gridBeforeWidthType=e.gridBeforeWidthType,t.gridAfter=e.gridAfter,t.gridAfterWidth=e.gridAfterWidth,t.gridAfterWidthType=e.gridAfterWidthType,t},e.prototype.writeTableFormat=function(e){var t={};return t.borders=this.writeBorders(e.borders),t.shading=this.writeShading(e.shading),t.cellSpacing=e.cellSpacing,t.leftIndent=e.leftIndent,t.tableAlignment=e.tableAlignment,t.topMargin=e.topMargin,t.rightMargin=e.rightMargin,t.leftMargin=e.leftMargin,t.bottomMargin=e.bottomMargin,t.preferredWidth=e.preferredWidth,t.preferredWidthType=e.preferredWidthType,t},e.prototype.writeStyles=function(e){this.document.styles=[];for(var t=0;t<e.styles.length;t++)this.document.styles.push(this.writeStyle(e.styles.getItem(t)))},e.prototype.writeStyle=function(e){var i={};return i.name=e.name,"Paragraph"===e.type&&(i.type="Paragraph",i.paragraphFormat=this.writeParagraphFormat(e.paragraphFormat),i.characterFormat=this.writeCharacterFormat(e.characterFormat)),"Character"===e.type&&(i.type="Character",i.characterFormat=this.writeCharacterFormat(e.characterFormat)),t.isNullOrUndefined(e.basedOn)||(i.basedOn=e.basedOn.name),t.isNullOrUndefined(e.link)||(i.link=e.link.name),t.isNullOrUndefined(e.next)||(i.next=e.next.name),i},e.prototype.writeLists=function(e){var t=[];this.document.lists=[];for(r=0;r<e.lists.length;r++){var i=e.lists[r];this.lists.indexOf(i.listId)>-1&&(this.document.lists.push(this.writeList(i)),t.indexOf(i.abstractListId)<0&&t.push(i.abstractListId))}this.document.abstractLists=[];for(var r=0;r<e.abstractLists.length;r++){var n=e.abstractLists[r];this.lists.indexOf(n.abstractListId)>-1&&this.document.abstractLists.push(this.writeAbstractList(n))}},e.prototype.writeAbstractList=function(e){var t={};t.abstractListId=e.abstractListId,t.levels=[];for(var i=0;i<e.levels.length;i++)t.levels[i]=this.writeListLevel(e.levels[i]);return t},e.prototype.writeList=function(e){var t={};return t.abstractListId=e.abstractListId,t.listId=e.listId,t},e.prototype.writeListLevel=function(e){var t={};return t.characterFormat=this.writeCharacterFormat(e.characterFormat),t.paragraphFormat=this.writeParagraphFormat(e.paragraphFormat),t.followCharacter=e.followCharacter,t.listLevelPattern=e.listLevelPattern,t.numberFormat=e.numberFormat,t.restartLevel=e.restartLevel,t.startAt=e.startAt,t},e.prototype.destroy=function(){this.lists=void 0,this.endLine=void 0,this.endOffset=void 0,this.viewer=void 0},e}(),ot=function(){function e(e){var i=this;this.displayText="",this.navigationUrl=void 0,this.bookmarkDropdown=void 0,this.bookmarkCheckbox=void 0,this.bookmarks=[],this.onKeyUpOnUrlBox=function(e){if(13===e.keyCode)return void(""!==i.displayTextBox.value&&""!==i.urlTextBox.value&&i.onInsertHyperlink());i.owner.selection.text;var t=i.urlTextBox.value;"www."===t.substring(0,4).toLowerCase()&&(i.urlTextBox.value="http://"+t),""===i.displayText&&(i.displayTextBox.value=t),i.enableOrDisableInsertButton()},this.onKeyUpOnDisplayBox=function(){i.displayText=i.displayTextBox.value,i.enableOrDisableInsertButton()},this.onInsertButtonClick=function(){i.onInsertHyperlink()},this.onCancelButtonClick=function(){i.owner.dialog.hide(),i.clearValue()},this.loadHyperlinkDialog=function(){i.owner.updateFocus(),i.bookmarks=[];for(var e=0;e<i.owner.bookmarks.keys.length;e++){var r=i.owner.bookmarks.keys[e];0!==r.indexOf("_")&&i.bookmarks.push(r)}var n=i.owner.selection.getHyperlinkField();if(t.isNullOrUndefined(n))i.displayText=i.owner.selection.getText(!0),""!==i.displayText&&(-1!==i.displayText.indexOf(String.fromCharCode(65532))||-1!==i.displayText.indexOf("\r")&&-1!==i.displayText.lastIndexOf("\r")&&-1!==i.displayText.slice(0,-1).indexOf("\r")?(i.displayTextBox.value="<<Selection in document>>",i.displayTextBox.disabled=!0):i.displayTextBox.value=i.displayText);else{if(!t.isNullOrUndefined(n.fieldSeparator)){var o=i.owner.selection.getHyperlinkDisplayText(n.fieldSeparator.line.paragraph,n.fieldSeparator,n.fieldEnd,!1,void 0);i.displayText=o.displayText,i.displayTextBox.disabled=o.isNestedField}i.displayTextBox.value=i.displayText;var a=i.owner.selection.getLinkText(n);i.urlTextBox.value=i.navigationUrl=a,i.owner.dialog.header=i.localObj.getConstant("Edit Hyperlink")}i.bookmarkDiv.style.display="none",i.addressText.style.display="block",i.urlTextBox.style.display="block",i.bookmarkCheckbox.checked=!1,i.bookmarkDropdown.dataSource=i.owner.bookmarks.keys,i.insertButton=document.getElementsByClassName("e-hyper-insert")[0],i.enableOrDisableInsertButton(),i.urlTextBox.focus(),"none"!==i.owner.selection.caret.style.display&&(i.owner.selection.caret.style.display="none")},this.closeHyperlinkDialog=function(){i.clearValue(),i.owner.updateFocus()},this.onUseBookmarkChange=function(e){e.checked?(i.bookmarkDiv.style.display="block",i.bookmarkDropdown.dataSource=i.bookmarks,i.addressText.style.display="none",i.urlTextBox.style.display="none"):(i.bookmarkDiv.style.display="none",i.addressText.style.display="block",i.urlTextBox.style.display="block")},this.onBookmarkchange=function(e){""!==i.bookmarkDropdown.value&&(i.insertButton.disabled=!1)},this.owner=e}return e.prototype.getModuleName=function(){return"HyperlinkDialog"},e.prototype.initHyperlinkDialog=function(e){var i=this,r=this.owner.owner.containerId+"_insert_hyperlink";this.target=t.createElement("div",{id:r,className:"e-de-hyperlink"});var n=t.createElement("div"),a=t.createElement("div",{className:"e-de-hyperlink-dlg-title",innerHTML:e.getConstant("Text to display")});this.displayTextBox=t.createElement("input",{id:this.owner.owner.containerId+"_display_text",className:"e-input e-de-hyperlink-dlg-input"}),this.displayTextBox.addEventListener("keyup",i.onKeyUpOnDisplayBox),n.appendChild(a),n.appendChild(this.displayTextBox),this.addressText=t.createElement("div",{className:"e-de-hyperlink-dlg-title",innerHTML:e.getConstant("Address")}),this.urlTextBox=t.createElement("input",{id:this.owner.owner.containerId+"_url_text",className:"e-input e-de-hyperlink-dlg-input",attrs:{autofocus:"true"}}),this.urlTextBox.addEventListener("input",i.onKeyUpOnUrlBox),this.urlTextBox.addEventListener("keyup",i.onKeyUpOnUrlBox),n.appendChild(this.addressText),n.appendChild(this.urlTextBox),this.bookmarkDiv=t.createElement("div",{styles:"display:none;"});var l=t.createElement("div",{className:"e-de-hyperlink-dlg-title",innerHTML:e.getConstant("Bookmark")}),d=t.createElement("div",{className:"e-de-hyperlink-dlg-bookmark"}),h=t.createElement("input",{id:"e-de-hyperlink-dlg-bookmark-value"});d.appendChild(h),this.bookmarkDropdown=new s.DropDownList({dataSource:[],change:this.onBookmarkchange,popupHeight:"230px",width:"230px",noRecordsTemplate:e.getConstant("No bookmarks found")}),this.bookmarkDropdown.appendTo(h),this.bookmarkDiv.appendChild(l),this.bookmarkDiv.appendChild(d),n.appendChild(this.bookmarkDiv);var c=t.createElement("div",{className:"e-de-hyperlink-bookmark-check e-de-hyperlink-dlg-title"}),p=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_bookmark",className:this.target.id+"_bookmarkcheck"});c.appendChild(p),this.bookmarkCheckbox=new o.CheckBox({label:e.getConstant("Use bookmarks"),change:this.onUseBookmarkChange}),this.bookmarkCheckbox.appendTo(p),n.appendChild(c),this.target.appendChild(n)},e.prototype.show=function(){this.localObj=new t.L10n("documenteditor",this.owner.owner.defaultLocale),this.localObj.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initHyperlinkDialog(this.localObj),this.owner.dialog.header=this.localObj.getConstant("Insert Hyperlink"),this.owner.dialog.height="auto",this.owner.dialog.width="auto",this.owner.dialog.content=this.target,this.owner.dialog.buttons=[{click:this.onInsertButtonClick,buttonModel:{content:this.localObj.getConstant("Ok"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:this.localObj.getConstant("Cancel"),cssClass:"e-flat e-hyper-cancel"}}],this.owner.dialog.dataBind(),this.owner.dialog.beforeOpen=this.loadHyperlinkDialog,this.owner.dialog.close=this.closeHyperlinkDialog,this.owner.dialog.show()},e.prototype.hide=function(){this.closeHyperlinkDialog()},e.prototype.enableOrDisableInsertButton=function(){t.isNullOrUndefined(this.insertButton)||(this.insertButton.disabled=""===this.urlTextBox.value||""===this.displayTextBox.value)},e.prototype.onInsertHyperlink=function(){var e=this.displayTextBox.value.trim(),i=this.urlTextBox.value.trim(),r=!1;if(t.isNullOrUndefined(this.bookmarkDropdown.value)||""===this.bookmarkDropdown.value||(i=this.bookmarkDropdown.value,r=!0),""===i)return void this.owner.dialog.hide();if(e=""===e&&""!==i?i:this.displayTextBox.value,t.isNullOrUndefined(this.navigationUrl)){var n=this.owner.selection.text!==e&&!this.displayTextBox.disabled;this.owner.owner.editorModule.insertHyperlink(i,e,n,r)}else this.owner.owner.editorModule.editHyperlink(this.owner.selection,i,e,r);this.owner.dialog.hide(),this.navigationUrl=void 0},e.prototype.clearValue=function(){this.displayTextBox.value="",this.urlTextBox.value="",this.displayText="",this.displayTextBox.disabled=!1,this.bookmarks=[]},e.prototype.destroy=function(){this.displayTextBox&&(this.displayTextBox.innerHTML="",this.displayTextBox=void 0),this.urlTextBox&&(this.urlTextBox.parentElement.removeChild(this.urlTextBox),this.urlTextBox=void 0),this.owner=void 0,t.isNullOrUndefined(this.target)||(this.target.parentElement&&this.target.parentElement.removeChild(this.target),this.target.innerHTML="",this.target=void 0)},e}(),at=function(){function e(e){var i=this;this.keyUpInsertTable=function(e){13===e.keyCode&&""!==i.rowsCountBox.value&&""!==i.columnsCountBox.value&&i.onInsertTableClick()},this.onCancelButtonClick=function(){i.owner.dialog.hide()},this.onInsertTableClick=function(){var e=i.rowValueTextBox.value,r=i.columnValueTexBox.value;t.isNullOrUndefined(e)&&t.isNullOrUndefined(r)||i.owner.owner.editor.insertTable(e,r),i.owner.dialog.hide()},this.owner=e}return e.prototype.getModuleName=function(){return"TableDialog"},e.prototype.initTableDialog=function(e){var i=this,r=this.owner.owner.containerId+"_insert_Table";this.target=t.createElement("div",{id:r,className:"e-de-insert-table"});var n=t.createElement("div"),o=t.createElement("div",{className:"e-de-insert-table-dlg-sub-header",innerHTML:e.getConstant("Number of columns")}),a=t.createElement("div",{className:"e-de-insert-table-dlg-input"});this.columnsCountBox=t.createElement("input",{attrs:{type:"text"},id:this.owner.owner.containerId+"_column"}),a.appendChild(this.columnsCountBox);var s=t.createElement("div",{className:"e-de-insert-table-dlg-sub-header",innerHTML:e.getConstant("Number of rows")}),d=t.createElement("div",{className:"e-de-insert-table-dlg-input"});this.rowsCountBox=t.createElement("input",{attrs:{type:"text"},id:this.owner.owner.containerId+"row"}),d.appendChild(this.rowsCountBox),n.appendChild(o),n.appendChild(a),n.appendChild(s),n.appendChild(d),this.target.appendChild(n),this.columnsCountBox.addEventListener("keyup",i.keyUpInsertTable),this.rowsCountBox.addEventListener("keyup",i.keyUpInsertTable),this.rowValueTextBox=new l.NumericTextBox({format:"#",value:2,min:1,max:32767,enablePersistence:!1}),this.rowValueTextBox.appendTo(this.rowsCountBox),this.columnValueTexBox=new l.NumericTextBox({format:"#",value:2,min:1,max:63,enablePersistence:!1}),this.columnValueTexBox.appendTo(this.columnsCountBox)},e.prototype.show=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initTableDialog(e),"none"!==this.owner.selection.caret.style.display&&(this.owner.selection.caret.style.display="none"),this.owner.dialog.header=e.getConstant("Insert Table"),this.owner.dialog.height="auto",this.owner.dialog.width="auto",this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=this.owner.updateFocus,this.owner.dialog.buttons=[{click:this.onInsertTableClick,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ok",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cancel"}}],this.rowValueTextBox.value=2,this.columnValueTexBox.value=2,this.owner.dialog.close=this.owner.updateFocus,this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.destroy=function(){if(this.columnsCountBox&&(this.columnsCountBox.parentElement&&this.columnsCountBox.parentElement.removeChild(this.columnsCountBox),this.columnsCountBox=void 0),this.rowsCountBox&&(this.rowsCountBox.parentElement&&this.rowsCountBox.parentElement.removeChild(this.rowsCountBox),this.rowsCountBox=void 0),this.columnValueTexBox&&(this.columnValueTexBox.destroy(),this.columnValueTexBox=void 0),this.rowValueTextBox&&(this.rowValueTextBox.destroy(),this.rowValueTextBox=void 0),this.columnsCountBox=void 0,this.rowsCountBox=void 0,this.owner=void 0,!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},e}(),st=function(){function e(e){var t=this;this.addBookmark=function(){t.owner.owner.editorModule.insertBookmark(t.textBoxInput.value),t.owner.dialog.hide()},this.selectHandler=function(e){t.textBoxInput.value=e.text;var i=document.getElementById("bookmark_text_box");i.setSelectionRange(0,e.text.length),i.focus()},this.gotoBookmark=function(){t.owner.selection.selectBookmark(t.textBoxInput.value)},this.deleteBookmark=function(){t.owner.owner.editorModule.deleteBookmark(t.textBoxInput.value),t.show()},this.owner=e}return e.prototype.getModuleName=function(){return"BookmarkDialog"},e.prototype.initBookmarkDialog=function(e,i){var r=this.owner.owner.containerId+"_insert_bookmark";this.target=t.createElement("div",{id:r,className:"e-de-bookmark"});var n=e.getConstant("Bookmark name")+":",a=t.createElement("div",{innerHTML:n,className:"e-bookmark-dlgfields"});this.target.appendChild(a);var s=t.createElement("div",{className:"e-bookmark-common"});this.target.appendChild(s);var l=t.createElement("div",{className:"e-bookmark-list"});s.appendChild(l);var h=t.createElement("div",{className:"e-bookmark-textboxdiv"});l.appendChild(h),this.textBoxInput=t.createElement("input",{className:"e-input e-bookmark-textbox-input",id:"bookmark_text_box"}),this.textBoxInput.setAttribute("type","text"),h.appendChild(this.textBoxInput);var c=t.createElement("div",{className:"e-bookmark-listViewDiv",id:"bookmark_listview"});l.appendChild(c);this.owner.bookmarks.keys;this.listviewInstance=new d.ListView({dataSource:i,cssClass:"e-bookmark-listview"}),this.listviewInstance.appendTo(c),this.listviewInstance.addEventListener("select",this.selectHandler);var p=t.createElement("div",{className:"e-bookmark-button"});s.appendChild(p);var g=t.createElement("div",{className:"e-bookmark-addbutton"});p.appendChild(g);var u=t.createElement("button",{innerHTML:"Add",id:"add"});g.appendChild(u),new o.Button({cssClass:"e-button-custom"}).appendTo(u),u.addEventListener("click",this.addBookmark);var f=t.createElement("div",{className:"e-bookmark-deletebutton"});p.appendChild(f);var m=t.createElement("button",{innerHTML:"Delete",id:"delete"});f.appendChild(m),new o.Button({cssClass:"e-button-custom"}).appendTo(m),m.addEventListener("click",this.deleteBookmark);var v=t.createElement("div",{className:"e-bookmark-gotobutton"});p.appendChild(v);var y=t.createElement("button",{innerHTML:"Go To",id:"goto"});v.appendChild(y),new o.Button({cssClass:"e-button-custom"}).appendTo(y),y.addEventListener("click",this.gotoBookmark)},e.prototype.show=function(){var e=this.owner.getBookmarks(),i=new t.L10n("documenteditor",this.owner.owner.defaultLocale);i.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.initBookmarkDialog(i,e),this.owner.dialog.header="Bookmark",this.owner.dialog.height="auto",this.owner.dialog.width="auto",this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=this.owner.updateFocus,this.owner.dialog.close=this.owner.updateFocus,this.owner.dialog.buttons=[{click:this.removeObjects.bind(this),buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.removeObjects=function(){this.owner.dialog.hide()},e.prototype.destroy=function(){this.textBoxInput&&(this.textBoxInput.remove(),this.textBoxInput=void 0),this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0)},e}(),lt=function(){function e(e){var i=this;this.loadTableofContentDialog=function(){i.owner.updateFocus(),i.pageNumber.checked=!0,i.rightAlign.disabled=!1,i.rightAlign.checked=!0,i.tabLeader.enabled=!0,i.hyperlink.checked=!0,i.style.checked=!0,i.outline.checked=!0,i.outline.disabled=!1,i.showLevel.enabled=!0},this.closeTableOfContentDialog=function(){i.unWireEventsAndBindings(),i.owner.updateFocus()},this.onCancelButtonClick=function(){i.owner.dialog.hide(),i.unWireEventsAndBindings()},this.selectHandler=function(e){i.textBoxInput.value=e.text;var t=document.getElementById("toclist");t.setSelectionRange(0,e.text.length),t.focus()},this.showStyleDialog=function(){t.isNullOrUndefined(i.owner.owner.styleDialogModule)||i.owner.owner.styleDialogModule.show(i.textBoxInput.value)},this.changeShowLevelValue=function(e){var t=[];switch(e.value){case 1:t=["1",null,null,null,null,null,null,null,null],i.changeByValue(t);break;case 2:t=["1","2",null,null,null,null,null,null,null],i.changeByValue(t);break;case 3:t=["1","2","3",null,null,null,null,null,null],i.changeByValue(t);break;case 4:t=["1","2","3","4",null,null,null,null,null],i.changeByValue(t);break;case 5:t=["1","2","3","4","5",null,null,null,null],i.changeByValue(t);break;case 6:t=["1","2","3","4","5","6",null,null,null],i.changeByValue(t);break;case 7:t=["1","2","3","4","5","6","7",null,null],i.changeByValue(t);break;case 8:t=["1","2","3","4","5","6","7","8",null],i.changeByValue(t);break;case 9:t=["1","2","3","4","5","6","7","8","9"],i.changeByValue(t)}},this.changeByValue=function(e){i.heading1.value=e[0],i.heading2.value=e[1],i.heading3.value=e[2],i.heading4.value=e[3],i.heading5.value=e[4],i.heading6.value=e[5],i.heading7.value=e[6],i.heading8.value=e[7],i.heading9.value=e[8]},this.reset=function(){i.showLevel.enabled=!0,i.showLevel.value=3,i.outline.disabled=!1,i.outline.checked=!0;var e=["1","2","3",null,null,null,null,null,null];i.changeByValue(e),i.normal.value=null},this.changeStyle=function(e){var t=e.srcElement.value;t!==i.getElementValue(e.srcElement)&&""!==t?i.showLevel.enabled=!1:(i.showLevel.enabled=!0,i.checkLevel())},this.changeHeadingStyle=function(e){var t=e.srcElement.value;i.showLevel.enabled=""===t,i.normal===e.srcElement&&(i.outline.checked=!1,i.outline.disabled=!0)},this.changePageNumberValue=function(e){e.checked?(i.rightAlign.checked=!0,i.rightAlign.disabled=!1,i.tabLeader.enabled=!0):(i.rightAlign.disabled=!0,i.tabLeader.enabled=!1)},this.changeRightAlignValue=function(e){e.checked?i.tabLeader.enabled=!0:i.tabLeader.enabled=!1},this.changeStyleValue=function(e){e.checked?(i.heading1.disabled=!1,i.heading2.disabled=!1,i.heading3.disabled=!1,i.heading4.disabled=!1,i.heading5.disabled=!1,i.heading6.disabled=!1,i.heading7.disabled=!1,i.heading8.disabled=!1,i.heading9.disabled=!1,i.normal.disabled=!1):(i.heading1.disabled=!0,i.heading2.disabled=!0,i.heading3.disabled=!0,i.heading4.disabled=!0,i.heading5.disabled=!0,i.heading6.disabled=!0,i.heading7.disabled=!0,i.heading8.disabled=!0,i.heading9.disabled=!0,i.normal.disabled=!0)},this.applyTableOfContentProperties=function(){var e={startLevel:1,endLevel:i.showLevel.value,includeHyperlink:i.hyperlink.checked,includePageNumber:i.pageNumber.checked,rightAlign:i.rightAlign.checked,tabLeader:i.tabLeader.value,includeOutlineLevels:i.outline.checked};i.applyLevelSetting(e),i.owner.owner.editorModule.insertTableOfContents(e),i.owner.dialog.hide()},this.unWireEventsAndBindings=function(){i.pageNumber.checked=!1,i.rightAlign.checked=!1,i.tabLeader.value="",i.hyperlink.checked=!1,i.style.checked=!1,i.outline.checked=!1,i.normal.value=""},this.owner=e}return e.prototype.getModuleName=function(){return"TableOfContentsDialog"},e.prototype.initTableOfContentDialog=function(e){var i=this.owner.owner.containerId,r=i+"_toc_dialog";this.target=t.createElement("div",{id:r,className:"e-de-toc-dlg-container"}),this.owner.owner.element.appendChild(this.target);var n=t.createElement("div",{id:"general_div",className:"e-de-toc-dlg-sub-container"});this.target.appendChild(n);var a=t.createElement("div",{id:i+"_genLabel",className:"e-de-toc-dlg-main-heading",styles:"margin-bottom: 13px;",innerHTML:e.getConstant("General")});n.appendChild(a);var h=t.createElement("div",{id:"left_general",styles:"float:left;position:relative;"});n.appendChild(h);var c=t.createElement("div",{styles:"position:relative;",className:"e-de-toc-dlg-right-general-div"});n.appendChild(c);var p=t.createElement("div",{id:"leftBottom_general",styles:"float:left;position:absolute;top:210px;"});n.appendChild(p);var g=t.createElement("div",{className:"e-de-toc-dlg-right-sub-container",styles:"float:right;"});n.appendChild(g);var u=t.createElement("div",{id:"pageNumber_div",className:"e-de-toc-dlg-sub-container"}),f=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_pageNumber"});u.appendChild(f);var m=t.createElement("div",{id:"rightAlign_div",className:"e-de-toc-dlg-sub-container"}),v=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_rightAlign"});m.appendChild(v),this.pageNumber=new o.CheckBox({label:e.getConstant("Show page numbers"),checked:!0,change:this.changePageNumberValue}),this.rightAlign=new o.CheckBox({label:e.getConstant("Right align page numbers"),checked:!0,change:this.changeRightAlignValue}),this.pageNumber.appendTo(f),this.rightAlign.appendTo(v);var y=t.createElement("div",{id:"tab_div",className:"e-de-toc-dlg-tab-div"}),w=t.createElement("div",{id:"tabLeaderLabel_div"}),b=t.createElement("label",{id:i+"_tabLeaderLabel",className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Tab leader")+":"});w.appendChild(b);var x=t.createElement("div",{id:"tabLeader_div"}),C=t.createElement("select",{id:i+"_tabLeader",innerHTML:'<option value="None">('+e.getConstant("None").toLocaleLowerCase()+')</option><option value="Dot" selected>....................</option><option value="Hyphen">-------------------</option><option value="Underscore">____________</option>'});x.appendChild(C),y.appendChild(w),y.appendChild(x),h.appendChild(u),h.appendChild(m),h.appendChild(y),this.tabLeader=new s.DropDownList({width:210}),this.tabLeader.appendTo(C);var F=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_hyperlink"});c.appendChild(F),this.hyperlink=new o.CheckBox({label:e.getConstant("Use hyperlinks instead of page numbers"),checked:!0}),this.hyperlink.appendTo(F);var P=t.createElement("div",{id:"show_div",className:"e-de-toc-dlg-style-label"}),W=t.createElement("div",{id:"showLevelLabel_div",className:"e-de-toc-dlg-show-level-div"}),T=t.createElement("label",{id:i+"_showLevelLabel",className:"e-de-toc-dlg-heading",innerHTML:e.getConstant("Show levels")+":"});W.appendChild(T);var I=t.createElement("div",{id:"showLevel_div",className:"e-de-toc-dlg-showlevel-div"}),S=t.createElement("input",{id:i+"_showLevel",attrs:{type:"text"}});I.appendChild(S),P.appendChild(W),P.appendChild(I),c.appendChild(P),this.showLevel=new l.NumericTextBox({format:"#",value:3,min:1,max:9,width:210,change:this.changeShowLevelValue}),this.showLevel.appendTo(S);var N=t.createElement("div",{id:"buildTable_div",className:"e-de-toc-dlg-sub-container"}),O=t.createElement("div",{id:i+"_buildTableLabel",className:"e-de-toc-dlg-main-heading e-de-toc-dlg-build-table",styles:"margin-bottom: 13px;",innerHTML:e.getConstant("Build table of contents from")+":"});p.appendChild(N),p.appendChild(O);var L=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_style"});p.appendChild(L),this.style=new o.CheckBox({label:e.getConstant("Styles"),checked:!0,change:this.changeStyleValue}),this.style.appendTo(L);var k=t.createElement("TABLE",{styles:"margin-top:3px;"}),B=t.createElement("tr"),E=t.createElement("td",{styles:"width:120px;padding-left:10px;"}),R=t.createElement("label",{innerHTML:e.getConstant("Available styles"),className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_availableLabel"});E.appendChild(R);var M=t.createElement("td"),H=t.createElement("label",{innerHTML:e.getConstant("TOC level")+":",className:"e-de-toc-dlg-main-heading e-de-toc-dlg-sub-level-heading",id:this.target.id+"_tocLabel"});M.appendChild(H),B.appendChild(E),B.appendChild(M),k.appendChild(B);var U=t.createElement("div",{id:"table_div",className:"e-de-toc-table-div"}),D=t.createElement("TABLE"),A=t.createElement("tr"),z=t.createElement("td"),_=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 1",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading1Label"});z.appendChild(_);var V=t.createElement("td");this.heading1=t.createElement("input",{id:"_heading1",className:"e-input e-de-toc-dlg-toc-level"}),this.heading1.value="1",this.heading1.addEventListener("keyup",this.changeStyle),V.appendChild(this.heading1),A.appendChild(z),A.appendChild(V);var q=t.createElement("tr"),j=t.createElement("td"),G=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 2",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading2Label"});j.appendChild(G);var K=t.createElement("td");this.heading2=t.createElement("input",{id:"_heading2",className:"e-input e-de-toc-dlg-toc-level"}),this.heading2.value="2",this.heading2.addEventListener("keyup",this.changeStyle),K.appendChild(this.heading2),q.appendChild(j),q.appendChild(K);var X=t.createElement("tr"),Y=t.createElement("td"),J=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 3",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading3Label"});Y.appendChild(J);var Z=t.createElement("td");this.heading3=t.createElement("input",{id:"_heading3",className:"e-input e-de-toc-dlg-toc-level"}),this.heading3.value="3",this.heading3.addEventListener("keyup",this.changeStyle),Z.appendChild(this.heading3),X.appendChild(Y),X.appendChild(Z);var $=t.createElement("tr"),Q=t.createElement("td"),ee=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 4",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading4Label"});Q.appendChild(ee);var te=t.createElement("td");this.heading4=t.createElement("input",{id:"_heading4",className:"e-input e-de-toc-dlg-toc-level"}),this.heading4.addEventListener("keyup",this.changeStyle),te.appendChild(this.heading4),$.appendChild(Q),$.appendChild(te);var ie=t.createElement("tr"),re=t.createElement("td"),ne=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 5",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading5Label"});re.appendChild(ne);var oe=t.createElement("td");this.heading5=t.createElement("input",{id:"_heading5",className:"e-input e-de-toc-dlg-toc-level"}),this.heading5.addEventListener("keyup",this.changeStyle),oe.appendChild(this.heading5),ie.appendChild(re),ie.appendChild(oe);var ae=t.createElement("tr"),se=t.createElement("td"),le=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 6",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading6Label"});se.appendChild(le);var de=t.createElement("td");this.heading6=t.createElement("input",{id:"_heading6",className:"e-input e-de-toc-dlg-toc-level"}),this.heading6.addEventListener("keyup",this.changeStyle),de.appendChild(this.heading6),ae.appendChild(se),ae.appendChild(de);var he=t.createElement("tr"),ce=t.createElement("td"),pe=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 7",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading7Label"});ce.appendChild(pe);var ge=t.createElement("td");this.heading7=t.createElement("input",{id:"_heading7",className:"e-input e-de-toc-dlg-toc-level"}),this.heading7.addEventListener("keyup",this.changeStyle),ge.appendChild(this.heading7),he.appendChild(ce),he.appendChild(ge);var ue=t.createElement("tr"),fe=t.createElement("td"),me=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 8",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading8Label"});fe.appendChild(me);var ve=t.createElement("td");this.heading8=t.createElement("input",{id:"_heading8",className:"e-input e-de-toc-dlg-toc-level"}),this.heading8.addEventListener("keyup",this.changeStyle),ve.appendChild(this.heading8),ue.appendChild(fe),ue.appendChild(ve);var ye=t.createElement("tr"),we=t.createElement("td"),be=t.createElement("label",{innerHTML:e.getConstant("Heading")+" 9",className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_heading9Label"});we.appendChild(be);var xe=t.createElement("td");this.heading9=t.createElement("input",{id:"_heading9",className:"e-input e-de-toc-dlg-toc-level"}),this.heading9.addEventListener("keyup",this.changeStyle),xe.appendChild(this.heading9),ye.appendChild(we),ye.appendChild(xe);var Ce=t.createElement("tr"),Fe=t.createElement("td"),Pe=t.createElement("label",{innerHTML:e.getConstant("Normal"),className:"e-de-toc-dlg-sub-heading",id:this.target.id+"_normalLabel"});Fe.appendChild(Pe);var We=t.createElement("td");this.normal=t.createElement("input",{id:"_normal",className:"e-input e-de-toc-dlg-toc-level"}),this.normal.addEventListener("keyup",this.changeHeadingStyle),We.appendChild(this.normal),Ce.appendChild(Fe),Ce.appendChild(We),D.appendChild(A),D.appendChild(q),D.appendChild(X),D.appendChild($),D.appendChild(ie),D.appendChild(ae),D.appendChild(he),D.appendChild(ue),D.appendChild(ye),D.appendChild(Ce),U.appendChild(D);var Te=t.createElement("div",{className:"e-de-toc-styles-table-div"});Te.appendChild(k),Te.appendChild(U),p.appendChild(Te);var Ie=t.createElement("div",{id:"fields_div",styles:"display: flex;"});p.appendChild(Ie);var Se=t.createElement("div",{id:"out_div"}),Ne=t.createElement("div",{id:"outline_div",className:"e-de-toc-dlg-sub-container e-de-toc-dlg-outline-levels"}),Oe=t.createElement("input",{attrs:{type:"checkbox"},id:"_outline"});Ne.appendChild(Oe),Se.appendChild(Ne),Ie.appendChild(Se),this.outline=new o.CheckBox({label:e.getConstant("Outline levels"),checked:!0}),this.outline.appendTo(Oe);var Le=t.createElement("div",{className:"e-de-toc-reset-button"});Ie.appendChild(Le);var ke=t.createElement("button",{innerHTML:"Reset",id:"reset"});Le.appendChild(ke),new o.Button({cssClass:"e-btn e-flat"}).appendTo(ke),ke.addEventListener("click",this.reset);var Be=t.createElement("div",{id:"tocStyles_div",className:"e-de-toc-dlg-sub-container"}),Ee=t.createElement("div",{id:i+"_tocStylesLabel",className:"e-de-toc-dlg-main-heading e-de-toc-dlg-styles",innerHTML:e.getConstant("Styles")+":"});g.appendChild(Be),g.appendChild(Ee);var Re=t.createElement("div",{className:"e-de-toc-dlg-style-input"});g.appendChild(Re),this.textBoxInput=t.createElement("input",{className:"e-input",id:"toclist"}),this.textBoxInput.setAttribute("type","text"),Re.appendChild(this.textBoxInput);var Me=t.createElement("div",{className:"e-de-toc-list-view"}),He=["TOC 1","TOC 2","TOC 3","TOC 4","TOC 5","TOC 6","TOC 7","TOC 8","TOC 9"];this.listViewInstance=new d.ListView({dataSource:He,cssClass:"e-toc-list-view"}),this.listViewInstance.appendTo(Me),this.listViewInstance.addEventListener("select",this.selectHandler),g.appendChild(Me);var Ue=t.createElement("div",{className:"e-de-toc-modify-button"});g.appendChild(Ue);var De=t.createElement("button",{innerHTML:"Modify",id:"modify"});Ue.appendChild(De),new o.Button({cssClass:"e-btn e-flat"}).appendTo(De),De.addEventListener("click",this.showStyleDialog)},e.prototype.show=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initTableOfContentDialog(e),this.owner.dialog.header=e.getConstant("Table of Contents"),this.owner.dialog.width="auto",this.owner.dialog.height="auto",this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=this.loadTableofContentDialog,this.owner.dialog.close=this.closeTableOfContentDialog,this.owner.dialog.buttons=[{click:this.applyTableOfContentProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-toc-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-toc-cancel"}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.checkLevel=function(){""!==this.heading1.value&&(this.showLevel.value=1),""!==this.heading2.value&&(this.showLevel.value=2),""!==this.heading3.value&&(this.showLevel.value=3),""!==this.heading4.value&&(this.showLevel.value=4),""!==this.heading5.value&&(this.showLevel.value=5),""!==this.heading6.value&&(this.showLevel.value=6),""!==this.heading7.value&&(this.showLevel.value=7),""!==this.heading8.value&&(this.showLevel.value=8),""!==this.heading9.value&&(this.showLevel.value=9)},e.prototype.getElementValue=function(e){switch(e){case this.heading1:return"1";case this.heading2:return"2";case this.heading3:return"3";case this.heading4:return"4";case this.heading5:return"5";case this.heading6:return"6";case this.heading7:return"7";case this.heading8:return"8";case this.heading9:return"9";default:return"1"}},e.prototype.getHeadingLevel=function(e){switch(e){case 1:return parseInt(this.heading1.value);case 2:return parseInt(this.heading2.value);case 3:return parseInt(this.heading3.value);case 4:return parseInt(this.heading4.value);case 5:return parseInt(this.heading5.value);case 6:return parseInt(this.heading6.value);case 7:return parseInt(this.heading7.value);case 8:return parseInt(this.heading8.value);case 9:return parseInt(this.heading9.value);default:return 0}},e.prototype.applyLevelSetting=function(e){e.levelSettings={};for(var t=0,i=0,r=!1,n=1;n<=e.endLevel;n++){var o=this.getHeadingLevel(n);if(n===o)0===t&&(t=n,r=!1),r||(i=n);else if(r=!0,0!==o){var a="Heading "+n.toString();e.levelSettings[a]=o}}e.startLevel=t,e.endLevel=i,""!==this.normal.value&&(e.levelSettings.Normal=+this.normal.value)},e.prototype.destroy=function(){if(this.pageNumber&&(this.pageNumber.destroy(),this.pageNumber=void 0),this.rightAlign&&(this.rightAlign.destroy(),this.rightAlign=void 0),this.tabLeader&&(this.tabLeader.destroy(),this.tabLeader=void 0),this.showLevel&&(this.showLevel.destroy(),this.showLevel=void 0),this.hyperlink&&(this.hyperlink.destroy(),this.hyperlink=void 0),this.style&&(this.style.destroy(),this.style=void 0),this.outline&&(this.outline.destroy(),this.outline=void 0),this.listViewInstance&&(this.listViewInstance.destroy(),this.listViewInstance=void 0),this.heading1=void 0,this.heading2=void 0,this.heading3=void 0,this.heading4=void 0,this.heading5=void 0,this.heading6=void 0,this.heading7=void 0,this.heading8=void 0,this.heading9=void 0,this.normal=void 0,this.textBoxInput=void 0,this.owner=void 0,!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},e}(),dt=function(){function e(e){var t=this;this.isPortrait=!0,this.loadPageSetupDialog=function(){t.owner.updateFocus();var e=t.owner.selection.sectionFormat;t.topMarginBox.value=e.topMargin,t.leftMarginBox.value=e.leftMargin,t.bottomMarginBox.value=e.bottomMargin,t.rightMarginBox.value=e.rightMargin,t.widthBox.value=e.pageWidth,t.heightBox.value=e.pageHeight,t.checkBox1.checked=e.differentOddAndEvenPages,t.checkBox2.checked=e.differentFirstPage,t.headerBox.value=e.headerDistance,t.footerBox.value=e.footerDistance,t.widthBox.value>t.heightBox.value?t.landscape.checked=!0:t.portrait.checked=!0},this.closePageSetupDialog=function(){t.unWireEventsAndBindings(),t.owner.updateFocus()},this.onCancelButtonClick=function(){t.owner.dialog.hide(),t.unWireEventsAndBindings()},this.keyUpInsertPageSettings=function(e){13===e.keyCode&&t.applyPageSetupProperties()},this.applyPageSetupProperties=function(){var e=new y;e.bottomMargin=t.bottomMarginBox.value,e.topMargin=t.topMarginBox.value,e.leftMargin=t.leftMarginBox.value,e.rightMargin=t.rightMarginBox.value,e.pageWidth=t.widthBox.value,e.pageHeight=t.heightBox.value,e.differentOddAndEvenPages=t.checkBox1.checked,e.differentFirstPage=t.checkBox2.checked,e.headerDistance=t.headerBox.value,e.footerDistance=t.footerBox.value,t.owner.owner.editorModule.onApplySectionFormat(void 0,e),t.owner.dialog.hide()},this.changeByPaperSize=function(e){var i=e.value,r=t.owner.selection.sectionFormat;r.pageWidth,r.pageHeight;t.owner.selection.sectionFormat.pageWidth>t.owner.selection.sectionFormat.pageHeight||t.landscape.checked?t.isPortrait=!1:t.isPortrait=!0,"letter"===i?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=792):(t.widthBox.value=792,t.heightBox.value=612):"tabloid"===i?t.isPortrait?(t.widthBox.value=792,t.heightBox.value=1224):(t.widthBox.value=1224,t.heightBox.value=792):"legal"===i?t.isPortrait?(t.widthBox.value=612,t.heightBox.value=1008):(t.widthBox.value=1008,t.heightBox.value=612):"statement"===i?t.isPortrait?(t.widthBox.value=392,t.heightBox.value=612):(t.widthBox.value=612,t.heightBox.value=392):"executive"===i?t.isPortrait?(t.widthBox.value=522,t.heightBox.value=756):(t.widthBox.value=756,t.heightBox.value=522):"a3"===i?t.isPortrait?(t.widthBox.value=841.9,t.heightBox.value=1190.55):(t.widthBox.value=1190.55,t.heightBox.value=841.9):"a4"===i?t.isPortrait?(t.widthBox.value=595.3,t.heightBox.value=841.9):(t.widthBox.value=841.9,t.heightBox.value=595.3):"a5"===i?t.isPortrait?(t.widthBox.value=419.55,t.heightBox.value=595.3):(t.widthBox.value=595.3,t.heightBox.value=419.55):"b4"===i?t.isPortrait?(t.widthBox.value=728.5,t.heightBox.value=1031.8):(t.widthBox.value=1031.8,t.heightBox.value=728.5):"b5"===i?t.isPortrait?(t.widthBox.value=515.9,t.heightBox.value=728.5):(t.widthBox.value=728.5,t.heightBox.value=515.9):"customsize"===i&&(t.isPortrait?(t.widthBox.value=515.9,t.heightBox.value=728.5):(t.widthBox.value=728.5,t.heightBox.value=515.9))},this.onPortrait=function(e){t.landscape.checked=!1;var i=t.widthBox.value,r=t.heightBox.value;i>r&&(t.widthBox.value=r,t.heightBox.value=i)},this.onLandscape=function(e){t.portrait.checked=!1;var i=t.widthBox.value,r=t.heightBox.value;i<r&&(t.widthBox.value=r,t.heightBox.value=i)},this.unWireEventsAndBindings=function(){t.paperSize.value=void 0,t.topMarginBox.value=void 0,t.bottomMarginBox.value=void 0,t.leftMarginBox.value=void 0,t.rightMarginBox.value=void 0,t.headerBox.value=void 0,t.footerBox.value=void 0,t.widthBox.value=void 0,t.heightBox.value=void 0,t.checkBox1.checked=!1,t.checkBox2.checked=!1,t.portrait.checked=!1,t.landscape.checked=!1},this.owner=e}return e.prototype.getModuleName=function(){return"PageSetupDialog"},e.prototype.initPageSetupDialog=function(e){var i=this.owner.owner.containerId+"_pagesetup_dialog";this.target=t.createElement("div",{id:i,className:"e-de-pagesetup-dlg-container"}),this.owner.owner.element.appendChild(this.target);var n=t.createElement("div",{id:this.target.id+"_MarginTabContainer"});this.target.appendChild(n),this.marginTab=t.createElement("div",{id:this.target.id+"_marginPropertyTab",styles:"position: relative;width:400px;"}),this.paperTab=t.createElement("div",{id:this.target.id+"_paperSizePropertyTab",styles:"position: relative;width:400px;"}),this.layoutTab=t.createElement("div",{id:this.target.id+"_CellPropertiesDialogTab",styles:"position: relative;width:400px;"});var o=t.createElement("div",{id:this.target.id+"_PageSetupDialogTab",className:"e-de-page-setup-ppty-tab"}),a=t.createElement("div",{className:"e-tab-header"}),s=t.createElement("div",{id:this.target.id+"_marginHeader",innerHTML:e.getConstant("Margin")}),l=t.createElement("div",{id:this.target.id+"_paperHeader",innerHTML:e.getConstant("Paper")}),d=t.createElement("div",{id:this.target.id+"_layoutHeader",innerHTML:e.getConstant("Layout")});a.appendChild(s),a.appendChild(l),a.appendChild(d);var h=t.createElement("div",{className:"e-content"}),c=t.createElement("div",{id:this.target.id+"_marginContent"}),p=t.createElement("div",{id:this.target.id+"_paperContent"}),g=t.createElement("div",{id:this.target.id+"_layoutContent"});c.appendChild(this.marginTab),p.appendChild(this.paperTab),g.appendChild(this.layoutTab),h.appendChild(c),h.appendChild(p),h.appendChild(g),o.appendChild(a),o.appendChild(h),n.appendChild(o),this.initMarginProperties(this.marginTab,e),this.initPaperSizeProperties(this.paperTab,e),this.initLayoutProperties(this.layoutTab,e);var u=new r.Tab({},o);this.target.addEventListener("keyup",this.keyUpInsertPageSettings),u.element.getElementsByClassName("e-item e-toolbar-item")[0].getElementsByClassName("e-tab-wrap")[0].classList.add("e-de-page-setup-dlg-margin-tab-header")},e.prototype.initMarginProperties=function(e,i){var r=t.createElement("div",{id:"margin_div",className:"e-de-page-setup-dlg-sub-container",styles:"height:135px;"}),n=t.createElement("div",{id:"left_margin",className:"e-de-page-setup-dlg-left-sub-container"});r.appendChild(n);var a=t.createElement("div",{className:"e-de-page-setup-dlg-right-sub-container"});r.appendChild(a);var s=t.createElement("label",{innerHTML:i.getConstant("Top"),className:"e-de-page-setup-dlg-sub-header",id:this.target.id+"_TopLabel",styles:"padding-top:0px;width:190px;"}),d=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_Top"}),h=t.createElement("label",{innerHTML:i.getConstant("Bottom"),className:"e-de-page-setup-dlg-sub-title-header",id:this.target.id+"_bottomLabel"}),c=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_bottom"});n.appendChild(s),n.appendChild(d),n.appendChild(h),n.appendChild(c);var p=t.createElement("label",{innerHTML:i.getConstant("Left"),className:"e-de-page-setup-dlg-sub-header",styles:"padding-top:0px;width:190px;",id:this.target.id+"_leftLabel"}),g=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_left"}),u=t.createElement("label",{innerHTML:i.getConstant("Right"),id:this.target.id+"_rightLabel",className:"e-de-page-setup-dlg-sub-title-header"}),f=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_right"});a.appendChild(p),a.appendChild(g),a.appendChild(u),a.appendChild(f),e.appendChild(r),this.topMarginBox=new l.NumericTextBox({value:71,width:170,decimals:2}),this.topMarginBox.appendTo(d),this.leftMarginBox=new l.NumericTextBox({value:73,width:170,decimals:2}),this.leftMarginBox.appendTo(g),this.bottomMarginBox=new l.NumericTextBox({value:72,width:170,decimals:2}),this.bottomMarginBox.appendTo(c),this.rightMarginBox=new l.NumericTextBox({value:74,width:170,decimals:2}),this.rightMarginBox.appendTo(f);var m=t.createElement("div",{id:"orientation_div",className:"e-de-page-setup-dlg-sub-container-port"}),v=t.createElement("div",{id:"_orientationLabelDiv",className:"e-de-page-setup-dlg-sub-label",innerHTML:i.getConstant("Orientation")}),y=t.createElement("div",{id:"_orientationPropDiv",styles:"display: flex;",className:"e-de-page-setup-dlg-orientation-prop"}),w=t.createElement("div",{id:"_portraitDiv",styles:"padding-right: 30px;"}),b=t.createElement("input",{attrs:{type:"radiobutton"},id:this.target.id+"_portrait"}),x=t.createElement("div",{id:"_landscapeDiv"}),C=t.createElement("input",{attrs:{type:"radiobutton"},id:this.target.id+"_landscape"});w.appendChild(b),x.appendChild(C),y.appendChild(w),y.appendChild(x),m.appendChild(v),m.appendChild(y),this.portrait=new o.RadioButton({label:i.getConstant("Portrait"),checked:!0,change:this.onPortrait}),this.landscape=new o.RadioButton({label:i.getConstant("Landscape"),change:this.onLandscape}),this.portrait.appendTo(b),this.landscape.appendTo(C),e.appendChild(m)},e.prototype.initPaperSizeProperties=function(e,i){var r=t.createElement("div",{id:"size_div",className:"e-de-page-setup-dlg-sub-size-container"}),n=t.createElement("div",{id:"left_size",className:"e-de-page-setup-dlg-left-sub-container"});r.appendChild(n);var o=t.createElement("div",{className:"e-de-page-setup-dlg-right-sub-container"});r.appendChild(o);var a=t.createElement("label",{innerHTML:i.getConstant("Width"),className:"e-de-page-setup-dlg-sub-header",id:this.target.id+"_widthLabel",styles:"padding-top:0px;width:190px;"}),d=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_Width"});n.appendChild(a),n.appendChild(d);var h=t.createElement("label",{innerHTML:i.getConstant("Height"),className:"e-de-page-setup-dlg-sub-header",styles:"padding-top:0px;width:190px;",id:this.target.id+"_heightLabel"}),c=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_height"});o.appendChild(h),o.appendChild(c),e.appendChild(r),this.widthBox=new l.NumericTextBox({value:612,width:170,decimals:2}),this.widthBox.appendTo(d),this.heightBox=new l.NumericTextBox({value:792,width:170,decimals:2}),this.heightBox.appendTo(c);var p=t.createElement("div",{id:"_paperSizeDiv",styles:"height:37px;",className:"e-de-page-setup-dlg-sub-container"}),g=t.createElement("select",{id:this.target.id+"_papersize",styles:"width:170px;padding-bottom: 20px;",innerHTML:'<option value="letter">'+i.getConstant("Letter")+'</option><option value="tabloid">'+i.getConstant("Tabloid")+'</option><option value="legal">'+i.getConstant("Legal")+'</option><option value="statement">'+i.getConstant("Statement")+'</option><option value="executive">'+i.getConstant("Executive")+'</option><option value="a3">'+i.getConstant("A3")+'</option><option value="a4">'+i.getConstant("A4")+'</option><option value="a5">'+i.getConstant("A5")+'</option><option value="b4">'+i.getConstant("B4")+'</option><option value="b5">'+i.getConstant("B5")+'</option><option value="customsize">'+i.getConstant("Custom Size")+"</option>"});p.appendChild(g),this.paperSize=new s.DropDownList({change:this.changeByPaperSize,width:"170px"}),this.paperSize.appendTo(g),e.appendChild(p)},e.prototype.initLayoutProperties=function(e,i){var r=t.createElement("div",{id:"_layoutDiv",className:"e-de-page-setup-dlg-layout-sub-container"}),n=t.createElement("div",{id:"_firstPageDiv",styles:"height: 27px;",className:"e-de-page-setup-dlg-first-page-prop"}),a=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_oddoreven"});n.appendChild(a);var s=t.createElement("div",{id:"_oddOrEvenDiv",styles:"height: 27px;",className:"e-de-page-setup-dlg-odd-or-even-prop"}),d=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_even"});s.appendChild(d),r.appendChild(n),r.appendChild(s),this.checkBox1=new o.CheckBox({label:i.getConstant("Different odd and even")}),this.checkBox2=new o.CheckBox({label:i.getConstant("Different first page")}),this.checkBox1.appendTo(a),this.checkBox2.appendTo(d),e.appendChild(r);var h=t.createElement("div",{id:"_textLabelDiv",className:"e-de-page-setup-dlg-sub-label"}),c=t.createElement("label",{innerHTML:i.getConstant("From edge"),id:this.target.id+"_textLabel"});h.appendChild(c),e.appendChild(h);var p=t.createElement("div",{id:"_headerFooeterPropDiv",className:"e-de-page-setup-dlg-sub-container",styles:"height: 65px;"}),g=t.createElement("div",{id:"_leftLayoutDiv",className:"e-de-page-setup-dlg-left-layout-container"});p.appendChild(g);var u=t.createElement("div",{className:"e-de-page-setup-dlg-right-layout-container"});p.appendChild(u);var f=t.createElement("label",{innerHTML:i.getConstant("Header"),className:"e-de-page-setup-dlg-sub-header",id:this.target.id+"_headerLabel",styles:"padding-top:0px;width:190px;"}),m=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_header"});g.appendChild(f),g.appendChild(m);var v=t.createElement("label",{innerHTML:i.getConstant("Footer"),className:"e-de-page-setup-dlg-sub-header",styles:"padding-top:0px;width:190px;",id:this.target.id+"_footerLabel"}),y=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_footer"});u.appendChild(v),u.appendChild(y),e.appendChild(p),this.headerBox=new l.NumericTextBox({value:612,width:170,decimals:2}),this.headerBox.appendTo(m),this.footerBox=new l.NumericTextBox({value:792,width:170,decimals:2}),this.footerBox.appendTo(y)},e.prototype.show=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initPageSetupDialog(e),this.owner.dialog.header=e.getConstant("Page Setup"),this.owner.dialog.width="auto",this.owner.dialog.height="auto",this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=this.loadPageSetupDialog,this.owner.dialog.close=this.closePageSetupDialog,this.owner.dialog.buttons=[{click:this.applyPageSetupProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-layout-ppty-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-layout-ppty-cancel"}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.destroy=function(){if(this.topMarginBox&&(this.topMarginBox.destroy(),this.topMarginBox=void 0),this.leftMarginBox&&(this.leftMarginBox.destroy(),this.leftMarginBox=void 0),this.bottomMarginBox&&(this.bottomMarginBox.destroy(),this.bottomMarginBox=void 0),this.rightMarginBox&&(this.rightMarginBox.destroy(),this.rightMarginBox=void 0),this.headerBox&&(this.headerBox.destroy(),this.headerBox=void 0),this.footerBox&&(this.footerBox.destroy(),this.footerBox=void 0),this.widthBox&&(this.widthBox.destroy(),this.widthBox=void 0),this.heightBox&&(this.heightBox.destroy(),this.heightBox=void 0),this.paperSize&&(this.paperSize.destroy(),this.paperSize=void 0),this.checkBox1&&(this.checkBox1.destroy(),this.checkBox1=void 0),this.checkBox2&&(this.checkBox2.destroy(),this.checkBox2=void 0),this.portrait&&(this.portrait.destroy(),this.portrait=void 0),this.landscape&&(this.landscape.destroy(),this.landscape=void 0),this.owner=void 0,!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},e}(),ht=function(){function e(e){var i=this;this.leftIndent=void 0,this.rightIndent=void 0,this.beforeSpacing=void 0,this.afterSpacing=void 0,this.textAlignment=void 0,this.firstLineIndent=void 0,this.lineSpacingIn=void 0,this.lineSpacingType=void 0,this.paragraphFormat=void 0,this.keyUpParagraphSettings=function(e){13===e.keyCode&&i.applyParagraphFormat()},this.changeBeforeSpacing=function(e){i.beforeSpacing=e.value},this.changeAfterSpacing=function(e){i.afterSpacing=e.value},this.changeLeftIndent=function(e){i.leftIndent=e.value},this.changeRightIndent=function(e){i.rightIndent=e.value},this.changeLineSpacingValue=function(e){i.lineSpacingIn=e.value},this.changeFirstLineIndent=function(e){i.firstLineIndent=e.value},this.changeByTextAlignment=function(e){i.textAlignment=e.value},this.changeByValue=function(e){var r=i.owner.selection.paragraphFormat;switch(i.special.index){case 0:0!==r.firstLineIndent&&(i.byIn.value=0);break;case 1:0===r.firstLineIndent||t.isNullOrUndefined(r.firstLineIndent)?i.byIn.value=.1:r.firstLineIndent<0&&(i.byIn.value=-r.firstLineIndent);break;case 2:0===r.firstLineIndent||t.isNullOrUndefined(r.firstLineIndent)?r.firstLineIndent=-.1:r.firstLineIndent>0&&(i.byIn.value=-r.firstLineIndent)}},this.changeBySpacing=function(e){if(!t.isNullOrUndefined(i.lineSpacing))switch(i.lineSpacing.index){case 0:i.lineSpacingType="AtLeast",i.atIn.value=12;break;case 1:i.lineSpacingType="Exactly",i.atIn.value=12;break;case 2:i.lineSpacingType="Multiple",i.atIn.value=1}},this.loadParagraphDialog=function(){var e;e=i.paragraphFormat?i.paragraphFormat:i.owner.selection.paragraphFormat;var t=i.alignment.index;t="Center"===e.textAlignment?0:"Left"===e.textAlignment?1:"Right"===e.textAlignment?2:3,i.alignment.index=t,i.beforeSpacingIn.value=e.beforeSpacing,i.afterSpacingIn.value=e.afterSpacing,i.leftIndentIn.value=e.leftIndent,i.rightIndentIn.value=e.rightIndent,i.byIn.value=e.firstLineIndent;var r=i.lineSpacing.index;r="AtLeast"===e.lineSpacingType?0:"Exactly"===e.lineSpacingType?1:2,i.lineSpacing.index=r,i.atIn.value=e.lineSpacing,"none"!==i.owner.selection.caret.style.display&&(i.owner.selection.caret.style.display="none")},this.applyParagraphFormat=function(){var e,r;i.paragraphFormat?(e=i.paragraphFormat,r=!1):(e=new F,r=!0),t.isNullOrUndefined(i.beforeSpacing)||(e.beforeSpacing=i.beforeSpacing),t.isNullOrUndefined(i.afterSpacing)||(e.afterSpacing=i.afterSpacing),t.isNullOrUndefined(i.lineSpacingType)||(e.lineSpacingType=i.lineSpacingType),t.isNullOrUndefined(i.leftIndent)||(e.leftIndent=i.leftIndent),t.isNullOrUndefined(i.rightIndent)||(e.rightIndent=i.rightIndent),t.isNullOrUndefined(i.lineSpacingIn)||(e.lineSpacing=i.lineSpacingIn),t.isNullOrUndefined(i.firstLineIndent)||(e.firstLineIndent=i.firstLineIndent),t.isNullOrUndefined(i.textAlignment)||(e.textAlignment=i.textAlignment),r?i.onParagraphFormat(e):i.owner.owner.styleDialogModule.updateParagraphFormat(),i.owner.dialog.hide()},this.closeParagraphDialog=function(){i.leftIndent=void 0,i.afterSpacing=void 0,i.beforeSpacing=void 0,i.firstLineIndent=void 0,i.textAlignment=void 0,i.rightIndent=void 0,i.lineSpacingIn=void 0,i.lineSpacingType=void 0,i.paragraphFormat=void 0,i.owner.dialog.hide(),i.owner.updateFocus()},this.owner=e}return e.prototype.getModuleName=function(){return"ParagraphDialog"},e.prototype.initParagraphDialog=function(e){var i=this,r=this.owner.owner.containerId,n=r+"_paragraph_dialog";this.target=t.createElement("div",{id:n,className:"e-de-para-dlg-container"});var o=t.createElement("div",{id:"property_div",styles:"width:400px;"}),a=t.createElement("div",{id:"genral_div",styles:"width:200px;height:85px;",className:"e-de-para-dlg-sub-container"}),d=t.createElement("div",{id:r+"_genLabel",className:"e-de-para-dlg-heading",innerHTML:e.getConstant("General")}),h=t.createElement("div",{id:r+"_AlignLabel",className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Alignment")}),c=t.createElement("select",{id:r+"_Alignment",innerHTML:'<option value="Center">'+e.getConstant("Center")+'</option><option value="Left">'+e.getConstant("Left")+'</option><option value="Right">'+e.getConstant("Right")+'</option><option value="Justify">'+e.getConstant("Justify")+"</option>"});a.appendChild(d),a.appendChild(h),a.appendChild(c);var p=t.createElement("div",{id:"indention_div",styles:"width: 400px;height: 150px;",className:"e-de-para-dlg-sub-container"}),g=t.createElement("div",{id:"left_indention",styles:"float:left;position:relative;"});p.appendChild(g);var u=t.createElement("div",{className:"e-de-para-dlg-right-sub-container",styles:"float:right;position:relative;"});p.appendChild(u);var f=t.createElement("div",{id:"spacing_div",styles:"width: 400px;height: 150px;",className:"e-de-para-dlg-sub-container"}),m=t.createElement("div",{id:"left_spacing",styles:"float:left;position:relative;"});f.appendChild(m);var v=t.createElement("div",{className:"e-de-para-dlg-right-sub-container",styles:"float:right;position:relative;"});f.appendChild(v);var y=t.createElement("div",{id:r+"_indentLabel",className:"e-de-para-dlg-heading",innerHTML:e.getConstant("Indentation")}),w=t.createElement("div",{id:r+"_bfTextLabel",className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Before text")}),b=t.createElement("input",{id:r+"_leftIndent",attrs:{type:"text"}}),x=t.createElement("div",{id:r+"_specialLabel",className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Special")}),C=t.createElement("select",{id:r+"_special",innerHTML:'<option value="None">'+e.getConstant("None")+'</option><option value="First Line">'+e.getConstant("First line")+'</option><option value="Hanging">'+e.getConstant("Hanging")+"</option> "});g.appendChild(y),g.appendChild(w),g.appendChild(b),g.appendChild(x),g.appendChild(C);var F=t.createElement("div",{id:r+"_afTextLabel",className:"e-de-dlg-sub-header",innerHTML:e.getConstant("After text")}),P=t.createElement("input",{id:r+"_rightIndent",attrs:{type:"text"}}),W=t.createElement("label",{id:r+"_byLabel",className:"e-de-dlg-sub-header",innerHTML:e.getConstant("By")}),T=t.createElement("input",{id:r+"_By",attrs:{type:"text"}});u.appendChild(F),u.appendChild(P),u.appendChild(W),u.appendChild(T);var I=t.createElement("div",{innerHTML:e.getConstant("Spacing"),className:"e-de-para-dlg-heading",id:r+"_spaceLabel"}),S=t.createElement("div",{className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Before"),id:r+"_beforeLabel"}),N=t.createElement("input",{id:r+"_beforeSpacing",attrs:{type:"text"}}),O=t.createElement("div",{id:r+"_lineSpaceLabel",className:"e-de-dlg-sub-header",innerHTML:e.getConstant("Line Spacing")}),L=t.createElement("select",{id:r+"_lineSpacing",styles:"width:180px;",innerHTML:'<option value="At least">'+e.getConstant("At least")+'</option><option value="Exactly">'+e.getConstant("Exactly")+'</option><option value="Multiple">'+e.getConstant("Multiple")+"</option>"});m.appendChild(I),m.appendChild(S),m.appendChild(N),m.appendChild(O),m.appendChild(L);var k=t.createElement("div",{innerHTML:e.getConstant("After"),className:"e-de-dlg-sub-header",id:r+"_afterLabel"}),B=t.createElement("input",{id:r+"_afterSpacing",attrs:{type:"text"}}),E=t.createElement("div",{innerHTML:e.getConstant("At"),id:r+"_atLabel",className:"e-de-dlg-sub-header"}),R=t.createElement("input",{id:r+"_lineSpacingAt",attrs:{type:"text"}});v.appendChild(k),v.appendChild(B),v.appendChild(E),v.appendChild(R),o.appendChild(a),o.appendChild(p),o.appendChild(f),this.target.appendChild(o),this.leftIndentIn=new l.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,width:180,enablePersistence:!1,change:this.changeLeftIndent}),this.leftIndentIn.appendTo(b),this.rightIndentIn=new l.NumericTextBox({format:"n1",value:0,min:-1584,max:1584,width:180,enablePersistence:!1,change:this.changeRightIndent}),this.rightIndentIn.appendTo(P),this.byIn=new l.NumericTextBox({format:"n1",value:0,min:0,max:1584,width:180,enablePersistence:!1,change:this.changeFirstLineIndent}),this.byIn.appendTo(T),this.beforeSpacingIn=new l.NumericTextBox({format:"n1",value:0,min:0,max:1584,width:180,step:6,enablePersistence:!1,change:this.changeBeforeSpacing}),this.beforeSpacingIn.appendTo(N),this.afterSpacingIn=new l.NumericTextBox({format:"n1",value:0,min:0,max:1584,width:180,step:6,enablePersistence:!1,change:this.changeAfterSpacing}),this.afterSpacingIn.appendTo(B),this.atIn=new l.NumericTextBox({format:"n1",value:0,min:1,max:1584,width:180,step:.5,enablePersistence:!1,change:this.changeLineSpacingValue}),this.special=new s.DropDownList({change:this.changeByValue,width:180}),this.special.appendTo(C),this.lineSpacing=new s.DropDownList({change:this.changeBySpacing,width:"180px"}),this.lineSpacing.appendTo(L),this.alignment=new s.DropDownList({width:180,change:this.changeByTextAlignment}),this.alignment.appendTo(c),this.atIn.appendTo(R),this.target.addEventListener("keyup",i.keyUpParagraphSettings)},e.prototype.onParagraphFormat=function(e){this.owner.owner.editorModule.initHistory("ParagraphFormat");var t=this.owner.selection;this.owner.owner.isShiftingEnabled=!0,this.owner.selection.isEmpty?(this.owner.owner.editorModule.applyParaFormatProperty(t.start.paragraph,void 0,e,!1),this.owner.owner.editor.layoutItemBlock(t.start.paragraph,!1)):this.owner.owner.editorModule.updateSelectionParagraphFormatting("ParagraphFormat",e,!1),this.owner.owner.editorModule.reLayout(t)},e.prototype.show=function(e){e&&(this.paragraphFormat=e);var i=new t.L10n("documenteditor",this.owner.owner.defaultLocale);i.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initParagraphDialog(i),this.loadParagraphDialog(),this.owner.dialog.header="Paragraph",this.owner.dialog.content=this.target,this.owner.dialog.height="auto",this.owner.dialog.width="auto",this.owner.dialog.buttons=[{click:this.applyParagraphFormat,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-para-okay",isPrimary:!0}},{click:this.closeParagraphDialog,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-para-cancel"}}],this.owner.dialog.beforeOpen=this.owner.updateFocus,this.owner.dialog.close=this.owner.updateFocus,this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.destroy=function(){if(this.afterSpacingIn&&(this.afterSpacingIn.destroy(),this.afterSpacingIn=void 0),this.beforeSpacingIn&&(this.beforeSpacingIn.destroy(),this.beforeSpacingIn=void 0),this.leftIndentIn&&(this.leftIndentIn.destroy(),this.leftIndentIn=void 0),this.rightIndentIn&&(this.rightIndentIn.destroy(),this.rightIndentIn=void 0),this.byIn&&(this.byIn.destroy(),this.byIn=void 0),this.atIn&&(this.atIn.destroy(),this.atIn=void 0),this.alignment&&(this.alignment.change=void 0,this.alignment.destroy()),this.alignment=void 0,this.lineSpacing&&(this.lineSpacing.change=void 0,this.lineSpacing.destroy()),this.lineSpacing=void 0,this.special&&(this.special.change=void 0,this.special.destroy()),this.special=void 0,this.owner=void 0,!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},e}(),ct=function(){function e(){this.listIn=void 0,this.levelNumberIn=void 0,this.dialog=void 0,this.levelNumber=0}return Object.defineProperty(e.prototype,"levelNumber",{get:function(){return this.levelNumberIn},set:function(e){this.levelNumberIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this.listIn},set:function(e){t.isNullOrUndefined(e)?this.createList():this.listIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevel",{get:function(){if(!t.isNullOrUndefined(this.list)&&this.levelNumber>=0&&this.levelNumber<9){if(t.isNullOrUndefined(this.dialog.owner.getAbstractListById(this.list.abstractListId))){this.dialog.owner.lists.push(this.list);var e=this.list.abstractList;this.list.abstractList||((e=new de).abstractListId=this.list.abstractListId);var i=new he(e);return i.characterFormat=new P(i),i.paragraphFormat=new F(i),i.paragraphFormat.leftIndent=48,i.paragraphFormat.firstLineIndent=-24,i.numberFormat="%"+1..toString()+".",i.listLevelPattern="UpRoman",i.followCharacter="Tab",i.startAt=1,i.restartLevel=1,this.dialog.owner.abstractLists.push(e),this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[0]}return this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length<=this.levelNumber&&this.addListLevels(),this.dialog.owner.getAbstractListById(this.list.abstractListId).levels[this.levelNumber]}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listLevelPattern",{get:function(){return t.isNullOrUndefined(this.listLevel)?"Arabic":this.listLevel.listLevelPattern},set:function(e){t.isNullOrUndefined(this.listLevel)||(this.listLevel.listLevelPattern=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"followCharacter",{get:function(){return t.isNullOrUndefined(this.listLevel)?"None":this.listLevel.followCharacter},set:function(e){t.isNullOrUndefined(this.listLevel)||(this.listLevel.followCharacter=e)},enumerable:!0,configurable:!0}),e.prototype.createList=function(){this.list=new b,this.list.listId=this.dialog.owner.lists.length+1;var e=new de;e.abstractListId=this.dialog.owner.abstractLists.length+1,this.list.abstractListId=e.abstractListId,this.dialog.owner.lists.push(this.list);var t=new he(e);t.paragraphFormat=new F(t),t.paragraphFormat.leftIndent=48,t.paragraphFormat.firstLineIndent=-24,t.characterFormat=new P(t),t.numberFormat="%1.",t.startAt=1,e.levels.push(t),this.dialog.owner.abstractLists.push(e)},e.prototype.addListLevels=function(){if(!t.isNullOrUndefined(this.list)&&!t.isNullOrUndefined(this.list.abstractListId))for(var e=this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.length;e<9;e++){var i=new he(this.dialog.owner.getAbstractListById(this.list.abstractListId));i.characterFormat=new P(i),i.paragraphFormat=new F(i),i.paragraphFormat.leftIndent=48*(e+1),i.paragraphFormat.firstLineIndent=-24,i.numberFormat="%"+(e+1).toString()+".",i.listLevelPattern="Arabic",i.followCharacter="Tab",i.startAt=1,i.restartLevel=e,this.dialog.owner.getAbstractListById(this.list.abstractListId).levels.push(i)}},e.prototype.destroy=function(){this.list=void 0,this.followCharacter=void 0,this.levelNumber=void 0,this.listLevelPattern=void 0},e}(),pt=function(){function e(e){var i=this;this.dialog=void 0,this.target=void 0,this.owner=void 0,this.viewModel=void 0,this.startAt=void 0,this.textIndent=void 0,this.alignedAt=void 0,this.listLevelElement=void 0,this.followNumberWith=void 0,this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy=void 0,this.isListCharacterFormat=!1,this.onTextIndentChanged=function(e){i.viewModel.listLevel.paragraphFormat.leftIndent=e.value},this.onStartValueChanged=function(e){i.viewModel.listLevel.startAt=e.value},this.onListLevelValueChanged=function(e){i.viewModel.levelNumber=parseInt(e.value.slice(e.value.length-1),10)-1,t.isNullOrUndefined(i.listLevel)||(t.isNullOrUndefined(i.listLevel.characterFormat)&&(i.listLevel.characterFormat=new P(i.viewModel.listLevel)),t.isNullOrUndefined(i.listLevel.paragraphFormat)||(i.listLevel.paragraphFormat=new F(i.viewModel.listLevel)),i.updateDialogValues(),i.updateRestartLevelBox())},this.onNumberFormatChanged=function(e){i.viewModel.listLevel.numberFormat=e.target.value},this.onAlignedAtValueChanged=function(e){i.viewModel.listLevel.paragraphFormat.firstLineIndent=e.value},this.onFollowCharacterValueChanged=function(e){e.value&&(i.viewModel.followCharacter=e.value)},this.onLevelPatternValueChanged=function(e){i.viewModel.listLevelPattern=e.value;var t="%"+(i.levelNumber+1).toString(),r=document.getElementById(i.owner.owner.containerId+"_numberFormat");"Bullet"===i.listLevel.listLevelPattern?(i.listLevel.numberFormat="",r.value=i.listLevel.numberFormat,i.listLevel.characterFormat.fontFamily="Wingdings"):("None"===i.listLevel.listLevelPattern&&(i.listLevel.numberFormat=""),i.listLevel.numberFormat.match(t)||"None"===i.listLevel.listLevelPattern||(i.listLevel.numberFormat=t+"."),r.value=i.listLevel.numberFormat)},this.loadListDialog=function(){i.owner.updateFocus(),t.isNullOrUndefined(i.owner.owner)||(i.viewModel=new ct,i.viewModel.dialog=i,i.owner.selection.paragraphFormat.listLevelNumber>0&&(i.viewModel.levelNumber=i.owner.selection.paragraphFormat.listLevelNumber),i.viewModel.list=i.owner.selection.paragraphFormat.getList(),t.isNullOrUndefined(i.listLevel)||(t.isNullOrUndefined(i.listLevel.characterFormat)&&(i.listLevel.characterFormat=new P(i.viewModel.listLevel)),t.isNullOrUndefined(i.listLevel.paragraphFormat)&&(i.listLevel.paragraphFormat=new F(i.viewModel.listLevel)),i.updateDialogValues(),"none"!==i.owner.selection.caret.style.display&&(i.owner.selection.caret.style.display="none")))},this.showFontDialog=function(){i.owner.owner.fontDialogModule.showFontDialog(i.listLevel.characterFormat)},this.onApplyList=function(){t.isNullOrUndefined(i.owner)||i.owner.selection.paragraphFormat.setList(i.list),i.owner.dialog2.hide(),i.owner.updateFocus()},this.onCancelButtonClick=function(){i.disposeBindingForListUI(),i.owner.dialog2.hide(),i.owner.updateFocus(),i.isListCharacterFormat=!1},this.closeListDialog=function(){i.disposeBindingForListUI(),i.owner.updateFocus(),i.isListCharacterFormat=!1},this.owner=e,this.viewModel=new ct}return Object.defineProperty(e.prototype,"listLevel",{get:function(){if(!t.isNullOrUndefined(this.viewModel))return this.viewModel.listLevel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){if(!t.isNullOrUndefined(this.viewModel))return this.viewModel.list},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levelNumber",{get:function(){return this.listLevel.ownerBase instanceof w?this.listLevel.ownerBase.levelNumber:this.listLevel.ownerBase instanceof de&&!t.isNullOrUndefined(this.listLevel.ownerBase.levels)?this.listLevel.ownerBase.levels.indexOf(this.listLevel):-1},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"ListDialog"},e.prototype.showListDialog=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initListDialog(e),this.isListCharacterFormat=!0,this.owner.dialog2.header=e.getConstant("Define new Multilevel list"),this.owner.dialog2.height="auto",this.owner.dialog2.width="auto",this.owner.dialog2.content=this.target,this.owner.dialog2.buttons=[{click:this.showFontDialog,buttonModel:{content:e.getConstant("Font"),cssClass:"e-flat e-list-dlg-font e-font"}},{click:this.onApplyList,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-list-dlg",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-list-dlg"}}],this.owner.dialog2.dataBind(),this.owner.dialog2.beforeOpen=this.loadListDialog,this.owner.dialog2.close=this.closeListDialog,this.owner.dialog2.position={X:"center",Y:"top"},this.owner.dialog2.show()},e.prototype.initListDialog=function(e){var i=this,r=this.owner.owner.containerId,o=r+"_insert_list";this.target=t.createElement("div",{id:o,className:"e-de-list-dlg"}),this.owner.owner.element.appendChild(this.target);var a=t.createElement("div",{innerHTML:'<label id="'+r+'_listLevellabel" style="display:block;" class=e-de-list-ddl-header-list-level>'+e.getConstant("List level")+'</label><label id="'+r+'_modifyLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Choose level to modify")+'</label><select style="height:20px;width:43%" id="'+r+'_listLevel"><option>'+e.getConstant("Level")+" 1</option><option>"+e.getConstant("Level")+" 2</option><option>"+e.getConstant("Level")+" 3</option><option>"+e.getConstant("Level")+" 4</option><option>"+e.getConstant("Level")+" 5</option><option>"+e.getConstant("Level")+" 6</option><option>"+e.getConstant("Level")+" 7</option><option>"+e.getConstant("Level")+" 8</option><option>"+e.getConstant("Level")+" 9</option></select>"});this.target.appendChild(a);var d=t.createElement("div"),h=t.createElement("div",{innerHTML:'<div style="float:left;display:block;"><label id="'+r+'_numberFormatLabel" style="display:block;" class=e-de-list-ddl-header>'+e.getConstant("Number format")+'</label><label id="'+r+'_numberStyleLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Number style for this level")+'</label><select style="height:20px;width:100%" id="'+r+'_numberStyle"><option>'+e.getConstant("Arabic")+"</option><option>"+e.getConstant("UpRoman")+"</option><option>"+e.getConstant("LowRoman")+"</option><option>"+e.getConstant("UpLetter")+"</option><option>"+e.getConstant("LowLetter")+"</option><option>"+e.getConstant("Number")+"</option><option>"+e.getConstant("Leading zero")+"</option><option>"+e.getConstant("Bullet")+"</option><option>"+e.getConstant("Ordinal")+"</option><option>"+e.getConstant("Ordinal Text")+"</option><option>"+e.getConstant("Special")+"</option><option>"+e.getConstant("For East")+'</option></select><label id="'+r+'_startAtLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Start at")+'</label><input type="text" id="'+r+'_startAt">'});d.appendChild(h);var c=t.createElement("div",{className:"e-de-list-dlg-subdiv",innerHTML:'<div><div><label id="'+r+'_formatLabel" style="display:inline-block;width:86%" class=e-de-list-ddl-subheader>'+e.getConstant("Enter formatting for number")+'</label><button id="'+r+'_list_info" class="e-control e-btn e-primary e-de-list-format-info">i</button></div><input style=width:180px; type="text" id="'+r+'_numberFormat" class=e-input></div><label id="'+r+'_restartLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Restart list after")+'</label><select style="height:20px;width:100%" id="'+r+'_restartBy"><option>'+e.getConstant("No Restart")+"</option></select></div>"});d.appendChild(c),this.target.appendChild(d);var p=t.createElement("div",{innerHTML:'<div style="float:left;display:block;"><label id="'+r+'_IndentsLabel" style="display:block;" class=e-de-list-ddl-header>'+e.getConstant("Position")+'</label><label id="'+r+'_textIndentLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Text indent at")+'</label><input type="text" id="'+r+'_textIndent"><label id="'+r+'_followCharacterLabel" style="display:block;" class=e-de-list-ddl-subheaderbottom>'+e.getConstant("Follow number with")+'</label><select style="height:20px;width:100%" id="'+r+'_followCharacter"><option>'+e.getConstant("Tab character")+"</option><option>"+e.getConstant("Space")+"</option><option>"+e.getConstant("Nothing")+'</option></select></div><div class="e-de-list-dlg-div"><label id="'+r+'_alignedAtLabel" style="display:block;" class=e-de-list-ddl-subheader>'+e.getConstant("Aligned at")+'</label><input type="text" id="'+r+'_alignedAt"></div>'});this.target.appendChild(p);var g=document.getElementById(r+"_startAt"),u=document.getElementById(r+"_textIndent"),f=document.getElementById(r+"_alignedAt");this.startAt=new l.NumericTextBox({format:"#",decimals:0,min:0,max:50,width:"180px",enablePersistence:!1}),this.startAt.addEventListener("change",i.onStartValueChanged),this.startAt.appendTo(g),this.textIndent=new l.NumericTextBox({format:"#",decimals:0,min:0,max:1584,width:"180px",step:4,enablePersistence:!1}),this.textIndent.addEventListener("change",i.onTextIndentChanged),this.textIndent.appendTo(u),this.alignedAt=new l.NumericTextBox({format:"#",max:1584,step:6,width:"180px",enablePersistence:!1}),this.alignedAt.addEventListener("change",i.onAlignedAtValueChanged),this.alignedAt.appendTo(f);var m=document.getElementById(r+"_listLevel");this.listLevelElement=new s.DropDownList({popupHeight:"150px",width:"180px",change:i.onListLevelValueChanged}),this.listLevelElement.appendTo(m);var v=document.getElementById(r+"_followCharacter");this.followNumberWith=new s.DropDownList({popupHeight:"150px",width:"180px",change:i.onFollowCharacterValueChanged}),this.followNumberWith.appendTo(v);var y=document.getElementById(r+"_numberStyle");this.numberStyle=new s.DropDownList({popupHeight:"150px",width:"180px",change:i.onLevelPatternValueChanged}),this.numberStyle.appendTo(y),this.numberFormat=document.getElementById(r+"_numberFormat"),this.numberFormat.addEventListener("change",i.onNumberFormatChanged);var w=document.getElementById(r+"_restartBy");this.restartBy=new s.DropDownList({popupHeight:"150px",width:"180px"}),this.restartBy.appendTo(w);var b=document.getElementById(r+"_list_info");this.formatInfoToolTip=new n.Tooltip({width:200}),this.formatInfoToolTip.content=e.getConstant("Number format tooltip information"),this.formatInfoToolTip.position="RightTop",this.formatInfoToolTip.appendTo(b)},e.prototype.updateRestartLevelBox=function(){for(var e=this.owner.owner.containerId,t=document.getElementById(e+"_listLevel"),i=document.getElementById(e+"_restartBy"),r=0;r<i.options.length;r)i.options.remove(r);if(0===t.selectedIndex)(o=document.createElement("option")).value="No Restart",o.innerHTML="No Restart",i.appendChild(o);else{for(r=t.selectedIndex;r>0;r--){var n=document.createElement("option");n.value="Level "+r,n.innerHTML="Level "+r,i.appendChild(n)}var o=document.createElement("option");o.value="No Restart",o.innerHTML="No Restart",i.appendChild(o)}i.selectedIndex=0},e.prototype.listPatternConverter=function(e){switch(e){case"Arabic":return 0;case"UpRoman":return 1;case"LowRoman":return 2;case"UpLetter":return 3;case"LowLetter":return 4;case"Number":return 5;case"LeadingZero":return 6;case"Bullet":return 7;case"Ordinal":return 8;case"OrdinalText":return 9;case"Special":return 10;case"FarEast":return 11;default:return 12}},e.prototype.followCharacterConverter=function(e){switch(e){case"Tab":return 0;case"Space":return 1;default:return 2}},e.prototype.updateDialogValues=function(){document.getElementById(this.owner.owner.containerId+"_restartBy");this.startAt.value=this.viewModel.listLevel.startAt,this.textIndent.value=this.viewModel.listLevel.paragraphFormat.leftIndent,this.alignedAt.value=this.viewModel.listLevel.paragraphFormat.firstLineIndent,this.followNumberWith.index=this.followCharacterConverter(this.viewModel.followCharacter),this.numberFormat.value=this.viewModel.listLevel.numberFormat,this.numberStyle.index=this.listPatternConverter(this.viewModel.listLevelPattern),this.listLevelElement.index=this.viewModel.levelNumber,this.viewModel.levelNumber=this.viewModel.levelNumber},e.prototype.disposeBindingForListUI=function(){this.followNumberWith.index=-1,this.numberFormat.value=" ",this.numberStyle.index=-1,this.listLevelElement.index=-1,this.restartBy.index=-1,this.viewModel.destroy()},e.prototype.destroy=function(){if(this.alignedAt&&this.alignedAt.destroy(),this.alignedAt=void 0,this.dialog=void 0,this.followNumberWith&&this.followNumberWith.destroy(),this.followNumberWith=void 0,this.listLevelElement&&this.listLevelElement.destroy(),this.listLevelElement=void 0,this.textIndent&&this.textIndent.destroy(),this.textIndent=void 0,this.startAt&&this.startAt.destroy(),this.startAt=void 0,this.numberStyle&&this.numberStyle.destroy(),this.numberStyle=void 0,this.numberFormat=void 0,this.restartBy&&this.restartBy.destroy(),this.restartBy=void 0,!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.owner=void 0,this.viewModel=void 0},e}(),gt=function(){function e(e){var i=this;this.target=void 0,this.styleType=void 0,this.styleBasedOn=void 0,this.styleParagraph=void 0,this.onlyThisDocument=void 0,this.template=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.characterFormat=void 0,this.paragraphFormat=void 0,this.openDialog=function(e){switch(e.item.id){case"style_font":i.showFontDialog();break;case"style_paragraph":i.showParagraphDialog();break;case"style_numbering":i.showNumberingBulletDialog()}},this.setBoldProperty=function(){i.characterFormat.bold=!i.characterFormat.bold,i.fontButtonClicked(void 0)},this.setItalicProperty=function(){i.characterFormat.italic=!i.characterFormat.italic,i.fontButtonClicked(void 0)},this.setUnderlineProperty=function(){i.characterFormat.underline="None"===i.characterFormat.underline?"Single":"None",i.fontButtonClicked(void 0)},this.fontButtonClicked=function(e){i.characterFormat.bold?i.bold.classList.contains("e-active")||i.bold.classList.add("e-active"):i.bold.classList.contains("e-active")&&i.bold.classList.remove("e-active"),i.characterFormat.italic?i.italic.classList.contains("e-active")||i.italic.classList.add("e-active"):i.italic.classList.contains("e-active")&&i.italic.classList.remove("e-active"),void 0!==i.characterFormat.underline&&"None"!==i.characterFormat.underline?i.underline.classList.contains("e-active")||(i.underline.classList.add("e-active"),i.characterFormat.underline="Single"):i.underline.classList.contains("e-active")&&(i.underline.classList.remove("e-active"),i.characterFormat.underline="None")},this.fontSizeUpdate=function(e){i.characterFormat.fontSize=e.value},this.fontFamilyChanged=function(e){i.characterFormat.fontFamily=e.value},this.fontColorUpdate=function(e){i.characterFormat.fontColor=e.currentValue.rgba},this.setLeftAlignment=function(){"Left"===i.paragraphFormat.textAlignment?i.paragraphFormat.textAlignment="Justify":i.paragraphFormat.textAlignment="Left",i.updateParagraphFormat()},this.setRightAlignment=function(){"Right"===i.paragraphFormat.textAlignment?i.paragraphFormat.textAlignment="Left":i.paragraphFormat.textAlignment="Right",i.updateParagraphFormat()},this.setCenterAlignment=function(){"Center"===i.paragraphFormat.textAlignment?i.paragraphFormat.textAlignment="Left":i.paragraphFormat.textAlignment="Center",i.updateParagraphFormat()},this.setJustifyAlignment=function(){"Justify"===i.paragraphFormat.textAlignment?i.paragraphFormat.textAlignment="Left":i.paragraphFormat.textAlignment="Justify",i.updateParagraphFormat()},this.increaseBeforeAfterSpacing=function(){i.paragraphFormat.beforeSpacing+=6,i.paragraphFormat.afterSpacing+=6},this.decreaseBeforeAfterSpacing=function(){i.paragraphFormat.beforeSpacing>=6?i.paragraphFormat.beforeSpacing-=6:i.paragraphFormat.beforeSpacing=0,i.paragraphFormat.afterSpacing>=6?i.paragraphFormat.afterSpacing-=6:i.paragraphFormat.afterSpacing=0},this.updateNextStyle=function(e){var r=e.srcElement.value;if("Paragraph"===i.getTypeValue()&&!t.isNullOrUndefined(r)&&""!==r&&!i.isUserNextParaUpdated){var n=i.owner.owner.viewer.styles.getStyleNames(i.getTypeValue());i.isEdit&&(n=n.filter(function(e){return e!==i.editStyleName})),n.push(r),i.styleParagraph.dataSource=n,i.styleParagraph.index=null,i.styleParagraph.index=n.indexOf(r),i.styleParagraph.dataBind()}},this.updateOkButton=function(){i.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0).value;i.enableOrDisableOkButton()},this.styleTypeChange=function(e){if(e.isInteracted){var t=void 0;"Character"===e.value&&(i.style=new O,t="Character"),"Paragraph"!==e.value&&"Linked(Paragraph and Character)"!==e.value||(i.style=new N,t="Paragraph"),i.toggleDisable(),i.updateStyleNames(t)}},this.styleBasedOnChange=function(e){},this.styleParagraphChange=function(e){e.isInteracted&&(i.isUserNextParaUpdated=!0)},this.showFontDialog=function(){t.isNullOrUndefined(i.owner.owner.fontDialogModule)||i.owner.owner.showFontDialog(i.characterFormat),i.updateCharacterFormat()},this.showParagraphDialog=function(){t.isNullOrUndefined(i.owner.owner.paragraphDialogModule)||i.owner.owner.showParagraphDialog(i.paragraphFormat)},this.showNumberingBulletDialog=function(){i.numberingBulletDialog=new ut(i.owner.owner.viewer),i.style instanceof N&&!t.isNullOrUndefined(i.style.paragraphFormat)&&i.numberingBulletDialog.showNumberBulletDialog(i.style.paragraphFormat.listFormat,i.abstractList)},this.onOkButtonClick=function(){var e=i.styleNameElement.value;if(!(e.length>0))throw new Error("Enter valid Style name");var r,n=i.owner.owner.viewer.styles.findByName(e);if(t.isNullOrUndefined(n)){var o=i.owner.owner.viewer.styles.findByName(i.styleBasedOn.value);"Paragraph"!==i.styleType.value&&"Linked(Paragraph and Character)"!==i.styleType.value||(e===i.styleParagraph.value?i.style.next=i.style:i.style.next=i.owner.owner.viewer.styles.findByName(i.styleParagraph.value),i.updateList()),i.style.link="Linked(Paragraph and Character)"===i.styleType.value?i.createLinkStyle(e):void 0,i.style.type=i.getTypeValue(),i.style.name=e,i.style.basedOn=o,i.owner.owner.viewer.styles.push(i.style),r=e,i.owner.owner.editorModule.applyStyle(r)}else i.style.type=i.getTypeValue(),i.style.basedOn=i.owner.owner.viewer.styles.findByName(i.styleBasedOn.value),"Paragraph"!==i.styleType.value&&"Linked(Paragraph and Character)"!==i.styleType.value||(i.style.next=i.owner.owner.viewer.styles.findByName(i.styleParagraph.value),i.style.characterFormat.mergeFormat(n.characterFormat),i.style.paragraphFormat.mergeFormat(n.paragraphFormat),i.updateList(),i.style.link="Linked(Paragraph and Character)"===i.styleType.value?i.createLinkStyle(e,i.isEdit):void 0),i.style.name=n.name,r=n.name,n=i.style,i.owner.owner.isShiftingEnabled=!0,i.owner.owner.editorModule.layoutWholeDocument(),i.owner.owner.isShiftingEnabled=!1;i.owner.owner.viewer.dialog2.hide(),i.style},this.loadStyleDialog=function(e){i.owner.owner.viewer.updateFocus(),i.isUserNextParaUpdated=!1,i.styleNameElement=i.target.getElementsByClassName("e-input e-de-style-dlg-name-input").item(0),i.styleNameElement.value=null,i.isEdit||(i.styleType.index=0);var t;i.isEdit&&(i.styleNameElement.value=i.editStyleName,t=i.editStyleName),i.okButton=i.owner.dialog2.element.getElementsByClassName("e-flat e-style-okay").item(0),i.enableOrDisableOkButton(),i.updateStyleNames(i.getTypeValue(),t),i.updateCharacterFormat(i.style.characterFormat),i.updateParagraphFormat(i.style.paragraphFormat)},this.onCancelButtonClick=function(){!i.isEdit&&i.style&&i.style.destroy(),i.owner.owner.viewer.dialog2.hide()},this.closeStyleDialog=function(){i.owner.owner.viewer.updateFocus()},this.owner=e}return e.prototype.getModuleName=function(){return"StyleDialog"},e.prototype.initStyleDialog=function(e){var i=this.owner.owner.containerId+"_style";this.target=t.createElement("div",{id:i,className:"e-de-style-dialog"});var r=t.createElement("div"),n=t.createElement("div",{className:"e-de-style-properties",innerHTML:e.getConstant("Properties")});r.appendChild(n);var o=t.createElement("div",{styles:"display:flex",className:"e-de-style-nametype-div"});r.appendChild(o);var a=t.createElement("div",{className:"e-de-style-left-div"});o.appendChild(a);var l=t.createElement("div",{className:"e-de-style-name",innerHTML:e.getConstant("Name")+":"});a.appendChild(l);var d=t.createElement("input",{id:this.owner.owner.containerId+"_style_name",styles:"width:210px;",className:"e-input e-de-style-dlg-name-input"});d.addEventListener("keyup",this.updateOkButton),d.addEventListener("input",this.updateOkButton),d.addEventListener("blur",this.updateNextStyle),a.appendChild(d);var h=t.createElement("div");o.appendChild(h);var c=t.createElement("div",{className:"e-de-style-styletype",innerHTML:e.getConstant("Style type")+":"});h.appendChild(c);var p=t.createElement("div",{className:"e-de-style-style-type-div"}),g=t.createElement("select",{id:"e-de-style-style-type"});g.innerHTML="<option>Paragraph</option><option>Character</option><option>Linked(Paragraph and Character)</option>",p.appendChild(g),this.styleType=new s.DropDownList({change:this.styleTypeChange,popupHeight:"253px",width:"210px"}),this.styleType.appendTo(g),h.appendChild(p);var u=t.createElement("div",{styles:"display:flex",className:"e-de-style-based-para-div"});r.appendChild(u);var f=t.createElement("div",{className:"e-de-style-left-div"});u.appendChild(f);var m=t.createElement("div",{className:"e-de-style-style-based-on",innerHTML:e.getConstant("Style based on")+":"});f.appendChild(m);var v=t.createElement("div",{className:"e-de-style-style-based-on-div"}),y=t.createElement("input",{id:"e-de-style-style-based-on-value"});v.appendChild(y),this.styleBasedOn=new s.DropDownList({dataSource:[],select:this.styleBasedOnChange,popupHeight:"253px",width:"210px"}),this.styleBasedOn.appendTo(y),f.appendChild(v);var w=t.createElement("div",{className:"e-de-style-left-div"});u.appendChild(w);var b=t.createElement("div",{className:"e-de-style-style-paragraph",innerHTML:e.getConstant("Style for following paragraph")+":"});w.appendChild(b);var x=t.createElement("div",{className:"e-de-style-style-paragraph-div"}),C=t.createElement("input",{id:"e-de-style-style-paragraph-value"});x.appendChild(C),this.styleParagraph=new s.DropDownList({dataSource:[],select:this.styleParagraphChange,popupHeight:"253px",width:"210px"}),this.styleParagraph.appendTo(C),w.appendChild(x);var F=t.createElement("div",{className:"e-de-style-formatting",innerHTML:e.getConstant("Formatting")});r.appendChild(F);var P=t.createElement("div",{className:"e-de-style-options-div"});r.appendChild(P);var W=t.createElement("div",{styles:"display:flex;margin-bottom: 15px;"});P.appendChild(W),this.createFontOptions(W);var T=t.createElement("div",{styles:"display:flex",className:"e-style-paragraph"});P.appendChild(T),this.createParagraphOptions(T),this.createFormatDropdown(r,e),this.target.appendChild(r)},e.prototype.createFormatDropdown=function(e,i){var r=this,n=t.createElement("button",{id:"style_format_dropdown",innerHTML:i.getConstant("Format")});n.style.height="35px",e.appendChild(n);var o=[{text:i.getConstant("Font")+"..",id:"style_font"},{text:i.getConstant("Paragraph")+"..",id:"style_paragraph"},{text:i.getConstant("Numbering")+"..",id:"style_numbering"}],a=new h.DropDownButton({items:o,cssClass:"e-de-style-format-dropdwn",beforeItemRender:function(e){"Character"===r.styleType.value?("Paragraph"===e.item.text&&e.element.classList.add("e-disabled"),"Numbering"===e.item.text&&e.element.classList.add("e-disabled")):("Paragraph"===e.item.text&&e.element.classList.remove("e-disabled"),"Numbering"===e.item.text&&e.element.classList.remove("e-disabled"))}});a.appendTo(n),a.addEventListener("select",this.openDialog)},e.prototype.createFontOptions=function(e){var i=t.createElement("select",{id:this.target.id+"_fontName"});i.innerHTML="<option>Arial</option><option>Calibri</option><option>Candara</option><option>Comic Sans MS</option><option>Consolas</option><option>Constantia</option><option>Corbel</option><option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option><option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option><option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option><option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option><option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>",e.appendChild(i),this.fontFamily=new s.ComboBox({width:"123px",popupWidth:"123px",cssClass:"e-style-font-fmaily-right",change:this.fontFamilyChanged}),this.fontFamily.showClearButton=!1,this.fontFamily.appendTo(i);var r=t.createElement("input");e.appendChild(r);var n=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];this.fontSize=new s.ComboBox({dataSource:n,width:"73px",cssClass:"e-style-font-fmaily-right",change:this.fontSizeUpdate}),this.fontSize.showClearButton=!1,this.fontSize.appendTo(r);var o=t.createElement("div",{className:"e-de-style-font-group-button"});e.appendChild(o),this.bold=this.createButtonElement(o,"e-de-bold","e-de-style-bold-button-size",this.owner.owner.containerId+"_style_bold"),this.bold.addEventListener("click",this.setBoldProperty),this.italic=this.createButtonElement(o,"e-de-italic","e-de-style-icon-button-size",this.owner.owner.containerId+"_style_italic"),this.italic.addEventListener("click",this.setItalicProperty),this.underline=this.createButtonElement(o,"e-de-underline","e-de-style-icon-button-size",this.owner.owner.containerId+"_style_underline"),this.underline.addEventListener("click",this.setUnderlineProperty);var a=t.createElement("input",{attrs:{type:"color"},className:"e-de-style-icon-button-size"});e.appendChild(a),this.fontColor=new l.ColorPicker({cssClass:"e-de-style-font-color-picker",change:this.fontColorUpdate}),this.fontColor.appendTo(a)},e.prototype.createParagraphOptions=function(e){var i=this,r=t.createElement("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(r),this.leftAlign=this.createButtonElement(r,"e-de-align-left","e-de-style-icon-button-size"),this.leftAlign.addEventListener("click",this.setLeftAlignment),this.centerAlign=this.createButtonElement(r,"e-de-align-center","e-de-style-icon-button-size"),this.centerAlign.addEventListener("click",this.setCenterAlignment),this.rightAlign=this.createButtonElement(r,"e-de-align-right","e-de-style-icon-button-size"),this.rightAlign.addEventListener("click",this.setRightAlignment),this.justify=this.createButtonElement(r,"e-de-justify","e-de-style-icon-button-last-size"),this.justify.addEventListener("click",this.setJustifyAlignment);var n=t.createElement("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(n),this.singleLineSpacing=this.createButtonElement(n,"e-de-single-spacing","e-de-style-icon-button-first-size"),this.singleLineSpacing.addEventListener("click",function(){i.paragraphFormat.lineSpacing=1,i.updateParagraphFormat()}),this.onePointFiveLineSpacing=this.createButtonElement(n,"e-de-one-point-five-spacing","e-de-style-icon-button-size"),this.onePointFiveLineSpacing.addEventListener("click",function(){i.paragraphFormat.lineSpacing=1.5,i.updateParagraphFormat()}),this.doubleLineSpacing=this.createButtonElement(n,"e-de-double-spacing","e-de-style-icon-button-last-size"),this.doubleLineSpacing.addEventListener("click",function(){i.paragraphFormat.lineSpacing=2,i.updateParagraphFormat()});var o=t.createElement("div",{className:"e-de-style-paragraph-group-button"});e.appendChild(o);var a=this.createButtonElement(o,"e-de-before-spacing","e-de-style-icon-button-first-size"),s=this.createButtonElement(o,"e-de-after-spacing","e-de-style-icon-button-last-size");a.addEventListener("click",this.increaseBeforeAfterSpacing),s.addEventListener("click",this.decreaseBeforeAfterSpacing);var l=t.createElement("div",{className:"e-de-style-paragraph-indent-group-button"});e.appendChild(l),this.createButtonElement(l,"e-de-indent","e-de-style-icon-button-first-size").addEventListener("click",function(){i.paragraphFormat.leftIndent>=36?i.paragraphFormat.leftIndent-=36:i.paragraphFormat.leftIndent=0}),this.createButtonElement(l,"e-de-outdent","e-de-style-icon-button-size").addEventListener("click",function(){i.paragraphFormat.leftIndent+=36})},e.prototype.createButtonElement=function(e,i,r,n){var a=t.createElement("button");return t.isNullOrUndefined(n)||(a.id=n),e.appendChild(a),new o.Button({iconCss:i,cssClass:r}).appendTo(a),a},e.prototype.toggleDisable=function(){"Character"===this.styleType.value?(this.styleParagraph.enabled=!1,this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex;pointer-events:none;opacity:0.5")):(this.styleParagraph.enabled=!0,this.target.getElementsByClassName("e-style-paragraph").item(0).removeAttribute("style"),this.target.getElementsByClassName("e-style-paragraph").item(0).setAttribute("style","display:flex")),this.styleBasedOn.enabled=!0},e.prototype.show=function(e,i){var r=new t.L10n("documenteditor",this.owner.owner.defaultLocale);this.isEdit=!t.isNullOrUndefined(e)&&e.length>0,this.editStyleName=e,this.abstractList=new de;var n=this.owner.owner.viewer.styles.findByName(e);this.style=this.isEdit?n||this.getStyle(e):new N,r.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initStyleDialog(r),t.isNullOrUndefined(i)&&(i=r.getConstant("Create New Style")),this.owner.owner.viewer.dialog2.header=i,this.owner.owner.viewer.dialog2.height="auto",this.owner.owner.viewer.dialog2.width="auto",this.owner.owner.viewer.dialog2.content=this.target,this.owner.owner.viewer.dialog2.buttons=[{click:this.onOkButtonClick,buttonModel:{content:r.getConstant("Ok"),cssClass:"e-flat e-style-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:r.getConstant("Cancel"),cssClass:"e-flat e-style-cancel"}}],this.toggleDisable(),this.owner.owner.viewer.dialog2.dataBind(),this.owner.owner.viewer.dialog2.beforeOpen=this.loadStyleDialog,this.owner.owner.viewer.dialog2.close=this.closeStyleDialog,this.owner.owner.viewer.dialog2.position={X:"center",Y:"center"},this.owner.owner.viewer.dialog2.show()},e.prototype.updateList=function(){var e=this.style.paragraphFormat.listFormat.listId;e>-1&&(0===this.owner.owner.viewer.lists.filter(function(t){return t.listId===e}).length?this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list):(this.owner.owner.viewer.lists=this.owner.owner.viewer.lists.filter(function(t){return t.listId!==e}),this.owner.owner.viewer.lists.push(this.style.paragraphFormat.listFormat.list))),-1!==this.abstractList.abstractListId&&this.owner.owner.viewer.abstractLists.push(this.abstractList)},e.prototype.createLinkStyle=function(e,t){var i;return i=t?this.owner.owner.viewer.styles.findByName(e+" Char","Character"):new O,i.type="Character",i.name=e+" Char",i.characterFormat=this.style.characterFormat.cloneFormat(),i.basedOn=this.style.basedOn,t||this.owner.owner.viewer.styles.push(i),this.owner.owner.viewer.styles.findByName(i.name,"Character")},e.prototype.updateCharacterFormat=function(e){t.isNullOrUndefined(e)||(this.characterFormat=e),this.fontFamily.value=this.characterFormat.fontFamily,this.fontSize.value=this.characterFormat.fontSize,this.fontColor.value=this.characterFormat.fontColor,this.fontButtonClicked(void 0)},e.prototype.updateParagraphFormat=function(e){t.isNullOrUndefined(e)||(this.paragraphFormat=e),"Left"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")||this.leftAlign.classList.add("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Right"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")||this.rightAlign.classList.add("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Center"===this.paragraphFormat.textAlignment?(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")||this.centerAlign.classList.add("e-active"),this.justify.classList.contains("e-active")&&this.justify.classList.remove("e-active")):"Justify"===this.paragraphFormat.textAlignment&&(this.leftAlign.classList.contains("e-active")&&this.leftAlign.classList.remove("e-active"),this.rightAlign.classList.contains("e-active")&&this.rightAlign.classList.remove("e-active"),this.centerAlign.classList.contains("e-active")&&this.centerAlign.classList.remove("e-active"),this.justify.classList.contains("e-active")||this.justify.classList.add("e-active")),1===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.add("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active")):1.5===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.add("e-active"),this.doubleLineSpacing.classList.remove("e-active")):2===this.paragraphFormat.lineSpacing?(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.add("e-active")):(this.singleLineSpacing.classList.remove("e-active"),this.onePointFiveLineSpacing.classList.remove("e-active"),this.doubleLineSpacing.classList.remove("e-active"))},e.prototype.enableOrDisableOkButton=function(){t.isNullOrUndefined(this.okButton)||(this.okButton.disabled=""===this.styleNameElement.value)},e.prototype.getTypeValue=function(){return"Linked(Paragraph and Character)"===this.styleType.value||"Paragraph"===this.styleType.value?"Paragraph":"Character"},e.prototype.updateStyleNames=function(e,i){var r=this.owner.owner.viewer.styles.getStyleNames(e);if(this.styleParagraph.dataSource=r,this.styleParagraph.index=null,i){this.styleBasedOn.dataSource=r.filter(function(e){return e!==i}),this.styleBasedOn.index=null;var n=this.getStyle(i);if(n.basedOn instanceof String||t.isNullOrUndefined(n.basedOn)?this.styleBasedOn.enabled=!1:this.styleBasedOn.index=r.indexOf(n.basedOn.name)>-1?r.indexOf(n.basedOn.name):0,"Paragraph"===n.type?t.isNullOrUndefined(n.link)?this.styleType.index=0:this.styleType.index=2:this.styleType.index=1,!t.isNullOrUndefined(n.next)){var o=n.next.name,a=0;r.indexOf(o)>-1&&(a=r.indexOf(o)),this.styleParagraph.index=a,this.isUserNextParaUpdated=o!==i}}else{this.styleBasedOn.dataSource=r,this.styleBasedOn.index=null;var s=0;if(this.owner.owner.selectionModule){var l=void 0;l="Character"===e?this.owner.owner.selection.characterFormat.styleName:this.owner.owner.selection.paragraphFormat.styleName,s=r.indexOf(l)}this.styleBasedOn.index=s,this.styleParagraph.index=0}this.isEdit?this.styleType.enabled=!1:this.styleType.enabled=!0,this.styleBasedOn.dataBind(),this.styleParagraph.dataBind()},e.prototype.getStyle=function(e){return t.isNullOrUndefined(this.owner.owner.viewer.styles.findByName(e))&&this.owner.owner.editor.createStyle(this.owner.owner.viewer.preDefinedStyles.get(e)),this.owner.owner.viewer.styles.findByName(e)},e.prototype.destroy=function(){if(this.owner=void 0,!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.styleType&&this.styleType.destroy(),this.styleType=void 0,this.styleBasedOn&&this.styleBasedOn.destroy(),this.styleBasedOn=void 0,this.styleParagraph&&this.styleParagraph.destroy(),this.styleParagraph=void 0,this.onlyThisDocument&&this.onlyThisDocument.destroy(),this.onlyThisDocument=void 0,this.template&&this.template.destroy(),this.template=void 0,this.style&&(this.style=void 0),this.abstractList&&(this.abstractList=void 0),this.numberingBulletDialog&&this.numberingBulletDialog.destroy(),this.numberingBulletDialog=void 0},e}(),ut=function(){function e(e){var i=this;this.isBullet=!1,this.numberListClick=function(e){i.isBullet=!1,i.setActiveElement(e),e.currentTarget.classList.contains("e-de-list-numbered-none")?(i.numberFormat=void 0,i.listLevelPattern=void 0):e.currentTarget.classList.contains("e-de-list-numbered-number-dot")?(i.numberFormat="%1.",i.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-number-brace")?(i.numberFormat="%1)",i.listLevelPattern="Arabic"):e.currentTarget.classList.contains("e-de-list-numbered-up-roman")?(i.numberFormat="%1.",i.listLevelPattern="UpRoman"):e.currentTarget.classList.contains("e-de-list-numbered-up-letter")?(i.numberFormat="%1.",i.listLevelPattern="UpLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-letter-brace")?(i.numberFormat="%1)",i.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-numbered-low-letter-dot")?(i.numberFormat="%1.",i.listLevelPattern="LowLetter"):e.currentTarget.classList.contains("e-de-list-numbered-low-roman")&&(i.numberFormat="%1.",i.listLevelPattern="LowRoman")},this.bulletListClick=function(e){i.isBullet=!0,i.setActiveElement(e),e.currentTarget.classList.contains("e-bullet-none")?(i.symbol=void 0,i.fontFamily=void 0):e.currentTarget.classList.contains("e-bullet-dot")?(i.symbol="",i.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-circle")?(i.symbol=" ",i.fontFamily="Symbol"):e.currentTarget.classList.contains("e-bullet-square")?(i.symbol="",i.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-flower")?(i.symbol="",i.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-arrow")?(i.symbol="",i.fontFamily="Wingdings"):e.currentTarget.classList.contains("e-bullet-tick")&&(i.symbol="",i.fontFamily="Wingdings")},this.loadNumberingBulletDialog=function(){i.owner.updateFocus()},this.closeNumberingBulletDialog=function(){i.unWireEventsAndBindings(),i.owner.updateFocus()},this.onCancelButtonClick=function(){i.isBullet=!1,i.listLevelPattern=void 0,i.numberFormat=void 0,i.symbol=void 0,i.fontFamily=void 0,i.owner.dialog.hide(),i.unWireEventsAndBindings()},this.onOkButtonClick=function(){i.owner.owner.viewer.lists.length>0?(i.listFormat.list.listId=i.owner.owner.viewer.lists[i.owner.owner.viewer.lists.length-1].listId+1,i.listFormat.listId=i.listFormat.list.listId):(i.listFormat.list.listId=0,i.listFormat.listId=0),i.owner.owner.viewer.abstractLists.length>0?i.abstractList.abstractListId=i.owner.owner.viewer.abstractLists[i.owner.owner.viewer.abstractLists.length-1].abstractListId+1:i.abstractList.abstractListId=0,i.listFormat.list.abstractListId=i.abstractList.abstractListId;var e=new he(i.abstractList);e.listLevelPattern=t.isNullOrUndefined(i.listLevelPattern)?"Bullet":i.listLevelPattern,e.numberFormat=i.isBullet?i.symbol:i.numberFormat,"Bullet"!==e.listLevelPattern&&(e.startAt=1),e.characterFormat.fontFamily=t.isNullOrUndefined(i.fontFamily)?"Verdana":i.fontFamily,e.paragraphFormat.leftIndent=36,e.paragraphFormat.firstLineIndent=-18,i.abstractList.levels.push(e),i.listFormat.listLevelNumber=0,i.listFormat.list.abstractList=i.abstractList,i.owner.dialog.hide()},this.owner=e}return e.prototype.getModuleName=function(){return"BulletsAndNumberingDialog"},e.prototype.initNumberingBulletDialog=function(e){var i=this.owner.owner.containerId;this.target=t.createElement("div",{id:i+"_insertNumberBulletDialog",className:"e-de-number-bullet-dlg"});var n=t.createElement("div",{id:i+"_tabNumberBulletDialog",className:"e-de-tab-number-bullet-dlg"});this.target.appendChild(n),this.createNumberList(i),this.createBulletList(i);var o=new r.Tab({items:[{header:{text:e.getConstant("Numbering")},content:"#"+i+"_Number"},{header:{text:e.getConstant("Bullets")},content:"#"+i+"_Bullet"}],heightAdjustMode:"None",width:272});o.appendTo(n),this.owner.owner.element.appendChild(this.target),o.refresh()},e.prototype.createNumberList=function(e){var i=t.createElement("div",{className:"e-de-style-numbered-list",id:e+"_Number"});i.style.display="none",i.style.height="270px";var r=t.createElement("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"});i.appendChild(r);var n=this.createNumberNoneListTag(r),o=this.createNumberListTag(r,"1.","2.","3.","e-de-list-numbered-number-dot"),a=this.createNumberListTag(r,"1)","2)","3)","e-de-list-numbered-number-brace"),s=this.createNumberListTag(r,"I.","II.","III.","e-de-list-numbered-up-roman"),l=this.createNumberListTag(r,"A.","B.","C.","e-de-list-numbered-up-letter"),d=this.createNumberListTag(r,"a.","b.","c.","e-de-numbered-low-letter-dot"),h=this.createNumberListTag(r,"a)","b)","c)","e-de-list-numbered-low-letter-brace"),c=this.createNumberListTag(r,"i.","ii.","iii.","e-de-list-numbered-low-roman");n.addEventListener("click",this.numberListClick),o.addEventListener("click",this.numberListClick),a.addEventListener("click",this.numberListClick),s.addEventListener("click",this.numberListClick),l.addEventListener("click",this.numberListClick),h.addEventListener("click",this.numberListClick),d.addEventListener("click",this.numberListClick),c.addEventListener("click",this.numberListClick),this.target.appendChild(i)},e.prototype.createNumberListTag=function(e,i,r,n,o){var a=t.createElement("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size "+o});e.appendChild(a);var s="<div>"+i+'<span class="e-de-ui-list-line"></span></div><div>'+r+'<span class="e-de-ui-list-line">';s+="</span></div><div>"+n+'<span class="e-de-ui-list-line"> </span></div >';var l=t.createElement("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:s});return a.style.cssFloat="left",a.appendChild(l),a},e.prototype.createNumberNoneListTag=function(e){var i=t.createElement("li",{styles:"display:block",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-menuitem-md e-de-list-items  e-de-list-item-size e-de-list-numbered-none"});e.appendChild(i);var r=t.createElement("div",{className:"e-de-ui-list-header-presetmenu",id:"e-de-ui-zlist0",innerHTML:'<div class="e-de-ui-bullets e-de-bullet-icons">None</div>'});return i.style.cssFloat="left",i.appendChild(r),i},e.prototype.createBulletListTag=function(e,i,r){var n=t.createElement("li",{styles:"display:block;",className:"e-de-ui-wfloating-menuitem e-de-ui-wfloating-bullet-menuitem-md e-de-list-items  e-de-list-item-size "+r});e.appendChild(n);var o=t.createElement("div",{className:"e-de-ui-bullet-list-header-presetmenu e-de-bullet-icon-size",id:"e-de-ui-zlist0"}),a=t.createElement("div",{className:i});return o.appendChild(a),n.appendChild(o),n},e.prototype.createBulletList=function(e){var i=t.createElement("div",{className:"e-de-ui-bullet-list-header-presetmenu",id:e+"_Bullet"});i.style.display="none",i.style.height="270px";var r=t.createElement("ul",{styles:"display: block; outline: 0px;",id:"listMenu",className:"e-de-ui-wfloating-menu e-de-ui-bullets-menu e-de-list-container e-de-list-thumbnail"});i.appendChild(r);var n=this.createBulletListTag(r,"e-de-icon-bullet-list-none e-de-bullet-icons","e-bullet-none"),o=this.createBulletListTag(r,"e-de-icon-bullet-list-dot e-de-bullet-icons","e-bullet-dot"),a=this.createBulletListTag(r,"e-de-icon-bullet-list-circle e-de-bullet-icons","e-bullet-circle"),s=this.createBulletListTag(r,"e-de-icon-bullet-list-square e-de-bullet-icons","e-bullet-square"),l=this.createBulletListTag(r,"e-de-icon-bullet-list-flower e-de-bullet-icons","e-bullet-flower"),d=this.createBulletListTag(r,"e-de-icon-bullet-list-arrow e-de-bullet-icons","e-bullet-arrow"),h=this.createBulletListTag(r,"e-de-icon-bullet-list-tick e-de-bullet-icons","e-bullet-tick");n.addEventListener("click",this.bulletListClick),o.addEventListener("click",this.bulletListClick),a.addEventListener("click",this.bulletListClick),s.addEventListener("click",this.bulletListClick),l.addEventListener("click",this.bulletListClick),d.addEventListener("click",this.bulletListClick),h.addEventListener("click",this.bulletListClick),this.target.appendChild(i)},e.prototype.showNumberBulletDialog=function(e,i){t.isNullOrUndefined(e)?this.listFormat=new x:this.listFormat=e,t.isNullOrUndefined(this.listFormat.list)&&(this.listFormat.list=new b),t.isNullOrUndefined(i)?this.abstractList=new de:this.abstractList=i;var r=new t.L10n("documenteditor",this.owner.owner.defaultLocale);r.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initNumberingBulletDialog(r),this.owner.dialog.header=r.getConstant("Numbering and Bullets"),this.owner.dialog.width="auto",this.owner.dialog.height="auto",this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=this.loadNumberingBulletDialog,this.owner.dialog.close=this.closeNumberingBulletDialog,this.owner.dialog.position={X:"center",Y:"center"},this.owner.dialog.buttons=[{click:this.onOkButtonClick,buttonModel:{content:r.getConstant("Ok"),cssClass:"e-flat e-numbering-bullet-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:r.getConstant("Cancel"),cssClass:"e-flat e-numbering-bullet-cancel"}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.setActiveElement=function(e){for(var t=e.currentTarget.parentElement,i=0;i<t.childElementCount;i++)t.childNodes[i].classList.contains("e-de-list-active")&&t.childNodes[i].classList.remove("e-de-list-active");e.currentTarget.classList.add("e-de-list-active")},e.prototype.unWireEventsAndBindings=function(){},e.prototype.destroy=function(){if(this.owner=void 0,this.listFormat&&(this.listFormat.destroy(),this.listFormat=void 0),this.abstractList&&(this.abstractList.destroy(),this.abstractList=void 0),this.target&&this.target.parentElement){this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}},e}(),ft=function(){function e(e){var i=this;this.fontStyleInternal=void 0,this.fontNameList=void 0,this.fontStyleText=void 0,this.fontSizeText=void 0,this.colorPicker=void 0,this.underlineDrop=void 0,this.strikethroughBox=void 0,this.doublestrikethrough=void 0,this.superscript=void 0,this.subscript=void 0,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontSize=void 0,this.fontFamily=void 0,this.fontColor=void 0,this.characterFormat=void 0,this.loadFontDialog=function(){i.owner.updateFocus();var e;if(e=i.characterFormat?i.characterFormat:i.owner.owner.selection.characterFormat,i.fontNameList.value=e.fontFamily,e.bold||e.italic?e.bold&&!e.italic?(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=1):!e.bold&&e.italic?(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=2):e.bold&&e.italic&&(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=3):(i.fontStyleText.value=i.fontSizeText.value,i.fontStyleText.index=0),!t.isNullOrUndefined(e.fontSize))for(var r=0;r<=15;r++){var n=i.fontSizeText.getItems();if(e.fontSize.toString()===n[r].innerHTML){i.fontSizeText.value=e.fontSize,i.fontSizeText.index=r;break}}t.isNullOrUndefined(e.fontColor)?i.colorPicker.value="#000000":i.colorPicker.value=e.fontColor,"None"===e.underline?i.underlineDrop.index=0:"Single"===e.underline&&(i.underlineDrop.index=1),"SingleStrike"===e.strikethrough?i.strikethroughBox.checked=!0:"DoubleStrike"===e.strikethrough?i.doublestrikethrough.checked=!0:(i.strikethroughBox.checked=!1,i.doublestrikethrough.checked=!1),"Superscript"===e.baselineAlignment?i.superscript.checked=!0:"Subscript"===e.baselineAlignment?i.subscript.checked=!0:(i.superscript.checked=!1,i.subscript.checked=!1),"none"!==i.owner.selection.caret.style.display&&(i.owner.selection.caret.style.display="none")},this.closeFontDialog=function(){i.unWireEventsAndBindings(),i.owner.updateFocus()},this.onCancelButtonClick=function(){i.owner.dialog.hide(),i.unWireEventsAndBindings()},this.onInsertFontFormat=function(){var e;e=i.characterFormat?i.characterFormat:new P(void 0),t.isNullOrUndefined(i.bold)||(e.bold=i.bold),t.isNullOrUndefined(i.italic)||(e.italic=i.italic),!t.isNullOrUndefined(i.fontSize)&&i.fontSize>0&&(e.fontSize=i.fontSize),t.isNullOrUndefined(i.fontColor)||(e.fontColor=i.fontColor),t.isNullOrUndefined(i.baselineAlignment)||(e.baselineAlignment=i.baselineAlignment),t.isNullOrUndefined(i.strikethrough)||(e.strikethrough=i.strikethrough),t.isNullOrUndefined(i.underline)||(e.underline=i.underline),t.isNullOrUndefined(i.fontFamily)||(e.fontFamily=i.fontFamily),i.characterFormat?i.owner.owner.styleDialogModule.updateCharacterFormat():i.onCharacterFormat(i.owner.selection,e),i.owner.dialog.hide()},this.fontSizeUpdate=function(e){i.fontSize=e.value},this.fontStyleUpdate=function(e){i.fontStyle=e.value},this.fontFamilyUpdate=function(e){i.fontFamily=e.value},this.underlineUpdate=function(e){i.underline=e.value},this.fontColorUpdate=function(e){t.isNullOrUndefined(e.currentValue)||(i.fontColor=e.currentValue.hex)},this.singleStrikeUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.strikethrough="SingleStrike":i.strikethrough="None"},this.doubleStrikeUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.strikethrough="DoubleStrike":i.strikethrough="None"},this.superscriptUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.baselineAlignment="Superscript":i.baselineAlignment="Normal"},this.subscriptUpdate=function(e){i.enableCheckBoxProperty(e),e.checked?i.baselineAlignment="Subscript":i.baselineAlignment="Normal"},this.owner=e}return Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this.fontStyleInternal},set:function(e){switch(this.fontStyleInternal=e,this.fontStyle){case"Bold":this.bold=!0,this.italic=!1;break;case"Italic":this.bold=!1,this.italic=!0;break;case"BoldItalic":this.bold=!0,this.italic=!0;break;case"Regular":this.bold=!1,this.italic=!1}},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"FontDialog"},e.prototype.createInputElement=function(e,i,r){return t.createElement("input",{attrs:{type:e},id:i,className:r})},e.prototype.initFontDialog=function(e){var i,r,n,a,s,d=this.owner.owner.containerId;this.target=t.createElement("div",{id:d+"_insertFontDialog",className:"e-de-font-dlg"});var h=this.getFontDiv(e);this.target.appendChild(h);var c=this.getFontSizeDiv(e);this.target.appendChild(c);var p=t.createElement("div",{id:d+"_fontColor",styles:"margin-top:15px;"});this.fontColorDiv=t.createElement("div",{id:d+"_fontColorDiv",className:"e-de-font-dlg-display"});var g=t.createElement("label",{className:"e-de-font-dlg-header-font-color e-de-font-color-margin",innerHTML:e.getConstant("Font color")});this.fontColorDiv.appendChild(g);var u=this.createInputElement("color",this.target.id+"_ColorDiv","e-de-font-dlg-color");this.fontColorDiv.appendChild(u),p.appendChild(this.fontColorDiv),this.target.appendChild(p);var f=t.createElement("div",{id:d+"_fontEffectsDiv"}),m=t.createElement("div",{className:"e-de-font-color-label e-de-font-dlg-display",id:this.target.id+"_fontEffectsSubDiv1"});i=t.createElement("label",{className:"e-de-font-dlg-header-effects",innerHTML:e.getConstant("Effects")}),m.appendChild(i),r=this.createInputElement("checkbox",this.target.id+"_strikeThrough",""),m.appendChild(r),n=this.createInputElement("checkbox",this.target.id+"_superScript",""),m.appendChild(n),f.appendChild(m);var v=t.createElement("div",{className:"e-de-font-checkbox",id:d+"_fontEffectsSubDiv2"});a=this.createInputElement("checkbox",this.target.id+"_subScript",""),v.appendChild(a),s=this.createInputElement("checkbox",this.target.id+"_doubleStrikeThrough",""),v.appendChild(s),f.appendChild(v),this.target.appendChild(f),this.owner.owner.element.appendChild(this.target),this.colorPicker=new l.ColorPicker({change:this.fontColorUpdate,value:"#000000"}),this.colorPicker.appendTo(u),this.strikethroughBox=new o.CheckBox({change:this.singleStrikeUpdate,cssClass:"e-de-font-content-label",label:e.getConstant("Strikethrough")}),this.strikethroughBox.appendTo(r),this.doublestrikethrough=new o.CheckBox({change:this.doubleStrikeUpdate,cssClass:"e-de-font-content-checkbox-label",label:e.getConstant("Double strikethrough")}),this.doublestrikethrough.appendTo(s),this.subscript=new o.CheckBox({label:e.getConstant("Subscript"),change:this.subscriptUpdate}),this.subscript.appendTo(a),this.superscript=new o.CheckBox({label:e.getConstant("Superscript"),cssClass:"e-de-font-content-label",change:this.superscriptUpdate}),this.superscript.appendTo(n)},e.prototype.getFontSizeDiv=function(e){var i,r,n=this.owner.owner.containerId;r=t.createElement("div",{id:n+"_fontSizeAndUnderlineDiv",className:"e-de-font-dlg-padding e-de-font-dlg-display"});var o=t.createElement("div",{id:n+"_fontSizeAndUnderlineSubDiv1"}),a=t.createElement("label",{className:"e-de-font-dlg-header",innerHTML:e.getConstant("Size")}),l="font-family:Roboto;font-size:14px;opacity:0.8;";(i=t.createElement("select",{id:this.target.id+"_fontSize",styles:l})).innerHTML="<option>8</option><option>9</option><option>10</option><option>11</option><option>12</option><option>14</option><option>16</option><option>18</option><option>20</option><option>24</option><option>26</option><option>28</option><option>36</option><option>48</option><option>72</option><option>96</option>",o.appendChild(a),o.appendChild(i),r.appendChild(o);var d,h=t.createElement("div",{className:"e-de-font-dlg-cb-right",id:n+"_fontSizeAndUnderlineSubDiv2"}),c=e.getConstant("Underline style"),p=t.createElement("label",{className:"e-de-font-dlg-header",innerHTML:c});return d=t.createElement("select",{id:this.target.id+"_underLine",styles:l}),d.innerHTML="<option>"+e.getConstant("None")+"</option><option>________</option>",h.appendChild(p),h.appendChild(d),r.appendChild(h),this.fontSizeText=new s.ComboBox({change:this.fontSizeUpdate,popupHeight:"170px",width:"170px"}),this.fontSizeText.showClearButton=!1,this.fontSizeText.appendTo(i),this.underlineDrop=new s.DropDownList({change:this.underlineUpdate,popupHeight:"100px",width:"170px"}),this.underlineDrop.appendTo(d),r},e.prototype.getFontDiv=function(e){var i=this.owner.owner.containerId,r=t.createElement("div",{id:i+"_fontDiv",className:"e-de-font-dlg-display"}),n=t.createElement("div",{id:i+"_fontSubDiv1"}),o=t.createElement("label",{className:"e-de-font-dlg-header",innerHTML:e.getConstant("Font")}),a=t.createElement("select",{id:this.target.id+"_fontName"});a.innerHTML="<option>Arial</option><option>Calibri</option><option>Candara</option><option>Comic Sans MS</option><option>Consolas</option><option>Constantia</option><option>Corbel</option><option>Courier New</option><option>Ebrima</option><option>Franklin Gothic</option><option>Gabriola</option><option>Gadugi</option><option>Georgia</option><option>Impact</option><option>Javanese Text</option><option>Microsoft Sans Serif</option><option>MS Gothic</option><option>MS UI Gothic</option><option>Segoe Print</option><option>Times New Roman</option><option>Verdana</option><option>Segoe UI</option><option>Algerian</option><option>Cambria</option><option>Georgia</option><option>Consolas</option>",n.appendChild(o),n.appendChild(a),r.appendChild(n);var l,d,h;l=t.createElement("div",{className:"e-de-font-dlg-cb-right",id:i+"_fontSubDiv2",styles:"float:right;"}),d=t.createElement("label",{className:"e-de-font-dlg-header",innerHTML:e.getConstant("Font style")});return h=t.createElement("select",{id:this.target.id+"_fontStyle",styles:"font-family:Roboto;font-size:14px;opacity:0.8;"}),h.innerHTML="<option>"+e.getConstant("Regular")+"</option><option>"+e.getConstant("Bold")+"</option><option>"+e.getConstant("Italic")+"</option><option>"+e.getConstant("Bold")+e.getConstant("Italic")+"</option>",l.appendChild(d),l.appendChild(h),r.appendChild(l),this.fontNameList=new s.ComboBox({change:this.fontFamilyUpdate,popupHeight:"200px",width:"170px"}),this.fontNameList.showClearButton=!1,this.fontNameList.appendTo(a),this.fontStyleText=new s.DropDownList({change:this.fontStyleUpdate,popupHeight:"170px",width:"170px"}),this.fontStyleText.appendTo(h),r},e.prototype.showFontDialog=function(e){e&&(this.characterFormat=e);var i=new t.L10n("documenteditor",this.owner.owner.defaultLocale);i.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initFontDialog(i),this.owner.dialog.header=i.getConstant("Font"),this.owner.dialog.width="auto",this.owner.dialog.height="auto",this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=this.loadFontDialog,this.owner.dialog.close=this.closeFontDialog,this.owner.dialog.buttons=[{click:this.onInsertFontFormat,buttonModel:{content:i.getConstant("Ok"),cssClass:"e-flat e-font-okay",isPrimary:!0}},{click:this.onCancelButtonClick,buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-font-cancel"}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.onCharacterFormat=function(e,t){if(this.owner.owner.editorModule.initHistory("CharacterFormat"),e.isEmpty)return e.start.offset===e.getParagraphLength(e.start.paragraph)&&(this.owner.owner.editorModule.applyCharFormatValueInternal(e,e.start.paragraph.characterFormat,void 0,t),this.owner.owner.editorModule.reLayout(e)),void this.owner.updateFocus();this.owner.owner.editorModule.setOffsetValue(this.owner.selection),this.owner.owner.editorModule.updateSelectionCharacterFormatting("CharacterFormat",t,!1)},e.prototype.enableCheckBoxProperty=function(e){this.strikethroughBox.checked&&this.doublestrikethrough.checked&&(this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,e.event.currentTarget.id===this.target.id+"_doubleStrikeThrough"?this.doublestrikethrough.checked=!0:this.strikethroughBox.checked=!0),this.superscript.checked&&this.subscript.checked&&(this.subscript.checked=!1,this.superscript.checked=!1,e.event.currentTarget.id===this.target.id+"_subScript"?this.subscript.checked=!0:this.superscript.checked=!0)},e.prototype.unWireEventsAndBindings=function(){this.fontNameList.value="",this.fontSizeText.value="",this.fontStyleText.value="",this.strikethroughBox.checked=!1,this.doublestrikethrough.checked=!1,this.superscript.checked=!1,this.subscript.checked=!1,this.bold=void 0,this.italic=void 0,this.underline=void 0,this.strikethrough=void 0,this.baselineAlignment=void 0,this.fontColor=void 0,this.fontSize=void 0,this.fontFamily=void 0},e.prototype.destroy=function(){if(this.owner=void 0,this.characterFormat&&(this.characterFormat.destroy(),this.characterFormat=void 0),!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.fontNameList&&this.fontNameList.destroy(),this.fontNameList=void 0,this.fontStyleText&&this.fontStyleText.destroy(),this.fontStyleText=void 0,this.fontSizeText&&this.fontSizeText.destroy(),this.fontSizeText=void 0,this.colorPicker&&this.colorPicker.destroy(),this.colorPicker=void 0,this.underlineDrop&&this.underlineDrop.destroy(),this.underlineDrop=void 0,this.strikethroughBox&&this.strikethroughBox.destroy(),this.strikethroughBox=void 0,this.doublestrikethrough&&this.doublestrikethrough.destroy(),this.doublestrikethrough=void 0,this.superscript&&this.superscript.destroy(),this.superscript=void 0,this.subscript&&this.subscript.destroy(),this.subscript=void 0},e}(),mt=function(){function e(e){var i=this;this.hasTableWidth=!1,this.hasCellWidth=!1,this.isTableBordersAndShadingUpdated=!1,this.isCellBordersAndShadingUpdated=!1,this.tabObj=void 0,this.isCellOptionsUpdated=!1,this.isTableOptionsUpdated=!1,this.onBeforeOpen=function(){i.owner.updateFocus(),i.loadTableProperties()},this.onCloseTablePropertyDialog=function(){i.unWireEvent.bind(i),i.owner.updateFocus()},this.applyTableProperties=function(){var e=i.owner.selection;if(i.preferCheckBox.checked||i.preferCheckBox.indeterminate||(t.isNullOrUndefined(e.tableFormat.preferredWidth)||0!==e.tableFormat.preferredWidth)&&(i.tableFormat.preferredWidth=0,i.tableFormat.preferredWidthType="Point"),i.tableFormat.hasValue("tableAlignment")&&"Left"!==i.tableFormat.tableAlignment&&(t.isNullOrUndefined(e.tableFormat.leftIndent)||0!==e.tableFormat.leftIndent)&&(i.tableFormat.leftIndent=0),i.rowHeightCheckBox.checked||i.rowHeightCheckBox.indeterminate||(t.isNullOrUndefined(e.rowFormat.height)||0!==e.rowFormat.height)&&(i.rowFormat.heightType="AtLeast",i.rowFormat.height=0),i.preferredCellWidthCheckBox.checked||i.preferredCellWidthCheckBox.indeterminate){if("Percent"===i.cellFormat.preferredWidthType&&!i.tableFormat.hasValue("preferredWidth")&&!i.tableFormat.hasValue("preferredWidthType")&&0===i.owner.selection.start.paragraph.associatedCell.ownerTable.tableFormat.preferredWidth){var r=i.owner.selection.start.paragraph.associatedCell.ownerTable.getOwnerWidth(!0),n=i.owner.selection.start.paragraph.associatedCell.ownerTable.getTableClientWidth(r);i.tableFormat.preferredWidthType="Percent",i.tableFormat.preferredWidth=n/W.convertPixelToPoint(i.owner.clientArea.width)*100}}else(t.isNullOrUndefined(e.cellFormat.preferredWidth)||0===e.cellFormat.preferredWidth)&&(i.cellFormat.preferredWidthType="Point",i.cellFormat.preferredWidth=0);i.rowHeightValue&&(i.rowFormat.height=i.rowHeightValue),i.owner.owner.editorModule.initComplexHistory("TableProperties"),i.owner.owner.editorModule.onTableFormat(i.tableFormat),i.owner.owner.editorModule.onRowFormat(i.rowFormat),i.owner.owner.editorModule.onCellFormat(i.cellFormat),i.owner.owner.editorHistory.updateComplexHistory(),i.closeTablePropertiesDialog(),i.owner.updateFocus()},this.applyTableSubProperties=function(){if(i.isCellOptionsUpdated){var e=i.owner.owner.cellOptionsDialogModule.cellFormat;i.owner.owner.cellOptionsDialogModule.applySubCellOptions(e)}if(i.isTableOptionsUpdated){var t=i.owner.owner.tableOptionsDialogModule.tableFormat;i.owner.owner.tableOptionsDialogModule.applySubTableOptions(t)}i.isCellOptionsUpdated=!1,i.isTableOptionsUpdated=!1},this.unWireEvent=function(){i.preferCheckBox.change=void 0,i.tableWidthBox.change=void 0,i.tableWidthType.change=void 0,i.leftIndentBox.change=void 0,i.rowHeightCheckBox.change=void 0,i.rowHeightBox.change=void 0,i.rowHeightType.change=void 0,i.repeatHeader.change=void 0,i.allowRowBreak.change=void 0,i.preferredCellWidthCheckBox.change=void 0,i.cellWidthBox.change=void 0,i.cellWidthType.change=void 0,i.cellFormat.destroy(),i.rowFormat.destroy(),i.tableFormat.destroy(),i.rowHeightValue=void 0,i.owner.dialog2.open=i.owner.selection.hideCaret.bind(i.owner)},this.closeTablePropertiesDialog=function(){i.owner.dialog2.hide(),i.owner.updateFocus()},this.changeTableCheckBox=function(){var e=i.preferCheckBox.checked||i.preferCheckBox.indeterminate;i.tableWidthBox.enabled=e,i.tableWidthType.enabled=e,i.tableFormat.preferredWidthType=e?"Points"===i.tableWidthType.value?"Point":i.tableWidthType.value:i.owner.selection.tableFormat.preferredWidthType},this.changeTableAlignment=function(e){i.updateClassForAlignmentProperties(i.tableTab);var r=e.target;t.classList(r,["e-de-table-alignment-active"],["e-de-table-properties-alignment"]),r.classList.contains("e-de-table-left-alignment")?i.leftIndentBox.enabled=!0:i.leftIndentBox.enabled=!1,i.tableFormat.tableAlignment=i.getTableAlignment()},this.changeTableRowCheckBox=function(){i.rowHeightType.enabled=i.rowHeightCheckBox.checked,i.rowHeightBox.enabled=i.rowHeightCheckBox.checked,i.rowHeightType.enabled?i.rowFormat.heightType=i.rowHeightType.value:i.rowFormat.heightType=i.owner.selection.rowFormat.heightType},this.changeTableCellCheckBox=function(){i.cellWidthType.enabled=i.preferredCellWidthCheckBox.checked,i.cellWidthBox.enabled=i.preferredCellWidthCheckBox.checked},this.changeCellAlignment=function(e){i.updateClassForCellAlignment(i.cellTab);var r=e.target;t.classList(r,["e-de-table-alignment-active"],["e-de-tablecell-alignment"]),i.cellFormat.verticalAlignment=i.getCellAlignment()},this.showTableOptionsDialog=function(){i.owner.owner.tableOptionsDialogModule.show(),i.owner.dialog2.element.style.pointerEvents="none"},this.showBordersShadingsPropertiesDialog=function(){i.owner.owner.bordersAndShadingDialogModule.show(),i.owner.dialog2.element.style.pointerEvents="none"},this.showCellOptionsDialog=function(){i.owner.owner.cellOptionsDialogModule.show(),i.owner.dialog2.element.style.pointerEvents="none"},this.owner=e}return Object.defineProperty(e.prototype,"cellFormat",{get:function(){return t.isNullOrUndefined(this.cellFormatIn)?this.cellFormatIn=new H:this.cellFormatIn},set:function(e){this.cellFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tableFormat",{get:function(){return t.isNullOrUndefined(this.tableFormatIn)?(this.tableFormatIn=new R,this.tableFormatIn):this.tableFormatIn},set:function(e){this.tableFormatIn=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowFormat",{get:function(){return t.isNullOrUndefined(this.rowFormatInternal)?(this.rowFormatInternal=new M,this.rowFormatInternal):this.rowFormatInternal},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TablePropertiesDialog"},e.prototype.initTablePropertyDialog=function(e){var i=this.owner.owner.containerId+"_TablePropertiesDialog";this.target=t.createElement("div",{id:i,className:"e-de-table-properties-dlg"}),this.owner.owner.element.appendChild(this.target);var n=t.createElement("div",{id:this.target.id+"_TabContainer"});this.target.appendChild(n),this.tableTab=t.createElement("div",{id:this.target.id+"_TablePropertiesContentDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.rowTab=t.createElement("div",{id:this.target.id+"_RowPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"}),this.cellTab=t.createElement("div",{id:this.target.id+"_CellPropertiesDialogTab",className:"e-de-table-ppty-dlg-tabs"});var o=t.createElement("div",{className:"e-de-table-dialog-separator-line"}),a=t.createElement("div",{id:this.target.id+"_TablePropertiesDialogTab",className:"e-de-table-ppty-tab"}),s=t.createElement("div",{className:"e-tab-header"}),l=t.createElement("div",{id:this.target.id+"_tableHeader",innerHTML:e.getConstant("Table")}),d=t.createElement("div",{id:this.target.id+"_rowHeader",innerHTML:e.getConstant("Row")}),h=t.createElement("div",{id:this.target.id+"_cellHeader",innerHTML:e.getConstant("Cell")});s.appendChild(l),s.appendChild(d),s.appendChild(h);var c=t.createElement("div",{className:"e-content"}),p=t.createElement("div",{id:this.target.id+"_tableContent"}),g=t.createElement("div",{id:this.target.id+"_rowContent"}),u=t.createElement("div",{id:this.target.id+"_cellContent"});p.appendChild(this.tableTab),g.appendChild(this.rowTab),u.appendChild(this.cellTab),c.appendChild(p),c.appendChild(g),c.appendChild(u),a.appendChild(s),a.appendChild(c),n.appendChild(a),this.initTableProperties(this.tableTab,e),this.initTableRowProperties(this.rowTab,e),this.initTableCellProperties(this.cellTab,e),this.tabObj=new r.Tab({},a),this.target.appendChild(o);for(var f=this.tableTab.getElementsByClassName(this.tableTab.id+"e-de-table-alignment"),m=0;m<f.length;m++)f[m].addEventListener("click",this.changeTableAlignment);for(var v=this.cellTab.getElementsByClassName(this.cellTab.id+"e-de-table-cell-alignment"),m=0;m<v.length;m++)v[m].addEventListener("click",this.changeCellAlignment);this.tabObj.element.getElementsByClassName("e-item e-toolbar-item")[0].getElementsByClassName("e-tab-wrap")[0].classList.add("e-de-table-ppty-dlg-table-header"),this.tabObj.element.getElementsByClassName("e-item e-toolbar-item")[1].getElementsByClassName("e-tab-wrap")[0].classList.add("e-de-table-ppty-dlg-row-header"),this.tabObj.element.getElementsByClassName("e-item e-toolbar-item")[2].getElementsByClassName("e-tab-wrap")[0].classList.add("e-de-table-ppty-dlg-cell-header"),this.tabObj.element.getElementsByClassName("e-indicator")[0].style.right="155px"},e.prototype.show=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initTablePropertyDialog(e),"none"!==this.owner.selection.caret.style.display&&(this.owner.selection.caret.style.display="none"),this.owner.dialog2.header=e.getConstant("Table Properties"),this.owner.dialog2.position={X:"center",Y:"center"},this.owner.dialog2.width="auto",this.owner.dialog2.height="auto",this.owner.dialog2.content=this.target,this.owner.dialog2.beforeOpen=this.onBeforeOpen,this.owner.dialog2.close=this.onCloseTablePropertyDialog,this.owner.dialog2.open=this.wireEvent.bind(this),this.owner.dialog2.buttons=[{click:this.applyTableProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-ppty-okay",isPrimary:!0}},{click:this.closeTablePropertiesDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-ppty-cancel"}}],this.owner.dialog2.dataBind(),this.owner.dialog2.show()},e.prototype.calculateGridValue=function(e){e.calculateGrid(),e.isGridUpdated=!1,e.buildTableColumns(),e.isGridUpdated=!0,this.owner.selection.owner.isLayoutEnabled=!0,this.owner.layout.reLayoutTable(e),this.owner.owner.editorModule.reLayout(this.owner.selection),this.owner.owner.editorModule.updateSelectionTextPosition(!0);var t=this.owner.owner.editorHistory;t&&t.currentBaseHistoryInfo&&(t.currentBaseHistoryInfo.modifiedProperties.length>0&&t.currentBaseHistoryInfo.updateSelection(),t.updateHistory()),this.owner.owner.editorModule.fireContentChange()},e.prototype.loadTableProperties=function(){this.setTableProperties(),this.setTableRowProperties(),this.setTableCellProperties(),this.owner.owner.bordersAndShadingDialogModule?this.bordersAndShadingButton.disabled=!1:this.bordersAndShadingButton.disabled=!0,this.tableOptionButton.disabled=!1,this.cellOptionButton.disabled=!1},e.prototype.wireEvent=function(){this.owner.selection.hideCaret(),this.preferCheckBox.change=this.changeTableCheckBox.bind(this),this.tableWidthBox.change=this.onTableWidthChange.bind(this),this.tableWidthType.change=this.onTableWidthTypeChange.bind(this),this.leftIndentBox.change=this.onLeftIndentChange.bind(this),this.rowHeightCheckBox.change=this.changeTableRowCheckBox.bind(this),this.rowHeightBox.change=this.onRowHeightChange.bind(this),this.rowHeightType.change=this.onRowHeightTypeChange.bind(this),this.allowRowBreak.change=this.onAllowBreakAcrossPage.bind(this),this.repeatHeader.change=this.onRepeatHeader.bind(this),this.preferredCellWidthCheckBox.change=this.changeTableCellCheckBox.bind(this),this.cellWidthBox.change=this.onCellWidthChange.bind(this),this.cellWidthType.change=this.onCellWidthTypeChange.bind(this)},e.prototype.initTableProperties=function(e,i){var r=t.createElement("div",{id:e.id+"_table_TabContainer"}),n=t.createElement("div",{id:r.id+"_sizeLabel",innerHTML:i.getConstant("Size"),styles:"width:100%;margin:0px;padding-top: 20px;padding-bottom: 0px;",className:"e-de-table-dialog-options-label"}),a=t.createElement("div",{styles:"display: inline-flex;"}),d=t.createElement("div",{styles:"float: left;",className:"e-de-table-container-div"}),h=t.createElement("div",{className:"e-de-table-ppty-dlg-preferred-width-div"}),c=t.createElement("div",{styles:"display: inline;",className:"e-de-table-ppty-dlg-measure-div"}),p=t.createElement("div",{styles:"display: inline;position: absolute;",className:"e-de-table-ppty-dlg-measure-drop-down-div"}),g=t.createElement("div"),u=t.createElement("input",{id:e.id+"_Prefer_Width_CheckBox",attrs:{type:"checkbox"}});this.preferredWidth=t.createElement("input",{id:e.id+"preferred_Width"});var f=t.createElement("div"),m=t.createElement("select",{innerHTML:"<option>"+i.getConstant("Points")+"</option><option>"+i.getConstant("Percent")+"</option>",id:e.id+"_width_dropdown"}),v=t.createElement("label",{innerHTML:i.getConstant("Measure in"),styles:"width: 60px;font-size: 11px; font-weight: normal;"}),y=t.createElement("div",{innerHTML:i.getConstant("Alignment"),className:"e-de-table-dialog-options-label",styles:"width: 100%;margin: 0px;padding-bottom: 15px"}),w=t.createElement("div",{styles:"height:70px;"}),b=e.id+"e-de-table-alignment",x=t.createElement("div",{className:"e-de-table-dia-align-div"});this.left=t.createElement("div",{className:"e-icons e-de-table-properties-alignment e-de-table-left-alignment "+b,id:e.id+"_left_alignment",styles:"width:54px;height:54px;margin:2px"}),x.appendChild(this.left);var C=t.createElement("div",{className:"e-de-table-dia-align-div"});this.center=t.createElement("div",{className:"e-icons e-de-table-properties-alignment  e-de-table-center-alignment "+b,id:e.id+"_center_alignment",styles:"width:54px;height:54px;margin:2px"}),C.appendChild(this.center),this.right=t.createElement("div",{styles:"width:54px;height:54px;margin:2px",id:e.id+"_right_alignment",className:"e-icons e-de-table-properties-alignment  e-de-table-right-alignment "+b});var F=t.createElement("div",{className:"e-de-table-dia-align-div"});F.appendChild(this.right);var P=t.createElement("label",{innerHTML:i.getConstant("Left"),className:"e-de-table-dia-align-label"}),W=t.createElement("label",{innerHTML:i.getConstant("Center"),className:"e-de-table-dia-align-label"}),T=t.createElement("label",{innerHTML:i.getConstant("Right"),className:"e-de-table-dia-align-label"}),I=t.createElement("div",{className:"e-de-table-ppty-dlg-left-indent-container"}),S=t.createElement("label",{innerHTML:i.getConstant("Indent from left"),styles:"font-weight: normal;font-size: 11px;float:right;margin-right:121px;"}),N=t.createElement("div",{styles:"margin-top: 27px;"});this.leftIndent=t.createElement("input",{id:e.id+"_left_indent"});var O=t.createElement("div",{className:"e-de-tbl-dlg-border-btn"});this.bordersAndShadingButton=t.createElement("button",{innerHTML:i.getConstant("Borders and Shading"),id:e.id+"_borders_and_shadings",className:"e-control e-btn e-flat e-de-ok-button"}),this.tableOptionButton=t.createElement("button",{className:"e-control e-btn e-flat",innerHTML:i.getConstant("Options"),id:e.id+"_table_cellmargin"}),this.tableOptionButton.addEventListener("click",this.showTableOptionsDialog),this.bordersAndShadingButton.addEventListener("click",this.showBordersShadingsPropertiesDialog),O.appendChild(this.bordersAndShadingButton),O.appendChild(this.tableOptionButton),I.appendChild(S),N.appendChild(this.leftIndent),I.appendChild(N),w.appendChild(x),w.appendChild(C),w.appendChild(F),x.appendChild(P),C.appendChild(W),F.appendChild(T),w.appendChild(I),r.appendChild(n),e.appendChild(r),d.appendChild(u),a.appendChild(d),h.appendChild(this.preferredWidth),a.appendChild(h),f.appendChild(m),c.appendChild(v),p.appendChild(f),g.appendChild(c),g.appendChild(p),a.appendChild(g),e.appendChild(a),e.appendChild(y),e.appendChild(w),e.appendChild(O),this.tableWidthBox=new l.NumericTextBox({value:0,decimals:2,min:0,max:1584,width:120,enablePersistence:!1}),this.tableWidthBox.appendTo(this.preferredWidth),this.leftIndentBox=new l.NumericTextBox({value:0,decimals:2,min:-1584,max:1584,width:140,enablePersistence:!1}),this.leftIndentBox.appendTo(this.leftIndent),this.preferCheckBox=new o.CheckBox({label:i.getConstant("Preferred Width")}),this.preferCheckBox.appendTo(u),this.tableWidthType=new s.DropDownList({width:"120px"}),this.tableWidthType.appendTo(m)},e.prototype.onTableWidthChange=function(){this.tableFormat.preferredWidth=this.tableWidthBox.value},e.prototype.onTableWidthTypeChange=function(){this.owner.selection.start.paragraph.associatedCell.ownerTable;var e,t=W.convertPixelToPoint(this.owner.clientArea.width);"Percent"===this.tableWidthType.text&&"Percent"!==this.owner.selection.tableFormat.preferredWidthType?(e=this.tableWidthBox.value/t*100,this.formatNumericTextBox(this.tableWidthBox,"Percent",e)):"Points"===this.tableWidthType.text&&"Point"!==this.owner.selection.tableFormat.preferredWidthType?(e=t/100*this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Point",e)):(e="#'%'"===this.tableWidthBox.format?"Points"===this.tableWidthType.text?t/100*this.tableWidthBox.value:this.tableWidthBox.value:"Percent"===this.tableWidthType.text?this.tableWidthBox.value/t*100:this.tableWidthBox.value,this.formatNumericTextBox(this.tableWidthBox,"Points"===this.tableWidthType.text?"Point":this.tableWidthType.text,e)),this.tableFormat.preferredWidthType="Points"===this.tableWidthType.text?"Point":this.tableWidthType.text},e.prototype.onLeftIndentChange=function(){this.tableFormat.leftIndent=this.leftIndentBox.value},e.prototype.setTableProperties=function(){var e=this.owner.selection.tableFormat,i=e.preferredWidth>0,r=e.preferredWidth;t.isNullOrUndefined(e.preferredWidth)?(this.preferCheckBox.indeterminate=!0,r=this.owner.selection.start.paragraph.associatedCell.ownerTable.combineWidget(this.owner).tableFormat.preferredWidth):this.preferCheckBox.checked=i,this.tableWidthBox.enabled=i,this.tableWidthType.enabled=i,this.formatNumericTextBox(this.tableWidthBox,e.preferredWidthType,r),"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.tableWidthType.index=0:this.tableWidthType.index=1,this.leftIndentBox.value=e.leftIndent,this.leftIndentBox.enabled="Left"===e.tableAlignment,t.classList(this.left,[],["e-de-table-alignment-active"]),t.classList(this.right,[],["e-de-table-alignment-active"]),t.classList(this.center,[],["e-de-table-alignment-active"]),"Left"===e.tableAlignment?this.left.classList.add("e-de-table-alignment-active"):"Center"===e.tableAlignment?this.center.classList.add("e-de-table-alignment-active"):"Right"===e.tableAlignment&&this.right.classList.add("e-de-table-alignment-active")},e.prototype.getTableAlignment=function(){for(var e=this.tableTab.id,t=this.tableTab.getElementsByClassName(e+"e-de-table-alignment"),i=0;i<t.length;i++)if(t[i].classList.contains("e-de-table-alignment-active"))return 0===i?"Left":1===i?"Center":"Right"},e.prototype.updateClassForAlignmentProperties=function(e){for(var i=e.id,r=e.getElementsByClassName(i+"e-de-table-alignment"),n=0;n<r.length;n++){var o=r[n];o.classList.contains("e-de-table-alignment-active")&&t.classList(o,["e-de-table-properties-alignment"],["e-de-table-alignment-active"])}},e.prototype.initTableRowProperties=function(e,i){var r=t.createElement("div",{styles:"width: 100%;"}),n=t.createElement("div",{innerHTML:i.getConstant("Size"),styles:"width: 100%;padding-top: 20px;padding-bottom: 10px;",className:"e-de-table-dialog-options-label"}),a=t.createElement("div",{styles:"display: inline;width: 100%;"}),d=t.createElement("div",{styles:"display: inline;float: left;",className:"e-de-table-header-div"}),h=t.createElement("input",{attrs:{type:"checkbox"},id:e.id+"_height_CheckBox"}),c=t.createElement("div",{styles:"display: inline-block;",className:"e-de-row-ht-top"});this.rowHeight=t.createElement("input",{attrs:{type:"text"},id:e.id+"_table_row_height"});var p=t.createElement("div",{styles:"float: right;display: inline;width: auto;margin-top: 5px;"}),g=t.createElement("div",{styles:"display: inline;",className:"e-de-table-ppty-dlg-row-height-label"}),u=t.createElement("div",{styles:"display: inline;",className:"e-de-table-subheader-div"}),f=t.createElement("div"),m=t.createElement("select",{innerHTML:"<option>"+i.getConstant("At least")+"</option><option>"+i.getConstant("Exactly")+"</option>",id:e.id+"_height_type"}),v=t.createElement("label",{innerHTML:i.getConstant("Row height is"),styles:"font-size: 11px;font-weight: normal;width: 75px;"});r.appendChild(n),e.appendChild(r),d.appendChild(h),a.appendChild(d),c.appendChild(this.rowHeight),a.appendChild(c),f.appendChild(m),g.appendChild(v),u.appendChild(f),p.appendChild(g),p.appendChild(u),a.appendChild(p),e.appendChild(a);var y=t.createElement("div",{innerHTML:i.getConstant("Options"),styles:"width: 100%;",className:"e-de-table-dialog-options-label"}),w=t.createElement("div",{className:"e-de-table-ppty-options-break"}),b=t.createElement("div",{className:"e-de-table-ppty-options-header-row"}),x=t.createElement("input",{attrs:{type:"checkbox"},id:e.id+"_allow_row_break"}),C=t.createElement("input",{attrs:{type:"checkbox"},id:e.id+"_repeat_header"});w.appendChild(x),b.appendChild(C),e.appendChild(y),e.appendChild(w),e.appendChild(b),this.rowHeightBox=new l.NumericTextBox({value:0,decimals:2,min:0,max:1584,width:120,enablePersistence:!1}),this.rowHeightBox.appendTo(this.rowHeight),this.rowHeightCheckBox=new o.CheckBox({label:i.getConstant("Specify height")}),this.rowHeightCheckBox.appendTo(h),this.rowHeightType=new s.DropDownList({width:"120px"}),this.rowHeightType.appendTo(m),this.allowRowBreak=new o.CheckBox({label:i.getConstant("Allow row to break across pages")}),this.allowRowBreak.appendTo(x),this.repeatHeader=new o.CheckBox({label:i.getConstant("Repeat as header row at the top of each page")}),this.repeatHeader.appendTo(C)},e.prototype.setTableRowProperties=function(){var e=this.owner.selection.rowFormat,i=e.height>0||"Exactly"===e.heightType;i?this.rowHeightCheckBox.checked=!0:void 0===e.heightType?(this.rowHeightCheckBox.indeterminate=!0,i=!0):this.rowHeightCheckBox.checked=!1,this.rowHeightBox.enabled=i,this.rowHeightType.enabled=i;t.isNullOrUndefined(this.owner.selection.rowFormat.isHeader)?(this.repeatHeader.indeterminate=!0,this.repeatHeader.disabled=!0):this.owner.selection.rowFormat.isHeader?(this.repeatHeader.checked=!1,this.repeatHeader.indeterminate=!0,this.repeatHeader.disabled=!0):(this.repeatHeader.checked=!1,this.repeatHeader.indeterminate=!1,this.repeatHeader.disabled=!0),t.isNullOrUndefined(e.allowBreakAcrossPages)?this.allowRowBreak.indeterminate=!0:this.allowRowBreak.checked=e.allowBreakAcrossPages,this.rowHeightBox.value=e.height,"Auto"===e.heightType||"AtLeast"===e.heightType?this.rowHeightType.index=0:this.rowHeightType.index=1},e.prototype.onRowHeightChange=function(){this.rowHeightValue=this.rowHeightBox.value},e.prototype.onRowHeightTypeChange=function(){this.rowFormat.heightType=this.rowHeightType.text},e.prototype.onAllowBreakAcrossPage=function(){this.rowFormat.allowBreakAcrossPages=this.allowRowBreak.checked},e.prototype.onRepeatHeader=function(){this.rowFormat.isHeader=this.repeatHeader.checked},e.prototype.initTableCellProperties=function(e,i){var r=t.createElement("div",{styles:"width: 100%;"}),n=t.createElement("div",{innerHTML:i.getConstant("Size"),className:"e-de-table-dialog-options-label",styles:"width: 100%;padding-top: 20px;padding-bottom: 10px;"}),a=t.createElement("div",{styles:"display: inline;width: 100%;"}),d=t.createElement("div",{styles:"display: inline;float: left;",className:"e-de-table-cell-header-div"}),h=t.createElement("input",{attrs:{type:"checkbox"},id:e.id+"_Prefer_Width_CheckBox_cell"}),c=t.createElement("div",{styles:"display: inline-block;",className:"e-de-cell-width-top"});this.preferredCellWidth=t.createElement("input",{id:e.id+"tablecell_Width_textBox",attrs:{type:"text"}});var p=t.createElement("div",{styles:"float: right;display: inline;width: auto;margin-top: 5px;"}),g=t.createElement("div",{styles:"display: inline;",className:"e-de-table-ppty-dlg-cell-tab-measure-label"}),u=t.createElement("div",{styles:"display: inline;float: right;",className:"e-de-table-cell-subheader-div"}),f=t.createElement("div"),m=t.createElement("select",{innerHTML:"<option>"+i.getConstant("Points")+"</option><option>"+i.getConstant("Percent")+"</option>",id:e.id+"_measure_type_cell"}),v=t.createElement("label",{innerHTML:i.getConstant("Measure in"),styles:"font-size: 11px;font-weight: normal;"});r.appendChild(n),e.appendChild(r),d.appendChild(h),a.appendChild(d),c.appendChild(this.preferredCellWidth),a.appendChild(c),f.appendChild(m),g.appendChild(v),u.appendChild(f),p.appendChild(g),p.appendChild(u),a.appendChild(p),e.appendChild(a);var y=t.createElement("div",{innerHTML:i.getConstant("Vertical alignment"),styles:"width: 100%;margin: 0px;",className:"e-de-table-dialog-options-label"}),w=e.id+"e-de-table-cell-alignment",b=t.createElement("div",{styles:"width: 100%;height: 100px;"}),x="width:54px;height:54px;margin:2px;border-style:solid;border-width:1px",C=t.createElement("div",{className:"e-de-table-dia-align-div"});this.cellTopAlign=t.createElement("div",{styles:x,id:e.id+"_cell_top-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-top-alignment "+w}),C.appendChild(this.cellTopAlign);var F=t.createElement("div",{className:"e-de-table-dia-align-div"});this.cellCenterAlign=t.createElement("div",{styles:x,id:e.id+"_cell_center-alignment",className:"e-icons e-de-tablecell-alignment  e-de-tablecell-center-alignment "+w}),F.appendChild(this.cellCenterAlign);var P=t.createElement("div",{className:"e-de-table-dia-align-div"});this.cellBottomAlign=t.createElement("div",{styles:x,id:e.id+"_cell_bottom-alignment",className:"e-icons e-de-tablecell-alignment e-de-tablecell-bottom-alignment  "+w}),P.appendChild(this.cellBottomAlign);var W=t.createElement("label",{innerHTML:i.getConstant("Top"),className:"e-de-table-dia-align-label"}),T=t.createElement("label",{innerHTML:i.getConstant("Center"),className:"e-de-table-dia-align-label"}),I=t.createElement("label",{innerHTML:i.getConstant("Bottom"),className:"e-de-table-dia-align-label"});this.cellOptionButton=t.createElement("button",{innerHTML:i.getConstant("Options"),id:e.id+"_table_cellmargin",className:"e-de-tbl-dlg-op-btn e-control e-btn e-flat e-de-cell-options"}),b.appendChild(C),b.appendChild(F),b.appendChild(P),C.appendChild(W),F.appendChild(T),P.appendChild(I),e.appendChild(y),e.appendChild(b),e.appendChild(this.cellOptionButton),this.cellOptionButton.addEventListener("click",this.showCellOptionsDialog),this.cellWidthBox=new l.NumericTextBox({value:0,decimals:2,min:0,max:1584,width:120,enablePersistence:!1}),this.cellWidthBox.appendTo(this.preferredCellWidth),this.preferredCellWidthCheckBox=new o.CheckBox({label:i.getConstant("Preferred Width")}),this.preferredCellWidthCheckBox.appendTo(h),this.cellWidthType=new s.DropDownList({width:"120px"}),this.cellWidthType.appendTo(m)},e.prototype.setTableCellProperties=function(){var e=this.owner.selection.cellFormat;this.hasCellWidth=e.preferredWidth>0;var i=e.preferredWidth;t.isNullOrUndefined(e.preferredWidth)?(this.preferredCellWidthCheckBox.indeterminate=!0,i=this.owner.selection.start.paragraph.associatedCell.cellFormat.preferredWidth):this.preferredCellWidthCheckBox.checked=this.hasCellWidth,this.cellWidthBox.enabled=this.hasCellWidth,this.cellWidthType.enabled=this.hasCellWidth,"Auto"===e.preferredWidthType||"Point"===e.preferredWidthType?this.cellWidthType.index=0:this.cellWidthType.index=1,this.formatNumericTextBox(this.cellWidthBox,e.preferredWidthType,i),t.classList(this.cellTopAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),t.classList(this.cellCenterAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),t.classList(this.cellBottomAlign,["e-de-tablecell-alignment"],["e-de-table-alignment-active"]),"Top"===e.verticalAlignment?this.cellTopAlign.classList.add("e-de-table-alignment-active"):"Center"===e.verticalAlignment?this.cellCenterAlign.classList.add("e-de-table-alignment-active"):"Bottom"===e.verticalAlignment&&this.cellBottomAlign.classList.add("e-de-table-alignment-active")},e.prototype.updateClassForCellAlignment=function(e){for(var i=e.getElementsByClassName(e.id+"e-de-table-cell-alignment"),r=0;r<i.length;r++){var n=i[r];n.classList.contains("e-de-table-alignment-active")&&t.classList(n,["e-de-tablecell-alignment"],["e-de-table-alignment-active"])}},e.prototype.formatNumericTextBox=function(e,t,i){e.format="Auto"===t||"Point"===t?"n2":"#'%'",e.step=1,e.decimals=2,e.value=i},e.prototype.getCellAlignment=function(){for(var e=this.cellTab.id,t=this.cellTab.getElementsByClassName(e+"e-de-table-cell-alignment"),i=0;i<t.length;i++)if(t[i].classList.contains("e-de-table-alignment-active"))return 0===i?"Top":1===i?"Center":"Bottom";return this.owner.selection.cellFormat.verticalAlignment},e.prototype.onCellWidthChange=function(){this.cellFormat.preferredWidth=this.cellWidthBox.value},e.prototype.onCellWidthTypeChange=function(){var e,t=this.owner.selection.start.paragraph.associatedCell.ownerTable,i=t.getOwnerWidth(!0),r=t.getTableClientWidth(i);"Percent"===this.cellWidthType.text&&"Percent"!==this.owner.selection.cellFormat.preferredWidthType?(e=this.cellWidthBox.value/r*100,this.formatNumericTextBox(this.cellWidthBox,"Percent",e)):"Points"===this.cellWidthType.text&&"Point"!==this.owner.selection.cellFormat.preferredWidthType?(e=r/100*this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Point",e)):(e="#'%'"===this.cellWidthBox.format?"Points"===this.cellWidthType.text?r/100*this.cellWidthBox.value:this.cellWidthBox.value:"Percent"===this.cellWidthType.text?this.cellWidthBox.value/r*100:this.cellWidthBox.value,this.formatNumericTextBox(this.cellWidthBox,"Points"===this.cellWidthType.text?"Point":this.cellWidthType.text,e)),this.cellFormat.preferredWidthType="Points"===this.cellWidthType.text?"Point":this.cellWidthType.text},e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.cellAlignment=void 0,this.tableAlignment=void 0,this.owner=void 0,this.preferCheckBox=void 0,this.tableWidthType=void 0,this.preferredWidth=void 0,this.rowHeightType=void 0,this.rowHeightCheckBox=void 0,this.rowHeight=void 0,this.cellWidthType=void 0,this.preferredCellWidthCheckBox=void 0,this.preferredCellWidth=void 0,this.tableTab=void 0,this.rowTab=void 0,this.cellTab=void 0,this.left=void 0,this.center=void 0,this.right=void 0,this.leftIndent=void 0,this.allowRowBreak=void 0,this.repeatHeader=void 0,this.cellTopAlign=void 0,this.cellCenterAlign=void 0,this.cellBottomAlign=void 0,this.tableFormat.destroy(),this.cellFormat.destroy(),this.tableFormat=void 0,this.cellFormat=void 0},e}(),vt=function(){function e(e){var i=this;this.cellFormat=new H,this.tableFormat=new R,this.applyBordersShadingsProperties=function(){var e=i.owner.owner.tablePropertiesDialogModule,r=i.owner.selection.start.paragraph.associatedCell,n=void 0;(i.checkClassName(i.previewDivTopTop)||i.checkClassName(i.previewDivTopBottom)||i.checkClassName(i.previewDivTopCenter)||i.checkClassName(i.previewDivBottomcenter)||i.checkClassName(i.previewDivBottomLeft)||i.checkClassName(i.previewDivBottomRight)||i.checkClassName(i.previewDivDiagonalRight)||i.checkClassName(i.previewDivLeftDiagonal))&&(n=new B,i.checkClassName(i.previewDivTopTop)&&(n.top=i.getBorder()),i.checkClassName(i.previewDivTopBottom)&&(n.bottom=i.getBorder()),i.checkClassName(i.previewDivBottomLeft)&&(n.left=i.getBorder()),i.checkClassName(i.previewDivBottomRight)&&(n.right=i.getBorder()),i.checkClassName(i.previewDivTopCenter)&&(n.horizontal=i.getBorder()),i.checkClassName(i.previewDivBottomcenter)&&(n.vertical=i.getBorder()),i.checkClassName(i.previewDivLeftDiagonal)&&(n.diagonalDown=i.getBorder()),i.checkClassName(i.previewDivDiagonalRight)&&(n.diagonalUp=i.getBorder()));var o=new E,a=i.owner.owner.editorModule;if(o.backgroundColor=i.shadingColorPicker.value,0===i.ulelementShading.index)i.applyTo=0,e&&(e.isCellBordersAndShadingUpdated=!0),i.cellFormat.borders=new B,t.isNullOrUndefined(n)?i.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&a.applyBordersInternal(i.cellFormat.borders,new B):a.applyBordersInternal(i.cellFormat.borders,n),t.isNullOrUndefined(r.cellFormat.shading)||(o.foregroundColor=r.cellFormat.shading.foregroundColor,o.textureStyle=r.cellFormat.shading.textureStyle),i.cellFormat.shading=new E,a.applyShading(i.cellFormat.shading,o);else{e&&(e.isTableBordersAndShadingUpdated=!0),i.applyTo=1;var s=i.owner.owner.selection.tableFormat.table.tableFormat;i.tableFormat.copyFormat(s),i.tableFormat.borders=new B,t.isNullOrUndefined(n)?i.noneDiv.classList.contains("e-de-table-border-inside-setting-click")&&a.applyBordersInternal(i.tableFormat.borders,new B):a.applyBordersInternal(i.tableFormat.borders,n),t.isNullOrUndefined(s.shading)||(o.foregroundColor=s.shading.foregroundColor,o.textureStyle=s.shading.textureStyle),i.tableFormat.shading=new E,a.applyShading(i.tableFormat.shading,o)}i.applyFormat(),i.closeDialog()},this.closeDialog=function(){i.owner.dialog.hide(),i.closeBordersShadingsDialog()},this.closeBordersShadingsDialog=function(){i.owner.dialog2.element.style.pointerEvents="",i.owner.updateFocus()},this.handleSettingCheckBoxAction=function(e){var t=e.target.id,r=i.target.id;t===r+"_None_Div"||t===r+"_None_Div_Container"||t===r+"_None_Div_Transparent"?(i.updateClassForSettingDivElements(),i.noneDiv.classList.add("e-de-table-border-inside-setting-click"),i.setSettingPreviewDivElement("none")):t===r+"_Box_Div"||t===r+"_Box_Div_Container"||t===r+"_Box_Div_Transparent"?(i.updateClassForSettingDivElements(),i.boxDiv.classList.add("e-de-table-border-inside-setting-click"),i.setSettingPreviewDivElement("box")):t===r+"_All_Div"||t===r+"_All_Div_Container"||t===r+"_All_Div_Transparent"?(i.updateClassForSettingDivElements(),i.allDiv.classList.add("e-de-table-border-inside-setting-click"),i.setSettingPreviewDivElement("all")):(i.updateClassForSettingDivElements(),i.customDiv.classList.add("e-de-table-border-inside-setting-click"),i.setSettingPreviewDivElement("customDiv"))},this.handlePreviewCheckBoxAction=function(e){var t=e.target.id,r=(i.target,i.target.id),n="e-de-table-border-inside-preview-click";i.customDiv.click(),t===r+"_Preview_Div_TopTop_Container"||t===r+"_Preview_Div_TopTop"||t===r+"_previewDivTopTopTransParent"?(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivTopTop),i.showHidePreviewDivElements(r,n,"_Preview_Div","_Preview_Div_TopTop","TopTop")):t===r+"_Preview_Div_TopCenter_Container"||t===r+"_Preview_Div_TopCenter"||t===r+"_previewDivTopCenterTransParent"?(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivTopCenter),i.showHidePreviewDivElements(r,n,"_Preview_Div_Horizontal","_Preview_Div_TopCenter","TopCenter")):t===r+"_Preview_Div_TopBottom_Container"||t===r+"_Preview_Div_TopBottom"||t===r+"_previewDivTopBottomTransParent"?(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivTopBottom),i.showHidePreviewDivElements(r,n,"_Preview_Div","_Preview_Div_TopBottom","TopBottom")):t===r+"_Preview_Div_LeftDiagonal_Container"||t===r+"_Preview_Div_LeftDiagonal"||t===r+"_previewDivLeftDiagonalTransParent"?(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivLeftDiagonal),i.showHidePreviewDivElements(r,n,"_Preview_Div_Left_Diagonal","_Preview_Div_LeftDiagonal","LeftDiagonal")):t===r+"_Preview_Div_BottomLeft_Container"||t===r+"_Preview_Div_BottomLeft"||t===r+"_previewDivBottomLeftTransparent"?(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivBottomLeft),i.showHidePreviewDivElements(r,n,"_Preview_Div","_Preview_Div_BottomLeft","BottomLeft")):t===r+"_Preview_Div_BottomCenter_Container"||t===r+"_Preview_Div_BottomCenter"||t===r+"_previewDivBottomcenterTransparent"?(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivBottomcenter),i.showHidePreviewDivElements(r,n,"_Preview_Div_Vertical","_Preview_Div_BottomCenter","BottomCenter")):t===r+"_Preview_Div_BottomRight_Container"||t===r+"_Preview_Div_BottomRight"||t===r+"_previewDivBottomRightTransparent"?(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivBottomRight),i.showHidePreviewDivElements(r,n,"_Preview_Div","_Preview_Div_BottomRight","BottomRight")):t!==r+"_Preview_Div_RightDiagonal_Container"&&t!==r+"_Preview_Div_RightDiagonal"&&t!==r+"_previewDivDiagonalRightTransparent"||(i.handlePreviewCheckBoxShowHide(r,n,i.previewDivDiagonalRight),i.showHidePreviewDivElements(r,n,"_Preview_Div_Right_Diagonal","_Preview_Div_RightDiagonal","RightDiagonal"))},this.applyTableCellPreviewBoxes=function(){i.customDiv.click(),t.isNullOrUndefined(i.ulelementShading)||(0===i.ulelementShading.index?(i.previewDivBottomcenterContainer.style.display="none",i.previewDivTopCenterContainer.style.display="none",i.previewVerticalDiv.style.display="none",i.previewHorizontalDiv.style.display="none",i.previewDivLeftDiagonal.style.display="",i.previewDivDiagonalRight.style.display="",i.previewDivBottomRightContainer.style.left="80px"):(i.previewDivLeftDiagonal.style.display="none",i.previewDivDiagonalRight.style.display="none",i.previewDivBottomcenterContainer.style.display="",i.previewDivTopCenterContainer.style.display="",i.previewVerticalDiv.style.display="",i.previewHorizontalDiv.style.display="",i.previewDivBottomRightContainer.style.left="110px"))},this.applyPreviewTableBackgroundColor=function(e){if(!t.isNullOrUndefined(e.currentValue)){var r=e.currentValue.hex;i.previewDiv.style.backgroundColor=r}},this.applyPreviewTableBorderColor=function(e){if(!t.isNullOrUndefined(e.currentValue)){var r=e.currentValue.hex;i.previewDiv.style.borderColor=r,i.previewRightDiagonalDiv.style.backgroundColor=r,i.previewLeftDiagonalDiv.style.backgroundColor=r,i.previewVerticalDiv.style.backgroundColor=r,i.previewHorizontalDiv.style.backgroundColor=r}},this.owner=e}return e.prototype.getModuleName=function(){return"BordersAndShadingDialog"},e.prototype.initBordersAndShadingsDialog=function(e){var i=this;this.target=t.createElement("div",{id:i.owner.owner.containerId+"_table_border_shadings",className:"e-de-table-border-shading-dlg"}),this.owner.owner.element.appendChild(this.target);var r=t.createElement("div",{innerHTML:e.getConstant("Borders"),styles:"position: absolute;top: 65px;",id:this.target.id+"_border_label",className:"e-de-table-border-heading"}),n=t.createElement("div",{styles:"display: inline-block;position: absolute;top: 105px;width: 100px;height: 235px;border-style: none;",id:this.target.id+"_border_settings"}),o=t.createElement("div",{styles:"display: inline-block;position: absolute;left: 125px;top: 125px;width: 150px;height: 235px;padding-left: 40px;border-style: none;padding-right: 40px;",id:this.target.id+"_border_style"}),a=t.createElement("div",{styles:"display: inline-block;position: absolute;left: 345px;top: 87px;width: 180px;height: 235px;padding: 0px;border-style: none;",id:this.target.id+"_border_preview"}),d=t.createElement("div",{innerHTML:e.getConstant("Style"),styles:"width: 100%;padding-bottom: 10px;",className:"e-de-table-element-subheading"}),h=t.createElement("select",{id:this.target.id+"_border_style_dropDown"});h.innerHTML="<option>"+e.getConstant("None")+"</option><option>"+e.getConstant("Single")+"</option><option>"+e.getConstant("Dot")+"</option><option>"+e.getConstant("DashSmallGap")+"</option><option>"+e.getConstant("DashLargeGap")+"</option><option>"+e.getConstant("DashDot")+"</option><option>"+e.getConstant("DashDotDot")+"</option><option>"+e.getConstant("Double")+"</option><option>"+e.getConstant("Triple")+"</option><option>"+e.getConstant("ThinThickSmallGap")+"</option><option>"+e.getConstant("ThickThinSmallGap")+"</option><option>"+e.getConstant("ThinThickThinSmallGap")+"</option><option>"+e.getConstant("ThinThickMediumGap")+"</option><option>"+e.getConstant("ThickThinMediumGap")+"</option><option>"+e.getConstant("ThinThickThinMediumGap")+"</option><option>"+e.getConstant("ThinThickLargeGap")+"</option><option>"+e.getConstant("ThickThinLargeGap")+"</option><option>"+e.getConstant("ThinThickThinLargeGap")+"</option><option>"+e.getConstant("SingleWavy")+"</option><option>"+e.getConstant("DoubleWavy")+"</option><option>"+e.getConstant("DashDotStroked")+"</option><option>"+e.getConstant("Emboss3D")+"</option><option>"+e.getConstant("Engrave3D")+"</option><option>"+e.getConstant("Outset")+"</option><option>"+e.getConstant("Inset")+"</option><option>"+e.getConstant("Thick")+"</option>";var c=t.createElement("div",{innerHTML:e.getConstant("Width"),styles:"width:100%;padding-top: 20px;padding-bottom: 10px;",className:"e-de-table-element-subheading"}),p=t.createElement("input",{id:this.target.id+"_width"}),g=t.createElement("div",{innerHTML:e.getConstant("Color"),styles:"padding-top: 25px;",className:"e-de-table-setting-heading"}),u=t.createElement("input",{attrs:{type:"color"},id:this.target.id+"_border_color",styles:"width: 30px;position: absolute;left: 90px;",className:"e-dlg-clr-pkr-top"}),f=t.createElement("div",{innerHTML:e.getConstant("Setting"),styles:"width: 100%;position: absolute;",className:"e-de-table-setting-heading"}),m=t.createElement("div",{id:this.target.id+"_None_Div_Container",className:"e-de-table-border-none"});this.noneDiv=t.createElement("div",{id:this.target.id+"_None_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var v=t.createElement("label",{innerHTML:e.getConstant("None"),className:"e-de-table-setting-labels-heading",styles:"padding-left: 10px;top: 20px;position: absolute;",id:this.target.id+"_None_Div_Label"}),y=t.createElement("div",{id:this.target.id+"_Box_Div_Container",className:"e-de-table-border-box"});this.boxDiv=t.createElement("div",{id:this.target.id+"_Box_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var w=t.createElement("label",{innerHTML:e.getConstant("Box"),className:"e-de-table-setting-labels-heading",styles:"padding-left: 10px;top: 20px;position: absolute;",id:this.target.id+"_Box_Div_Label"}),b=t.createElement("div",{id:this.target.id+"_All_Div_Container",className:"e-de-table-border-all"});this.allDiv=t.createElement("div",{id:this.target.id+"_All_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var x=t.createElement("label",{innerHTML:e.getConstant("All"),className:"e-de-table-setting-labels-heading",styles:"padding-left: 10px;top: 25px;position: absolute;",id:this.target.id+"_All_Div_Label"}),C=t.createElement("div",{id:this.target.id+"_Custom_Div_Container",className:"e-de-table-border-custom"});this.customDiv=t.createElement("div",{id:this.target.id+"_Custom_Div",className:"e-de-table-border-inside-setting e-de-table-border-setting-genral"});var F=t.createElement("label",{innerHTML:e.getConstant("Custom"),className:"e-de-table-setting-labels-heading",styles:"padding-left: 10px;top: 25px;position: absolute;",id:this.target.id+"_Custom_Div_Label"});this.noneDivTransparent=t.createElement("div",{id:this.target.id+"_None_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-none-setting"}),this.boxDivTransparent=t.createElement("div",{id:this.target.id+"_Box_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-box-setting"}),this.allDivTransparent=t.createElement("div",{id:this.target.id+"_All_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-all-setting"}),this.customDivTransparent=t.createElement("div",{id:this.target.id+"_Custom_Div_Transparent",className:"e-icons e-de-table-border-setting e-de-table-border-custom-setting"});var P=t.createElement("div",{innerHTML:e.getConstant("Preview"),className:"e-de-table-setting-heading",styles:"position: absolute;top: 20px;left: 10px;"});this.previewDiv=t.createElement("div",{styles:"width: 80px;height: 80px;position: absolute; left: 50px;top: 50px;",id:this.target.id+"_Preview_Div",className:"e-de-border-dlg-preview-div"}),this.previewRightDiagonalDiv=t.createElement("div",{styles:"position: absolute;width:1px;height:113px;left: 90px;top: 34px;transform: rotate(135deg);",id:this.target.id+"_Preview_Div_Right_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewLeftDiagonalDiv=t.createElement("div",{styles:"position: absolute;width: 1px;height: 113px;left: 90px;top: 34px;transform:rotate(45deg);",id:this.target.id+"_Preview_Div_Left_Diagonal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewVerticalDiv=t.createElement("div",{styles:"width: 1px;height: 81px;position: absolute;left: 90px;top: 50px;",id:this.target.id+"_Preview_Div_Vertical",className:"e-de-border-dlg-preview-inside-divs"}),this.previewHorizontalDiv=t.createElement("div",{styles:"width: 81px;height: 1px;position: absolute;left: 50px;top: 90px;",id:this.target.id+"_Preview_Div_Horizontal",className:"e-de-border-dlg-preview-inside-divs"}),this.previewDivTopTopContainer=t.createElement("div",{styles:"top: 50px;position: absolute;left: 10px;",id:this.target.id+"_Preview_Div_TopTop_Container"}),this.previewDivTopTop=t.createElement("div",{id:this.target.id+"_Preview_Div_TopTop",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopCenterContainer=t.createElement("div",{styles:"top: 80px;position: absolute;left: 10px;",id:this.target.id+"_Preview_Div_TopCenter_Container"}),this.previewDivTopCenter=t.createElement("div",{id:this.target.id+"_Preview_Div_TopCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopBottomContainer=t.createElement("div",{styles:"top: 110px;position: absolute;left: 10px;",id:this.target.id+"_Preview_Div_TopBottom_Container"}),this.previewDivTopBottom=t.createElement("div",{id:this.target.id+"_Preview_Div_TopBottom",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivLeftDiagonalContainer=t.createElement("div",{styles:"top: 145px;position: absolute;left: 10px;",id:this.target.id+"_Preview_Div_LeftDiagonal_Container"}),this.previewDivLeftDiagonal=t.createElement("div",{id:this.target.id+"_Preview_Div_LeftDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomLeftContainer=t.createElement("div",{styles:"top: 145px;position: absolute;left: 50px",id:this.target.id+"_Preview_Div_BottomLeft_Container"}),this.previewDivBottomLeft=t.createElement("div",{id:this.target.id+"_Preview_Div_BottomLeft",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomcenterContainer=t.createElement("div",{styles:"top: 145px;position: absolute;left: 80px;",id:this.target.id+"_Preview_Div_BottomCenter_Container"}),this.previewDivBottomcenter=t.createElement("div",{id:this.target.id+"_Preview_Div_BottomCenter",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivBottomRightContainer=t.createElement("div",{styles:"top: 145px;position: absolute;left: 110px;",id:this.target.id+"_Preview_Div_BottomRight_Container"}),this.previewDivBottomRight=t.createElement("div",{id:this.target.id+"_Preview_Div_BottomRight",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivDiagonalRightContainer=t.createElement("div",{styles:"top: 145px; position: absolute; left: 110px;",id:this.target.id+"_Preview_Div_RightDiagonal_Container"}),this.previewDivDiagonalRight=t.createElement("div",{id:this.target.id+"_Preview_Div_RightDiagonal",className:"e-de-table-border-inside-preview e-de-table-border-preview-genral"}),this.previewDivTopTopTransParent=t.createElement("div",{id:this.target.id+"_previewDivTopTopTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-toptop-alignment"}),this.previewDivTopCenterTransParent=t.createElement("div",{id:this.target.id+"_previewDivTopCenterTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topcenter-alignment"}),this.previewDivTopBottomTransParent=t.createElement("div",{id:this.target.id+"_previewDivTopBottomTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-topbottom-alignment"}),this.previewDivLeftDiagonalTransParent=t.createElement("div",{id:this.target.id+"_previewDivLeftDiagonalTransParent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionalup-alignment"}),this.previewDivBottomLeftTransparent=t.createElement("div",{id:this.target.id+"_previewDivBottomLeftTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomleft-alignment"}),this.previewDivBottomcenterTransparent=t.createElement("div",{id:this.target.id+"_previewDivBottomcenterTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomcenter-alignment"}),this.previewDivBottomRightTransparent=t.createElement("div",{id:this.target.id+"_previewDivBottomRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-bottomright-alignment"}),this.previewDivDiagonalRightTransparent=t.createElement("div",{id:this.target.id+"_previewDivDiagonalRightTransparent",className:"e-icons e-de-table-border-preview e-de-table-border-diagionaldown-alignment"}),this.shadingContiner=t.createElement("div",{styles:"display:inline-block;position:absolute;left:17px;width:400px;height:100px;padding:0px;border-style: none;margin-left:10px;",id:this.target.id+"_shading_preview",className:"e-de-table-shading-preview"});var W=t.createElement("div",{innerHTML:e.getConstant("Shading"),className:"e-de-table-border-heading",styles:"padding-top: 30px;left: 5px;"}),T=t.createElement("div",{styles:"display:flex;"}),I=t.createElement("div",{innerHTML:e.getConstant("Fill"),className:"e-de-table-setting-heading e-de-table-border-fill",styles:"top: 50px;left: 10px;"}),S=t.createElement("input",{attrs:{type:"color"},id:this.target.id+"_shading_color",styles:"position: absolute;top: 75px;left: 40px;width: 30px;"}),N=t.createElement("div",{styles:"position:absolute;top:41px;left:150px;width:180px;"}),O=t.createElement("div",{styles:"width:100px;padding-bottom: 10px;",innerHTML:e.getConstant("Apply To"),className:"e-de-table-element-subheading"}),L=t.createElement("div",{styles:"width:100px;position:absolute;"}),k=t.createElement("select",{innerHTML:"<option>"+e.getConstant("Cell")+"</option><option>"+e.getConstant("Table")+"</option>",id:this.target.id+"_shading"});L.appendChild(k),this.noneDiv.appendChild(this.noneDivTransparent),this.boxDiv.appendChild(this.boxDivTransparent),this.allDiv.appendChild(this.allDivTransparent),this.customDiv.appendChild(this.customDivTransparent),m.appendChild(this.noneDiv),m.appendChild(v),y.appendChild(this.boxDiv),y.appendChild(w),b.appendChild(this.allDiv),b.appendChild(x),C.appendChild(this.customDiv),C.appendChild(F),n.appendChild(f),n.appendChild(m),n.appendChild(y),n.appendChild(b),n.appendChild(C),this.previewDivBottomcenter.appendChild(this.previewDivBottomcenterTransparent),this.previewDivBottomRight.appendChild(this.previewDivBottomRightTransparent),this.previewDivBottomLeft.appendChild(this.previewDivBottomLeftTransparent),this.previewDivTopTop.appendChild(this.previewDivTopTopTransParent),this.previewDivTopCenter.appendChild(this.previewDivTopCenterTransParent),this.previewDivTopBottom.appendChild(this.previewDivTopBottomTransParent),this.previewDivDiagonalRight.appendChild(this.previewDivDiagonalRightTransparent),this.previewDivLeftDiagonal.appendChild(this.previewDivLeftDiagonalTransParent),this.previewDivBottomcenterContainer.appendChild(this.previewDivBottomcenter),this.previewDivBottomLeftContainer.appendChild(this.previewDivBottomLeft),this.previewDivBottomRightContainer.appendChild(this.previewDivBottomRight),this.previewDivDiagonalRightContainer.appendChild(this.previewDivDiagonalRight),this.previewDivLeftDiagonalContainer.appendChild(this.previewDivLeftDiagonal),this.previewDivTopBottomContainer.appendChild(this.previewDivTopBottom),this.previewDivTopCenterContainer.appendChild(this.previewDivTopCenter),this.previewDivTopTopContainer.appendChild(this.previewDivTopTop),a.appendChild(P),a.appendChild(this.previewDiv),a.appendChild(this.previewRightDiagonalDiv),a.appendChild(this.previewHorizontalDiv),a.appendChild(this.previewLeftDiagonalDiv),a.appendChild(this.previewVerticalDiv),a.appendChild(this.previewDivBottomcenterContainer),a.appendChild(this.previewDivBottomLeftContainer),a.appendChild(this.previewDivBottomRightContainer),a.appendChild(this.previewDivDiagonalRightContainer),a.appendChild(this.previewDivLeftDiagonalContainer),a.appendChild(this.previewDivTopBottomContainer),a.appendChild(this.previewDivTopCenterContainer),a.appendChild(this.previewDivTopTopContainer),N.appendChild(O),N.appendChild(L),T.appendChild(I),T.appendChild(S),T.appendChild(N),this.shadingContiner.appendChild(W),this.shadingContiner.appendChild(T),o.appendChild(d),o.appendChild(h),o.appendChild(c),o.appendChild(p),o.appendChild(g),o.appendChild(u),this.target.appendChild(r),this.target.appendChild(n),this.target.appendChild(o),this.target.appendChild(a),this.target.appendChild(this.shadingContiner),m.addEventListener("click",this.handleSettingCheckBoxAction),y.addEventListener("click",this.handleSettingCheckBoxAction),b.addEventListener("click",this.handleSettingCheckBoxAction),C.addEventListener("click",this.handleSettingCheckBoxAction),this.previewDivBottomcenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomLeftContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivBottomRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopTopContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopBottomContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivTopCenterContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivDiagonalRightContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.previewDivLeftDiagonalContainer.addEventListener("click",this.handlePreviewCheckBoxAction),this.borderWidth=new l.NumericTextBox({value:0,min:0,max:6,decimals:2,width:150,enablePersistence:!1}),this.borderWidth.appendTo(p),this.borderStyle=new s.DropDownList({width:"150px",popupHeight:"150px",index:1}),this.borderStyle.appendTo(h),this.ulelementShading=new s.DropDownList({width:"150px",change:this.applyTableCellPreviewBoxes,index:1}),this.ulelementShading.appendTo(k),this.borderColorPicker=new l.ColorPicker({value:"#000000",change:this.applyPreviewTableBorderColor}),this.borderColorPicker.appendTo(u),this.shadingColorPicker=new l.ColorPicker({value:"#000000",change:this.applyPreviewTableBackgroundColor}),this.shadingColorPicker.appendTo(S)},e.prototype.applyFormat=function(){this.owner.selection;var e=this.owner.owner.editorModule;e.initComplexHistory("BordersAndShading"),e.isBordersAndShadingDialog=!0,0===this.applyTo?e.onCellFormat(this.cellFormat):e.onTableFormat(this.tableFormat),t.isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)||this.owner.owner.editorHistory.updateComplexHistory(),e.isBordersAndShadingDialog=!1},e.prototype.getBorder=function(){var e=new k;return e.color=this.borderColorPicker.value,e.lineStyle=this.borderStyle.text,e.lineWidth=this.borderWidth.value,e},e.prototype.checkClassName=function(e){return e.classList.contains("e-de-table-border-inside-preview-click")},e.prototype.show=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initBordersAndShadingsDialog(e),this.loadBordersShadingsPropertiesDialog(),this.owner.dialog.content=this.target,this.owner.dialog.header=e.getConstant("Borders and Shading"),this.owner.dialog.beforeOpen=this.owner.updateFocus,this.owner.dialog.close=this.closeBordersShadingsDialog,this.owner.dialog.position={X:"center",Y:"center"},this.owner.dialog.width="auto",this.owner.dialog.height="auto",this.owner.dialog.buttons=[{click:this.applyBordersShadingsProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-border-shading-okay",isPrimary:!0}},{click:this.closeDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-border-shading-cancel"}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.updateClassForSettingDivElements=function(){for(var e=this.target.getElementsByClassName("e-de-table-border-inside-setting"),t=0;t<e.length;t++)if(-1!==e[t].className.indexOf("e-de-table-border-inside-setting-click")){var i=e[t].className;i=i.replace("e-de-table-border-inside-setting-click",""),e[t].className=i}},e.prototype.setSettingPreviewDivElement=function(e){switch(e){case"none":this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("none");break;case"box":this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("box");break;case"all":this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"),this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"),this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"),this.isShowHidePreviewTableElements("all")}},e.prototype.isShowHidePreviewTableElements=function(e){switch(e){case"none":this.previewDiv.style.border="none",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"box":this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="none",this.previewVerticalDiv.style.display="none";break;case"all":this.previewDiv.style.border="1px solid rgba(0, 0, 0, .54)",this.previewRightDiagonalDiv.style.display="none",this.previewLeftDiagonalDiv.style.display="none",this.previewHorizontalDiv.style.display="block",this.previewVerticalDiv.style.display="block"}},e.prototype.handlePreviewCheckBoxShowHide=function(e,t,i){i.classList.contains(t)?i.classList.remove(t):i.classList.add(t)},e.prototype.showHidePreviewDivElements=function(e,t,i,r,n){var o=document.getElementById(e+i),a=document.getElementById(e+r);"TopTop"===n?this.setPropertyPreviewDivElement(o,a,t,"border-top"):"TopCenter"===n?this.setPropertyPreviewDivElement(o,a,t,"display"):"TopBottom"===n?this.setPropertyPreviewDivElement(o,a,t,"border-bottom"):"LeftDiagonal"===n?this.setPropertyPreviewDivElement(o,a,t,"display"):"BottomLeft"===n?this.setPropertyPreviewDivElement(o,a,t,"border-left"):"BottomCenter"===n?this.setPropertyPreviewDivElement(o,a,t,"display"):"BottomRight"===n?this.setPropertyPreviewDivElement(o,a,t,"border-right"):"RightDiagonal"===n&&this.setPropertyPreviewDivElement(o,a,t,"display")},e.prototype.setPropertyPreviewDivElement=function(e,t,i,r){t.classList.contains(i)&&"border"===r.split("-")[0]?e.style[r]="1px solid rgba(0, 0, 0, .54)":t.classList.contains(i)&&"display"===r?e.style[r]="block":e.style[r]="none"},e.prototype.loadBordersShadingsPropertiesDialog=function(){var e,i,r,n,o=this.owner.selection.tableFormat.table.tableFormat;t.isNullOrUndefined(o)||t.isNullOrUndefined(o.borders)||(this.cloneBorders(o.borders),t.isNullOrUndefined(o.borders)||t.isNullOrUndefined(o.borders.top)?(e=1,i="#000000",n=0,r="#000000"):(e=this.getLineStyle(o.borders.top.lineStyle),i=o.borders.top.color,n=o.borders.top.getLineWidth(),r=o.shading.backgroundColor)),this.borderColorPicker.value=i,this.shadingColorPicker.value=r;var a={target:this.borderColorPicker,ctrlKey:!1,shiftKey:!1,which:0},s={target:this.shadingColorPicker,ctrlKey:!1,shiftKey:!1,which:0};this.applyPreviewTableBackgroundColor(s),this.applyPreviewTableBorderColor(a),this.ulelementShading.index=1,this.previewDivLeftDiagonal.style.display="none",this.previewDivDiagonalRight.style.display="none",this.borderWidth.value=n,this.borderStyle.index=e},e.prototype.cloneBorders=function(e){var t=!1,i=!1,r=!1,n=!1,o=!1,a=!1,s=!1,l=!1,d=!1;null!==e&&(e.top&&(e.top.hasNoneStyle||"None"!==e.top.lineStyle)&&(t=!0),e.bottom&&(e.bottom.hasNoneStyle||"None"!==e.bottom.lineStyle)&&(i=!0),e.left&&(e.left.hasNoneStyle||"None"!==e.left.lineStyle)&&(r=!0),e.right&&(e.right.hasNoneStyle||"None"!==e.right.lineStyle)&&(n=!0),e.horizontal&&(e.horizontal.hasNoneStyle||"None"!==e.horizontal.lineStyle)&&(o=!0),e.vertical&&(e.vertical.hasNoneStyle||"None"!==e.vertical.lineStyle)&&(a=!0),e.diagonalDown&&(e.diagonalDown.hasNoneStyle||"None"!==e.diagonalDown.lineStyle)&&(s=!0),e.diagonalUp&&(e.diagonalUp.hasNoneStyle||"None"!==e.diagonalUp.lineStyle)&&(d=!0),t&&i&&r&&n?t&&i&&r&&n&&o&&a&&!d&&!s?t&&i&&r&&n&&o&&a&&!d&&!s&&(e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("all"),this.allDiv.classList.add("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"))):r&&i&&t&&n&&!o&&!a?e.top.hasNoneStyle&&e.bottom.hasNoneStyle&&e.left.hasNoneStyle&&e.right.hasNoneStyle&&e.horizontal.hasNoneStyle&&e.vertical.hasNoneStyle?(this.setSettingPreviewDivElement("none"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.add("e-de-table-border-inside-setting-click")):(this.setSettingPreviewDivElement("box"),this.customDiv.classList.remove("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.add("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click")):l=!0:l=!0,this.previewDivLeftDiagonal.classList.remove("e-de-table-border-inside-preview-click"),this.previewDivDiagonalRight.classList.remove("e-de-table-border-inside-preview-click"),l&&(this.customDiv.classList.add("e-de-table-border-inside-setting-click"),this.noneDiv.classList.remove("e-de-table-border-inside-setting-click"),this.boxDiv.classList.remove("e-de-table-border-inside-setting-click"),this.allDiv.classList.remove("e-de-table-border-inside-setting-click"),t?this.previewDivTopTop.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopTop.classList.remove("e-de-table-border-inside-preview-click"),i?this.previewDivTopBottom.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopBottom.classList.remove("e-de-table-border-inside-preview-click"),r?this.previewDivBottomLeft.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomLeft.classList.remove("e-de-table-border-inside-preview-click"),n?this.previewDivBottomRight.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomRight.classList.remove("e-de-table-border-inside-preview-click"),a?this.previewDivBottomcenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivBottomcenter.classList.remove("e-de-table-border-inside-preview-click"),o?this.previewDivTopCenter.classList.add("e-de-table-border-inside-preview-click"):this.previewDivTopCenter.classList.remove("e-de-table-border-inside-preview-click")))},e.prototype.getLineStyle=function(e){switch(e){case"Single":return 1;case"Dot":return 2;case"DashSmallGap":return 3;case"DashLargeGap":return 4;case"DashDot":return 5;case"DashDotDot":return 6;case"Double":return 7;case"Triple":return 8;case"ThinThickSmallGap":return 9;case"ThickThinSmallGap":return 10;case"ThinThickThinSmallGap":return 11;case"ThinThickMediumGap":return 12;case"ThickThinMediumGap":return 13;case"ThinThickThinMediumGap":return 14;case"ThinThickLargeGap":return 15;case"ThickThinLargeGap":return 16;case"ThinThickThinLargeGap":return 17;case"SingleWavy":return 18;case"DoubleWavy":return 19;case"DashDotStroked":return 20;case"Emboss3D":return 21;case"Engrave3D":return 22;case"Outset":return 23;case"Inset":return 24;case"Thick":return 25}return 0},e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.cellFormat&&(this.cellFormat.destroy(),this.cellFormat=void 0),this.tableFormat&&(this.tableFormat.destroy(),this.tableFormat=void 0),this.dialog=void 0,this.target=void 0,t.isNullOrUndefined(this.borderStyle)||this.borderStyle.destroy(),this.borderStyle=void 0,t.isNullOrUndefined(this.borderColorPicker)||this.borderColorPicker.destroy(),this.borderColorPicker=void 0,t.isNullOrUndefined(this.shadingColorPicker)||this.shadingColorPicker.destroy(),this.shadingColorPicker=void 0,t.isNullOrUndefined(this.ulelementShading)||this.ulelementShading.destroy(),this.ulelementShading=void 0,this.noneDivTransparent=void 0,this.boxDivTransparent=void 0,this.allDivTransparent=void 0,this.customDivTransparent=void 0,this.previewDiv=void 0,this.previewRightDiagonalDiv=void 0,this.previewLeftDiagonalDiv=void 0,this.previewVerticalDiv=void 0,this.previewHorizontalDiv=void 0,this.previewDivTopTopContainer=void 0,this.previewDivTopTop=void 0,this.previewDivTopCenterContainer=void 0,this.previewDivTopCenter=void 0,this.previewDivTopBottomContainer=void 0,this.previewDivTopBottom=void 0,this.previewDivLeftDiagonalContainer=void 0,this.previewDivLeftDiagonal=void 0,this.previewDivBottomLeftContainer=void 0,this.previewDivBottomLeft=void 0,this.previewDivBottomcenterContainer=void 0,this.previewDivBottomcenter=void 0,this.previewDivBottomRightContainer=void 0,this.previewDivBottomRight=void 0,this.previewDivDiagonalRightContainer=void 0,this.previewDivDiagonalRight=void 0,this.previewDivTopTopTransParent=void 0,this.previewDivTopCenterTransParent=void 0,this.previewDivTopBottomTransParent=void 0,this.previewDivLeftDiagonalTransParent=void 0,this.previewDivBottomLeftTransparent=void 0,this.previewDivBottomcenterTransparent=void 0,this.previewDivBottomRightTransparent=void 0,this.previewDivDiagonalRightTransparent=void 0,this.shadingContiner=void 0,this.noneDiv=void 0,this.customDiv=void 0,this.allDiv=void 0,this.boxDiv=void 0},e}(),yt=function(){function e(e){var i=this;this.applyTableCellProperties=function(){var e=i.owner.selection.tableFormat;t.isNullOrUndefined(i.bottomMarginBox.value||i.leftMarginBox.value||i.rightMarginBox.value||i.topMarginBox.value||i.cellSpaceTextBox.value)||e.bottomMargin===i.bottomMarginBox.value&&e.leftMargin===i.leftMarginBox.value&&e.rightMargin===i.rightMarginBox.value&&e.topMargin===i.topMarginBox.value&&e.cellSpacing===i.cellSpaceTextBox.value||(i.owner.owner.tablePropertiesDialogModule.isTableOptionsUpdated=!0,i.applyTableOptions(i.tableFormat),i.owner.owner.tablePropertiesDialogModule.applyTableSubProperties()),i.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){i.owner.dialog.hide(),i.owner.dialog.element.style.pointerEvents="",i.owner.updateFocus()},this.changeAllowSpaceCheckBox=function(){i.allowSpaceCheckBox.checked?i.cellSpaceTextBox.enabled=!0:i.cellSpaceTextBox.enabled=!1},this.removeEvents=function(){i.owner.dialog2.element.style.pointerEvents="",i.owner.updateFocus()},this.owner=e}return Object.defineProperty(e.prototype,"tableFormat",{get:function(){return t.isNullOrUndefined(this.tableFormatIn)?this.tableFormatIn=new R:this.tableFormatIn},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"TableOptionsDialog"},e.prototype.initTableOptionsDialog=function(e){this.owner;this.target=t.createElement("div",{id:this.owner.owner.containerId+"_insertCellMarginsDialog",className:"e-de-table-options-dlg"}),this.owner.owner.element.appendChild(this.target);var i=t.createElement("div",{styles:"width: 475px;position: relative;height: 180px;"}),r=t.createElement("Label",{id:this.target.id+"_innerDivLabel",className:"e-de-cell-dia-options-label",innerHTML:e.getConstant("Default cell margins")});i.appendChild(r),wt.getCellMarginDialogElements(this,i,e);var n=t.createElement("div",{styles:"width: 475px; position: relative;"}),a=t.createElement("Label",{className:"e-de-cell-dia-options-label",id:this.target.id+"_cellSpaceLabel"});a.innerHTML=e.getConstant("Default cell spacing"),n.appendChild(a);var s=t.createElement("TABLE",{styles:"height: 30px;padding-bottom: 15px;"}),d=t.createElement("tr"),h=t.createElement("td"),c=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_cellcheck"}),p=t.createElement("td",{styles:"padding-left: 15px;"});this.cellspacingTextBox=t.createElement("input",{attrs:{type:"text"},id:this.target.id+"_cellspacing"}),h.appendChild(c),p.appendChild(this.cellspacingTextBox),d.appendChild(h),d.appendChild(p),s.appendChild(d),n.appendChild(s);var g=document.createElement("div");this.target.appendChild(n),this.target.appendChild(g),this.cellSpaceTextBox=new l.NumericTextBox({value:0,min:0,max:264.5,width:150,decimals:2,enablePersistence:!1}),this.cellSpaceTextBox.appendTo(this.cellspacingTextBox),this.allowSpaceCheckBox=new o.CheckBox({label:e.getConstant("Allow spacing between cells"),change:this.changeAllowSpaceCheckBox,cssClass:"e-de-tbl-margin-sub-header"}),this.allowSpaceCheckBox.appendTo(c)},e.prototype.loadCellMarginsDialog=function(){var e=this.owner.selection.tableFormat;this.cellSpaceTextBox.value=e.cellSpacing,this.bottomMarginBox.value=e.bottomMargin,this.topMarginBox.value=e.topMargin,this.rightMarginBox.value=e.rightMargin,this.leftMarginBox.value=e.leftMargin,e.cellSpacing>0?(this.allowSpaceCheckBox.checked=!0,this.cellSpaceTextBox.enabled=!0):(this.allowSpaceCheckBox.checked=!1,this.cellSpaceTextBox.enabled=!1)},e.prototype.applySubTableOptions=function(e){this.owner.owner.editorHistory.initComplexHistory(this.owner.selection,"TableMarginsSelection"),this.applyTableOptionsHistory(e),t.isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)||this.owner.owner.editorHistory.updateComplexHistory()},e.prototype.applyTableOptionsHelper=function(e){this.applySubTableOptionsHelper(e)},e.prototype.applyTableOptionsHistory=function(e){this.owner.owner.editorModule.initHistory("TableOptions"),this.applySubTableOptionsHelper(e)},e.prototype.applySubTableOptionsHelper=function(e){var i=this.owner.selection.start.currentWidget.paragraph.associatedCell.ownerTable,r=(i=i.combineWidget(this.owner)).tableFormat;t.isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)||this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedTableOptions(r),r.cellSpacing=e.cellSpacing,r.leftMargin=e.leftMargin,r.topMargin=e.topMargin,r.rightMargin=e.rightMargin,r.bottomMargin=e.bottomMargin,this.owner.owner.tablePropertiesDialogModule.calculateGridValue(i)},e.prototype.applyTableOptions=function(e){e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value,this.allowSpaceCheckBox.checked&&(e.cellSpacing=this.cellSpaceTextBox.value)},e.prototype.show=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initTableOptionsDialog(e),this.loadCellMarginsDialog(),this.owner.dialog.header=e.getConstant("Table Options"),this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=void 0,this.owner.dialog.position={X:"center",Y:"center"},this.owner.dialog.height="auto",this.owner.dialog.width="auto",this.owner.dialog.open=void 0,this.owner.dialog.beforeOpen=this.owner.updateFocus,this.owner.dialog.close=this.removeEvents,this.owner.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-cancel"}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.owner=void 0,this.cellspacingTextBox=void 0,this.allowSpaceCheckBox=void 0},e}(),wt=function(){function e(e){var i=this;this.removeEvents=function(){i.owner.dialog2.element.style.pointerEvents="",i.owner.updateFocus()},this.changeSameAsTable=function(){i.sameAsTableCheckBox.checked?(i.leftMarginBox.enabled=!1,i.rightMarginBox.enabled=!1,i.bottomMarginBox.enabled=!1,i.topMarginBox.enabled=!1):(i.leftMarginBox.enabled=!0,i.rightMarginBox.enabled=!0,i.bottomMarginBox.enabled=!0,i.topMarginBox.enabled=!0)},this.applyTableCellProperties=function(){var e=i.owner.selection.cellFormat;t.isNullOrUndefined(i.bottomMarginBox.value||i.leftMarginBox.value||i.rightMarginBox.value||i.topMarginBox.value)||e.bottomMargin===i.bottomMarginBox.value&&e.leftMargin===i.leftMarginBox.value&&e.rightMargin===i.rightMarginBox.value&&e.topMargin===i.topMarginBox.value||(i.owner.owner.tablePropertiesDialogModule.isCellOptionsUpdated=!0,i.applyTableOptions(i.cellFormat),i.owner.owner.tablePropertiesDialogModule.applyTableSubProperties()),i.closeCellMarginsDialog()},this.closeCellMarginsDialog=function(){i.owner.dialog.hide(),i.owner.dialog.element.style.pointerEvents=""},this.owner=e}return Object.defineProperty(e.prototype,"cellFormat",{get:function(){return t.isNullOrUndefined(this.cellFormatIn)?this.cellFormatIn=new H:this.cellFormatIn},enumerable:!0,configurable:!0}),e.prototype.getModuleName=function(){return"CellOptionsDialog"},e.prototype.initCellMarginsDialog=function(i){this.owner;this.target=t.createElement("div",{id:this.owner.owner.containerId+"_tableCellMarginsDialog",className:"e-de-table-cell-margin-dlg"}),this.owner.owner.element.appendChild(this.target);var r=t.createElement("div",{styles:"width: 475px;position: relative;height: 165px;"}),n=t.createElement("Label",{className:"e-de-cell-dia-options-label",id:this.target.id+"_innerDivLabel"});n.innerHTML=i.getConstant("Cell margins"),r.appendChild(n);var a=t.createElement("TABLE",{styles:"height: 40px;padding-bottom: 0px;",className:"e-de-cell-margin-top"}),s=t.createElement("tr"),l=t.createElement("td",{className:"e-de-tbl-btn-seperator"}),d=t.createElement("input",{attrs:{type:"checkbox"},id:this.target.id+"_sameAsCheckBox"});l.appendChild(d),s.appendChild(l),a.appendChild(s),r.appendChild(a),e.getCellMarginDialogElements(this,r,i);var h=document.createElement("div");this.target.appendChild(h),this.sameAsTableCheckBox=new o.CheckBox({label:i.getConstant("Same as the whole table"),change:this.changeSameAsTable}),this.sameAsTableCheckBox.appendTo(d),this.sameAsTableCheckBox.addEventListener("change",this.changeSameAsTable)},e.prototype.show=function(){var e=new t.L10n("documenteditor",this.owner.owner.defaultLocale);e.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.target||this.initCellMarginsDialog(e),this.loadCellMarginsDialog(),this.owner.dialog.header=e.getConstant("Cell Options"),this.owner.dialog.position={X:"center",Y:"top"},this.owner.dialog.height="auto",this.owner.dialog.width="auto",this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=void 0,this.owner.dialog.open=void 0,this.owner.dialog.close=this.removeEvents,this.owner.dialog.buttons=[{click:this.applyTableCellProperties,buttonModel:{content:e.getConstant("Ok"),cssClass:"e-flat e-table-cell-margin-okay",isPrimary:!0}},{click:this.closeCellMarginsDialog,buttonModel:{content:e.getConstant("Cancel"),cssClass:"e-flat e-table-cell-margin-cancel"}}],this.owner.dialog.show()},e.prototype.loadCellMarginsDialog=function(){var e=this.owner.selection.cellFormat;if(this.sameAsTable=t.isNullOrUndefined(e.leftMargin||e.topMargin||e.rightMargin||e.bottomMargin),this.sameAsTable){var i=this.owner.selection.tableFormat;this.loadCellProperties(i,!1,!0)}else this.loadCellProperties(e,!0,!1)},e.prototype.loadCellProperties=function(e,t,i){this.leftMarginBox.value=e.leftMargin,this.rightMarginBox.value=e.rightMargin,this.topMarginBox.value=e.topMargin,this.bottomMarginBox.value=e.bottomMargin,this.leftMarginBox.enabled=t,this.rightMarginBox.enabled=t,this.topMarginBox.enabled=t,this.bottomMarginBox.enabled=t,this.sameAsTableCheckBox.checked=i},e.prototype.applySubCellOptions=function(e){this.owner.owner.editorHistory.initComplexHistory(this.owner.selection,"CellMarginsSelection"),this.owner.owner.editorModule.initHistory("CellOptions");var i=this.owner.selection.start.paragraph.associatedCell.ownerTable;i=i.combineWidget(this.owner),this.applyCellmarginsValue(this.owner.selection.start.paragraph.associatedCell.ownerRow.combineWidget(this.owner),this.owner.selection.start,this.owner.selection.end,e),this.owner.owner.editorModule.reLayout(this.owner.selection,!1),t.isNullOrUndefined(this.owner.owner.editorHistory.currentHistoryInfo)||this.owner.owner.editorHistory.updateComplexHistory()},e.prototype.applyCellmarginsValue=function(e,i,r,n){if(this.applyCellMarginsInternal(e,n),r.paragraph.associatedCell.ownerRow!==e){var o=e.nextWidget;t.isNullOrUndefined(o)||this.applyCellmarginsValue(o,i,r,n)}},e.prototype.applyCellMarginsInternal=function(e,i){if(!t.isNullOrUndefined(this.owner.owner.editorHistory.currentBaseHistoryInfo)){var r=e.childWidgets[0].cellFormat;i=this.owner.owner.editorHistory.currentBaseHistoryInfo.addModifiedCellOptions(r,i,e.ownerTable)}t.isNullOrUndefined(i)||this.applyCellMarginsForCells(e,i)},e.prototype.applyCellMarginsForCells=function(e,t){var i=e.childWidgets;this.iterateCells(i,t)},e.prototype.iterateCells=function(e,t){for(var i=0;i<e.length;i++)this.applySubCellMargins(e[i].cellFormat,t);this.owner.owner.tablePropertiesDialogModule.calculateGridValue(e[0].ownerTable)},e.prototype.applySubCellMargins=function(e,t){e.leftMargin=t.leftMargin,e.topMargin=t.topMargin,e.rightMargin=t.rightMargin,e.bottomMargin=t.bottomMargin},e.prototype.applyTableOptions=function(e){this.sameAsTableCheckBox.checked||(e.leftMargin=this.leftMarginBox.value,e.topMargin=this.topMarginBox.value,e.bottomMargin=this.bottomMarginBox.value,e.rightMargin=this.rightMarginBox.value)},e.prototype.destroy=function(){if(!t.isNullOrUndefined(this.target)){this.target.parentElement&&this.target.parentElement.removeChild(this.target);for(var e=0;e<this.target.childNodes.length;e++)this.target.removeChild(this.target.childNodes[e]),e--;this.target=void 0}this.dialog=void 0,this.target=void 0,this.owner=void 0,this.sameAsTableCheckBox=void 0},e.getCellMarginDialogElements=function(e,i,r){if(!t.isNullOrUndefined(e)){var n=t.createElement("TABLE",{className:"e-de-cell-margin-top"}),o=t.createElement("tr",{styles:"height: 50px;color:black;"}),a=t.createElement("td"),s=t.createElement("label",{innerHTML:r.getConstant("Top"),className:"e-de-cell-dia-label-common",id:e.target.id+"_TopLabel"}),d=t.createElement("input",{attrs:{type:"text"},styles:"width:100%",id:e.target.id+"_Top"});a.appendChild(s),a.appendChild(d);var h=t.createElement("td",{className:"e-de-tbl-btn-seperator"}),c=t.createElement("label",{innerHTML:r.getConstant("Left"),className:"e-de-cell-dia-label-common",id:e.target.id+"_leftLabel"}),p=t.createElement("input",{attrs:{type:"text"},styles:"width:100%",id:e.target.id+"_left"});h.appendChild(c),h.appendChild(p),o.appendChild(a),o.appendChild(h);var g=t.createElement("tr",{styles:"height: 50px;color:black;"}),u=t.createElement("td",{styles:"width:40%;"}),f=t.createElement("label",{innerHTML:r.getConstant("Bottom"),className:"e-de-cell-dia-label-common",id:e.target.id+"_bottomLabel"}),m=t.createElement("input",{attrs:{type:"text"},styles:"width:100%",id:e.target.id+"_bottom"});u.appendChild(f),u.appendChild(m);var v=t.createElement("td",{styles:"width:40%;"}),y=t.createElement("label",{innerHTML:r.getConstant("Right"),id:e.target.id+"_rightLabel",className:"e-de-cell-dia-label-common"}),w=t.createElement("input",{attrs:{type:"text"},styles:"width:100%",id:e.target.id+"_right"});v.appendChild(y),v.appendChild(w),g.appendChild(u),g.appendChild(v),n.appendChild(o),n.appendChild(g),i.appendChild(n),e.target.appendChild(i),e.topMarginBox=new l.NumericTextBox({value:0,min:0,max:1584,width:150,decimals:2,enablePersistence:!1}),e.topMarginBox.appendTo(d),e.leftMarginBox=new l.NumericTextBox({value:0,min:0,max:1584,width:150,decimals:2,enablePersistence:!1}),e.leftMarginBox.appendTo(p),e.bottomMarginBox=new l.NumericTextBox({value:0,min:0,max:1584,width:150,decimals:2,enablePersistence:!1}),e.bottomMarginBox.appendTo(m),e.rightMarginBox=new l.NumericTextBox({value:0,min:0,max:1584,width:150,decimals:2,enablePersistence:!1}),e.rightMarginBox.appendTo(w)}},e}(),bt=function(){function e(e){var t=this;this.updateStyleNames=function(){var e=["Normal","Heading 1","Heading 2","Heading 3","Heading 4","Heading 5","Heading 6"];return t.owner.owner.viewer.styles.getStyleNames("Paragraph").concat(e).filter(function(e,t,i){return i.indexOf(e)===t})},this.modifyStyles=function(){t.owner.dialog.hide(),t.owner.owner.styleDialogModule.show(t.styleName,t.localValue.getConstant("Modify Style"))},this.selectHandler=function(e){t.styleName=e.text},this.addNewStyles=function(){t.owner.dialog.hide(),t.owner.owner.styleDialogModule.show()},this.owner=e}return e.prototype.getModuleName=function(){return"StylesDialog"},e.prototype.initStylesDialog=function(e,i){var r=this.owner.owner.containerId+"_insert_styles";this.target=t.createElement("div",{id:r,className:"e-de-styles"});var n=e.getConstant("Styles"),a=t.createElement("div",{innerHTML:n,className:"e-styles-dlgfields"});this.target.appendChild(a);var s=t.createElement("div",{className:"e-styles-common"});this.target.appendChild(s);var l=t.createElement("div",{className:"e-styles-list"});s.appendChild(l);var h=t.createElement("div",{className:"e-styles-listViewDiv",id:"styles_listview"});l.appendChild(h),this.listviewInstance=new d.ListView({dataSource:i,cssClass:"e-styles-listview"}),this.listviewInstance.appendTo(h),this.listviewInstance.addEventListener("select",this.selectHandler);var c=t.createElement("div",{className:"e-styles-button"});s.appendChild(c);var p=t.createElement("div",{className:"e-styles-addbutton"});c.appendChild(p);var g=t.createElement("button",{innerHTML:e.getConstant("New"),id:"new"});p.appendChild(g),new o.Button({cssClass:"e-button-custom"}).appendTo(g),g.addEventListener("click",this.addNewStyles);var u=t.createElement("div",{className:"e-styles-addbutton"});c.appendChild(u);var f=t.createElement("button",{innerHTML:e.getConstant("Modify"),id:"modify"});u.appendChild(f),new o.Button({cssClass:"e-button-custom"}).appendTo(f),f.addEventListener("click",this.modifyStyles)},e.prototype.show=function(){var e=this.updateStyleNames(),i=new t.L10n("documenteditor",this.owner.owner.defaultLocale);i.setLocale(this.owner.owner.locale),t.setCulture(this.owner.owner.locale),this.localValue=i,this.initStylesDialog(i,e),this.owner.dialog.content=this.target,this.owner.dialog.beforeOpen=this.owner.updateFocus,this.owner.dialog.close=this.owner.updateFocus,this.owner.dialog.header="Styles",this.owner.dialog.height="auto",this.owner.dialog.width="auto",this.owner.dialog.buttons=[{click:this.hideObjects.bind(this),buttonModel:{content:i.getConstant("Cancel"),cssClass:"e-flat e-hyper-insert",isPrimary:!0}}],this.owner.dialog.dataBind(),this.owner.dialog.show()},e.prototype.hideObjects=function(){this.owner.dialog.hide()},e.prototype.destroy=function(){this.listviewInstance&&(this.listviewInstance.destroy(),this.listviewInstance=void 0)},e}();return e.Dictionary=c,e.WUniqueFormat=p,e.WUniqueFormats=g,e.DocumentEditor=m,e.Print=v,e.ContextMenu=le,e.WSectionFormat=y,e.WStyle=S,e.WParagraphStyle=N,e.WCharacterStyle=O,e.WStyles=L,e.WCharacterFormat=P,e.WListFormat=x,e.WTabStop=C,e.WParagraphFormat=F,e.WTableFormat=R,e.WRowFormat=M,e.WCellFormat=H,e.WBorder=k,e.WBorders=B,e.WShading=E,e.WList=b,e.WAbstractList=de,e.WListLevel=he,e.WLevelOverride=w,e.LayoutViewer=me,e.PageLayoutViewer=ve,e.Layout=ce,e.Rect=D,e.Margin=A,e.Widget=z,e.BlockContainer=_,e.BodyWidget=V,e.HeaderFooterWidget=q,e.BlockWidget=j,e.ParagraphWidget=G,e.TableWidget=K,e.TableRowWidget=X,e.TableCellWidget=Y,e.LineWidget=J,e.ElementBox=Z,e.FieldElementBox=$,e.TextElementBox=Q,e.FieldTextElementBox=ee,e.TabElementBox=te,e.BookmarkElementBox=ie,e.ImageElementBox=re,e.ListTextElementBox=ne,e.Page=oe,e.WTableHolder=ae,e.WColumn=se,e.Renderer=pe,e.SfdtReader=ye,e.TextHelper=ge,e.Zoom=ue,e.Selection=Le,e.SelectionCharacterFormat=we,e.SelectionParagraphFormat=be,e.SelectionSectionFormat=xe,e.SelectionTableFormat=Ce,e.SelectionCellFormat=Fe,e.SelectionRowFormat=Pe,e.SelectionImageFormat=We,e.TextPosition=Ie,e.SelectionWidgetInfo=Se,e.Hyperlink=Ne,e.ImageFormat=Oe,e.Search=He,e.OptionsPane=Ue,e.TextSearch=ke,e.SearchWidgetInfo=Be,e.TextSearchResult=Ee,e.TextSearchResults=Re,e.Editor=Ae,e.ImageResizer=Je,e.ImageResizingPoints=Ze,e.SelectedImageInfo=$e,e.TableResizer=De,e.HelperMethods=W,e.Point=T,e.EditorHistory=tt,e.BaseHistoryInfo=Ye,e.HistoryInfo=et,e.ModifiedLevel=ze,e.ModifiedParagraphFormat=_e,e.RowHistoryFormat=Ve,e.TableHistoryInfo=qe,e.TableFormatHistoryInfo=je,e.RowFormatHistoryInfo=Ge,e.CellFormatHistoryInfo=Ke,e.CellHistoryFormat=Xe,e.WordExport=it,e.TextExport=rt,e.SfdtExport=nt,e.HtmlExport=Te,e.HyperlinkDialog=ot,e.TableDialog=at,e.BookmarkDialog=st,e.TableOfContentsDialog=lt,e.PageSetupDialog=dt,e.ParagraphDialog=ht,e.ListDialog=pt,e.StyleDialog=gt,e.BulletsAndNumberingDialog=ut,e.FontDialog=ft,e.TablePropertiesDialog=mt,e.BordersAndShadingDialog=vt,e.TableOptionsDialog=yt,e.CellOptionsDialog=wt,e.StylesDialog=bt,e}({},ej.base,ej.fileutils,ej.navigations,ej.popups,ej.buttons,ej.compression,ej.dropdowns,ej.inputs,ej.lists,ej.splitbuttons),this.ejs=ej;
//# sourceMappingURL=ej2-documenteditor.min.js.map
