!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-data"),require("@syncfusion/ej2-popups"),require("@syncfusion/ej2-grids"),require("@syncfusion/ej2-navigations"),require("@syncfusion/ej2-inputs"),require("@syncfusion/ej2-dropdowns"),require("@syncfusion/ej2-excel-export"),require("@syncfusion/ej2-pdf-export"),require("@syncfusion/ej2-charts"),require("@syncfusion/ej2-calendars"),require("@syncfusion/ej2-splitbuttons"),require("@syncfusion/ej2-buttons")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-data","@syncfusion/ej2-popups","@syncfusion/ej2-grids","@syncfusion/ej2-navigations","@syncfusion/ej2-inputs","@syncfusion/ej2-dropdowns","@syncfusion/ej2-excel-export","@syncfusion/ej2-pdf-export","@syncfusion/ej2-charts","@syncfusion/ej2-calendars","@syncfusion/ej2-splitbuttons","@syncfusion/ej2-buttons"],t):t(e.ej={},e.ej2Base,e.ej2Data,e.ej2Popups,e.ej2Grids,e.ej2Navigations,e.ej2Inputs,e.ej2Dropdowns,e.ej2ExcelExport,e.ej2PdfExport,e.ej2Charts,e.ej2Calendars,e.ej2Splitbuttons,e.ej2Buttons)}(this,function(e,t,i,r,a,n,o,l,s,d,p,h,u,c){"use strict";var g=function(){function e(){}return e.getType=function(e){return e&&e.getDay?e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0?"datetime":"date":typeof e},e.resetTime=function(e){return e.setHours(0,0,0,0),e},e.getClonedData=function(e){var t=[];if(e)for(var i=0,r=e;i<r.length;i++){for(var a=r[i],n=Object.keys(a),o=0,l={};o<n.length;)l[n[o]]=a[n[o]],o++;t.push(l)}return t},e.inArray=function(e,t){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return i;return-1},e}(),m=function(){function e(){this.valueContent=[],this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.rMembers=[],this.cMembers=[],this.valueMatrix=[],this.indexMatrix=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rawIndexObject={},this.isEditing=!1,this.data=[],this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.groupingFields={},this.columnKeys={},this.fieldDrillCollection={}}return e.prototype.renderEngine=function(e,r,a){this.getValueCellInfo=a,this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.excludeFields=t.isNullOrUndefined(e.excludeFields)?[]:e.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rawIndexObject={},this.isEditing=!1;var n;if(this.globalize=new t.Internationalization,this.localeObj=r?r.localeObj:void 0,this.fieldsType=r?r.fieldsType:{},this.enableSort=e.enableSorting,this.alwaysShowValueHeader=e.alwaysShowValueHeader,this.showHeaderWhenEmpty=!!t.isNullOrUndefined(e.showHeaderWhenEmpty)||e.showHeaderWhenEmpty,this.showSubTotals=!!t.isNullOrUndefined(e.showSubTotals)||e.showSubTotals,this.showRowSubTotals=!!t.isNullOrUndefined(e.showRowSubTotals)||e.showRowSubTotals,this.showColumnSubTotals=!!t.isNullOrUndefined(e.showColumnSubTotals)||e.showColumnSubTotals,this.showGrandTotals=!!t.isNullOrUndefined(e.showGrandTotals)||e.showGrandTotals,this.showRowGrandTotals=!!t.isNullOrUndefined(e.showRowGrandTotals)||e.showRowGrandTotals,this.showColumnGrandTotals=!!t.isNullOrUndefined(e.showColumnGrandTotals)||e.showColumnGrandTotals,this.allowValueFilter=e.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!r&&r.enableValueSorting,this.valueContent=[],e.dataSource instanceof i.DataManager||(this.data=e.dataSource),this.data&&this.data[0]){this.fields=Object.keys(this.data[0]);this.fields;var o={};o[0]=e.rows,o[1]=e.columns,o[2]=e.values,o[3]=e.filters;for(var l=0;l<4;){if(o[l])for(var s=0;s<o[l].length;s++)this.excludeFields.indexOf(o[l][s].name)>-1&&(o[l].splice(s,1),s--);l++}this.rows=e.rows?e.rows:[],this.columns=e.columns?e.columns:[],this.filters=e.filters?e.filters:[],this.formats=e.formatSettings?e.formatSettings:[],this.values=e.values?e.values:[],this.groups=e.groupSettings?e.groupSettings:[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.enableSort=void 0===e.enableSorting||e.enableSorting,n=this.getGroupData(this.data),this.validateFilters(e),this.isExpandAll=!(!this.isValueFiltersAvail||!e.allowValueFilter)||e.expandAll,this.drilledMembers=e.drilledMembers?this.isValueFiltersAvail&&e.allowValueFilter?[]:e.drilledMembers:[],this.isMutiMeasures=this.values.length>1,this.valueAxis="row"===e.valueAxis?1:0,this.emptyCellTextContent=e.emptyCellsTextContent?e.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.values.length:1,this.colValuesLength=0===this.valueAxis?this.values.length:1,this.valueSortSettings=e.valueSortSettings||{sortOrder:"None",headerDelimiter:".",headerText:"",columnIndex:void 0},this.valueSortData=[],this.pageSettings=r?r.pageSettings?r.pageSettings:this.pageSettings:void 0,this.savedFieldList=r?r.savedFieldList:void 0,this.isDrillThrough=!!r&&(!!r.isDrillThrough&&r.isDrillThrough),this.getFieldList(n,this.enableSort,e.allowValueFilter),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[];var d=this.columns.length-1;for(this.columnKeys={};d>-1;)this.columnKeys[this.columns[d].name]=this.columns[d],d--;this.updateFilterMembers(e),this.generateGridData(e)}},e.prototype.getGroupData=function(e){for(var r=e[0],a=function(a){var o=a.name;if(!(n.fields.indexOf(o)>-1))return{value:r};var l={};if("Number"===a.type){if("number"!==g.getType(r[o]))return{value:r};a.rangeInterval&&e.sort(function(e,t){return e[o]>t[o]?1:t[o]>e[o]?-1:0})}for(var s=e.length;s--;){var d=e[s];if(d[o]&&"Date"===a.type){var p=new Date(d[o].toString());if(!t.isNullOrUndefined(p)&&a.groupInterval.length>0){for(var h=!1,u=0,c=a.groupInterval;u<c.length;u++){var m=c[u];h=!0;var f=n.getRange(a,p.getTime()),v=g.resetTime(new Date);switch(m){case"Years":l[S=o+"_years"]=m,d[S]=f?void 0:new Date(v.setFullYear(p.getFullYear())).toString();break;case"Quarters":l[S=o+"_quarters"]=m;var y=Math.ceil((p.getMonth()+1)/3);d[S]=f?void 0:(n.localeObj?n.localeObj.getConstant("qtr"):"Qtr")+y.toString();break;case"QuarterYear":l[S=o+"_quarterYear"]=m;y=Math.ceil((p.getMonth()+1)/3);d[S]=f?void 0:(n.localeObj?n.localeObj.getConstant("qtr"):"Qtr")+y.toString()+" "+(n.localeObj?n.localeObj.getConstant("of"):"of")+" "+p.getFullYear().toString();break;case"Months":l[S=o+"_months"]=m,d[S]=f?void 0:new Date(v.setMonth(p.getMonth(),v.getDate())).toString();break;case"Days":l[S=o+"_days"]=m,d[S]=f?void 0:new Date(v.setMonth(p.getMonth(),p.getDate())).toString();break;case"Hours":l[S=o+"_hours"]=m,d[S]=f?void 0:new Date(v.setHours(p.getHours())).toString();break;case"Minutes":l[S=o+"_minutes"]=m,d[S]=f?void 0:new Date(v.setMinutes(p.getMinutes())).toString();break;case"Seconds":var S;l[S=o+"_seconds"]=m,d[S]=f?void 0:new Date(v.setSeconds(p.getSeconds())).toString()}}h&&delete d[o]}}else{f=n.getRange(a,d[o]);d[o]=f?void 0:d[o]}for(var b=[],C=0,x=X=Object.keys(d);C<x.length;C++){var w=x[C];b.push(!!d[w])}r=-1===b.indexOf(!1)&&X.length===Object.keys(e[0]).length?d:r}if("Date"===a.type){for(var T=!1,M=[n.rows,n.columns,n.values,n.filters],D=Object.keys(l),E=Object.keys(D).length,L=void 0,O=0,P=M;O<P.length;O++){var N=P[O];if(!T&&N){for(var I=N.length,A=0;A<I;){if(N[A].name===o){T=!0;var F=N[A];for(N.splice(A,1);E--;){L=l[D[E]];var q={name:D[E],caption:(n.localeObj?n.localeObj.getConstant(L):L)+" ("+o+")",type:"Count",showNoDataItems:F.showNoDataItems,baseField:F.baseField,baseItem:F.baseItem};N.splice(A,0,q)}break}A++}if(T)break}}for(E=Object.keys(D).length;E--;){L=l[D[E]];var R=new i.DataManager({json:n.formats}).executeLocal((new i.Query).where("name","equal",D[E]))[0];if("Quarters"!==L&&"QuarterYear"!==L&&!R){var j={name:D[E],type:["Years","Months","Days"].indexOf(L)>-1?"date":"time",format:"Years"===L?"yyyy":"Months"===L?"MMM":"Days"===L?"d-MMM":"Hours"===L?"hh a":"Minutes"===L?":mm":"Seconds"===L?":ss":void 0};n.formats.push(j)}}}else if("Number"===a.type&&a.rangeInterval){var k=void 0,H=void 0,V=void 0,_=void 0,B=[],U=[],G=e.length;I=0;for(n.groupingFields[o]=o;I<G;)U.push(e[I][o]),e[I][o]&&-1===B.indexOf(e[I][o])&&B.push(e[I][o]),I++;for(var z=Math.max.apply(Math,B),W=(A=B[0],z);A<W;A++)if(U.indexOf(A)<0){var Q=n.frameData(e[0]);Q[o]=A;var Y=U.lastIndexOf(A-1);U.splice(Y+1,0,A),e.splice(Y+1,0,Q)}for(G=e.length,I=0;I<G;){if(e[I]&&e[I][o]){_=(V=e[I][o])+(a.rangeInterval-1),k=k||V,H=H?H>z?z:H:_>z?z:_,V>=k&&V<=H?e[I][o]=k===H?k.toString():k.toString()+"-"+H.toString():V>H&&V===H+1&&(H=(k=H+1)+(a.rangeInterval-1)>z?z:k+(a.rangeInterval-1),e[I][o]=k===H?k.toString():k.toString()+"-"+H.toString());b=[];for(var X,K=0,Z=X=Object.keys(e[I]);K<Z.length;K++){w=Z[K];b.push(!!e[I][w])}r=-1===b.indexOf(!1)&&X.length===Object.keys(e[0]).length?e[I]:r}I++}for(var J=0,$=M=[n.rows,n.columns,n.values,n.filters];J<$.length;J++){var ee=$[J],te=new i.DataManager({json:ee}).executeLocal((new i.Query).where("name","equal",o))[0];te&&((te=te.properties?te.properties:te).type="Count")}A=0;for(var ie=n.formats.length;A<ie;A++)if(n.formats[A].name===o){n.formats.splice(A,1);break}}n.groupingFields=t.extend(n.groupingFields,l)},n=this,o=0,l=this.groups;o<l.length;o++){var s=a(l[o]);if("object"==typeof s)return s.value}return this.fields=Object.keys(r),r},e.prototype.frameData=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=void 0,i++;return r},e.prototype.getRange=function(e,t){var i;if("Date"===e.type){var r=new Date(t),a="string"==typeof e.startingAt?new Date(e.startingAt):e.startingAt,n="string"==typeof e.endingAt?new Date(e.endingAt):e.endingAt;i=!!(a&&r.getTime()<a.getTime()||n&&r.getTime()>n.getTime())}else{var o="string"==typeof e.startingAt?parseInt(e.startingAt,10):e.startingAt,l="string"==typeof e.endingAt?parseInt(e.endingAt,10):e.endingAt;i=!!(o&&t<o||l&&t>l)}return i},e.prototype.getFormattedFields=function(e){for(var t=this.formats.length;t--;)this.formatFields[this.formats[t].name]=this.formats[t],this.formats[t].type&&(this.dateFormatFunction[this.formats[t].name]={exactFormat:this.globalize.getDateFormat(this.formats[t]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:this.formats[t].type})})},e.prototype.getFieldList=function(e,i,r){var a,n=this.fields,o=t.extend([],this.rows,null,!0);o=o.concat(this.columns,this.values,this.filters),this.getFormattedFields(o),this.getCalculatedField(n),n=this.fields;var l=this.excludeFields.length;for(l-=1;l>-1;){var s=this.fields.indexOf(this.excludeFields[l]);this.fields.splice(s,1),this.fieldList&&delete this.fieldList[this.excludeFields[l]],l--}var d=n.length;if(this.savedFieldList)for(this.fieldList=this.savedFieldList;d--;){var p=n[d];this.fieldList[p]?(this.fieldList[p].isSelected=!1,this.fieldList[p].index=d,this.fieldList[p].filter=[],this.fieldList[p].isExcelFilter=!1,this.fieldList[p].filterType="",this.isValueFiltersAvail&&r&&(this.fieldList[p].dateMember=[],this.fieldList[p].formattedMembers={},this.fieldList[p].members={})):this.fieldList[p]={id:p,caption:p,type:void 0===a||"undefined"===a?"number":a,filterType:"",index:d,filter:[],sort:i?"Ascending":"None",isSelected:!1}}else for(;d--;){p=n[d];a=this.fieldsType&&this.fieldsType[p]?this.fieldsType[p]:g.getType(e[p]),this.fieldList||(this.fieldList={}),this.fieldList[p]={id:p,caption:p,type:void 0===a||"undefined"===a?"number":a,filterType:"",index:d,filter:[],sort:i?"Ascending":"None",isSelected:!1}}this.updateTreeViewData(o)},e.prototype.updateFieldList=function(e){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=e[t[i]].isExcelFilter},e.prototype.updateTreeViewData=function(e){for(var t=e.length,i=this.calculatedFieldSettings.length;t--;)if(this.fieldList[e[t].name]){var r=this.fieldList[e[t].name];r.caption=e[t].caption?e[t].caption:e[t].name,r.isSelected=!0,r.showNoDataItems=e[t].showNoDataItems,r.aggregateType=e[t].type,r.baseField=e[t].baseField,r.baseItem=e[t].baseItem}for(;i--;)this.fieldList[this.calculatedFieldSettings[i].name].aggregateType="CalculatedField",this.fieldList[this.calculatedFieldSettings[i].name].formula=this.calculatedFieldSettings[i].formula},e.prototype.getCalculatedField=function(e){for(var i=0,r=this.calculatedFieldSettings;i<r.length;i++){var a=r[i];this.calculatedFields[a.name]=t.extend({},a,null,!0),this.calculatedFields[a.name].actualFormula=a.formula}for(var n=Object.keys(this.calculatedFields),o=function(t,i){var r=l.calculatedFields[n[t]],a=r.properties,o=(a?a.formula:r.formula).replace(/ +/g,""),s=o.replace(/"/g,"");r.formula=s.indexOf("^")>-1?l.powerFunction(s):s,r.name=a?a.name:r.name,(e=e.filter(function(e){return e!==r.name})).push(r.name);for(var d=o.split('"'),p=0,h=d.length;p<h;p++){var u=d[p],c=u.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n/\\]+/),g="DistinctCount"===c[0]?"DistinctCount":"PopulationStDev"===c[0]?"PopulationStDev":"SampleStDev"===c[0]?"SampleStDev":"PopulationVar"===c[0]?"PopulationVar":"SampleVar"===c[0]?"SampleVar":c[0];if(-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(g)){var m=e.indexOf(c[1]);l.calculatedFormulas[r.name]?l.calculatedFormulas[r.name].push({index:m,type:g,formula:u}):l.calculatedFormulas[r.name]=[{index:m,type:g,formula:u}]}}},l=this,s=0,d=n.length;s<d;s++)o(s);this.fields=e},e.prototype.validateFilters=function(e){this.isValueFiltersAvail=!1;var i=e.filterSettings?e.filterSettings:[],r=t.extend([],this.rows,null,!0);r=r.concat(this.columns);for(var a=0,n=i;a<n.length;a++){for(var o=n[a],l=0,s=r;l<s.length;l++){var d=s[l];if(o.name===d.name&&"Value"===o.type){this.isValueFiltersAvail=!0;break}}if(this.isValueFiltersAvail)break}},e.prototype.fillFieldMembers=function(e,t){for(var i=this.fields,r=e.length,a=this.fieldList,n=i.length,o=0;o<n;o++){var l=i[o];a[l].members||(a[l].members={}),a[l].formattedMembers||(a[l].formattedMembers={}),a[l].dateMember||(a[l].dateMember=[]);for(var s=a[l].members,d=Object.keys(s).length>0,p=a[l].formattedMembers,h=a[l].dateMember,u=0,c=0,g=0;g<r;g++){var m=e[g][l];if(!d){var f=m,v=!this.pageSettings||this.formatFields[l]&&["date","dateTime","time"].indexOf(this.formatFields[l].type)>-1?this.getFormattedValue(m,l):{formattedText:null===m?this.localeObj?this.localeObj.getConstant("null"):String(m):void 0===m?this.localeObj?l in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(m):m.toString(),actualText:null===m?this.localeObj?this.localeObj.getConstant("null"):String(m):void 0===m?this.localeObj?l in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(m):m};v.formattedText&&(f=v.formattedText),s.hasOwnProperty(m)?s[m].index.push(g):(u++,s[m]={index:[g],ordinal:u,isDrilled:!!this.isExpandAll},h.push({formattedText:v.formattedText,actualText:v.dateText?v.dateText:v.actualText})),p.hasOwnProperty(f)?p[f].index.push(g):(c++,p[f]={index:[g],ordinal:c,isDrilled:!!this.isExpandAll})}t[g]?t[g][o]=s[m].ordinal:(t[g]=[],t[g][o]=s[m].ordinal)}}},e.prototype.generateValueMatrix=function(e){for(var t=this.fields,i=e.length,r=[],a=t.length,n=this.fieldList;i--;){e[i];var o=a;for(r[i]=[];o--;){var l=t[o];r[i][o]="number"===n[l].type?e[i][l]:1}}return r},e.prototype.updateSortSettings=function(e,t){for(var i=0,r=e?e.length:0;i<r&&t;i++)this.fieldList[e[i].name]&&(this.fieldList[e[i].name].sort=e[i].order)},e.prototype.updateFilterMembers=function(e){var t=this.filterMembers,i={},r=this.getFilters(e,i),a=this.indexMatrix.length;if(r)for(var n=i.include.index,o=0;o<n.length;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[n[o]]||t.push(n[o]);else for(o=0;o<a;o++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[o]||t.push(o)},e.prototype.getFilters=function(e,t){for(var i=e.filterSettings?e.filterSettings:[],r=(this.filters,!1),a=[],n=0,o=i.length;n<o;n++){var l=i[n].properties?i[n].properties:i[n];this.fieldList[l.name]&&this.fieldList[l.name].isSelected&&this.isValidFilterField(l,e.allowLabelFilter)&&(this.applyLabelFilter(l),l&&(a=l.items),l.type&&"Include"===l.type?(this.frameFilterList(a,l.name,t,"include",l.showLabelFilter,r),r=!0):this.frameFilterList(a,l.name,t,"exclude",l.showLabelFilter),l.showLabelFilter&&(l.items=[],l.type=l.showDateFilter?"Date":l.showNumberFilter?"Number":"Label"))}return r},e.prototype.isValidFilterField=function(e,i){var r=!1,a=t.extend([],this.rows,null,!0);if(a=a.concat(this.columns),this.fieldList[e.name].isSelected&&["Include","Exclude"].indexOf(e.type)>=0){for(var n=!1,o=0,l=this.values;o<l.length;o++){var s=l[o];if(e.name===s.name){n=!0;break}}n||(r=!0)}else for(var d=0,p=a;d<p.length;d++){s=p[d];if(e.name===s.name&&i&&["Label","Date","Number"].indexOf(e.type)>=0){r=!0;break}}return r},e.prototype.applyLabelFilter=function(e){if(["Label","Date","Number"].indexOf(e.type)>=0){var t=Object.keys(this.fieldList[e.name].members);if(e.showLabelFilter=!0,"Label"===e.type)e.items=this.getLabelFilterMembers(t,e.condition,e.value1,e.value2);else if("Date"===e.type){e.showDateFilter=!0;var i="string"==typeof e.value1?new Date(e.value1):e.value1,r="string"==typeof e.value2?new Date(e.value2):e.value2;e.items=this.getDateFilterMembers(t,e.name,e.condition,i,r)}else{e.showNumberFilter=!0,e.items=[];for(var a=0,n=t;a<n.length;a++){var o=n[a],l=this.getParsedValue(e.name,e.value1),s=this.getParsedValue(e.name,e.value2),d=this.getParsedValue(e.name,o);this.validateFilterValue(d,e.condition,l,s)&&e.items.push(o)}}e.type=e.condition?["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"].indexOf(e.condition)>-1&&!e.showNumberFilter?"Exclude":"Include":"Exclude"}else e.showLabelFilter=!1},e.prototype.getLabelFilterMembers=function(e,t,i,r){for(var a=[],n=0,o=e;n<o.length;n++){var l=o[n],s=l.toLowerCase();if(i.toString())switch(t){case"Equals":case"DoesNotEquals":s===i.toLowerCase()&&a.push(l);break;case"BeginWith":case"DoesNotBeginWith":0===s.indexOf(i.toLowerCase())&&a.push(l);break;case"EndsWith":case"DoesNotEndsWith":null!==s.match(i.toLowerCase()+"$")&&a.push(l);break;case"Contains":case"DoesNotContains":s.indexOf(i.toLowerCase())>-1&&a.push(l);break;case"GreaterThan":s>i.toLowerCase()&&a.push(l);break;case"GreaterThanOrEqualTo":s>=i.toLowerCase()&&a.push(l);break;case"LessThan":s<i.toLowerCase()&&a.push(l);break;case"LessThanOrEqualTo":s<=i.toLowerCase()&&a.push(l);break;case"Between":case"NotBetween":s>=i.toLowerCase()&&s<=r.toLowerCase()&&a.push(l);break;default:s===i.toLowerCase()&&a.push(l)}}return a},e.prototype.getDateFilterMembers=function(e,t,i,r,a){for(var n=[],o=0,l=e;o<l.length;o++){var s=l[o],d=new Date(s);if(r)switch(i){case"Equals":case"DoesNotEquals":this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(r.toString(),t).formattedText&&n.push(this.getFormattedValue(s,t).formattedText);break;case"After":d.getTime()>r.getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"AfterOrEqualTo":d.getTime()>=r.getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"Before":d.getTime()<r.getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"BeforeOrEqualTo":d.getTime()<=r.getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;case"Between":case"NotBetween":d.getTime()>=r.getTime()&&d.getTime()<=a.getTime()&&n.push(this.getFormattedValue(s,t).formattedText);break;default:this.getFormattedValue(d.toString(),t).formattedText===this.getFormattedValue(r.toString(),t).formattedText&&n.push(this.getFormattedValue(s,t).formattedText)}}return n},e.prototype.validateFilterValue=function(e,t,i,r){var a=!1;if("number"==typeof i)switch(t){case"Equals":e===i&&(a=!0);break;case"DoesNotEquals":e!==i&&(a=!0);break;case"GreaterThan":e>i&&(a=!0);break;case"GreaterThanOrEqualTo":e>=i&&(a=!0);break;case"LessThan":e<i&&(a=!0);break;case"LessThanOrEqualTo":e<=i&&(a=!0);break;case"Between":e>=i&&e<=r&&(a=!0);break;case"NotBetween":e>=i&&e<=r||(a=!0);break;default:e!==i&&(a=!0)}return a},e.prototype.frameFilterList=function(e,t,i,r,a,n){i[r]?this.updateFilter(e,t,i,r,a,n):(i[r]={indexObject:{},index:[]},this.updateFilter(e,t,i,r,a,n))},e.prototype.updateFilter=function(e,t,i,r,a,n){var o=0,l=this.fieldList[t];l.filter=e,l.filterType=r,l.isExcelFilter=a;var s=this.formatFields[t]&&["date","dateTime","time"].indexOf(this.formatFields[t].type)>-1?l.formattedMembers:l.members,d=n,p={},h={};for(p[r]={indexObject:{},index:[]},this.fieldFilterMem[t]={memberObj:{}};e[o];){var u=s[e[o]].index;if("include"===r)for(var c=0,g=u.length;c<g;c++)d&&void 0===i[r].indexObject[u[c]]||(p[r].indexObject[u[c]]=u[c],p[r].index.push(u[c]));else{for(c=0,g=u.length;c<g;c++)void 0===i[r].indexObject[u[c]]&&(i[r].indexObject[u[c]]=u[c],i[r].index.push(u[c]));this.fieldFilterMem[t].memberObj[e[o]]=e[o]}o++}if("include"===r){i[r]=p[r];for(c=0;c<e.length;c++)h[e[c]]=e[c];var m=Object.keys(s);for(c=0,g=m.length;c<g;c++)void 0===h[m[c]]&&(this.fieldFilterMem[t].memberObj[m[c]]=m[c])}},e.prototype.applyValueFiltering=function(e,i,r,a,n,o,l){this.isValueFiltered=!1;var s=t.extend({},r[r.length-1],null,!0);return this.getFilteredData(r,a,n,o,i,e.name,s,l),this.isValueFiltered&&(o.push(s),r=o),r},e.prototype.getFilteredData=function(e,i,r,a,n,o,l,s){for(var d=e.length,p=0;p<d;p++)if(r[o])if(e[p].level===n){this.isValueFiltered=!0,this.fieldList[o].isExcelFilter=!0;var h=0,u=r[o].measure,c=this.fieldList[u].index,g=this.fieldList[u].aggregateType;this.rawIndexObject={},h="row"===s?this.getAggregateValue(e[p].index,i.indexObject,c,g):this.getAggregateValue(i.index,e[p].indexObject,c,g);var m={fieldName:u,row:e[p],column:i,value:h,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[p].hasChild&&e[p].isDrilled?"subTotal":"grand sum"===e[p].type?"grandTotal":"value",columnCellType:i.hasChild&&i.isDrilled?"subTotal":"grand sum"===i.type?"grandTotal":"value",aggregateType:g,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(m),h=m.value,this.rawIndexObject={};var f=this.getParsedValue(u,r[o].value1),v=this.getParsedValue(u,r[o].value2);if(this.validateFilterValue(h,r[o].condition,f,v)||"grand sum"===e[p].type)"grand sum"!==e[p].type&&(a.push(t.extend({},e[p],null,!0)),a[a.length-1].isLevelFiltered=!0);else{var y=this.removefilteredData(e[p],this.valueFilteredData),S=y||e[p];this.validateFilteredParentData(S,this.valueFilteredData,l,0,n,s)}}else e[p].hasChild&&e[p].members.length>0&&"grand sum"!==e[p].type&&(a.push(t.extend({},e[p],null,!0)),a[a.length-1].members=[],a[a.length-1].isLevelFiltered=!0,this.getFilteredData(e[p].members,i,r,a[a.length-1].members,n,o,l,s))},e.prototype.getParsedValue=function(e,i){var r=i?i.toString():"";if(this.formatFields[e]&&i){var a=t.extend({},this.formatFields[e],null,!0);return delete a.name,this.globalize.parseNumber(r,a)}return this.globalize.parseNumber(r,{format:"N"})},e.prototype.removefilteredData=function(e,i){for(var r,a=t.extend([],i,null,!0),n=0;n<a.length;n++){if(e.isLevelFiltered&&e.axis===a[n].axis&&e.valueSort.levelName===a[n].valueSort.levelName&&e.actualText===a[n].actualText&&e.axis===a[n].axis&&e.level===a[n].level&&e.ordinal===a[n].ordinal){r=a[n],i.splice(n,1);break}i[n].hasChild&&i[n].members.length>0&&this.removefilteredData(e,i[n].members)}return r},e.prototype.validateFilteredParentData=function(e,t,i,r,a,n){if(t.length>0)for(var o=0,l=t;o<l.length;o++){var s=l[o];if(s.level===r){if("row"===n)for(var d=0,p=u=e.index;d<p.length;d++){var h=p[d];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1),e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==a&&s.index.indexOf(h)>=0&&s.index.splice(s.index.indexOf(h),1)}else for(var u=e.indexObject,c=0,g=Object.keys(u);c<g.length;c++){h=g[c];u.hasOwnProperty(h)&&(delete i.indexObject[h],e.valueSort.levelName.toString().indexOf(s.valueSort.levelName.toString())>=0&&s.level!==a&&delete s.indexObject[h])}s&&s.members.length>0&&s.members[0].level===r+1&&s.members[0].level!==a&&this.validateFilteredParentData(e,s.members,i,r+1,a,n)}}else if("row"===n)for(var m=0,f=u=e.index;m<f.length;m++){h=f[m];i.index.indexOf(h)>=0&&i.index.splice(i.index.indexOf(h),1)}else{u=e.indexObject;for(var v=0,y=Object.keys(u);v<y.length;v++){h=y[v];u.hasOwnProperty(h)&&delete i.indexObject[h]}}},e.prototype.updateFramedHeaders=function(e,i,r,a,n){for(var o=0,l=e;o<l.length;o++){var s=l[o];this.isHeaderAvail=!1,(this.validateFilteredHeaders(s,r,n)||"grand sum"===s.type)&&("row"===n?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,a.push(t.extend({},s,null,!0)),a[a.length-1].members=[],s.hasChild&&s.isDrilled&&s.members.length>0&&this.updateFramedHeaders(s.members,i,r,a[a.length-1].members,n))}return this.filterFramedHeaders},e.prototype.validateFilteredHeaders=function(e,t,i){for(var r=0,a=t;r<a.length;r++){var n=a[r];if(!this.isHeaderAvail){if(e.actualText===n.actualText&&e.level===n.level&&e.valueSort.levelName===n.valueSort.levelName)return"row"===i?n.index.length>0?(this.isHeaderAvail=!0,e.index=n.index,!0):(this.isHeaderAvail=!1,e.index=n.index,!1):Object.keys(n.indexObject).length>0?(this.isHeaderAvail=!0,e.indexObject=n.indexObject,!0):(this.isHeaderAvail=!1,e.indexObject=n.indexObject,!1);n.hasChild&&n.members.length>0&&"grand sum"!==n.type&&this.validateFilteredHeaders(e,n.members,i)}}return this.isHeaderAvail},e.prototype.isEmptyDataAvail=function(e,t){this.isEmptyData=!1,e.length>0&&"grand sum"===e[e.length-1].type&&0===e[e.length-1].index.length&&(this.isEmptyData=!0),t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0),0!==e.length&&0!==t.length||(this.isEmptyData=!0)},e.prototype.updateGridData=function(e){this.data=e.dataSource,this.indexMatrix=[];for(var t=0,i=this.fields;t<i.length;t++){var r=i[t];this.fieldList[r].members={},this.fieldList[r].formattedMembers={},this.fieldList[r].dateMember=[]}this.fillFieldMembers(this.data,this.indexMatrix),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.cMembers=[],this.rMembers=[],this.updateFilterMembers(e),this.isEditing=!0,this.isDrillThrough=!0,this.generateGridData(e),this.isEditing=!1},e.prototype.generateGridData=function(e,i){this.fields;var r=e.columns?e.columns:[],a=this.data,n=e.rows?e.rows:[],o=e.filterSettings,l=e.values?e.values:[];this.removeCount=0,this.isExpandAll=e.expandAll,this.drilledMembers=e.drilledMembers?e.drilledMembers:[],this.isEmptyData=!1;var s=[],d=n[0]&&n[0].showNoDataItems||r[0]&&r[0].showNoDataItems,p=t.extend([],this.rows,null,!0);if(p=p.concat(this.columns,this.values,this.filters),d)for(var h=0;h<this.indexMatrix.length;h++)s.push(h);for(h=0;h<this.filterMembers.length;h++)this.filterPosObj[this.filterMembers[h]]=this.filterMembers[h];this.valueSortSettings.columnIndex=void 0;(new Date).getTime();this.frameDrillObject(),this.isValueFilterEnabled&&!this.isEditing||i||(this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==n.length&&(this.rMembers=this.getIndexedHeaders(n,a,0,n[0].showNoDataItems?s:this.filterMembers,"row","",this.allowValueFilter)),0!==r.length&&(this.cMembers=this.getIndexedHeaders(r,a,0,r[0].showNoDataItems?s:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&e.allowValueFilter?{rowHeaders:t.extend([],this.rMembers,null,!0),columnHeaders:t.extend([],this.cMembers,null,!0)}:{}),this.pivotValues=[],this.headerContent=[],this.valueContent=[],this.valueFilteredData=[],this.filterFramedHeaders=[];var u=[],c=[],g=[],m=[],f=this.values.length;if(this.isValueFiltersAvail&&e.allowValueFilter&&!i){this.valueFilteredData=[];var v=this.saveDataHeaders.rowHeaders,y=this.saveDataHeaders.columnHeaders;if(o.length>0){for(var S={},b={},C=0,x=l;C<x.length;C++){var w=x[C];b[w.name]=w}for(var T=0,M=o;T<M.length;T++){var D=M[T];v=g.length>0?g:v,y=m.length>0?m:y,this.valueFilteredData=[];var E=D.properties?D.properties:D;if("Value"===E.type&&this.fieldList[D.name].isSelected){S[D.name]=D,E.items=[];for(var L=!1,O=n.length,P=r.length,N=0;N<O;N++)if(E.name===n[N].name&&b[E.measure]&&!L){L=!0,g=this.applyValueFiltering(n[N],N,v,y[y.length-1],S,this.valueFilteredData,"row");break}for(var I=0;I<P;I++)if(E.name===r[I].name&&b[E.measure]&&!L){L=!0,m=this.applyValueFiltering(r[I],I,y,v[v.length-1],S,this.valueFilteredData,"column");break}}}}g=g.length>0?g:v,m=m.length>0?m:y,this.isEmptyDataAvail(g,m);var A=t.extend({},this.fieldList,null,!0);this.indexMatrix=[];var F=this.data[0];this.getFieldList(F,this.enableSort,e.allowValueFilter),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(e.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],this.updateFilterMembers(e),this.rMembers=0!==n.length?this.getIndexedHeaders(n,a,0,n[0].showNoDataItems?s:this.filterMembers,"row",""):[],this.cMembers=0!==r.length?this.getIndexedHeaders(r,a,0,r[0].showNoDataItems?s:this.filterMembers,"column",""):[],this.insertAllMembersCommon(),this.updateFieldList(A),this.rowCount=0,this.columnCount=0,this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,g,this.filterFramedHeaders,"row"),this.filterFramedHeaders=[],this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,m,this.filterFramedHeaders,"column"),this.isValueFilterEnabled=!0}i||this.applyValueSorting(),this.pageSettings&&(i?(this.rMembers=i.rowHeaders,this.cMembers=i.columnHeaders,this.rowCount=i.rowHeadersCount,this.columnCount=i.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues()),this.getAggregatedHeaders(n,r,this.rMembers,this.cMembers,l),this.getHeaderData(this.cMembers,c,this.pivotValues,0,this.valueAxis?1:f),this.insertSubTotals(),this.getTableData(this.rMembers,u,c,0,this.pivotValues,f,this.rMembers[this.rMembers.length-1],this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(u,c,this.pivotValues),this.isEngineUpdated=!0;(new Date).getTime();this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.onDrill=function(e){this.frameDrillObject();var t=this.getHeadersInfo(e.fieldName,e.axis);this.performDrillOperation(t.headers,e,t.fields,t.position,0),this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount,"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers,this.updateEngine()},e.prototype.onSort=function(e){var t=this.getHeadersInfo(e.name,"");this.fieldList[e.name].sort=e.order,this.performSortOperation(t.headers,e,t,0),this.updateEngine()},e.prototype.onFilter=function(e,t){var i=this.getHeadersInfo(e.name,"");"Include"===e.type&&e.items.length===this.fieldList[e.name].dateMember.length?(this.fieldList[e.name].filter=[],this.fieldList[e.name].filterType=""):(this.fieldList[e.name].filter=e.items,this.fieldList[e.name].filterType=e.type);for(var r={},a=0,n=this.filterMembers;a<n.length;a++){var o=n[a];r[o]=o}this.filterMembers=[],this.fieldFilterMem={},this.updateFilterMembers(t);for(var l=this.filterMembers.filter(function(e){return void 0===r[e]}),s=0,d=e.items;s<d.length;s++)d[s];if(this.rows[0]&&this.rows[0].showNoDataItems||this.columns[0]&&this.columns[0].showNoDataItems){var p=[];this.filterPosObj={};for(var h=0;h<l.length;h++)this.filterPosObj[l[h]]=l[h];for(h=0;h<this.indexMatrix.length;h++)p.push(h);l=p}this.performFilterCommonUpdate(e,i,l),this.frameHeaderObjectsCollection=!1,this.headerObjectsCollection={},this.updateEngine()},e.prototype.onAggregation=function(e){this.fieldList[e.name].aggregateType=e.type,this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.updateEngine()},e.prototype.onCalcOperation=function(e){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders,this.getCalculatedField(this.fields),this.fieldList[e.name]?this.fieldList[e.name].formula=e.formula:(this.fieldList[e.name]={id:e.name,caption:e.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:e.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.values.length-1)*this.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.values.length-1)*this.values.length),this.updateEngine()},e.prototype.performDrillOperation=function(e,t,i,r,a){for(var n=0;n<e.length;){if(r===a){if(t.memberName===e[n].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).join(t.delimiter?t.delimiter:"**")){if("down"===t.action){e[n].isDrilled=!0,e[n].members=this.getIndexedHeaders(i,this.data,r+1,e[n].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter));var o=void 0;if("row"===t.axis)o=this.applyValueSorting(e[n].members,this.cMembers),e[n].members=o.rMembers;else{var l=this.showSubTotals&&this.showColumnSubTotals&&i[r].showSubTotals;this.columnCount-=l?0:this.colValuesLength,o=this.applyValueSorting(this.rMembers,e[n].members),e[n].members=o.cMembers}}else e[n].isDrilled=!1,this.updateHeadersCount(e[n].members,t.axis,r,i,"minus",!0),e[n].members=[];break}}else e[n].members.length>0&&(e[n].members=this.performDrillOperation(e[n].members,t,i,r,a+1));n++}return e},e.prototype.performSortOperation=function(e,t,i,r){for(var a=0;a<e.length;){if(i.position===r){e=this.getSortedHeaders(e,t.order.toString());break}e[a].members.length>0&&(e[a].members=this.performSortOperation(e[a].members,t,i,r+1)),a++}return e},e.prototype.performFilterDeletion=function(e,t,i,r,a){for(var n=0,o=!0,l=function(){if(i.position===a){var l=s;e=e.filter(function(e){return!l.fieldFilterMem[t.name].memberObj[e.formattedText]||"grand sum"===e.type}),o=!1}else e[n].members.length>0&&(e[n].members=s.performFilterDeletion(e[n].members,t,i,r,a+1));n++},s=this;n<e.length&&o;)l();var d=this;return e.filter(function(e){return e.members.length>0?e.members.length>0:d.matchIndexes(e.indexObject,r)})},e.prototype.matchIndexes=function(e,t){var i=Object.keys(e),r=i.length;if(0===r)return!0;for(;r>-1;){if(void 0!==t[e[i[r]]])return!0;r--}return!1},e.prototype.performFilterAddition=function(e,t,i){for(var r=0,a=function(){var a=e[r].valueSort.levelName;if(n.headerObjectsCollection[a]){for(var o={},l=0,s=e[r].members;l<s.length;l++){var d=s[l];o[d.valueSort.levelName.toString()]=d.valueSort.levelName.toString()}var p=n.headerObjectsCollection[a].filter(function(e){return!o[e.valueSort.levelName.toString()]});e[r].members=e[r].members.concat(p),e[r].members=n.getSortedHeaders(e[r].members,n.fieldList[i.fields[e[r].members[0].level].name].sort),delete n.headerObjectsCollection[a]}e[r].members.length>0&&(e[r].members=n.performFilterAddition(e[r].members,t,i)),r++},n=this;r<e.length;)a();return e},e.prototype.performFilterCommonUpdate=function(e,t,i){for(var r="row"===t.axis?this.rMembers:this.cMembers,a={},n=0,o=this.filterMembers;n<o.length;n++){var l=o[n];a[l]=l}if(this.fieldFilterMem[e.name]&&(r=this.performFilterDeletion(t.headers,e,t,a,0)),i.length>0){this.frameHeaderObjectsCollection=!0,t.fields.filter(function(e){return e.showNoDataItems}).length>0&&(i=this.data.map(function(e,t){return t})),this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,"");for(var s={},d=0,p=r=this.performFilterAddition(r,t.fields,t);d<p.length;d++){var h=p[d];s[h.valueSort.levelName.toString()]=h.valueSort.levelName.toString()}var u=this.headerObjectsCollection.parent.filter(function(e){return!s[e.valueSort.levelName.toString()]}),c=r.filter(function(e){return"grand sum"===e.type});c.length>0&&r.pop(),r=this.getSortedHeaders(r.concat(u),this.fieldList[t.fields[0].name].sort).concat(c)}"row"===t.axis?this.rowCount=0:this.columnCount=0,this.updateHeadersCount(r,t.axis,0,t.fields,"plus",!1),"row"===t.axis?(t.position>0&&this.insertPosition(this.rows,this.data,0,this.filterMembers,"row","",r),this.insertTotalPosition(r),this.rMembers=this.headerCollection.rowHeaders=r,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.columns,this.data,0,this.filterMembers,"column","",r),this.insertTotalPosition(r),this.cMembers=this.headerCollection.columnHeaders=r,this.headerCollection.columnHeadersCount=this.columnCount),this.applyValueSorting()},e.prototype.getHeadersInfo=function(e,t){this.rMembers=this.headerCollection.rowHeaders,this.cMembers=this.headerCollection.columnHeaders;for(var i="row"===(t=""===t?this.getAxisByFieldName(e):t)?this.rMembers:this.cMembers,r="row"===t?this.rows:this.columns,a=0,n=0,o=r;n<o.length;n++){if(o[n].name===e)break;a++}return{axis:t,fields:r,headers:i,position:a}},e.prototype.updateEngine=function(){this.removeCount=0,this.calculatePagingValues(),this.pivotValues=[],this.headerContent=[],this.valueContent=[];var e=[],t=[],i=this.values.length;this.getAggregatedHeaders(this.rows,this.columns,this.rMembers,this.cMembers,this.values),this.getHeaderData(this.cMembers,t,this.pivotValues,0,this.valueAxis?1:i),this.insertSubTotals(),this.getTableData(this.rMembers,e,t,0,this.pivotValues,i,this.rMembers[this.rMembers.length-1],this.cMembers[this.cMembers.length-1]),this.applyAdvancedAggregate(e,t,this.pivotValues),this.isEngineUpdated=!0,this.isEmptyDataAvail(this.rMembers,this.cMembers)},e.prototype.getAxisByFieldName=function(e){for(var t=0,i="";t<4&&""===i;){switch(t){case 0:i=this.getFieldByName(e,this.rows)?"row":"";break;case 1:i=this.getFieldByName(e,this.columns)?"column":""}t++}return i},e.prototype.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.updateHeadersCount=function(e,t,i,r,a,n){var o=0,l=r[i],s=!0;for(s="column"===t?this.showSubTotals&&this.showColumnSubTotals&&l.showSubTotals:this.showSubTotals&&this.showRowSubTotals&&l.showSubTotals;o<e.length;)"row"===t?this.rowCount=this.rowCount-("plus"===a?-(1===this.valueAxis?this.values.length:1):1===this.valueAxis?this.values.length:1):this.columnCount=this.columnCount-("plus"===a?-(1===this.valueAxis?1:this.values.length):1===this.valueAxis?1:this.values.length),e[o].members.length>0&&this.updateHeadersCount(e[o].members,t,i+1,r,a,!0),o++;"column"===t&&!s&&n&&(this.columnCount+="plus"===a?-this.colValuesLength:this.colValuesLength)},e.prototype.frameHeaderWithKeys=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=e[t[i]],i++;return r},e.prototype.getSortedHeaders=function(e,t){return!(this.formatFields&&this.formatFields[e[0].valueSort.axis]&&this.formatFields[e[0].valueSort.axis].type)?"Ascending"===t?e.sort(function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0}):"Descending"===t?e.sort(function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0}):e:"Ascending"===t?e.sort(function(e,t){return e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0}):"Descending"===t?e.sort(function(e,t){return e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0}):e},e.prototype.applyValueSorting=function(e,t){var i=!1;if(void 0!==e&&void 0!==t||(e=this.rMembers,t=this.cMembers,i=!0),this.enableValueSorting&&this.valueSortSettings.headerText&&""!==this.valueSortSettings.headerText&&this.values.length>0){for(var r=this.valueSortSettings.headerText.split(this.valueSortSettings.headerDelimiter),a="",n=void 0,o=void 0,l=void 0,s=0;s<this.values.length;s++){if(this.values[s].caption===r[r.length-1]){l=this.values[s].name;break}l=r[r.length-1]}if((1===this.values.length&&0===this.columns.length||this.values.length>1)&&l&&this.fieldList[l]){for(s=0;s<r.length-1;s++)a=""===a?r[s]:a+this.valueSortSettings.headerDelimiter+r[s];n=this.fieldList[l].index,o=this.fieldList[l].aggregateType}else{if(this.alwaysShowValueHeader&&1!==r.length)for(s=0;s<r.length-1;s++)a=""===a?r[s]:a+this.valueSortSettings.headerDelimiter+r[s];else a=this.valueSortSettings.headerText;n=this.fieldList[this.values[0].name].index,o=this.fieldList[this.values[0].name].aggregateType}var d=void 0;0===this.valueAxis?(d=this.getMember(t,a))&&(e=this.sortByValueRow(e,d,this.valueSortSettings.sortOrder,n,o)):(d=this.getMember(e,a))&&(t=this.sortByValueRow(t,d,this.valueSortSettings.sortOrder,n,o)),i&&(this.rMembers=e,this.cMembers=t,this.pageSettings&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:e,cMembers:t}},e.prototype.getMember=function(e,t){for(var i,r=e.length,a=0;a<r;a++){if(e[a].valueSort.levelName===t){i=e[a];break}if(e[a].members.length>0&&(i=this.getMember(e[a].members,t)),i)return i}return i},e.prototype.sortByValueRow=function(e,t,i,r,a){for(var n=[],o=0,l=e;o<l.length;o++){if("grand sum"===(u=l[o]).type)n.push({header:u});else{this.rawIndexObject={};var s=this.getAggregateValue(u.index,t.indexObject,r,a),d={fieldName:this.fields[r],row:u,column:t,value:s,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:u.hasChild&&u.isDrilled?"subTotal":"grand sum"===u.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:a,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(d),s=d.value,this.rawIndexObject={},n.push({header:u,value:s})}}n.sort(function(e,t){return"Descending"===i?(t.value||"grand sum"===t.header.type?t.value:0)-(e.value||"grand sum"===e.header.type?e.value:0):(e.value||"grand sum"===e.header.type?e.value:0)-(t.value||"grand sum"===t.header.type?t.value:0)});for(var p=0,h=e=n.map(function(e){return e.header});p<h.length;p++){var u;(u=h[p]).members.length>0&&(u.members=this.sortByValueRow(u.members,t,i,r,a))}return e},e.prototype.insertAllMembersCommon=function(){(!(!this.showGrandTotals||!this.showRowGrandTotals)||!(this.rows.length>0))&&this.insertAllMember(this.rMembers,this.filterMembers,"","row");(!(!this.showGrandTotals||!this.showColumnGrandTotals)||!(this.columns.length>0))&&this.insertAllMember(this.cMembers,this.filterMembers,"","column")},e.prototype.insertSubTotals=function(){for(var e=this.pivotValues.length,i=0;i<e;i++){var r=this.pivotValues[i];if(r)for(var a=void 0,n=1,o=void 0,l=r.length-1;l>0;l--){var s=r[l];if(s){a&&(a.colSpan=n,a.colIndex=a.colIndex-(n-1)),o={index:s.index,indexObject:s.indexObject},s.index=[],s.indexObject={},a=t.extend({},s,null,!0),s.index=o.index,s.indexObject=o.indexObject;for(var d=i+1;this.pivotValues[d]&&!this.pivotValues[d][l];){this.pivotValues[i][l].isDrilled||(this.pivotValues[i][l].rowSpan=d-i+1,a.rowSpan=d-i+1);var p="sum"===s.type||"grand sum"===s.type?s.type:"sum";this.pivotValues[d][l]=this.headerContent[d][l]={type:p,formattedText:"sum"===s.type||"grand sum"===s.type?s.formattedText:s.formattedText+" Total",axis:"column",level:-1,colIndex:l,rowIndex:d,valueSort:s.valueSort},s.valueSort&&s.valueSort[this.valueSortSettings.headerText]&&(this.valueSortSettings.columnIndex=l);var h=!1;"grand sum"===p?(this.pivotValues[i][l].rowSpan=d-i+1,a.rowSpan=d-i+1):"sum"!==this.pivotValues[i][l].type&&this.pivotValues[i][l].isDrilled?(this.pivotValues[i+1][l].rowSpan=d-i,h=!0):this.pivotValues[d][l].rowSpan=-1,d>i+1&&("sum"===this.pivotValues[i][l].type||h)&&(this.pivotValues[d][l].rowSpan=-1),d++}n=1}else r[l]=this.headerContent[i][l]=t.extend({},a,null,!0),r[l].index=this.headerContent[i][l].index=o.index,r[l].indexObject=this.headerContent[i][l].indexObject=o.indexObject,n++,r[l].colSpan=n,r[l].colIndex=r[l].colIndex-(n-1);1===l&&a&&(a.colSpan=n,a.colIndex=a.colIndex-(n-1))}}},e.prototype.frameDrillObject=function(){this.fieldDrillCollection={};for(var e=0;e<this.drilledMembers.length;e++)for(var t=this.drilledMembers[e],i=0;i<t.items.length;i++){var r=t.name+this.valueSortSettings.headerDelimiter+t.items[i].split(t.delimiter).join(this.valueSortSettings.headerDelimiter);this.fieldDrillCollection[r]=r}},e.prototype.getIndexedHeaders=function(e,i,r,a,n,o,l){var s=[];if(e){var d=e.length,p={},h=e[r].name,u=e[r],c=this.fieldList[h],g=!1,m=this.formatFields[h]&&["date","dateTime","time"].indexOf(this.formatFields[h].type)>-1,f=a.length<1&&r>0||u.showNoDataItems,v={};if(f){for(var y=Object.keys(c.members),S=0,b=y.length;S<b;S++)(this.showHeaderWhenEmpty||this.localeObj&&y[S]!==this.localeObj.getConstant("undefined"))&&(v[y[S]]=y[S]);a.length<1&&(g=!0,a.length=y.length)}for(S=0,b=a.length;S<b;S++){var C={};t.isNullOrUndefined(e[r].showSubTotals)||e[r].showSubTotals||(C.showSubTotals=!1),C.hasChild=r<d-1,C.level=r,C.axis=n,C.colSpan=1;var x=g?c.members[Object.keys(v)[0]].ordinal:this.indexMatrix[a[S]][c.index],w=g?Object.keys(v)[0]:i[a[S]][h];if(!(t.isNullOrUndefined(w)||this.localeObj&&w===this.localeObj.getConstant("undefined"))||this.showHeaderWhenEmpty){if(delete v[w],!f||!this.fieldFilterMem[h]||this.fieldFilterMem[h].memberObj[w]!==w){var T=m?{actualText:w,formattedText:c.dateMember[x-1].formattedText,dateText:c.dateMember[x-1].actualText}:{formattedText:null===w?this.localeObj?this.localeObj.getConstant("null"):String(w):void 0===w&&this.localeObj?h in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(w),actualText:null===w?this.localeObj?this.localeObj.getConstant("null"):String(w):void 0===w?this.localeObj?h in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(w):w};C.actualText=T.actualText,C.formattedText=T.formattedText,m&&(C.dateText=T.dateText);var M=!f||void 0!==this.filterPosObj[a[S]]&&!g;if(p&&p[x])M&&(p[x].index.push(a[S]),p[x].indexObject[a[S]]=a[S]);else{p[x]={index:[],indexObject:{}},C.index=p[x].index,C.indexObject=p[x].indexObject,M&&(C.index=p[x].index=[a[S]],p[x].indexObject[a[S]]=a[S],C.indexObject=p[x].indexObject),C.ordinal=x,C.valueSort={},C.valueSort.axis=h,0!==r?(C.valueSort.levelName=o+this.valueSortSettings.headerDelimiter+C.formattedText,C.valueSort[o+this.valueSortSettings.headerDelimiter+C.formattedText]=1):(C.valueSort[C.formattedText]=1,C.valueSort.levelName=C.formattedText);var D=C.valueSort.axis+this.valueSortSettings.headerDelimiter+C.valueSort.levelName;C.isDrilled=!(!l||!this.isValueFiltersAvail)||(C.hasChild&&this.fieldDrillCollection[D]?!this.isExpandAll:c.members[w].isDrilled),C.members=[],s.push(C)}f&&!g&&r>0&&S+1===a.length&&Object.keys(v).length>0&&(g=!0,b=Object.keys(v).length,S=-1)}}else f&&!g&&r>0&&S+1===a.length&&Object.keys(v).length>0&&(b=Object.keys(v).length,g=!0,S=-1)}for(var E=0,L=s.length;E<L;E++){this.frameHeaderObjectsCollection||("row"===n?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength);var O=null;if(s[E].valueSort&&s[E].valueSort.levelName&&(O=s[E].valueSort.levelName),o=O||s[E].formattedText,!this.showHeaderWhenEmpty&&d-1>r&&s[E].index&&s[E].index.length>0&&!f){w=i[s[E].index[0]][e[r+1].name];var P=!(t.isNullOrUndefined(w)||this.localeObj&&w===this.localeObj.getConstant("undefined"))||1!==s[E].index.length;s[E].hasChild=P}else!this.showHeaderWhenEmpty&&f&&e[r+1]&&e[r+1].name&&Object.keys(this.fieldList[e[r+1].name].members).length&&(s[E].hasChild=!0);if(d-1>r&&s[E].isDrilled){this.columnCount-=this.showSubTotals&&this.showColumnSubTotals&&u.showSubTotals||"column"!==n?0:this.colValuesLength;var N=s[E].index;s[E].members=this.getIndexedHeaders(e,i,r+1,void 0===N?[]:N,n,o),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[o]=s[E].members)}}return this.enableSort?m?"Ascending"===c.sort?s.sort(function(e,t){return e.dateText>t.dateText?1:t.dateText>e.dateText?-1:0}):"Descending"===c.sort?s.sort(function(e,t){return e.dateText<t.dateText?1:t.dateText<e.dateText?-1:0}):s:"Ascending"===c.sort?s.sort(function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0}):"Descending"===c.sort?s.sort(function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0}):s:s}return s},e.prototype.getOrderedIndex=function(e){for(var t={},i=0;i<e.length;i++)"grand sum"!==e[i].type&&(t[e[i].ordinal]=i);return t},e.prototype.insertPosition=function(e,t,i,r,a,n,o){var l=[],s=this.getOrderedIndex(o);if(e){for(var d={},p=e[i].name,h=this.fieldList[p],u=0,c=r.length;u<c;u++){var g={},m=this.indexMatrix[r[u]][h.index],f=o[s[m]],v=this.formatFields[p]&&["date","dateTime","time"].indexOf(this.formatFields[p].type)>-1?this.getFormattedValue(t[r[u]][p],p):{formattedText:t[r[u]][p].toString(),actualText:t[r[u]][p].toString()};f&&f.formattedText===v.formattedText&&(d&&d[m]?(d[m].index.push(r[u]),d[m].indexObject[r[u]]=r[u]):(d[m]={index:[],indexObject:{}},f.index=d[m].index=[r[u]],d[m].indexObject[r[u]]=r[u],f.indexObject=d[m].indexObject,f.valueSort={},f.valueSort.axis=p,0!==i?(f.valueSort.levelName=n+this.valueSortSettings.headerDelimiter+f.formattedText,f.valueSort[n+this.valueSortSettings.headerDelimiter+f.formattedText]=1):(f.valueSort[f.formattedText]=1,f.valueSort.levelName=f.formattedText),g.members=[],l.push(g)))}for(var y=o.length-l.length;y>0;)l.push({members:[]}),y--;for(var S=0,b=l.length;S<b;S++)if(o[S].members.length>0){var C=null;o[S].valueSort&&o[S].valueSort.levelName&&(C=o[S].valueSort.levelName),n=C||o[S].formattedText,l[S].members=this.insertPosition(e,t,i+1,o[S].index,a,n,o[S].members)}return l}return l},e.prototype.insertTotalPosition=function(e){var t=e[e.length-1];if(t&&"grand sum"===t.type){t.index=this.filterMembers;for(var i=0,r=this.filterMembers.length;i<r;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i]}return e},e.prototype.calculatePagingValues=function(){if(this.pageSettings){1===this.valueAxis?this.rowValuesLength=this.values.length:this.colValuesLength=this.values.length,this.memberCnt=-this.rowValuesLength,this.rowStartPos=(this.pageSettings.rowCurrentPage*this.pageSettings.rowSize-this.pageSettings.rowSize)*this.rowValuesLength;var e=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength>this.rowCount?this.rowCount-3*this.pageSettings.rowSize*this.rowValuesLength:this.rowStartPos;e<0&&(e=this.rowStartPos=0,this.pageSettings.rowCurrentPage=1),this.rowFirstLvl=(this.rowStartPos-e)%this.pageSettings.rowSize,this.rowStartPos=e,this.endPos=this.rowStartPos+3*this.pageSettings.rowSize*this.rowValuesLength,this.endPos=this.endPos>this.rowCount?this.rowCount:this.endPos,this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.columnCurrentPage*this.pageSettings.columnSize-this.pageSettings.columnSize)*this.colValuesLength,(e=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength>this.columnCount?this.columnCount-3*this.pageSettings.columnSize*this.colValuesLength:this.colStartPos)<0&&(e=this.colStartPos=0,this.pageSettings.columnCurrentPage=1),this.colFirstLvl=(this.colStartPos-e)%this.pageSettings.columnSize,this.colStartPos=e,this.endPos=this.colStartPos+3*this.pageSettings.columnSize*this.colValuesLength,this.endPos=this.endPos>this.columnCount?this.columnCount:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column"),this.memberCnt=-1,this.pageInLimit=!1}},e.prototype.performSlicing=function(e,t,i,r){for(var a=0;e[a];){if(this.memberCnt+="column"===r?this.colValuesLength:this.rowValuesLength,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===r?this.colFirstLvl=this.colFirstLvl+e[a].level:this.rowFirstLvl=this.rowFirstLvl+e[a].level,this.pageInLimit=!0),this.pageInLimit&&this.endPos<=this.memberCnt){if("column"!==r)break;if(0===e[a].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0,this.endPos+=e[a].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(e[a].members.length>0?this.removeChildMembers(e[a]):e[a]),e[a].members.length>0&&("column"===r&&(this.memberCnt-=this.showSubTotals&&this.showColumnSubTotals&&this.columnKeys[e[a].valueSort.axis].showSubTotals?0:this.colValuesLength),t[t.length-1].members=this.performSlicing(e[a].members,[],i,r)),this.pageInLimit||t.pop(),0===e[a].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;a++}return t},e.prototype.removeChildMembers=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=e[t[i]],"members"===t[i]&&(r.members=[]),i++;return r},e.prototype.insertAllMember=function(e,t,i,r){var a=e.length;i=" Total",e[a]={hasChild:!1,index:t,level:0,axis:r,isDrilled:!1,indexObject:{},members:[],formattedText:"Grand"+i,ordinal:a,type:"grand sum",valueSort:{}},e[a].valueSort[e[a].formattedText]=1,e[a].valueSort.levelName=e[a].formattedText;for(var n=0,o=t.length;n<o;n++)e[a].indexObject[t[n]]=t[n];"row"===r?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength},e.prototype.getTableData=function(e,i,r,a,n,o,l,s){for(var d=e.length,p=0;p<d;p++){i[a=n.length]=e[p];var h=a-Number(Object.keys(i)[0]),u=!i[a].members.length;if(e[p].colIndex=0,e[p].rowIndex=a,n[a]?n[a][0]=this.valueContent[h][0]=this.frameHeaderWithKeys(e[p]):(n[a]=[],this.valueContent[h]={},n[a][0]=this.valueContent[h][0]=this.frameHeaderWithKeys(e[p])),this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&(!e[p].isDrilled||(t.isNullOrUndefined(e[p].showSubTotals)||e[p].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals)){for(var c=a,g=h,m=0;m<o;m++){a++,h++;var f=this.values[m].caption?this.values[m].caption:this.values[m].name,v={axis:"row",actualText:this.values[m].name,formattedText:f,level:0,valueSort:{},colIndex:0,rowIndex:a,type:"value"};n[a]||(n[a]=[],this.valueContent[h]={},n[a][0]=this.valueContent[h][0]=v);var y=n[a][0].valueSort;y[n[a-m-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+f]=1,y.levelName=n[a-m-1][0].valueSort.levelName+this.valueSortSettings.headerDelimiter+f;for(var S=0,b=1,C=r.length;S<C;++S)this.updateRowData(e,r,a,n,m,p,S,b,h,l,s),b=n[a].length,n[c][b-1]=this.valueContent[g][b-1]={axis:"value",actualText:"",colSpan:1,colIndex:b,formattedText:"",hasChild:!1}}this.recursiveRowData(e,i,r,a,n,o,u,p,o,l,s)}else{for(S=0,b=1,C=r.length;S<C;++S)for(m=0;m<o;m++)this.updateRowData(e,r,a,n,m,p,S,b,h,l,s),b=n[a].length;this.recursiveRowData(e,i,r,a,n,o,u,p,0,l,s)}}},e.prototype.getAggregatedHeaders=function(e,t,i,r,a){this.selectedHeaders={selectedHeader:[],values:[]};for(var n=a.length,o=0;o<n;o++)switch(a[o].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var l=void 0,s=void 0;this.selectedHeaders.values.push(a[o].name),a[o].baseField&&a[o].baseItem?(l=a[o].baseField,s=a[o].baseItem):this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?(l=t[0].name,s=Object.keys(this.fieldList[t[0].name].members)[0]):e.length>0&&(l=e[0].name,s=Object.keys(this.fieldList[e[0].name].members)[0]);for(var d=!1,p=0,h=e;p<h.length;p++){if(h[p].name===l){this.getAggregatedHeaderData(i,a[o].name,s,!1,"row",a[o].type,this.selectedHeaders.selectedHeader,o),d=!0;break}}if(!d)for(var u=0,c=t;u<c.length;u++){if(c[u].name===l){this.getAggregatedHeaderData(r,a[o].name,s,!1,"column",a[o].type,this.selectedHeaders.selectedHeader,o);break}}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(a[o].name),this.getAggregatedHeaderData("PercentageOfParentRowTotal"===a[o].type?i:r,a[o].name,void 0,!1,"PercentageOfParentRowTotal"===a[o].type?"row":"column",a[o].type,this.selectedHeaders.selectedHeader,o);break;case"RunningTotals":this.selectedHeaders.values.push(a[o].name),this.getAggregatedHeaderData(this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?r:i,a[o].name,void 0,!1,this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?"column":"row",a[o].type,this.selectedHeaders.selectedHeader,o);break;case"PercentageOfParentTotal":l=void 0;this.selectedHeaders.values.push(a[o].name),a[o].baseField?l=a[o].baseField:this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)&&t.length>0?l=t[0].name:e.length>0&&(l=e[0].name);d=!1;for(var g=e.length,m=0;m<g;m++)if(e[m].name===l){this.getAggregatedHeaderData(i,a[o].name,void 0,!1,"row",a[o].type,this.selectedHeaders.selectedHeader,o,m),d=!0;break}if(!d)for(g=t.length,m=0;m<g;m++)if(t[m].name===l){this.getAggregatedHeaderData(r,a[o].name,void 0,!1,"column",a[o].type,this.selectedHeaders.selectedHeader,o,m);break}}},e.prototype.getAggregatedHeaderData=function(e,i,r,a,n,o,l,s,d){for(var p=0,h=e;p<h.length;p++){var u=h[p];switch(o){case"DifferenceFrom":case"PercentageOfDifferenceFrom":-1!==u.valueSort.levelName.toString().split(".").indexOf(r)?(l.push(this.updateSelectedHeaders(r,u.level,n,a,i,o,u.valueSort.levelName,a?[u]:e,s+1)),u.members.length>0&&this.getAggregatedHeaderData(u.members,i,r,!0,n,o,l[l.length-1].childMembers,s)):u.members.length>0&&this.getAggregatedHeaderData(u.members,i,r,!1,n,o,l,s);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===u.type?l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,e,s+1)):u.members.length>0&&(l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,u.members,s+1)),this.getAggregatedHeaderData(u.members,i,void 0,!1,n,o,l,s));break;case"PercentageOfParentTotal":if("grand sum"!==u.type)if(u.level===d)if(u.members.length>0){if(a)for(var c=l[l.length-1].aggregateHeaders,g=0,m=u.members;g<m.length;g++){var f=m[g];c.push(f)}else{var v=t.extend([],u.members,null,!0);l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,v,s+1));(c=l[l.length-1].aggregateHeaders).push(u)}this.getAggregatedHeaderData(u.members,i,void 0,!0,n,o,l,s,d+1)}else a||l.push(this.updateSelectedHeaders(void 0,u.level,n,!1,i,o,u.valueSort.levelName,[u],s+1));else u.members.length>0&&this.getAggregatedHeaderData(u.members,i,void 0,!1,n,o,l,s,d)}}},e.prototype.updateSelectedHeaders=function(e,t,i,r,a,n,o,l,s){return{name:e,level:t,axis:i,isChild:r,value:a,type:n,uniqueName:o,aggregateHeaders:l,childMembers:[],valueCount:s}},e.prototype.applyAdvancedAggregate=function(e,t,i){if(this.selectedHeaders.values.length>0){for(var r={},a=[],n=!1,o=i.length,l=0;l<o;l++)if(void 0!==i[l]&&void 0!==i[l][0]){if(!n)for(var s=i[l].length,d=0;d<s;d++)"value"===i[l][d].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][d].actualText)&&(a.push(d),n=!0);if(a.length>0&&"value"===i[l][a[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[l][a[0]].actualText))for(var p=0,h=a;p<h.length;p++){r[l+","+(g=h[p])]=[l,g]}}this.updateAggregates(e,t,i,this.selectedHeaders.selectedHeader,a,r);for(var u=0,c=Object.keys(r);u<c.length;u++){var g;i[r[g=c[u]][0]][r[g][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A"}}},e.prototype.updateAggregates=function(e,t,i,r,a,n){for(var o=0,l=r;o<l.length;o++){var s=l[o],d=s.aggregateHeaders,p=s.value,h=this.valueAxis&&(this.isMutiMeasures||this.alwaysShowValueHeader)?s.valueCount:0,u=s.type,c=s.uniqueName,g="row"===s.axis,m=void 0,f=[],v=[],y=[],S=[],b=[],C=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(s.type))if(g){if("RunningTotals"!==s.type)for(var x=e.length,w=0;w<x;w++)if(void 0!==e[w]&&e[w].valueSort[c]){m=e[w],b=i[w+h];break}}else{for(var T=i.length,M=0;M<T&&(void 0!==i[M]&&void 0===i[M][0]);M++)y.push(i[M]);for(var D=y.length;D--;){var E=(I=y[D][a[0]]).actualText;-1===this.selectedHeaders.values.indexOf(E)&&(v=y[D],D=0)}if("RunningTotals"!==s.type)for(var L=v.length,O=0;O<L;O++){var P=!1;if(void 0!==v[O]&&v[O].valueSort[c]){m=v[O];var N=i.length;for(M=0;M<N;M++){var I;void 0!==(I=i[M])&&void 0!==I[0]&&"value"===I[O].axis&&-1!==this.selectedHeaders.values.indexOf(I[O].actualText)&&(P=!0,C[M]=I[O],S.push(M))}if(P)break}}}switch(s.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":var A=s.isChild;if(g){if(A){for(var F=c.split("."),q=(x=e.length,0);q<x;q++)if(void 0!==e[q]){if(-1!==e[q].valueSort.levelName.toString().split(".").indexOf(F[F.length-1])&&e[q].level===m.level)for(var R=0,j=a;R<j.length;R++){U=j[R];"value"===(be=i[q+h][U]).axis&&be.actualText===p&&(f.push([q+h,U]),n[q+h+","+U]&&delete n[q+h+","+U])}}}else for(var k=0,H=d;k<H.length;k++){var V=H[k],x=e.length;for(w=0;w<x;w++)if(void 0!==e[w]&&e[w].valueSort[V.valueSort.levelName]&&e[w].level===m.level&&"grand sum"!==e[w].type)for(var _=0,B=a;_<B.length;_++){var U=B[_];"value"===(be=i[w+h][U]).axis&&be.actualText===p&&(f.push([w+h,U]),n[w+h+","+U]&&delete n[w+h+","+U])}}for(var G=0,z=f;G<z.length;G++){var W=(be=i[(U=z[G])[0]][U[1]]).value-b[U[1]].value;W=isNaN(W)?0:W,"DifferenceFrom"===u?be.formattedText=0===W?this.emptyCellTextContent:this.getFormattedValue(W,p).formattedText:(W=0===b[U[1]].value?0:W/b[U[1]].value,be.formattedText=0!==W?this.globalize.formatNumber(W,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent)}}else{if(A){F=c.split("."),L=v.length;for(var Q=0;Q<L;Q++){P=!1;if(void 0!==v[Q]){if(-1!==v[Q].valueSort.levelName.toString().split(".").indexOf(F[F.length-1])&&v[Q].level===m.level){for(var Y=0,X=S;Y<X.length;Y++){"value"===(be=i[U=X[Y]][Q]).axis&&be.actualText===p&&(P=!0,f.push([U,Q]),n[U+","+Q]&&delete n[U+","+Q])}if(P)break}}}}else for(var K=0,Z=d;K<Z.length;K++){V=Z[K];var L=v.length;for(O=0;O<L;O++){var P=!1;if(void 0!==v[O]&&v[O].valueSort[V.valueSort.levelName]&&v[O].level===m.level&&"grand sum"!==v[O].type){for(var J=0,$=S;J<$.length;J++){"value"===(be=i[U=$[J]][O]).axis&&be.actualText===p&&(P=!0,f.push([U,O]),n[U+","+O]&&delete n[U+","+O])}if(P)break}}}for(var ee=0,te=f;ee<te.length;ee++){W=(be=i[(U=te[ee])[0]][U[1]]).value-C[U[0]].value;W=isNaN(W)?0:W,"DifferenceFrom"===u?be.formattedText=0===W?this.emptyCellTextContent:this.getFormattedValue(W,p).formattedText:(W=0===C[U[0]].value?0:W/C[U[0]].value,be.formattedText=0!==W?this.globalize.formatNumber(W,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent)}}s.childMembers.length>0&&this.updateAggregates(e,t,i,s.childMembers,a,n);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(g){for(var ie=0,re=d;ie<re.length;ie++)for(V=re[ie],x=e.length,M=0;M<x;M++)if(void 0!==e[M]&&e[M].valueSort[V.valueSort.levelName]&&e[M].level===V.level)for(var ae=0,ne=a;ae<ne.length;ae++){U=ne[ae];"value"===(be=i[M+h][U]).axis&&be.actualText===p&&(f.push([M+h,U]),n[M+h+","+U]&&delete n[M+h+","+U])}for(var oe=0,le=f;oe<le.length;oe++){W=(be=i[(M=le[oe])[0]][M[1]]).value/b[M[1]].value;W=isNaN(W)?0:W,be.formattedText=0!==W?this.globalize.formatNumber(W,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent}}else{for(var se=0,de=d;se<de.length;se++){V=de[se],L=v.length;for(var pe=0;pe<L;pe++){P=!1;if(void 0!==v[pe]&&v[pe].valueSort[V.valueSort.levelName]){for(var he=0,ue=S;he<ue.length;he++){"value"===(be=i[U=ue[he]][pe]).axis&&be.actualText===p&&(P=!0,f.push([U,pe]),n[U+","+pe]&&delete n[U+","+pe])}if(P)break}}}for(var ce=0,ge=f;ce<ge.length;ce++){var me=(be=i[(M=ge[ce])[0]][M[1]]).value/C[M[0]].value;me=isNaN(me)?0:me,be.formattedText=0!==me?this.globalize.formatNumber(me,{format:"P",maximumFractionDigits:2}):this.emptyCellTextContent}}break;case"RunningTotals":if(g)for(var fe=0,ve=a;fe<ve.length;fe++){U=ve[fe],W=0;for(var ye=0,Se=d;ye<Se.length;ye++)for(V=Se[ye],x=e.length,q=0;q<x;q++)if(void 0!==e[q]){var be=i[q+h][U];if(void 0!==e[q]&&e[q].valueSort[V.valueSort.levelName]&&e[q].level===V.level&&"value"===be.axis&&be.actualText===p){"grand sum"!==e[q].type&&(W+=be.value,be.formattedText=this.getFormattedValue(W,p).formattedText),n[q+h+","+U]&&delete n[q+h+","+U];break}}}else for(x=e.length,w=0;w<x;w++)if(void 0!==e[w]){W=0;for(var Ce=0,xe=d;Ce<xe.length;Ce++)for(V=xe[Ce],L=v.length,O=0;O<L;O++){be=i[w+h][O];if(void 0!==v[O]&&v[O].valueSort[V.valueSort.levelName]&&"value"===be.axis&&be.actualText===p){"grand sum"!==v[O].type&&(W+=be.value,be.formattedText=this.getFormattedValue(W,p).formattedText),n[w+h+","+O]&&delete n[w+h+","+O];break}}}}}},e.prototype.recursiveRowData=function(e,t,i,r,a,n,o,l,s,d,p){o||this.getTableData(t[r-s].members,t,i,r,a,n,d,p),this.pageSettings||(t[r-s].members=[])},e.prototype.updateRowData=function(e,i,r,a,n,o,l,s,d,p,h){var u=this.fieldList[this.values[n].name].index,c=this.fieldList[this.values[n].name].aggregateType,g=this.values[n].name,m=[],f={},v=0;switch(c){case"Index":for(var y=["cVal","rTotalVal","cTotalVal","gTotalVal"],S=0,b=0,C=m=[[e[o],i[l]],[e[o],h],[p,i[l]],[p,h]];b<C.length;b++){var x=C[b];f[y[S]]=this.getAggregateValue(x[0].index,x[1].indexObject,u,c),S++}var w=f.cVal*f.gTotalVal/(f.rTotalVal*f.cTotalVal);v=!(e[o].members.length>0)||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showRowSubTotals&&this.showSubTotals?t.isNullOrUndefined(f.cVal)?f.cVal:isNaN(w)?0:w:void 0;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":(m=[[e[o],i[l]]]).push("PercentageOfGrandTotal"===c?[p,h]:"PercentageOfColumnTotal"===c?[p,i[l]]:[e[o],h]);y=["cVal","gTotalVal"],S=0;for(var T=0,M=m;T<M.length;T++){x=M[T];f[y[S]]=this.getAggregateValue(x[0].index,x[1].indexObject,u,c),S++}w=f.cVal/f.gTotalVal;v=!(e[o].members.length>0)||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?t.isNullOrUndefined(f.cVal)?f.cVal:isNaN(w)?0:w:void 0;break;default:v=!(e[o].members.length>0)||(t.isNullOrUndefined(e[o].showSubTotals)||e[o].showSubTotals)&&this.showSubTotals&&this.showRowSubTotals?this.getAggregateValue(e[o].index,i[l].indexObject,u,c):void 0}var D={fieldName:this.values[n].name,row:e[o],column:i[l],value:v,cellSets:this.getCellSet(this.rawIndexObject),rowCellType:e[o].hasChild&&e[o].isDrilled?"subTotal":"grand sum"===e[o].type?"grandTotal":"value",columnCellType:i[l].hasChild&&i[l].isDrilled?"subTotal":"grand sum"===i[l].type?"grandTotal":"value",aggregateType:c,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(D),v=D.value;var E=e[o].hasChild||i[l].hasChild||"grand sum"===e[o].type||"grand sum"===i[l].type,L=e[o].members.length>0&&(!t.isNullOrUndefined(e[o].showSubTotals)&&!e[o].showSubTotals||!this.showSubTotals||!this.showRowSubTotals),O=L?"":void 0===v?this.emptyCellTextContent:"Count"===c?v.toLocaleString():this.getFormattedValue(v,g).formattedText;!isNaN(v)&&!t.isNullOrUndefined(v)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(c)>=0?O=this.globalize.formatNumber(v,{format:"P",maximumFractionDigits:2}):L||!isNaN(v)||t.isNullOrUndefined(v)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(c)||(O="#DIV/0!"),O=D.skipFormatting?t.isNullOrUndefined(v)?this.emptyCellTextContent:v.toString():O,a[r][s]=this.valueContent[d][s]={axis:"value",actualText:g,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===e[o].type?"":e[o].valueSort.levelName,columnHeaders:"grand sum"===i[l].type?"":i[l].valueSort.levelName,formattedText:O,value:t.isNullOrUndefined(v)?0:v,rowIndex:r,colIndex:s,isSum:E},this.rawIndexObject={}},e.prototype.getCellSet=function(e){for(var t=[],i=0,r=Object.keys(e);i<r.length;i++){var a=r[i];this.data[parseInt(a,10)]&&t.push(this.data[parseInt(a,10)])}return t},e.prototype.getHeaderData=function(e,i,r,a,n){for(var o=e.length,l=this.columns.length,s=this.valueSortSettings.headerText,d=0;d<o;d++){e[d].members.length&&this.getHeaderData(e[d].members,i,r,a,n);var p=!0;(t.isNullOrUndefined(e[d].showSubTotals)||e[d].showSubTotals)&&this.showSubTotals&&this.showColumnSubTotals?i[a=i.length]=this.frameHeaderWithKeys(e[d]):(e[d].members.length>0?(this.removeCount++,p=!1):i[i.length]=this.frameHeaderWithKeys(e[d]),a=i.length-1);var h=e[d].level;e[d].rowIndex=h,e[d].colIndex=a*n+n,r[h]?r[h][a*n+n]=this.headerContent[h][a*n+n]=this.frameHeaderWithKeys(e[d]):(r[h]=[],this.headerContent[h]={},r[h][a*n+n]=this.headerContent[h][a*n+n]=this.frameHeaderWithKeys(e[d]));var u=0===this.columns.length&&1===this.values.length;if((this.isMutiMeasures||this.alwaysShowValueHeader||u)&&!this.valueAxis&&p)for(var c=0;c<n;c++){var g=this.values[c].caption?this.values[c].caption:this.values[c].name,m={axis:"column",actualText:this.values[c].name,formattedText:g,level:0,valueSort:{},colIndex:a*n+1+c,rowIndex:l};r[l]?r[l][a*n+1+c]=this.headerContent[l][a*n+1+c]=m:(r[l]=[],this.headerContent[l]={},r[l][a*n+1+c]=this.headerContent[l][a*n+1+c]=m);var f=r[l][a*n+1+c].valueSort;f[e[d].valueSort.levelName+this.valueSortSettings.headerDelimiter+g]=1,f.levelName=e[d].valueSort.levelName+this.valueSortSettings.headerDelimiter+g,f&&f[s]&&(this.valueSortSettings.columnIndex=a*n+1+c)}else e[d].valueSort&&e[d].valueSort[s]&&(this.valueSortSettings.columnIndex=a*n+1);this.pageSettings||(i[a].members=[])}},e.prototype.getAggregateValue=function(e,i,r,a){e.length;var n=0,o=0,l=0,s=!0,d=!1;if(a&&"count"===a.toLowerCase())for(;void 0!==e[n];)void 0!==i[e[n]]&&(d=!0,this.rawIndexObject[e[n]]=e[n],o+=t.isNullOrUndefined(this.valueMatrix[e[n]][r])?0:1),n++;else if(a&&"distinctcount"===a.toLowerCase())for(var p=[];void 0!==e[n];){if(void 0!==i[e[n]]){this.rawIndexObject[e[n]]=e[n],d=!0;var h=this.valueMatrix[e[n]][r];t.isNullOrUndefined(h)||(0===p.length||p.length>0&&-1===p.indexOf(h))&&(o+=1,p.push(h))}n++}else if(a&&"product"===a.toLowerCase())for(;void 0!==e[n];){if(void 0!==i[e[n]]){this.rawIndexObject[e[n]]=e[n],d=!0;h=this.valueMatrix[e[n]][r];t.isNullOrUndefined(h)?s&&(o=h):(o=s||t.isNullOrUndefined(o)?1:o,o*=h),s=!1}n++}else if(a&&-1!==["populationstdev","samplestdev","populationvar","samplevar"].indexOf(a.toLowerCase())){for(var u=0,c=0,g=[],m=0,f=0,v=0;void 0!==e[n];){if(void 0!==i[e[n]]){d=!0,this.rawIndexObject[e[n]]=e[n];h=this.valueMatrix[e[n]][r];t.isNullOrUndefined(h)||(c+=h,g.push(h),u++)}n++}if(u>0){m=c/u;for(var y=0,S=g;y<S.length;y++){var b=S[y];v+=Math.pow(b-m,2)}o=0===(f=-1!==["populationstdev","samplestdev"].indexOf(a.toLowerCase())?Math.sqrt(v/("populationstdev"===a.toLowerCase()?u:u-1)):v/("populationvar"===a.toLowerCase()?u:u-1))?NaN:f}else o=c}else if(a&&"min"===a.toLowerCase()){var C=!0;for(o=void 0;void 0!==e[n];)void 0!==i[e[n]]&&void 0!==this.valueMatrix[e[n]][r]&&(d=!0,this.rawIndexObject[e[n]]=e[n],t.isNullOrUndefined(o)&&t.isNullOrUndefined(this.valueMatrix[e[n]][r])?o=this.valueMatrix[e[n]][r]:C?(o=this.valueMatrix[e[n]][r],C=!1):o=this.valueMatrix[e[n]][r]<o?this.valueMatrix[e[n]][r]:o),n++}else if(a&&"max"===a.toLowerCase())for(var x=!0;void 0!==e[n];)void 0!==i[e[n]]&&void 0!==this.valueMatrix[e[n]][r]&&(d=!0,this.rawIndexObject[e[n]]=e[n],x?(o=this.valueMatrix[e[n]][r],x=!1):o=this.valueMatrix[e[n]][r]>o?this.valueMatrix[e[n]][r]:o),n++;else if(a&&"calculatedfield"===a.toLowerCase())for(;void 0!==e[n];){if(void 0!==i[e[n]]){d=!0,this.rawIndexObject[e[n]]=e[n];var w=this.calculatedFields[this.fields[r]],T=w.formula,M={};if(this.calculatedFormulas[w.name])for(var D=this.calculatedFormulas[w.name],E=0,L=D.length;E<L;E++){var O=D[E],P=M[O.formula];if(void 0===P){var N=O.type;P=this.getAggregateValue(e,i,O.index,N),M[O.formula]=P}T=T.replace(O.formula,String(P))}(o=this.evaluate(T))===1/0||void 0===o||isNaN(o)||JSON.parse(String(o))}n++}else for(o=void 0;void 0!==e[n];){if(void 0!==i[e[n]]){d=!0,this.rawIndexObject[e[n]]=e[n];h=this.valueMatrix[e[n]][r];t.isNullOrUndefined(o)&&t.isNullOrUndefined(h)?o=h:(t.isNullOrUndefined(o)&&(o=0),o+=t.isNullOrUndefined(h)?0:h),t.isNullOrUndefined(h)||l++}n++}return a&&"avg"===a.toLowerCase()&&0!==o&&!t.isNullOrUndefined(o)?o/l:d?o:void 0},e.prototype.evaluate=function(e){return Function('"use strict";return ('+e+")")()},e.prototype.getFormattedValue=function(e,i){var r=null===e?this.localeObj?this.localeObj.getConstant("null"):String(e):void 0===e?this.localeObj?i in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(e):e,a={formattedText:r.toString(),actualText:r,dateText:r};if(this.formatFields[i]&&e){var n=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i],o=t.extend({},n,null,!0);delete o.name,!o.minimumSignificantDigits&&o.minimumSignificantDigits<1&&delete o.minimumSignificantDigits,!o.maximumSignificantDigits&&o.maximumSignificantDigits<1&&delete o.maximumSignificantDigits,o.type?a.formattedText=this.dateFormatFunction[i].exactFormat(new Date(e)):a.formattedText=this.globalize.formatNumber(e,o),a.actualText=e,"None"!==this.fieldList[i].sort&&o.type&&["date","dateTime","time"].indexOf(this.formatFields[i].type)>-1&&(a.dateText=this.dateFormatFunction[i].fullFormat(new Date(e)))}return a},e.prototype.powerFunction=function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,function(e,i){return t.push(i),"~"+(t.length-1)});for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return e},e}(),f="enginePopulating",v="enginePopulated",y="beforeExport",S="excelHeaderQueryCellInfo",b="pdfHeaderQueryCellInfo",C="excelQueryCellInfo",x="pdfQueryCellInfo",w="onPdfCellRender",T="dataBound",M="hyperlinkCellClick",D="beforeColumnsRender",E="cellSelecting",L="beginDrillThrough",O="saveReport",P="chartTooltipRender",N="chartAxisLabelRender",I="chartSeriesCreated",A="aggregateCellInfo",F="contextMenuClick",q="fieldListRefreshed",R="conditionalFormatCreating",j="initial-load",k="ui-update",H="content-ready",V="data-ready",_="init-groupingbar",B="tree-view-update",U="pivot-button-update",G="init-calculatedfield",z="init-toolbar",W="init-formatting",Q="e-pivotfieldlist",Y="e-rtl",X="e-device",K="e-icons",Z="e-disable",J="e-dropdown-icon",$="e-pivotfieldlist-wrapper",ee="e-toggle-field-list",te="e-field-list",ie="e-field-list-tree",re="e-field-list-footer",ae="e-flat e-primary",ne="e-left-axis-fields",oe="e-right-axis-fields",le="e-axis-content",se="e-draggable-prompt",de="e-pvt-btn-div",pe="e-pivot-button",he="e-descend",ue="e-btn-filter",ce="e-pv-filter",ge="e-pv-filtered",me="e-remove",fe="e-drop-indicator",ve="e-drop-hover",ye="e-member-editor-wrapper",Se="e-member-editor-container",be="e-drillthrough-body-header",Ce="e-drillthrough-body-header-common",xe="e-drillthrough-body-header-value",we="e-ok-btn",Te="e-cancel-btn",Me="e-pivot-error-dialog",De="e-droppable",Ee="e-rows",Le="e-columns",Oe="e-values",Pe="e-filters",Ne="e-grouping-bar",Ie="e-group-rows",Ae="e-group-columns",Fe="e-group-values",qe="e-group-filters",Re="e-drag-restrict",je="e-list-selected",ke="e-text-content",He="e-field-list-btn",Ve="e-calculated-field-btn",_e="e-add-icon",Be="e-list-text",Ue="e-selected-node",Ge="e-selected-option-icon",ze="e-between-text-div",We="e-filter-input-div-2",Qe="e-value-options",Ye="e-filter-operator",Xe="e-collapse",Ke="e-expand",Ze="e-table",Je="e-columnsheader",$e="e-rowsheader",et="e-cellvalue",tt="e-tooltipheader",it="e-tooltipcontent",rt="e-nextspan",at="e-editor-search-wrapper",nt="e-pivot-calc-input",ot="e-member-options",lt="e-format",st="e-pivot-formula",dt="e-pivot-treeview",pt="e-pivot-treeview-outer",ht="e-pivot-ok-button",ut="e-pivot-button-div",ct="e-pivot-all-field-title",gt="e-disabled",mt="e-menu-hide",ft="e-member-prompt",vt="e-edit",yt="e-edited",St="e-empty-field",bt="e-pivot-formatting-dialog",Ct="e-format-condition-button",xt="e-input",wt="e-format-color-picker",Tt="e-virtualtrack",Mt="e-movablecontent",Dt="e-frozencontent",Et="e-movableheader",Lt="e-cellselectionbackground",Ot="e-selectionbackground",Pt="e-field-list-back-icon",Nt="e-rowcell",It="e-active",At="e-spanclicked",Ft="e-rowselect",qt="e-gridheader",Rt="e-pivotview-pdf-export",jt="e-pivotview-excel-export",kt="e-pivotview-csv-export",Ht="e-pivotview-report-input",Vt="e-pivotchart",_t="e-group-chart-rows",Bt="e-group-chart-values",Ut="e-group-chart-values-drodown-div",Gt="e-group-chart-values-drodown",zt="e-pivotview-disable-icon",Wt="e-pivotview-select-icon",Qt="e-pivot-grouping-bar",Yt="e-pivot-format-symbol-drop",Xt=function(){function e(e){this.parent=e}return e.prototype.render=function(e,t){this.parentElement=t,this.openContextMenu(e)},e.prototype.openContextMenu=function(e){void 0===this.menuInfo&&this.createContextMenu(),this.currentMenu=e.currentTarget;var t=this.currentMenu.getBoundingClientRect();this.parent.enableRtl?this.menuInfo.open(t.top,t.left-105):this.menuInfo.open(t.top,t.left)},e.prototype.createContextMenu=function(){var e={items:[{text:this.parent.localeObj.getConstant("Sum"),id:this.parent.element.id+"_Sum"},{text:this.parent.localeObj.getConstant("Count"),id:this.parent.element.id+"_Count"},{text:this.parent.localeObj.getConstant("DistinctCount"),id:this.parent.element.id+"_DistinctCount"},{text:this.parent.localeObj.getConstant("Product"),id:this.parent.element.id+"_Product"},{text:this.parent.localeObj.getConstant("Avg"),id:this.parent.element.id+"_Avg"},{text:this.parent.localeObj.getConstant("Min"),id:this.parent.element.id+"_Min"},{text:this.parent.localeObj.getConstant("Max"),id:this.parent.element.id+"_Max"},{text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"}],enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this),select:this.selectOptionInContextMenu.bind(this)},i=document.getElementById(this.parent.element.id+"valueFieldContextMenu");null!==i&&(i.innerHTML="");var r=t.createElement("ul",{id:this.parent.element.id+"valueFieldContextMenu"});this.parent.element.appendChild(r),this.menuInfo=new n.ContextMenu(e),this.menuInfo.isStringTemplate=!0,this.menuInfo.appendTo(r)},e.prototype.beforeMenuOpen=function(e){e.element.style.zIndex=(this.menuInfo.element.style.zIndex+3).toString(),e.element.style.display="inline"},e.prototype.createValueSettingsDialog=function(e,i){var a=this;this.parentElement=i;var n=t.createElement("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":e.id}});this.parentElement.appendChild(n),this.valueDialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(e),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:we,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){a.valueDialog.hide()},buttonModel:{cssClass:Te,content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parentElement,overlayClick:function(){a.removeDialog()},close:this.removeDialog.bind(this)}),this.valueDialog.isStringTemplate=!0,this.valueDialog.appendTo(n)},e.prototype.createFieldOptions=function(e){var i=e.getAttribute("data-caption"),r=e.getAttribute("data-type"),a=e.getAttribute("data-basefield"),n=e.getAttribute("data-baseitem");r="undefined"!==r.toString()?r:"Sum";for(var s=[{value:"Sum",text:this.parent.localeObj.getConstant("Sum")},{value:"Count",text:this.parent.localeObj.getConstant("Count")},{value:"DistinctCount",text:this.parent.localeObj.getConstant("DistinctCount")},{value:"Product",text:this.parent.localeObj.getConstant("Product")},{value:"Avg",text:this.parent.localeObj.getConstant("Avg")},{value:"Min",text:this.parent.localeObj.getConstant("Min")},{value:"Max",text:this.parent.localeObj.getConstant("Max")},{value:"Index",text:this.parent.localeObj.getConstant("Index")},{value:"SampleStDev",text:this.parent.localeObj.getConstant("SampleStDev")},{value:"PopulationStDev",text:this.parent.localeObj.getConstant("PopulationStDev")},{value:"SampleVar",text:this.parent.localeObj.getConstant("SampleVar")},{value:"PopulationVar",text:this.parent.localeObj.getConstant("PopulationVar")},{value:"RunningTotals",text:this.parent.localeObj.getConstant("RunningTotals")},{value:"DifferenceFrom",text:this.parent.localeObj.getConstant("DifferenceFrom")},{value:"PercentageOfDifferenceFrom",text:this.parent.localeObj.getConstant("PercentageOfDifferenceFrom")},{value:"PercentageOfGrandTotal",text:this.parent.localeObj.getConstant("PercentageOfGrandTotal")},{value:"PercentageOfColumnTotal",text:this.parent.localeObj.getConstant("PercentageOfColumnTotal")},{value:"PercentageOfRowTotal",text:this.parent.localeObj.getConstant("PercentageOfRowTotal")},{value:"PercentageOfParentTotal",text:this.parent.localeObj.getConstant("PercentageOfParentTotal")},{value:"PercentageOfParentColumnTotal",text:this.parent.localeObj.getConstant("PercentageOfParentColumnTotal")},{value:"PercentageOfParentRowTotal",text:this.parent.localeObj.getConstant("PercentageOfParentRowTotal")}],d=["DifferenceFrom","PercentageOfDifferenceFrom"],p=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],h=t.extend([],this.parent.dataSourceSettings.rows,null,!0),u=[],c=[],g=0,m=h=h.concat(this.parent.dataSourceSettings.columns);g<m.length;g++){var f=m[g],v=f.name,y=f.caption?f.caption:f.name;u.push({value:v,text:y})}a="undefined"!==a.toString()?a:u[0].value,c=Object.keys(this.parent.engineModule.fieldList["undefined"!==a.toString()?a:u[0].value].formattedMembers),n="undefined"!==n.toString()?n:c[0];var S=t.createElement("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":r,"data-caption":i,"data-basefield":a,"data-baseitem":n}}),b=t.createElement("div",{className:"e-field-name-text-wrapper"}),C=t.createElement("div",{className:"e-field-option-wrapper"}),x=t.createElement("div",{className:"e-type-option-wrapper"}),w=t.createElement("div",{className:"e-base-field-option-wrapper"}),T=t.createElement("div",{className:"e-base-item-option-wrapper"}),M=t.createElement("div",{className:"e-field-name-title",innerHTML:this.parent.localeObj.getConstant("sourceName")+"&nbsp;"}),D=t.createElement("div",{className:"e-field-name-content",innerHTML:e.id.toString()}),E=t.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("sourceCaption")}),L=t.createElement("div",{className:"e-base-field-option-text",innerHTML:this.parent.localeObj.getConstant("summarizeValuesBy")}),O=t.createElement("div",{className:"e-base-item-option-text",innerHTML:this.parent.localeObj.getConstant("baseField")}),P=t.createElement("div",{className:"e-type-option-text",innerHTML:this.parent.localeObj.getConstant("baseItem")}),N=t.createElement("div",{className:"e-caption-input-wrapper"}),I=t.createElement("div",{id:this.parentElement.id+"_type_option"}),A=t.createElement("div",{id:this.parentElement.id+"_base_field_option"}),F=t.createElement("div",{id:this.parentElement.id+"_base_item_option"}),q=t.createElement("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});b.appendChild(M),b.appendChild(D),N.appendChild(E),N.appendChild(q),x.appendChild(L),w.appendChild(O),T.appendChild(P),x.appendChild(I),w.appendChild(A),T.appendChild(F),C.appendChild(b),C.appendChild(N),C.appendChild(x),C.appendChild(w),C.appendChild(T),S.appendChild(C);var R=this,j=new l.DropDownList({dataSource:s,fields:{value:"value",text:"text"},value:r,cssClass:Qe,width:"100%",change:function(e){k.enabled=-1!==p.indexOf(e.value),H.enabled=-1!==d.indexOf(e.value),H.enabled&&1===H.dataSource.length&&(H.dataSource=c,H.dataBind())}});j.isStringTemplate=!0,j.appendTo(I);var k=new l.DropDownList({dataSource:u,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:a,enabled:-1!==p.indexOf(r),cssClass:Qe,width:"100%",change:function(e){c=Object.keys(R.parent.engineModule.fieldList[e.value].formattedMembers),H.dataSource=c,H.value=c[0],H.filterBarPlaceholder=R.parent.localeObj.getConstant("example")+" "+c[0],H.dataBind()}});k.isStringTemplate=!0,k.appendTo(A);var H=new l.DropDownList({dataSource:[c[0]],enableRtl:this.parent.enableRtl,value:n,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+c[0],enabled:-1!==d.indexOf(r),cssClass:Ye,width:"100%"});H.isStringTemplate=!0,H.appendTo(F);var V=new o.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,value:i,width:"100%"});return V.isStringTemplate=!0,V.appendTo(q),S},e.prototype.selectOptionInContextMenu=function(e){if(null!==e.item.text){var t=this.currentMenu.parentElement,i=e.item.id.split(this.parent.element.id+"_")[1];if("MoreOption"===i)this.createValueSettingsDialog(t,this.parentElement);else{var r=t.getAttribute("data-uid"),a=this.parent.dataSourceSettings.values,n=t.querySelector(".e-content"),o=e.item.text+" of "+this.parent.engineModule.fieldList[r].caption;n.innerHTML=o,n.setAttribute("title",o),t.setAttribute("data-type",i);for(var l=0;l<this.parent.dataSourceSettings.values.length;l++)if(this.parent.dataSourceSettings.values[l].name===r){var s=a[l].properties?a[l].properties:a[l];s.type=i,this.parent.lastAggregationInfo=s}this.updateDataSource()}}},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(k,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateValueSettings=function(){var e,i=this.valueDialog.element,r=t.getInstance("#"+this.parentElement.id+"type_input_option",o.MaskedTextBox),a=t.getInstance("#"+this.parentElement.id+"_type_option",l.DropDownList),n=t.getInstance("#"+this.parentElement.id+"_base_field_option",l.DropDownList),s=t.getInstance("#"+this.parentElement.id+"_base_item_option",l.DropDownList),d=i.getAttribute("data-field");if(this.parentElement.querySelector("."+pe)&&(e=this.parentElement.querySelector("."+pe+"."+d.replace(/[^A-Z0-9]/gi,""))),e){var p=e.querySelector(".e-content"),h=this.parent.localeObj.getConstant(a.value)+" of "+r.value;p.innerHTML=h,p.setAttribute("title",h),e.setAttribute("data-type",a.value),e.setAttribute("data-caption",r.value),e.setAttribute("data-basefield",n.value),e.setAttribute("data-baseitem",s.value)}var u=this.parent.pivotCommon.eventBase.getFieldByName(d,this.parent.dataSourceSettings.values);(u=u.properties?u.properties:u).caption=r.value,u.type=a.value,u.baseField=n.value,u.baseItem=s.value,this.valueDialog.close(),this.parent.lastAggregationInfo=u,this.updateDataSource(!0)},e.prototype.removeDialog=function(){this.valueDialog&&!this.valueDialog.isDestroyed&&this.valueDialog.destroy(),document.getElementById(this.parentElement.id+"_ValueDialog")&&t.remove(document.getElementById(this.parentElement.id+"_ValueDialog"))},e.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&!this.menuInfo.isDestroyed&&this.menuInfo.destroy()},e}(),Kt=function(){function e(e){this.indentCollection={},this.colPos=0,this.lastSpan=0,this.lvlCollection={},this.hierarchyCollection={},this.lvlPosCollection={},this.hierarchyPosCollection={},this.position=0,this.measurePos=0,this.maxMeasurePos=0,this.hierarchyCount=0,this.actualText="",this.parent=e,this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=e.gridSettings,this.formatList=this.getFormatList(),this.aggMenu=new Xt(this.parent)}return e.prototype.render=function(){var e=this.parent,i="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;if(this.parent.gridHeaderCellInfo=[],this.parent.gridCellCollection={},this.injectGridModules(e),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid")){i.isEngineUpdated?(this.parent.enableValueSorting&&(i.valueContent=this.frameDataSource("value")),i.isEngineUpdated=!1):(i.headerContent=this.frameDataSource("header"),i.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:e.dataSourceSettings.values.length>0&&!this.engine.isEmptyData?i.valueContent:this.frameDataSource("value")},!0),this.parent.grid.notify("datasource-modified",{}),this.parent.isScrolling&&(this.parent.resizeInfo={}),this.parent.grid.refreshColumns(),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ne)&&this.parent.groupingBarModule.setGridRowWidth();this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML,this.parent.grid.width=this.calculateGridWidth(),this.parent.isScrolling||this.calculateGridHeight(!0)}else this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild(t.createElement("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo("#"+this.parent.element.id+"_grid");this.parent.grid.on(a.headerRefreshed,this.refreshHeader,this)},e.prototype.refreshHeader=function(){if(this.parent.enableVirtualization){var e=this.parent.element.querySelector("."+Et),i=this.parent.element.querySelector("."+Mt),r=i.querySelector("."+Tt);this.parent.virtualHeaderDiv=e.querySelector("."+Tt),e.querySelector("."+Tt)?t.remove(e.querySelector("."+Tt)):this.parent.virtualHeaderDiv=t.createElement("div",{className:Tt}),e.appendChild(this.parent.virtualHeaderDiv),r&&t.setStyleAttribute(this.parent.virtualHeaderDiv,{height:0,width:r.style.width}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:i.querySelector(".e-table").style.transform.split(",")[0]+",0px)"}),e.scrollLeft=i.scrollLeft}},e.prototype.bindGrid=function(e,t){this.injectGridModules(e),this.parent.grid=new a.Grid({frozenColumns:1,frozenRows:0,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.parent.width:this.calculateGridWidth(),locale:e.locale,enableRtl:e.enableRtl,allowExcelExport:e.allowExcelExport,allowPdfExport:e.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,allowReordering:this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this)}),this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this))},e.prototype.headerRefreshed=function(e){this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&(this.parent.lastGridSettings=void 0,this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ne)&&this.parent.groupingBarModule.setGridRowWidth())},e.prototype.rowSelected=function(e){this.parent.renderModule.selected(),this.parent.trigger("rowSelected",e)},e.prototype.rowDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger("rowDeselected",e)},e.prototype.cellSelected=function(e){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger("selected",e))},e.prototype.cellSelecting=function(e){this.parent.trigger(E,e)},e.prototype.cellDeselected=function(e){this.parent.renderModule.selected(),this.parent.trigger("cellDeselected",e)},e.prototype.queryCellInfo=function(e){this.parent.renderModule.rowCellBoundEvent(e)},e.prototype.headerCellInfo=function(e){this.parent.renderModule.columnCellBoundEvent(e)},e.prototype.excelHeaderQueryCellInfo=function(e){this.parent.renderModule.excelColumnEvent(e)},e.prototype.pdfQueryCellInfo=function(e){this.parent.renderModule.pdfRowEvent(e)},e.prototype.excelQueryCellInfo=function(e){this.parent.renderModule.excelRowEvent(e)},e.prototype.pdfHeaderQueryCellInfo=function(e){this.parent.renderModule.pdfColumnEvent(e)},e.prototype.dataBound=function(e){if(this.parent.cellTemplate&&!t.isBlazor){for(var i=0,r=this.parent.gridHeaderCellInfo;i<r.length;i++){var a=r[i];this.parent.cellTemplate&&t.append([].slice.call(this.parent.getCellTemplate()(a,this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate")),a.targetCell)}this.parent.gridHeaderCellInfo=[]}this.parent.element.querySelector(".e-firstcell")&&(this.parent.enableRtl?this.parent.element.querySelector(".e-firstcell").style.borderRight="none":this.parent.element.querySelector(".e-firstcell").style.borderLeft="none"),this.parent.grid.widthService.setWidthToTable(),this.parent.isEmptyGrid||this.calculateGridHeight(!0),"Chart"!==this.parent.currentView&&this.parent.grid.hideScroll(),this.parent.isScrolling=!1,this.parent.notify(H,{})},e.prototype.contextMenuOpen=function(e){for(var t=0,i=e.items;t<i.length;t++){var r=i[t],a=this.parent.lastCellClicked,n=null,o=void 0;a.classList.contains("e-stackedheadercelldiv")||a.classList.contains("e-cellvalue")||a.classList.contains("e-headercelldiv")||a.classList.contains("e-icons")||a.classList.contains("e-rhandler")?n=a.parentElement:a.classList.contains("e-headercell")||a.classList.contains("e-rowcell")||a.classList.contains("e-columnsheader")||a.classList.contains("e-rowsheader")||a.classList.contains("e-valuescontent")||a.classList.contains("e-valuesheader")?n=a:a.classList.contains("e-headertext")&&(n=a.parentElement.parentElement),(n.classList.contains("e-valuesheader")||n.classList.contains("e-stot"))&&(o=!0);var l=Number(n.getAttribute("index")),s=Number(n.getAttribute("aria-colindex"));this.parent.pivotValues[l][s];switch(r.id){case this.parent.element.id+"_expand":n.querySelectorAll("."+Ke).length>0?(e.element.querySelectorAll("#"+this.parent.element.id+"_expand")&&e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add(gt),e.element.querySelector("#"+this.parent.element.id+"_expand").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_expand").classList.remove(gt),e.element.querySelector("#"+this.parent.element.id+"_expand").classList.contains(mt)&&(e.element.querySelector("#"+this.parent.element.id+"_expand").classList.remove(mt),e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.remove(mt))):o?e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add(mt):e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add(gt);break;case this.parent.element.id+"_collapse":n.querySelectorAll("."+Xe).length>0?(e.element.querySelector("#"+this.parent.element.id+"_expand")&&e.element.querySelector("#"+this.parent.element.id+"_expand").classList.add(gt),e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.remove(gt),e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.contains(mt)&&(e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.remove(mt),e.element.querySelector("#"+this.parent.element.id+"_expand").classList.remove(mt))):o?e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.add(mt):e.element.querySelector("#"+this.parent.element.id+"_collapse").classList.add(gt);break;case this.parent.element.id+"_drillthrough":this.parent.allowDrillThrough?n.classList.contains("e-summary")?e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.remove(gt):""===n.innerText&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough")&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.add(gt):e.element.querySelector("#"+this.parent.element.id+"_drillthrough")&&e.element.querySelector("#"+this.parent.element.id+"_drillthrough").classList.add(gt);break;case this.parent.element.id+"_sortasc":this.parent.enableValueSorting?n.querySelectorAll(".e-icon-descending").length>0?(e.element.querySelector("#"+this.parent.element.id+"_sortdesc")?e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.add(gt):e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.remove(gt),e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.remove(gt)):e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.remove(gt):e.element.querySelector("#"+this.parent.element.id+"_sortasc")&&e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.add(gt);break;case this.parent.element.id+"_sortdesc":this.parent.enableValueSorting?n.querySelectorAll(".e-icon-ascending").length>0?(e.element.querySelector("#"+this.parent.element.id+"_sortasc")?e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.add(gt):e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.remove(gt),e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.remove(gt)):e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_sortasc").classList.remove(gt):e.element.querySelector("#"+this.parent.element.id+"_sortdesc")&&e.element.querySelector("#"+this.parent.element.id+"_sortdesc").classList.add(gt);break;case this.parent.element.id+"_CalculatedField":this.parent.allowCalculatedField||e.element.querySelector("#"+this.parent.element.id+"_CalculatedField").classList.add(gt);break;case this.parent.element.id+"_pdf":this.parent.allowPdfExport||e.element.querySelector("#"+this.parent.element.id+"_pdf").classList.add(gt);break;case this.parent.element.id+"_excel":this.parent.allowExcelExport||e.element.querySelector("#"+this.parent.element.id+"_excel").classList.add(gt);break;case this.parent.element.id+"_csv":this.parent.allowExcelExport||e.element.querySelector("#"+this.parent.element.id+"_csv").classList.add(gt);break;case this.parent.element.id+"_exporting":this.parent.allowExcelExport||this.parent.allowPdfExport||e.element.querySelector("#"+this.parent.element.id+"_exporting").classList.add(gt);break;case this.parent.element.id+"_aggregate":""===n.innerText?e.element.querySelector("#"+this.parent.element.id+"_aggregate")&&e.element.querySelector("#"+this.parent.element.id+"_aggregate").classList.add(gt):e.element.querySelector("#"+this.parent.element.id+"_aggregate").classList.contains(gt)&&e.element.querySelector("#"+this.parent.element.id+"_aggregate").classList.remove(gt)}}this.parent.trigger("contextMenuOpen",e)},e.prototype.contextMenuClick=function(e){var t=this.parent.lastCellClicked,i=e.item.id,r=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),a=null;t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-icons")||t.classList.contains("e-rhandler")?a=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?a=t:t.classList.contains("e-headertext")&&(a=t.parentElement.parentElement);var n=Number(a.getAttribute("index")),o=Number(a.getAttribute("aria-colindex")),l=this.parent.pivotValues[n][o];switch(e.item.id!==this.parent.element.id+"_AggSum"&&e.item.id!==this.parent.element.id+"_AggProduct"&&e.item.id!==this.parent.element.id+"_AggCount"&&e.item.id!==this.parent.element.id+"_AggDistinctCount"&&e.item.id!==this.parent.element.id+"_AggAvg"&&e.item.id!==this.parent.element.id+"_AggMin"&&e.item.id!==this.parent.element.id+"_AggMax"&&e.item.id!==this.parent.element.id+"_AggMoreOption"||(this.field=this.parent.engineModule.fieldList[l.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[l.actualText.toString()].caption),i){case this.parent.element.id+"_pdf":this.parent.pdfExport();break;case this.parent.element.id+"_excel":this.parent.excelExport();break;case this.parent.element.id+"_csv":this.parent.csvExport();break;case this.parent.element.id+"_drillthrough_menu":a.dispatchEvent(r);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:l.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:l.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}}),this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(a.querySelectorAll("."+Ke)){var s=a.querySelectorAll("."+Ke)[0];this.parent.onDrill(s)}break;case this.parent.element.id+"_collapse":if(a.querySelectorAll("."+Xe)){var d=a.querySelectorAll("."+Xe)[0];this.parent.onDrill(d)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggSum":this.updateAggregate("Sum");break;case this.parent.element.id+"_AggProduct":this.updateAggregate("Product");break;case this.parent.element.id+"_AggCount":this.updateAggregate("Count");break;case this.parent.element.id+"_AggDistinctCount":this.updateAggregate("DistinctCount");break;case this.parent.element.id+"_AggAvg":this.updateAggregate("Avg");break;case this.parent.element.id+"_AggMin":this.updateAggregate("Min");break;case this.parent.element.id+"_AggMax":this.updateAggregate("Max");break;case this.parent.element.id+"_AggMoreOption":a.setAttribute("id",this.field),a.setAttribute("data-caption",this.fieldCaption),a.setAttribute("data-field",this.field),a.setAttribute("data-type",this.engine.fieldList[l.actualText.toString()].aggregateType),a.setAttribute("data-basefield",this.engine.fieldList[l.actualText.toString()].baseField),a.setAttribute("data-baseItem",this.engine.fieldList[l.actualText.toString()].baseItem),this.aggMenu.createValueSettingsDialog(a,this.parent.element)}this.parent.trigger(F,e)},e.prototype.updateAggregate=function(e){for(var t=this.parent.dataSourceSettings.values,i=0;i<this.parent.dataSourceSettings.values.length;i++)if(this.parent.dataSourceSettings.values[i].name===this.field){t[i].type=e}},e.prototype.injectGridModules=function(e){a.Grid.Inject(a.Freeze),e.allowExcelExport&&a.Grid.Inject(a.ExcelExport),e.allowPdfExport&&a.Grid.Inject(a.PdfExport),a.Grid.Inject(a.Selection,a.Reorder,a.Resize),this.gridSettings.contextMenuItems&&a.Grid.Inject(a.ContextMenu)},e.prototype.updateGridSettings=function(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){var e=Object.keys(this.parent.lastGridSettings);e.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height),e.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width),this.updatePivotColumns()}this.clearColumnSelection()},e.prototype.updatePivotColumns=function(){for(var e=Object.keys(this.parent.lastGridSettings),i=0;i<this.parent.pivotColumns.length;i++)for(var r=this.parent.pivotColumns[i],a=0;a<e.length;a++){var n=e[a];t.isNullOrUndefined(this.parent.pivotColumns[i][n])||(r[n]=this.parent.lastGridSettings[n])}this.parent.fillGridColumns(this.parent.grid.columns)},e.prototype.clearColumnSelection=function(){this.parent.element.querySelectorAll("."+It).forEach(function(e){e.classList.remove(It),e.classList.remove(Ot)})},e.prototype.appendValueSortIcon=function(e,i,r,a){if(this.parent.enableValueSorting){var n=this.parent.dataSourceSettings.valueSortSettings,o="grand sum"!==e.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.engineModule.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:this.parent.engineModule.headerContent.length-1:0,l=n&&n.headerText?e.valueSort.levelName===n.headerText:a===n.columnIndex;if(void 0!==n&&l&&r===o&&"column"===this.parent.dataSourceSettings.valueAxis&&(i.querySelector(".e-sortfilterdiv")?(i.querySelector(".e-sortfilterdiv").classList.add("Descending"===n.sortOrder?"e-descending":"e-ascending"),i.querySelector(".e-sortfilterdiv").classList.add("Descending"===n.sortOrder?"e-icon-descending":"e-icon-ascending")):i.appendChild(t.createElement("div",{className:"Descending"===n.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv"})),!t.isNullOrUndefined(e.hasChild)&&"grand sum"!==e.type&&i.querySelector(".e-expand")&&(i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending")))){var s=i.querySelector(".e-icon-descending")||i.querySelector(".e-icon-ascending");t.setStyleAttribute(s,{"padding-top":"12px"})}}return i},e.prototype.onResizeStop=function(e){var t="0.formattedText"===e.column.field?"0.formattedText":e.column.customAttributes.cell.valueSort.levelName;this.parent.resizeInfo[t]=Number(e.column.width.toString().split("px")[0]),this.setGroupWidth(e),this.calculateGridHeight(!0),this.parent.grid.hideScroll()},e.prototype.setGroupWidth=function(e){if(this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+Ne)){if(this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth){e.cancel=!0;var t=this.parent.grid.columns;t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width=this.resColWidth+"px"}this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px";var i=this.parent.element.querySelector(".e-headercontent").offsetHeight;this.parent.element.querySelector(".e-group-rows").style.height=i+"px"}this.parent.trigger("touchend"===e.e.type||"mouseup"===e.e.type?"resizeStop":"resizing",e)},e.prototype.selected=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.onSelect.bind(this),300)},e.prototype.onSelect=function(){for(var e={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},t=0,i=this.parent.element.querySelectorAll("."+Lt+",."+Ot);t<i.length;t++){var r=i[t],a=Number(r.getAttribute("aria-colindex")),n=Number(r.getAttribute("index")),o=this.engine.pivotValues[n][a];o&&("value"===o.axis?e.selectedCellsInfo.push({currentCell:o,value:o.value,columnHeaders:o.columnHeaders,rowHeaders:o.rowHeaders,measure:o.actualText.toString()}):"column"===o.axis?e.selectedCellsInfo.push({currentCell:o,value:o.formattedText,columnHeaders:o.valueSort.levelName,rowHeaders:"",measure:""}):e.selectedCellsInfo.push({currentCell:o,value:o.formattedText,columnHeaders:"",rowHeaders:o.valueSort.levelName,measure:""}))}this.parent.trigger("cellSelected",e)},e.prototype.rowCellBoundEvent=function(e){var i=e.cell;if(i&&!this.parent.isEmptyGrid){var r=this.parent.hyperlinkSettings.cssClass;i.setAttribute("index",(Number(i.getAttribute("index"))+this.engine.headerContent.length).toString());var a=e.data[0];if("0"===i.getAttribute("aria-colindex")){if("pivot"===this.parent.dataType){var n=a.type&&"value"===a.type;i.innerText="";var o=a.level?a.level:n?this.lastSpan+1:0;do{o>0&&i.appendChild(t.createElement("span",{className:0===o?"":rt})),o--}while(o>-1);o=a.level?a.level:0,this.lastSpan=n?this.lastSpan:o,!a.hasChild&&o>0&&i.appendChild(t.createElement("span",{className:"e-lastspan"}));var l=void 0;this.parent.dataSourceSettings.rows.length>0&&(!a.valueSort||Object.keys(a.valueSort).length>0)&&(l=o>-1?this.parent.dataSourceSettings.rows[o].name:"",i.setAttribute("fieldname",l))}else i=this.onOlapRowCellBoundEvent(i,a);var s=a.formattedText;a.type&&("grand sum"===a.type?(i.classList.add("e-gtot"),s=this.parent.localeObj.getConstant("grandTotal")):i.classList.add("e-stot")),i.classList.add($e),!0===a.hasChild&&i.appendChild(t.createElement("div",{className:(!0===a.isDrilled?Xe:Ke)+" "+K,attrs:{title:!0===a.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}})),i.appendChild(t.createElement("span",{className:et,innerHTML:this.parent.isRowCellHyperlink||a.enableHyperlink?'<a  data-url="'+s+'" class="e-hyperlinkcell '+r+'">'+s+"</a>":s}));var d=this.parent.pivotView.dataSourceSettings.valueSortSettings;if(this.parent.enableValueSorting&&d&&d.headerText&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(i.getAttribute("index"))][0].valueSort.levelName===d.headerText){var p=i.querySelector(".e-expand")||i.querySelector(".e-collapse")?"padding-top: 18px":"padding-top: 12px";i.appendChild(t.createElement("div",{className:"Descending"===d.sortOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv":"e-icon-ascending e-icons e-ascending e-sortfilterdiv",styles:p}))}}else{var h=i.innerText;i.innerText="",i.classList.add("e-valuescontent"),(a=e.data[Number(i.getAttribute("aria-colindex"))]).isSum&&i.classList.add("e-summary"),a.cssClass&&i.classList.add(a.cssClass),i.appendChild(t.createElement("span",{className:et,innerHTML:-1!==i.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===i.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||a.enableHyperlink?'<a data-url="'+h+'" class="e-hyperlinkcell '+r+'">'+h+"</a>":h})),this.parent.gridSettings.allowReordering&&i.setAttribute("aria-colindex",e.column.customAttributes.cell.colIndex.toString())}if(this.parent.cellTemplate){var u=i.getAttribute("index"),c=i.getAttribute("aria-colindex"),g=u+"_"+c;window&&t.isBlazor?u&&c&&(this.parent.gridCellCollection[g]=i):t.append([].slice.call(this.parent.getCellTemplate()({targetCell:i},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate")),i)}this.unWireEvents(i),this.wireEvents(i)}e.pivotview=this.parent,this.parent.trigger("queryCellInfo",e)},e.prototype.onOlapRowCellBoundEvent=function(e,i){e.innerText="";var r=this.engine.rowMeasurePos,a=i.hierarchy,n=3===i.memberType?this.measurePos+"."+i.levelUniqueName:i.levelUniqueName,o=i.hasChild;if(!this.lvlCollection[n]&&n)this.lvlPosCollection[this.position]=n,this.lvlCollection[n]={position:this.position,hasChild:o},this.position++;else if(n){for(var l=this.lvlCollection[n].position,s=l+1;s<this.position;s++)delete this.lvlCollection[this.lvlPosCollection[s]],delete this.lvlPosCollection[s];this.position=this.position>l+1?l+1:this.position}if(!this.hierarchyCollection[a]&&a)this.hierarchyPosCollection[this.hierarchyCount]=a,this.hierarchyCollection[a]={lvlPosition:this.position-1,hierarchyPOs:this.hierarchyCount},this.hierarchyCount++;else if(a){var d=this.hierarchyCollection[a].hierarchyPOs;for(s=d+1;s<this.hierarchyCount;s++)delete this.hierarchyCollection[this.hierarchyPosCollection[s]],delete this.hierarchyPosCollection[s];this.hierarchyCount=this.hierarchyCount>d+1?d+1:this.hierarchyCount}if(3!==i.memberType&&n&&this.lvlCollection[n]){var p=this.hierarchyCollection[a]?this.hierarchyCollection[a].hierarchyPOs:-1;this.measurePos=r<=p&&this.hierarchyPosCollection[r+1]?this.measurePos:this.lvlCollection[n].position}for(var h=this.lvlCollection[n]?this.lvlCollection[n].position:-1,u=0,c=0;u<=h&&h>0&&i.level>-1;){var g=this.lvlCollection[this.lvlPosCollection[u]].hasChild;u>0&&this.lvlCollection[this.lvlPosCollection[u-1]].hasChild&&!g&&e.appendChild(t.createElement("span",{className:"e-lastspan"})),u!==h&&(e.appendChild(t.createElement("span",{className:rt})),c++),u++}return 3===i.memberType&&-1===i.level&&Object.keys(this.lvlCollection).length>1&&(e.appendChild(t.createElement("span",{className:rt})),c++),this.indentCollection[i.rowIndex]=c,this.maxIndent=this.maxIndent>c?this.maxIndent:c,e.setAttribute("fieldname",i.hierarchy),e},e.prototype.columnCellBoundEvent=function(e){if(e.cell.column&&e.cell.column.customAttributes){var i=e.cell.column.customAttributes.cell,r=e.node;if(i){var a=this.parent.hyperlinkSettings.cssClass,n=i.level?i.level:0;-1===i.level&&!i.rowSpan&&i.rowIndex!==this.engine.headerContent.length-1||-1===i.rowSpan?e.node.style.display="none":i.rowSpan>1&&(e.node.setAttribute("rowspan",i.rowSpan.toString()),e.node.setAttribute("aria-rowspan",i.rowSpan.toString()),i.rowIndex+i.rowSpan===this.engine.headerContent.length&&(e.node.style.borderBottomWidth="0px")),e.node.setAttribute("aria-colindex",i.colIndex.toString()),e.node.setAttribute("index",i.rowIndex.toString());var o=void 0;if("pivot"===this.parent.dataType?!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&i.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(o=n>-1&&this.parent.dataSourceSettings.columns[n]?this.parent.dataSourceSettings.columns[n].name:"",r.setAttribute("fieldname",o)):r=this.onOlapColumnCellBoundEvent(r,i),i.type){r.classList.add("grand sum"===i.type?"e-gtot":"e-stot");var l="grand sum"===i.type?this.parent.localeObj.getConstant("grandTotal"):i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total");null!==r.querySelector(".e-headertext")?r.querySelector(".e-headertext").innerText=l:r.querySelector(".e-stackedheadercelldiv").innerText=l}if(r.classList.add(Je),this.parent.isColumnCellHyperlink||i.enableHyperlink)if(r.querySelector(".e-stackedheadercelldiv")){var s=r.querySelector(".e-stackedheadercelldiv").innerText;r.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+s+'" class="e-hyperlinkcell '+a+'">'+s+"</a>"}else if(r.querySelector(".e-headertext")){s=r.querySelector(".e-headertext").innerText;r.querySelector(".e-headertext").innerHTML='<a data-url="'+s+'" class="e-hyperlinkcell '+a+'">'+s+"</a>"}if(!0===i.hasChild){var d=r.querySelector(".e-headercelldiv");d&&(d.style.height="auto",d.style.lineHeight="normal");var p=t.createElement("div",{className:(!0===i.isDrilled?Xe:Ke)+" "+K,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}});r.children[0].classList.add(et),window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?r.children[0].style.display="table":r.children[0].style.display="block",r.insertBefore(p,r.children[0])}if(r=this.appendValueSortIcon(i,r,i.rowIndex,i.colIndex),this.parent.cellTemplate){var h=r.getAttribute("index"),u=r.getAttribute("aria-colindex"),c=h+"_"+u;window&&t.isBlazor?h&&u&&(this.parent.gridCellCollection[c]=r):this.parent.gridHeaderCellInfo.push({targetCell:r})}for(var g=this.parent.dataSourceSettings.values.length,m=0;m<g;m++)this.parent.dataSourceSettings.values[m].name===i.actualText&&r.classList.add("e-valuesheader");this.unWireEvents(r),this.wireEvents(r)}}this.parent.trigger("headerCellInfo",e)},e.prototype.onOlapColumnCellBoundEvent=function(e,t){e.setAttribute("fieldname",3===t.memberType?t.actualText.toString():t.hierarchy);var i=this.engine.headerContent[t.rowIndex]?this.engine.headerContent[t.rowIndex][t.colIndex-1]:void 0;return i&&i.actualText===t.actualText&&i.type===t.type&&(3===t.memberType||i.colSpan>1)?e.style.display="none":(e.setAttribute("colspan",t.colSpan.toString()),e.setAttribute("aria-colspan",t.colSpan.toString())),e},e.prototype.onHyperCellClick=function(e){var i=e.target.parentElement.parentElement,r={currentCell:i=i.className.indexOf("e-headercelldiv")>-1?i.parentElement:i,data:this.engine.pivotValues[Number(i.getAttribute("index"))][Number(i.getAttribute("aria-colindex"))],cancel:!0};this.parent.trigger(M,r,function(e){if(!e.cancel){r.currentCell=t.getElement(r.currentCell);var i=r.currentCell.getAttribute("data-url")?r.currentCell.getAttribute("data-url"):r.currentCell.querySelector("a").getAttribute("data-url");window.open(i)}})},e.prototype.getRowStartPos=function(){for(var e,t=this.parent.pivotValues,i=0;i<t.length;i++)if(t[i]&&t[i][0]&&"row"===t[i][0].axis){e=i;break}return e},e.prototype.frameDataSource=function(e){var t=[];if(this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var i=0,r=this.parent.pivotValues,a="value"===e?this.rowStartPos:0,n="value"===e?r.length:this.rowStartPos,o=a;o<n;o++)if(r[o]){t[i="header"===e?o:i]={};for(var l=0;l<r[o].length;l++)r[o][l]&&(t[i][l]=r[o][l]);i++}}else t="value"===e?this.engine.valueContent:this.engine.headerContent;else t=this.frameEmptyData();return t},e.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},e.prototype.calculateColWidth=function(e){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2;var i=(e-=1)*this.gridSettings.columnWidth<t?t/e:this.gridSettings.columnWidth;return Math.floor(i)},e.prototype.resizeColWidth=function(e){var t=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width);e-=1,t=t-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2;var i=e*this.gridSettings.columnWidth<t?t/e:this.gridSettings.columnWidth;return Math.floor(i)},e.prototype.calculateGridWidth=function(){var e=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return"auto"===this.gridSettings.width?"auto"===this.parent.width?e=t:this.parent.width.toString().indexOf("%")>-1&&(e=parseFloat(this.parent.width.toString())/100*t):e=this.gridSettings.width,e},e.prototype.calculateGridHeight=function(e){var t=this.parent.height,i=this.parent.getHeightAsNumber();if(isNaN(i)&&(i=this.parent.element.offsetHeight>0?this.parent.element.offsetHeight:1),"Chart"!==this.parent.currentView)if("auto"===this.gridSettings.height&&i&&this.parent.element.querySelector("."+qt)){if(t=i-(this.parent.element.querySelector("."+qt).offsetHeight+(this.parent.element.querySelector("."+Ne)?this.parent.element.querySelector("."+Ne).offsetHeight:0)+(this.parent.element.querySelector(".e-pivot-toolbar")?42:0))-2,e){var r=this.parent.element.querySelector("."+Dt+" ."+Ze).offsetHeight,a=this.parent.element.querySelector("."+Mt).offsetHeight,n=this.parent.element.querySelector("."+Mt+" ."+Ze).offsetWidth,o=this.parent.element.querySelector("."+Mt).offsetWidth<n,l=a<r,s=!!(o&&t-r<18);this.parent.grid.height=t>=r&&(!o||t>=a)&&!l&&!s?"auto":t}else t>this.engine.valueContent.length*this.gridSettings.rowHeight&&(t="auto")}else t=this.gridSettings.height;return t<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:t},e.prototype.frameStackedHeaders=function(){var e=[];if(this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData){var t=this.engine.headerContent.length,i=[],r=[],a=this.calculateColWidth(this.engine.pivotValues[0].length);do{var n=[],o=0;t--;var l=this.engine.headerContent[t];if(l)for(var s=0;s<Object.keys(l).length+(l[0]?0:1);s++){var d=l[s]&&l[s].colSpan?3!==l[s].memberType||0===t?l[s].colSpan:i[s]:1;d="olap"===this.parent.dataType?1:d;l[s]&&l[s].rowSpan&&l[s].rowSpan;var p=l[s]?"grand sum"===l[s].type?this.parent.localeObj.getConstant("grandTotal"):"sum"===l[s].type?l[s].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):l[s].formattedText:"";if(t===this.engine.headerContent.length-1)d=1,n[o]={field:s+".formattedText",headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,a):this.resColWidth,minWidth:30,format:0===s?"":this.formatList[l[s].actualText],allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0};else if(i[s]){for(var h=d=l[s]&&"grand sum"===l[s].type&&2===l[s].memberType?1:d,u=[],c=s;h>0;){if(n[o]){if(!e[r[c]])break;u.push(e[r[c]])}else n[o]={headerText:p,customAttributes:{cell:l[s]},width:l[s]?this.setSavedWidth(l[s].valueSort.levelName,a):this.resColWidth,minWidth:30,allowReordering:this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0},u=[e[r[c]]];h-=i[c],c+=i[c]}n[o].columns=u}n[o]&&(n[o].clipMode=this.gridSettings.clipMode),i[s]=d,r[s]=o,o++,s=s+d-1}e=n.length>0?n:e}while(t>0);e[0]={field:"0.formattedText",width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0}}else e=this.frameEmptyColumns();return e.length>1&&(e[e.length-1].minWidth=e[e.length-1].width,e[e.length-1].width="auto"),this.parent.triggerColumnRenderEvent(e),e},e.prototype.setSavedWidth=function(e,t){return t=this.parent.resizeInfo[e]?this.parent.resizeInfo[e]:t},e.prototype.frameEmptyColumns=function(){var e=[],t=this.calculateColWidth(2);return e.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),e.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),e},e.prototype.getFormatList=function(){for(var e={},t=0;t<this.parent.dataSourceSettings.values.length;t++){var i=this.parent.dataSourceSettings.values[t],r="N";if("olap"===this.parent.dataType){if(this.parent.olapEngineModule.fieldList[i.name]){var a=this.parent.olapEngineModule.fieldList[i.name].formatString;r=a.indexOf("#")>-1?a:a[0]+"2"}}else if(this.parent.dataSourceSettings.formatSettings.length>0)for(var n=0;n<this.parent.dataSourceSettings.formatSettings.length;n++){var o=this.parent.dataSourceSettings.formatSettings[n];if(i.name===o.name){r=o.format;break}}e[i.name]=r}return e},e.prototype.excelColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger(S,e)},e.prototype.pdfColumnEvent=function(e){e=this.exportHeaderEvent(e),this.parent.trigger(b,e)},e.prototype.excelRowEvent=function(e){if("0.formattedText"===e.column.field){var i="value"===e.data[0].type,r=0;r="olap"===this.parent.dataType?this.indentCollection[e.data[0].rowIndex]:i?this.lastSpan+1:e.data[0].level,this.colPos=0,e.style={hAlign:"Left",indent:2*r},this.lastSpan=i?this.lastSpan:r}else this.colPos++,t.isNullOrUndefined(e.data[this.colPos].value)||t.isNullOrUndefined(e.data[this.colPos].formattedText)?e.value="":e.value=e.data[this.colPos].value||e.data[this.colPos].formattedText;e=this.exportContentEvent(e),this.parent.trigger(C,e)},e.prototype.pdfRowEvent=function(e){if("0.formattedText"===(e=this.exportContentEvent(e)).column.field){var t=0,i="value"===e.data[0].type;t="olap"===this.parent.dataType?this.indentCollection[e.data[0].rowIndex]:i?this.lastSpan+1:-1!==e.data[0].level?e.data[0].level:0,e.style={paragraphIndent:10*t},this.lastSpan=i?this.lastSpan:t}this.parent.trigger(x,e)},e.prototype.exportHeaderEvent=function(e){var t=1;if(e.gridCell.column.customAttributes){var i=e.gridCell.column.customAttributes.cell;this.actualText!==i.actualText&&i.colSpan>1&&i.level>-1&&(e.gridCell.colSpan=e.cell.colSpan=i.colSpan>-1?i.colSpan:1),t=i.rowSpan>-1?i.rowSpan:1,this.actualText=i.actualText}else t=Object.keys(this.engine.headerContent).length;return e.cell.rowSpan!==t&&t>-1&&(e.cell.rowSpan=t),e},e.prototype.exportContentEvent=function(e){return e.value="grand sum"===e.data[Number(e.column.field.split(".formattedText")[0])].type?this.parent.localeObj.getConstant("grandTotal"):e.value,e},e.prototype.unWireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.remove(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},e.prototype.wireEvents=function(e){e.querySelector(".e-hyperlinkcell")&&t.EventHandler.add(e.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},e}(),Zt=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Jt=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},$t=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"name",void 0),Jt([t.Property()],i.prototype,"caption",void 0),Jt([t.Property("Sum")],i.prototype,"type",void 0),Jt([t.Property()],i.prototype,"axis",void 0),Jt([t.Property(!1)],i.prototype,"showNoDataItems",void 0),Jt([t.Property()],i.prototype,"baseField",void 0),Jt([t.Property()],i.prototype,"baseItem",void 0),Jt([t.Property(!0)],i.prototype,"showSubTotals",void 0),Jt([t.Property(!1)],i.prototype,"isNamedSet",void 0),Jt([t.Property(!1)],i.prototype,"isCalculatedField",void 0),i}(t.ChildProperty),ei=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Zt(t,e)}($t),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}Zt(i,e),Jt([t.Property()],i.prototype,"backgroundColor",void 0),Jt([t.Property()],i.prototype,"color",void 0),Jt([t.Property()],i.prototype,"fontFamily",void 0),Jt([t.Property()],i.prototype,"fontSize",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"name",void 0),Jt([t.Property("Include")],i.prototype,"type",void 0),Jt([t.Property()],i.prototype,"items",void 0),Jt([t.Property("DoesNotEquals")],i.prototype,"condition",void 0),Jt([t.Property()],i.prototype,"value1",void 0),Jt([t.Property()],i.prototype,"value2",void 0),Jt([t.Property()],i.prototype,"measure",void 0),Jt([t.Property(1)],i.prototype,"levelCount",void 0),Jt([t.Property()],i.prototype,"selectedField",void 0),i}(t.ChildProperty)),ti=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"measure",void 0),Jt([t.Property()],i.prototype,"label",void 0),Jt([t.Property()],i.prototype,"conditions",void 0),Jt([t.Property()],i.prototype,"value1",void 0),Jt([t.Property()],i.prototype,"value2",void 0),Jt([t.Property()],i.prototype,"style",void 0),Jt([t.Property(!0)],i.prototype,"applyToGrandTotals",void 0),i}(t.ChildProperty),ii=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"name",void 0),Jt([t.Property("Ascending")],i.prototype,"order",void 0),i}(t.ChildProperty),ri=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"name",void 0),Jt([t.Property()],i.prototype,"minimumFractionDigits",void 0),Jt([t.Property()],i.prototype,"maximumFractionDigits",void 0),Jt([t.Property()],i.prototype,"minimumSignificantDigits",void 0),Jt([t.Property()],i.prototype,"maximumSignificantDigits",void 0),Jt([t.Property(!0)],i.prototype,"useGrouping",void 0),Jt([t.Property()],i.prototype,"skeleton",void 0),Jt([t.Property()],i.prototype,"type",void 0),Jt([t.Property()],i.prototype,"currency",void 0),Jt([t.Property()],i.prototype,"minimumIntegerDigits",void 0),Jt([t.Property()],i.prototype,"format",void 0),i}(t.ChildProperty),ai=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"name",void 0),Jt([t.Property()],i.prototype,"groupInterval",void 0),Jt([t.Property()],i.prototype,"startingAt",void 0),Jt([t.Property()],i.prototype,"endingAt",void 0),Jt([t.Property("Date")],i.prototype,"type",void 0),Jt([t.Property()],i.prototype,"rangeInterval",void 0),i}(t.ChildProperty),ni=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"name",void 0),Jt([t.Property()],i.prototype,"formula",void 0),Jt([t.Property()],i.prototype,"hierarchyUniqueName",void 0),Jt([t.Property()],i.prototype,"formatString",void 0),i}(t.ChildProperty),oi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"name",void 0),Jt([t.Property()],i.prototype,"items",void 0),Jt([t.Property()],i.prototype,"delimiter",void 0),i}(t.ChildProperty),li=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"headerText",void 0),Jt([t.Property(".")],i.prototype,"headerDelimiter",void 0),Jt([t.Property("None")],i.prototype,"sortOrder",void 0),Jt([t.Property()],i.prototype,"measure",void 0),i}(t.ChildProperty),si=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Zt(i,e),Jt([t.Property()],i.prototype,"catalog",void 0),Jt([t.Property()],i.prototype,"cube",void 0),Jt([t.Property()],i.prototype,"dataProviderType",void 0),Jt([t.Property()],i.prototype,"url",void 0),Jt([t.Property()],i.prototype,"localeIdentifier",void 0),Jt([t.Property()],i.prototype,"dataSource",void 0),Jt([t.Collection([],$t)],i.prototype,"rows",void 0),Jt([t.Collection([],$t)],i.prototype,"columns",void 0),Jt([t.Collection([],$t)],i.prototype,"values",void 0),Jt([t.Collection([],$t)],i.prototype,"filters",void 0),Jt([t.Property([])],i.prototype,"excludeFields",void 0),Jt([t.Property(!1)],i.prototype,"expandAll",void 0),Jt([t.Property("column")],i.prototype,"valueAxis",void 0),Jt([t.Collection([],ei)],i.prototype,"filterSettings",void 0),Jt([t.Collection([],ii)],i.prototype,"sortSettings",void 0),Jt([t.Property(!0)],i.prototype,"enableSorting",void 0),Jt([t.Property(!1)],i.prototype,"allowLabelFilter",void 0),Jt([t.Property(!1)],i.prototype,"allowValueFilter",void 0),Jt([t.Property(!0)],i.prototype,"showSubTotals",void 0),Jt([t.Property(!0)],i.prototype,"showRowSubTotals",void 0),Jt([t.Property(!0)],i.prototype,"showColumnSubTotals",void 0),Jt([t.Property(!0)],i.prototype,"showGrandTotals",void 0),Jt([t.Property(!0)],i.prototype,"showRowGrandTotals",void 0),Jt([t.Property(!0)],i.prototype,"showColumnGrandTotals",void 0),Jt([t.Property(!1)],i.prototype,"alwaysShowValueHeader",void 0),Jt([t.Property(!0)],i.prototype,"showHeaderWhenEmpty",void 0),Jt([t.Property(!0)],i.prototype,"showAggregationOnValueField",void 0),Jt([t.Collection([],ri)],i.prototype,"formatSettings",void 0),Jt([t.Collection([],oi)],i.prototype,"drilledMembers",void 0),Jt([t.Complex({},li)],i.prototype,"valueSortSettings",void 0),Jt([t.Collection([],ni)],i.prototype,"calculatedFieldSettings",void 0),Jt([t.Collection([],ti)],i.prototype,"conditionalFormatSettings",void 0),Jt([t.Property()],i.prototype,"emptyCellsTextContent",void 0),Jt([t.Collection([],ai)],i.prototype,"groupSettings",void 0),i}(t.ChildProperty),di=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pi=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},hi=(function(e){function i(){return null!==e&&e.apply(this,arguments)||this}di(i,e),pi([t.Property("Row")],i.prototype,"mode",void 0),pi([t.Property("Flow")],i.prototype,"cellSelectionMode",void 0),pi([t.Property("Single")],i.prototype,"type",void 0),pi([t.Property(!1)],i.prototype,"checkboxOnly",void 0),pi([t.Property(!1)],i.prototype,"persistSelection",void 0),pi([t.Property("Default")],i.prototype,"checkboxMode",void 0),pi([t.Property(!1)],i.prototype,"enableSimpleMultiRowSelection",void 0)}(t.ChildProperty),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return di(i,e),pi([t.Property("auto")],i.prototype,"height",void 0),pi([t.Property("auto")],i.prototype,"width",void 0),pi([t.Property("Both")],i.prototype,"gridLines",void 0),pi([t.Property(!1)],i.prototype,"allowTextWrap",void 0),pi([t.Property(!1)],i.prototype,"allowReordering",void 0),pi([t.Property(!0)],i.prototype,"allowResizing",void 0),pi([t.Property(null)],i.prototype,"rowHeight",void 0),pi([t.Property(110)],i.prototype,"columnWidth",void 0),pi([t.Property("Ellipsis")],i.prototype,"clipMode",void 0),pi([t.Property(!1)],i.prototype,"allowSelection",void 0),pi([t.Property(-1)],i.prototype,"selectedRowIndex",void 0),pi([t.Property({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],i.prototype,"selectionSettings",void 0),pi([t.Property({WrapMode:"Both"})],i.prototype,"textWrapSettings",void 0),pi([t.Property("AllPages")],i.prototype,"printMode",void 0),pi([t.Property()],i.prototype,"contextMenuItems",void 0),pi([t.Event()],i.prototype,"beforeCopy",void 0),pi([t.Event()],i.prototype,"printComplete",void 0),pi([t.Event()],i.prototype,"beforePrint",void 0),pi([t.Event()],i.prototype,"contextMenuOpen",void 0),pi([t.Event()],i.prototype,"contextMenuClick",void 0),pi([t.Event()],i.prototype,"queryCellInfo",void 0),pi([t.Event()],i.prototype,"headerCellInfo",void 0),pi([t.Event()],i.prototype,"rowSelecting",void 0),pi([t.Event()],i.prototype,"rowSelected",void 0),pi([t.Event()],i.prototype,"rowDeselecting",void 0),pi([t.Event()],i.prototype,"rowDeselected",void 0),pi([t.Event()],i.prototype,"cellSelecting",void 0),pi([t.Event()],i.prototype,"cellSelected",void 0),pi([t.Event()],i.prototype,"cellDeselecting",void 0),pi([t.Event()],i.prototype,"cellDeselected",void 0),pi([t.Event()],i.prototype,"resizeStart",void 0),pi([t.Event()],i.prototype,"resizing",void 0),pi([t.Event()],i.prototype,"resizeStop",void 0),pi([t.Event()],i.prototype,"pdfHeaderQueryCellInfo",void 0),pi([t.Event()],i.prototype,"pdfQueryCellInfo",void 0),pi([t.Event()],i.prototype,"excelHeaderQueryCellInfo",void 0),pi([t.Event()],i.prototype,"excelQueryCellInfo",void 0),pi([t.Event()],i.prototype,"columnDragStart",void 0),pi([t.Event()],i.prototype,"columnDrag",void 0),pi([t.Event()],i.prototype,"columnDrop",void 0),pi([t.Event()],i.prototype,"columnRender",void 0),i}(t.ChildProperty)),ui=function(){function e(e){this.parent=e,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return e.prototype.getModuleName=function(){return"excelExport"},e.prototype.exportToExcel=function(e){if(this.parent.enableVirtualization){var i=this.engine.pageSettings;this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.engine.pageSettings=i}var r={fileName:"default",header:"",footer:"",dataCollections:[this.engine.pivotValues]};this.parent.trigger(y,r);for(var a=r.fileName,n=r.dataCollections,o=[],l=0;l<n.length;l++){for(var d=n[l],p=0,h=d.length,u=0,c=this.parent.renderModule.getFormatList(),g=[],m=0,f=0;f<h;f++)if(d[f]){u++,p=d[f].length;for(var v=[],S=0;S<p;S++)if(d[f][S]){var b=d[f][S];if(-1!==b.level||b.rowSpan){var C="value"===b.axis?b.value:b.formattedText;if(C="grand sum"===b.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===b.type?C.toString().replace("Total",this.parent.localeObj.getConstant("total")):C,-1!==b.level||b.rowSpan){if(v.push({index:S+1,value:C,colSpan:b.colSpan,rowSpan:-1===b.rowSpan?1:b.rowSpan}),"value"===b.axis){(isNaN(b.value)||""===b.formattedText||void 0===b.formattedText||t.isNullOrUndefined(b.value))&&(v[v.length-1].value="");var x="row"===this.parent.dataSourceSettings.valueAxis&&"olap"===this.parent.dataType&&b.rowOrdinal&&this.engine.tupRowInfo[b.rowOrdinal]?this.engine.tupRowInfo[b.rowOrdinal].measureName:b.actualText;v[v.length-1].style={numberFormat:c[x],bold:!1,wrapText:!0},b.style&&(v[v.length-1].style.backColor=b.style.backgroundColor,v[v.length-1].style.fontColor=b.style.color,v[v.length-1].style.fontName=b.style.fontFamily,v[v.length-1].style.fontSize=Number(b.style.fontSize.split("px")[0]))}else if(v[v.length-1].style={bold:!0,vAlign:"Center",wrapText:!0,indent:0===S?10*b.level:0},"row"===b.axis&&0===S)if(v[v.length-1].style.hAlign="Left","olap"===this.parent.dataType){var w=this.parent.renderModule.indentCollection[f];v[v.length-1].style.indent=2*w,m=m>w?m:w}else v[v.length-1].style.indent=2*b.level,m=b.level>m?b.level:m;v[v.length-1].style.borders={color:"#000000",lineStyle:"Thin"}}}S+=b.colSpan?b.colSpan-1:0}else v.push({index:S+1,value:"",colSpan:1,rowSpan:1});g.push({index:u,cells:v})}var T=[];for(S=0;S<p;S++)T.push({index:S+1,width:100});m>0&&(T[0].width=100+20*m),o.push({columns:T,rows:g})}new s.Workbook({worksheets:o},"Excel"===e?"xlsx":"csv").save(a+("Excel"===e?".xlsx":".csv"))},e.prototype.destroy=function(){},e}(),ci=function(){function e(e){this.parent=e,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return e.prototype.getModuleName=function(){return"pdfExport"},e.prototype.addPage=function(e){var t=e.document.pages.add(),i=e.args.header,r=e.args.footer,a=new d.PdfStandardFont(d.PdfFontFamily.TimesRoman,15,d.PdfFontStyle.Regular),n=new d.PdfSolidBrush(new d.PdfColor(0,0,0)),o=new d.PdfPen(new d.PdfColor(0,0,0),.5),l=new d.PdfPageTemplateElement(new d.RectangleF(0,0,t.graphics.clientSize.width,20));l.graphics.drawString(i,a,o,n,0,0,new d.PdfStringFormat(d.PdfTextAlignment.Center)),e.document.template.top=l;var s=new d.PdfPageTemplateElement(new d.RectangleF(0,0,t.graphics.clientSize.width,20));return s.graphics.drawString(r,a,o,n,0,0,new d.PdfStringFormat(d.PdfTextAlignment.Center)),e.document.template.bottom=s,t},e.prototype.hexDecToRgb=function(e){if(null===e||""===e||7!==e.length)throw new Error("please set valid hex value for color..");e=e.substring(1);var t=parseInt(e,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},e.prototype.getFontStyle=function(e){var i=d.PdfFontStyle.Regular;return!t.isNullOrUndefined(e)&&e.bold&&(i|=d.PdfFontStyle.Bold),!t.isNullOrUndefined(e)&&e.italic&&(i|=d.PdfFontStyle.Italic),!t.isNullOrUndefined(e)&&e.underline&&(i|=d.PdfFontStyle.Underline),!t.isNullOrUndefined(e)&&e.strikeout&&(i|=d.PdfFontStyle.Strikeout),i},e.prototype.getBorderStyle=function(e){var i=new d.PdfBorders;if(t.isNullOrUndefined(e)){var r=new d.PdfColor(234,234,234);i.all=new d.PdfPen(r)}else{var a=e.width,n=t.isNullOrUndefined(a)||"number"!=typeof a?void 0:.75*a,o=new d.PdfColor(196,196,196);if(!t.isNullOrUndefined(e.color)){var l=this.hexDecToRgb(e.color);o=new d.PdfColor(l.r,l.g,l.b)}var s=new d.PdfPen(o,n);t.isNullOrUndefined(e.dashStyle)||(s.dashStyle=this.getDashStyle(e.dashStyle)),i.all=s}return i},e.prototype.getDashStyle=function(e){switch(e){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},e.prototype.getStyle=function(){var e=new d.PdfBorders;if(t.isNullOrUndefined(this.gridStyle))return{brush:new d.PdfSolidBrush(new d.PdfColor),border:e,font:void 0};var i=t.isNullOrUndefined(this.gridStyle.header.fontName)?d.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.header.fontName),r=this.getFontStyle(this.gridStyle.header),a=t.isNullOrUndefined(this.gridStyle.header.fontSize)?10.5:this.gridStyle.header.fontSize,n=new d.PdfColor;if(!t.isNullOrUndefined(this.gridStyle.header.fontColor)){var o=this.hexDecToRgb(this.gridStyle.header.fontColor);n=new d.PdfColor(o.r,o.g,o.b)}var l=new d.PdfStandardFont(i,a,r);return t.isNullOrUndefined(this.gridStyle.header.font)||(l=this.gridStyle.header.font),{border:this.getBorderStyle(this.gridStyle.header.border),font:l,brush:new d.PdfSolidBrush(n)}},e.prototype.setRecordThemeStyle=function(e,i){if(!t.isNullOrUndefined(this.gridStyle)&&!t.isNullOrUndefined(this.gridStyle.record)){var r=t.isNullOrUndefined(this.gridStyle.record.fontName)?d.PdfFontFamily.Helvetica:this.getFontFamily(this.gridStyle.record.fontName),a=t.isNullOrUndefined(this.gridStyle.record.fontSize)?9.75:this.gridStyle.record.fontSize,n=this.getFontStyle(this.gridStyle.record),o=new d.PdfStandardFont(r,a,n);t.isNullOrUndefined(this.gridStyle.record.font)||(o=this.gridStyle.record.font),e.style.setFont(o);var l=new d.PdfColor;if(!t.isNullOrUndefined(this.gridStyle.record.fontColor)){var s=this.hexDecToRgb(this.gridStyle.record.fontColor);l=new d.PdfColor(s.r,s.g,s.b)}e.style.setTextBrush(new d.PdfSolidBrush(l))}var p=this.gridStyle&&this.gridStyle.record&&this.gridStyle.record.border?this.getBorderStyle(this.gridStyle.record.border):i;return e.style.setBorder(p),e},e.prototype.exportToPDF=function(){for(var e=this.applyEvent(),t=this.getStyle(),i=100+20*this.parent.renderModule.maxIndent,r=Math.floor((540-i)/90)+1,a=0,n=e.args.dataCollections[a],o=0;e.args.allowRepeatHeader&&r>1&&o<n.length;o++)for(var l=r;n[o]&&l<n[o].length;l+=r)n[o].splice(l,0,n[o][0]);var s=n&&n.length>0?n[0].length:0,p=0;do{var h=this.addPage(e),u=new d.PdfGrid,c=r>1?r:5;if(n&&n.length>0){u.columns.add(n[0].length-p>=c?c:n[0].length-p);for(var g=n.length,m=0,f=0,v=0;v<g;v++)if(n[v]){var y=!(n[v][0]&&"row"===n[v][0].axis),S=n[v].length>p+c?p+c:n[v].length;y&&u.headers.add(1);var b=y?u.headers.getHeader(m):u.rows.addRow();y?(b.style.setBorder(t.border),t.font&&b.style.setFont(t.font),b.style.setTextBrush(t.brush)):this.setRecordThemeStyle(b,t.border);for(var C=0,x=!0,T=p;T<S;T++){var M=!1;if(n[v][T]){var D=n[v][T];if(-1!==D.level||D.rowSpan){var E=D.formattedText;E="grand sum"===D.type?this.parent.localeObj.getConstant("grandTotal"):"sum"===D.type?E.toString().replace("Total",this.parent.localeObj.getConstant("total")):E,(-1!==D.level||D.rowSpan)&&(b.cells.getCell(C).columnSpan=D.colSpan?c-C<D.colSpan?c-C:D.colSpan:1,y&&D.rowSpan&&D.rowSpan>1&&(b.cells.getCell(C).rowSpan=D.rowSpan?D.rowSpan:1),b.cells.getCell(C).value=E?E.toString():""),""!==E&&(x=!1)}f=D.level>f?D.level:f,M="value"===D.axis,T+=b.cells.getCell(C).columnSpan?b.cells.getCell(C).columnSpan-1:0,C+=b.cells.getCell(C).columnSpan?b.cells.getCell(C).columnSpan-1:0,D.style&&(b=this.applyStyle(b,D,C));var L={style:D&&D.isSum?{bold:!0}:void 0,pivotCell:D,cell:b.cells.getCell(C)};this.parent.trigger(w,L),L.style&&this.processCellStyle(b.cells.getCell(C),L)}else{L={style:void 0,pivotCell:void 0,cell:b.cells.getCell(C)};this.parent.trigger(w,L),L.style&&this.processCellStyle(b.cells.getCell(C),L),b.cells.getCell(C).value="",0===T&&y&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0?u.headers.getHeader(0).cells.getCell(0).rowSpan++:0!==T&&y&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&u.headers.getHeader(0).cells.getCell(0).rowSpan<Object.keys(this.engine.headerContent).length&&u.headers.getHeader(0).cells.getCell(0).rowSpan++}var O=new d.PdfStringFormat;if("olap"===this.parent.dataType){var P=!y&&0===C&&n[v][T]?this.parent.renderModule.indentCollection[n[v][T].rowIndex]:0;O.paragraphIndent=15*P,f=f>P?f:P}else O.paragraphIndent=!y&&0===C&&n[v][T]&&-1!==n[v][T].level?15*n[v][T].level:0;O.alignment=M?d.PdfTextAlignment.Right:d.PdfTextAlignment.Left,O.lineAlignment=d.PdfVerticalAlignment.Middle,b.cells.getCell(C).style.stringFormat=O,C++}x&&(b.height=16),m++}u.columns.getColumn(0).width=100+20*f}0===p&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&u.headers.getHeader(0).cells.getCell(0).rowSpan--,u.draw(h,new d.PointF(10,20)),(p+=c)>=s&&e.args.dataCollections.length>a+1&&(a++,s=(n=e.args.dataCollections[a])&&n.length>0?n[0].length:0,p=0)}while(p<s);e.document.save(e.args.fileName+".pdf"),e.document.destroy()},e.prototype.applyStyle=function(e,t,i){var r=this.parent.conditionalFormattingModule.hexToRgb(t.style.backgroundColor),a=new d.PdfSolidBrush(new d.PdfColor(r.r,r.g,r.b));e.cells.getCell(i).style.backgroundBrush=a;var n=Number(t.style.fontSize.split("px")[0]),o=new d.PdfStandardFont(d.PdfFontFamily.TimesRoman,n,d.PdfFontStyle.Regular);return e.cells.getCell(i).style.font=o,r=this.parent.conditionalFormattingModule.hexToRgb(t.style.color),a=new d.PdfSolidBrush(new d.PdfColor(r.r,r.g,r.b)),e.cells.getCell(i).style.textBrush=a,e},e.prototype.getFontFamily=function(e){switch(e){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},e.prototype.getFont=function(e){if(e.style.font)return e.style.font;var i=t.isNullOrUndefined(e.style.fontSize)?9.75:.75*e.style.fontSize,r=t.isNullOrUndefined(e.style.fontFamily)?d.PdfFontFamily.TimesRoman:this.getFontFamily(e.style.fontFamily),a=d.PdfFontStyle.Regular;return!t.isNullOrUndefined(e.style.bold)&&e.style.bold&&(a|=d.PdfFontStyle.Bold),!t.isNullOrUndefined(e.style.italic)&&e.style.italic&&(a|=d.PdfFontStyle.Italic),!t.isNullOrUndefined(e.style.underline)&&e.style.underline&&(a|=d.PdfFontStyle.Underline),!t.isNullOrUndefined(e.style.strikeout)&&e.style.strikeout&&(a|=d.PdfFontStyle.Strikeout),new d.PdfStandardFont(r,i,a)},e.prototype.processCellStyle=function(e,i){if(!t.isNullOrUndefined(i.style.backgroundColor)){var r=this.hexDecToRgb(i.style.backgroundColor);e.style.backgroundBrush=new d.PdfSolidBrush(new d.PdfColor(r.r,r.g,r.b))}if(!t.isNullOrUndefined(i.style.textBrushColor)){var a=this.hexDecToRgb(i.style.textBrushColor);e.style.textBrush=new d.PdfSolidBrush(new d.PdfColor(a.r,a.g,a.b))}if(!t.isNullOrUndefined(i.style.textPenColor)){var n=this.hexDecToRgb(i.style.textPenColor);e.style.textPen=new d.PdfPen(new d.PdfColor(n.r,n.g,n.b))}if(t.isNullOrUndefined(i.style.fontFamily)&&t.isNullOrUndefined(i.style.fontSize)&&t.isNullOrUndefined(i.style.bold)&&t.isNullOrUndefined(i.style.italic)&&t.isNullOrUndefined(i.style.underline)&&t.isNullOrUndefined(i.style.strikeout)||(e.style.font=this.getFont(i)),!t.isNullOrUndefined(i.style.border)){var o=new d.PdfBorders,l=i.style.border.width,s=t.isNullOrUndefined(l)||"number"!=typeof l?void 0:.75*l,p=new d.PdfColor(196,196,196);if(!t.isNullOrUndefined(i.style.border.color)){var h=this.hexDecToRgb(i.style.border.color);p=new d.PdfColor(h.r,h.g,h.b)}var u=new d.PdfPen(p,s);t.isNullOrUndefined(i.style.border.dashStyle)||(u.dashStyle=this.getDashStyle(i.style.border.dashStyle)),o.all=u,e.style.borders=o}},e.prototype.applyEvent=function(){if(this.parent.enableVirtualization){var e=this.engine.pageSettings;this.engine.pageSettings=null,this.engine.generateGridData(this.parent.dataSourceSettings),this.engine.pageSettings=e}var t={fileName:"default",header:"",footer:"",dataCollections:[JSON.parse(JSON.stringify(this.engine.pivotValues))],allowRepeatHeader:!0,style:void 0};this.parent.trigger(y,t),this.gridStyle=t.style;return{document:new d.PdfDocument,args:t}},e.prototype.destroy=function(){},e}(),gi=function(){function e(e){this.keyConfigs={tab:"tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.pivotViewKeyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"tab":this.processTab(e);break;case"enter":this.processEnter(e);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(e);break;case"escape":this.clearSelection()}},e.prototype.getNextButton=function(e){var t=[].slice.call(this.parent.element.querySelectorAll("."+pe)),i=e;if(this.parent.grid.element.querySelector("."+pe))for(var r=t.length,a=0;a<r;a++)if(t[a].getAttribute("data-uid")===e.getAttribute("data-uid")){i=t[a+1]?t[a+1]:i;break}return i},e.prototype.processTab=function(e){var i=e.target;if(i&&t.closest(i,"."+pe)){var r=this.parent.grid.serviceLocator.getService("focus"),a=this.getNextButton(i);if(a.getAttribute("data-uid")!==i.getAttribute("data-uid"))r.currentInfo.skipAction=!0,a.focus();else{r.focus();var n=r.getFocusedElement();t.addClass([n],["e-focused","e-focus"]),n.setAttribute("tabindex","0")}e.preventDefault()}else if(!this.parent.showGroupingBar&&this.parent.showFieldList){if(i&&t.closest(i,"."+ee)){(r=this.parent.grid.serviceLocator.getService("focus")).focus();n=r.getFocusedElement();t.addClass([n],["e-focused","e-focus"]),n.setAttribute("tabindex","0")}}else if(!this.parent.showGroupingBar&&!this.parent.showFieldList&&i&&t.closest(i,".e-pivotview")){var o=t.closest(i,".e-pivotview"),l=(r=this.parent.grid.serviceLocator.getService("focus"),[].slice.call(o.getElementsByTagName("tr")));if(i.innerHTML===l[l.length-1].lastChild.innerHTML)r.currentInfo.skipAction=!0;else{r.focus();n=r.getFocusedElement();t.addClass([n],["e-focused","e-focus"]),n.setAttribute("tabindex","0")}}},e.prototype.processEnter=function(e){var i=e.target;if(i&&t.closest(i,".e-grid"))return i.querySelector("."+K)?i.querySelector("."+K).click():i.classList.contains("e-valuescontent")&&i.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),void e.preventDefault()},e.prototype.clearSelection=function(){var e=this.parent;[].slice.call(e.element.querySelectorAll("."+Lt+",."+Ot)).forEach(function(e){e.classList.remove(Ot),e.classList.remove(Lt),e.classList.remove(It)}),this.parent.renderModule.selected()},e.prototype.processSelection=function(e){if(this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode){var i,r=e.target,a=this.parent,n=Number(e.target.getAttribute("aria-colIndex")),o=Number(e.target.getAttribute("index"));if("TH"!==r.nodeName&&"TD"!==r.nodeName||(i="shiftUp"===e.action||"upArrow"===e.action?0===o||0===n||"TH"!==r.nodeName&&a.renderModule.rowStartPos!==o?null:this.getParentElement(a,i,n,o-1):"shiftDown"===e.action||"downArrow"===e.action?a.element.querySelector('th[aria-colindex="'+n+'"][index="'+(o+1)+'"]'):"shiftLeft"===e.action||"leftArrow"===e.action?e.target.previousSibling:e.target.nextSibling),t.isNullOrUndefined(i))"upArrow"===e.action?(i=a.element.querySelector('[aria-colindex="'+n+'"][index="'+(o-1)+'"]'),o--):"downArrow"===e.action&&(i=a.element.querySelector('[aria-colindex="'+n+'"][index="'+(o+1)+'"]'),o++),t.isNullOrUndefined(i)||a.clearSelection(i,e,n,o);else if("Both"===a.gridSettings.selectionSettings.mode&&i.classList.contains(Nt))a.clearSelection(i,e,n,o);else{n=Number(i.getAttribute("aria-colindex")),o=Number(i.getAttribute("index"));var l=Number(i.getAttribute("aria-colspan"));a.clearSelection(i,e,n,o);var s={cancel:!1,isCellClick:!0,currentCell:i,data:a.pivotValues[o][n]};a.trigger(E,s,function(t){t.cancel||a.applyColumnSelection(e,i,n,n+(l>0?l-1:0),o)})}}},e.prototype.getParentElement=function(e,t,i,r){for(;!t;)t=e.element.querySelector('[aria-colindex="'+i+'"][index="'+r+'"]'),i--;return t},e.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},e}(),mi=function(){function e(e){this.parent=e,this.parent.contextMenuModule=this}return e.prototype.render=function(){this.renderContextMenu()},e.prototype.renderContextMenu=function(){var e={cssClass:"e-pivot-context-menu",items:[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],enableRtl:this.parent.enableRtl,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},i=t.createElement("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(i),this.menuObj=new n.ContextMenu(e),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(i)},e.prototype.onBeforeMenuOpen=function(e){var i=[].slice.call(e.element.querySelectorAll("li")),r="olap"===this.parent.dataType?this.fieldElement.getAttribute("data-type"):this.fieldElement.querySelector(".e-content").getAttribute("data-type");if(t.removeClass(i,gt),"CalculatedField"===r||"isMeasureFieldsAvail"===r)for(var a=0,n=i;a<n.length;a++){(p=n[a]).textContent!==this.parent.localeObj.getConstant("addToValue")&&t.addClass([p],gt)}else if("isMeasureAvail"===r)for(var o=0,l=i;o<l.length;o++){(p=l[o]).textContent!==this.parent.localeObj.getConstant("addToRow")&&p.textContent!==this.parent.localeObj.getConstant("addToColumn")&&t.addClass([p],gt)}else if("olap"===this.parent.dataType)for(var s=0,d=i;s<d.length;s++){var p;if((p=d[s]).textContent===this.parent.localeObj.getConstant("addToValue")){t.addClass([p],gt);break}}},e.prototype.onSelectContextMenu=function(e){if(null!==e.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=e.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.btnElement=this.fieldElement,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1),this.parent.updateDataSource(!0),this.fieldElement=void 0}},e.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy()},e}(),fi=function(){function e(e){this.previousValues={top:0,left:0},this.frozenPreviousValues={top:0,left:0},this.eventType="",this.parent=e,this.addInternalEvents()}return e.prototype.getModuleName=function(){return"virtualscroll"},e.prototype.addInternalEvents=function(){this.parent.on(H,this.wireEvents,this)},e.prototype.wireEvents=function(){var e=this.parent.element.querySelector("."+Mt),i=this.parent.element.querySelector("."+Dt),r=this.parent.element.querySelector("."+Et);t.EventHandler.clearEvents(e),t.EventHandler.clearEvents(i),this.parent.engineModule&&(t.EventHandler.add(e,"scroll touchmove pointermove",this.onHorizondalScroll(r,e,i),this),t.EventHandler.add(e,"scroll wheel touchmove pointermove",this.onVerticalScroll(i,e),this),t.EventHandler.add(e,"mouseup touchend",this.common(r,e,i),this),t.EventHandler.add(i,"wheel",this.onWheelScroll(e,i),this),t.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(r,e,i),this),t.EventHandler.add(r,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(r,"touchmove pointermove",this.onTouchScroll(r,e,i),this)),this.parent.grid.isPreventScrollEvent=!0},e.prototype.onWheelScroll=function(e,t){var i=this,r=e;return function(e){var a=r.scrollTop+(1===e.deltaMode?30*e.deltaY:e.deltaY);i.frozenPreviousValues.top!==a&&(e.preventDefault(),t.scrollTop=a,r.scrollTop=a,i.frozenPreviousValues.top=a,i.eventType=e.type)}},e.prototype.getPointXY=function(e){var t={x:0,y:0};return e.touches&&e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t},e.prototype.onTouchScroll=function(e,t,i){var r=this,a=t;return function(t){if("mouse"!==t.pointerType){var n=r.getPointXY(t),o=a.scrollTop+(r.pageXY.y-n.y),l=a.scrollLeft+(r.pageXY.x-n.x);if(r.parent.element.querySelector(".e-headercontent").contains(t.target)){if(r.frozenPreviousValues.left===l||l<0)return;e.scrollLeft=l,a.scrollLeft=l,r.pageXY.x=n.x,r.frozenPreviousValues.left=l}else{if(r.frozenPreviousValues.top===o||o<0)return;i.scrollTop=o,a.scrollTop=o,r.pageXY.y=n.y,r.frozenPreviousValues.top=o}r.eventType=t.type}}},e.prototype.update=function(e,t,i,a,n){if(this.parent.isScrolling=!0,"vertical"===this.direction){var o="row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,l=this.parent.pageSettings.rowSize*o*this.parent.gridSettings.rowHeight,s=Math.ceil(i/l);if(this.parent.scrollPosObject.vertical===s||this.parent.engineModule.pageSettings.rowSize>=this.parent.engineModule.rowCount)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element);(h=this.parent).scrollPosObject.vertical=s,h.engineModule.pageSettings.rowCurrentPage=s>1?s:1,h.engineModule.generateGridData(h.dataSourceSettings,h.engineModule.headerCollection),h.pivotValues=h.engineModule.pivotValues;var d=l*Math.ceil(h.engineModule.rowStartPos/(h.pageSettings.rowSize*o))-h.engineModule.rowFirstLvl*o*h.gridSettings.rowHeight;h.scrollPosObject.verticalSection=d}else{var p="column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1;l=this.parent.pageSettings.columnSize*p*this.parent.gridSettings.columnWidth,s=Math.ceil(a/l);if(this.parent.scrollPosObject.horizontal===s)return void r.hideSpinner(this.parent.element);r.showSpinner(this.parent.element);var h;(h=this.parent).scrollPosObject.horizontal=s,h.engineModule.pageSettings.columnCurrentPage=s>1?s:1,h.engineModule.generateGridData(h.dataSourceSettings,h.engineModule.headerCollection),h.pivotValues=h.engineModule.pivotValues;d=l*Math.ceil(h.engineModule.colStartPos/(h.pageSettings.columnSize*p))-h.engineModule.colFirstLvl*p*h.gridSettings.columnWidth;h.scrollPosObject.horizontalSection=d}},e.prototype.setPageXY=function(){var e=this;return function(t){"mouse"!==t.pointerType&&(e.pageXY=e.getPointXY(t))}},e.prototype.common=function(e,t,i){var r=this;return function(i){r.update(e,t,t.scrollTop*r.parent.verticalScrollScale,t.scrollLeft*r.parent.horizontalScrollScale,i)}},e.prototype.onHorizondalScroll=function(e,i,r){var a,n=this;return function(o){var l=i.scrollLeft*n.parent.horizontalScrollScale;if("wheel"!==o.type&&"touchmove"!==o.type&&"wheel"!==n.eventType&&"touchmove"!==n.eventType||(clearTimeout(a),a=setTimeout(function(){l="touchmove"===o.type?i.scrollLeft:l,n.update(e,i,i.scrollTop*n.parent.verticalScrollScale,l,o)},300)),n.previousValues.left!==l){n.direction="horizondal";var s=-(l-n.parent.scrollPosObject.horizontalSection-i.scrollLeft),d=i.querySelector("."+Ze).style.transform.split(",")[1].trim();i.scrollLeft<n.parent.scrollerBrowserLimit&&(t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+s+"px,"+d}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+s+"px,0px)"}));var p=n.parent.scrollPosObject.horizontalSection>l?-(n.parent.scrollPosObject.horizontalSection-l):l+e.offsetWidth-(n.parent.scrollPosObject.horizontalSection+i.querySelector(".e-table").offsetWidth),h=Math.ceil(n.parent.scrollPosObject.horizontalSection/n.parent.horizontalScrollScale)<n.parent.scrollerBrowserLimit;if(n.parent.scrollPosObject.horizontalSection>l||p>1&&h){l>e.clientWidth?(n.parent.scrollPosObject.left<1&&(n.parent.scrollPosObject.left=e.clientWidth),n.parent.scrollPosObject.left=n.parent.scrollPosObject.left-50,p=n.parent.scrollPosObject.horizontalSection>l?p-n.parent.scrollPosObject.left:p+n.parent.scrollPosObject.left):p=-n.parent.scrollPosObject.horizontalSection,s=-(l-(n.parent.scrollPosObject.horizontalSection+p)-i.scrollLeft);var u=n.parent.gridSettings.columnWidth*n.parent.engineModule.columnCount-n.parent.grid.columns[0].width;u>n.parent.scrollerBrowserLimit&&(n.parent.horizontalScrollScale=u/n.parent.scrollerBrowserLimit,u=n.parent.scrollerBrowserLimit),s>u&&s>l&&(s=l,p=0),t.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+s+"px,"+d}),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate("+s+"px,0px)"}),n.parent.scrollPosObject.horizontalSection=n.parent.scrollPosObject.horizontalSection+p}n.previousValues.left=l,n.frozenPreviousValues.left=l,n.eventType="",e.scrollLeft=i.scrollLeft}else r.scrollTop=i.scrollTop}},e.prototype.onVerticalScroll=function(e,i){var r,a=this;return function(n){var o=i.scrollTop*a.parent.verticalScrollScale;if("wheel"!==n.type&&"touchmove"!==n.type&&"wheel"!==a.eventType&&"touchmove"!==a.eventType||(clearTimeout(r),r=setTimeout(function(){a.update(null,i,i.scrollTop*a.parent.verticalScrollScale,i.scrollLeft*a.parent.horizontalScrollScale,n)},300)),a.previousValues.top!==o){a.direction="vertical";var l=-(o-a.parent.scrollPosObject.verticalSection-i.scrollTop),s=i.querySelector("."+Ze).style.transform.split(",")[0].trim();i.scrollTop<a.parent.scrollerBrowserLimit&&(t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+l+"px)"}),t.setStyleAttribute(i.querySelector(".e-table"),{transform:s+","+l+"px)"}));var d=a.parent.scrollPosObject.verticalSection>o?-(a.parent.scrollPosObject.verticalSection-o):o+e.clientHeight-(a.parent.scrollPosObject.verticalSection+e.querySelector(".e-table").offsetHeight),p=Math.ceil(a.parent.scrollPosObject.verticalSection/a.parent.verticalScrollScale)<a.parent.scrollerBrowserLimit;if(a.parent.scrollPosObject.verticalSection>o||d>1&&p){o>e.clientHeight?(a.parent.scrollPosObject.top<1&&(a.parent.scrollPosObject.top=e.clientHeight),a.parent.scrollPosObject.top=a.parent.scrollPosObject.top-50,d=a.parent.scrollPosObject.verticalSection>o?d-a.parent.scrollPosObject.top:d+a.parent.scrollPosObject.top):d=-a.parent.scrollPosObject.verticalSection;var h=a.parent.element.querySelector("."+Mt).querySelector(".e-table");l=-(o-(a.parent.scrollPosObject.verticalSection+d)-i.scrollTop);var u=a.parent.gridSettings.rowHeight*a.parent.engineModule.rowCount+.1-h.clientHeight;u>a.parent.scrollerBrowserLimit&&(a.parent.verticalScrollScale=u/a.parent.scrollerBrowserLimit,u=a.parent.scrollerBrowserLimit),l>u&&l>o&&(l=o,d=0),t.setStyleAttribute(e.querySelector(".e-table"),{transform:"translate(0px,"+l+"px)"}),t.setStyleAttribute(i.querySelector(".e-table"),{transform:s+","+l+"px)"}),a.parent.scrollPosObject.verticalSection=a.parent.scrollPosObject.verticalSection+d}a.previousValues.top=o,a.frozenPreviousValues.top=o,a.eventType="",e.scrollTop=i.scrollTop,i.scrollTop=e.scrollTop}}},e.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(H,this.wireEvents)},e.prototype.destroy=function(){this.removeInternalEvents()},e}(),vi=function(){function e(e){this.isUpdated=!1,this.gridIndexObjects={},this.gridData=[],this.parent=e,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return e.prototype.showDrillThroughDialog=function(e){var i=this;this.gridData=e.rawData,"olap"===this.parent.dataType&&this.formatData(),this.removeDrillThroughDialog();var a=t.createElement("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog",styles:"visibility:hidden;"});this.parent.element.appendChild(a),this.dialogPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(e),beforeOpen:function(){i.drillThroughGrid.setProperties({dataSource:i.parent.editSettings.allowEditing?i.dataWithPrimarykey(e):i.gridData,height:300},!0),i.drillThroughGrid.enableVirtualization=!i.parent.editSettings.allowEditing},beforeClose:function(){if(i.parent.editSettings.allowEditing&&i.isUpdated){for(var e=Object.keys(i.gridIndexObjects).length,r=[],a=0,n=i.drillThroughGrid.dataSource;a<n.length;a++){var o=n[a];if(t.isNullOrUndefined(o.__index)||""===o.__index){for(var l=0,s=i.engine.fields;l<s.length;l++){var d=s[l];t.isNullOrUndefined(o[d])&&delete o[d]}delete o.__index,r.push(o)}else e>0&&(delete i.gridIndexObjects[o.__index.toString()],e--)}e=0;for(var p=[],h=0,u=i.parent.engineModule.data;h<u.length;h++){delete(o=u[h]).__index,void 0===i.gridIndexObjects[e.toString()]&&p.push(o),e++}p=p.concat(r),i.parent.setProperties({dataSourceSettings:{dataSource:p}},!0),i.engine.updateGridData(i.parent.dataSourceSettings),i.parent.pivotValues=i.engine.pivotValues}i.isUpdated=!1,i.gridIndexObjects={}},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!0,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(a),t.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"})},e.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy();var e=document.getElementById(this.parent.element.id+"_drillthrough");e&&t.remove(e),document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&t.remove(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},e.prototype.createDrillThroughGrid=function(e){var i=t.createElement("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),r=t.createElement("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"});if(""!==e.rowHeaders&&(r.innerHTML="<span class="+Ce+"><span class="+be+">"+this.parent.localeObj.getConstant("row")+"</span> :<span class="+xe+">"+e.rowHeaders+"</span></span>"),""!==e.columnHeaders&&(r.innerHTML=r.innerHTML+"<span class="+Ce+"><span class="+be+">"+this.parent.localeObj.getConstant("column")+"</span> :<span class="+xe+">"+e.columnHeaders+"</span></span>"),""!==e.value){var n=e.value.split("(")[0],o=e.value.split("(")[1].split(")")[0];"0"!==o&&(r.innerHTML=r.innerHTML+"<span class="+Ce+"><span class="+be+">"+n+"</span> :<span class="+xe+">"+o+"</span></span>")}var l=["ColumnChooser"];this.parent.editSettings.allowEditing&&(l=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]);var s=t.createElement("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"});a.Grid.Inject(a.Selection,a.Reorder,a.Resize,a.Toolbar,a.ColumnChooser),this.drillThroughGrid=new a.Grid({gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,toolbar:l,columns:this.frameGridColumns(),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing});var d=this;return this.parent.trigger(L,{cellInfo:e,gridObj:this.drillThroughGrid,type:"editing"}),this.parent.editSettings.allowEditing?(a.Grid.Inject(a.Edit,a.Page),this.drillThroughGrid.editSettings=this.parent.editSettings,this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,a.Grid.Inject(a.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick,this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1}),this.drillThroughGrid.actionComplete=function(e){"batchsave"!==e.requestType&&"save"!==e.requestType&&"delete"!==e.requestType||(d.isUpdated=!0),("Normal"===d.drillThroughGrid.editSettings.mode&&"save"===e.requestType&&d.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!d.parent.editSettings.allowCommandColumns||"batchsave"===e.requestType)&&d.dialogPopUp.hide()},this.drillThroughGrid.beforeBatchSave=function(){d.isUpdated=!0}):a.Grid.Inject(a.VirtualScroll),document.body.appendChild(s),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(s),i.appendChild(r),i.appendChild(s),i},e.prototype.frameGridColumns=function(){var e="olap"===this.parent.dataType?Object.keys(JSON.parse(this.engine.gridJSON)[0]):Object.keys(this.engine.fieldList),t=[];if("olap"===this.parent.dataType)for(var i=0,r=e;i<r.length;i++){var a=r[i];t.push({field:a.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join(""),headerText:a.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("."),width:120,visible:!0,validationRules:{required:!0},type:"string"})}else for(var n=0,o=e;n<o.length;n++){a=o[n];if("CalculatedField"!==this.engine.fieldList[a].aggregateType){var l="";l="number"===this.engine.fieldList[a].type?"numericedit":"date"===this.engine.fieldList[a].type?"datepickeredit":"",t.push({field:a,headerText:this.engine.fieldList[a].caption,width:120,visible:this.engine.fieldList[a].isSelected,validationRules:{required:!0},editType:l,type:"string"})}}return t},e.prototype.formatData=function(){for(var e=0;e<this.gridData.length;){for(var t=this.gridData[e],i=Object.keys(this.gridData[e]),r={},a=0;a<i.length;){r[i[a].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("")]=t[i[a]],a++}this.gridData[e]=r,e++}},e.prototype.dataWithPrimarykey=function(e){for(var t=Object.keys(e.currentCell.indexObject),i=this.gridData,r=0,a=0,n=i;a<n.length;a++){n[a].__index=t[r],this.gridIndexObjects[t[r].toString()]=Number(t[r]),r++}return i},e}(),yi=function(){function e(e){this.parent=e,this.drillThroughDialog=new vi(this.parent),this.addInternalEvents()}return e.prototype.getModuleName=function(){return"drillthrough"},e.prototype.addInternalEvents=function(){this.parent.on(H,this.wireEvents,this)},e.prototype.wireEvents=function(){this.unWireEvents(),t.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},e.prototype.unWireEvents=function(){t.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},e.prototype.mouseClickHandler=function(e){var t=e.target,i=null;t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")?i=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),i&&(this.parent.allowDrillThrough&&i.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing)&&this.executeDrillThrough(i)},e.prototype.executeDrillThrough=function(e){var t=Number(e.getAttribute("aria-colindex")),i=Number(e.getAttribute("index")),r=this.parent.pivotValues[i][t],a="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,n="",o="",l=[];if(void 0!==r.rowHeaders&&void 0!==r.columnHeaders&&void 0!==r.value){if("olap"===this.parent.dataType){var s="column"===a.valueAxis?a.tupColumnInfo[r.colOrdinal]:a.tupRowInfo[r.rowOrdinal];n=a.fieldList[s.measureName].caption,o=a.fieldList[s.measureName].aggregateType,this.parent.olapEngineModule.getDrillThroughData(r,this.parent.maxRowsForDrillThrough),l=JSON.parse(a.gridJSON)}else{n=a.fieldList[r.actualText.toString()]?a.fieldList[r.actualText.toString()].caption:r.actualText.toString(),o=a.fieldList[r.actualText]?a.fieldList[r.actualText].aggregateType:"";for(var d=0,p=Object.keys(r.indexObject);d<p.length;d++){var h=p[d];l.push(this.parent.dataSourceSettings.dataSource[Number(h)])}}var u="CalculatedField"===o?n.toString():""!==o?o+" "+this.parent.localeObj.getConstant("of")+" "+n:n,c={currentTarget:e,currentCell:r,rawData:l,rowHeaders:""===r.rowHeaders?"":r.rowHeaders.toString().split(".").join(" - "),columnHeaders:""===r.columnHeaders?"":r.columnHeaders.toString().split(".").join(" - "),value:u+"("+r.formattedText+")"};this.parent.trigger("drillThrough",c),this.drillThroughDialog.showDrillThroughDialog(c)}},e}(),Si=function(){function e(){this.headerColl={},this.maxLevel=0,this.columnGroupObject={},this.fieldPosition=[],this.measurePos=-1}return e.prototype.getModuleName=function(){return"pivotchart"},e.prototype.loadChart=function(e,i){this.parent=e,this.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=i;if(!("olap"===e.dataType?e.olapEngineModule.tupColumnInfo.length>0&&e.olapEngineModule.tupRowInfo.length>0&&(!t.isNullOrUndefined(e.olapEngineModule.colMeasurePos)||!t.isNullOrUndefined(e.olapEngineModule.rowMeasurePos)):e.dataSourceSettings.values.length>0))return this.parent.chart?(this.parent.chart.series=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=1,void this.parent.chart.refresh()):void this.parent.notify(H,{});this.chartSettings.enableMultiAxis?this.measureList=this.dataSourceSettings.values.map(function(e){return e.name}):this.measureList=[""===i.value?this.dataSourceSettings.values[0].name:i.value],this.columnGroupObject={};var r=this.engineModule.pivotValues;this.currentMeasure=i.enableMultiAxis?this.measureList[0]:(""===i.value||0===this.dataSourceSettings.values.filter(function(e){return e.name===i.value}).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:i.value;var a,n,o,l=this.getColumnTotalIndex(r),s=Object.keys(r),d={},p=0,h=-.5;this.headerColl={},this.maxLevel=0;var u,c={},g="",m="";"olap"===this.parent.dataType&&(c=this.groupHierarchyWithLevels(r),g=this.fieldPosition[this.fieldPosition.length-1],m=this.measurePos===this.fieldPosition.length-1&&this.fieldPosition.length>1?this.fieldPosition[this.fieldPosition.length-2]:g);for(var f=0,v=s;f<v.length;f++){var y=v[f],S=Number(y);if(r[S][0]&&"row"===r[S][0].axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==r[S][0].type)){var b=r[S][0],C="olap"===this.parent.dataType?this.engineModule.tupRowInfo[b.ordinal]:void 0,x=-1,w=b.level;"olap"===this.parent.dataType?(x=C.uNameCollection.split("::").length-1,3===b.memberType||C.measureName&&C.measureName!==this.dataSourceSettings.values[0].name||(d=0===(p=(n=void 0===n?b.levelUniqueName:n)===b.levelUniqueName?0:p)?{}:d,p=o&&n!==b.levelUniqueName?o.hierarchy===b.hierarchy?p+(b.level-o.level):t.isNullOrUndefined(d[b.levelUniqueName])?c[b.hierarchy].start:d[b.levelUniqueName]:p,d[b.levelUniqueName]=p,w=p,h+=o&&m===o.hierarchy&&!o.isDrilled?1:0,a=p,o=b)):"value"!==b.type&&(void 0===a||a<w||h++,a=w),this.maxLevel=w>this.maxLevel?w:this.maxLevel;var T="olap"===this.parent.dataType?b.formattedText:b.actualText?b.actualText.toString():b.formattedText.toString(),M=b.hasChild?(b.isDrilled?" - ":" + ")+T:T,D=C?C.uNameCollection:b.valueSort.levelName.toString(),E={name:T,text:M,hasChild:b.hasChild,isDrilled:b.isDrilled,levelName:D,level:w,fieldName:b.valueSort.axis?b.valueSort.axis.toString():"",rowIndex:S,colIndex:0,cell:b};("olap"===this.parent.dataType?3!==b.memberType:"value"!==b.type)&&(this.headerColl[h]?this.headerColl[h][w]=E:(this.headerColl[h]={},this.headerColl[h][w]=E));var L=r[S],O=Object.keys(L),P=void 0;u="olap"===this.parent.dataType?3!==b.memberType?b:u:"value"!==b.type?b:u;for(var N=0,I=O;N<I.length;N++){var A=I[N],F=Number(A),q=r[S][F],R=""!==q.rowHeaders||0===this.dataSourceSettings.rows.length,j="olap"===this.parent.dataType&&C&&C.measureName?C.measureName:q.actualText;if(!l[q.colIndex]&&"value"===q.axis&&"header"!==b.type&&(i.enableMultiAxis||j===this.currentMeasure)){if("olap"===this.parent.dataType?g!==b.hierarchy||(3===b.memberType&&P?x!==this.measurePos||P.isDrilled:b.isDrilled):("value"===b.type&&P?P.members.length>0:b.members.length>0)||!R)break;var k="olap"===this.parent.dataType?q.columnHeaders.toString().split(/~~|::/).join(" - "):q.columnHeaders.toString().split(".").join(" - "),V="olap"===this.parent.dataType?q.rowHeaders.toString().split(/~~|::/).join(" - "):q.rowHeaders.toString().split(".").join(" - "),_=k+" | "+j;this.columnGroupObject[_]?this.columnGroupObject[_].push({x:0===this.dataSourceSettings.rows.length?b.formattedText:V,y:Number(q.value)}):this.columnGroupObject[_]=[{x:0===this.dataSourceSettings.rows.length?b.formattedText:V,y:Number(q.value)}]}P=u}}}this.refreshChart()},e.prototype.refreshChart=function(){this.chartSeries=[];var e=Object.keys(this.columnGroupObject);this.persistSettings=JSON.parse(this.parent.getPersistData()).chartSettings;for(var i=0,r=e;i<r.length;i++){var a=r[i],n={};(n=this.persistSettings.chartSeries?this.frameObjectWithKeys(this.persistSettings.chartSeries):n).dataSource=this.columnGroupObject[a],n.xName="x",n.yName="y",n.name=this.chartSettings.enableMultiAxis?a:a.split(" | ")[0],"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(n.yAxisName=a.split(" | ")[1]),this.chartSeries=this.chartSeries.concat(n)}var o={series:this.chartSeries,cancel:!1};this.parent.trigger(I,o),o.cancel?(this.element&&t.remove(this.element),this.parent.notify(H,{})):this.bindChart()},e.prototype.frameObjectWithKeys=function(e){for(var t=Object.keys(e),i=0,r={};i<t.length;)r[t[i]]=e[t[i]],i++;return r},e.prototype.bindChart=function(){var e=this.configXAxis(),i=this.configTooltipSettings(),r=this.configLegendSettings(),a=this.configZoomSettings(),n=this.frameAxesWithRows(),o=this.chartSettings.chartSeries.type;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:t.createElement("div",{className:Vt,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector(".e-grid")):this.parent.element.appendChild(this.element?this.element:t.createElement("div",{className:Vt,id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild(t.createElement("div",{className:Vt,id:this.parent.element.id+"_chart"}))),this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=this.chartSeries,this.parent.chart.primaryXAxis=e,"Polar"===o||"Radar"===o?(this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=n.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.axes=n.axes,this.parent.chart.rows=n.rows),this.parent.chart.refresh()):(this.parent.showGroupingBar?this.element.style.minWidth="400px !important":this.element.style.minWidth="310px !important",p.Chart.Inject(p.ColumnSeries,p.StackingColumnSeries,p.RangeColumnSeries,p.BarSeries,p.StackingBarSeries,p.ScatterSeries,p.BubbleSeries,p.LineSeries,p.StepLineSeries,p.SplineSeries,p.SplineAreaSeries,p.MultiColoredLineSeries,p.PolarSeries,p.RadarSeries,p.AreaSeries,p.RangeAreaSeries,p.StackingAreaSeries,p.StepAreaSeries,p.MultiColoredAreaSeries,p.ParetoSeries,p.Legend,p.Tooltip,p.Category,p.MultiLevelLabel,p.ScrollBar,p.Zoom,p.Export,p.Crosshair),this.parent.chart=new p.Chart({series:this.chartSeries,legendSettings:r,tooltip:i,zoomSettings:a,axes:"Polar"===o||"Radar"===o?[]:n.axes,rows:"Polar"===o||"Radar"===o?[{}]:n.rows,primaryYAxis:"Polar"===o||"Radar"===o?n.axes[0]:{visible:!1},primaryXAxis:e,width:this.parent.width.toString(),height:this.parent.height.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:this.chartSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.chartSettings.pointClick?this.chartSettings.pointClick.bind(this):void 0,chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,dragComplete:this.chartSettings.dragComplete?this.chartSettings.dragComplete.bind(this):void 0,zoomComplete:this.chartSettings.zoomComplete?this.chartSettings.zoomComplete.bind(this):void 0,scrollStart:this.chartSettings.scrollStart?this.chartSettings.scrollStart.bind(this):void 0,scrollEnd:this.chartSettings.scrollEnd?this.chartSettings.scrollEnd.bind(this):void 0,scrollChanged:this.chartSettings.scrollChanged?this.chartSettings.scrollChanged.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this)}),this.parent.chart.isStringTemplate=!0,this.parent.chart.appendTo("#"+this.parent.element.id+"_chart"))},e.prototype.frameAxesWithRows=function(){var e=[],t=[],i=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type);if(this.chartSettings.enableMultiAxis)for(var r=0,a=100/this.dataSourceSettings.values.length+"%",n=0,o=this.dataSourceSettings.values;n<o.length;n++){for(var l=o[n],s=this.engineModule.fieldList[l.name],d=this.parent.localeObj.getConstant(s.aggregateType)+" of "+s.caption,p=void 0,h=0,u=this.dataSourceSettings.formatSettings;h<u.length;h++){var c=u[h];if(c.name===l.name){p=c;break}}var g="olap"===this.parent.dataType?this.getFormat(s.formatString):p?p.format:"N",m="Polar"===this.chartSettings.chartSeries.type||"Radar"===this.chartSettings.chartSeries.type,f={};(f=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):f).labelFormat=f.labelFormat?f.labelFormat:i?"":m?"N":g,f.title=f.title?f.title:d,f.plotOffset=f.plotOffset?f.plotOffset:r%2!=0?30:0,f.rowIndex=r,m||(f.name=l.name),e=e.concat(f),t.push({height:a}),r++}else{s=this.engineModule.fieldList[this.currentMeasure],d=this.parent.localeObj.getConstant(s.aggregateType)+" of "+s.caption,p=void 0;for(var v=0,y=this.dataSourceSettings.formatSettings;v<y.length;v++){if((l=y[v]).name===this.currentMeasure){p=l;break}}f={},g="olap"===this.parent.dataType?this.getFormat(s.formatString):p?p.format:"N";(f=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):f).rowIndex=0,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(f.name=this.currentMeasure),f.labelFormat=f.labelFormat?f.labelFormat:i?"":g,f.title=f.title?f.title:d,e=e.concat(f),t.push({height:"100%"})}return{axes:e,rows:t}},e.prototype.getFormat=function(e){return e="Currency"===e?"C":"Percent"===e?"P":"N"},e.prototype.getColumnTotalIndex=function(e){for(var t={},i=0,r=Object.keys(e);i<r.length;i++)for(var a=r[i],n=e[Number(a)],o=0,l=Object.keys(n);o<l.length;o++){var s=l[o],d=n[Number(s)];if("column"!==d.axis)return t;("sum"===d.type||0!==this.dataSourceSettings.columns.length&&"grand sum"===d.type)&&-1!==d.rowSpan&&(t[d.colIndex]=d.colIndex)}return t},e.prototype.groupHierarchyWithLevels=function(e){var i,r;this.fieldPosition=[];var a={},n=0,o={};this.measurePos=this.engineModule.tupRowInfo[0].measurePosition;for(var l=0;l<e.length;l++){var s=e[l][0];s&&"row"===s.axis&&"grand sum"!==s.type&&(t.isNullOrUndefined(a[s.hierarchy])?(3===s.memberType?n===this.measurePos?(this.fieldPosition[this.measurePos]=s.hierarchy,a[s.hierarchy]=(i={},i[s.levelUniqueName]=s.levelUniqueName,i)):n--:(this.fieldPosition[n]=s.hierarchy,a[s.hierarchy]=(r={},r[s.levelUniqueName]=s.levelUniqueName,r)),n++):a[s.hierarchy][s.levelUniqueName]=s.levelUniqueName)}for(var d=-1,p=0;p<this.fieldPosition.length;p++)this.measurePos!==p&&(o[this.fieldPosition[p]]={start:d+1,end:d+Object.keys(a[this.fieldPosition[p]]).length},d=o[this.fieldPosition[p]].end);return o},e.prototype.frameMultiLevelLabels=function(){for(var e=Object.keys(this.headerColl),t=this.headerColl[-.5],i=0,r=e;i<r.length;i++){for(var a=r[i],n=Number(a),o=this.headerColl[n],l=0,s=!1;l<=this.maxLevel;)s?o[l]||(o[l]={name:o[l-1].name,text:"",hasChild:o[l-1].hasChild,isDrilled:o[l-1].isDrilled,levelName:o[l-1].levelName,level:o[l-1].level,fieldName:o[l-1].fieldName,rowIndex:o[l-1].rowIndex,colIndex:o[l-1].colIndex,span:-1}):o[l]?s=!0:o[l]=t[l],l++;t=this.headerColl[n]}for(var d={},p=0,h=e;p<h.length;p++){a=h[p],n=Number(a),o=this.headerColl[n];for(var u=0,c=Object.keys(o);u<c.length;u++){var g=c[u],m=Number(g);if(d[m]){var f=d[m].length;o[m].levelName===t[m].levelName?d[m][f-1].end=d[m][f-1].end+1:d[m].push({start:n,end:n+1,text:o[m].text,type:-1===o[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:o[m]})}else d[m]=[{start:n,end:n+1,text:o[m].text,type:-1===o[m].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:o[m]}]}t=o}for(var v=[],y=Object.keys(d).length-1;y>-1;y--)v.push({categories:d[y],border:{width:1},overflow:"Trim"});return v},e.prototype.getZoomFactor=function(){isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.calculatedWidth=this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?this.calculatedWidth=Number(this.parent.width.toString().split("px")[0]):this.calculatedWidth=this.parent.element.clientWidth:this.calculatedWidth=Number(this.parent.width);var e=10*this.chartSeries.length>120?10*this.chartSeries.length:120,t=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*e):1;return t=t<1&&t>0?t:1},e.prototype.configTooltipSettings=function(){var e=this.chartSettings.tooltip;return e.enable=void 0===e.enable||e.enable,e.header=e.header?e.header:"",e.enableMarker=void 0===e.enableMarker||e.enableMarker,e},e.prototype.configLegendSettings=function(){var e={};return e=this.chartSettings.legendSettings?this.chartSettings.legendSettings:e,e.padding=e.padding?e.padding:25,e.shapePadding=e.shapePadding?e.shapePadding:10,e},e.prototype.configXAxis=function(){var e={};return e=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):e,e.valueType="Category",e.labelIntersectAction=e.labelIntersectAction?e.labelIntersectAction:"Rotate45",e.title=e.title?e.title:this.dataSourceSettings.rows.map(function(e){return e.caption||e.name}).join(" / "),e.zoomFactor=this.getZoomFactor(),this.chartSettings.showMultiLevelLabels&&(e.multiLevelLabels=this.frameMultiLevelLabels(),e.border={width:1,type:"WithoutTopandBottomBorder"},e.majorTickLines={width:0,height:-10}),e},e.prototype.configZoomSettings=function(){var e=this.chartSettings.zoomSettings;return e.enableSelectionZooming=void 0===e.enableSelectionZooming||e.enableSelectionZooming,e.enableScrollbar=void 0===e.enableScrollbar||e.enableScrollbar,e},e.prototype.tooltipRender=function(e){var t=this.engineModule.fieldList[e.series.yAxisName?e.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultiAxis?e.series.name.split(" | ")[1]:this.currentMeasure],i=this.parent.localeObj.getConstant(t.aggregateType)+" of "+t.caption,r="olap"===this.parent.dataType?e.point.y:this.engineModule.formatFields[t.id]&&this.chartSettings.useGroupingSeparator?this.parent.engineModule.getFormattedValue(e.point.y,t.id).formattedText:e.text.split("<b>")[1].split("</b>")[0];e.text=i+": "+r+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+e.series.name.split(" | ")[0])+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+e.point.x),this.parent.trigger(P,e)},e.prototype.loaded=function(e){if(this.parent.isChartLoaded=!0,this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels){var i=g.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0";t.isNullOrUndefined(this.parent.element.querySelector("#"+this.parent.element.id+i))||this.parent.element.querySelector("#"+this.parent.element.id+i).setAttribute("cursor","pointer")}this.parent.notify(H,{}),this.parent.trigger("chartLoaded",e)},e.prototype.axisLabelRender=function(e){this.chartSettings.showMultiLevelLabels&&"primaryXAxis"===e.axis.name&&(e.text=""),this.parent.trigger(N,e)},e.prototype.multiLevelLabelClick=function(e){e.customAttributes&&e.customAttributes.hasChild&&("olap"===this.parent.dataType?this.parent.onDrill(void 0,e.customAttributes):this.onDrill(e))},e.prototype.onDrill=function(e){var t=e.customAttributes,i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",a=t.fieldName,n=this.engineModule.pivotValues[t.rowIndex][t.colIndex],o=n.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),l=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:a,items:[o],delimiter:i}]}},!0);else{for(var s=0;s<this.dataSourceSettings.drilledMembers.length;s++){var d=this.dataSourceSettings.drilledMembers[s];if(o=o.split(i).join(d.delimiter?d.delimiter:i),i=d.delimiter=d.delimiter?d.delimiter:i,d.name===a){l=!0;var p=d.items.indexOf(o);p>-1?d.items.splice(p,1):d.items.push(o)}}l||this.dataSourceSettings.drilledMembers.push({name:a,items:[o],delimiter:i})}r.showSpinner(this.parent.element);var h={fieldName:a,memberName:o,delimiter:i,axis:"row",action:t.isDrilled?"up":"down",currentCell:n};this.parent.trigger("drill",{drillInfo:h,pivotview:this}),this.parent.enableVirtualization?(this.engineModule.drilledMembers=this.dataSourceSettings.drilledMembers,this.engineModule.onDrill(h)):this.engineModule.generateGridData(this.dataSourceSettings),this.parent.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.parent.renderPivotGrid()},e.prototype.load=function(e){e.chart.zoomModule&&(e.chart.zoomModule.isZoomed=!0),this.parent.trigger("chartLoad",e)},e.prototype.resized=function(e){e.chart.primaryXAxis.zoomFactor=this.getZoomFactor(),this.parent.trigger("chartResized",e)},e.prototype.destroy=function(){},e}(),bi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ci=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},xi=(function(){function e(){}Ci([t.Property("")],e.prototype,"color",void 0),Ci([t.Property(1)],e.prototype,"width",void 0)}(),function(){function e(){}Ci([t.Property(!0)],e.prototype,"enable",void 0),Ci([t.Property(1e3)],e.prototype,"duration",void 0),Ci([t.Property(0)],e.prototype,"delay",void 0)}(),function(){function e(){}Ci([t.Property(null)],e.prototype,"value",void 0),Ci([t.Property(null)],e.prototype,"color",void 0),Ci([t.Property("0")],e.prototype,"dashArray",void 0)}(),function(){function e(){}Ci([t.Property(!1)],e.prototype,"visible",void 0),Ci([t.Property("Circle")],e.prototype,"shape",void 0),Ci([t.Property("")],e.prototype,"imageUrl",void 0),Ci([t.Property(5)],e.prototype,"height",void 0),Ci([t.Property(5)],e.prototype,"width",void 0),Ci([t.Complex({width:2,color:null},p.Border)],e.prototype,"border",void 0),Ci([t.Property(null)],e.prototype,"fill",void 0),Ci([t.Property(1)],e.prototype,"opacity",void 0),Ci([t.Complex({},p.DataLabelSettings)],e.prototype,"dataLabel",void 0)}(),function(){function e(){}Ci([t.Property(!1)],e.prototype,"visible",void 0),Ci([t.Property("Fixed")],e.prototype,"type",void 0),Ci([t.Property("Both")],e.prototype,"direction",void 0),Ci([t.Property("Vertical")],e.prototype,"mode",void 0),Ci([t.Property(null)],e.prototype,"color",void 0),Ci([t.Property(1)],e.prototype,"verticalError",void 0),Ci([t.Property(1)],e.prototype,"width",void 0),Ci([t.Property(1)],e.prototype,"horizontalError",void 0),Ci([t.Property(3)],e.prototype,"verticalPositiveError",void 0),Ci([t.Property(3)],e.prototype,"verticalNegativeError",void 0),Ci([t.Property(1)],e.prototype,"horizontalPositiveError",void 0),Ci([t.Property(1)],e.prototype,"horizontalNegativeError",void 0),Ci([t.Complex(null,p.ErrorBarCapSettings)],e.prototype,"errorBarCap",void 0)}(),function(){function e(){}Ci([t.Property("")],e.prototype,"name",void 0),Ci([t.Property("Linear")],e.prototype,"type",void 0),Ci([t.Property(2)],e.prototype,"period",void 0),Ci([t.Property(2)],e.prototype,"polynomialOrder",void 0),Ci([t.Property(0)],e.prototype,"backwardForecast",void 0),Ci([t.Property(0)],e.prototype,"forwardForecast",void 0),Ci([t.Complex({},p.Animation)],e.prototype,"animation",void 0),Ci([t.Complex({},p.MarkerSettings)],e.prototype,"marker",void 0),Ci([t.Property(!0)],e.prototype,"enableTooltip",void 0),Ci([t.Property(null)],e.prototype,"intercept",void 0),Ci([t.Property("")],e.prototype,"fill",void 0),Ci([t.Property(1)],e.prototype,"width",void 0),Ci([t.Property("SeriesType")],e.prototype,"legendShape",void 0)}(),function(){function e(){}Ci([t.Property(null)],e.prototype,"fill",void 0),Ci([t.Complex({color:"transparent",width:0},p.Border)],e.prototype,"border",void 0),Ci([t.Property("Gap")],e.prototype,"mode",void 0)}(),function(){function e(){}Ci([t.Property(0)],e.prototype,"topLeft",void 0),Ci([t.Property(0)],e.prototype,"topRight",void 0),Ci([t.Property(0)],e.prototype,"bottomLeft",void 0),Ci([t.Property(0)],e.prototype,"bottomRight",void 0)}(),function(){function e(){}Ci([t.Property("Normal")],e.prototype,"fontStyle",void 0),Ci([t.Property("16px")],e.prototype,"size",void 0),Ci([t.Property("Normal")],e.prototype,"fontWeight",void 0),Ci([t.Property("")],e.prototype,"color",void 0),Ci([t.Property("Center")],e.prototype,"textAlignment",void 0),Ci([t.Property("Segoe UI")],e.prototype,"fontFamily",void 0),Ci([t.Property(1)],e.prototype,"opacity",void 0),Ci([t.Property("Trim")],e.prototype,"textOverflow",void 0)}(),function(){function e(){}Ci([t.Property(!1)],e.prototype,"enable",void 0),Ci([t.Property(null)],e.prototype,"fill",void 0),Ci([t.Complex(p.Theme.crosshairLabelFont,p.Font)],e.prototype,"textStyle",void 0)}(),function(){function e(){}Ci([t.Property(1)],e.prototype,"width",void 0),Ci([t.Property(5)],e.prototype,"height",void 0),Ci([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}Ci([t.Property(1)],e.prototype,"width",void 0),Ci([t.Property("")],e.prototype,"dashArray",void 0),Ci([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}Ci([t.Property(.7)],e.prototype,"width",void 0),Ci([t.Property(5)],e.prototype,"height",void 0),Ci([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}Ci([t.Property(.7)],e.prototype,"width",void 0),Ci([t.Property("")],e.prototype,"dashArray",void 0),Ci([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}Ci([t.Property(1)],e.prototype,"width",void 0),Ci([t.Property("")],e.prototype,"dashArray",void 0),Ci([t.Property(null)],e.prototype,"color",void 0)}(),function(){function e(){}Ci([t.Property(!0)],e.prototype,"visible",void 0),Ci([t.Property(!1)],e.prototype,"startFromAxis",void 0),Ci([t.Property(null)],e.prototype,"start",void 0),Ci([t.Property(null)],e.prototype,"end",void 0),Ci([t.Property(null)],e.prototype,"size",void 0),Ci([t.Property("#808080")],e.prototype,"color",void 0),Ci([t.Property(null)],e.prototype,"dashArray",void 0),Ci([t.Property("Auto")],e.prototype,"sizeType",void 0),Ci([t.Property(!1)],e.prototype,"isRepeat",void 0),Ci([t.Property(null)],e.prototype,"repeatEvery",void 0),Ci([t.Property(null)],e.prototype,"repeatUntil",void 0),Ci([t.Property(!1)],e.prototype,"isSegmented",void 0),Ci([t.Property(null)],e.prototype,"segmentStart",void 0),Ci([t.Property(null)],e.prototype,"segmentEnd",void 0),Ci([t.Property(null)],e.prototype,"segmentAxisName",void 0),Ci([t.Complex({color:"transparent",width:1},p.Border)],e.prototype,"border",void 0),Ci([t.Property("")],e.prototype,"text",void 0),Ci([t.Property(null)],e.prototype,"rotation",void 0),Ci([t.Property("Middle")],e.prototype,"horizontalAlignment",void 0),Ci([t.Property("Middle")],e.prototype,"verticalAlignment",void 0),Ci([t.Complex(p.Theme.stripLineLabelFont,p.Font)],e.prototype,"textStyle",void 0),Ci([t.Property("Behind")],e.prototype,"zIndex",void 0),Ci([t.Property(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}Ci([t.Property("")],e.prototype,"color",void 0),Ci([t.Property(1)],e.prototype,"width",void 0),Ci([t.Property("Rectangle")],e.prototype,"type",void 0)}(),function(){function e(){}Ci([t.Complex({},p.Border)],e.prototype,"border",void 0),Ci([t.Property("transparent")],e.prototype,"background",void 0),Ci([t.Property(1)],e.prototype,"opacity",void 0)}(),function(){function e(){}Ci([t.Property(!1)],e.prototype,"enable",void 0),Ci([t.Property("")],e.prototype,"dashArray",void 0),Ci([t.Complex({color:null,width:1},p.Border)],e.prototype,"line",void 0),Ci([t.Property("Both")],e.prototype,"lineType",void 0)}(),function(){function e(){}Ci([t.Property(!0)],e.prototype,"visible",void 0),Ci([t.Property(null)],e.prototype,"height",void 0),Ci([t.Property(null)],e.prototype,"width",void 0),Ci([t.Complex({x:0,y:0},Location)],e.prototype,"location",void 0),Ci([t.Property("Auto")],e.prototype,"position",void 0),Ci([t.Property(8)],e.prototype,"padding",void 0),Ci([t.Property("Center")],e.prototype,"alignment",void 0),Ci([t.Complex(p.Theme.legendLabelFont,p.Font)],e.prototype,"textStyle",void 0),Ci([t.Property(10)],e.prototype,"shapeHeight",void 0),Ci([t.Property(10)],e.prototype,"shapeWidth",void 0),Ci([t.Complex({},p.Border)],e.prototype,"border",void 0),Ci([t.Complex({left:0,right:0,top:0,bottom:0},p.Margin)],e.prototype,"margin",void 0),Ci([t.Property(5)],e.prototype,"shapePadding",void 0),Ci([t.Property("transparent")],e.prototype,"background",void 0),Ci([t.Property(1)],e.prototype,"opacity",void 0),Ci([t.Property(!0)],e.prototype,"toggleVisibility",void 0),Ci([t.Property(null)],e.prototype,"description",void 0),Ci([t.Property(3)],e.prototype,"tabIndex",void 0)}(),function(){function e(){}Ci([t.Property(0)],e.prototype,"series",void 0),Ci([t.Property(0)],e.prototype,"point",void 0)}(),function(){function e(){}Ci([t.Property(10)],e.prototype,"left",void 0),Ci([t.Property(10)],e.prototype,"right",void 0),Ci([t.Property(10)],e.prototype,"top",void 0),Ci([t.Property(10)],e.prototype,"bottom",void 0)}(),function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return bi(i,e),Ci([t.Property(null)],i.prototype,"fill",void 0),Ci([t.Complex(null,p.Animation)],i.prototype,"animation",void 0),Ci([t.Property("0")],i.prototype,"dashArray",void 0),Ci([t.Property(1)],i.prototype,"width",void 0),Ci([t.Property("X")],i.prototype,"segmentAxis",void 0),Ci([t.Property("Line")],i.prototype,"drawType",void 0),Ci([t.Property(!0)],i.prototype,"isClosed",void 0),Ci([t.Collection([],p.ChartSegment)],i.prototype,"segments",void 0),Ci([t.Property("")],i.prototype,"stackingGroup",void 0),Ci([t.Complex({color:"transparent",width:0},p.Border)],i.prototype,"border",void 0),Ci([t.Property(!0)],i.prototype,"visible",void 0),Ci([t.Property(1)],i.prototype,"opacity",void 0),Ci([t.Property("Line")],i.prototype,"type",void 0),Ci([t.Complex(null,p.MarkerSettings)],i.prototype,"marker",void 0),Ci([t.Complex(null,p.ErrorBarSettings)],i.prototype,"errorBar",void 0),Ci([t.Property(!0)],i.prototype,"enableTooltip",void 0),Ci([t.Collection([],p.Trendline)],i.prototype,"trendlines",void 0),Ci([t.Property("")],i.prototype,"tooltipMappingName",void 0),Ci([t.Property("SeriesType")],i.prototype,"legendShape",void 0),Ci([t.Property(1)],i.prototype,"minRadius",void 0),Ci([t.Property(null)],i.prototype,"selectionStyle",void 0),Ci([t.Property("Natural")],i.prototype,"splineType",void 0),Ci([t.Property(3)],i.prototype,"maxRadius",void 0),Ci([t.Property(.5)],i.prototype,"cardinalSplineTension",void 0),Ci([t.Property(null)],i.prototype,"columnWidth",void 0),Ci([t.Complex(null,p.EmptyPointSettings)],i.prototype,"emptyPointSettings",void 0),Ci([t.Complex(null,p.CornerRadius)],i.prototype,"cornerRadius",void 0),Ci([t.Property(0)],i.prototype,"columnSpacing",void 0),i}(t.ChildProperty)),wi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return bi(i,e),Ci([t.Property("Rotate45")],i.prototype,"labelIntersectAction",void 0),Ci([t.Complex(p.Theme.axisLabelFont,p.Font)],i.prototype,"labelStyle",void 0),Ci([t.Property("")],i.prototype,"title",void 0),Ci([t.Complex({},p.CrosshairTooltip)],i.prototype,"crosshairTooltip",void 0),Ci([t.Property("")],i.prototype,"labelFormat",void 0),Ci([t.Complex(p.Theme.axisTitleFont,p.Font)],i.prototype,"titleStyle",void 0),Ci([t.Property(!1)],i.prototype,"isIndexed",void 0),Ci([t.Property(0)],i.prototype,"plotOffset",void 0),Ci([t.Property("None")],i.prototype,"edgeLabelPlacement",void 0),Ci([t.Property("BetweenTicks")],i.prototype,"labelPlacement",void 0),Ci([t.Property("Outside")],i.prototype,"tickPosition",void 0),Ci([t.Property(!1)],i.prototype,"opposedPosition",void 0),Ci([t.Property(!0)],i.prototype,"visible",void 0),Ci([t.Property("Outside")],i.prototype,"labelPosition",void 0),Ci([t.Property(0)],i.prototype,"labelRotation",void 0),Ci([t.Property(0)],i.prototype,"minorTicksPerInterval",void 0),Ci([t.Property(null)],i.prototype,"maximum",void 0),Ci([t.Property(null)],i.prototype,"minimum",void 0),Ci([t.Property(34)],i.prototype,"maximumLabelWidth",void 0),Ci([t.Property(null)],i.prototype,"interval",void 0),Ci([t.Complex({},p.MajorTickLines)],i.prototype,"majorTickLines",void 0),Ci([t.Property(!1)],i.prototype,"enableTrim",void 0),Ci([t.Complex({},p.MajorGridLines)],i.prototype,"majorGridLines",void 0),Ci([t.Complex({},p.MinorTickLines)],i.prototype,"minorTickLines",void 0),Ci([t.Complex({},p.AxisLine)],i.prototype,"lineStyle",void 0),Ci([t.Complex({},p.MinorGridLines)],i.prototype,"minorGridLines",void 0),Ci([t.Property(!1)],i.prototype,"isInversed",void 0),Ci([t.Property(null)],i.prototype,"description",void 0),Ci([t.Property(0)],i.prototype,"startAngle",void 0),Ci([t.Property(100)],i.prototype,"coefficient",void 0),Ci([t.Collection([],p.StripLineSettings)],i.prototype,"stripLines",void 0),Ci([t.Property(2)],i.prototype,"tabIndex",void 0),Ci([t.Complex({color:null,width:0,type:"Rectangle"},p.LabelBorder)],i.prototype,"border",void 0),i}(t.ChildProperty),Ti=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return bi(i,e),Ci([t.Property(!1)],i.prototype,"enableMarker",void 0),Ci([t.Property(!0)],i.prototype,"enable",void 0),Ci([t.Property(null)],i.prototype,"fill",void 0),Ci([t.Property(!1)],i.prototype,"shared",void 0),Ci([t.Property(.75)],i.prototype,"opacity",void 0),Ci([t.Property(null)],i.prototype,"header",void 0),Ci([t.Property(null)],i.prototype,"format",void 0),Ci([t.Complex(p.Theme.tooltipLabelFont,p.Font)],i.prototype,"textStyle",void 0),Ci([t.Property(null)],i.prototype,"template",void 0),Ci([t.Complex({color:"#cccccc",width:.5},p.Border)],i.prototype,"border",void 0),Ci([t.Property(!0)],i.prototype,"enableAnimation",void 0),i}(t.ChildProperty),Mi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return bi(i,e),Ci([t.Property(!1)],i.prototype,"enablePinchZooming",void 0),Ci([t.Property(!0)],i.prototype,"enableSelectionZooming",void 0),Ci([t.Property(!1)],i.prototype,"enableDeferredZooming",void 0),Ci([t.Property(!1)],i.prototype,"enableMouseWheelZooming",void 0),Ci([t.Property("XY")],i.prototype,"mode",void 0),Ci([t.Property(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],i.prototype,"toolbarItems",void 0),Ci([t.Property(!0)],i.prototype,"enableScrollbar",void 0),Ci([t.Property(!1)],i.prototype,"enablePan",void 0),i}(t.ChildProperty),Di=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return bi(i,e),Ci([t.Complex({},xi)],i.prototype,"chartSeries",void 0),Ci([t.Complex({},wi)],i.prototype,"primaryXAxis",void 0),Ci([t.Complex({},wi)],i.prototype,"primaryYAxis",void 0),Ci([t.Property("")],i.prototype,"value",void 0),Ci([t.Property(!1)],i.prototype,"enableMultiAxis",void 0),Ci([t.Complex(p.Theme.chartTitleFont,p.Font)],i.prototype,"titleStyle",void 0),Ci([t.Property("")],i.prototype,"title",void 0),Ci([t.Complex(p.Theme.chartSubTitleFont,p.Font)],i.prototype,"subTitleStyle",void 0),Ci([t.Property("")],i.prototype,"subTitle",void 0),Ci([t.Complex({color:"#DDDDDD",width:0},p.Border)],i.prototype,"border",void 0),Ci([t.Complex({},p.Margin)],i.prototype,"margin",void 0),Ci([t.Complex({border:{color:null,width:.5},background:"transparent"},p.ChartArea)],i.prototype,"chartArea",void 0),Ci([t.Property(null)],i.prototype,"background",void 0),Ci([t.Property("Material")],i.prototype,"theme",void 0),Ci([t.Property([])],i.prototype,"palettes",void 0),Ci([t.Complex({},p.CrosshairSettings)],i.prototype,"crosshair",void 0),Ci([t.Complex({},Ti)],i.prototype,"tooltip",void 0),Ci([t.Complex({},Mi)],i.prototype,"zoomSettings",void 0),Ci([t.Property()],i.prototype,"legendSettings",void 0),Ci([t.Property("None")],i.prototype,"selectionMode",void 0),Ci([t.Property(!0)],i.prototype,"enableExport",void 0),Ci([t.Property(!1)],i.prototype,"isMultiSelect",void 0),Ci([t.Collection([],p.Indexes)],i.prototype,"selectedDataIndexes",void 0),Ci([t.Property(!0)],i.prototype,"enableAnimation",void 0),Ci([t.Property(!0)],i.prototype,"useGroupingSeparator",void 0),Ci([t.Property(!1)],i.prototype,"isTransposed",void 0),Ci([t.Property(1)],i.prototype,"tabIndex",void 0),Ci([t.Property(null)],i.prototype,"description",void 0),Ci([t.Event()],i.prototype,"resized",void 0),Ci([t.Property(!0)],i.prototype,"enableSideBySidePlacement",void 0),Ci([t.Event()],i.prototype,"loaded",void 0),Ci([t.Event()],i.prototype,"beforePrint",void 0),Ci([t.Event()],i.prototype,"animationComplete",void 0),Ci([t.Event()],i.prototype,"load",void 0),Ci([t.Event()],i.prototype,"textRender",void 0),Ci([t.Event()],i.prototype,"legendRender",void 0),Ci([t.Event()],i.prototype,"seriesRender",void 0),Ci([t.Event()],i.prototype,"pointRender",void 0),Ci([t.Event()],i.prototype,"tooltipRender",void 0),Ci([t.Event()],i.prototype,"axisLabelRender",void 0),Ci([t.Event()],i.prototype,"chartMouseClick",void 0),Ci([t.Event()],i.prototype,"chartMouseMove",void 0),Ci([t.Event()],i.prototype,"pointMove",void 0),Ci([t.Event()],i.prototype,"pointClick",void 0),Ci([t.Event()],i.prototype,"chartMouseDown",void 0),Ci([t.Event()],i.prototype,"chartMouseLeave",void 0),Ci([t.Event()],i.prototype,"dragComplete",void 0),Ci([t.Event()],i.prototype,"chartMouseUp",void 0),Ci([t.Event()],i.prototype,"scrollStart",void 0),Ci([t.Event()],i.prototype,"zoomComplete",void 0),Ci([t.Event()],i.prototype,"scrollChanged",void 0),Ci([t.Event()],i.prototype,"scrollEnd",void 0),Ci([t.Property(!0)],i.prototype,"showMultiLevelLabels",void 0),i}(t.ChildProperty),Ei=function(){function e(){}return e.getCellSets=function(e,i,r,a,n){this.engine=i,this.isMondrian=i.isMondrian,this.isMeasureAvail=i.isMeasureAvail,this.isPaging=i.isPaging,this.pageSettings=i.pageSettings,this.rows=i.rows,this.columns=i.columns,this.values=i.values,this.filters=i.filters,this.allowLabelFilter=i.allowLabelFilter,this.allowValueFilter=i.allowValueFilter,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.drilledMembers=i.updateDrilledItems(e.drilledMembers),this.calculatedFieldSettings=i.calculatedFieldSettings,this.valueAxis="row"===e.valueAxis?"rows":"columns",a&&(a.axis="row"===a.axis?"rows":"columns"),this.filterMembers=t.extend({},i.filterMembers,null,!0),this.fieldDataObj=i.fieldListObj,this.fieldList=i.fieldList,this.cellSetInfo="\nDIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE";var o=this.getMeasuresQuery(this.values),l=this.getDimensionsQuery(this.rows,o,"rows",a).replace(/\&/g,"&amp;"),s=this.getDimensionsQuery(this.columns,o,"columns",a).replace(/\&/g,"&amp;");if(this.isPaging&&r&&void 0!==this.pageSettings&&""!==l&&""!==s){l=(d=this.getPagingQuery(l,s)).rowQuery,s=d.columnQuery}else if(this.isPaging&&!r&&void 0!==this.pageSettings&&""!==l&&""!==s){var d;l=(d=this.getPagingCountQuery(l,s)).rowQuery,s=d.columnQuery}l=l.length>0?l+(this.isPaging&&!r?"":this.cellSetInfo+" ON ROWS"):"",s=s.length>0?s+(this.isPaging&&!r?"":this.cellSetInfo+" ON COLUMNS"):"";var p=this.getSlicersQuery(this.filters,"filters").replace(/\&/g,"&amp;"),h=this.getfilterQuery(this.filterMembers,e.cube).replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;"),u=this.getCalculatedFieldQuery(this.calculatedFieldSettings).replace(/\&/g,"&amp;"),c=this.frameMDXQuery(l,s,p,h,u,r),g={catalog:e.catalog,cube:e.cube,url:e.url,request:c,LCID:e.localeIdentifier.toString()};i.mdxQuery=c.replace(/\&amp;/g,"&").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/%280/g,'"'),console.log(i.mdxQuery),a&&(a.axis="rows"===a.axis?"row":"column"),n||this.getTableCellData(g,this.isPaging&&!r?this.engine.generatePagingData.bind(this.engine):this.engine.generateEngine.bind(this.engine),a?{action:a.action,drillInfo:a}:{dataSourceSettings:e,action:"loadTableElements"})},e.getTableCellData=function(e,t,i){var r=this.engine.getConnectionInfo(e.url,e.LCID),a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement>'+e.request+"</Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+r.LCID+"</LocaleIdentifier> </PropertyList> </Properties></Execute> </Body> </Envelope>";this.engine.doAjaxPost("POST",r.url,a,t,i)},e.frameMDXQuery=function(e,t,i,r,a,n){var o=this.isPaging&&!n?""!==a?"":"\nWITH":"\nSelect ";return t.length>0&&(o+=t),e.length>0&&(o=o+(t.length>0?this.isPaging&&!n?"":", ":"")+e),o=a+o+(this.isPaging&&!n?"\nMEMBER [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] AS Count([e16a30d0-2174-4874-8dae-a5085a75a3e2]) MEMBER [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] AS Count ([d1876d2b-e50e-4547-85fe-5b8ed9d629de])\nSELECT { [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] , [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] } ON AXIS(0)":"")+r+i+"\nCELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE\n"},e.getPagingQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e;return{rowQuery:""!==e?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")},"+((0===this.pageSettings.rowCurrentPage?1:this.pageSettings.rowCurrentPage)-1)+","+this.pageSettings.rowSize+")":"",columnQuery:""!==t?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")},"+((0===this.pageSettings.columnCurrentPage?1:this.pageSettings.columnCurrentPage)-1)+","+this.pageSettings.columnSize+")":""}},e.getPagingCountQuery=function(e,t){e=e.replace("NON EMPTY ( ","").slice(0,-1),t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=e;return{rowQuery:""!==e?"SET [d1876d2b-e50e-4547-85fe-5b8ed9d629de] as "+(this.isMondrian?"":"NONEMPTY")+" ("+e+(this.isMondrian||""===t?"":","+t)+")\n":"",columnQuery:""!==t?"\nSET [e16a30d0-2174-4874-8dae-a5085a75a3e2] as "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")\n":""}},e.getDimensionsQuery=function(e,t,i,r){var a="";if(e.length>0){a="\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"");for(var n=0;n<e.length;){0===n?"[measures]"===e[n].name.toLowerCase()?""!==t&&(a+=t):a+="({"+this.getDimensionQuery(e[n],i)+"})":"[measures]"===e[n].name.toLowerCase()?""!==t&&(a=a+" * "+t):a=a+" * "+("({"+this.getDimensionQuery(e[n],i)+"})"),n++}var o=this.getDrillQuery(e,t,i,r);a=r&&r.axis===i?"\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"")+o:a+(""!==o?",":"")+o,a=(this.valueAxis!==i?this.updateValueSortQuery(a,this.valueSortSettings):a)+(this.drilledMembers.length>0?"})":"")+")"}return a},e.getDrillQuery=function(e,t,i,r){var a="",n=[],o=!1,l="";r&&r.axis===i&&"down"===r.action.toLowerCase()?(o=!0,n=[{name:r.fieldName,items:[r.memberName],delimiter:"~~"}]):n=this.drilledMembers;for(var s=0,d=n;s<d.length;s++)for(var p=d[s],h=0,u=p.items;h<u.length;h++){for(var c=[],g=0,m=u[h].split(p.delimiter?p.delimiter:"~~");g<e.length;){if(m[g]&&-1!==m[g].indexOf(e[g].name))-1!==m[m.length-1].indexOf(e[g].name)?o?l=l+(""!==l?" * ":"")+"({"+m[g]+".CHILDREN})":c.push("("+m[g]+".CHILDREN)"):"[measures]"===m[g].toLowerCase()&&""!==t?o?l=l+(""!==l?" * ":"")+"("+t+")":c.push("("+t+")"):-1!==m[g].toLowerCase().indexOf("[measures]")?o?l=l+(""!==l?" * ":"")+"({"+m[g]+"})":c.push("({"+m[g]+"})"):o?l=l+(""!==l?" * ":"")+"({"+m[g]+"})":c.push("("+m[g]+")");else{if(m[g]||!e[g]){c=[];break}"[measures]"===e[g].name.toLowerCase()&&""!==t?o?l=l+(""!==l?" * ":"")+"("+t+")":c.push("("+t+")"):o?l=l+(""!==l?" * ":"")+"({"+this.getDimensionQuery(e[g],i)+"})":c.push("("+this.getDimensionQuery(e[g],i)+")")}g++}c.length>0&&c.length<m.length&&(c=[]),a=a+(""!==a&&c.length>0?",":"")+(c.length>0?"("+c.toString()+")":"")}return o?l:a},e.updateValueSortQuery=function(e,t){if(t&&t.measure&&""!==t.measure){var i=this.drilledMembers.length>0?"HIERARCHIZE ({":"",r=this.fieldList[t.measure].isCalculatedField?this.fieldList[t.measure].tag:t.measure;switch(t.sortOrder){case"Ascending":e=(e=e.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+r+"), ASC)";break;case"Descending":e=(e=e.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+r+"), DESC)"}}return e},e.getSlicersQuery=function(e,i){var r=this,a="",n=t.extend([],this.rows,null,!0);if(n=n.concat(this.columns),e.length>0){for(var o=0;o<e.length;){n.filter(function(t){var i=r.getDimensionUniqueName(t.name),a=r.getDimensionUniqueName(e[o].name);return i===a&&!(r.isMondrian&&""===a&&""===i)}).length>0||(void 0===e[o].name||this.filterMembers[e[o].name]?this.filterMembers[e[o].name]&&(a=a+(""!==a?" * ":"")+"{"+this.filterMembers[e[o].name].toString()+"}"):a=a+(""!==a?" * ":"")+"{"+this.getDimensionQuery(e[o],i)+"}"),o++}a="\nWHERE ("+a.replace(/DrilldownLevel/g,"")+")"}return a},e.getDimensionQuery=function(e,t){var i=e.isCalculatedField?this.fieldList[e.name].tag:e.name;return this.fieldList[e.name].hasAllMember||e.isNamedSet?e.isNamedSet?"{"+i+"}":this.isPaging?i+".CHILDREN":"DrilldownLevel({"+i+"}"+("rows"===t||"columns"===t?",,,INCLUDE_CALC_MEMBERS":"")+")":"(("+i+").levels(0).AllMembers)"},e.getDimensionUniqueName=function(e){var t=this.fieldDataObj.hierarchy,i=[];if(t){for(var r=0,a=t;r<a.length;r++){var n=a[r];n.id.toLowerCase()===e.toLowerCase()&&i.push(n)}return i.length>0?i[0].pid:""}return e.split(".")[0]},e.getMeasuresQuery=function(e){var t="";if(e.length>0){t="{{";for(var i="",r=0,a=e;r<a.length;r++){var n=a[r],o=n.isCalculatedField?this.fieldList[n.name].tag:n.name;i=i.length>0?i+", "+o:o}t=t+i+"}}"}return t},e.getfilterQuery=function(e,t){for(var i="\nFROM ["+t+"]",r="\nFROM( SELECT (",a=[],n=[],o=[],l=[],s=0,d=this.rows;s<d.length;s++){e[(g=d[s]).name]&&e[g.name].length>0&&("string"==typeof e[g.name][0]?o.push(e[g.name]):(a.push(e[g.name]),delete e[g.name]))}for(var p=0,h=this.columns;p<h.length;p++){e[(g=h[p]).name]&&e[g.name].length>0&&("string"==typeof e[g.name][0]?l.push(e[g.name]):(a.push(e[g.name]),delete e[g.name]))}for(var u=0,c=this.filters;u<c.length;u++){for(var g=c[u],m=!1,f=0,v=this.columns;f<v.length;f++){var y=v[f];this.getDimensionUniqueName(y.name)===this.getDimensionUniqueName(g.name)&&e[g.name]&&(l.push(e[g.name]),m=!0)}if(m)for(var S=0,b=this.rows;S<b.length;S++){var C=b[S];this.getDimensionUniqueName(C.name)===this.getDimensionUniqueName(g.name)&&e[g.name]&&o.push(e[g.name])}}if(this.allowLabelFilter||this.allowValueFilter)for(var x=0,w=a;x<w.length;x++)for(var T=0,M=w[x];T<M.length;T++){var D=M[T];n.push(this.getAdvancedFilterQuery(D,r,"COLUMNS"))}for(var E=0,L=l.length;E<L;E++)r=0===E?r+"{"+l[E].toString()+"}":r+",{"+l[E].toString()+"}";l.length>0&&(r=o.length>0?r+" ) ON COLUMNS ,(":r+" ) ON COLUMNS");for(E=0,L=o.length;E<L;E++)r=E>0?r+",{"+o[E].toString()+"}":r+"{"+o[E].toString()+"}";r=l.length>0&&o.length>0?r+=") ON ROWS ":0==l.length&&o.length>0?r+") ON COLUMNS ":r;var O="";return n.length>0&&(O=(l.length>0||o.length>0?r:"")+" "+n.join(" ")+" "+i+Array(n.length+1+(l.length>0||o.length>0?1:0)).join(")")),i=0===l.length&&0===o.length?i:r+i+")",O.length>0?O:i},e.getAdvancedFilterQuery=function(e,t,i){return"\nFROM (SELECT Filter("+e.selectedField+".AllMembers, "+this.getAdvancedFilterCondtions(e.name,e.condition,e.value1,e.value2,e.type,e.measure)+")) on "+i},e.getAdvancedFilterCondtions=function(e,t,i,r,a,n){var o="";switch(t){case"Equals":o="("+("Value"!==a?e+'.CurrentMember.member_caption ="'+i+'"':n+" = "+i);break;case"DoesNotEquals":o="("+("Value"!=a?e+'.CurrentMember.member_caption <>"'+i+'"':n+" <>"+i);break;case"Contains":o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0';break;case"DoesNotContains":o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'")=0';break;case"BeginWith":o="( Left ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotBeginWith":o="( Left ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"EndsWith":o="( Right ("+e+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotEndsWith":o="( Right ("+e+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"GreaterThan":o="("+("Value"!=a?e+'.CurrentMember.member_caption >"'+i+'"':n+" >"+i);break;case"GreaterThanOrEqualTo":o="("+("Value"!=a?e+'.CurrentMember.member_caption >="'+i+'"':n+" >="+i);break;case"LessThan":o="("+("Value"!=a?e+'.CurrentMember.member_caption <"'+i+'"':n+" <"+i);break;case"LessThanOrEqualTo":o="("+("Value"!=a?e+'.CurrentMember.member_caption <="'+i+'"':n+" <="+i);break;case"Between":o="("+("Value"!=a?e+'.CurrentMember.member_caption >="'+i+'"AND '+e+'.CurrentMember.member_caption <="'+r+'"':n+" >="+i+" AND "+n+" <="+r);break;case"NotBetween":o="("+("Value"!=a?e+'.CurrentMember.member_caption >="'+i+'"OR '+e+'.CurrentMember.member_caption <="'+r+'"':n+" >="+i+" OR "+n+" <="+r);break;default:o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+i+'") >0'}return o},e.getCalculatedFieldQuery=function(e){var i="";if(e.length>0){i="\nWITH";for(var r=0,a=e;r<a.length;r++){var n=a[r],o=(n.formula.indexOf("Measure")>-1?"[Measures].":n.hierarchyUniqueName+".")+"["+n.name+"]",l=t.isNullOrUndefined(n.formatString)?null:n.formatString;i+="\nMEMBER "+o+"as ("+n.formula+") "+(t.isNullOrUndefined(l)?"":', FORMAT_STRING ="'+l.trim()+'"')}}return i},e}(),Li=function(){function e(){this.fieldList={},this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.colStartPos=0,this.enableSort=!1,this.enableValueSorting=!1,this.dataFields={},this.filterMembers={},this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.rowStartPos=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.gridJSON="",this.colDepth=0,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.headerGrouping={},this.lastLevel=[],this.showRowSubTotals=!0,this.showColumnSubTotals=!0,this.hideRowTotalsObject={},this.hideColumnTotalsObject={},this.sortObject={}}return e.prototype.renderEngine=function(e,i){this.isEmptyData=!1,this.mdxQuery="",this.isMeasureAvail=!1,this.allowLabelFilter=!1,this.allowValueFilter=!1,this.isMondrian=!1,this.measureReportItems=[],this.calcChildMembers=[],this.selectedItems=[],this.savedFieldList=void 0,this.savedFieldListData=void 0,this.filterMembers={},this.dataFields={},this.valueAxis="",this.columnCount=0,this.rowCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.colStartPos=0,this.enableValueSorting=!1,this.sortObject={},this.globalize=new t.Internationalization,this.locale=this.globalize.getCulture(),this.localeObj=i?i.localeObj:void 0,this.enableValueSorting=!!i&&i.enableValueSorting,e.url&&(this.isMondrian="mondrian"===e.dataProviderType,this.dataSourceSettings=e,this.getAxisFields(),this.enableSort=void 0===e.enableSorting||e.enableSorting,this.valueSortSettings=e.valueSortSettings?e.valueSortSettings:void 0,this.filterSettings=e.filterSettings?e.filterSettings:[],this.sortSettings=e.sortSettings?e.sortSettings:[],this.allowLabelFilter=!!e.allowLabelFilter,this.allowValueFilter=!!e.allowValueFilter,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.valueAxis="row"===e.valueAxis?"row":"column",this.pageSettings=i?i.pageSettings?i.pageSettings:this.pageSettings:void 0,this.isPaging=!!this.pageSettings,this.frameSortObject(),this.savedFieldList=i?i.savedFieldList:void 0,this.savedFieldListData=i?i.savedFieldListData:void 0,this.fieldListData=[],this.fieldListObj={},this.savedFieldList&&this.savedFieldListData?this.updateFieldlist(!0):this.getFieldList(e),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.measureReportItems=[],this.updateFilterItems(this.filterSettings),this.generateGridData(e))},e.prototype.generateGridData=function(e,t){var i=!(!t||"navPaging"!==t||!this.isPaging||void 0===this.pageSettings);Ei.getCellSets(e,this,i)},e.prototype.generatePagingData=function(e,t,i){var r=[].slice.call(e.querySelectorAll("Axes, CellData"));this.rowCount=r.length>0&&[].slice.call(r[0].querySelectorAll('Axis[name|="Axis1"] Tuple')).length>0?[].slice.call(r[0].querySelectorAll('Axis[name|="Axis1"] Tuple')).length:0,this.columnCount=r.length>0&&[].slice.call(r[0].querySelectorAll('Axis[name|="Axis0"] Tuple')).length>0?[].slice.call(r[0].querySelectorAll('Axis[name|="Axis0"] Tuple')).length:0;var a=i.dataSourceSettings;Ei.getCellSets(a,this,!0)},e.prototype.generateEngine=function(e,i,r){"down"!==r.action&&(this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.colDepth=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.colMeasures={},this.colMeasurePos=void 0,this.rowMeasurePos=void 0,this.rowStartPos=-1),this.xmlDoc=e,this.request=i,this.customArgs=r,this.totalCollection=[],this.parentObjCollection={},this.curDrillEndPos=-1,this.onDemandDrillEngine=[],this.getSubTotalsVisibility(),this.xmlaCellSet=e.querySelectorAll("Axes, CellData");var a=this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis0"] Tuple')):[],n=this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis1"] Tuple')):[],o=this.xmlaCellSet.length>1?[].slice.call(this.xmlaCellSet[1].querySelectorAll("Cell")):[];if(this.drilledMembers.length>0){var l=this.getMeasureInfo(),s=void 0;a=(s=this.frameMeasureOrder(l,"column",a,o,a.length)).orderedHeaderTuples,o=s.orderedValueTuples,n=(s=this.frameMeasureOrder(l,"row",n,o,a.length)).orderedHeaderTuples,o=s.orderedValueTuples}"down"===r.action&&this.updateTupCollection("row"===r.drillInfo.axis?n.length:a.length),"down"===r.action&&"column"!==r.drillInfo.axis||this.frameColumnHeader(a),"down"===r.action&&"row"!==r.drillInfo.axis||(this.frameRowHeader(n),this.performRowSorting()),this.frameValues(o,a.length),this.performColumnSpanning(),this.isEngineUpdated=!0,this.isEmptyData=0===a.length||t.isNullOrUndefined(this.colMeasurePos)&&t.isNullOrUndefined(this.rowMeasurePos)},e.prototype.getSubTotalsVisibility=function(){this.showRowSubTotals=this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals,this.showColumnSubTotals=this.dataSourceSettings.showColumnSubTotals&&this.dataSourceSettings.showSubTotals,this.hideRowTotalsObject={},this.hideColumnTotalsObject={};var e=1;do{if(1===e){if(this.showColumnSubTotals)for(var t=0;t<this.dataSourceSettings.columns.length;t++)!1===this.dataSourceSettings.columns[t].showSubTotals&&(this.hideColumnTotalsObject[this.dataSourceSettings.columns[t].name]=t)}else if(this.showRowSubTotals)for(var i=0;i<this.dataSourceSettings.rows.length;i++)!1===this.dataSourceSettings.rows[i].showSubTotals&&(this.hideRowTotalsObject[this.dataSourceSettings.rows[i].name]=i);e++}while(e<3)},e.prototype.frameRowHeader=function(e){this.headerGrouping={},this.lastLevel=[];var t=this.pivotValues.length,i=[],r=[];"down"!==this.customArgs.action?(i=this.pivotValues,r=this.valueContent):t=this.customArgs.drillInfo.currentCell.rowIndex+1,this.rowStartPos=this.rowStartPos>0?this.rowStartPos:t;for(var a,n,o,l=0,s=[],d={},p=[],h=!1,u=-1,c=-1,g=[{axis:"row",colIndex:0,formattedText:"Grand Total",hasChild:!1,level:-1,rowIndex:0,index:[],type:"grand sum",ordinal:0,colSpan:1,rowSpan:1,memberType:2,isDrilled:!1}],m=[],f=this.customArgs.drillInfo&&"row"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;l<e.length;){var v=e[l].querySelectorAll("Member");m=this.frameTupCollection(v,m,l+f,this.tupRowInfo,this.showRowSubTotals,this.hideRowTotalsObject,"row"),l++}l=0;var y,S=e.length;if("down"===this.customArgs.action){var b=this.customArgs.drillInfo.currentCell.ordinal+1;l=b,S+=b,n=this.tupRowInfo[b-1].allCount,a=this.tupRowInfo[b-1].allStartPos,y=this.tupRowInfo[b-1]}for(var C=l;l<S;){v=e["down"===this.customArgs.action?l-(this.customArgs.drillInfo.currentCell.ordinal+1):l].querySelectorAll("Member");var x=0,w=void 0,T=this.tupRowInfo[l].allCount,M=this.tupRowInfo[l].allStartPos,D=this.tupRowInfo[l].measure,E=this.tupRowInfo[l].typeCollection,L=(this.tupRowInfo[l].drillInfo,this.tupRowInfo[l].drillStartPos),O=this.tupRowInfo[l].startDrillUniquename;this.tupRowInfo[l].drillEndPos,this.tupRowInfo[l].levelCollection;if(0===l||l===C){for(var P="down"===this.customArgs.action?this.tupRowInfo[0].members:v;x<P.length;)"1"===P[x].querySelector("MEMBER_TYPE").textContent&&0===Number(P[x].querySelector("LNum").textContent)?(d[x]=0,u=-1===u?x:u,c=x):(d[x]=1,h=!0),x++;o=E.indexOf("3")}if(x=0,0===l&&(v.length>T+(D?1:0)||1===v.length&&D)&&g.pop(),!h||T===n||M!==a||1===v.length&&D){var N=!(L>-1)||(!(T>0)||M>L);N=y&&N&&L>-1?y.startDrillUniquename!==O||y.measureName!==this.tupRowInfo[l].measureName&&(M===L+1||this.tupRowInfo[l].measurePosition===L+1):N;var I=!(u>-1&&T>0)||M>c;if(v.length===T+(D?1:0)&&D)g.push({axis:"row",actualText:v[o].querySelector("UName").textContent,colIndex:0,formattedText:v[o].querySelector("Caption").textContent,hasChild:!1,level:-1,rowIndex:t,index:[],ordinal:l,colSpan:1,rowSpan:1,memberType:Number(E[o]),isDrilled:!1,parentUniqueName:v[o].querySelector("PARENT_UNIQUE_NAME")?v[o].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:v[o].querySelector("LName").textContent,hierarchy:v[o].getAttribute("Hierarchy"),valueSort:{levelName:"",axis:v[o].getAttribute("Hierarchy")}});else if(0!==M&&(0!==o||1!==M)&&N&&I){y=this.tupRowInfo[l];var A=t,F=x;for(w={};x<v.length;){var q=v[x];if(q.querySelector("UName").textContent===s[x]||"2"===E[x]||w&&w.isDrilled&&1===d[x-1]&&1!==d[x])"2"===E[x]&&(F=x);else{var R=Number(q.querySelector("LNum").textContent)-(d[x]&&"3"!==E[x]?1:0);i[t]=[{axis:"row",actualText:q.querySelector("UName").textContent,colIndex:0,formattedText:q.querySelector("Caption").textContent,hasChild:Number(q.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:R,rowIndex:t,index:[],ordinal:l,type:"header",colSpan:1,rowSpan:1,memberType:Number(E[x]),isDrilled:this.tupRowInfo[l].drillInfo[x].isDrilled,parentUniqueName:q.querySelector("PARENT_UNIQUE_NAME")?q.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:q.querySelector("LName").textContent,hierarchy:q.getAttribute("Hierarchy"),valueSort:{levelName:"",axis:q.getAttribute("Hierarchy")}}],(w="3"!==E[x]?i[t][0]:w)?i[t][0].valueSort.levelName=q.querySelector("Caption").textContent:(i[t][0].valueSort.levelName=q.querySelector("Caption").textContent,p.push(q.querySelector("Caption").textContent)),r[t-this.rowStartPos]={},r[t-this.rowStartPos][0]=i[t][0],D&&o>x&&(s[o]="");for(var j=x+1;j<v.length;j++)s[j]="";s[x]=q.querySelector("UName").textContent,t++,F=x}this.tupRowInfo[l].drillInfo[x].isDrilled&&this.tupRowInfo[l].showTotals&&(this.tupRowInfo[l].showTotals=!!this.showRowSubTotals&&void 0===this.hideRowTotalsObject[this.tupRowInfo[l].drillInfo[x].hierarchy]),x++}A<t&&F>=v.length-1&&(i[t-1][0].ordinal=l,"header"===i[t-1][0].type&&delete i[t-1][0].type)}n=T,a=M}l++}if(g.length>1&&3!==g[0].memberType&&(g[0].ordinal=-1),!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)for(var k=0;k<g.length;k++)this.tupRowInfo[g[k].ordinal]&&(this.tupRowInfo[g[k].ordinal].showTotals=!1);if("down"!==this.customArgs.action)for(k=0;k<g.length;k++)g[k].rowIndex=t,i[t]=[g[k]],r[t-this.rowStartPos]={},r[t-this.rowStartPos][0]=i[t][0],t++;else this.updateRowEngine(i,r,e.length),this.onDemandDrillEngine=i},e.prototype.frameTupCollection=function(e,i,r,a,n,o,l){for(var s,d,p,h,u,c,g=0,m=0,f=[],v=[],y=[],S="",b="",C=!0,x=-1;g<e.length;){var w=e[g],T=Number(w.querySelector("MEMBER_TYPE").textContent)>2?"3":w.querySelector("MEMBER_TYPE").textContent,M=Number(w.querySelector("LNum").textContent),D=w.querySelector("UName").textContent,E=w.querySelector("Caption").textContent,L=w.getAttribute("Hierarchy"),O=w.querySelector("PARENT_UNIQUE_NAME")?w.querySelector("PARENT_UNIQUE_NAME").textContent:"";if("2"===T?(m++,p=t.isNullOrUndefined(p)?g:p):"3"===T?(h=w,u=D,c=g,"column"===l?(this.colMeasures[D]=w,this.colMeasurePos=g):this.rowMeasurePos=g):x=o[L],"2"!==T){if(this.headerGrouping[g]){if(M>this.lastLevel[g])this.lastLevel[g]=M;else if(M<this.lastLevel[g]){for(var P=this.lastLevel[g];P>=M;)delete this.headerGrouping[g].UName[P],delete this.headerGrouping[g].Caption[P],P--;this.lastLevel[g]=M}this.headerGrouping[g].UName[M]=D,this.headerGrouping[g].Caption[M]=E}else this.lastLevel[g]=M,this.headerGrouping[g]={UName:(s={},s[M]=D,s),Caption:(d={},d[M]=E,d)};var N=Object.values(this.headerGrouping[g].UName).join("~~");S=""===S?N:S+"::"+N;var I=Object.values(this.headerGrouping[g].Caption).join("~~");g!==c&&(b=""===b?I:b+"::"+I)}f.push(T),v.push(M),(t.isNullOrUndefined(i[g])||i[g]<M)&&(i[g]=M),y.push({level:M,uName:D,hierarchy:L,isDrilled:!1}),a[r-1]&&"1"===a[r-1].typeCollection[g]&&y[g].level>a[r-1].drillInfo[g].level&&this.setDrillInfo(O,g,r,a),g++}return x>-1&&(C="2"!==f[x+1]),a[r]={allCount:m,allStartPos:p,measure:h,measureName:u,measurePosition:c,members:e,typeCollection:f,uNameCollection:S,captionCollection:b,levelCollection:v,drillInfo:y,drillStartPos:-1,drillEndPos:-1,showTotals:!(!n&&m>0&&p>(0===c?1:0))&&C},i},e.prototype.updateRowEngine=function(e,t,i){for(var r=this.pivotValues.length-1,a=Object.keys(e).length;r>this.customArgs.drillInfo.currentCell.rowIndex;)this.pivotValues[r+a]=this.pivotValues[r],this.pivotValues[r+a][0].ordinal+=i,this.pivotValues[r+a][0].rowIndex+=a,this.valueContent[r+a-this.rowStartPos]=this.valueContent[r-this.rowStartPos],r--;for(var n=0;n<e.length;n++)this.pivotValues[n]=e[n],this.valueContent[Number(n)-this.rowStartPos]=t[Number(n)-this.rowStartPos];this.pivotValues[this.customArgs.drillInfo.currentCell.rowIndex][0].isDrilled=!0},e.prototype.updateTupCollection=function(e){for(var t="row"===this.customArgs.drillInfo.axis?this.tupRowInfo:this.tupColumnInfo,i=t.length-1;i>this.customArgs.drillInfo.currentCell.ordinal;)t[i+e]=t[i],i--},e.prototype.frameColumnHeader=function(e){this.headerGrouping={},this.lastLevel=[];for(var t=0,i=[],r=[],a=-1,n=-1,o=this.customArgs.drillInfo&&"column"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;t<e.length;){var l=e[t].querySelectorAll("Member");i=this.frameTupCollection(l,i,t+o,this.tupColumnInfo,this.showColumnSubTotals,this.hideColumnTotalsObject,"column"),t++}if(e.length>0){l=e[0].querySelectorAll("Member");for(var s=0;s<l.length;)"1"===l[s].querySelector("MEMBER_TYPE").textContent&&0===Number(l[s].querySelector("LNum").textContent)?(r[s]=0,a=-1===a?s:a,n=s):r[s]=1,s++}var d=this;i.map(function(e,t){d.colDepth=d.colDepth+(0===r[t]?e+1:0===e?1:e)}),t=0;for(var p,h=1,u={},c=!0,g=!1;t<e.length;){l=e[t].querySelectorAll("Member");var m=this.tupColumnInfo[t].allCount,f=this.tupColumnInfo[t].allStartPos,v=this.tupColumnInfo[t].measure,y=this.tupColumnInfo[t].typeCollection,S=this.tupColumnInfo[t].drillInfo,b=this.tupColumnInfo[t].drillStartPos,C=this.tupColumnInfo[t].startDrillUniquename,x=this.tupColumnInfo[t].endDrillUniquename,w=this.tupColumnInfo[t].drillEndPos,T=this.tupColumnInfo[t].levelCollection,M="2"!==y[0]&&("3"!==y[0]||"2"!==y[1]);if(0===t&&l.length>m+(v?1:0)&&(g=!0,M=m>0&&M?f>a:M),M&&0===m){var D=[-1,-1,-1];this.tupColumnInfo[t-1]&&0===this.tupColumnInfo[t-1].allCount?D=this.levelCompare(T,this.tupColumnInfo[t-1].levelCollection):g&&p&&(D=this.levelCompare(T,p.levelCollection)),this.tupColumnInfo[t].drillStartPos<0?(!c&&D[0]>-1&&D[2]>-1&&(h=this.mergeTotCollection(h,m,i,r,f,S,D)),this.setParentCollection(l),this.frameCommonColumnLoop(l,t,h,i,r),this.tupColumnInfo[t].showTotals||h--,!c&&D[0]>-1&&D[2]>-1&&(h=this.mergeTotCollection(h,m,i,r,f,S,D)),c=!1,h++):u.drillStartPos===b&&u.startDrillUniquename===C&&u.allCount!==m||(!c&&D[0]>-1&&D[2]>-1&&(h=this.mergeTotCollection(h,m,i,r,f,S,D),c=!0),this.setParentCollection(l),(!g||n<=b)&&(this.totalCollection[this.totalCollection.length]={allCount:m,ordinal:t,members:l,drillInfo:S},u.allCount=m,u.allStartPos=f,u.drillStartPos=b,u.startDrillUniquename=C,u.endDrillUniquename=x)),p=this.tupColumnInfo[t]}if(m>0&&(!g||M&&n<f)&&(m===u.allCount||f!==u.allStartPos)){var E=w===b||u.endDrillUniquename===x,L=f!==u.allStartPos?u.startDrillUniquename!==C:E;b>-1&&!L||(c||(h=this.mergeTotCollection(h,m,i,r,f,S),c=!0),this.setParentCollection(l),g&&b>-1&&!(n<=b)||(this.totalCollection[this.totalCollection.length]={allCount:m,ordinal:t,members:l,allStartPos:f,drillInfo:S},u.allCount=m,u.allStartPos=f,u.drillStartPos=b,u.startDrillUniquename=C,u.endDrillUniquename=x))}t++}if(this.totalCollection.length>0)if(Object.keys(this.colMeasures).length>1)this.orderTotals(h,i,r);else{this.totalCollection=this.totalCollection.reverse();for(var O=0,P=this.totalCollection;O<P.length;O++){var N=P[O];(!(0===this.tupColumnInfo[N.ordinal].measurePosition?1===this.tupColumnInfo[N.ordinal].allStartPos:0===this.tupColumnInfo[N.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals)&&(this.frameCommonColumnLoop(N.members,N.ordinal,h,i,r),this.tupColumnInfo[N.ordinal].showTotals&&h++)}}},e.prototype.orderTotals=function(e,t,i){for(var r={},a=1,n=0,o=this.totalCollection;n<o.length;n++){var l=o[n];if(!(0===this.tupColumnInfo[l.ordinal].measurePosition?1===this.tupColumnInfo[l.ordinal].allStartPos:0===this.tupColumnInfo[l.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals){var s=this.tupColumnInfo[l.ordinal].measure.querySelector("UName").textContent;r[s]?(r[s].coll.push(l),r[s].count++,a=a<r[s].count?r[s].count:a):r[s]={coll:[l],count:1}}}for(var d=Object.keys(r),p=a-1;p>-1;){for(var h=0,u=d;h<u.length;h++){(l=r[u[h]].coll[p])&&(this.frameCommonColumnLoop(l.members,l.ordinal,e,t,i),this.tupColumnInfo[l.ordinal].showTotals&&e++)}p--}},e.prototype.setParentCollection=function(e){for(var t=0;e.length>t;){var i=e[t],r=Number(i.querySelector("MEMBER_TYPE").textContent)>2?"3":i.querySelector("MEMBER_TYPE").textContent,a=Number(i.querySelector("LNum").textContent),n=i.querySelector("UName").textContent;"2"===r?delete this.parentObjCollection[t]:this.parentObjCollection[t]?this.parentObjCollection[t][a]&&this.parentObjCollection[t][a].querySelector("UName").textContent===n||(this.parentObjCollection[t][a]=i):(this.parentObjCollection[t]={},this.parentObjCollection[t][a]=i),t++}},e.prototype.setDrillInfo=function(e,t,i,r){for(i--;r[i]&&r[i].drillInfo[t].uName===e;)r[i].drillInfo[t].isDrilled=!0,this.curDrillEndPos<=t&&(r[i].drillEndPos=this.curDrillEndPos=t,r[i].endDrillUniquename=e),(r[i].drillStartPos>t||-1===r[i].drillStartPos)&&(r[i].drillStartPos=t),r[i].startDrillUniquename=e,i--},e.prototype.levelCompare=function(e,t){for(var i=[-1,0],r=0;r<t.length;r++)if(e[r]!==t[r]){i=[r,e[r],t[r]-e[r]];break}return i},e.prototype.mergeTotCollection=function(e,i,r,a,n,o,l){for(var s=t.isNullOrUndefined(n)?l[0]:n-(this.colMeasurePos===n-1?2:1),d=o[s]&&o[s].level,p=this.getLevelsAsString(s-1,o),h={},u=1,c=!1,g=0,m=this.totalCollection;g<m.length;g++){var f=m[g];if(c||f.allCount<=i&&(!(d>-1&&f.drillInfo[s])||f.drillInfo[s].level>=d&&this.getLevelsAsString(s-1,f.drillInfo)===p)){var v=this.tupColumnInfo[f.ordinal].measure?this.tupColumnInfo[f.ordinal].measure.querySelector("UName").textContent:"measure";h[v]?(h[v].coll.push(f),h[v].count++,u=u<h[v].count?h[v].count:u):h[v]={coll:[f],count:1},c=!1}}for(var y=Object.keys(h),S=u-1;S>-1;){for(var b=0,C=y;b<C.length;b++){var x=h[C[b]].coll[S];if(x){(!(0===this.tupColumnInfo[x.ordinal].measurePosition?1===this.tupColumnInfo[x.ordinal].allStartPos:0===this.tupColumnInfo[x.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals)&&(this.frameCommonColumnLoop(x.members,x.ordinal,e,r,a),this.tupColumnInfo[x.ordinal].showTotals&&e++),this.totalCollection.pop()}}S--}return e},e.prototype.getLevelsAsString=function(e,t){for(var i=[],r=0;r<e;r++)i[r]=t[r].level;return i.length>0?i.toString():""},e.prototype.frameCommonColumnLoop=function(e,t,i,r,a){var n=-1;if(this.tupColumnInfo[t].showTotals)for(var o=0,l=0;o<e.length;)l+=a[o]>0&&this.tupColumnInfo[t].measurePosition!==o?r[o]:r[o]+1,this.tupColumnInfo[t].drillInfo[o].isDrilled&&this.tupColumnInfo[t].showTotals&&(this.tupColumnInfo[t].showTotals=!!this.showColumnSubTotals&&void 0===this.hideColumnTotalsObject[this.tupColumnInfo[t].drillInfo[o].hierarchy],l-=r[o]-this.tupColumnInfo[t].levelCollection[o],n=this.tupColumnInfo[t].showTotals?-1:l-1),o++;if(this.tupColumnInfo[t].showTotals)for(var s=0,d=0,p={};s<e.length;){for(var h=e[s],u=Number(h.querySelector("MEMBER_TYPE").textContent)>2?"3":h.querySelector("MEMBER_TYPE").textContent,c=0,g="2"!==u?a[s]?1:0:1;g<=("3"===u?1:r[s]);g++){var m=!1;this.pivotValues[d]||(this.pivotValues[d]=[]),Number(e[s].querySelector("LNum").textContent)>g&&"2"!==u?(h=this.parentObjCollection[s][g],m=!0):(h=e[s],c++),"2"!==u&&(p[h.querySelector("UName").textContent]=h.querySelector("Caption").textContent);var f=this.valueSortSettings&&this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"~~";this.pivotValues[d][i]={axis:"column",actualText:h.querySelector("UName").textContent,colIndex:i,formattedText:h.querySelector("Caption").textContent,hasChild:Number(h.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:c>1?-1:Number(h.querySelector("LNum").textContent)-(a[s]&&"3"!==u?1:0),rowIndex:d,ordinal:t,memberType:Number(u),isDrilled:m||this.tupColumnInfo[t].drillInfo[s].isDrilled,parentUniqueName:h.querySelector("PARENT_UNIQUE_NAME")?h.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:h.querySelector("LName").textContent,hierarchy:h.getAttribute("Hierarchy"),valueSort:{levelName:Object.values(p).join(f),axis:h.getAttribute("Hierarchy")}},this.headerContent[d]||(this.headerContent[d]={}),this.headerContent[d][i]=this.pivotValues[d][i],d++}s++}else if(n>-1)this.pivotValues[n][i-1].ordinal=t;else if(this.tupColumnInfo[t].allCount>0){for(o=0,l=0;o<this.tupColumnInfo[t].allStartPos;)l+=a[o]>0&&this.tupColumnInfo[t].measurePosition!==o?r[o]:r[o]+1,o++;this.tupColumnInfo[t].allStartPos===this.tupColumnInfo[t].measurePosition+1?l-=r[this.tupColumnInfo[t].allStartPos-2]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-2]+1:l-=r[this.tupColumnInfo[t].allStartPos-1]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-1],this.pivotValues[l-1][i-1].ordinal=t}},e.prototype.performRowSorting=function(){var e;if(this.enableSort&&this.tupRowInfo.length>0){for(var t=this.pivotValues.length,i={},r={},a=[],n=!1,o=this.tupRowInfo[0].typeCollection.lastIndexOf("1"),l=this.colDepth;l<t;l++){var s=this.pivotValues[l][0],d=this.tupRowInfo[s.ordinal],p=d?d.uNameCollection:"";if(""!==p){o>-1&&(p=this.frameUniqueName(p,s,d));var h=p.split(/[~~,::]/).length;if(3===s.memberType&&this.tupRowInfo[0].measurePosition>0){r[F=this.getParentUname(p,s,!0,!0)]?r[F].push(s):r[F]=[s]}else i[h]?i[h][p]=[s]:i[h]=(e={},e[p]=[s],e)}n&&a.push(s),"grand sum"===s.type&&(n=!0)}for(var u=Object.keys(r).length>0&&this.tupRowInfo[0].measurePosition>0,c=Object.keys(i).map(function(e){return Number(e)}).sort(),g={},m=c.length-1;m>=0;m--){for(var f={},v=i[c[m]],y=Object.keys(v),S=0;S<y.length;S++){f[F=0===m?"parent":this.getParentUname(y[S],v[y[S]][0],u,!1)]?f[F].push(v[y[S]][0]):f[F]=v[y[S]]}for(var b=Object.keys(f),C=0;C<b.length;C++)f[b[C]]=this.sortRowHeaders(f[b[C]]);if(g[c[m+1]])for(C=0;C<b.length;C++){for(var x=[],w=f[b[C]],T=0;T<w.length;T++){var M=this.tupRowInfo[w[T].ordinal],D=M.uNameCollection;x.push(w[T]),o>-1&&(D=this.frameUniqueName(D,w[T],M));var E=!1;if(u){if(r[F=this.getParentUname(D,w[T],u,!0)]){r[F]=this.sortRowHeaders(r[F]);var L=D.lastIndexOf("::")===D.indexOf("::[Measures]"),O=D.split("::").length-1===M.measurePosition,P=!M.drillInfo[M.measurePosition-1].isDrilled,N=M.members.length>M.measurePosition+1;if(L&&O&&P&&N){E=!0;for(var I=0;I<r[F].length;I++){x.push(r[F][I]);var A=D.substring(0,D.indexOf("::[Measures]"))+"::"+r[F][I].actualText;g[c[m+1]][A]&&(x=x.concat(g[c[m+1]][A]))}}else x=x.concat(r[F])}}!E&&g[c[m+1]][D]&&(x=x.concat(g[c[m+1]][D]))}f[b[C]]=x}else if(u)for(C=0;C<b.length;C++){for(w=f[b[C]],x=[],T=0;T<w.length;T++){x.push(w[T]);D=this.tupRowInfo[w[T].ordinal].uNameCollection;o>-1&&(D=this.frameUniqueName(D,w[T],this.tupRowInfo[w[T].ordinal]));var F;r[F=this.getParentUname(D,w[T],!0,!0)]&&(r[F]=this.sortRowHeaders(r[F]),x=x.concat(r[F]))}f[b[C]]=x}g[c[m]]=f}var q=0,R=0;n=!1,a=this.sortRowHeaders(a);for(l=this.colDepth;l<t;l++){var j=n?a:g[c[0]].parent,k=n?q-R:q;j[k]&&(this.pivotValues[l]=[j[k]],this.pivotValues[l][0].rowIndex=l,this.valueContent[q][0]=this.pivotValues[l][0]),q++,"grand sum"===this.pivotValues[l][0].type&&(n=!0,R=q)}}},e.prototype.frameUniqueName=function(e,t,i){var r=e.indexOf(t.actualText.toString()+"::[Measures]")>-1,a=(e=e.substring(0,e.indexOf(t.actualText.toString()))+t.actualText.toString()).split("::").length<=i.measurePosition;return e+=r||a?"::"+i.measureName:""},e.prototype.sortRowHeaders=function(e){if(e.length>0&&3!==e[0].memberType){var t=this.sortObject[e[0].hierarchy]||this.sortObject[e[0].levelUniqueName];"Ascending"===t?e.sort(function(e,t){return e.formattedText>t.formattedText?1:t.formattedText>e.formattedText?-1:0}):"Descending"===t&&e.sort(function(e,t){return e.formattedText<t.formattedText?1:t.formattedText<e.formattedText?-1:0})}return e},e.prototype.frameSortObject=function(){if(this.enableSort)for(var e=0;e<this.sortSettings.length;e++)this.sortObject[this.sortSettings[e].name]=this.sortSettings[e].order},e.prototype.getParentUname=function(e,t,i,r){var a="";if(i&&!r){for(var n=this.tupRowInfo[t.ordinal],o=[],l={},s=0;s<e.length;s++)"~"!==e[s]&&":"!==e[s]||(o.push(s),l[s]=e[s]+e[s],s++);if(n.measurePosition>=e.split("::").length-1)a=o[o.length-2]>-1?e.substring(0,o[o.length-2])+l[o[o.length-1]]+n.measureName:"parent";else{a=(d=e.lastIndexOf("~~")>e.lastIndexOf("::")?e.lastIndexOf("~~"):e.lastIndexOf("::"))>-1?e.substring(0,d):"parent"}}else{var d;a=(d=e.lastIndexOf("~~")>e.lastIndexOf("::")?e.lastIndexOf("~~"):e.lastIndexOf("::"))>-1?e.substring(0,d):"parent"}return a},e.prototype.performColumnSpanning=function(){for(var e={},t=this.rowStartPos-1,i=Object.keys(this.colMeasures).length;t>-1;){e[t]={};for(var r=this.pivotValues[t].length-1;r>0;){e[t][r]=1;var a=this.pivotValues[t][r+1],n=this.pivotValues[t+1]&&this.rowStartPos-t>1?this.pivotValues[t+1][r]:void 0,o=this.pivotValues[t][r],l=!1,s=!1,d=this.tupColumnInfo[o.ordinal],p=d.allStartPos>("3"===d.typeCollection[0]?1:0);n&&a&&a.actualText===o.actualText&&(2===o.memberType?p&&"sum"!==a.type?o.colSpan=1:o.colSpan=a.colSpan+1>i?1:a.colSpan+1:(o.colSpan=a.colSpan+1,o.ordinal=a.ordinal),l=!0),2===o.memberType?(p?(o.type="sum",o.formattedText="Total"):(o.type="grand sum",o.formattedText="Grand Total"),o.hasChild=!1):-1===o.level&&(o.type="sum",o.formattedText="Total",o.hasChild=!1),n?2===o.memberType&&2===n.memberType||n.actualText===o.actualText?(e[t][r]=e[t+1]?e[t+1][r]+1:1,0===t||1===o.memberType&&o.level>-1&&1===n.memberType&&-1===n.level?(o.rowSpan=o.isDrilled?1:e[t+1][r]+1,n.rowSpan=n.isDrilled&&-1===n.level?e[t+1][r]:n.rowSpan):3===o.memberType?o.rowSpan=1:o.rowSpan=-1,s=!0):o.isDrilled&&-1===o.level&&2===n.memberType?(e[t][r]=e[t+1]?e[t+1][r]+1:1,o.rowSpan=-1,s=!0):(o.rowSpan=0===t?e[t][r]:-1,n.rowSpan=n.level>-1&&!n.isDrilled||2!==o.memberType&&2===n.memberType?e[t+1][r]:1):o.rowSpan=o.level>-1||1===this.rowStartPos?e[t][r]:-1,l||(o.colSpan=1),s||(e[t][r]=1),r--}t--}},e.prototype.frameValues=function(e,i){var r=this.colDepth,a=this.pivotValues.length,n=0;if("down"===this.customArgs.action){var o=Object.keys(this.onDemandDrillEngine);r=Number(o[0]),a=Number(o[o.length-1])+1,n=this.onDemandDrillEngine[r][0].ordinal}for(var l={},s=0;s<e.length;s++)l[Number(e[s].getAttribute("CellOrdinal"))]=e[s];for(var d=r;d<a;d++){var p=this.pivotValues[d],h=p[0].ordinal;for(s=1;s<this.pivotValues[0].length;s++){var u=this.pivotValues[this.colDepth-1][s].ordinal,c=(p[0].hasChild||p[0].hasChild||"grand sum"===p[0].type||p[0].type,this.pivotValues[this.colDepth-1][s]),g=3===p[0].memberType?p[0].actualText.toString():this.tupColumnInfo[c.ordinal]&&this.tupColumnInfo[c.ordinal].measure?this.tupColumnInfo[c.ordinal].measure.querySelector("UName").textContent:p[0].actualText;if("header"===p[0].type)p[s]={axis:"value",actualText:g,formattedText:"",value:0,colIndex:s,rowIndex:d};else{var m=void 0,f=void 0,v="0";this.tupRowInfo[h]&&(m=l[(h-n)*i+u],f=this.tupRowInfo[h].showTotals?t.isNullOrUndefined(m)||t.isNullOrUndefined(m.querySelector("FmtValue"))?"":m.querySelector("FmtValue").textContent:"",v=this.tupRowInfo[h].showTotals?t.isNullOrUndefined(m)||t.isNullOrUndefined(m.querySelector("Value"))?null:m.querySelector("Value").textContent:"0"),p[s]={axis:"value",actualText:g,formattedText:f,colOrdinal:u,rowOrdinal:h,columnHeaders:this.tupColumnInfo[u]?this.tupColumnInfo[u].captionCollection:"",rowHeaders:this.tupRowInfo[h]?this.tupRowInfo[h].captionCollection:"",value:t.isNullOrUndefined(v)?null:Number(v),colIndex:s,rowIndex:d}}this.valueContent[d-this.rowStartPos][s]=p[s]}}},e.prototype.getMeasureInfo=function(){for(var e,t="column",i=[],r=0,a=this.values;r<a.length;r++){var n=a[r];i[i.length]=n.isCalculatedField?this.fieldList[n.name].tag:n.name}if(i.length>1){if(this.isMeasureAvail){for(var o=!1,l=0,s=this.rows.length;l<s;l++)if("[measures]"===this.rows[l].name.toLowerCase()){t="row",e=l,o=!0;break}if(!o)for(l=0,s=this.columns.length;l<s;l++)if("[measures]"===this.columns[l].name.toLowerCase()){t="column",e=l,o=!0;break}}else e="row"===(t=this.valueAxis)?this.rows.length-1:this.columns.length-1;return{measureAxis:t,measureIndex:e,valueInfo:i}}return{measureAxis:t,measureIndex:-1,valueInfo:[]}},e.prototype.frameMeasureOrder=function(e,t,i,r,a){var n=[],o=[],l=[],s={},d=[],p=e.measureAxis,h=e.measureIndex,u=e.valueInfo;if(p===t&&u.length>0){for(var c={},g=[],m=0,f=i.length;m<f;m++){for(var v=i[m],y=[].slice.call(v.querySelectorAll("Member")),S="",b="",C=0;C<y.length;)S=S+(""!==S?"~~":"")+y[C].querySelector("UName").textContent,C===h&&0===h?b=S:C===h-1&&(b=S),C++;c[b]?c[b][c[b].length]=S:(c[b]=[S],g[g.length]=b),s[S]={index:m,node:v},d[d.length]=S}if(d.length>0&&g.length>0)if(0===h)for(var x=0,w=u;x<w.length;x++)for(var T=w[x],M=0,D=g;M<D.length;M++){if((N=D[M])===T)for(var E=0,L=c[N];E<L.length;E++){S=L[E];l[l.length]=s[S].index,n[n.length]=s[S].node}}else for(var O=0,P=g;O<P.length;O++)for(var N=P[O],I=0,A=u;I<A.length;I++)for(var F=A[I],q=0,R=c[N];q<R.length;q++){(S=R[q]).split("~~")[h]===F&&(l[l.length]=s[S].index,n[n.length]=s[S].node)}if(r.length>0){for(var j=[],k=[],H=0,V=0,_=(m=0,r.length);m<_;m++)H>a-1?(H=0,j[++V]||(j[V]=[]),j[V][H]=m,H++):(j[V]||(j[V]=[]),j[V][H]=m,H++),k[k.length]=Number(r[m].getAttribute("CellOrdinal"));if("column"===p){if(j.length>0&&j[0].length===l.length)for(C=0,_=l.length;C<_;C++)for(m=0;m<j.length;){var B=k[U=m*a+C].toString();(G=r[Number(j[m][l[C]])]).setAttribute("CellOrdinal",B.toString()),o[U]=G,m++}}else if(j.length===l.length)for(C=0,_=l.length;C<_;C++)for(m=0;m<j[l[C]].length;){var U,G;B=k[U=C*a+m].toString();(G=r[Number(j[l[C]][m])]).setAttribute("CellOrdinal",B.toString()),o[o.length]=G,m++}}return{orderedHeaderTuples:n,orderedValueTuples:o}}return{orderedHeaderTuples:i,orderedValueTuples:r}},e.prototype.getDrilledSets=function(e,i,r){for(var a=[],n="row"===r?this.tupRowInfo:this.tupColumnInfo,o=0===n[0].typeCollection.indexOf("3")?1:0,l=0;l<n.length;)(t.isNullOrUndefined(n[l].allStartPos)||n[l].allStartPos>o)&&(a[a.length]=n[l].uNameCollection),l++;for(var s=e.split("::"),d=[],p=0;p<=i;p++)d[d.length]=s[p];e=d.join("::");for(var h=[],u=0,c=a;u<c.length;u++){var g=c[u];0===g.indexOf(e)&&h.push(g)}for(var m={},f=0,v=h;f<v.length;f++){for(var y=v[f].split("::"),S="",b=0;b<=i;b++){var C=y[b].split("~~");S=S+(""!==S?"~~":"")+C[C.length-1]}m[S]=S}return m},e.prototype.updateDrilledInfo=function(e){this.dataSourceSettings=e,this.drilledMembers=e.drilledMembers?this.updateDrilledItems(e.drilledMembers):[],this.generateGridData(e)},e.prototype.updateCalcFields=function(e,t){this.dataSourceSettings=e,this.calculatedFieldSettings=e.calculatedFieldSettings?e.calculatedFieldSettings:[],this.getAxisFields(),this.updateFieldlist(),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.dataFields[t.name]?this.generateGridData(e):Ei.getCellSets(e,this,!0,void 0,!0)},e.prototype.onSort=function(e){this.dataSourceSettings=e,this.sortSettings=e.sortSettings?e.sortSettings:[],this.getAxisFields(),this.frameSortObject(),this.updateFieldlist(),this.xmlaCellSet.length>0&&this.xmlDoc?this.generateEngine(this.xmlDoc,this.request,this.customArgs):this.generateGridData(e)},e.prototype.updateFieldlist=function(e){for(var t=0;t<this.savedFieldListData.length;){var i=this.savedFieldListData[t].id,r=this.savedFieldListData[t].pid;if(this.savedFieldList[i]){var a=this.enableSort?this.sortObject[i]?this.sortObject[i]:"Ascending":"None";this.savedFieldList[i].isSelected=!1,this.savedFieldList[i].isExcelFilter=!1,this.savedFieldList[i].sort=a,this.savedFieldListData[t].sort=a,e&&(this.savedFieldList[i].filter=[],this.savedFieldList[i].actualFilter=[])}if(this.dataFields[i]&&this.savedFieldList[i]&&this.selectedItems.indexOf(i)>-1?(this.savedFieldList[i].isSelected=!0,this.savedFieldListData[t].isSelected=!0):this.dataFields[r]&&this.savedFieldList[r]&&this.selectedItems.indexOf(r)>-1?this.savedFieldListData[t].isSelected=!0:this.savedFieldListData[t].isSelected=!1,this.savedFieldList[i]&&this.savedFieldList[i].isCalculatedField)for(var n=0,o=this.calculatedFieldSettings;n<o.length;n++){var l=o[n];if(i===l.name){var s=l.formula,d=this.dataFields[l.name]&&this.dataFields[l.name].caption?this.dataFields[l.name].caption:l.name,p=l.formatString,h=(s.indexOf("Measure")>-1?"[Measures].":l.hierarchyUniqueName+".")+"["+l.name+"]";this.savedFieldListData[t].caption=d,this.savedFieldListData[t].spriteCssClass="e-calc-member "+(s.indexOf("Measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+K,this.savedFieldListData[t].tag=h,this.savedFieldListData[t].formula=s,this.savedFieldListData[t].formatString=p,this.savedFieldListData[t].fieldType=s.indexOf("Measure")>-1?"Measure":"Dimension",this.savedFieldListData[t].parentHierarchy=s.indexOf("Measure")>-1?void 0:l.hierarchyUniqueName,this.savedFieldList[i].caption=d,this.savedFieldList[i].spriteCssClass=this.savedFieldListData[t].spriteCssClass,this.savedFieldList[i].tag=h,this.savedFieldList[i].formula=s,this.savedFieldList[i].formatString=p,this.savedFieldList[i].fieldType=this.savedFieldListData[t].fieldType,this.savedFieldList[i].parentHierarchy=this.savedFieldListData[t].parentHierarchy}}t++}this.fieldList=this.savedFieldList,this.fieldListData=this.savedFieldListData},e.prototype.getFieldList=function(e){var t={catalog:e.catalog,cube:e.cube,url:e.url,LCID:e.localeIdentifier.toString(),request:"MDSCHEMA_HIERARCHIES"};this.getTreeData(t,this.getFieldListItems.bind(this),{dataSourceSettings:e,action:"loadFieldElements"})},e.prototype.getTreeData=function(e,t,i){var r=this.getConnectionInfo(e.url,e.LCID),a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+r.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>";this.doAjaxPost("POST",r.url,a,t,i)},e.prototype.getAxisFields=function(){this.rows=this.dataSourceSettings.rows?this.dataSourceSettings.rows:[],this.columns=this.dataSourceSettings.columns?this.dataSourceSettings.columns:[],this.filters=this.dataSourceSettings.filters?this.dataSourceSettings.filters:[],this.values=this.dataSourceSettings.values?this.dataSourceSettings.values:[];for(var e=t.extend([],this.rows,null,!0),i=(e=e.concat(this.columns,this.values,this.filters)).length;i--;)this.dataFields[e[i].name]=e[i],"[measures]"===e[i].name.toLowerCase()?this.isMeasureAvail=!0:this.selectedItems.push(e[i].name);if(!this.isMeasureAvail&&this.values.length>0){var r={name:"[Measures]",caption:"Measures"};"row"===this.valueAxis?this.rows.push(r):this.columns.push(r),this.isMeasureAvail=!0}},e.prototype.getAggregateType=function(e,t){var i;switch(t){case"1":i="Sum";break;case"2":i="Count";break;case"3":i="Min";break;case"4":i="Max";break;case"5":i="Avg";break;case"8":i="DistinctCount";break;case"127":i="CalculatedField";break;default:i=void 0}return i||void 0},e.prototype.updateFilterItems=function(e){var i=t.extend([],this.rows,null,!0);i=i.concat(this.columns);for(var r=0,a=e;r<a.length;r++){var n=a[r];if("Include"===n.type){var o=this.fieldList[n.name].members,l=o&&Object.keys(o).length>0;this.fieldList[n.name].actualFilter=n.items.slice();var s=t.extend([],n.items,null,!0);if(l)for(var d=0;d<s.length;){for(var p=[],h=0,u=p=this.getParentNode(s[d],o,p);h<u.length;h++){var c=u[h],m=g.inArray(c,n.items);-1!==m&&n.items.splice(m,1)}d++}for(var f=[],v=0,y=n.items;v<y.length;v++){var S=y[v];f.push(S),l?this.fieldList[n.name].filter.push(o[S].caption):this.fieldList[n.name].filter.push(S)}this.filterMembers[n.name]=f,this.fieldList[n.name].isExcelFilter=!1}else if((this.allowValueFilter||this.allowLabelFilter)&&-1!==["Date","Label","Number","Value"].indexOf(n.type))for(var b=0,C=i;b<C.length;b++){if(C[b].name===n.name){var x=this.filterMembers[n.name];x&&"object"==typeof x[0]&&x[0].type===n.type?x[x.length]=n:this.filterMembers[n.name]=[n],this.fieldList[n.name].isExcelFilter=!0;break}}}},e.prototype.getParentNode=function(e,t,i){if(t[e].parent&&e!==t[e].parent){var r=t[e].parent;i.push(r),this.getParentNode(r,t,i)}return i},e.prototype.updateDrilledItems=function(e){var i=[],r=t.extend([],this.rows,null,!0);r=r.concat(this.columns);for(var a=0,n=e;a<n.length;a++)for(var o=n[a],l=0,s=r;l<s.length;l++){var d=s[l];if(o.name===d.name){i.push(o);break}}return i},e.prototype.getDrillThroughData=function(e,t){for(var i=this.tupColumnInfo[e.colOrdinal]?this.tupColumnInfo[e.colOrdinal].uNameCollection.split("::"):[],r=this.tupRowInfo[e.rowOrdinal]?this.tupRowInfo[e.rowOrdinal].uNameCollection.split("::"):[],a="",n="",o=0;o<i.length;o++)a=(a.length>0?a+",":"")+(i[o].split("~~").length>1?i[o].split("~~")[i[o].split("~~").length-1]:i[o]);for(o=0;o<r.length;o++)n=(n.length>0?n+",":"")+(r[o].split("~~").length>1?r[o].split("~~")[r[o].split("~~").length-1]:r[o]);var l="DRILLTHROUGH MAXROWS "+t+" Select("+(a.length>0?a:"")+(a.length>0?",":"")+(n.length>0?n:"")+") on 0 from ["+this.dataSourceSettings.cube+"]";l=l.replace(/&/g,"&amp;");var s=this.getSoapMsg(this.dataSourceSettings,l),d=this.getConnectionInfo(this.dataSourceSettings.url,this.dataSourceSettings.localeIdentifier);this.doAjaxPost("POST",d.url,s,this.drillThroughSuccess.bind(this),{dataSourceSettings:this.dataSourceSettings,action:"drillThrough"})},e.prototype.drillThroughSuccess=function(e){var t=[];[].slice.call(e.querySelectorAll("row")).map(function(e){[].slice.call(e.children).map(function(e){var i=e.textContent,r=e.tagName;t.push('"'+r+'":"'+i+'"')})});for(var i=t[0],r="",a=0;a<t.length;a++)Object.keys(JSON.parse("[{"+t[a]+"}]")[0])[0]!==Object.keys(JSON.parse("[{"+i+"}]")[0])[0]?r+=","+t[a]:r+=""===r?"[{"+t[a]:"}, {"+t[a];r+="}]",this.gridJSON=r},e.prototype.getFilterMembers=function(e,t,i,r,a){var n,o=this.fieldList[t].levels,l=this.fieldList[t].levelCount;return n=a?"Descendants({"+o[l].id+"}, "+o[i-1].id+", "+(i-l==1?"SELF)":"SELF_AND_BEFORE)"):t+", Descendants({"+o[0].id+"}, "+o[i-1].id+", SELF_AND_BEFORE)",this.fieldList[t].levelCount=i,r||this.getMembers(e,t,!1,n,a),n},e.prototype.getMembers=function(e,t,i,r,a){var n,o="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE",l=this.fieldList[t].hasAllMember,s=(l?t:t+".LEVELS(0)").replace(/\&/g,"&amp;");n=i?"SELECT ({"+s+".ALLMEMBERS})"+o+" ON 0 FROM ["+e.cube+"]":"SELECT ({"+(r||(l?s+", "+s+".CHILDREN":s+".ALLMEMBERS"))+"})"+o+" ON 0 FROM ["+e.cube+"]";var d=this.getSoapMsg(e,n),p=this.getConnectionInfo(e.url,e.localeIdentifier);a||(this.fieldList[t].filterMembers=[],this.fieldList[t].childMembers=[],this.fieldList[t].searchMembers=[],this.fieldList[t].members={},this.fieldList[t].currrentMembers={}),this.doAjaxPost("POST",p.url,d,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,loadLevelMembers:a,action:"fetchMembers"})},e.prototype.getChildMembers=function(e,t,i){var r="SELECT ({"+t.replace(/\&/g,"&amp;")+".CHILDREN})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE ON 0 FROM ["+e.cube+"]",a=this.getSoapMsg(e,r),n=this.getConnectionInfo(e.url,e.localeIdentifier);this.doAjaxPost("POST",n.url,a,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:i,action:"fetchChildMembers"})},e.prototype.getCalcChildMembers=function(e,t){this.calcChildMembers=[];var i="SELECT ({"+t.replace(/\&/g,"&amp;")+".MEMBERS})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE ON 0 FROM ["+e.cube+"]",r=this.getConnectionInfo(e.url,e.localeIdentifier),a=this.getSoapMsg(e,i);this.doAjaxPost("POST",r.url,a,this.generateMembers.bind(this),{dataSourceSettings:e,action:"fetchCalcChildMembers"})},e.prototype.getSearchMembers=function(e,t,i,r,a,n){if(this.fieldList[t].searchMembers=[],this.fieldList[t].currrentMembers={},""!==i){var o=t.replace(/\&/g,"&amp;"),l="WITH SET [SearchMembersSet] AS &#39;FILTER("+(a?o+".ALLMEMBERS, ":"{"+(n>1?this.getFilterMembers(e,t,n,!0):o+", "+o+".CHILDREN")+"},")+"(INSTR(1, "+o+'.CurrentMember.member_caption, "'+i+'") > 0))&#39;SET [SearchParentsSet] AS &#39;GENERATE([SearchMembersSet], ASCENDANTS([SearchMembersSet].Current))&#39;SET [SearchSet] AS &#39;HIERARCHIZE(DISTINCT({[SearchMembersSet], [SearchParentsSet]}))&#39;SELECT SUBSET([SearchSet], 0, '+r+")DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE ON 0 FROM ["+e.cube+"]",s=this.getSoapMsg(e,l),d=this.getConnectionInfo(e.url,e.localeIdentifier);this.doAjaxPost("POST",d.url,s,this.generateMembers.bind(this),{dataSourceSettings:e,fieldName:t,action:"fetchSearchMembers"})}},e.prototype.generateMembers=function(e,t,i){for(var r,a=[].slice.call(e.querySelectorAll('Axis[name="Axis0"] Tuple')),n=i.fieldName,o={},l=0,s=a;l<s.length;l++){var d=s[l],p=d.querySelector("Member"),h=p.querySelector("MEMBER_TYPE").textContent,u=p.querySelector("UName").textContent,c=p.querySelector("Caption").textContent,g={"data-fieldName":n},m=p.querySelector("PARENT_UNIQUE_NAME")?p.querySelector("PARENT_UNIQUE_NAME").textContent:"";if(""===m&&"1"===h)o={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,isSelected:!1,id:u,tag:u,name:c,caption:c,htmlAttributes:g},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[n].filterMembers.push(o),this.fieldList[n].childMembers.push(o)):"fetchSearchMembers"===i.action?(this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[n].searchMembers.push(o),o.expanded=!0):this.calcChildMembers.push(o);else if(""!==m&&"1"===h)if(m===r&&"1"===h)o={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,id:u,name:c,isSelected:!1,caption:c,htmlAttributes:g,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].filterMembers.push(o),this.fieldList[n].childMembers.push(o),this.fieldList[n].members[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):"fetchSearchMembers"===i.action?(o.expanded=!0,this.fieldList[n].searchMembers.push(o),this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:void 0,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(o);else{if("fetchMembers"===i.action&&this.fieldList[n].members[u])continue;var f=!!i.loadLevelMembers&&this.fieldList[n].members[m].isSelected;o={hasChildren:!!d.querySelector("CHILDREN_CARDINALITY")&&"0"!==d.querySelector("CHILDREN_CARDINALITY").textContent,htmlAttributes:g,isSelected:!1,id:u,pid:m,name:c,caption:c,tag:u},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[n].isHierarchy=!1,this.fieldList[n].filterMembers.push(o),this.fieldList[n].childMembers.push(o),this.fieldList[n].members[u]={name:u,caption:c,parent:m,isNodeExpand:!1,isSelected:f}):"fetchSearchMembers"===i.action?(this.fieldList[n].searchMembers.push(o),o.expanded=!0,this.fieldList[n].currrentMembers[u]={name:u,caption:c,parent:m,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(o)}else"2"===h&&(r=u)}},e.prototype.getFieldListItems=function(e,t,i){for(var r={},a=[],n=0,o=[].slice.call(e.querySelectorAll("row"));n<o.length;n++){var l=o[n],s=[].slice.call(l.querySelectorAll("ALL_MEMBER")).length>0;a.push({pid:l.querySelector("DIMENSION_UNIQUE_NAME").textContent,id:l.querySelector("HIERARCHY_UNIQUE_NAME").textContent,name:l.querySelector("HIERARCHY_CAPTION").textContent,caption:l.querySelector("HIERARCHY_CAPTION").textContent,tag:l.querySelector("HIERARCHY_UNIQUE_NAME").textContent,hasAllMember:s,allMember:s?l.querySelectorAll("ALL_MEMBER")[0].textContent:void 0,type:"string"})}r={hierarchy:a,hierarchySuccess:e,measures:[]},this.fieldListObj=r;var d={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_DIMENSIONS"};this.getTreeData(d,this.loadDimensionElements.bind(this),i)},e.prototype.loadCalculatedMemberElements=function(e){if(e.length>0){var t=this.fieldListData,i={hasChildren:!0,isSelected:!1,id:"[Calculated Members].[_0]",name:"[Calculated Members].[_0]",caption:"Calculated Members",spriteCssClass:"e-calcMemberGroupCDB "+K,tag:"[Calculated Members].[_0]",type:"string"};t.length>0&&"[measures]"===t[0].id.toLowerCase()&&t.splice(0,0,i);for(var r=0,a=e;r<a.length;r++){var n=a[r];if(!this.fieldList[n.name]){var o=n.formula,l=(o.indexOf("Measure")>-1?"[Measures].":n.hierarchyUniqueName+".")+"["+n.name+"]",s=this.dataFields[n.name]&&this.dataFields[n.name].caption?this.dataFields[n.name].caption:n.name,d=n.formatString,p={hasChildren:!1,isSelected:!1,id:n.name,pid:"[Calculated Members].[_0]",name:n.name,caption:s,spriteCssClass:"e-calc-member "+(o.indexOf("Measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+K,tag:l,formula:o,formatString:d,aggregateType:void 0,type:"CalculatedField",filter:[],dateMember:[],sort:"Ascending",filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,isCalculatedField:!0,fieldType:o.indexOf("Measure")>-1?"Measure":"Dimension",parentHierarchy:o.indexOf("Measure")>-1?void 0:n.hierarchyUniqueName};t.push(p),this.fieldList[p.id]=p}}}},e.prototype.loadDimensionElements=function(e,i,r){for(var a=[],n=[].slice.call(e.querySelectorAll("row")),o={},l=0,s=n;l<s.length;l++){var d=s[l],p=d.querySelector("DIMENSION_UNIQUE_NAME").textContent,h=d.querySelector("DIMENSION_CAPTION").textContent;p.toLowerCase().indexOf("[measure")>=0?o={hasChildren:!0,isSelected:!1,id:p,name:p,caption:h,spriteCssClass:"[measures]"===p.toLowerCase()?"e-measureGroupCDB-icon "+K:"e-dimensionCDB-icon "+K,tag:p,type:"string"}:t.isNullOrUndefined(n[0].querySelector("HIERARCHY_CAPTION"))&&a.push({hasChildren:!0,isSelected:!1,id:this.isMondrian?p+"~#^Dim":p,name:p,caption:h,spriteCssClass:"e-dimensionCDB-icon "+K,tag:p,defaultHierarchy:d.querySelector("DEFAULT_HIERARCHY").textContent,type:"string"})}a.splice(0,0,o),this.fieldListData=a;var u={catalog:r.dataSourceSettings.catalog,cube:r.dataSourceSettings.cube,url:r.dataSourceSettings.url,LCID:r.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_SETS"};this.getTreeData(u,this.loadNamedSetElements.bind(this),r)},e.prototype.loadNamedSetElements=function(e,i,r){var a=t.extend([],this.rows,null,!0);a=a.concat(this.columns,this.filters);for(var n=this.fieldListData,o=[],l=0,s=a;l<s.length;l++){var d=s[l];o.push(d.name)}for(var p=[],h=0,u=[].slice.call(e.querySelectorAll("row"));h<u.length;h++){d=u[h];p.indexOf(d.querySelector("DIMENSIONS").textContent.split(".")[0])>=0||(n.push({hasChildren:!0,isSelected:!1,pid:d.querySelector("DIMENSIONS").textContent.split(".")[0],id:d.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+d.querySelector("DIMENSIONS").textContent.split(".")[0],name:d.querySelector("SET_DISPLAY_FOLDER").textContent,spriteCssClass:"e-folderCDB-icon e-icons namedSets",caption:d.querySelector("SET_DISPLAY_FOLDER").textContent,type:"string"}),p.push(d.querySelector("DIMENSIONS").textContent.split(".")[0]));var c="["+d.querySelector("SET_NAME").textContent.trim()+"]",g={hasChildren:!0,isNamedSets:!0,isSelected:o.indexOf("["+d.querySelector("SET_NAME").textContent+"]")>=0,pid:d.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+d.querySelector("DIMENSIONS").textContent.split(".")[0],id:c,name:d.querySelector("SET_CAPTION").textContent,caption:d.querySelector("SET_CAPTION").textContent,spriteCssClass:"e-namedSetCDB-icon "+K,tag:d.querySelector("EXPRESSION").textContent,type:"string",filter:[],dateMember:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1};n.push(g),this.fieldList[c]=g}r.hierarchy=this.fieldListData,r.hierarchySuccess=this.fieldListObj.hierarchySuccess,this.loadHierarchyElements(r)},e.prototype.loadHierarchyElements=function(e){for(var i=e.hierarchySuccess,r=e.hierarchy,a=t.extend([],this.rows,null,!0),n=[],o=0,l=a=a.concat(this.columns,this.filters);o<l.length;o++){var s=l[o];n.push(s.name)}for(var d=0,p=[].slice.call(i.querySelectorAll("row"));d<p.length;d++){var h=(s=p[d]).querySelector("DIMENSION_UNIQUE_NAME").textContent,u=s.querySelector("HIERARCHY_UNIQUE_NAME").textContent,c=[].slice.call(s.querySelectorAll("ALL_MEMBER")).length>0,g=void 0;if(c){var m=s.querySelectorAll("ALL_MEMBER")[0].textContent.replace(/[\[\]\&']+/g,"").split(".");g=m[m.length-1].trim()}else g=void 0;for(var f=s.querySelector("HIERARCHY_DISPLAY_FOLDER")?s.querySelector("HIERARCHY_DISPLAY_FOLDER").textContent:"",v=[],y=0,S=r;y<S.length;y++){(M=S[y]).tag===h&&v.push(M)}if(v.length>0&&(h!==u||this.isMondrian)){var b=h+(this.isMondrian?"~#^Dim":"");if(""!==f){for(var C=h+(this.isMondrian?"~#^Dim":"")+"_"+f,x=[],w=0,T=r;w<T.length;w++){var M;(M=T[w]).tag===C&&M.pid===b&&x.push(M)}if(0===x.length){var D={hasChildren:!0,isSelected:!1,pid:h+(this.isMondrian?"~#^Dim":""),id:C,name:f,spriteCssClass:"e-folderCDB-icon "+K,tag:C,caption:f,type:"string"};r.push(D)}b=C}var E={hasChildren:!s.querySelector("HIERARCHY_ORIGIN")||"2"!==s.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==s.querySelector("HIERARCHY_ORIGIN").textContent,isSelected:n.indexOf(u)>=0,pid:b,id:u,name:s.querySelector("HIERARCHY_CAPTION").textContent,spriteCssClass:(s.querySelector("HIERARCHY_ORIGIN")?"2"!==s.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==s.querySelector("HIERARCHY_ORIGIN").textContent?"e-hierarchyCDB-icon":"e-attributeCDB-icon":"e-hierarchyCDB-icon")+" "+K,hasAllMember:c,allMember:g,tag:u,caption:s.querySelector("HIERARCHY_CAPTION").textContent,type:"string",filter:[],dateMember:[],sort:this.enableSort?this.sortObject[u]?this.sortObject[u]:"Ascending":"None",filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},levels:[],levelCount:1,isHierarchy:!!s.querySelector("HIERARCHY_ORIGIN")&&("2"===s.querySelector("HIERARCHY_ORIGIN").textContent||"6"===s.querySelector("HIERARCHY_ORIGIN").textContent),isExcelFilter:!1};r.push(E),this.fieldList[u]=E}}var L={catalog:e.dataSourceSettings.catalog,cube:e.dataSourceSettings.cube,url:e.dataSourceSettings.url,LCID:e.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_LEVELS"};this.getTreeData(L,this.loadLevelElements.bind(this),e)},e.prototype.loadLevelElements=function(e,t,i){var r=[],a=this.fieldListData;r=[];for(var n=0,o=[].slice.call(e.querySelectorAll("row"));n<o.length;n++){var l=o[n];if(1!==parseInt(l.querySelector("LEVEL_TYPE").textContent,10)&&"[measures]"!==l.querySelector("HIERARCHY_UNIQUE_NAME").textContent.toLowerCase()){var s=l.querySelector("HIERARCHY_UNIQUE_NAME").textContent,d=l.querySelector("LEVEL_UNIQUE_NAME").textContent,p=l.querySelector("LEVEL_CAPTION").textContent,h={hasChildren:!1,isChecked:!1,isSelected:this.fieldList[s].isSelected,pid:s,id:d,name:p,tag:d,spriteCssClass:"e-level-members e-hierarchy-level-"+parseInt(l.querySelector("LEVEL_NUMBER").textContent,10)+"-icon "+K,caption:p,type:"string"};r.push(h),this.fieldList[s]&&this.fieldList[s].spriteCssClass&&-1===this.fieldList[s].spriteCssClass.indexOf("e-attributeCDB-icon")?(this.fieldList[s].levels.push(h),this.fieldList[s].isHierarchy=!1):this.fieldList[s].isHierarchy=!0}}this.fieldListData=a=a.concat(r);var u={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASURES"};this.getTreeData(u,this.loadMeasureElements.bind(this),i)},e.prototype.loadMeasureElements=function(e,i,r){for(var a,n=this.fieldListData,o=[],l=[],s=0,d=t.extend([],this.values,null,!0);s<d.length;s++){var p=d[s];l.push(p.name)}if("en-US"!==this.locale){var h={catalog:r.dataSourceSettings.catalog,cube:r.dataSourceSettings.cube,url:r.dataSourceSettings.url,LCID:r.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASUREGROUPS"};this.getTreeData(h,this.loadMeasureGroups.bind(this),r)}for(var u=0,c=[].slice.call(e.querySelectorAll("row"));u<c.length;u++){p=c[u];var g=t.isNullOrUndefined(p.querySelector("MEASUREGROUP_NAME"))?"":p.querySelector("MEASUREGROUP_NAME").textContent,m=p.querySelector("MEASURE_UNIQUE_NAME").textContent,f=p.querySelector("DEFAULT_FORMAT_STRING")?p.querySelector("DEFAULT_FORMAT_STRING").textContent:"#,#",v=p.querySelector("MEASURE_AGGREGATOR")?p.querySelector("MEASURE_AGGREGATOR").textContent:"1";if(!(o.indexOf(g)>=0)){if("en-US"!==this.locale){for(var y=[],S=0,b=this.fieldListObj.measuresGroups;S<b.length;S++){var C=b[S];C.querySelector("MEASUREGROUP_NAME").textContent===g&&y.push(C)}a=y.length>0?y[0].querySelector("MEASUREGROUP_CAPTION").textContent:g}else a=g;""!==g&&(n.push({hasChildren:!0,isChecked:!1,isSelected:!1,pid:"[Measures]",id:g,name:a,spriteCssClass:"e-measureCDB e-folderCDB-icon "+K,tag:g,caption:a,aggregateType:this.getAggregateType(g,v),type:"string"}),o.push(g))}var x={hasChildren:!1,isSelected:l.indexOf(m)>=0,pid:""===g?"[Measures]":g,id:m,name:p.querySelector("MEASURE_CAPTION").textContent,spriteCssClass:"e-measure-icon "+K,tag:m,caption:p.querySelector("MEASURE_CAPTION").textContent,aggregateType:this.getAggregateType(m,v),type:"number",filter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},formatString:f};n.push(x),this.fieldList[m]=x,l.indexOf(m)>=0&&l.splice(l.indexOf(m),1)}this.measureReportItems=l},e.prototype.loadMeasureGroups=function(e,i,r){t.isNullOrUndefined(this.fieldListObj)&&(this.fieldListObj={}),this.fieldListObj.measuresGroups=[].slice.call(e.querySelectorAll("row"))},e.prototype.doAjaxPost=function(e,i,r,a,n){new t.Ajax({mode:!1,contentType:"text/xml",url:i,data:r,dataType:"xml",type:e,onSuccess:function(e,t){var i=(new DOMParser).parseFromString(e,"text/xml");a(i,t,n)},onFailure:function(e){return e}}).send()},e.prototype.getSoapMsg=function(e,t){var i=this.getConnectionInfo(e.url,e.localeIdentifier);return this.isMondrian?'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+t+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+""+"</DataSourceInfo><Catalog>"+e.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>":'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+t+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+e.catalog+"</Catalog> <LocaleIdentifier>"+i.LCID+"</LocaleIdentifier></PropertyList> </Properties> </Execute> </Body> </Envelope>"},e.prototype.getConnectionInfo=function(e,i){var r={url:"",LCID:"1033"};if(""!==e)for(var a=0,n=e.split(";");a<n.length;a++){var o=n[a];o.toLowerCase().indexOf("locale")<0&&0===r.url.length?r.url=o:o.toLowerCase().indexOf("locale")>=0?r.LCID=o.replace(/ /g,"").split("=")[1]:t.isNullOrUndefined(i)||(r.LCID=i.toString())}return r},e.prototype.getMDXQuery=function(e){return Ei.getCellSets(e,this,!0,void 0,!0),this.mdxQuery},e}(),Oi=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Pi=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},Ni=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Oi(i,e),Pi([t.Property(!0)],i.prototype,"showFilterIcon",void 0),Pi([t.Property(!0)],i.prototype,"showSortIcon",void 0),Pi([t.Property(!0)],i.prototype,"showRemoveIcon",void 0),Pi([t.Property(!0)],i.prototype,"showValueTypeIcon",void 0),Pi([t.Property("Both")],i.prototype,"displayMode",void 0),Pi([t.Property(!0)],i.prototype,"allowDragAndDrop",void 0),i}(t.ChildProperty),Ii=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Oi(i,e),Pi([t.Property(!1)],i.prototype,"allowAdding",void 0),Pi([t.Property(!1)],i.prototype,"allowEditing",void 0),Pi([t.Property(!1)],i.prototype,"allowDeleting",void 0),Pi([t.Property(!1)],i.prototype,"allowCommandColumns",void 0),Pi([t.Property("Normal")],i.prototype,"mode",void 0),Pi([t.Property(!0)],i.prototype,"allowEditOnDblClick",void 0),Pi([t.Property(!0)],i.prototype,"showConfirmDialog",void 0),Pi([t.Property(!1)],i.prototype,"showDeleteConfirmDialog",void 0),i}(t.ChildProperty),Ai=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Oi(i,e),Pi([t.Property()],i.prototype,"measure",void 0),Pi([t.Property()],i.prototype,"label",void 0),Pi([t.Property("NotEquals")],i.prototype,"conditions",void 0),Pi([t.Property()],i.prototype,"value1",void 0),Pi([t.Property()],i.prototype,"value2",void 0),i}(t.ChildProperty),Fi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Oi(i,e),Pi([t.Property(!1)],i.prototype,"showHyperlink",void 0),Pi([t.Property(!1)],i.prototype,"showRowHeaderHyperlink",void 0),Pi([t.Property(!1)],i.prototype,"showColumnHeaderHyperlink",void 0),Pi([t.Property(!1)],i.prototype,"showValueCellHyperlink",void 0),Pi([t.Property(!1)],i.prototype,"showSummaryCellHyperlink",void 0),Pi([t.Collection([],Ai)],i.prototype,"conditionalSettings",void 0),Pi([t.Property()],i.prototype,"headerText",void 0),Pi([t.Property("")],i.prototype,"cssClass",void 0),i}(t.ChildProperty),qi=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return Oi(i,e),Pi([t.Property("Table")],i.prototype,"view",void 0),Pi([t.Property("Table")],i.prototype,"primary",void 0),i}(t.ChildProperty),Ri=function(e){function n(i,r){var a=e.call(this,i,r)||this;return a.verticalScrollScale=1,a.horizontalScrollScale=1,a.scrollerBrowserLimit=5e5,a.lastSortInfo={},a.lastFilterInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.isScrolling=!1,a.shiftLockedPos=[],a.savedSelectedCellsPos=[],a.isPopupClicked=!1,a.isMouseDown=!1,a.isMouseUp=!1,a.fieldsType={},a.defaultItems={},a.isCellBoxMultiSelection=!1,a.gridHeaderCellInfo=[],a.gridCellCollection={},a.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},a.resizeInfo={},a.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},a.pivotColumns=[],a.totColWidth=0,a.posCount=0,a.isModified=!1,a.needsID=!0,a.pivotView=a,a.dataSourceSettings&&!t.isNullOrUndefined(a.dataSourceSettings.dataProviderType)&&""!==a.dataSourceSettings.dataProviderType?(a.dataType="olap",a.olapEngineModule=new Li):(a.dataType="pivot",a.engineModule=new m),a}Oi(n,e),o=n,n.prototype.requiredModules=function(){var e,t=[];return e=!0,t.push({args:[this],member:"grouping"}),this.allowConditionalFormatting&&t.push({args:[this],member:"conditionalformatting"}),this.allowNumberFormatting&&(e=!0,t.push({args:[this],member:"numberformatting"})),this.allowCalculatedField&&(e=!0,t.push({args:[this],member:"calculatedfield"})),this.showToolbar&&this.toolbar.length>0&&(e=!0,t.push({args:[this],member:"toolbar"})),this.showFieldList&&(e=!0,t.push({args:[this],member:"fieldlist"})),this.allowExcelExport&&t.push({args:[this],member:"excelExport"}),this.allowPdfExport&&t.push({args:[this],member:"pdfExport"}),this.enableVirtualization&&t.push({args:[this],member:"virtualscroll"}),this.gridSettings&&this.gridSettings.contextMenuItems&&(e=!0),e&&t.push({args:[this],member:"common"}),t},n.prototype.preRender=function(){this.initProperties(),this.isAdaptive=t.Browser.isDevice,this.renderToolTip(),this.keyboardModule=new gi(this),this.contextMenuModule=new mi(this),this.globalize=new t.Internationalization(this.locale),this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel",delete:"Delete",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"APPLY",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field :",baseItem:"Base item :",summarizeValuesBy:"Summarize values by :",sourceName:"Field name :",sourceCaption:"Field caption :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report",new:"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report",export:"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",png:"PNG",jpeg:"JPEG",svg:"SVG",mdxQuery:"MDX Query",showSubTotals:"Show sub totals",doNotShowSubTotals:"Do not show sub totals",showSubTotalsRowsOnly:"Show sub totals rows only",showSubTotalsColumnsOnly:"Show sub totals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter vaild report name!!!",reportList:"Report list",removeConfirm:"Are you sure want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Want to save changes to report?",emptyReportName:"Enter a report name",qtr:"Qtr",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping",true:"True",false:"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting",memberType:"Field Type",formatString:"Format String",expressionField:"Expression",customFormat:"Enter custom format string",selectedHierarchy:"Parent Hierarchy",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",Percent:"Percent",Currency:"Currency",Custom:"Custom",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing the calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.renderContextMenu(),this.isDragging=!1,this.addInternalEvents()},n.prototype.onBeforeTooltipOpen=function(e){e.element.classList.add("e-pivottooltipwrap")},n.prototype.renderToolTip=function(){this.showTooltip?(this.tooltip=new r.Tooltip({target:"td.e-valuescontent",showTipPointer:!1,enableRtl:this.enableRtl,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()},n.prototype.renderContextMenu=function(){if(this.gridSettings.contextMenuItems){for(var e=[],t=[],i=[],r=[],a=[],n=[],o=0,l=this.gridSettings.contextMenuItems;o<l.length;o++){var s=l[o];"string"==typeof s&&-1!==this.getDefaultItems().indexOf(s)?-1!==s.toString().toLowerCase().indexOf("aggregate")?n=[{text:this.localeObj.getConstant("Sum"),id:this.element.id+"_AggSum"},{text:this.localeObj.getConstant("DistinctCount"),id:this.element.id+"_AggDistinctCount"},{text:this.localeObj.getConstant("Count"),id:this.element.id+"_AggCount"},{text:this.localeObj.getConstant("Product"),id:this.element.id+"_AggProduct"},{text:this.localeObj.getConstant("Avg"),id:this.element.id+"_AggAvg"},{text:this.localeObj.getConstant("Max"),id:this.element.id+"_AggMax"},{text:this.localeObj.getConstant("Min"),id:this.element.id+"_AggMin"},{text:this.localeObj.getConstant("MoreOption"),id:this.element.id+"_AggMoreOption"}]:-1!==s.toString().toLowerCase().indexOf("export")?i.push(this.buildDefaultItems(s)):e.push(this.buildDefaultItems(s)):"string"!=typeof s&&t.push(s)}if(n.length>0){var d=this.buildDefaultItems("Aggregate");d.items=n,r.push(d)}if(i.length>0){var p=this.buildDefaultItems("export");p.items=i,a.push(p)}this.gridSettings.contextMenuItems=[],Array.prototype.push.apply(this.gridSettings.contextMenuItems,r),Array.prototype.push.apply(this.gridSettings.contextMenuItems,e),Array.prototype.push.apply(this.gridSettings.contextMenuItems,a),Array.prototype.push.apply(this.gridSettings.contextMenuItems,t)}},n.prototype.getDefaultItems=function(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]},n.prototype.buildDefaultItems=function(e){var t;switch(e){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("calculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+K};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+K};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:Rt+" "+K};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:jt+" "+K};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:kt+" "+K};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+K};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+K};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+K};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+K}}return this.defaultItems[e]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[e]},n.prototype.initProperties=function(){this.isScrolling=!1,this.setProperties({pivotValues:[]},!0),this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0,this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0,this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0,this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0,this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo.bind(this):void 0,this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo.bind(this):void 0,this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo.bind(this):void 0,this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo.bind(this):void 0,this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0,this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0,this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0,this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0,this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0,this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0,this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0,this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0,this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0,this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0,this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0,this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0,null===this.gridSettings.rowHeight&&this.setProperties({gridSettings:{rowHeight:this.isAdaptive?48:36}},!0),this.element.style.height="100%",this.enableVirtualization&&(this.updatePageSettings(!0),this.allowExcelExport&&o.Inject(ui),this.allowPdfExport&&o.Inject(ci),this.editSettings.allowEditing&&o.Inject(yi)),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type,"Table"!==this.displayOption.view&&(this.chartModule=new Si),this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view},n.prototype.updatePageSettings=function(e){if(this.enableVirtualization)if("pivot"===this.dataType){var t=1,i=1;this.dataSourceSettings.values.length>1&&("row"===this.dataSourceSettings.valueAxis?i=this.dataSourceSettings.values.length:t=this.dataSourceSettings.values.length);var r=this.getHeightAsNumber();isNaN(r)&&(r=this.element.offsetHeight),this.pageSettings={columnCurrentPage:e?1:this.pageSettings.columnCurrentPage,rowCurrentPage:e?1:this.pageSettings.rowCurrentPage,columnSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/t),rowSize:Math.ceil(Math.floor(r/this.gridSettings.rowHeight)/i)}}else this.pageSettings={columnCurrentPage:1,rowCurrentPage:1,columnSize:4,rowSize:4}},n.prototype.render=function(){var e=this;this.cellTemplateFn=this.templateParser(this.cellTemplate),this.spinnerTemplate?r.createSpinner({target:this.element,template:this.spinnerTemplate},this.createElement):r.createSpinner({target:this.element},this.createElement);var i={dataSourceSettings:this.dataSourceSettings,pivotview:this,fieldsType:{}};this.trigger("load",i,function(t){e.dataSourceSettings=t.dataSourceSettings,e.fieldsType=t.fieldsType,e.updateClass(),e.notify(_,{}),e.notify(j,{}),e.isAdaptive&&e.contextMenuModule.render(),e.notify(z,{})}),t.isBlazor()&&this.renderComplete()},n.prototype.addInternalEvents=function(){this.on(j,this.generateData,this),this.on(V,this.renderPivotGrid,this),this.on(H,this.onContentReady,this)},n.prototype.removeInternalEvents=function(){this.off(j,this.generateData),this.off(V,this.renderPivotGrid),this.off(H,this.onContentReady)},n.prototype.getPersistData=function(){return this.addOnPersist(["dataSourceSettings","pivotValues","gridSettings","chartSettings"])},n.prototype.getModuleName=function(){return"pivotview"},n.prototype.copy=function(e){this.grid.copy(e)},n.prototype.onPropertyChanged=function(i,r){for(var a=0,n=Object.keys(i);a<n.length;a++){switch(n[a]){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":if(i.dataSourceSettings&&1===Object.keys(i.dataSourceSettings).length&&i.dataSourceSettings.groupSettings){var o=t.extend([],this.dataSourceSettings.groupSettings,null,!0),l=g.getClonedData(this.clonedDataSet),s=t.extend({},this.clonedReport,null,!0);s.dataSource=l,(0===i.dataSourceSettings.groupSettings.length||i.dataSourceSettings.groupSettings.length>0)&&(s.groupSettings=i.dataSourceSettings.groupSettings.length>0?o:[],this.setProperties({dataSourceSettings:s},!0))}this.notify(j,{});break;case"pivotValues":case"displayOption":case"height":case"width":this.notify(V,{});break;case"gridSettings":this.lastGridSettings=i.gridSettings,this.renderModule.updateGridSettings(),this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type;break;case"chartSettings":this.chartModule.loadChart(this,this.chartSettings);break;case"locale":case"currencyCode":case"enableRtl":this.tooltip&&this.tooltip.destroy(),e.prototype.refresh.call(this),this.updateClass();break;case"enableValueSorting":this.enableValueSorting=i.enableValueSorting,this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")&&this.element.querySelector(".e-grouping-bar").remove(),this.renderPivotGrid();break;case"groupingBarSettings":this.axisFieldModule.render();break;case"showTooltip":this.renderToolTip();break;case"toolbar":this.toolbarModule&&this.toolbarModule.refreshToolbar()}}},n.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return t.compile(document.querySelector(e).innerHTML.trim())}catch(i){return t.compile(e)}},n.prototype.getCellTemplate=function(){return this.cellTemplateFn},n.prototype.renderPivotGrid=function(){"Table"===this.currentView&&this.cellTemplate&&t.isBlazor&&t.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.chartModule&&(this.chartModule.engineModule=this.engineModule,this.chartModule.loadChart(this,this.chartSettings)),(this.showFieldList||this.showGroupingBar)&&(this.notify(k,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=t.extend({},this.dataSourceSettings,null,!0))),this.enableVirtualization&&(this.virtualscrollModule=new fi(this)),"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new yi(this)),this.renderModule=new Kt(this),this.renderModule.render()):this.grid&&t.remove(this.grid.element),this.trigger(T),this.allowConditionalFormatting&&this.applyFormatting(),this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&("Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none"):(this.grid.element.style.display="none",this.chart.element.style.display="")),this.toolbarModule&&(this.showFieldList&&this.element.querySelector("#"+this.element.id+"_PivotFieldList")&&(this.element.querySelector("#"+this.element.id+"_PivotFieldList").style.display="none"),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action?this.isModified=!0:this.toolbarModule.action="")},n.prototype.updateDataSource=function(e){r.showSpinner(this.element);var t=this,i=Object.keys(t.lastSortInfo).length>0,a=Object.keys(t.lastFilterInfo).length>0,n=Object.keys(t.lastAggregationInfo).length>0,o=Object.keys(t.lastCalcFieldInfo).length>0;if(t.updatePageSettings(!1),"pivot"===t.dataType&&t.enableVirtualization&&(i||a||n||o))i&&(t.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),t.engineModule.onSort(t.lastSortInfo),t.lastSortInfo={}),n&&(t.engineModule.onAggregation(t.lastAggregationInfo),t.lastAggregationInfo={}),o&&(t.engineModule.onCalcOperation(t.lastCalcFieldInfo),t.lastCalcFieldInfo={}),a&&(t.engineModule.onFilter(t.lastFilterInfo,t.dataSourceSettings),t.lastFilterInfo={});else if("olap"===t.dataType){var l={mode:"",savedFieldList:t.olapEngineModule.fieldList,savedFieldListData:t.olapEngineModule.fieldListData,pageSettings:t.pageSettings,enableValueSorting:t.enableValueSorting,isDrillThrough:t.allowDrillThrough||t.editSettings.allowEditing,localeObj:t.localeObj};o||i?(t.olapEngineModule.savedFieldList=t.olapEngineModule.fieldList,t.olapEngineModule.savedFieldListData=t.olapEngineModule.fieldListData,o?(t.olapEngineModule.updateCalcFields(t.dataSourceSettings,t.lastCalcFieldInfo),t.lastCalcFieldInfo={}):(t.olapEngineModule.onSort(t.dataSourceSettings),t.lastSortInfo={})):t.olapEngineModule.renderEngine(t.dataSourceSettings,l),t.setProperties({pivotValues:t.olapEngineModule.pivotValues},!0)}else{l={mode:"",savedFieldList:t.engineModule.fieldList,pageSettings:t.pageSettings,enableValueSorting:t.enableValueSorting,isDrillThrough:t.allowDrillThrough||t.editSettings.allowEditing,localeObj:t.localeObj,fieldsType:t.fieldsType};try{t.engineModule.renderEngine(t.dataSourceSettings,l,t.getValueCellInfo.bind(t)),t.setProperties({pivotValues:t.engineModule.pivotValues},!0)}catch(e){if(!this.calculatedFieldModule||!this.calculatedFieldModule.isFormula)throw e;this.calculatedFieldModule.showError()}}var s={dataSourceSettings:t.dataSourceSettings,pivotValues:t.pivotValues};t.trigger(v,s,function(e){t.dataSourceSettings=e.dataSourceSettings,"olap"===t.dataType?t.olapEngineModule.pivotValues=e.pivotValues:t.engineModule.pivotValues=e.pivotValues,t.pivotCommon.engineModule="olap"===t.dataType?t.olapEngineModule:t.engineModule,t.pivotCommon.dataSourceSettings=t.dataSourceSettings,t.setProperties({pivotValues:e.pivotValues},!0),t.renderPivotGrid()})},n.prototype.excelExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("Excel"):this.grid.excelExport(e,t,i,r)},n.prototype.csvExport=function(e,t,i,r){this.enableVirtualization?this.excelExportModule.exportToExcel("CSV"):this.grid.csvExport(e,t,i,r)},n.prototype.pdfExport=function(e,t,i,r){this.enableVirtualization?this.pdfExportModule.exportToPDF():this.grid.pdfExport(e,t,i,r)},n.prototype.chartExport=function(e,t,i,r,a){this.chart&&this.chart.enableExport&&this.chart.exportModule.export(e,t,i,null,r,a)},n.prototype.printChart=function(){this.chart&&this.chart.print()},n.prototype.onDrill=function(e,t){var i=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",a="",n="",o="";if(t?(a=t.fieldName,n=t.cell.axis,o=t.isDrilled?"up":"down"):(a=e.parentElement.getAttribute("fieldname"),n=e.parentElement.classList.contains($e)?"row":"column",o=e.classList.contains(Xe)?"up":"down"),"pivot"===this.dataType){var l=t?t.cell:this.engineModule.pivotValues[Number(e.parentElement.getAttribute("index"))][Number(e.parentElement.getAttribute("aria-colindex"))],s=l.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(i),d=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:a,items:[s],delimiter:i}]}},!0);else{for(var p=0;p<this.dataSourceSettings.drilledMembers.length;p++){var h=this.dataSourceSettings.drilledMembers[p];if(s=s.split(i).join(h.delimiter?h.delimiter:i),i=h.delimiter=h.delimiter?h.delimiter:i,h.name===a){d=!0;var u=h.items.indexOf(s);u>-1?h.items.splice(u,1):h.items.push(s)}}d||this.dataSourceSettings.drilledMembers.push({name:a,items:[s],delimiter:i})}r.showSpinner(this.element);var c={fieldName:a,memberName:s,delimiter:i,axis:n,action:o,currentCell:l};this.trigger("drill",{drillInfo:c,pivotview:this}),this.enableVirtualization?(this.engineModule.drilledMembers=this.dataSourceSettings.drilledMembers,this.engineModule.onDrill(c)):this.engineModule.generateGridData(this.dataSourceSettings),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()}else this.onOlapDrill(a,n,o,i,e,t)},n.prototype.onOlapDrill=function(e,t,i,r,a,n){var o=n?n.cell:this.olapEngineModule.pivotValues[Number(a.parentElement.getAttribute("index"))][Number(a.parentElement.getAttribute("aria-colindex"))],l="row"===t?this.olapEngineModule.tupRowInfo[o.ordinal]:this.olapEngineModule.tupColumnInfo[o.ordinal],s={axis:t,action:i,fieldName:e,delimiter:r,memberName:l.uNameCollection,currentCell:o},d=l.drillInfo.map(function(e){return e.hierarchy}).indexOf(o.hierarchy.toString());if(s&&"down"===s.action){for(var p=s.memberName.split("::"),h="",u=0;u<=d;u++){var c=(y=p[u]).split("~~");h=h+(""!==h?"~~":"")+c[c.length-1]}s.memberName=h;for(var m=[],f=0,v=this.dataSourceSettings.drilledMembers;f<v.length;f++){var y;(y=v[f]).name===s.fieldName&&m.push(y)}if(m.length>0){m[0].delimiter&&(h=h.replace(/~~/g,m[0].delimiter));-1===g.inArray(h,m[0].items)&&m[0].items.push(h)}else{var S={name:s.fieldName,items:[h],delimiter:"~~"};this.dataSourceSettings.drilledMembers?this.dataSourceSettings.drilledMembers.push(S):this.dataSourceSettings.drilledMembers=[S]}this.olapEngineModule.updateDrilledInfo(this.dataSourceSettings)}else{for(var b=this.olapEngineModule.getDrilledSets(s.memberName,d,t),C=0,x=Object.keys(b);C<x.length;C++)for(var w=b[x[C]],T=0,M=this.dataSourceSettings.drilledMembers.length;T<M;T++){h=w;(m=this.dataSourceSettings.drilledMembers[T]).delimiter&&(h=w.replace(/~~/g,m.delimiter));for(var D=[],E=0;E<m.items.length;E++)0!==m.items[E].indexOf(h)&&(D[D.length]=m.items[E]);m.items=D}for(var L=[],O=0,P=this.dataSourceSettings.drilledMembers;O<P.length;O++){(p=P[O]).items.length>0&&L.push(p)}this.setProperties({dataSourceSettings:{drilledMembers:L}},!0),this.olapEngineModule.updateDrilledInfo(this.dataSourceSettings)}this.setProperties({pivotValues:this.olapEngineModule.pivotValues},!0),this.renderPivotGrid()},n.prototype.onContentReady=function(){if("Table"!==this.currentView&&this.cellTemplate&&t.isBlazor&&t.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.isPopupClicked=!1,this.showFieldList?r.hideSpinner(this.pivotFieldListModule.fieldListSpinnerElement):this.fieldListSpinnerElement&&r.hideSpinner(this.fieldListSpinnerElement),this.isEmptyGrid?this.isEmptyGrid=!1:(r.hideSpinner(this.element),this.trigger(T)),this.grid){if(this.enableVirtualization&&this.engineModule){this.element.querySelector("."+Mt)&&!this.element.querySelector("."+Mt).querySelector("."+Tt)&&(this.virtualDiv=t.createElement("div",{className:Tt}),this.element.querySelector("."+Mt).appendChild(this.virtualDiv)),this.element.querySelector("."+Et)&&!this.element.querySelector("."+Et).querySelector("."+Tt)?(this.virtualHeaderDiv=t.createElement("div",{className:Tt}),this.element.querySelector("."+Et).appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector("."+Et).querySelector("."+Tt);var e=this.element.querySelector("."+Mt).querySelector(".e-table"),i=this.gridSettings.rowHeight*this.engineModule.rowCount+.1-e.clientHeight;i>this.scrollerBrowserLimit&&(this.verticalScrollScale=i/this.scrollerBrowserLimit,i=this.scrollerBrowserLimit);var a=this.gridSettings.columnWidth*this.engineModule.columnCount-this.grid.columns[0].width;a>this.scrollerBrowserLimit&&(this.horizontalScrollScale=a/this.scrollerBrowserLimit,a=this.scrollerBrowserLimit),t.setStyleAttribute(this.virtualDiv,{height:(i>.1?i:.1)+"px",width:(a>.1?a:.1)+"px"}),t.setStyleAttribute(this.virtualHeaderDiv,{height:0,width:(a>.1?a:.1)+"px"});var n=this.element.querySelector("."+Mt),o=this.element.querySelector("."+Dt),l=this.element.querySelector("."+Et),s=n.scrollTop>this.scrollerBrowserLimit?n.querySelector("."+Ze).style.transform.split(",")[1].trim():-(n.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-n.scrollTop)+"px)",d=n.scrollLeft>this.scrollerBrowserLimit?n.querySelector("."+Ze).style.transform.split(",")[0].trim()+",":"translate("+-(n.scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-n.scrollLeft)+"px,";t.setStyleAttribute(o.querySelector(".e-table"),{transform:"translate(0px,"+s}),t.setStyleAttribute(n.querySelector(".e-table"),{transform:d+s}),t.setStyleAttribute(l.querySelector(".e-table"),{transform:d+0+"px)"})}this.showGroupingBar?(this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"):(this.element.style.minWidth="310px",this.grid.element.style.minWidth="310px"),this.unwireEvents(),this.wireEvents()}if(this.isChartLoaded=!1,this.cellTemplate&&t.isBlazor){var p=Object.keys(this.gridCellCollection);if(p.length>0){for(var h=0,u=p;h<u.length;h++){var c=u[h],g=this.gridCellCollection[c];t.append([].slice.call(this.getCellTemplate()({targetCell:g},this,"cellTemplate",this.element.id+"_cellTemplate")),g)}t.updateBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate",this)}}},n.prototype.setToolTip=function(e){var t=Number(e.target.getAttribute("aria-colindex")),i=Number(e.target.getAttribute("index")),r=this.pivotValues[i][t];this.tooltip.content="";var a,n,o=!1;r&&"olap"===this.dataType?this.olapEngineModule.fieldList[r.actualText]&&(a=this.olapEngineModule.fieldList[r.actualText].aggregateType,n=this.olapEngineModule.fieldList[r.actualText].caption,o=!0):r&&this.engineModule.fieldList[r.actualText]&&(a=this.engineModule.fieldList[r.actualText].aggregateType,n=this.engineModule.fieldList[r.actualText].caption,o=!0),r&&o?this.tooltip.content="<div class=e-pivottooltip><p class="+tt+">"+this.localeObj.getConstant("row")+":</p><p class="+it+">"+this.getRowText(i,0)+"</p></br><p class="+tt+">"+this.localeObj.getConstant("column")+":</p><p class="+it+">"+this.getColText(0,t,i)+"</p></br>"+(""!==r.actualText?"<p class="+tt+">"+this.localeObj.getConstant(a)+" "+this.localeObj.getConstant("of")+" "+n+":</p><p class="+it+">"+("0"===r.formattedText||""===r.formattedText?this.localeObj.getConstant("noValue"):r.formattedText)+"</p></div>":""):e.cancel=!0},n.prototype.getRowText=function(e,t){for(var i=this.pivotValues[e][t],r=i.level,a="grand sum"===i.type?this.localeObj.getConstant("grandTotal"):i.formattedText;r>0||void 0===i.index;)e--,void 0!==(i=this.pivotValues[e][t]).index&&r>i.level&&(a=a+" - "+i.formattedText,r-=1);return a.split(" - ").reverse().join(" - ")},n.prototype.getColText=function(e,t,i){for(var r=this.pivotValues[0][t],a=r.axis,n="grand sum"===r.type?this.localeObj.getConstant("grandTotal"):r.formattedText;"value"!==a&&i>e;)e++,this.pivotValues[e]&&(a=(r=this.pivotValues[e][t]).axis,"sum"!==r.type&&"grand sum"!==r.type&&"value"!==a&&(n=n+" - "+r.formattedText));return n},n.prototype.updateClass=function(){this.enableRtl?t.addClass([this.element],Y):t.removeClass([this.element],Y),this.isAdaptive?t.addClass([this.element],X):t.removeClass([this.element],X)},n.prototype.mouseRclickHandler=function(e){3===e.which?this.lastCellClicked=e.target:0===e.which&&(this.lastCellClicked=e.target),this.lastCellClicked=e.target},n.prototype.mouseDownHandler=function(e){if(3===e.which&&(this.lastCellClicked=e.target),this.isCellBoxMultiSelection){this.isMouseDown=!0,this.isMouseUp=!1;var t=this.parentAt(e.target,"TH");this.clearSelection(t,e,Number(t.getAttribute("aria-colindex")),Number(t.getAttribute("index"))),this.lastSelectedElement=void 0}},n.prototype.mouseMoveHandler=function(e){if(this.isCellBoxMultiSelection&&(e.preventDefault(),this.isMouseDown&&e.target)){var t=e.target,i=this.parentAt(t,"TH");this.lastSelectedElement&&this.lastSelectedElement!==i&&i.classList.contains(Ot)?(this.lastSelectedElement.classList.remove(It),this.lastSelectedElement.classList.remove(Ot),this.lastSelectedElement=i):(this.lastSelectedElement=i,i.classList.add(It),i.classList.add(Ot)),this.renderModule.selected()}},n.prototype.mouseUpHandler=function(e){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)},n.prototype.parentAt=function(e,t){for(;e.tagName!==t&&e.parentElement;)e=e.parentElement;return e},n.prototype.mouseClickHandler=function(e){3===e.which?this.lastCellClicked=e.target:0===e.which&&(this.lastCellClicked=e.target);var t=e.target;if((t.classList.contains("e-headercell")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")||t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headertext")||t.classList.contains("e-ascending")||t.classList.contains("e-descending"))&&this.enableValueSorting){var i=null;if(t.classList.contains("e-headercell")||t.classList.contains("e-rowsheader")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-headercelldiv")||t.classList.contains("e-ascending")||t.classList.contains("e-descending")?i=t.parentElement:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),this.CellClicked(t,e),i.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader")&&"column"===this.dataSourceSettings.valueAxis||i.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(i.parentElement.classList.contains("e-rowsheader")||i.classList.contains("e-stot"))){var a=Number(i.getAttribute("aria-colindex")),n=Number(i.getAttribute("index"));"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)?n="value"===this.pivotValues[n][a].type?n:n+1:"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(a=Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,n=this.engineModule.headerContent.length-1),this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(i.getAttribute("aria-colindex"))+Number(i.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[n][a].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),r.showSpinner(this.element);if(this.engineModule.enableValueSorting=!0,this.enableVirtualization){if(this.dataSourceSettings.enableSorting){for(var o=0,l=Object.keys(this.engineModule.fieldList);o<l.length;o++){var s=l[o];this.engineModule.fieldList[s].sort="Ascending"}this.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}this.engineModule.rMembers=this.engineModule.headerCollection.rowHeaders,this.engineModule.cMembers=this.engineModule.headerCollection.columnHeaders,this.engineModule.applyValueSorting(),this.engineModule.updateEngine()}else this.engineModule.generateGridData(this.dataSourceSettings);this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.renderPivotGrid()}}else{if(!t.classList.contains(Xe)&&!t.classList.contains(Ke))return void this.CellClicked(t,e);this.onDrill(t)}},n.prototype.framePivotColumns=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.columns&&r.columns.length>0)this.framePivotColumns(r.columns);else{var a="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"",n=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:a,Number("auto"===r.width?r.minWidth:r.width));this.pivotColumns.push({allowReordering:r.allowReordering,allowResizing:r.allowResizing,headerText:a,width:n}),this.totColWidth=this.totColWidth+Number(n)}}},n.prototype.setGridColumns=function(e){if(this.element.offsetWidth<this.totColWidth){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.columns&&r.columns.length>0)this.setGridColumns(r.columns);else{var n="0.formattedText"===r.field?"":r.customAttributes?r.customAttributes.cell.valueSort.levelName:"";r.allowReordering=this.pivotColumns[this.posCount].allowReordering,r.allowResizing=this.pivotColumns[this.posCount].allowResizing;var o=this.renderModule.setSavedWidth("0.formattedText"===r.field?r.field:n,Number(this.pivotColumns[this.posCount].width));"auto"!==r.width?r.width=o:r.minWidth=o,this.posCount++,r.allowReordering&&(this.gridSettings.allowReordering=!0),r.allowResizing&&(this.gridSettings.allowResizing=!0)}}this.gridSettings.allowReordering&&a.Grid.Inject(a.Reorder),this.gridSettings.allowResizing&&a.Grid.Inject(a.Resize)}},n.prototype.fillGridColumns=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];r.allowReordering=this.gridSettings.allowReordering,r.allowResizing=this.gridSettings.allowResizing,this.posCount++,r.columns&&r.columns.length>0&&this.fillGridColumns(r.columns)}},n.prototype.triggerColumnRenderEvent=function(e){this.pivotColumns=[],this.totColWidth=0,this.framePivotColumns(e);var t=this.pivotColumns[0].width,i={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings};this.trigger(D,i),t!==this.pivotColumns[0].width&&this.element.offsetWidth<this.totColWidth&&(this.firstColWidth=this.pivotColumns[0].width),this.posCount=0,this.setGridColumns(e)},n.prototype.setCommonColumnsWidth=function(e,t){for(var i=0,r=e;i<r.length;i++){var a=r[i];"0.formattedText"!==a.field?a.columns?this.setCommonColumnsWidth(a.columns,t):"auto"!==a.width?a.width=t:a.minWidth=t:a.width=this.firstColWidth?this.firstColWidth:a.width}},n.prototype.getHeightAsNumber=function(){var e;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?e=parseFloat(this.height.toString())/100*this.element.offsetHeight:this.height.toString().indexOf("px")>-1&&(e=Number(this.height.toString().split("px")[0])):e=Number(this.height),e<this.gridSettings.rowHeight&&(e=this.gridSettings.rowHeight),e},n.prototype.getWidthAsNumber=function(){var e;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?e=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(e=Number(this.width.toString().split("px")[0])),isNaN(e)&&(e=this.element.offsetWidth)):e=Number(this.width),e<400&&(e=400),e},n.prototype.onWindowResize=function(){clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500)},n.prototype.layoutRefresh=function(){if(this.element&&this.element.classList.contains("e-pivotview")&&("olap"===this.dataType?this.olapEngineModule&&this.olapEngineModule.pivotValues:this.engineModule&&this.engineModule.pivotValues)){var e=this.renderModule.resizeColWidth(this.dataSourceSettings.values.length>0?"olap"===this.dataType&&this.olapEngineModule.pivotValues.length>0?this.olapEngineModule.pivotValues[0].length:this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2:2);this.grid.width=this.renderModule.calculateGridWidth(),this.renderModule.calculateGridHeight(!0),this.setCommonColumnsWidth(this.grid.columns,e),this.posCount=0,this.showGroupingBar||this.setGridColumns(this.grid.columns),"Table"===this.currentView&&this.cellTemplate&&t.isBlazor&&t.resetBlazorTemplate(this.element.id+"_cellTemplate","CellTemplate"),this.grid.refreshColumns(),this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+Ne)&&this.groupingBarModule.setGridRowWidth()}},n.prototype.CellClicked=function(e,t){var i=this,r=null;if(e.classList.contains("e-headercell")||e.classList.contains("e-rowcell")?r=e:e.classList.contains("e-stackedheadercelldiv")||e.classList.contains("e-cellvalue")||e.classList.contains("e-headercelldiv")?r=e.parentElement:e.classList.contains("e-headertext")?r=e.parentElement.parentElement:e.classList.contains(Ft)&&(e.classList.contains(At)?this.isPopupClicked=!1:this.isPopupClicked=!0),r){var a=Number(r.getAttribute("aria-colindex")),n=Number(r.getAttribute("index")),o=Number(r.getAttribute("aria-colspan")),l={cancel:!1,isCellClick:!0,currentCell:r,data:this.pivotValues[n][a]};this.trigger(E,l,function(e){i.gridSettings.allowSelection&&(("Both"===i.gridSettings.selectionSettings.mode?r.classList.contains(Nt):"Row"===i.gridSettings.selectionSettings.mode)?i.clearSelection(r,t,a,n):(i.clearSelection(r,t,a,n),e.cancel||i.applyColumnSelection(t,r,a,a+(o>0?o-1:0),n)),"Multiple"!==i.gridSettings.selectionSettings.type||"Row"!==i.gridSettings.selectionSettings.mode&&"Both"!==i.gridSettings.selectionSettings.mode||i.applyRowSelection(0,n,t)),i.cellClick&&e.isCellClick&&i.trigger("cellClick",{currentCell:r,data:i.pivotValues[n][a]})})}},n.prototype.clearSelection=function(e,t,i,r){(t.shiftKey||t.ctrlKey)&&"Single"!==this.gridSettings.selectionSettings.type||("Cell"===this.gridSettings.selectionSettings.mode?e.classList.contains(Je)?[].slice.call(this.element.querySelectorAll(".e-rowcell."+Lt)).forEach(function(e){e.classList.remove(Lt)}):[].slice.call(this.element.querySelectorAll("."+Je+"."+It)).forEach(function(e){e.classList.remove(It),e.classList.remove(Ot)}):"Both"===this.gridSettings.selectionSettings.mode&&(e.classList.contains(Nt)?[].slice.call(this.element.querySelectorAll("."+Ot)).forEach(function(e){Number(e.getAttribute("index"))!==r&&(e.classList.remove(It),e.classList.remove(Ot))}):[].slice.call(this.element.querySelectorAll("."+Lt)).forEach(function(e){e.classList.remove(Lt)})))},n.prototype.applyRowSelection=function(e,t,i){var r=this.engineModule.pivotValues[t][e];if(!i.ctrlKey&&!i.shiftKey&&r&&r.members.length>0){var a=r.level,n=t;do{n++,r=this.engineModule.pivotValues[n][e]}while(r&&a<r.level);this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-this.renderModule.rowStartPos,endIndex:n-(1+this.renderModule.rowStartPos)}:this.grid.selectionModule.selectRowsByRange(t-this.renderModule.rowStartPos,n-(1+this.renderModule.rowStartPos))}},n.prototype.applyColumnSelection=function(e,t,i,r,a){if(!t.classList.contains($e)&&("Cell"!==this.gridSettings.selectionSettings.mode||t.classList.contains(Je))){var n=e.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(e),this.isPopupClicked?(this.element.querySelector("."+Ft).classList.add(At),n=!0):(this.element.querySelector("."+Ft).classList.remove(At),n=!1));for(var o=[],l=this.gridSettings.selectionSettings.type,s=t.classList.contains(It),d=[],p={},h=i;h<=r;h++)d.push(h.toString());n&&"Single"!==l?s=!1:([].slice.call(this.element.querySelectorAll("."+It)).forEach(function(e){e.classList.remove(It),e.classList.remove(Ot),-1===d.indexOf(e.getAttribute("aria-colindex"))&&(s=!1);var t=Number(e.getAttribute("aria-colindex"));p[t]=t}),d=Object.keys(p).length>0?Object.keys(p).sort(function(e,t){return e-t}):d),"Multiple"===l&&e.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?d:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=i?i=Number(this.shiftLockedPos[0]):r=r<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):r):this.shiftLockedPos=[];var u=[];e.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===l&&!t.classList.contains($e)&&[].slice.call(this.element.querySelectorAll("."+$e+"."+Lt)).forEach(function(e){u.push(e.getAttribute("index"))});for(var c=i;c<=r;)o.push('[aria-colindex="'+c+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+a+'"]':"")),c++;if(!s){a=t.classList.contains("e-headercell")?a:this.renderModule.rowStartPos-1;var g=t.classList.contains(It);[].slice.call(this.element.querySelectorAll(o.toString())).forEach(function(e){Number(e.getAttribute("index"))>=a&&(g&&n&&-1===u.indexOf(e.getAttribute("index"))?(e.classList.remove(It),e.classList.remove(Ot)):(e.classList.add(It),e.classList.add(Ot)))})}this.renderModule.selected()}},n.prototype.getSelectedCellsPos=function(){var e=this;e.savedSelectedCellsPos=[],[].slice.call(this.element.querySelectorAll("."+Ot)).forEach(function(t){e.savedSelectedCellsPos.push({rowIndex:t.getAttribute("index"),colIndex:t.getAttribute("aria-colindex")})})},n.prototype.setSavedSelectedCells=function(){var e=this;[].slice.call(this.savedSelectedCellsPos).forEach(function(t){var i='[aria-colindex="'+t.colIndex+'"][index="'+t.rowIndex+'"]';e.element.querySelector(i).classList.add(It),e.element.querySelector(i).classList.add(Ot)})},n.prototype.renderEmptyGrid=function(){var e=this;this.isEmptyGrid=!0,this.renderModule=new Kt(this),this.grid&&this.grid.element&&this.element.querySelector(".e-grid")?(this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns()):(this.element.querySelector(".e-grid")&&t.remove(this.element.querySelector(".e-grid")),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){},this.element.appendChild(t.createElement("div",{id:this.element.id+"_grid"})),this.grid.isStringTemplate=!0,this.grid.appendTo("#"+this.element.id+"_grid"),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",function(){e.grid.scrollModule.setWidth(),e.grid.scrollModule.setHeight(),e.grid.element.querySelector(".e-movablecontent").style.overflowY="auto"}))},n.prototype.initEngine=function(){var e=this;this.trigger(f,{dataSourceSettings:this.dataSourceSettings},function(i){e.dataSourceSettings=i.dataSourceSettings,e.updatePageSettings(!1);var r={mode:"",savedFieldList:void 0,pageSettings:e.pageSettings,enableValueSorting:e.enableValueSorting,isDrillThrough:e.allowDrillThrough||e.editSettings.allowEditing,localeObj:e.localeObj,fieldsType:e.fieldsType};if("pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var a=e.engineModule.data;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:g.getClonedData(a),e.setProperties({dataSourceSettings:{dataSource:[]}},!0),e.clonedReport=e.clonedReport?e.clonedReport:t.extend({},e.dataSourceSettings,null,!0),e.setProperties({dataSourceSettings:{dataSource:a}},!0)}e.engineModule.renderEngine(e.dataSourceSettings,r,e.getValueCellInfo.bind(e)),e.setProperties({pivotValues:e.engineModule.pivotValues},!0)}else""!==e.dataSourceSettings.dataProviderType&&"olap"===e.dataType&&(r.savedFieldListData=void 0,e.olapEngineModule.renderEngine(e.dataSourceSettings,r),e.setProperties({pivotValues:e.olapEngineModule.pivotValues},!0));var n=e;e.trigger(v,{pivotValues:e.pivotValues},function(e){n.pivotValues=e.pivotValues,n.notify(V,{}),n.isEmptyGrid=!1})})},n.prototype.generateData=function(){"Chart"!==this.displayOption.view&&this.renderEmptyGrid(),r.showSpinner(this.element);this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?this.dataSourceSettings.dataSource instanceof i.DataManager?setTimeout(this.getData.bind(this),100):""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):r.hideSpinner(this.element):r.hideSpinner(this.element)},n.prototype.getValueCellInfo=function(e){var t=e;return this.trigger(A,t),t},n.prototype.bindTriggerEvents=function(e){this.trigger(a.getObject("name",e),e)},n.prototype.getData=function(){this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},n.prototype.executeQuery=function(e){this.element.querySelector(".e-spinner-pane")||r.showSpinner(this.element);this.engineModule.data=e.result,this.initEngine()},n.prototype.applyFormatting=function(){if(this.pivotValues){for(var e=[],i=this.pivotValues.length,r=0;r<i;r++)void 0!==this.pivotValues[r]&&void 0===this.pivotValues[r][0]&&e.push(r);for(r=0;r<this.pivotValues.length;r++)for(var a=1;this.pivotValues[r]&&a<this.pivotValues[r].length;a++)if("value"===this.pivotValues[r][a].axis){this.pivotValues[r][a].style=void 0,this.pivotValues[r][a].cssClass=void 0;for(var n=this.dataSourceSettings.conditionalFormatSettings,o=0;o<n.length;o++)if((!0===n[o].applyToGrandTotals||t.isNullOrUndefined(n[o].applyToGrandTotals)||""!==this.pivotValues[r][a].rowHeaders&&""!==this.pivotValues[r][a].columnHeaders)&&this.checkCondition(this.pivotValues[r][a].value,n[o].conditions,n[o].value1,n[o].value2)){"row"===this.dataSourceSettings.valueAxis||this.engineModule.headerContent.length,this.dataSourceSettings.valueAxis;n[o].measure&&this.pivotValues[r][a].actualText!==n[o].measure||void 0!==n[o].measure&&""===n[o].measure||void 0!==n[o].label&&""===n[o].label||!(!n[o].label||this.pivotValues[r][0].valueSort.levelName.indexOf(n[o].label)>-1||this.pivotValues[r][a].rowHeaders.indexOf(n[o].label)>-1||this.pivotValues[r][a].columnHeaders.indexOf(n[o].label)>-1)||(n[o].style&&n[o].style.backgroundColor&&(n[o].style.backgroundColor=this.conditionalFormattingModule.isHex(n[o].style.backgroundColor.substr(1))?n[o].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(n[o].style.backgroundColor)),n[o].style&&n[o].style.color&&(n[o].style.color=this.conditionalFormattingModule.isHex(n[o].style.color.substr(1))?n[o].style.color:this.conditionalFormattingModule.colourNameToHex(n[o].style.color)),this.pivotValues[r][a].style=n[o].style,this.pivotValues[r][a].cssClass="format"+this.element.id+o)}}var l=this.dataSourceSettings.conditionalFormatSettings;for(o=0;o<l.length;o++){var s=this.createStyleSheet.bind(this)(),d="color: "+l[o].style.color+"!important;background-color: "+l[o].style.backgroundColor+"!important;font-size: "+l[o].style.fontSize+"!important;font-family: "+l[o].style.fontFamily+" !important;";s.insertRule(".format"+this.element.id+o+"{"+d+"}",0)}}},n.prototype.createStyleSheet=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet},n.prototype.applyHyperlinkSettings=function(){if(this.pivotValues){for(var e=this.pivotValues,i=[],r=e.length,a=0;a<r;a++)void 0!==e[a]&&void 0===e[a][0]&&i.push(a);if(this.hyperlinkSettings.conditionalSettings.length>0)for(a=0;a<e.length;a++)for(var n=1;e[a]&&n<e[a].length;n++)if("value"===e[a][n].axis){e[a][n].enableHyperlink=!1;for(var o=this.hyperlinkSettings.conditionalSettings,l=0;l<o.length;l++)if(this.checkCondition(e[a][n].value,o[l].conditions,o[l].value1,o[l].value2)){var s="row"===this.dataSourceSettings.valueAxis?a:this.engineModule.headerContent.length-1,d="row"===this.dataSourceSettings.valueAxis?0:n;(!o[l].measure||1===this.dataSourceSettings.values.length||e[s][d].valueSort&&e[s][d].actualText===o[l].measure)&&(!o[l].label||e[i[o[l].label.split(".").length-1]]&&e[i[o[l].label.split(".").length-1]][n]&&e[i[o[l].label.split(".").length-1]][n].valueSort&&e[i[o[l].label.split(".").length-1]][n].valueSort[o[l].label]||e[a][0].valueSort.levelName.indexOf(o[l].label)>-1)&&(e[a][n].enableHyperlink=!0)}}if(t.isNullOrUndefined(this.hyperlinkSettings.headerText))return;for(a=0;a<e.length;a++)for(n=1;e[a]&&n<e[a].length;n++)if("value"===e[a][n].axis){var p=this.hyperlinkSettings.headerText;s="row"===this.dataSourceSettings.valueAxis?a:this.engineModule.headerContent.length-1,d="row"===this.dataSourceSettings.valueAxis?0:n;if(e[i[p.split(".").length-1]]&&e[i[p.split(".").length-1]][n]&&e[i[p.split(".").length-1]][n].valueSort&&e[i[p.split(".").length-1]][n].valueSort[p]){for(var h=0,u=i;h<u.length;h++){var c=u[h];e[c][n]&&"column"===e[c][n].axis&&e[c][n].valueSort.levelName.indexOf(p)>-1&&(e[c][n].enableHyperlink=!0)}e[a][n].enableHyperlink=!0}else e[a][0].valueSort.levelName.indexOf(p)>-1&&(e[a][0].enableHyperlink=!0,e[a][n].enableHyperlink=!0)}}},n.prototype.checkCondition=function(e,t,i,r){switch(t){case"LessThan":return e<i;case"LessThanOrEqualTo":return e<=i;case"GreaterThan":return e>i;case"GreaterThanOrEqualTo":return e>=i;case"Equals":return e===i;case"NotEquals":return e!==i;case"Between":return i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r;case"NotBetween":return!(i<r&&e>=i&&e<=r||i>r&&e<=i&&e>=r);default:return!1}},n.prototype.wireEvents=function(){"Chart"!==this.displayOption.view&&(t.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),t.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),t.EventHandler.add(this.element.querySelector("."+qt),"mousemove",this.mouseMoveHandler,this),t.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),t.EventHandler.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this),window.addEventListener("resize",this.onWindowResize.bind(this),!0))},n.prototype.unwireEvents=function(){"Chart"!==this.displayOption.view&&(t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),t.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector("."+qt)&&t.EventHandler.remove(this.element.querySelector("."+qt),"mousemove",this.mouseMoveHandler),t.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),t.EventHandler.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler),window.removeEventListener("resize",this.onWindowResize.bind(this),!0))},n.prototype.destroy=function(){this.removeInternalEvents(),this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy(),this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy(),this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy(),this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy(),this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy(),this.isAdaptive&&this.contextMenuModule&&this.contextMenuModule.destroy(),this.keyboardModule&&this.keyboardModule.destroy(),this.tooltip&&this.tooltip.destroy(),this.chart&&this.chart.destroy(),this.unwireEvents(),t.removeClass([this.element],Q),t.removeClass([this.element],Y),t.removeClass([this.element],X),this.element.innerHTML="",e.prototype.destroy.call(this)};var o;return Pi([t.Property("USD")],n.prototype,"currencyCode",void 0),Pi([t.Property(!1)],n.prototype,"showFieldList",void 0),Pi([t.Complex({},hi)],n.prototype,"gridSettings",void 0),Pi([t.Complex({},Di)],n.prototype,"chartSettings",void 0),Pi([t.Complex({},Ni)],n.prototype,"groupingBarSettings",void 0),Pi([t.Complex({},Fi)],n.prototype,"hyperlinkSettings",void 0),Pi([t.Complex({},si)],n.prototype,"dataSourceSettings",void 0),Pi([t.Complex({},Ii)],n.prototype,"editSettings",void 0),Pi([t.Complex({},qi)],n.prototype,"displayOption",void 0),Pi([t.Property()],n.prototype,"pivotValues",void 0),Pi([t.Property(!1)],n.prototype,"showGroupingBar",void 0),Pi([t.Property(!0)],n.prototype,"showTooltip",void 0),Pi([t.Property(!1)],n.prototype,"showToolbar",void 0),Pi([t.Property([])],n.prototype,"toolbar",void 0),Pi([t.Property(!1)],n.prototype,"showValuesButton",void 0),Pi([t.Property(!1)],n.prototype,"allowCalculatedField",void 0),Pi([t.Property(!1)],n.prototype,"enableValueSorting",void 0),Pi([t.Property(!1)],n.prototype,"allowConditionalFormatting",void 0),Pi([t.Property(!1)],n.prototype,"allowNumberFormatting",void 0),Pi([t.Property("auto")],n.prototype,"height",void 0),Pi([t.Property("auto")],n.prototype,"width",void 0),Pi([t.Property(!1)],n.prototype,"allowExcelExport",void 0),Pi([t.Property(!1)],n.prototype,"enableVirtualization",void 0),Pi([t.Property(!1)],n.prototype,"allowDrillThrough",void 0),Pi([t.Property(!1)],n.prototype,"allowPdfExport",void 0),Pi([t.Property(!1)],n.prototype,"allowDeferLayoutUpdate",void 0),Pi([t.Property(1e3)],n.prototype,"maxNodeLimitInMemberEditor",void 0),Pi([t.Property(1e4)],n.prototype,"maxRowsForDrillThrough",void 0),Pi([t.Property(!1)],n.prototype,"loadMaximumMembers",void 0),Pi([t.Property()],n.prototype,"cellTemplate",void 0),Pi([t.Property()],n.prototype,"spinnerTemplate",void 0),Pi([t.Event()],n.prototype,"queryCellInfo",void 0),Pi([t.Event()],n.prototype,"headerCellInfo",void 0),Pi([t.Event()],n.prototype,"resizing",void 0),Pi([t.Event()],n.prototype,"resizeStop",void 0),Pi([t.Event()],n.prototype,"pdfHeaderQueryCellInfo",void 0),Pi([t.Event()],n.prototype,"pdfQueryCellInfo",void 0),Pi([t.Event()],n.prototype,"excelHeaderQueryCellInfo",void 0),Pi([t.Event()],n.prototype,"excelQueryCellInfo",void 0),Pi([t.Event()],n.prototype,"columnDragStart",void 0),Pi([t.Event()],n.prototype,"columnDrag",void 0),Pi([t.Event()],n.prototype,"columnDrop",void 0),Pi([t.Event()],n.prototype,"beforeColumnsRender",void 0),Pi([t.Event()],n.prototype,"selected",void 0),Pi([t.Event()],n.prototype,"cellDeselected",void 0),Pi([t.Event()],n.prototype,"rowSelected",void 0),Pi([t.Event()],n.prototype,"rowDeselected",void 0),Pi([t.Event()],n.prototype,"chartTooltipRender",void 0),Pi([t.Event()],n.prototype,"chartLoaded",void 0),Pi([t.Event()],n.prototype,"chartLoad",void 0),Pi([t.Event()],n.prototype,"chartResized",void 0),Pi([t.Event()],n.prototype,"chartAxisLabelRender",void 0),Pi([t.Event()],n.prototype,"contextMenuClick",void 0),Pi([t.Event()],n.prototype,"contextMenuOpen",void 0),Pi([t.Event()],n.prototype,"onPdfCellRender",void 0),Pi([t.Event()],n.prototype,"saveReport",void 0),Pi([t.Event()],n.prototype,"fetchReport",void 0),Pi([t.Event()],n.prototype,"loadReport",void 0),Pi([t.Event()],n.prototype,"renameReport",void 0),Pi([t.Event()],n.prototype,"removeReport",void 0),Pi([t.Event()],n.prototype,"newReport",void 0),Pi([t.Event()],n.prototype,"toolbarRender",void 0),Pi([t.Event()],n.prototype,"toolbarClick",void 0),Pi([t.Event()],n.prototype,"load",void 0),Pi([t.Event()],n.prototype,"enginePopulating",void 0),Pi([t.Event()],n.prototype,"enginePopulated",void 0),Pi([t.Event()],n.prototype,"onFieldDropped",void 0),Pi([t.Event()],n.prototype,"dataBound",void 0),Pi([t.Event()],n.prototype,"created",void 0),Pi([t.Event()],n.prototype,"destroyed",void 0),Pi([t.Event()],n.prototype,"beforeExport",void 0),Pi([t.Event()],n.prototype,"conditionalFormatCreating",void 0),Pi([t.Event()],n.prototype,"cellClick",void 0),Pi([t.Event()],n.prototype,"drillThrough",void 0),Pi([t.Event()],n.prototype,"beginDrillThrough",void 0),Pi([t.Event()],n.prototype,"hyperlinkCellClick",void 0),Pi([t.Event()],n.prototype,"cellSelecting",void 0),Pi([t.Event()],n.prototype,"drill",void 0),Pi([t.Event()],n.prototype,"cellSelected",void 0),Pi([t.Event()],n.prototype,"chartSeriesCreated",void 0),Pi([t.Event()],n.prototype,"aggregateCellInfo",void 0),Pi([t.Event()],n.prototype,"fieldListRefreshed",void 0),n=o=Pi([t.NotifyPropertyChanges],n)}(t.Component),ji=function(){function e(e){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",delete:"delete",enter:"enter"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new t.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return e.prototype.keyActionHandler=function(e){switch(e.action){case"shiftF":this.processFilter(e);break;case"shiftS":this.processSort(e);break;case"delete":this.processDelete(e);break;case"enter":this.processOpenContextMenu(e)}},e.prototype.processOpenContextMenu=function(e){var i=e.target;if(i&&t.closest(i,"."+pe)&&t.closest(i,"."+Oe))return i.querySelector("."+J).click(),void e.preventDefault()},e.prototype.processSort=function(e){var i=e.target;if(i&&t.closest(i,"."+pe)&&!t.closest(i,"."+Oe)&&!t.closest(i,".e-axis-filter"))return i.querySelector(".e-sort").click(),void e.preventDefault()},e.prototype.processFilter=function(e){var i=e.target;if(i&&t.closest(i,"."+pe)&&!t.closest(i,"."+Oe))return i.querySelector("."+ue).click(),void e.preventDefault()},e.prototype.processDelete=function(e){var i=e.target;if(i&&t.closest(i,"."+pe))return i.querySelector("."+me).click(),void e.preventDefault()},e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),ki=function(){function e(e){this.parent=e}return e.prototype.updateSorting=function(e){if(!e.target.classList.contains(ue)&&!e.target.classList.contains(me)){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var i=e.target,r=void 0,a=void 0,n=void 0;i.id?(r=i.id,a=[].slice.call(i.querySelectorAll("."+he))):(r=i.parentElement.id,a=[].slice.call(i.parentElement.querySelectorAll("."+he))),n=0!==a.length;var o=this.getSortItemByName(r);if(t.isNullOrUndefined(o)){s={name:r,order:n?"Ascending":"Descending"};this.parent.dataSourceSettings.sortSettings.push(s)}else{for(var l=0;l<this.parent.dataSourceSettings.sortSettings.length;l++)if(this.parent.dataSourceSettings.sortSettings[l].name===r){this.parent.dataSourceSettings.sortSettings.splice(l,1);break}var s={name:r,order:n?"Ascending":"Descending"};this.parent.dataSourceSettings.sortSettings.push(s)}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1],n?t.removeClass([i],he):t.addClass([i],he)}},e.prototype.updateFiltering=function(e){var i=e.target,r=i.parentElement.id,a=i.parentElement.textContent,n=!1,o=[],l=[];if("olap"===this.parent.dataType)l=this.getOlapData(r,n);else{this.parent.engineModule.fieldList[r].dateMember="Ascending"===this.parent.engineModule.fieldList[r].sort?this.parent.engineModule.fieldList[r].dateMember.sort(function(e,t){return e.actualText>t.actualText?1:t.actualText>e.actualText?-1:0}):"Descending"===this.parent.engineModule.fieldList[r].sort?this.parent.engineModule.fieldList[r].dateMember.sort(function(e,t){return e.actualText<t.actualText?1:t.actualText<e.actualText?-1:0}):this.parent.engineModule.fieldList[r].dateMember;var s=this.getFilterItemByName(r);t.isNullOrUndefined(s)||(n="Include"===s.type,o=s.items?s.items:[]),l=this.getTreeData(n,this.parent.engineModule.fieldList[r].dateMember,o,r)}this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var d;d=d="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Wrapper"),this.parent.filterDialog.createFilterDialog(l,r,a,d)},e.prototype.getOlapData=function(e,i){var r=[],a=[];this.parent.filterDialog.isSearchEnabled=!1;var n=this.parent.engineModule,o=this.getFilterItemByName(e);0===n.fieldList[e].filterMembers.length?this.parent.control.loadMaximumMembers?n.getMembers(this.parent.dataSourceSettings,e,!0):o&&o.levelCount>1&&n.fieldList[e].levels.length>1?n.getFilterMembers(this.parent.dataSourceSettings,e,o.levelCount):(n.fieldList[e].levelCount=1,n.getMembers(this.parent.dataSourceSettings,e)):(n.fieldList[e].currrentMembers={},n.fieldList[e].searchMembers=[]);var l=n.fieldList[e].isHierarchy;r=n.fieldList[e].filterMembers,t.isNullOrUndefined(o)||(i=!o.type||"Include"===o.type,a=o.items?o.items:[]);for(var s={},d={},p=n.fieldList[e].members,h=0,u=a;h<u.length;h++){var c=u[h];s[c]=c,d[c]=c,p[c]&&(d=this.getParentNode(e,c,d))}return r=this.getFilteredTreeNodes(e,r,d,[],l),r=this.getOlapTreeData(i,g.getClonedData(r),s,e,l)},e.prototype.getSortItemByName=function(e){var t=this.parent.dataSourceSettings.sortSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFilterItemByName=function(e){var t=this.parent.dataSourceSettings.filterSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFieldByName=function(e,t){return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getFormatItemByName=function(e){var t=this.parent.dataSourceSettings.formatSettings;return new i.DataManager({json:t}).executeLocal((new i.Query).where("name","equal",e))[0]},e.prototype.getParentIDs=function(e,t,i){for(var r,a=0,n=e.fields.dataSource;a<n.length;a++){var o=n[a];if(o.id===t){r=o.pid;break}}return r&&(i.push(r),this.getParentIDs(e,r,i)),i},e.prototype.getChildIDs=function(e,t,i){for(var r,a=0,n=e.fields.dataSource;a<n.length;a++){var o=n[a];if(o.pid===t){r=o.id;break}}return r&&(i.push(r),this.getParentIDs(e,r,i)),i},e.prototype.searchTreeNodes=function(e,i,r,a){if(r){for(var n=[],o=[],l=0,s=[].slice.call(i.element.querySelectorAll("li"));l<s.length;l++){var d=s[l];d.querySelector(".e-list-text").textContent.toLowerCase().indexOf(e.value.toLowerCase())>-1?n.push(d):o.push(d)}if(i.enableNodes(n),t.removeClass(n,Z),i.disableNodes(o),t.addClass(o,Z),n.length>0&&o.length>0)for(var p=0,h=n;p<h.length;p++){var u=h[p].getAttribute("data-uid"),c=this.getParentIDs(i,u,[]),m=this.getChildIDs(i,u,[]),f=[];if(c.length>0)for(var v=0,y=o;v<y.length;v++){var S=y[v];-1!==g.inArray(S.getAttribute("data-uid"),c)&&f.push(S)}if(m.length>0)for(var b=0,C=o;b<C.length;b++){S=C[b];-1!==g.inArray(S.getAttribute("data-uid"),m)&&f.push(S)}i.enableNodes(f),t.removeClass(f,Z)}0===[].slice.call(i.element.querySelectorAll("li."+Z)).length?i.collapseAll():i.expandAll(void 0,void 0,!0)}else if(this.parent.searchTreeItems=[],"olap"!==this.parent.dataType||a){n=[];var x=0;x=1;for(var w=0,T=this.parent.currentTreeItems;w<T.length;w++){var M=T[w];M.name.toLowerCase().indexOf(e.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(M),x<=this.parent.control.maxNodeLimitInMemberEditor&&n.push(M),x++)}--x>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=x-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1),this.parent.isDataOverflow=x>this.parent.control.maxNodeLimitInMemberEditor,this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"inline-block":"none",i.fields={dataSource:n,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},i.dataBind()}else this.updateOlapSearchTree(e,i,a)},e.prototype.updateOlapSearchTree=function(e,t,i){var r=[],a=this.parent.filterDialog.dialogPopUp.element.getAttribute("data-fieldname");if(""===e.value.toLowerCase()){this.parent.filterDialog.isSearchEnabled=!1,this.parent.engineModule.fieldList[a].searchMembers=[];for(var n={},o={},l=this.parent.engineModule.fieldList[a].members,s=[],d=0,p=Object.keys(l);d<p.length;d++){l[c=p[d]].isSelected&&(l[c].parent&&l[l[c].parent].isSelected||s.push(c))}for(var h=0,u=s;h<u.length;h++){var c;n[c=u[h]]=c,o[c]=c,l[c]&&(o=this.getParentNode(a,c,o))}var m=this.parent.engineModule.fieldList[a].filterMembers;r=this.getFilteredTreeNodes(a,m,o,[],i),r=this.getOlapTreeData(!0,g.getClonedData(r),n,a,i,!0)}else{this.parent.filterDialog.isSearchEnabled=!0;m=this.parent.engineModule.fieldList[a].searchMembers;r=g.getClonedData(m),r=this.getOlapSearchTreeData(!0,r,a)}t.fields={dataSource:r,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},t.dataBind()},e.prototype.getTreeData=function(e,t,i,r){this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={},this.parent.savedTreeFilterPos={};var a=this.parent.engineModule;this.parent.isDateField=a.formatFields[r]&&["date","dateTime","time"].indexOf(a.formatFields[r].type)>-1;for(var n=[],o=1,l={},s=0,d=i;s<d.length;s++){var p=d[s];l[p]=p}for(var h=0,u=t;h<u.length;h++){var c=u[h],g=this.parent.isDateField?c.formattedText:c.actualText.toString(),m={id:c.actualText.toString(),name:g,isSelected:!e};void 0!==l[g]&&(m.isSelected=!!e),o<=this.parent.control.maxNodeLimitInMemberEditor&&n.push(m),m.isSelected||(this.parent.savedTreeFilterPos[o-1]=g),this.parent.currentTreeItems.push(m),this.parent.searchTreeItems.push(m),this.parent.currentTreeItemsPos[c.actualText]=o-1,o++}return this.parent.isDataOverflow=o-1>this.parent.control.maxNodeLimitInMemberEditor,n},e.prototype.getOlapTreeData=function(e,t,i,r,a,n){var o=this.parent.engineModule.fieldList[r];this.parent.currentTreeItems=[],this.parent.searchTreeItems=[],this.parent.currentTreeItemsPos={};for(var l=[],s=1,d=0,p=t;d<p.length;d++){var h=p[d],u=h,c=h.id.toString();n||(u.isSelected=!e),void 0!==i[c]&&(u.isSelected=!!e),!n&&h.hasChildren&&this.updateChildNodeStates(o.filterMembers,r,h.id,u.isSelected),o.members[c].isSelected=u.isSelected,o.currrentMembers&&o.currrentMembers[c]&&(o.currrentMembers[c].isSelected=u.isSelected),s<=this.parent.control.maxNodeLimitInMemberEditor&&a&&l.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]=s-1,s++}return this.parent.isDataOverflow=!!a&&s-1>this.parent.control.maxNodeLimitInMemberEditor,a?l:t},e.prototype.getOlapSearchTreeData=function(e,t,i){for(var r=this.parent.engineModule.fieldList[i].members,a=0,n=t;a<n.length;a++){var o=n[a],l=o.id.toString();r[l]&&(o.isSelected=r[l].isSelected),this.parent.searchTreeItems.push(o)}return t},e.prototype.updateChildNodeStates=function(e,t,i,r){for(var a=this.parent.engineModule.fieldList[t].members,n=this.parent.engineModule.fieldList[t].currrentMembers,o=0,l=e;o<l.length;o++){var s=l[o];s.pid&&s.pid.toString()===i&&(a[s.id].isSelected=r,n&&n[s.id]&&(n[s.id].isSelected=r),s.hasChildren&&this.updateChildNodeStates(e,t,s.id,r))}},e.prototype.getParentNode=function(e,t,i){var r=this.parent.engineModule.fieldList[e].members;if(r[t].parent&&t!==r[t].parent){var a=r[t].parent;i[a]=a,this.getParentNode(e,a,i)}return i},e.prototype.getFilteredTreeNodes=function(e,i,r,a,n){for(var o=[],l=this.parent.engineModule.fieldList[e].members,s=0,d=r?Object.keys(r):[];s<d.length;s++){var p=l[d[s]].parent;void 0!==p&&-1===g.inArray(p,o)&&o.push(p)}for(var h=0,u=i;h<u.length;h++){var c=u[h];t.isNullOrUndefined(c.pid)||-1!==g.inArray(c.pid,o)?(a.push(c),t.isNullOrUndefined(c.pid)&&-1!==g.inArray(c.id,o)?l[c.id].isNodeExpand=!0:t.isNullOrUndefined(c.pid)||-1===g.inArray(c.pid,o)?l[c.id].isNodeExpand=!1:(l[c.id].isNodeExpand=!1,l[c.pid].isNodeExpand=!0)):l[c.id].isNodeExpand=!1}return a},e}(),Hi=function(){function e(e){this.parent=e}return e.prototype.onStateModified=function(e,i){var r="",a=!0,n=t.closest(e.target,"."+De),o=-1;if(this.parent.dataSourceUpdate.btnElement=e.element?e.element.parentElement:void 0,n&&(r=n.classList[1]===Ee?"rows":n.classList[1]===Le?"columns":n.classList[1]===Oe?"values":n.classList[1]===Pe?"filters":""),"olap"===this.parent.dataType){var l=this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i;if(e.cancel&&""===r)return a=!1;if(this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===r||"values"===r)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&l.toLowerCase().indexOf("[measures].")>-1&&("filters"===r||"rows"===r||"columns"===r)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===l.toLowerCase().indexOf("[measures].")&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&("filters"===r||"values"===r)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&-1===l.toLowerCase().indexOf("[measures].")&&"values"===r){var s=this.parent.localeObj.getConstant("warning"),d=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(s,d),a=!1}}else if(e.cancel&&""===r||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===r||"values"===r||r.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return a=!1;if(""!==r){if("olap"===this.parent.dataType){if((l=this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i).toLowerCase().indexOf("[measures].")>-1&&("filters"===r||"rows"===r||"columns"===r)||this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&"filters"===r||-1===l.toLowerCase().indexOf("[measures].")&&"values"===r){s=this.parent.localeObj.getConstant("warning"),d=this.parent.localeObj.getConstant("fieldDropErrorAction");return this.parent.errorDialog.createErrorDialog(s,d),a=!1}}if("pivot"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&"CalculatedField"===this.parent.engineModule.fieldList[i].aggregateType&&"values"!==r){s=this.parent.localeObj.getConstant("warning"),d=this.parent.localeObj.getConstant("dropAction");return this.parent.errorDialog.createErrorDialog(s,d),a=!1}o=this.getButtonPosition(e.target,r)}else this.parent.engineModule.fieldList[i]&&(this.parent.engineModule.fieldList[i].isSelected=!1);return this.parent.dataSourceUpdate.updateDataSource(i,r,o),a},e.prototype.getButtonPosition=function(e,i){var r=-1,a=t.closest(e,"."+de);if(!t.isNullOrUndefined(a)){a=a.querySelector("."+pe);for(var n=this.parent.element.querySelector(".e-"+i),o=[].slice.call(n.querySelectorAll("."+pe)),l=0,s=o.length;l<s;l++)if(o[l].id===a.id){r=l;break}}return r},e}(),Vi=function(){function e(e){this.parent=e}return e.prototype.updateDataSource=function(e,t,i){var r;if(this.control&&this.btnElement&&"true"===this.btnElement.getAttribute("isvalue"))switch(t){case"":this.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":this.control.setProperties({dataSourceSettings:{valueAxis:"row"}},!0);break;case"columns":this.control.setProperties({dataSourceSettings:{valueAxis:"column"}},!0)}else"CalculatedField"===(r=(r=this.removeFieldFromReport(e.toString()))||this.getNewField(e.toString())).type&&""!==t&&(t="values");if("olap"===this.parent.dataType&&(r=(r=this.removeFieldFromReport(e.toString()))||this.getNewField(e.toString()),0===this.parent.dataSourceSettings.values.length&&this.removeFieldFromReport("[measures]"),"CalculatedField"===r.type&&""!==t&&(t="values")),this.control){var a={droppedField:r,dataSourceSettings:this.parent.dataSourceSettings,droppedAxis:t};this.control.trigger("onFieldDropped",a)}if(r)switch(t){case"filters":-1!==i?this.parent.dataSourceSettings.filters.splice(i,0,r):this.parent.dataSourceSettings.filters.push(r);break;case"rows":-1!==i?this.parent.dataSourceSettings.rows.splice(i,0,r):this.parent.dataSourceSettings.rows.push(r);break;case"columns":-1!==i?this.parent.dataSourceSettings.columns.splice(i,0,r):this.parent.dataSourceSettings.columns.push(r);break;case"values":if(-1!==i?this.parent.dataSourceSettings.values.splice(i,0,r):this.parent.dataSourceSettings.values.push(r),"olap"===this.parent.dataType&&!this.parent.engineModule.isMeasureAvail){var n={name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0};("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push(n)}}},e.prototype.removeFieldFromReport=function(e){for(var t,i=!1,r=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],a=this.parent.engineModule.fieldList[e],n=0,o=r.length;n<o;n++)if(!i&&r[n])for(var l=0,s=r[n].length;l<s;l++)if(r[n][l].name===e||"olap"===this.parent.dataType&&"[measures]"===r[n][l].name.toLowerCase()&&r[n][l].name.toLowerCase()===e){if(t=r[n][l].properties?r[n][l].properties:r[n][l],t.type=a&&"number"===a.type?t.type:"Count",r[n].splice(l,1),"olap"===this.parent.dataType){var d=this.parent.engineModule;d&&d.fieldList[e]&&(d.fieldList[e].currrentMembers={},d.fieldList[e].members={},d.fieldList[e].filterMembers=[],d.fieldList[e].searchMembers=[])}i=!0;break}return t},e.prototype.getNewField=function(e){var t;if("olap"===this.parent.dataType){t={name:e,caption:(i=this.parent.engineModule.fieldList[e]).caption,isNamedSet:i.isNamedSets,isCalculatedField:i.isCalculatedField,type:void 0===i.aggregateType?"number"===i.type?"Sum":"Count":i.aggregateType}}else{var i;t={name:e,caption:(i=this.parent.engineModule.fieldList[e]).caption,type:void 0===i.aggregateType?"number"===i.type?"Sum":"Count":i.aggregateType,showNoDataItems:i.showNoDataItems,baseField:i.baseField,baseItem:i.baseItem}}return t},e}(),_i=function(){function e(e){this.parent=e}return e.prototype.createErrorDialog=function(e,i){var a=t.createElement("div",{id:this.parent.parentID+"_ErrorDialog",className:Me});this.parent.element.appendChild(a),this.errorPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:e,content:i,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:1000001,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:we,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.errorPopUp.isStringTemplate=!0,this.errorPopUp.appendTo(a)},e.prototype.closeErrorDialog=function(){this.errorPopUp.close()},e.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&this.errorPopUp.destroy(),document.getElementById(this.parent.parentID+"_ErrorDialog")&&t.remove(document.getElementById(this.parent.parentID+"_ErrorDialog"))},e}(),Bi=function(){function e(e){this.parent=e}return e.prototype.createFilterDialog=function(e,i,a,n){var o=t.createElement("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":""),attrs:{"data-fieldName":i,"aria-label":a},styles:"visibility:hidden;"}),l=this.parent.engineModule.fieldList[i].caption,s=this.parent.localeObj.getConstant("filter")+' "'+a+'" '+this.parent.localeObj.getConstant("by");this.filterObject=this.getFilterObject(i),this.isSearchEnabled=!1,this.allowExcelLikeFilter=this.isExcelFilter(i),this.parent.element.appendChild(o),this.dialogPopUp=new r.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?s:l,content:this.allowExcelLikeFilter?"":this.createTreeView(e,a,i),isModal:"Popup"===this.parent.renderMode||!!this.parent.isAdaptive,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,width:"auto",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:we,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" "+Z),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:Te,content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:n,close:this.removeFilterDialog.bind(this),open:this.dialogOpen.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(o),this.allowExcelLikeFilter?(this.createTabMenu(e,a,i),t.addClass([this.dialogPopUp.element],"e-excel-filter"),this.updateCheckedState(a)):this.updateCheckedState(a),t.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"}),this.allowExcelLikeFilter&&this.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus()},e.prototype.dialogOpen=function(e){e.element.querySelector(".e-editor-label-wrapper")&&(e.element.querySelector(".e-editor-label-wrapper").style.width=e.element.offsetWidth+"px")},e.prototype.createTreeView=function(e,i,r){var a=this,l=t.createElement("div",{id:this.parent.parentID+"EditorDiv",className:ye+(this.allowExcelLikeFilter?" e-excelfilter":"")}),s=t.createElement("button",{id:this.parent.parentID+"_LevelDiv",className:"e-level-wrapper-class"}),d=t.createElement("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:at}),p=this.parent.engineModule.fieldList[r].caption,h=t.createElement("input",{attrs:{type:"text"}}),u=t.createElement("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1"},className:"e-editor-label-wrapper"});this.parent.editorLabelElement=t.createElement("label",{className:"e-editor-label"}),this.parent.editorLabelElement.innerText=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",u.style.display=this.parent.isDataOverflow?"inline-block":"none",u.appendChild(this.parent.editorLabelElement),d.appendChild(h),d.appendChild(s);var c=t.createElement("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-wrapper"}),g=t.createElement("div",{className:"e-select-all"}),m=t.createElement("div",{className:Se+"-outer-div"}),f=t.createElement("div",{className:Se}),v=t.createElement("div",{className:ft+" "+Z,innerHTML:this.parent.localeObj.getConstant("noMatches")});"olap"!==this.parent.dataType||this.parent.control.loadMaximumMembers||this.parent.engineModule.fieldList[r].isHierarchy||this.parent.engineModule.fieldList[r].isNamedSets?s.style.display="none":this.createLevelWrapper(s,r),c.appendChild(g),l.appendChild(d),l.appendChild(c),l.appendChild(v),this.editorSearch=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+' "'+p+'"',enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",showClearButton:!0,change:function(e){if("olap"===a.parent.dataType)a.searchOlapTreeView(e,v,i);else{a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1);var r=a.dialogPopUp.element;0===[].slice.call(a.memberTreeView.element.querySelectorAll("li")).length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector("."+we).setAttribute("disabled","disabled"),t.removeClass([v],Z)):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),r.querySelector("."+we).removeAttribute("disabled"),t.addClass([v],Z)),a.updateCheckedState(i)}}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(h);var y=[{id:"all",name:"All",isSelected:!0,htmlAttributes:{"data-fieldName":r}}];return this.allMemberSelect=new n.TreeView({fields:{dataSource:y,id:"id",text:"name",isChecked:"isSelected"},showCheckBox:!0,expandOn:"None",enableRtl:this.parent.enableRtl,nodeClicked:this.nodeCheck.bind(this,!0),keyPress:this.nodeCheck.bind(this,!0)}),this.allMemberSelect.isStringTemplate=!0,this.allMemberSelect.appendTo(g),m.appendChild(f),l.appendChild(m),this.memberTreeView=new n.TreeView({fields:{dataSource:e,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},showCheckBox:!0,enableRtl:this.parent.enableRtl,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this,!1),keyPress:this.nodeCheck.bind(this,!1),nodeExpanding:this.updateChildNodes.bind(this),expandOn:"None"}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(f),l.appendChild(u),l},e.prototype.createLevelWrapper=function(e,i){for(var r=this,a=this.parent.engineModule,n=a.fieldList[i].levels,o=a.fieldList[i].levelCount,l=[],s=0,d=n.length;s<d;s++)l.push({id:n[s].id,text:n[s].name});this.dropMenu=new u.DropDownButton({cssClass:"e-level-drop",items:l,iconCss:"e-icons e-dropdown-icon",disabled:o===n.length,beforeOpen:function(e){var a=[].slice.call(e.element.querySelectorAll("li")),n=r.parent.engineModule.fieldList[i].levelCount;t.removeClass(a,gt);for(var o=0,l=a.length;o<l;o++)o<n&&t.addClass([a[o]],gt)},select:function(e){for(var t,i=r.dialogPopUp.element.getAttribute("data-fieldname"),a=r.parent.engineModule,n=0,o=l.length;n<o;n++)l[n].id===e.item.id&&(t=n);a.getFilterMembers(r.parent.dataSourceSettings,i,t+1,!1,!0)}}),this.dropMenu.appendTo(e)},e.prototype.searchOlapTreeView=function(e,i,r){var a=this;clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){var n=a.parent.engineModule,o=a.dialogPopUp.element,l=o.getAttribute("data-fieldname"),s=a.parent.control.maxNodeLimitInMemberEditor?a.parent.control.maxNodeLimitInMemberEditor:5e3;if(n.fieldList[l].isHierarchy)a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!0);else{if(a.dropMenu&&""!==e.value?a.dropMenu.disabled=!0:a.dropMenu.disabled=!1,a.parent.control.loadMaximumMembers)n.getSearchMembers(a.parent.dataSourceSettings,l,e.value.toLowerCase(),s,!0);else{var d=n.fieldList[l].levelCount?n.fieldList[l].levelCount:1;n.getSearchMembers(a.parent.dataSourceSettings,l,e.value.toLowerCase(),s,!1,d)}a.parent.eventBase.searchTreeNodes(e,a.memberTreeView,!1,!1)}0===[].slice.call(a.memberTreeView.element.querySelectorAll("li")).length?(a.allMemberSelect.disableNodes([a.allMemberSelect.element.querySelector("li")]),o.querySelector("."+we).setAttribute("disabled","disabled"),t.removeClass([i],Z)):(a.allMemberSelect.enableNodes([a.allMemberSelect.element.querySelector("li")]),o.querySelector("."+we).removeAttribute("disabled"),t.addClass([i],Z)),a.updateCheckedState(r)},500)},e.prototype.nodeCheck=function(e,t){var i=[t.node];if(t.event.target.classList.contains("e-fullrow")||"Enter"===t.event.key){var r=e?this.allMemberSelect:this.memberTreeView;"true"===r.getNode(t.node).isChecked?r.uncheckAll(i):r.checkAll(i)}},e.prototype.updateChildNodes=function(e){if("olap"===this.parent.dataType){var i=this.parent.engineModule,r=e.node.getAttribute("data-fieldname"),a=i.fieldList[r],n=[];if(a&&a.filterMembers.length>0&&!this.isSearchEnabled&&!a.members[e.nodeData.id].isNodeExpand){for(var o=[],l=0,s=a.filterMembers;l<s.length;l++){var d=s[l];d.pid===e.nodeData.id.toString()&&o.push(d)}0===o.length&&(a.childMembers=[],i.getChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString(),r),o=a.childMembers,a.childMembers=[]);var p=g.getClonedData(o),h=this.memberTreeView.fields.dataSource,u=!1;t.isNullOrUndefined(this.filterObject)||(u="Include"===this.filterObject.type,n=this.filterObject.items?this.filterObject.items:[]);for(var c=0,m=p=this.updateChildData(u,p,n,r,e.nodeData);c<m.length;c++){var f=m[c];h.push(f)}a.members[e.nodeData.id].isNodeExpand=!0,this.memberTreeView.addNodes(p,e.node)}}},e.prototype.updateChildData=function(e,t,i,r,a){for(var n=Object.keys(this.parent.currentTreeItemsPos).length,o=this.parent.engineModule.fieldList[r],l=[],s=1,d=0,p=t;d<p.length;d++){var h=p[d],u=h,c=h.id.toString();o.members[c].isNodeExpand=!1,h.isSelected="true"===a.isChecked,s<=this.parent.control.maxNodeLimitInMemberEditor&&l.push(u),this.parent.currentTreeItems.push(u),this.parent.searchTreeItems.push(u),this.parent.currentTreeItemsPos[c]=n,n++,s++}return this.parent.isDataOverflow=!1,l},e.prototype.createTabMenu=function(e,i,r){var a=t.createElement("div",{className:"e-filter-tab-wrapper"});this.dialogPopUp.content=a,this.dialogPopUp.dataBind();for(var o=["Label","Value","Include","Exclude"],l="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",s=Object.keys(this.parent.engineModule.fieldList[r].members)[0],d=this.parent.engineModule.fieldList[r].type,p=this.parent.eventBase.getFormatItemByName(r),h=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&o.indexOf(this.filterObject.type)>1?Ge:""},content:this.createTreeView(e,i,r)}],u=0,c=o;u<c.length;u++){var g=c[u];if("Label"===g&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===g&&this.parent.dataSourceSettings.allowValueFilter){var m="Label"===g&&s.match(l)&&s.match(l)[0].length===s.length&&"number"===d?"Number":"Label"===g&&"Invalid Date"!==new Date(s).toString()&&(p&&p.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":g,f={header:{text:"Number"===m?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(m.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===m?Ge:""},content:this.createCustomFilter(r,this.filterObject&&this.filterObject.type===m?this.filterObject:void 0,m.toLowerCase())};h.push(f)}}var v=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;this.tabObj=new n.Tab({heightAdjustMode:"Auto",items:h,height:"100%",selectedItem:v,enableRtl:this.parent.enableRtl}),this.tabObj.isStringTemplate=!0,this.tabObj.appendTo(a),v>0&&t.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===v&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},e.prototype.createCustomFilter=function(e,i,r){for(var a=[],n=[],o=[],l=this.parent.dataSourceSettings.values,s="DoesNotEquals",d=0,p=0,h=["Between","NotBetween"],u="label"===r?["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]:"date"===r?["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"]:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],c=0,g=u;c<g.length;c++){var m=g[c];s=i&&m===i.condition?u.indexOf(i.condition)>=0?i.condition:u[0]:s,a.push({value:m,text:this.parent.localeObj.getConstant(m)})}for(var f=l.length;f--;)n.unshift({value:l[f].name,text:l[f].caption?l[f].caption:l[f].name}),d=i&&"Value"===i.type&&i.measure===l[f].name&&i.condition===s?f:d;if("olap"===this.parent.dataType){var v=this.parent.engineModule,y=v.fieldList[e].levels;if(this.parent.engineModule.fieldList[e].isHierarchy)o.push({value:e,text:v.fieldList[e].name}),p=0;else for(var S=0,b=y.length;S<b;S++)p=i&&i.selectedField===y[S].id?S:p,o.push({value:y[S].id,text:y[S].name})}var C=t.createElement("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(r)>=0?"label":r)+"-filter",id:this.parent.parentID+"_"+r+"_filter_div_content",attrs:{"data-type":r,"data-fieldName":e,"data-operator":s,"data-selectedField":"olap"===this.parent.dataType&&o.length>0?o[p].value.toString():"","data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[d].name:"","data-value1":i&&s===i.condition&&i.value1?i.value1.toString():"","data-value2":i&&s===i.condition&&i.value2?i.value2.toString():""}}),x=t.createElement("div",{className:"e-filter-text-div",innerHTML:this.parent.localeObj.getConstant(r+"TextContent")}),w=t.createElement("div",{className:ze+" "+(-1===h.indexOf(s)?Z:""),innerHTML:this.parent.localeObj.getConstant("And")}),T=t.createElement("div",{className:"e-separator-div"}),M=t.createElement("div",{className:"e-filter-option-wrapper-1"}),D=t.createElement("div",{className:"e-level-option-wrapper "+("olap"===this.parent.dataType?"":Z)}),E=t.createElement("div",{className:"e-measure-option-wrapper "+(["label","date","number"].indexOf(r)>=0?Z:"")}),L=t.createElement("div",{className:"e-condition-option-wrapper"}),O=t.createElement("div",{className:"e-filter-option-wrapper-2"}),P=t.createElement("div",{id:this.parent.parentID+"_"+r+"_level_option_wrapper"}),N=t.createElement("div",{id:this.parent.parentID+"_"+r+"_measure_option_wrapper"}),I=t.createElement("div",{id:this.parent.parentID+"_"+r+"_contition_option_wrapper"}),A=t.createElement("div",{className:"e-filter-input-div-1"}),F=t.createElement("div",{className:We+" "+(-1===h.indexOf(s)?Z:"")}),q=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_1",attrs:{type:"text"}}),R=t.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_2",attrs:{type:"text"}});return A.appendChild(q),F.appendChild(R),D.appendChild(P),D.appendChild(T.cloneNode(!0)),E.appendChild(N),E.appendChild(T),L.appendChild(I),M.appendChild(D),M.appendChild(E),M.appendChild(L),O.appendChild(A),O.appendChild(w),O.appendChild(F),this.createElements(i,h,N,I,q,R,n,a,d,s,r,P,o,p),C.appendChild(x),C.appendChild(M),C.appendChild(O),C},e.prototype.createElements=function(e,i,r,n,s,d,p,u,c,g,m,f,v,y){var S=this;if("olap"===this.parent.dataType){var b=new l.DropDownList({dataSource:v,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:y,cssClass:"e-level-options",width:"100%",change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab"),r=i.getAttribute("data-fieldName"),n=i.getAttribute("data-type");if(!t.isNullOrUndefined(i)){S.updateInputValues(i,n,s,d),a.setStyleAndAttributes(i,{"data-selectedField":e.value});for(var o,l=0,h=S.parent.dataSourceSettings.filterSettings;l<h.length;l++){var u=h[l];if(u.name===r&&u.selectedField===e.value){o=u;break}}if(o){"value"===n&&o.measure&&""!==o.measure&&(C.value=o.measure?o.measure:p[0].value),o.condition?x.value=o.condition?o.condition:"DoesNotEquals":x.value="DoesNotEquals";var c=void 0,g=void 0;"value"===n?(c=s.ej2_instances[0],g=d.ej2_instances[0],c&&(c.value=o.value1?parseInt(o.value1,10):void 0),g&&(g.value=o.value2?parseInt(o.value2,10):void 0)):(c=s.ej2_instances[0],g=d.ej2_instances[0],c&&(c.value=o.value1?o.value1:""),g&&(g.value=o.value2?o.value2:""))}S.updateInputValues(i,n,s,d)}}});b.isStringTemplate=!0,b.appendTo(f)}var C=new l.DropDownList({dataSource:p,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:c,cssClass:Qe,width:"100%",change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||(S.updateInputValues(i,m,s,d),a.setStyleAndAttributes(i,{"data-measure":e.value}))}});C.isStringTemplate=!0,C.appendTo(r);var x=new l.DropDownList({dataSource:u,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:g,cssClass:Ye,width:"100%",change:function(e){var r=S.dialogPopUp.element.querySelector(".e-selected-tab");if(!t.isNullOrUndefined(r)){S.updateInputValues(r,m,s,d);for(var n=0,o=[ze,We];n<o.length;n++){var l=o[n];i.indexOf(e.value)>=0?t.removeClass([r.querySelector("."+l)],Z):t.addClass([r.querySelector("."+l)],Z)}a.setStyleAndAttributes(r,{"data-operator":e.value})}}});if(x.isStringTemplate=!0,x.appendTo(n),"date"===m){var w=new h.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&g===e.condition?"string"==typeof e.value1?new Date(e.value1):e.value1:null,change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||a.setStyleAndAttributes(i,{"data-value1":e.value,"data-value2":T.value})},width:"100%"}),T=new h.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:e&&g===e.condition?"string"==typeof e.value2?new Date(e.value2):e.value2:null,change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||a.setStyleAndAttributes(i,{"data-value1":w.value,"data-value2":e.value})},width:"100%"});w.isStringTemplate=!0,w.appendTo(s),T.isStringTemplate=!0,T.appendTo(d)}else if("value"===m){var M=new o.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&g===e.condition?parseInt(e.value1,10):void 0,change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||a.setStyleAndAttributes(i,{"data-value1":e.value?e.value.toString():"0","data-value2":D.value?D.value.toString():"0"})},width:"100%"}),D=new o.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:e&&g===e.condition?parseInt(e.value2,10):void 0,change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||a.setStyleAndAttributes(i,{"data-value1":M.value?M.value.toString():"0","data-value2":e.value?e.value.toString():"0"})},width:"100%"});M.isStringTemplate=!0,M.appendTo(s),D.isStringTemplate=!0,D.appendTo(d)}else{var E=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&g===e.condition?e.value1:"",change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||a.setStyleAndAttributes(i,{"data-value1":e.value,"data-value2":L.value})},width:"100%"}),L=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:e&&g===e.condition?e.value2:"",change:function(e){var i=S.dialogPopUp.element.querySelector(".e-selected-tab");t.isNullOrUndefined(i)||a.setStyleAndAttributes(i,{"data-value1":E.value,"data-value2":e.value})},width:"100%"});E.isStringTemplate=!0,E.appendTo(s),L.isStringTemplate=!0,L.appendTo(d)}},e.prototype.updateInputValues=function(e,i,r,n){var o,l;if("date"===i){var s=r.ej2_instances[0],d=n.ej2_instances[0];o=t.isNullOrUndefined(s.value)?"":s.value.toString(),l=t.isNullOrUndefined(d.value)?"":d.value.toString()}else{s=r.ej2_instances[0],d=n.ej2_instances[0];o=s.value,l=d.value}a.setStyleAndAttributes(e,{"data-value1":o,"data-value2":l})},e.prototype.validateTreeNode=function(e){e.node.classList.contains(Z)&&(e.cancel=!0)},e.prototype.updateCheckedState=function(e){var i=this.dialogPopUp.element;a.setStyleAndAttributes(i,{role:"menu","aria-haspopup":"true"});var r=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),n=i.getAttribute("data-fieldname"),o=this.getUnCheckedNodes(n),l=this.getCheckedNodes(n),s=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");r.length>0?l>0?(o>0?(t.removeClass([s],"e-check"),t.addClass([s],"e-stop")):0===o&&(t.removeClass([s],"e-stop"),t.addClass([s],"e-check")),this.dialogPopUp.buttons[0].buttonModel.disabled=!1,i.querySelector("."+we).removeAttribute("disabled")):o>0&&0===l&&(t.removeClass([s],["e-check","e-stop"]),this.getCheckedNodes(n)===l&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,i.querySelector("."+we).setAttribute("disabled","disabled"))):(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,i.querySelector("."+we).setAttribute("disabled","disabled"))},e.prototype.getCheckedNodes=function(e){var t=this.parent.engineModule,i=[];if("olap"===this.parent.dataType&&t&&!t.fieldList[e].isHierarchy)return this.memberTreeView.getAllCheckedNodes().length;for(var r=0,a=this.parent.searchTreeItems;r<a.length;r++){var n=a[r];n.isSelected&&i.push(n)}return i.length},e.prototype.getUnCheckedNodes=function(e){var t=[],i=[],r=this.parent.engineModule;if("olap"===this.parent.dataType&&r&&!r.fieldList[e].isHierarchy)return i=this.memberTreeView.getAllCheckedNodes(),this.memberTreeView.fields.dataSource.length-i.length;for(var a=0,n=this.parent.searchTreeItems;a<n.length;a++){var o=n[a];o.isSelected||t.push(o)}return t.length},e.prototype.isExcelFilter=function(e){for(var t=!1,i=0,r=this.parent.dataSourceSettings.filters;i<r.length;i++){if(r[i].name===e){t=!0;break}}return!(t||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)},e.prototype.getFilterObject=function(e){var t=this.parent.eventBase.getFilterItemByName(e);if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0))return t},e.prototype.closeFilterDialog=function(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy(),this.dropMenu&&!this.dropMenu.isDestroyed&&this.dropMenu.destroy(),document.getElementById(this.parent.parentID+"_LevelDiv-popup")&&t.remove(document.getElementById(this.parent.parentID+"_LevelDiv-popup")),this.dialogPopUp.close()},e.prototype.removeFilterDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&this.dialogPopUp.destroy(),document.getElementById(this.parent.parentID+"_EditorTreeView")&&t.remove(document.getElementById(this.parent.parentID+"_EditorTreeView"))},e}(),Ui=function(){function e(e){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=e.element,this.moduleName=e.moduleName,this.dataSourceSettings=e.dataSourceSettings,this.engineModule=e.pivotEngine,this.enableRtl=e.enableRtl,this.isAdaptive=e.isAdaptive,this.renderMode=e.renderMode,this.parentID=e.id,this.localeObj=e.localeObj,this.dataType=e.dataType,this.nodeStateModified=new Hi(this),this.dataSourceUpdate=new Vi(this),this.eventBase=new ki(this),this.filterDialog=new Bi(this),this.errorDialog=new _i(this),this.keyboardModule=new ji(this),this}return e.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},e}(),Gi=function(){function e(e){this.parent=e}return e.prototype.render=function(){var e=t.createElement("div",{id:this.parent.element.id+"_Wrapper",className:$+" "+("olap"===this.parent.dataType?"e-olapfieldlist-wrapper":""),styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?t.addClass([e],X):t.removeClass([e],X),this.parent.enableRtl?t.addClass([e],Y):t.removeClass([e],Y),this.parent.cssClass&&t.addClass([e],this.parent.cssClass),this.parentElement=t.createElement("div",{className:"e-field-list-container"}),this.parent.element.appendChild(e),this.parent.isAdaptive&&(e.removeAttribute("style"),this.parentElement=t.createElement("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(e)),"Popup"===this.parent.renderMode?(this.renderFieldListDialog(e),this.unWireDialogEvent(this.parent.element.querySelector("."+ee)),this.wireDialogEvent(this.parent.element.querySelector("."+ee))):this.renderStaticLayout(e)},e.prototype.renderStaticLayout=function(e){if(!this.parent.isAdaptive){var i=t.createElement("div",{className:"e-field-list-title"}),r=t.createElement("div",{className:"e-title-content",innerHTML:this.parent.localeObj.getConstant("staticFieldList")});i.appendChild(r),i.appendChild(this.createCalculatedButton()),t.addClass([e],"e-static"),e.appendChild(i),e.appendChild(this.parentElement),t.addClass([e],"e-static"),this.parent.allowDeferLayoutUpdate&&(e.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons())}},e.prototype.renderDeferUpdateButtons=function(){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new c.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:!0,enableRtl:this.parent.enableRtl,change:this.onCheckChange.bind(this)}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo("#"+this.parent.element.id+"DeferUpdateCheckBox"),this.deferUpdateApplyButton=new c.Button({cssClass:"e-defer-apply-button e-defer-update-btn"+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,isPrimary:!0}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton1"),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this)),this.deferUpdateCancelButton=new c.Button({cssClass:"e-defer-cancel-button "+Te+("Popup"===this.parent.renderMode?" e-flat":""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.isStringTemplate=!0,this.deferUpdateCancelButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton2"),this.deferUpdateCancelButton.element.onclick="Fixed"===this.parent.renderMode?this.cancelButtonClick.bind(this):this.onCloseFieldList.bind(this)},e.prototype.createDeferUpdateButtons=function(){var e=t.createElement("div",{className:"e-layout-footer"});if(this.parent.allowDeferLayoutUpdate){var i=t.createElement("div",{className:"e-checkbox-layout"}),r=t.createElement("input",{id:this.parent.element.id+"DeferUpdateCheckBox"});i.appendChild(r),e.appendChild(i)}var a=t.createElement("div",{className:"e-button-layout"});if(this.parent.allowDeferLayoutUpdate){var n=t.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton1"});a.appendChild(n)}var o=t.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton2"});return a.appendChild(o),e.appendChild(a),e},e.prototype.onCheckChange=function(e){e.checked&&(this.parent.clonedDataSource=t.extend({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)),this.parent.allowDeferLayoutUpdate=!this.parent.allowDeferLayoutUpdate,"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate})):this.parent.allowDeferLayoutUpdate?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0),this.cancelButtonClick()},e.prototype.applyButtonClick=function(){this.parent.updateDataSource(!1);var e=this.parent;e.axisFieldModule.render(),e.clonedDataSource=t.extend({},e.dataSourceSettings,null,!0),e.clonedFieldList=t.extend({},e.pivotFieldList,null,!0)},e.prototype.cancelButtonClick=function(){this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),this.parent.engineModule.fieldList=t.extend({},this.parent.clonedFieldList,null,!0),this.parent.updateDataSource(!1,!0)},e.prototype.renderFieldListDialog=function(e){var i=t.createElement("div",{className:ee+" "+K+" e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList")}});if(this.parent.element.appendChild(i),this.parent.isAdaptive){var a='<div class=e-title-mobile-header><span class="e-icons '+Pt+'"></span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"</div></div>",n=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:He+" e-small e-round",iconCss:K+" "+_e,isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:Ve+" e-small e-round "+Z,iconCss:K+" "+_e,enableRtl:this.parent.enableRtl,isPrimary:!0}}];this.fieldListDialog=new r.Dialog({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:a,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:n,target:document.body,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),t.setStyleAttribute(e.querySelector("#"+e.id+"_dialog-content"),{padding:"0"});var o=e.querySelector(".e-footer-content");t.addClass([o],re),t.removeClass([o.querySelector("."+Ve)],"e-flat"),t.removeClass([o.querySelector("."+He)],"e-flat"),this.fieldListDialog.element.querySelector("."+Pt).onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)}else{var l=this.createDeferUpdateButtons().outerHTML;a="<div class=e-title-header><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"</div></div>";this.fieldListDialog=new r.Dialog({animationSettings:{effect:"Zoom"},header:a,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:l,closeOnEscape:!0,target:t.isNullOrUndefined(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(e),this.renderDeferUpdateButtons(),t.setStyleAttribute(e.querySelector("#"+e.id+"_title"),{width:"100%"}),e.querySelector(".e-title-header").appendChild(this.createCalculatedButton())}},e.prototype.updateDataSource=function(e){for(var t=["filters","columns","rows","values"],i=0,r=e;i<r.length;i++){var a=r[i],n=t[this.adaptiveElement.selectedItem];this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(a,n,-1)}this.parent.axisFieldModule.render(),this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},e.prototype.onDeferUpdateClick=function(){this.parent.updateDataSource(),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.renderAdaptiveLayout=function(e){var i=t.createElement("div",{className:re});e.appendChild(this.parentElement);var r=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||r.pop(),this.adaptiveElement=new n.Tab({heightAdjustMode:"Auto",items:r,height:"100%",enableRtl:this.parent.enableRtl,selected:this.tabSelect.bind(this)}),"Fixed"===this.parent.renderMode?(i.appendChild(this.createAddButton()),t.addClass([e],"e-static"),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(i)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))},e.prototype.tabSelect=function(e){var i=t.closest(this.parentElement,"."+$);i&&i.querySelector("."+He)&&(4!==e.selectedIndex?(t.addClass([i.querySelector("."+Ve)],Z),t.removeClass([i.querySelector("."+He)],Z)):(t.removeClass([i.querySelector("."+Ve)],Z),t.addClass([i.querySelector("."+He)],Z))),4===e.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify(G,{})):this.parent.axisFieldModule.render()},e.prototype.createCalculatedButton=function(){var e=t.createElement("div",{id:this.parent.element.id+"_CalculatedField",attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("calculatedField")}}),i=new c.Button({cssClass:"e-calculated-field "+Z,content:this.parent.localeObj.getConstant("calculatedField"),enableRtl:this.parent.enableRtl});return i.isStringTemplate=!0,i.appendTo(e),this.parent.calculatedFieldModule&&t.removeClass([e],Z),i.element.onclick=this.showCalculatedField.bind(this),e},e.prototype.createAddButton=function(){var e=t.createElement("div",{className:re+"-content"}),i=t.createElement("div",{}),r=t.createElement("div",{}),a=new c.Button({cssClass:Ve+" e-small e-round "+Z,iconCss:K+" "+_e,enableRtl:this.parent.enableRtl}),n=new c.Button({cssClass:He+" e-small e-round",iconCss:K+" "+_e,enableRtl:this.parent.enableRtl});return n.isStringTemplate=!0,n.appendTo(i),a.isStringTemplate=!0,a.appendTo(r),e.appendChild(i),e.appendChild(r),a.element.onclick=this.showCalculatedField.bind(this),n.element.onclick=this.showFieldListDialog.bind(this),e},e.prototype.createAxisTable=function(e){var i=t.createElement("div",{className:te+"-"+e}),r=t.createElement("div",{className:le+" e-"+e}),a=t.createElement("span",{className:se,innerHTML:this.parent.localeObj.getConstant("addPrompt")});return i.appendChild(r),i.appendChild(a),i},e.prototype.showCalculatedField=function(e){this.parent.isAdaptive||this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),t.addClass([this.parent.element.querySelector("."+ee)],"e-hide")),this.parent.notify(G,{})},e.prototype.showFieldListDialog=function(e){var t=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(t)},e.prototype.onShowFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=t.extend({},this.parent.dataSourceSettings,null,!0),this.parent.clonedFieldList=t.extend({},this.parent.pivotFieldList,null,!0)),t.addClass([this.parent.element.querySelector("."+ee)],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show(),this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top},e.prototype.onCloseFieldList=function(){this.parent.allowDeferLayoutUpdate&&(this.parent.dataSourceSettings=t.extend({},this.parent.clonedDataSource.properties,null,!0),this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),Object.keys(this.parent.clonedFieldList).length>0&&("olap"===this.parent.dataType?this.parent.olapEngineModule.fieldList=t.extend({},this.parent.clonedFieldList,null,!0):this.parent.engineModule.fieldList=t.extend({},this.parent.clonedFieldList,null,!0)),this.parent.pivotGridModule.notify(k,this),this.parent.pivotGridModule.notify(H,this)),this.parent.dialogRenderer.fieldListDialog.hide()},e.prototype.removeFieldListIcon=function(){document.getElementById(this.parent.element.id+"calculateddialog")||t.removeClass([this.parent.element.querySelector("."+ee)],"e-hide")},e.prototype.keyPress=function(e){e.target;if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireDialogEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.onShowFieldList,this)},e.prototype.unWireDialogEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.onShowFieldList)},e}(),zi=function(){function e(e){this.selectedNodes=[],this.parent=e,this.addEventListener()}return e.prototype.render=function(e){if(this.parentElement=this.parent.dialogRenderer.parentElement,this.fieldListSort="None",this.parent.isAdaptive)this.renderTreeDialog(e);else{var i=t.createElement("div",{className:"e-field-table "+("olap"===this.parent.dataType?"e-olap-field-table":"")}),r=t.createElement("div",{className:"e-field-header",innerHTML:this.parent.localeObj.getConstant("allFields")}),a=t.createElement("div",{className:ie+"-outer-div"});this.treeViewElement=t.createElement("div",{id:this.parent.element.id+"_TreeView",className:te+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});var n=t.createElement("div",{className:"e-field-header-wrapper"});if(n.appendChild(r),i.appendChild(n),this.updateSortElements(n),a.appendChild(this.treeViewElement),i.appendChild(a),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode){var o=t.createElement("div",{className:"e-center-div"}),l=t.createElement("div",{className:"e-center-title",innerHTML:this.parent.localeObj.getConstant("centerHeader")});this.parentElement.appendChild(o),this.parentElement.appendChild(l)}this.renderTreeView()}},e.prototype.updateSortElements=function(e){for(var i=0,r=["None","Ascend","Descend"];i<r.length;i++){var a=r[i],n=t.createElement("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":"Sort "+a,"data-sort":a},className:K+" e-sort-"+a.toLowerCase()+" "+(this.fieldListSort===a?"e-selected":"")});e.appendChild(n),this.unWireFieldListEvent(n),this.wireFieldListEvent(n)}},e.prototype.renderTreeView=function(){this.fieldTable=new n.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},nodeChecked:this.nodeStateChange.bind(this),cssClass:ie,showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"None",autoCheck:!1,loadOnDemand:!1,enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this)}),this.treeViewElement.innerHTML="",this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(this.treeViewElement)},e.prototype.updateNodeIcon=function(e){if("olap"===this.parent.dataType)if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var i=e.node.querySelector(".e-list-icon");t.removeClass([i],"e-folderCDB-icon"),t.addClass([i],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){i=e.node.querySelector(".e-list-icon");t.removeClass([i],"e-folderCDB-open-icon"),t.addClass([i],"e-folderCDB-icon")}},e.prototype.updateTreeNode=function(e){var i=!1;i="olap"!==this.parent.dataType||this.updateOlapTreeNode(e);var r=e.node.querySelector("."+ke);if(e.node.querySelector(".e-list-icon")&&r){var a=e.node.querySelector(".e-list-icon");r.insertBefore(a,e.node.querySelector(".e-list-text"))}if(i&&!this.parent.isAdaptive){i=!1;var n=t.createElement("span",{attrs:{tabindex:"-1",title:this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},styles:"visibility:visible;",className:K+" e-drag"});e.node.querySelector(".e-checkbox-wrapper")&&!e.node.querySelector(".cls.DRAG_CLASS")&&r&&r.insertBefore(n,e.node.querySelector(".e-checkbox-wrapper"))}e.node.querySelector(".e-check")&&t.addClass([e.node.querySelector("."+Be)],Ue)},e.prototype.updateOlapTreeNode=function(e){var t=!1;return"olap"===this.parent.dataType?(e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon,.e-folderCDB-open-icon,.e-dimensionCDB-icon,.e-kpiCDB-icon")&&(e.node.querySelector(".e-checkbox-wrapper").style.display="none"),e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-list-icon").className.indexOf("e-level-members")>-1&&(this.parent.isAdaptive?e.node.querySelector(".e-checkbox-wrapper").style.display="none":e.node.querySelector(".e-checkbox-wrapper").style.visibility="hidden"),e.node&&(e.node.querySelector(".e-hierarchyCDB-icon,.e-attributeCDB-icon,.e-namedSetCDB-icon")||e.node.querySelector(".e-measure-icon,.e-kpiGoal-icon,.e-kpiStatus-icon,.e-kpiTrend-icon,.e-kpiValue-icon")||e.node.querySelector(".e-calc-measure-icon,.e-calc-dimension-icon"))&&(e.node.querySelector(".e-measure-icon")?(e.node.querySelector(".e-list-icon").style.display="none",t=!0):t=!0)):t=!0,t},e.prototype.renderTreeDialog=function(e){var i=t.createElement("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")});this.parentElement.appendChild(i),this.fieldDialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(e)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,width:"auto",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:Te,content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:we,content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!0,target:this.parentElement.parentElement,close:this.dialogClose.bind(this)}),this.fieldDialog.isStringTemplate=!0,this.fieldDialog.appendTo(i)},e.prototype.dialogClose=function(){document.getElementById(this.parent.element.id+"_FieldListTreeView")&&t.remove(document.getElementById(this.parent.element.id+"_FieldListTreeView"))},e.prototype.createTreeView=function(e){var i=t.createElement("div",{id:this.parent.element.id+"EditorDiv",className:ye}),r=t.createElement("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:at}),a=t.createElement("input",{attrs:{type:"text"}});r.appendChild(a);var l=t.createElement("div",{className:Se+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")});i.appendChild(r),this.editorSearch=new o.MaskedTextBox({showClearButton:!0,placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,cssClass:"e-editor-search",change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(a);var s=t.createElement("div",{className:ft+" "+Z,innerHTML:this.parent.localeObj.getConstant("noMatches")});return i.appendChild(s),i.appendChild(l),this.fieldTable=new n.TreeView({fields:{dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,loadOnDemand:!1,sortOrder:"olap"===this.parent.dataType?"None":"Ascending",enableRtl:this.parent.enableRtl,nodeChecked:this.addNode.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this)}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(l),i},e.prototype.textChange=function(e){this.parent.pivotCommon.eventBase.searchTreeNodes(e,this.fieldTable,!0);var i=this.fieldDialog.element.querySelector("."+ft),r=[].slice.call(this.fieldTable.element.querySelectorAll("li")),a=[].slice.call(this.fieldTable.element.querySelectorAll("li."+Z));r.length===a.length?t.removeClass([i],Z):t.addClass([i],Z)},e.prototype.dragStart=function(e){if(e.event.target.classList.contains("e-drag")){this.parent.isDragging=!0,t.addClass([e.draggedNode.querySelector("."+Be)],je);var i=void 0;i="olap"===this.parent.dataType?this.parent.olapEngineModule.fieldList[e.draggedNode.getAttribute("data-uid")]:this.parent.engineModule.fieldList[e.draggedNode.getAttribute("data-uid")];var r=[Ee,Le,Pe];if(i&&"CalculatedField"===i.aggregateType)for(var a=0,n=r;a<n.length;a++){var o=n[a];t.addClass([this.parentElement.querySelector("."+o)],Re)}}else e.cancel=!0},e.prototype.dragStop=function(e){e.cancel=!0,this.parent.isDragging=!1;for(var i=0,r=[Ee,Le,Pe];i<r.length;i++){var a=r[i];t.removeClass([this.parentElement.querySelector("."+a)],Re)}t.removeClass([e.draggedNode.querySelector("."+Be)],je),this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var n=e.draggedNodeData.id.toString();if(this.isNodeDropped(e,n)){var o=this.parent.pivotFieldList[n];if(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,n)){this.parent.allowDeferLayoutUpdate?(o.isSelected=!0,this.updateDataSource()):this.parent.updateDataSource();this.parent.axisFieldModule.render()}}},e.prototype.isNodeDropped=function(e,i){var r=!0;if("true"===e.draggedNodeData.isChecked){var a=this.getButton(i),n=t.closest(a,"."+De),o=t.closest(e.target,"."+De);if(a&&n===o){for(var l=[].slice.call(n.querySelectorAll("."+pe)),s=t.closest(e.target,"."+de),d=void 0,p=-1,h=0,u=l.length;h<u;h++)if(l[h].id===a.id&&(d=h),s){var c=s.querySelector("."+pe);l[h].id===c.id&&(p=h)}if(d===p||d===l.length-1&&-1===p){var g=document.getElementById(this.parent.element.id+"_Wrapper");t.removeClass([].slice.call(g.querySelectorAll("."+fe)),ve),r=!1}}}return r},e.prototype.getButton=function(e){for(var t,i=document.getElementById(this.parent.element.id+"_Wrapper"),r=[].slice.call(i.querySelectorAll("."+pe)),a=0,n=r.length;a<n;a++)if(r[a].id===e){t=r[a];break}return t},e.prototype.nodeStateChange=function(e){var i=t.closest(e.node,"."+ke);if(!t.isNullOrUndefined(i)){var r=t.closest(i,"li"),a=r.getAttribute("data-uid");this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var n=this.parent.pivotFieldList[a];if("check"===e.action){t.addClass([i.querySelector("."+Be)],Ue),this.updateSelectedNodes(r,e.action);var o=this.parent.pivotCommon.dataSourceUpdate.getNewField(a);if("number"===n.type||"CalculatedField"===n.type&&n.formula&&n.formula.indexOf("Measure")>-1&&"olap"===this.parent.dataType){if(this.parent.dataSourceSettings.values.push(o),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.isMeasureAvail){var l={name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0};("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push(l)}}else this.parent.dataSourceSettings.rows.push(o)}else t.removeClass([i.querySelector("."+Be)],Ue),this.updateSelectedNodes(r,e.action),this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(a),"olap"===this.parent.dataType&&0===this.parent.dataSourceSettings.values.length&&this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]");this.parent.allowDeferLayoutUpdate?("check"===e.action?n.isSelected=!0:n.isSelected=!1,this.updateDataSource()):this.parent.updateDataSource(!0);var s=this.parent;setTimeout(function(){s.axisFieldModule.render()})}},e.prototype.updateSelectedNodes=function(e,i){if(e&&e.querySelector("ul"))for(var r=0,a=[].slice.call(e.querySelectorAll("li"));r<a.length;r++){var n=a[r];"check"===i?t.addClass([n.querySelector("."+Be)],Ue):t.removeClass([n.querySelector("."+Be)],Ue)}},e.prototype.updateDataSource=function(){"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(k,this)):this.parent.triggerPopulateEvent()},e.prototype.addNode=function(e){var t=this.parent.pivotFieldList[e.data[0].id.toString()];if("check"===e.action)this.selectedNodes.push(t.id.toString());else for(var i=this.selectedNodes.length;i--;)if(this.selectedNodes[i]===t.id.toString()){this.selectedNodes.splice(i,1);break}},e.prototype.refreshTreeView=function(){if(this.fieldTable){var e=this.getUpdatedData();this.fieldTable.fields={dataSource:e,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},this.fieldTable.dataBind()}},e.prototype.getUpdatedData=function(){var e=this.getTreeData(),t=this.fieldTable.expandedNodes;return this.updateExpandedNodes(e,t),this.applySorting(e,this.fieldListSort)},e.prototype.getTreeData=function(e){var t=[];if("olap"===this.parent.dataType)t=this.getOlapTreeData(e);else{for(var i=Object.keys(this.parent.pivotFieldList),r={},a=0,n=i;a<n.length;a++){var o=n[a],l=this.parent.pivotFieldList[o];r[o]={id:l.id,caption:l.caption,isSelected:l.isSelected}}if(this.parent.isAdaptive){for(var s=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],d=i.length;d--;)r[i[d]].isSelected=!1;for(var p=0,h=s;p<h.length;p++){r[h[p].name].isSelected=!0}}for(var u=r,c=0,g=i;c<g.length;c++){var m=u[l=g[c]];t.push(m)}}return t},e.prototype.getOlapTreeData=function(e){var t=[],i=this.parent.olapEngineModule.fieldListData;if(this.parent.isAdaptive)for(var r=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][e],a=0;a<i.length;){var n=i[a],o=void 0;if(3===e){if("[measures]"!==n.id.toLowerCase()&&(0===n.id.toLowerCase().indexOf("[measures]")||n.spriteCssClass&&-1!==n.spriteCssClass.indexOf("e-measureCDB"))){(o={id:n.id,caption:n.caption,hasChildren:n.hasChildren,type:n.type,aggregateType:n.aggregateType,isSelected:n.isSelected,pid:n.pid,spriteCssClass:n.spriteCssClass}).isSelected=!1,o.spriteCssClass&&-1!==o.spriteCssClass.indexOf("e-measureCDB")&&(o.spriteCssClass=o.spriteCssClass.replace("e-folderCDB-icon","e-measureGroupCDB-icon"),o.pid=void 0);for(var l=0,s=r;l<s.length;l++){var d=s[l];if(o.id===d.name){o.isSelected=!0;break}}t.push(o)}}else if(0!==n.id.toLowerCase().indexOf("[measures]")&&(!n.spriteCssClass||-1===n.spriteCssClass.indexOf("e-measureCDB"))){(o={id:n.id,caption:n.caption,hasChildren:n.hasChildren,type:n.type,aggregateType:n.aggregateType,isSelected:n.isSelected,pid:n.pid,spriteCssClass:n.spriteCssClass}).isSelected=!1;for(var p=0,h=r;p<h.length;p++){var u=h[p];if(o.id===u.name){o.isSelected=!0;break}}t.push(o)}a++}else t=g.getClonedData(this.parent.olapEngineModule.fieldListData);return t},e.prototype.updateExpandedNodes=function(e,t){if(t.length>0)for(var i=0,r=0,a=e;r<a.length;r++){var n=a[r];if(t.indexOf(n.id)>-1&&(i++,n.expanded=!0,n.spriteCssClass=n.spriteCssClass&&n.spriteCssClass.toString().indexOf("e-folderCDB-icon")>-1?n.spriteCssClass.toString().replace("e-folderCDB-icon","e-folderCDB-open-icon"):n.spriteCssClass,i===t.length))break}},e.prototype.updateSorting=function(e){var i=e.target,r=i.getAttribute("data-sort");if(-1===i.className.indexOf("e-selected")){switch(r){case"None":this.fieldListSort="None",t.addClass([i],"e-selected"),t.removeClass([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),t.removeClass([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Ascend":this.fieldListSort="Ascend",t.addClass([i],"e-selected"),t.removeClass([this.parentElement.querySelector(".e-sort-none")],"e-selected"),t.removeClass([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Descend":this.fieldListSort="Descend",t.addClass([i],"e-selected"),t.removeClass([this.parentElement.querySelector(".e-sort-ascend")],"e-selected"),t.removeClass([this.parentElement.querySelector(".e-sort-none")],"e-selected")}this.refreshTreeView()}},e.prototype.applySorting=function(e,t){if("olap"===this.parent.dataType){var i=void 0,r=void 0;this.parent.dataSourceSettings.calculatedFieldSettings.length>0&&"[calculated members].[_0]"===e[0].id.toLowerCase()?(r=e[0],i=e[1],e.splice(0,2)):(i=e[0],e.splice(0,1)),e="Ascend"===t?e.sort(function(e,t){return e.caption>t.caption?1:t.caption>e.caption?-1:0}):"Descend"===t?e.sort(function(e,t){return e.caption<t.caption?1:t.caption<e.caption?-1:0}):e,r?e.splice(0,0,r,i):e.splice(0,0,i)}else this.fieldTable.sortOrder="Ascend"===t?"Ascending":"Descend"===t?"Descending":"None";return e},e.prototype.onFieldAdd=function(e){this.parent.dialogRenderer.updateDataSource(this.selectedNodes),this.closeTreeDialog()},e.prototype.closeTreeDialog=function(){this.selectedNodes=[],this.fieldDialog.hide()},e.prototype.keyPress=function(e){e.target;if(13===e.keyCode&&e.target)return e.target.click(),void e.preventDefault()},e.prototype.wireFieldListEvent=function(e){t.EventHandler.add(e,"keydown",this.keyPress,this),t.EventHandler.add(e,"click",this.updateSorting,this)},e.prototype.unWireFieldListEvent=function(e){t.EventHandler.remove(e,"keydown",this.keyPress),t.EventHandler.remove(e,"click",this.updateSorting)},e.prototype.addEventListener=function(){this.parent.on(B,this.refreshTreeView,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(B,this.refreshTreeView)},e.prototype.destroy=function(){this.removeEventListener()},e}(),Wi=function(){function e(e){this.parent=e}return e.prototype.render=function(){if(!this.parent.isAdaptive){var e=t.createElement("div",{className:"e-axis-table "+("olap"===this.parent.dataType?"e-olap-axis-table":"")});this.leftAxisPanel=t.createElement("div",{className:ne}),this.rightAxisPanel=t.createElement("div",{className:oe}),this.parent.dialogRenderer.parentElement.appendChild(e),e.appendChild(this.leftAxisPanel),e.appendChild(this.rightAxisPanel),this.axisTable=e,this.renderAxisTable()}this.parent.axisFieldModule.render()},e.prototype.renderAxisTable=function(){for(var e=["filters","rows","columns","values"],i=0,r=e.length;i<r;i++){var a=t.createElement("div",{className:te+"-"+e[i]}),n=t.createElement("div",{className:"e-axis-wrapper"}),o=t.createElement("div",{className:"e-axis-header",innerHTML:this.parent.localeObj.getConstant(e[i])});n.appendChild(this.getIconupdate(e[i])),n.appendChild(o);var l=t.createElement("div",{className:le+" e-"+e[i]}),s=void 0;s="rows"===e[i]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===e[i]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===e[i]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");var d=t.createElement("span",{className:se,innerHTML:s});new t.Droppable(l,{});a.appendChild(n),a.appendChild(l),a.appendChild(d),i<=1?this.leftAxisPanel.appendChild(a):this.rightAxisPanel.appendChild(a),this.unWireEvent(l),this.wireEvent(l)}},e.prototype.getIconupdate=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-axis-icon-wrapper"}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:"e-icons e-axis-"+e});return i.appendChild(r),i},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),t.EventHandler.add(e,"mouseleave",this.updateDropIndicator,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),t.EventHandler.remove(e,"mouseleave",this.updateDropIndicator)},e.prototype.updateDropIndicator=function(e){var i=this.parent.dialogRenderer.parentElement;if(this.parent.isDragging&&e.target.classList.contains(le)&&"mouseover"===e.type){t.removeClass([].slice.call(i.querySelectorAll("."+fe)),ve),t.removeClass([].slice.call(i.querySelectorAll("."+fe+"-last")),ve);var r=[].slice.call(e.target.querySelectorAll("."+de));r.length>0&&t.addClass([r[r.length-1].querySelector("."+fe+"-last")],ve)}else"mouseleave"===e.type&&(t.removeClass([].slice.call(i.querySelectorAll("."+fe)),ve),t.removeClass([].slice.call(i.querySelectorAll("."+fe+"-last")),ve))},e}(),Qi=function(){function e(e){this.parent=e,this.menuOption=new Xt(this.parent),this.parent.pivotButtonModule=this,this.addEventListener(),this.parent instanceof Ji&&(this.axisField=new Yi(this.parent))}return e.prototype.renderPivotButton=function(e){var i,r=t.extend([],e.field,null,!0),a=e.axis,n=-1,o="pivot"===this.parent.dataType&&("pivotfieldlist"==this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton);if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===e.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===e.axis)&&o&&this.parent.dataSourceSettings.values.length>1&&(n=r.length,r.push({name:this.parent.localeObj.getConstant("values"),caption:this.parent.localeObj.getConstant("values"),axis:e.axis})),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Wrapper"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Wrapper"),!this.parentElement.querySelector("."+te+"-"+a))return;var s=this.parentElement.querySelector("."+te+"-"+a).querySelector("."+se);0===r.length?t.removeClass([s],Z):t.addClass([s],Z),i=this.parentElement.querySelector("."+te+"-"+a).querySelector("."+le)}else this.parentElement=this.parent.element,i=this.parentElement.querySelector(".e-group-"+a);if(i)if("pivotview"===this.parent.getModuleName()&&0===r.length)for(var d=0,p=this.parentElement.querySelectorAll(".e-group-"+a);d<p.length;d++){if(!(P=p[d]).classList.contains(Bt)){s=t.createElement("span",{className:se,innerHTML:this.parent.groupingBarSettings.allowDragAndDrop?"rows"===a?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===a?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===a?this.parent.localeObj.getConstant("valueAxisPrompt"):this.parent.localeObj.getConstant("filterAxisPrompt"):""});P.appendChild(s)}}else{for(var h=0,u=r.length;h<u;h++)for(var g=0,m="pivotfieldlist"===this.parent.getModuleName()?[i]:this.parentElement.querySelectorAll(".e-group-"+a);g<m.length;g++){P=P=m[g];var f="olap"===this.parent.dataType&&("[measures]"===r[h].name.toLowerCase()||"values"===a),v="olap"===this.parent.dataType&&"values"===a;if(!P.classList.contains(Bt)){var y=t.createElement("div",{className:de+(0===h?" e-first-btn":""),attrs:{"data-tag":a+":"+r[h].name}}),S=t.createElement("div",{id:r[h].name,className:pe+" "+r[h].name.replace(/[^A-Z0-9]/gi,""),attrs:{"data-uid":r[h].name,tabindex:"0",isvalue:h===n||f&&!v?"true":"false","aria-disabled":"false","aria-label":r[h].caption?r[h].caption:r[h].name,"data-type":"olap"===this.parent.dataType?v?"isMeasureFieldsAvail":f?"isMeasureAvail":r[h].type:r[h].type,"data-caption":r[h].caption?r[h].caption:r[h].name,"data-basefield":r[h].baseField,"data-baseitem":r[h].baseItem}}),b=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:fe}),C=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:fe+"-last"}),x=this.createButtonDragIcon(S),w=this.createButtonText(r,h,a,n);S.appendChild(w),f||r[h].isNamedSet||r[h].isCalculatedField||(-1===["filters","values"].indexOf(a)&&n!==h&&this.createSortOption(S,r[h].name),"values"!==a&&n!==h&&this.createFilterOption(S,r[h].name),"values"===a&&this.getTypeStatus(r,h,S));var T=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:K+" "+me});"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showRemoveIcon?t.removeClass([T],Z):t.addClass([T],Z)),S.appendChild(T),y.appendChild(b),y.appendChild(S),y.appendChild(C),P.appendChild(y);var M=new c.Button({enableRtl:this.parent.enableRtl});M.isStringTemplate=!0,M.appendTo(S),this.unWireEvent(y,h===n?"values":a,f),this.wireEvent(y,h===n?"values":a,f),("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&this.createDraggable("pivotview"===this.parent.getModuleName()?w:x)}}if("values"===a)for(var D=function(e){if(e.classList.contains(Bt)){var i=r.map(function(e){return{text:e.caption?e.caption:e.name,value:e.name}}),a=E.parent;if(E.valueFiedDropDownList&&e.querySelector("."+Ut))E.valueFiedDropDownList.dataSource=i,E.valueFiedDropDownList.value=a.chartSettings.enableMultiAxis?i[0].value:a.chartModule.currentMeasure;else{var n=t.createElement("div",{className:Ut});e.appendChild(n),E.valueFiedDropDownList=new l.DropDownList({dataSource:i,enableRtl:E.parent.enableRtl,value:a.chartSettings.enableMultiAxis?i[0].value:a.chartModule.currentMeasure,width:200,fields:{value:"value",text:"text"},cssClass:Gt,change:function(e){e.e&&null!==e.e&&(a.chartSettings.value=e.value)}}),E.valueFiedDropDownList.isStringTemplate=!0,E.valueFiedDropDownList.appendTo(n)}}},E=this,L=0,O=this.parentElement.querySelectorAll(".e-group-"+a);L<O.length;L++){var P;D(P=O[L])}}},e.prototype.createButtonText=function(e,i,r,a){var n,o;"filters"===r&&(o=this.updateButtontext(e[i].name));var l;void 0!==(l="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e[i].name]&&(void 0!==(n=l.fieldList[e[i].name].aggregateType)||"string"!==l.fieldList[e[i].name].type&&"include"!==l.fieldList[e[i].name].type&&"exclude"!==l.fieldList[e[i].name].type?void 0===n&&(n=void 0!==l.fieldList[e[i].name].aggregateType?l.fieldList[e[i].name].aggregateType:"Sum"):n="Count");var s=e[i].caption?e[i].caption:e[i].name;return t.createElement("span",{attrs:{title:"filters"===r?"olap"===this.parent.dataType&&"CalculatedField"===l.fieldList[e[i].name].type?s:s+" ("+o+")":"olap"===this.parent.dataType?s:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===r&&"CalculatedField"!==n?this.parent.localeObj.getConstant(n)+" of "+s:s,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":a===i?"":n},className:"e-content "+("pivotview"!==this.parent.getModuleName()||this.parent.groupingBarSettings.allowDragAndDrop?"":"e-disable-drag"),innerHTML:"filters"===r?"olap"===this.parent.dataType&&"CalculatedField"===l.fieldList[e[i].name].type?s:s+" ("+o+")":"olap"===this.parent.dataType?s:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===r&&"CalculatedField"!==n?this.parent.localeObj.getConstant(n)+" of "+s:s})},e.prototype.getTypeStatus=function(e,t,i){var r=("olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e[t].name];"CalculatedField"!==r.aggregateType&&"number"===r.type&&this.createSummaryType(i,e[t].name)},e.prototype.createSummaryType=function(e,i){var r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:K+" "+J});return"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showValueTypeIcon?t.removeClass([r],Z):t.addClass([r],Z)),e.appendChild(r),r},e.prototype.createMenuOption=function(e){this.menuOption.render(e,this.parentElement),this.parent.pivotButtonModule=this},e.prototype.createDraggable=function(e){this.draggable=new t.Draggable(e,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"!==this.parent.getModuleName()||this.parent.groupingBarSettings.allowDragAndDrop?"":"."+pe})},e.prototype.createButtonDragIcon=function(e){var i=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),r=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:K+" e-drag"});return i.appendChild(r),e.appendChild(i),i},e.prototype.createSortOption=function(e,i){var r,a,n;if(n="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate){r="";for(var o=0;o<this.parent.dataSourceSettings.sortSettings.length;o++)this.parent.dataSourceSettings.sortSettings[o].name===i&&(r="Descending"===this.parent.dataSourceSettings.sortSettings[o].order?he:"")}else r="Descending"===n.fieldList[i].sort?he:"";return a="None"===n.fieldList[i].sort?t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:K}):t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:K+" e-sort "+r}),this.parent.dataSourceSettings.enableSorting?t.removeClass([a],Z):t.addClass([a],Z),"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showSortIcon?t.removeClass([a],Z):t.addClass([a],Z)),e.appendChild(a),a},e.prototype.createFilterOption=function(e,i){var r,a;if(a="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate){r=ce;for(var n=0;n<this.parent.dataSourceSettings.filterSettings.length;n++)this.parent.dataSourceSettings.filterSettings[n].name===i&&(r=ge)}else r=0===a.fieldList[i].filter.length?a.fieldList[i].isExcelFilter?ge:ce:ge;var o=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:ue+" "+K+" "+r});return"pivotview"===this.parent.getModuleName()&&(this.parent.groupingBarSettings.showFilterIcon?t.removeClass([o],Z):t.addClass([o],Z)),e.appendChild(o),o},e.prototype.updateButtontext=function(e){var t,i,r=(t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[e].filter.length,a=t.fieldList[e].filterType,n=t.fieldList[e].dateMember.length,o=t.fieldList[e].filter[0];if("olap"===this.parent.dataType)i=this.updateOlapButtonText(t,e,o,r);else if("include"===a)1===r?i=o:r>1&&(i=r===n?this.parent.localeObj.getConstant("all"):this.parent.localeObj.getConstant("multipleItems"));else if("exclude"===a){if(1===r)i=2===n?o!==t.fieldList[e].dateMember[0].actualText?o:t.fieldList[e].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(r>1){var l=void 0,s=Object.keys(t.fieldList[e].members),d=t.fieldList[e].filter;if(r===s.length-1)e:for(l=0;l<s.length;l++){var p=s[l];if(-1===d.indexOf(p)){i=s[l];break e}}else i=this.parent.localeObj.getConstant("multipleItems")}}else i=this.parent.localeObj.getConstant("all");return i},e.prototype.updateOlapButtonText=function(e,t,i,r){var a,n=e.fieldList[t].actualFilter;if(n.length>0){var o=e.fieldList[t].members,l=e.fieldList[t].currrentMembers,s=[];if(e.fieldList[t].searchMembers.length>0){for(var d=0,p=n;d<p.length;d++){l[c=p[d]].isSelected&&(l[c].parent&&l[l[c].parent].isSelected||s.push(c))}i=1===s.length?l[s[0]].caption:i}else if(e.fieldList[t].filterMembers.length>0){for(var h=0,u=n;h<u.length;h++){var c;o[c=u[h]].isSelected&&(o[c].parent&&o[o[c].parent].isSelected||s.push(c))}i=1===s.length?o[s[0]].caption:i}r=0===s.length?r:s.length}return 0===r?a=e.fieldList[t].allMember?e.fieldList[t].allMember:this.parent.localeObj.getConstant("all"):1===r?a=i:r>1&&(a=this.parent.localeObj.getConstant("multipleItems")),a},e.prototype.createDragClone=function(e){var i=t.closest(e.element,"."+pe),r=t.createElement("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"}),a=t.createElement("span",{className:ke,innerHTML:i.textContent});return r.appendChild(a),document.body.appendChild(r),r},e.prototype.onDragStart=function(e){this.parent.isDragging=!0;var i;i="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;var r=t.closest(e.element,"."+pe),a=i.fieldList[r.getAttribute("data-uid")],n=[Ee,Le,Pe];if(t.addClass([r],je),a&&"CalculatedField"===a.aggregateType)for(var o=0,l=n;o<l.length;o++){var s=l[o];t.addClass([this.parentElement.querySelector("."+s)],Re)}},e.prototype.onDragging=function(e){this.draggable.setProperties({cursorAt:{top:!t.isNullOrUndefined(e.event.targetTouches)||t.Browser.isDevice?60:-20}})},e.prototype.onDragStop=function(e){this.parent.isDragging=!1,e.target.classList&&(e.target.classList.contains(Bt)||e.target.classList.contains(Gt))&&(e.target=this.parent.element.querySelector("."+_t));var i=t.closest(e.element,"."+pe);t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+pe)),je),t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+fe)),ve);for(var r=0,a=[Ee,Le,Pe];r<a.length;r++){var n=a[r];t.removeClass([this.parentElement.querySelector("."+n)],Re)}if(this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close(),document.getElementById(this.parent.element.id+"_DragClone")&&t.remove(document.getElementById(this.parent.element.id+"_DragClone")),document.body.style.cursor="auto",this.isButtonDropped(e.target,i)&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(e,i.id))){this.updateDataSource();this.parent.axisFieldModule.render()}},e.prototype.isButtonDropped=function(e,i){var r=t.closest(i,"."+De),a=!0;if(r===t.closest(e,"."+De)){for(var n=[].slice.call(r.querySelectorAll("."+pe)),o=t.closest(e,"."+de),l=void 0,s=-1,d=0,p=n.length;d<p;d++)if(n[d].id===i.id&&(l=d),o){var h=o.querySelector("."+pe);n[d].id===h.id&&(s=d)}(l===s||l===n.length-1&&-1===s)&&(t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+fe)),ve),a=!1)}return a},e.prototype.updateSorting=function(e){if(!e.target.classList.contains(ue)&&!e.target.classList.contains(me)&&(this.parent instanceof Ji||this.parent.groupingBarSettings.showSortIcon)){("pivotview"===this.parent.getModuleName()&&this.parent.enableValueSorting||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableValueSorting)&&(this.parent.enableValueSorting||this.parent.pivotGridModule.enableValueSorting)&&(e.target.classList.contains("e-pivot-button")?"rows"===e.target.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0):"rows"===e.target.parentElement.parentElement.getAttribute("data-tag").split(":")[0]&&this.parent.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0)),this.parent.pivotCommon.eventBase.updateSorting(e),this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"==this.parent.getModuleName()||this.updateDataSource(!0);this.parent instanceof Ji&&this.axisField.render()}},e.prototype.updateDataSource=function(e){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(k,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent():this.parent.updateDataSource(e)},e.prototype.updateFiltering=function(e){this.parent.pivotCommon.eventBase.updateFiltering(e);var t=e.target;this.fieldName=t.parentElement.id,this.dialogPopUp=this.parent.pivotCommon.filterDialog.dialogPopUp,this.memberTreeView=this.parent.pivotCommon.filterDialog.memberTreeView,this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=this.nodeStateModified.bind(this),this.parent.pivotCommon.filterDialog.allMemberSelect.nodeChecked=this.nodeStateModified.bind(this),this.bindDialogEvents()},e.prototype.bindDialogEvents=function(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):(this.index=0,this.updateDialogButtonEvents())},e.prototype.buttonModel=function(){return[{buttonModel:{cssClass:we,content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" "+Z),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this),buttonModel:{cssClass:Te,content:this.parent.localeObj.getConstant("cancel")}}]},e.prototype.tabSelect=function(e){this.index=e.selectedIndex,this.updateDialogButtonEvents(),t.removeClass([].slice.call(this.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab"),e.selectedIndex>0&&t.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===e.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab"),0===e.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.dialogPopUp.element.querySelector("."+we).removeAttribute("disabled"))},e.prototype.updateDialogButtonEvents=function(){this.dialogPopUp.buttons=this.buttonModel(),this.dialogPopUp.dataBind()},e.prototype.updateCustomFilter=function(e){var i,r=this.dialogPopUp.element.querySelector(".e-selected-tab"),a=r.getAttribute("data-fieldname"),n=r.getAttribute("data-selectedField"),o=r.getAttribute("data-type"),l=r.getAttribute("data-measure"),s=r.getAttribute("data-operator"),d=r.getAttribute("data-value1"),p=r.getAttribute("data-value2"),h="value"===o?"Value":"date"===o?"Date":"number"===o?"Number":"Label",u={name:a,type:h,measure:l,condition:s,value1:"date"===o?new Date(d):d,value2:"date"===o?new Date(p):p};if("olap"===this.parent.dataType){u.selectedField=n,this.removeDataSourceSettings(a,n,h);for(var c=0,g=this.parent.dataSourceSettings.filterSettings;c<g.length;c++){var m=g[c];m.name===a&&m.selectedField===n&&(i=m)}}else i=this.parent.pivotCommon.eventBase.getFilterItemByName(a);if(t.isNullOrUndefined(d)||""===d||["Between","NotBetween"].indexOf(s)>-1&&(t.isNullOrUndefined(p)||""===p)){var f=h.toLowerCase()+(t.isNullOrUndefined(d)||""===d?"_input_option_1":"_input_option_2"),v=r.querySelector("#"+this.parent.element.id+"_"+f);return t.addClass([v],St),void v.focus()}i?((i=i.properties?i.properties:i).type=h,i.measure=l,i.condition=s,i.value1="date"===o?new Date(d):d,i.value2="date"===o?new Date(p):p,"olap"===this.parent.dataType&&(i.selectedField=n)):this.parent.dataSourceSettings.filterSettings.push(u),"Value"!==h&&(this.parent.lastFilterInfo=this.parent.pivotCommon.eventBase.getFilterItemByName(a)),this.dialogPopUp.close(),this.refreshPivotButtonState(a,!0),this.updateDataSource(!0)},e.prototype.ClearFilter=function(e){var t=this.dialogPopUp.element,i=t.getAttribute("data-fieldname"),r=t.querySelector(".e-selected-tab");if(this.dialogPopUp.close(),"olap"===this.parent.dataType&&r){var a=r.getAttribute("data-selectedField");this.removeDataSourceSettings(i,a)}else this.removeDataSourceSettings(i);var n=this.parent.pivotCommon.eventBase.getFilterItemByName(i);this.refreshPivotButtonState(i,!!n),this.updateDataSource(!0)},e.prototype.removeButton=function(e){var t=e.target,i=t.parentElement.id;"true"===t.parentElement.getAttribute("isvalue")?(this.parent.setProperties({dataSourceSettings:{values:[]}},!0),"olap"===this.parent.dataType&&this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[measures]")):this.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(i),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.axisFieldModule.render(),this.updateDataSource()},e.prototype.nodeStateModified=function(e){var i=t.closest(e.node,"li"),r=i.getAttribute("data-fieldname");if("all"===i.getAttribute("data-uid"))this.memberTreeView.nodeChecked=null,"check"===e.action?this.memberTreeView.checkAll():this.memberTreeView.uncheckAll(),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[r].isHierarchy&&this.updateNodeStates(this.memberTreeView.getAllCheckedNodes(),r,e.action),this.checkedStateAll(e.action),this.memberTreeView.nodeChecked=this.nodeStateModified.bind(this);else{if("olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[r].isHierarchy){var a=this.memberTreeView.getAllCheckedNodes();this.updateNodeStates(a,r,e.action)}var n=this.parent.pivotCommon.currentTreeItemsPos[i.getAttribute("data-uid")];"check"===e.action?this.parent.pivotCommon.currentTreeItems[n]&&(this.parent.pivotCommon.currentTreeItems[n].isSelected=!0):this.parent.pivotCommon.currentTreeItems[n]&&(this.parent.pivotCommon.currentTreeItems[n].isSelected=!1)}this.parent.pivotCommon.filterDialog.updateCheckedState()},e.prototype.checkedStateAll=function(e){for(var t={},i=0,r=this.parent.pivotCommon.searchTreeItems;i<r.length;i++){(o=r[i]).isSelected="check"===e,t[o.id]=o.id}for(var a=0,n=this.parent.pivotCommon.currentTreeItems;a<n.length;a++){var o;void 0!==t[(o=n[a]).id]&&(o.isSelected="check"===e)}},e.prototype.updateNodeStates=function(e,t,i){var r=this.parent.pivotCommon.engineModule.fieldList[t],a=r.members,n=r.currrentMembers;if(r.searchMembers.length>0){for(var o=0,l=Object.keys(n);o<l.length;o++){if(n[c=l[o]]&&(n[c].isSelected=!1),a[c]&&(a[c].isSelected=!1,this.memberTreeView.element.querySelector('li[data-uid="'+c+'"]'))){(p=this.memberTreeView.element.querySelector('li[data-uid="'+c+'"]'))&&!p.querySelector("ul")&&this.parent.pivotCommon.eventBase.updateChildNodeStates(r.filterMembers,t,c,!1)}}for(var s=0,d=e;s<d.length;s++){if(a[f=d[s]]&&this.memberTreeView.element.querySelector('li[data-uid="'+f+'"]')){var p;(p=this.memberTreeView.element.querySelector('li[data-uid="'+f+'"]'))&&!p.querySelector("ul")&&(a[f].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(r.filterMembers,t,f,!0))}n[f]&&(n[f].isSelected=!0)}}else{for(var h=0,u=Object.keys(a);h<u.length;h++){var c;a[c=u[h]].isSelected&&(a[c].isSelected=!1)}for(var g=0,m=e;g<m.length;g++){var f;a[f=m[g]]&&(a[f].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(r.filterMembers,t,f,!0))}}},e.prototype.updateFilterState=function(e,t){var i=!1,r={items:[],name:e,type:"Include"},a=this.parent.olapEngineModule;if("olap"===this.parent.dataType&&a&&!a.fieldList[e].isHierarchy){r.items=this.memberTreeView.getAllCheckedNodes(),i=r.items.length!==this.memberTreeView.fields.dataSource.length;for(var n=a.fieldList[e].members,o=a.fieldList[e].currrentMembers,l=0,s=r.items;l<s.length;l++){var d=s[l];n[d]&&(n[d].isSelected=!0),o[d]&&(o[d].isSelected=!0)}}else{for(var p=0,h=this.parent.pivotCommon.searchTreeItems;p<h.length;p++){var u=h[p];u.isSelected&&(this.parent.pivotCommon.isDateField?r.items.push(u.name):r.items.push(u.id))}i=r.items.length!==this.parent.pivotCommon.currentTreeItems.length}"olap"===this.parent.dataType&&this.removeDataSourceSettings(e);if(this.parent.pivotCommon.eventBase.getFilterItemByName(e)){for(var c=0;c<this.parent.dataSourceSettings.filterSettings.length;c++)if(this.parent.dataSourceSettings.filterSettings[c].name===e){this.parent.dataSourceSettings.filterSettings.splice(c,1);break}this.parent.dataSourceSettings.filterSettings.push(r)}else this.parent.dataSourceSettings.filterSettings.push(r);this.dialogPopUp.close(),this.refreshPivotButtonState(e,i),i||this.removeDataSourceSettings(e),this.parent.lastFilterInfo=r,this.updateDataSource(!0);this.parent instanceof Ji&&this.axisField.render()},e.prototype.refreshPivotButtonState=function(e,i){for(var r,a=0,n=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));a<n.length;a++){var o=n[a];if(o.getAttribute("data-uid")===e){r=o.querySelector("."+ue);break}}i?(t.removeClass([r],ce),t.addClass([r],ge)):(t.removeClass([r],ge),t.addClass([r],ce))},e.prototype.removeDataSourceSettings=function(e,t,i){for(var r=this.parent.dataSourceSettings.filterSettings,a=0,n=r.length;a<n;a++)if("olap"===this.parent.dataType&&t){if(!i&&r[a].name===e&&r[a].selectedField===t){r.splice(a,1);break}r[a].type!==i&&r[a].name===e&&(r.splice(a,1),n--,a--)}else if(r[a].name===e){if(r.splice(a,1),"olap"!==this.parent.dataType)break;n--,a--}},e.prototype.updateDropIndicator=function(e){if(this.parent.isDragging){t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+fe+"-last")),ve),t.removeClass([].slice.call(this.parentElement.querySelectorAll("."+fe)),ve);var i=t.closest(e.target,"."+de);t.addClass([i.querySelector("."+fe)],ve)}},e.prototype.wireEvent=function(e,i,r){t.EventHandler.add(e,"mouseover",this.updateDropIndicator,this),r||(-1===["filters","values"].indexOf(i)&&null!==e.querySelector("."+pe)&&t.EventHandler.add(e.querySelector("."+pe),"click",this.updateSorting,this),"values"!==i&&null!==e.querySelector("."+ue)&&t.EventHandler.add(e.querySelector("."+ue),"click",this.updateFiltering,this),"values"===i&&null!==e.querySelector("."+J)&&t.EventHandler.add(e.querySelector("."+J),"click",this.createMenuOption,this)),t.EventHandler.add(e.querySelector("."+me),"click",this.removeButton,this)},e.prototype.unWireEvent=function(e,i,r){t.EventHandler.remove(e,"mouseover",this.updateDropIndicator),r||(-1===["filters","values"].indexOf(i)&&null!==e.querySelector("."+pe)&&t.EventHandler.remove(e.querySelector("."+pe),"click",this.updateSorting),"values"!==i&&null!==e.querySelector("."+ue)&&t.EventHandler.remove(e.querySelector("."+ue),"click",this.updateFiltering),"values"===i&&null!==e.querySelector("."+J)&&t.EventHandler.remove(e.querySelector("."+J),"click",this.createMenuOption)),t.EventHandler.remove(e.querySelector("."+me),"click",this.removeButton)},e.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton},this.parent.isDestroyed||this.parent.on(U,this.handlers.load,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(U,this.handlers.load)},e.prototype.destroy=function(){this.menuOption.destroy(),this.removeEventListener()},e}(),Yi=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new Qi(this.parent),this.createPivotButtons()},e.prototype.createPivotButtons=function(){var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=this.parent.dialogRenderer.parentElement;t.querySelector("."+te+"-filters")&&(t.querySelector("."+te+"-filters").querySelector("."+le).innerHTML=""),t.querySelector("."+te+"-rows")&&(t.querySelector("."+te+"-rows").querySelector("."+le).innerHTML=""),t.querySelector("."+te+"-columns")&&(t.querySelector("."+te+"-columns").querySelector("."+le).innerHTML=""),t.querySelector("."+te+"-values")&&(t.querySelector("."+te+"-values").querySelector("."+le).innerHTML="");for(var i=["rows","columns","values","filters"],r=0,a=e.length;r<a;r++)if(e[r]){var n={field:e[r],axis:i[r].toString()};this.parent.notify(U,n)}},e}(),Xi=function(){function e(e){this.parent=e,this.parent.dialogRenderer=new Gi(this.parent),this.parent.treeViewModule=new zi(this.parent),this.parent.axisTableModule=new Wi(this.parent),this.parent.axisFieldModule=new Yi(this.parent)}return e.prototype.render=function(){this.parent.dialogRenderer.render(),this.parent.isAdaptive||this.parent.treeViewModule.render(),this.parent.axisTableModule.render()},e}(),Ki=function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Zi=function(e,t,i,r){var a,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var l=e.length-1;l>=0;l--)(a=e[l])&&(o=(n<3?a(o):n>3?a(t,i,o):a(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},Ji=function(e){function a(i,r){var a=e.call(this,i,r)||this;return a.isRequiredUpdate=!0,a.lastSortInfo={},a.lastFilterInfo={},a.lastAggregationInfo={},a.lastCalcFieldInfo={},a.dataSourceSettings&&!t.isNullOrUndefined(a.dataSourceSettings.dataProviderType)&&""!==a.dataSourceSettings.dataProviderType?(a.olapEngineModule=new Li,a.dataType="olap"):(a.engineModule=new m,a.dataType="pivot"),a}return Ki(a,e),a.prototype.requiredModules=function(){var e=[];return this.allowCalculatedField&&e.push({args:[this],member:"calculatedfield"}),e},a.prototype.preRender=function(){this.isAdaptive=t.Browser.isDevice,this.globalize=new t.Internationalization(this.locale),this.renderModule=new Xi(this),this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",calculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel",delete:"Delete",alert:"Alert",warning:"Warning",ok:"OK",sum:"Sum",average:"Average",count:"Count",min:"Min",max:"Max",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"APPLY",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption :",summarizeValuesBy:"Summarize values by :",baseField:"Base field :",baseItem:"Base item :",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update",null:"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",memberType:"Field Type",selectedHierarchy:"Parent Hierarchy",formatString:"Format String",expressionField:"Expression",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",customFormat:"Enter custom format string",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",Currency:"Currency",Percent:"Percent",Custom:"Custom",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing the calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year"},this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale),this.isDragging=!1,this.captionData=[],this.wireEvent()},a.prototype.frameCustomProperties=function(e,t){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var i=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0,r=!this.pivotGridModule||(this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing),a=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0;return"olap"===this.dataType?{mode:"",savedFieldList:t||void 0,savedFieldListData:e||void 0,pageSettings:i,enableValueSorting:a,isDrillThrough:r,localeObj:this.localeObj}:{mode:"",savedFieldList:void 0,pageSettings:i,enableValueSorting:a,isDrillThrough:r,localeObj:this.localeObj}},a.prototype.render=function(){var e=this;this.trigger("load",{dataSourceSettings:this.dataSourceSettings},function(i){e.dataSourceSettings=i.dataSourceSettings,t.addClass([e.element],Q),e.enableRtl?t.addClass([e.element],Y):t.removeClass([e.element],Y),e.isAdaptive?t.addClass([e.element],X):t.removeClass([e.element],X),e.cssClass&&t.addClass([e.element],e.cssClass),e.notify(j,{})}),t.isBlazor()&&this.renderComplete()},a.prototype.wireEvent=function(){this.on(j,this.generateData,this),this.on(V,this.fieldListRender,this)},a.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off(j,this.generateData),this.off(V,this.fieldListRender))},a.prototype.getPersistData=function(){return this.addOnPersist(["dataSourceSettings"])},a.prototype.getModuleName=function(){return"pivotfieldlist"},a.prototype.onPropertyChanged=function(e,i){for(var r=!1,a=0,n=Object.keys(e);a<n.length;a++){switch(n[a]){case"locale":this.refresh();break;case"enableRtl":this.enableRtl?t.addClass([this.element],Y):t.removeClass([this.element],Y),r=!0}r&&this.fieldListRender()}},a.prototype.initEngine=function(){var e=this;this.trigger(f,{dataSourceSettings:this.dataSourceSettings},function(i){if(e.dataSourceSettings=i.dataSourceSettings,"pivot"===e.dataType){if(e.dataSourceSettings.groupSettings&&e.dataSourceSettings.groupSettings.length>0){var r=e.dataSourceSettings.dataSource;e.clonedDataSet=e.clonedDataSet?e.clonedDataSet:g.getClonedData(r),e.setProperties({dataSourceSettings:{dataSource:[]}},!0),e.clonedReport=e.clonedReport?e.clonedReport:t.extend({},e.dataSourceSettings,null,!0),e.setProperties({dataSourceSettings:{dataSource:r}},!0)}e.engineModule.renderEngine(e.dataSourceSettings,e.frameCustomProperties(),e.getValueCellInfo.bind(e)),e.pivotFieldList=e.engineModule.fieldList;var a={pivotFieldList:e.pivotFieldList,pivotValues:e.engineModule.pivotValues},n=e;e.trigger(v,a,function(e){n.pivotFieldList=e.pivotFieldList,n.engineModule.pivotValues=e.pivotValues,n.notify(V,{}),n.trigger(T)})}else if("olap"===e.dataType){e.olapEngineModule.renderEngine(e.dataSourceSettings,e.frameCustomProperties()),e.pivotFieldList=e.olapEngineModule.fieldList;a={pivotFieldList:e.pivotFieldList,pivotValues:e.olapEngineModule.pivotValues};var o=e;e.trigger(v,a,function(e){o.pivotFieldList=e.pivotFieldList,o.olapEngineModule.pivotValues=e.pivotValues,o.notify(V,{}),o.trigger(T)})}})},a.prototype.generateData=function(){this.pivotFieldList={},this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.dataSourceSettings.dataSource instanceof i.DataManager&&setTimeout(this.getData.bind(this),100):(this.notify(V,{}),this.trigger(T))},a.prototype.getValueCellInfo=function(e){var t=e;return this.trigger(A,t),t},a.prototype.getData=function(){this.dataSourceSettings.dataSource.executeQuery(new i.Query).then(this.executeQuery.bind(this))},a.prototype.executeQuery=function(e){this.engineModule.data=e.result,this.initEngine()},a.prototype.fieldListRender=function(){this.element.innerHTML="","Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(this.dialogRenderer.fieldListDialog.destroy(),t.remove(document.getElementById(this.element.id+"_Wrapper"))),this.renderModule.render(),this.fieldListSpinnerElement="Popup"===this.renderMode?this.dialogRenderer.fieldListDialog.element:this.element.querySelector(".e-pivotfieldlist-wrapper"),this.spinnerTemplate?r.createSpinner({target:this.fieldListSpinnerElement,template:this.spinnerTemplate},this.createElement):r.createSpinner({target:this.fieldListSpinnerElement},this.createElement);var e;e={pivotEngine:"olap"===this.dataType?this.olapEngineModule:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:document.getElementById(this.element.id+"_Wrapper"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj,dataType:this.dataType},this.pivotCommon=new Ui(e),this.pivotCommon.control=this,this.allowDeferLayoutUpdate&&(this.clonedDataSource=t.extend({},this.dataSourceSettings,null,!0),this.clonedFieldList=t.extend({},this.pivotFieldList,null,!0))},a.prototype.getFieldCaption=function(e){if(this.getFields(e),this.captionData.length>0)for(var t=this.captionData.length,i="olap"===this.dataType?this.olapEngineModule:this.engineModule;t--;)if(this.captionData[t])for(var r=0,a=this.captionData[t];r<a.length;r++){var n=a[r];n&&i.fieldList[n.name]&&(n.caption?i.fieldList[n.name].caption=n.caption:i.fieldList[n.name].caption=n.name)}},a.prototype.getFields=function(e){this.captionData=[e.rows,e.columns,e.values,e.filters]},a.prototype.updateDataSource=function(e,i){this.pivotGridModule&&r.showSpinner(this.pivotGridModule.element),r.showSpinner(this.fieldListSpinnerElement);var a=this,n=!1;if(t.isNullOrUndefined(i)){var o=a.pivotGridModule?a.pivotGridModule.pageSettings:void 0,l=Object.keys(a.lastCalcFieldInfo).length>0,s=void 0;if("pivot"===a.dataType){var d=a.frameCustomProperties();d.savedFieldList=a.pivotFieldList;var p=a.pivotGridModule?a.pivotGridModule.lastSortInfo:a.lastSortInfo;a.pivotGridModule&&(a.pivotGridModule.lastSortInfo={}),a.lastSortInfo={};var h=Object.keys(a.lastAggregationInfo).length>0;s=Object.keys(p).length>0;var u=Object.keys(a.lastFilterInfo).length>0;if(o&&(s||u||h||l))s&&(a.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),a.engineModule.onSort(p)),u&&(a.engineModule.onFilter(a.lastFilterInfo,a.dataSourceSettings),a.lastFilterInfo={}),h&&(a.engineModule.onAggregation(a.lastAggregationInfo),a.lastAggregationInfo={}),l&&(a.engineModule.onCalcOperation(a.lastCalcFieldInfo),a.lastCalcFieldInfo={});else try{a.engineModule.renderEngine(a.dataSourceSettings,d,a.getValueCellInfo.bind(a))}catch(e){if(!this.calculatedFieldModule||!this.calculatedFieldModule.isFormula)throw e;this.calculatedFieldModule.showError()}}else n=a.updateOlapDataSource(s,l,n);a.getFieldCaption(a.dataSourceSettings)}else a.axisFieldModule.render(),a.isRequiredUpdate=!1;var c={dataSourceSettings:a.dataSourceSettings,pivotFieldList:"pivot"===a.dataType?a.engineModule.fieldList:a.olapEngineModule.fieldList,pivotValues:"pivot"===a.dataType?a.engineModule.pivotValues:a.olapEngineModule.pivotValues};a.trigger(v,c,function(i){a.dataSourceSettings=i.dataSourceSettings,a.pivotCommon.dataSourceSettings=a.dataSourceSettings,a.pivotFieldList=i.pivotFieldList,"olap"===a.dataType?(a.olapEngineModule.pivotValues=i.pivotValues,a.pivotCommon.engineModule=a.olapEngineModule):(a.engineModule.pivotValues=i.pivotValues,a.pivotCommon.engineModule=a.engineModule),e||!a.treeViewModule.fieldTable||a.isAdaptive||a.notify(B,{}),a.isRequiredUpdate?(a.allowDeferLayoutUpdate&&(a.clonedDataSource=t.extend({},a.dataSourceSettings,null,!0),a.clonedFieldList=t.extend({},a.pivotFieldList,null,!0)),a.updateView(a.pivotGridModule)):"Popup"===a.renderMode&&a.allowDeferLayoutUpdate&&(a.pivotGridModule.engineModule=a.engineModule,a.pivotGridModule.setProperties({dataSourceSettings:a.dataSourceSettings.properties},!0),a.pivotGridModule.notify(k,a),r.hideSpinner(a.fieldListSpinnerElement)),a.isRequiredUpdate=!0,!a.pivotGridModule||a.isAdaptive&&a.pivotGridModule&&n?r.hideSpinner(a.fieldListSpinnerElement):a.pivotGridModule.fieldListSpinnerElement=a.fieldListSpinnerElement})},a.prototype.updateOlapDataSource=function(e,t,i){var a=this.frameCustomProperties(this.olapEngineModule.fieldListData,this.olapEngineModule.fieldList);return a.savedFieldList=this.pivotFieldList,e=Object.keys(this.lastSortInfo).length>0,t||e?(this.olapEngineModule.savedFieldList=this.pivotFieldList,this.olapEngineModule.savedFieldListData=this.olapEngineModule.fieldListData,t?(this.olapEngineModule.updateCalcFields(this.dataSourceSettings,this.lastCalcFieldInfo),this.lastCalcFieldInfo={},i=!0,this.pivotGridModule&&this.isAdaptive&&r.hideSpinner(this.pivotGridModule.element)):(this.olapEngineModule.onSort(this.dataSourceSettings),this.lastSortInfo={})):this.olapEngineModule.renderEngine(this.dataSourceSettings,a),i},a.prototype.update=function(e){e&&(this.clonedDataSet=e.clonedDataSet,this.setProperties({dataSourceSettings:e.dataSourceSettings},!0),this.engineModule=e.engineModule,this.olapEngineModule=e.olapEngineModule,this.dataType=e.dataType,this.pivotFieldList="olap"===this.dataType?e.olapEngineModule.fieldList:e.engineModule.fieldList,"Popup"===this.renderMode&&(this.pivotGridModule=e),this.getFieldCaption(e.dataSourceSettings),this.pivotCommon.engineModule="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=this,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(B,{}),this.axisFieldModule.render(),"Fixed"===this.renderMode&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=t.extend({},this.dataSourceSettings,null,!0),this.clonedFieldList=t.extend({},this.pivotFieldList,null,!0)))},a.prototype.updateView=function(e){if(e){e.clonedDataSet=this.clonedDataSet,e.setProperties({dataSourceSettings:this.dataSourceSettings},!0),e.engineModule=this.engineModule,e.olapEngineModule=this.olapEngineModule,e.dataType=this.dataType,e.pivotValues="olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues;var t={dataSourceSettings:e.dataSourceSettings,pivotValues:e.pivotValues};e.trigger(q,t),e.dataBind()}},a.prototype.triggerPopulateEvent=function(){var e=this,t={dataSourceSettings:this.dataSourceSettings,pivotFieldList:"olap"===this.dataType?this.olapEngineModule.fieldList:this.engineModule.fieldList,pivotValues:"olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues};this.trigger(v,t,function(t){e.dataSourceSettings=t.dataSourceSettings,e.pivotFieldList=t.pivotFieldList,e.engineModule.pivotValues=t.pivotValues})},a.prototype.destroy=function(){this.unWireEvent(),this.treeViewModule&&this.treeViewModule.destroy(),this.pivotButtonModule&&this.pivotButtonModule.destroy(),this.allowDeferLayoutUpdate&&this.dialogRenderer&&this.dialogRenderer.deferUpdateCheckBox&&!this.dialogRenderer.deferUpdateCheckBox.isDestroyed&&this.dialogRenderer.deferUpdateCheckBox.destroy(),e.prototype.destroy.call(this),this.element.innerHTML="",t.removeClass([this.element],Q),t.removeClass([this.element],Y),t.removeClass([this.element],X),"Popup"===this.renderMode&&(this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&this.dialogRenderer.fieldListDialog.destroy(),document.getElementById(this.element.id+"_Wrapper")&&t.remove(document.getElementById(this.element.id+"_Wrapper")))},Zi([t.Complex({},si)],a.prototype,"dataSourceSettings",void 0),Zi([t.Property("Popup")],a.prototype,"renderMode",void 0),Zi([t.Property()],a.prototype,"target",void 0),Zi([t.Property("")],a.prototype,"cssClass",void 0),Zi([t.Property(!1)],a.prototype,"allowCalculatedField",void 0),Zi([t.Property(!1)],a.prototype,"showValuesButton",void 0),Zi([t.Property(!1)],a.prototype,"allowDeferLayoutUpdate",void 0),Zi([t.Property(1e3)],a.prototype,"maxNodeLimitInMemberEditor",void 0),Zi([t.Property(!1)],a.prototype,"loadMaximumMembers",void 0),Zi([t.Property()],a.prototype,"spinnerTemplate",void 0),Zi([t.Event()],a.prototype,"load",void 0),Zi([t.Event()],a.prototype,"enginePopulating",void 0),Zi([t.Event()],a.prototype,"enginePopulated",void 0),Zi([t.Event()],a.prototype,"onFieldDropped",void 0),Zi([t.Event()],a.prototype,"aggregateCellInfo",void 0),Zi([t.Event()],a.prototype,"dataBound",void 0),Zi([t.Event()],a.prototype,"created",void 0),Zi([t.Event()],a.prototype,"destroyed",void 0),a=Zi([t.NotifyPropertyChanges],a)}(t.Component),$i="CalculatedField",er=function(){function e(e){this.isFormula=!1,this.parent=e,this.existingReport=null,this.parent.calculatedFieldModule=this,this.removeEventListener(),this.addEventListener(),this.parentID=this.parent.element.id,this.dialog=null,this.inputObj=null,this.treeObj=null,this.droppable=null,this.menuObj=null,this.newFields=null,this.isFieldExist=!0,this.formulaText=null,this.fieldText=null,this.isEdit=!1,this.currentFieldName=null,this.confirmPopUp=null}return e.prototype.getModuleName=function(){return"calculatedfield"},e.prototype.keyActionHandler=function(e){var t=e.currentTarget.querySelector(".e-hover.e-node-focus");if(t)switch(e.action){case"moveRight":"pivot"===this.parent.dataType&&this.displayMenu(t.previousSibling);break;case"enter":var i=t.getAttribute("data-field"),r=t.getAttribute("data-type"),a=this.dialog.element.querySelector("#"+this.parentID+"droppable");"pivot"===this.parent.dataType?""===a.value?a.value=r===$i?t.getAttribute("data-uid"):'"'+r+"("+i+')"':""!==a.value&&(a.value=r===$i?a.value+t.getAttribute("data-uid"):a.value+'"'+r+"("+i+')"'):(this.parent.olapEngineModule&&this.parent.olapEngineModule.fieldList[i]&&this.parent.olapEngineModule.fieldList[i].isCalculatedField&&(i=this.parent.olapEngineModule.fieldList[i].tag),""===a.value?a.value=i:""!==a.value&&(a.value=a.value+i))}},e.prototype.fieldClickHandler=function(e){var t=e.event.target.parentElement;(e.event.target.classList.contains(lt)||e.event.target.classList.contains(vt)||e.event.target.classList.contains(yt))&&this.displayMenu(t.parentElement)},e.prototype.clearFormula=function(){this.treeObj&&this.treeObj.element.querySelector("li")&&(t.removeClass(this.treeObj.element.querySelectorAll("li"),"e-active"),this.displayMenu(this.treeObj.element.querySelector("li")))},e.prototype.displayMenu=function(e){if("pivot"!==this.parent.dataType||null===document.querySelector("."+this.parentID+"calculatedmenu")||!e.querySelector(".e-list-icon").classList.contains(K)||e.querySelector(".e-list-icon").classList.contains(yt)||e.querySelector(".e-list-icon").classList.contains(vt)||"LI"!==e.tagName){if("LI"===e.tagName&&(e.querySelector(".e-list-icon").classList.contains(vt)||"olap"===this.parent.dataType&&e.getAttribute("data-type")===$i&&e.classList.contains("e-active"))){this.isEdit=!0;var i=e.getAttribute("data-field"),r=e.getAttribute("data-caption");if(this.currentFieldName=i,this.inputObj.value=r,this.inputObj.dataBind(),"olap"===this.parent.dataType){var a=e.getAttribute("data-membertype"),n=e.getAttribute("data-hierarchy"),s=e.getAttribute("data-formula"),d=e.getAttribute("data-formatString"),p=e.getAttribute("data-customString"),h=this.dialog.element,u=t.getInstance(h.querySelector("#"+this.parentID+"Custom_Format_Element"),o.MaskedTextBox),c=t.getInstance(h.querySelector("#"+this.parentID+"Member_Type_Div"),l.DropDownList),g=t.getInstance(h.querySelector("#"+this.parentID+"Hierarchy_List_Div"),l.DropDownList),m=t.getInstance(h.querySelector("#"+this.parentID+"Format_Div"),l.DropDownList);document.querySelector("#"+this.parentID+"droppable").value=s,c.readonly=!0,c.value=a,c.dataBind(),"Dimension"===a&&(g.value=n),""!==d&&(m.value=d,m.dataBind()),u.value=p,u.dataBind()}else t.addClass([e.querySelector(".e-list-icon")],yt),t.removeClass([e.querySelector(".e-list-icon")],vt),e.querySelector("."+yt).setAttribute("title",this.parent.localeObj.getConstant("clear")),document.querySelector("#"+this.parentID+"droppable").value=e.getAttribute("data-uid")}else if("LI"===e.tagName&&(e.querySelector(".e-list-icon").classList.contains(yt)||"olap"===this.parent.dataType&&!e.classList.contains("e-active"))){if(this.isEdit=!1,this.inputObj.value="",this.inputObj.dataBind(),"olap"===this.parent.dataType){h=this.dialog.element,g=t.getInstance(h.querySelector("#"+this.parentID+"Hierarchy_List_Div"),l.DropDownList),m=t.getInstance(h.querySelector("#"+this.parentID+"Format_Div"),l.DropDownList),u=t.getInstance(h.querySelector("#"+this.parentID+"Custom_Format_Element"),o.MaskedTextBox),c=t.getInstance(h.querySelector("#"+this.parentID+"Member_Type_Div"),l.DropDownList);g.index=0,g.dataBind(),m.index=0,m.dataBind(),u.value="",u.dataBind(),c.index=0,c.readonly=!1,c.dataBind()}else t.addClass([e.querySelector(".e-list-icon")],vt),t.removeClass([e.querySelector(".e-list-icon")],yt),e.querySelector(".e-edit").setAttribute("title",this.parent.localeObj.getConstant("edit"));document.querySelector("#"+this.parentID+"droppable").value=""}}else this.menuObj.close(),this.curMenu=e.querySelector("."+Be),this.openContextMenu()},e.prototype.openContextMenu=function(){var e=this.curMenu.getBoundingClientRect();this.parent.enableRtl?this.menuObj.open(e.top+30,e.left-100):this.menuObj.open(e.top+30,e.left+150)},e.prototype.selectContextMenu=function(e){if(null!==e.element.textContent){var i=t.closest(this.curMenu,".e-list-item").getAttribute("data-caption");t.closest(this.curMenu,".e-list-item").setAttribute("data-type",e.element.id),this.curMenu.textContent=i+" ("+e.element.id.split(this.parent.element.id+"_")[1]+")",t.addClass([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]),this.curMenu.parentElement.parentElement.setAttribute("tabindex","-1"),this.curMenu.parentElement.parentElement.focus()}},e.prototype.createMenu=function(){var e=[{id:this.parent.element.id+"_Sum",text:this.parent.localeObj.getConstant("Sum")},{id:this.parent.element.id+"_Count",text:this.parent.localeObj.getConstant("Count")},{id:this.parent.element.id+"_DistinctCount",text:this.parent.localeObj.getConstant("DistinctCount")},{id:this.parent.element.id+"_Avg",text:this.parent.localeObj.getConstant("Avg")},{id:this.parent.element.id+"_Min",text:this.parent.localeObj.getConstant("Min")},{id:this.parent.element.id+"_Max",text:this.parent.localeObj.getConstant("Max")},{id:this.parent.element.id+"_Product",text:this.parent.localeObj.getConstant("Product")},{id:this.parent.element.id+"_SampleStDev",text:this.parent.localeObj.getConstant("SampleStDev")},{id:this.parent.element.id+"_SampleVar",text:this.parent.localeObj.getConstant("SampleVar")},{id:this.parent.element.id+"_PopulationStDev",text:this.parent.localeObj.getConstant("PopulationStDev")},{id:this.parent.element.id+"_PopulationVar",text:this.parent.localeObj.getConstant("PopulationVar")}],i={cssClass:this.parentID+"calculatedmenu",items:e,enableRtl:this.parent.enableRtl,beforeOpen:this.beforeMenuOpen.bind(this),select:this.selectContextMenu.bind(this)},r=t.createElement("ul",{id:this.parentID+"contextmenu"});this.parent.element.appendChild(r),this.menuObj=new n.ContextMenu(i),this.menuObj.isStringTemplate=!0,this.menuObj.appendTo(r)},e.prototype.applyFormula=function(){var e=this,i=!1;if(t.removeClass([document.getElementById(this.parentID+"ddlelement")],St),"olap"===e.parent.dataType){var r=e.inputObj.value;e.parent.olapEngineModule.fieldList[r]&&"CalculatedField"!==e.parent.olapEngineModule.fieldList[r].type&&(i=!0)}else Object.keys(e.parent.engineModule.fieldList).forEach(function(t,r){e.inputObj.value&&e.inputObj.value===t&&"CalculatedField"!==e.parent.engineModule.fieldList[t].aggregateType&&(i=!0)});if(i)e.parent.pivotCommon.errorDialog.createErrorDialog(e.parent.localeObj.getConstant("error"),e.parent.localeObj.getConstant("fieldExist"));else{this.newFields=t.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.existingReport=t.extend({},this.parent.dataSourceSettings,null,!0);var a=this.parent.dataSourceSettings,n=document.querySelector("#"+this.parentID+"droppable");if(null!==this.inputObj.value&&""!==this.inputObj.value&&""!==n.value){r=void 0;if("olap"===this.parent.dataType){var s=this.parent.isAdaptive?this.parent.dialogRenderer.adaptiveElement.element:this.dialog.element,d=t.getInstance(s.querySelector("#"+this.parentID+"Custom_Format_Element"),o.MaskedTextBox),p=t.getInstance(s.querySelector("#"+this.parentID+"Member_Type_Div"),l.DropDownList),h=t.getInstance(s.querySelector("#"+this.parentID+"Hierarchy_List_Div"),l.DropDownList),u=t.getInstance(s.querySelector("#"+this.parentID+"Format_Div"),l.DropDownList);if(r={name:this.inputObj.value,formula:n.value,formatString:"Custom"===u.value?d.value:u.value},"Dimension"===p.value&&(r.hierarchyUniqueName=h.value),this.isFieldExist=!1,this.isEdit){for(g=0;g<a.calculatedFieldSettings.length;g++)if(a.calculatedFieldSettings[g].name===this.currentFieldName&&this.isEdit){"Dimension"===p.value&&(a.calculatedFieldSettings[g].hierarchyUniqueName=r.hierarchyUniqueName),a.calculatedFieldSettings[g].formatString=r.formatString,a.calculatedFieldSettings[g].formula=r.formula,r=a.calculatedFieldSettings[g],this.isFieldExist=!0;break}var c=t.extend([],a.rows,null,!0);c=c.concat(a.columns,a.values,a.filters);for(g=0;g<c.length;g++)if(c[g].isCalculatedField&&null!==this.currentFieldName&&c[g].name===this.currentFieldName&&this.isEdit){c[g].caption=this.inputObj.value,this.isFieldExist=!0;break}}else for(var g=0;g<a.calculatedFieldSettings.length;g++)if(a.calculatedFieldSettings[g].name===r.name)return void this.createConfirmDialog(e.parent.localeObj.getConstant("alert"),e.parent.localeObj.getConstant("confirmText"));this.isFieldExist||a.calculatedFieldSettings.push(r),this.parent.lastCalcFieldInfo=r}else{r={name:this.inputObj.value,type:"CalculatedField"};var m={name:this.inputObj.value,formula:n.value};if(this.isFieldExist=!0,this.isEdit){for(g=0;g<a.values.length;g++)if(a.values[g].type===$i&&null!==this.currentFieldName&&a.values[g].name===this.currentFieldName&&this.isEdit)for(f=0;f<a.calculatedFieldSettings.length;f++)a.calculatedFieldSettings[f].name===this.currentFieldName&&(a.values[g].caption=this.inputObj.value,a.calculatedFieldSettings[f].formula=n.value,this.parent.engineModule.fieldList[this.currentFieldName].caption=this.inputObj.value,this.isFieldExist=!1)}else for(var g=0;g<a.values.length;g++)if(a.values[g].type===$i&&a.values[g].name===r.name){for(var f=0;f<a.calculatedFieldSettings.length;f++)if(a.calculatedFieldSettings[f].name===r.name)return void this.createConfirmDialog(e.parent.localeObj.getConstant("alert"),e.parent.localeObj.getConstant("confirmText"));this.isFieldExist=!1}this.isFieldExist&&(a.values.push(r),a.calculatedFieldSettings.push(m)),this.parent.lastCalcFieldInfo=m}this.addFormula(a,r.name)}else null===this.inputObj.value||""===this.inputObj.value?(t.addClass([document.getElementById(this.parentID+"ddlelement")],St),document.getElementById(this.parentID+"ddlelement").focus()):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula"))}},e.prototype.addFormula=function(e,t){this.isFormula=!0,this.field=t,this.parent.setProperties({dataSourceSettings:e},!0),"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.isRequiredUpdate=!1),this.parent.updateDataSource(!1);this.isEdit=!1,this.dialog?this.dialog.close():(this.inputObj.value="",this.formulaText=null,this.fieldText=null,this.parent.dialogRenderer.parentElement.querySelector("."+nt).value="",this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value="")},e.prototype.showError=function(){this.parent.engineModule.fieldList[this.field]&&delete this.parent.engineModule.fieldList[this.field],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),this.parent.setProperties({dataSourceSettings:this.existingReport},!0),this.parent.lastCalcFieldInfo={},this.parent.updateDataSource(!1),this.isFormula=!1},e.prototype.getFieldListData=function(e){var t=[];if("olap"===this.parent.dataType)for(var i=0,r=t=g.getClonedData(e.olapEngineModule.fieldListData);i<r.length;i++){var a=r[i];a.spriteCssClass&&(a.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||a.spriteCssClass.indexOf("e-level-members")>-1)?a.hasChildren=!0:a.spriteCssClass&&a.spriteCssClass.indexOf("e-namedSetCDB-icon")>-1&&(a.hasChildren=!1)}else Object.keys(e.engineModule.fieldList).forEach(function(i){var r=null;r="string"===e.engineModule.fieldList[i].type||"include"===e.engineModule.fieldList[i].type||"exclude"===e.engineModule.fieldList[i].type?"Count":void 0!==e.engineModule.fieldList[i].aggregateType?e.engineModule.fieldList[i].aggregateType:"Sum",t.push({index:e.engineModule.fieldList[i].index,name:e.engineModule.fieldList[i].caption+" ("+r+")",type:r,icon:lt+" "+K,formula:e.engineModule.fieldList[i].formula,field:i,caption:e.engineModule.fieldList[i].caption?e.engineModule.fieldList[i].caption:i})});return t},e.prototype.beforeMenuOpen=function(e){e.element.style.zIndex=(this.dialog.zIndex+1).toString(),e.element.style.display="inline"},e.prototype.fieldDropped=function(e){e.cancel=!0;var i=this.dialog.element.querySelector("#"+this.parentID+"droppable");t.removeClass([i],"e-copy-drop"),t.removeClass([e.draggedNode.querySelector("."+Be)],je);var r=e.draggedNode.getAttribute("data-field");if("olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList[r]&&this.parent.olapEngineModule.fieldList[r].isCalculatedField&&(r=this.parent.olapEngineModule.fieldList[r].tag),e.target.id===this.parentID+"droppable"&&""===i.value)i.value=r,i.focus();else if(e.target.id===this.parentID+"droppable"&&""!==i.value){var a=void 0,n=i.value,o=i.selectionStart,l=n.substring(o,n.length);a=(d=n.substring(0,o))+r,i.value=d+r+l,i.focus(),i.setSelectionRange(a.length,a.length)}else e.cancel=!0;else{var s=e.draggedNode.getAttribute("data-type");if(e.target.id===this.parentID+"droppable"&&""===i.value)i.value=s===$i?e.draggedNodeData.id.toString():'"'+s+"("+r+')"',i.focus();else if(e.target.id===this.parentID+"droppable"&&""!==i.value){a=void 0,o=i.selectionStart;var d=(n=i.value).substring(0,o);l=n.substring(o,n.length);s===$i?(a=d+e.draggedNodeData.id.toString(),i.value=d+e.draggedNodeData.id.toString()+l):(a=d+'"'+s+"("+r+')"',i.value=d+'"'+s+"("+r+')"'+l),i.focus(),i.setSelectionRange(a.length,a.length)}else e.cancel=!0}},e.prototype.createDialog=function(){var e=this;null!==document.querySelector("#"+this.parentID+"calculateddialog")&&t.remove(document.querySelector("#"+this.parentID+"calculateddialog")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div "+("olap"===this.parent.dataType?"e-olap-calc-dialog-div":"")}));var i=[{click:this.applyFormula.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}];if("olap"===this.parent.dataType){var a={click:this.clearFormula.bind(this),buttonModel:{cssClass:"e-calc-clear-btn",content:this.parent.localeObj.getConstant("clear")}};i.splice(0,0,a)}this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:i,close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),open:function(){e.dialog.element.querySelector("#"+e.parentID+"ddlelement")&&e.dialog.element.querySelector("#"+e.parentID+"ddlelement").focus()},animationSettings:{effect:"Zoom"},width:"25%",isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parentID+"calculateddialog")},e.prototype.cancelClick=function(){this.dialog.close(),this.isEdit=!1},e.prototype.beforeOpen=function(e){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))},e.prototype.closeDialog=function(e){"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&(t.addClass([this.parent.element.querySelector("."+ee)],"e-hide"),this.parent.dialogRenderer.fieldListDialog.show())),this.treeObj.destroy(),this.dialog.destroy(),this.newFields=null,t.remove(document.getElementById(this.parentID+"calculateddialog")),t.remove(document.querySelector("."+this.parentID+"calculatedmenu"))},e.prototype.renderDialogElements=function(){var e=t.createElement("div",{id:this.parentID+"outerDiv",className:("olap"===this.parent.dataType?"e-olap-calc-outer-div ":"")+"e-pivot-calc-outer-div"}),i=t.createElement("div",{id:this.parentID+"Olap_Tree_Div",className:"e-olap-field-tree-div"}),a=t.createElement("div",{id:this.parentID+"Olap_Calc_Div",className:"e-olap-calculated-div"});if("pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+st)&&this.parent.isAdaptive){var n=t.createElement("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"});e.appendChild(n);var o=t.createElement("div",{id:this.parentID+"buttonDiv",className:ut}),l=t.createElement("button",{id:this.parentID+"addBtn",innerHTML:this.parent.localeObj.getConstant("add"),className:"e-pivot-add-button"}),s=t.createElement("button",{id:this.parentID+"cancelBtn",innerHTML:this.parent.localeObj.getConstant("cancel"),className:"e-pivot-cancel-button"});o.appendChild(s),o.appendChild(l),e.appendChild(o)}else{if(!this.parent.isAdaptive&&"olap"===this.parent.dataType){var d=t.createElement("div",{className:"e-pivot-field-name-title",innerHTML:this.parent.localeObj.getConstant("fieldTitle")});a.appendChild(d)}var p=t.createElement("div",{id:this.parentID+"outerDiv",className:"e-pivot-calc-input-div"}),h=t.createElement("input",{id:this.parentID+"ddlelement",attrs:{type:"text"},className:nt});p.appendChild(h),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(p):a.appendChild(p);var u=t.createElement("div",{id:this.parentID+"control_wrapper",className:pt});if(!this.parent.isAdaptive){var c=t.createElement("div",{className:ct,innerHTML:"olap"===this.parent.dataType?this.parent.localeObj.getConstant("allFields"):this.parent.localeObj.getConstant("formulaField")});if("olap"===this.parent.dataType){var g=t.createElement("div",{className:ct+"-wrapper"});g.appendChild(c);var m=t.createElement("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldTooltip")},className:K+" e-info"});g.appendChild(m);new r.Tooltip({content:this.parent.localeObj.getConstant("fieldTooltip"),position:this.parent.enableRtl?"RightCenter":"LeftCenter",target:".e-info",offsetY:(this.parent.enableRtl,-10),width:220}).appendTo(g),u.appendChild(g)}else e.appendChild(c)}var f=t.createElement("div",{className:dt+"-outer-div"});if(u.appendChild(f),f.appendChild(t.createElement("div",{id:this.parentID+"tree",className:dt})),"olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(u):i.appendChild(u),!this.parent.isAdaptive){d=t.createElement("div",{className:"e-pivot-formula-title",innerHTML:"olap"===this.parent.dataType?this.parent.localeObj.getConstant("expressionField"):this.parent.localeObj.getConstant("formula")});"olap"===this.parent.dataType?a.appendChild(d):e.appendChild(d)}var v=t.createElement("textarea",{id:this.parentID+"droppable",className:st,attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):"olap"===this.parent.dataType?this.parent.localeObj.getConstant("olapDropText"):this.parent.localeObj.getConstant("dropText")}});if("olap"!==this.parent.dataType||this.parent.isAdaptive?e.appendChild(v):a.appendChild(v),this.parent.isAdaptive){o=t.createElement("div",{id:this.parentID+"buttonDiv",className:ut});var y=t.createElement("button",{id:this.parentID+"okBtn",innerHTML:this.parent.localeObj.getConstant("apply"),className:ht});o.appendChild(y),e.appendChild(o)}if("olap"===this.parent.dataType){if(!this.parent.isAdaptive){var S=t.createElement("div",{className:"e-olap-member-title",innerHTML:this.parent.localeObj.getConstant("memberType")});a.appendChild(S)}var b=t.createElement("div",{id:this.parentID+"Member_Type_Div",className:"e-olap-calc-member-type-div"});if(this.parent.isAdaptive?e.appendChild(b):a.appendChild(b),!this.parent.isAdaptive){var C=t.createElement("div",{className:"e-olap-hierarchy-title",innerHTML:this.parent.localeObj.getConstant("selectedHierarchy")});a.appendChild(C)}var x=t.createElement("div",{id:this.parentID+"Hierarchy_List_Div",className:"e-olap-calc-hierarchy-list-div"});if(this.parent.isAdaptive?e.appendChild(x):a.appendChild(x),!this.parent.isAdaptive){var w=t.createElement("div",{className:"e-olap-format-title",innerHTML:this.parent.localeObj.getConstant("formatString")});a.appendChild(w)}var T=t.createElement("div",{id:this.parentID+"Format_Div",className:"e-olap-calc-format-type-div"});this.parent.isAdaptive?e.appendChild(T):a.appendChild(T);var M=t.createElement("div",{id:this.parentID+"custom_Format_Div",className:"e-olap-calc-custom-format-div"}),D=t.createElement("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:"e-custom-format-input"});if(M.appendChild(D),a.appendChild(M),this.parent.isAdaptive?e.appendChild(M):a.appendChild(M),"pivotfieldlist"===this.parent.getModuleName()&&null===this.parent.dialogRenderer.parentElement.querySelector("."+st)&&this.parent.isAdaptive){y=e.querySelector("."+ht);e.appendChild(y)}else e.appendChild(i),e.appendChild(a)}}return e},e.prototype.renderAdaptiveLayout=function(){document.querySelector("#"+this.parentID+"droppable")&&(this.formulaText=document.querySelector("#"+this.parentID+"droppable").value,this.fieldText=this.inputObj.value),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createOlapDropElements=function(){for(var e=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element,t=[],i=[],r=[],a=0,n=["Measure","Dimension"];a<n.length;a++){var s=n[a];t.push({value:s,text:this.parent.localeObj.getConstant(s)})}for(var d=0,p=["Standard","Currency","Percent","Custom"];d<p.length;d++){var h=p[d];i.push({value:h,text:this.parent.localeObj.getConstant(h)})}for(var u=0,c=g.getClonedData(this.parent.olapEngineModule.fieldListData);u<c.length;u++){var m=c[u];m.spriteCssClass&&(m.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||m.spriteCssClass.indexOf("e-hierarchyCDB-icon")>-1)&&r.push({value:m.id,text:m.caption})}var f=new l.DropDownList({dataSource:t,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:0,cssClass:ot,width:"100%",change:function(e){v.enabled="Dimension"===e.value,v.dataBind()}});f.isStringTemplate=!0,f.appendTo(e.querySelector("#"+this.parentID+"Member_Type_Div"));var v=new l.DropDownList({dataSource:r,enableRtl:this.parent.enableRtl,allowFiltering:!0,enabled:!1,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+r[0].text.toString(),fields:{value:"value",text:"text"},index:0,cssClass:ot,width:"100%"});v.isStringTemplate=!0,v.appendTo(e.querySelector("#"+this.parentID+"Hierarchy_List_Div"));var y=new l.DropDownList({dataSource:i,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:0,cssClass:ot,width:"100%",change:function(e){S.enabled="Custom"===e.value,S.dataBind()}});y.isStringTemplate=!0,y.appendTo(e.querySelector("#"+this.parentID+"Format_Div"));var S=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("customFormat"),enabled:!1});S.isStringTemplate=!0,S.appendTo("#"+this.parentID+"Custom_Format_Element")},e.prototype.createTreeView=function(){var e=this;"olap"===this.parent.dataType?this.treeObj=new n.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeDragStart:this.dragStart.bind(this),nodeDragging:function(e){e.event.target&&e.event.target.classList.contains(st)?(t.removeClass([e.clonedNode],Re),t.addClass([e.event.target],"e-copy-drop")):(t.addClass([e.clonedNode],Re),t.removeClass([e.event.target],"e-copy-drop"),e.dropIndicator="e-no-drop",t.addClass([e.clonedNode.querySelector("."+K)],"e-icon-expandable"),t.removeClass([e.clonedNode.querySelector("."+K)],"e-list-icon"))},nodeClicked:this.fieldClickHandler.bind(this),nodeSelected:function(i){i.node.getAttribute("data-type")===$i?e.displayMenu(i.node):(t.removeClass([i.node],"e-active"),i.cancel=!0)},nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),sortOrder:"None"}):this.treeObj=new n.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),sortOrder:"Ascending"}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"tree")},e.prototype.updateNodeIcon=function(e){if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable.e-process")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var i=e.node.querySelector(".e-list-icon");t.removeClass([i],"e-folderCDB-icon"),t.addClass([i],"e-folderCDB-open-icon")}else if(e.node&&e.node.querySelector(".e-list-icon")&&e.node.querySelector(".e-icon-expandable")&&e.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1){i=e.node.querySelector(".e-list-icon");t.removeClass([i],"e-folderCDB-open-icon"),t.addClass([i],"e-folderCDB-icon")}else{for(var r=this.treeObj.fields.dataSource,a=[],n=0,o=r;n<o.length;n++){var l=o[n];l.pid===e.nodeData.id.toString()&&a.push(l)}if(0!==a.length)return;this.parent.olapEngineModule.calcChildMembers=[],this.parent.olapEngineModule.getCalcChildMembers(this.parent.dataSourceSettings,e.nodeData.id.toString()),a=this.parent.olapEngineModule.calcChildMembers,this.parent.olapEngineModule.calcChildMembers=[];for(var s=0,d=a;s<d.length;s++){(i=d[s]).pid=e.nodeData.id.toString(),i.hasChildren=!1,i.spriteCssClass="e-level-members",i.caption=""===i.caption?this.parent.localeObj.getConstant("blank"):i.caption,r.push(i)}this.treeObj.addNodes(a,e.node)}},e.prototype.nodeCollapsing=function(e){e.cancel=!0},e.prototype.dragStart=function(e){if("olap"===this.parent.dataType){(i=e.clonedNode)&&(i.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||i.querySelector(".e-dimensionCDB-icon,.e-attributeCDB-icon,.e-hierarchyCDB-icon")||i.querySelector(".e-level-members,.e-namedSetCDB-icon"))?(t.addClass([e.draggedNode.querySelector("."+Be)],je),t.addClass([i],"e-pivot-calc"),i.style.zIndex=(this.dialog.zIndex+1).toString(),i.style.display="inline"):e.cancel=!0}else if(e.event.target.classList.contains("e-drag")){t.addClass([e.draggedNode.querySelector("."+Be)],je);var i=e.clonedNode;t.addClass([i],"e-pivot-calc"),i.style.zIndex=(this.dialog.zIndex+1).toString(),i.style.display="inline"}else e.cancel=!0},e.prototype.drawTreeNode=function(e){if("olap"===this.parent.dataType){e.node.querySelector(".e-measure-icon")&&(e.node.querySelector(".e-list-icon").style.display="none");var i=e.nodeData;e.node.setAttribute("data-field",i.id),e.node.setAttribute("data-caption",i.caption);var r=e.node.querySelector("."+ke);if(e.nodeData&&e.nodeData.type===$i&&r&&e.node.querySelector(".e-list-icon.e-calc-member")){e.node.setAttribute("data-type",i.type),e.node.setAttribute("data-membertype",i.fieldType),e.node.setAttribute("data-hierarchy",i.parentHierarchy?i.parentHierarchy:""),e.node.setAttribute("data-formula",i.formula);var a=void 0;a=i.formatString?["Standard","Currency","Percent"].indexOf(i.formatString)>-1?i.formatString:"Custom":"",e.node.setAttribute("data-formatString",a),e.node.setAttribute("data-customString","Custom"===a?i.formatString:"")}if(this.parent.isAdaptive){var n=e.node.querySelector("."+ke);if(e.node&&e.node.querySelector(".e-list-icon")&&n){var o=e.node.querySelector(".e-list-icon");n.insertBefore(o,e.node.querySelector(".e-list-text"))}e.node&&e.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon")&&(e.node.querySelector(".e-checkbox-wrapper").style.display="none"),e.node&&e.node.querySelector(".e-level-members")&&(e.node.querySelector(".e-list-icon").style.display="none")}}else{i=e.nodeData.field;e.node.setAttribute("data-field",i),e.node.setAttribute("data-caption",e.nodeData.caption),e.node.setAttribute("data-type",e.nodeData.type);var l=t.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:K+" e-drag"});t.prepend([l],e.node.querySelector("."+ke)),t.append([e.node.querySelector("."+lt)],e.node.querySelector("."+ke)),"number"!==this.parent.engineModule.fieldList[i].type&&this.parent.engineModule.fieldList[i].aggregateType!==$i?t.removeClass([e.node.querySelector("."+lt)],K):e.node.querySelector("."+lt).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[i].aggregateType===$i&&(e.node.querySelector("."+lt).setAttribute("title",this.parent.localeObj.getConstant("edit")),t.addClass([e.node.querySelector("."+lt)],vt),t.removeClass([e.node.querySelector("."+lt)],lt))}},e.prototype.createTypeContainer=function(e){for(var i=t.createElement("div",{id:this.parentID+"control_wrapper",className:pt}),r=["Sum","Count","Avg","Min","Max","DistinctCount","Product","SampleStDev","PopulationStDev","SampleVar","PopulationVar"],a=0;a<r.length;a++){var n=t.createElement("input",{id:this.parentID+"radio"+r[a],attrs:{type:"radio","data-ftxt":e},className:"e-pivot-calc-radio"});i.appendChild(n)}return i},e.prototype.getAccordionData=function(e){var t=this,i=[];return Object.keys(e.engineModule.fieldList).forEach(function(r,a){i.push({header:"<input id="+t.parentID+"_"+a+' class=e-pivot-calc-check type="checkbox" data-field='+r+" data-caption="+t.parent.engineModule.fieldList[r].caption+" data-type="+t.parent.engineModule.fieldList[r].type+"/>",content:e.engineModule.fieldList[r].aggregateType===$i||"number"!==t.parent.engineModule.fieldList[r].type?"":t.createTypeContainer(r).outerHTML})}),i},e.prototype.renderMobileLayout=function(e){e.items[4].content=this.renderDialogElements().outerHTML,e.dataBind(),"olap"===this.parent.dataType&&this.parent.isAdaptive&&this.createOlapDropElements();var t=new c.Button({cssClass:"e-flat",isPrimary:!0});if(t.isStringTemplate=!0,t.appendTo("#"+this.parentID+"cancelBtn"),t.element&&(t.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+st)&&this.parent.isAdaptive){var i=new c.Button({cssClass:"e-flat e-outline",isPrimary:!0});if(i.isStringTemplate=!0,i.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),null!==this.formulaText&&null!==this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable")){this.parent.dialogRenderer.parentElement.querySelector("#"+this.parentID+"droppable").value=this.formulaText}null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+nt)&&(this.parent.dialogRenderer.parentElement.querySelector("."+nt).value=this.fieldText,this.inputObj.value=this.fieldText),i.element&&(i.element.onclick=this.applyFormula.bind(this))}else if(this.parent.isAdaptive){var r=new c.Button({cssClass:"e-flat",isPrimary:!0});if(r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"addBtn"),"olap"===this.parent.dataType)this.treeObj=new n.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,sortOrder:"None",enableRtl:this.parent.enableRtl,drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this)}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"accordDiv");else{var a=new n.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,expanding:this.accordionExpand.bind(this)});a.isStringTemplate=!0,a.appendTo("#"+this.parentID+"accordDiv"),Object.keys(this.parent.engineModule.fieldList).forEach(this.updateType.bind(this))}r.element&&(r.element.onclick=this.addBtnClick.bind(this))}},e.prototype.accordionExpand=function(e){var t=this;0===e.element.querySelectorAll(".e-radio-wrapper").length&&Object.keys(this.parent.engineModule.fieldList).forEach(function(i){var r,a=["Sum","Count","Avg","Min","Max","DistinctCount","Product","SampleStDev","PopulationStDev","SampleVar","PopulationVar"];if(i===e.element.querySelector("[data-field").getAttribute("data-field"))for(var n=0;n<a.length;n++)(r=new c.RadioButton({label:t.parent.localeObj.getConstant(a[n]),name:"AggregateType"+i,change:t.onChange.bind(t)})).isStringTemplate=!0,r.appendTo("#"+t.parentID+"radio"+a[n])})},e.prototype.onChange=function(e){var t=e.event.target.id.split(this.parent.element.id+"radio")[1],i=e.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");e.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")",e.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",t)},e.prototype.updateType=function(e,t){var i=null;i="string"===this.parent.engineModule.fieldList[e].type||"include"===this.parent.engineModule.fieldList[e].type||"exclude"===this.parent.engineModule.fieldList[e].type?"Count":void 0!==this.parent.engineModule.fieldList[e].aggregateType?this.parent.engineModule.fieldList[e].aggregateType:"Sum";var r=new c.CheckBox({label:this.parent.engineModule.fieldList[e].caption+" ("+i+")"});r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"_"+t),document.querySelector("#"+this.parentID+"_"+t).setAttribute("data-field",e),document.querySelector("#"+this.parentID+"_"+t).setAttribute("data-type",i)},e.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.addBtnClick=function(){var e="",t=null,i=null;if("pivot"===this.parent.dataType){for(var r=document.querySelectorAll(".e-accordion .e-check"),a=0;a<r.length;a++)if(t=r[a].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(i=r[a].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf($i))e=e+'"'+i+"("+t+')"';else for(var n=0;n<this.parent.dataSourceSettings.calculatedFieldSettings.length;n++)if(this.parent.dataSourceSettings.calculatedFieldSettings[n].name===t){e+=this.parent.dataSourceSettings.calculatedFieldSettings[n].formula;break}}else for(var o=this.treeObj.getAllCheckedNodes(),l=this.parent.olapEngineModule,s=0,d=o;s<d.length;s++){var p=d[s];e+=l.fieldList[p]&&l.fieldList[p].type===$i?l.fieldList[p].tag:p}this.formulaText=null!==this.formulaText?this.formulaText+e:e,this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},e.prototype.createCalculatedFieldDialog=function(){this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName()?this.renderAdaptiveLayout():this.parent.isAdaptive||(this.renderDialogLayout(),this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top)},e.prototype.renderDialogLayout=function(){this.newFields=t.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0),this.createDialog(),this.dialog.content=this.renderDialogElements(),this.dialog.refresh(),this.inputObj=new o.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName")}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),"olap"!==this.parent.dataType||this.parent.isAdaptive||this.createOlapDropElements(),this.createTreeView(),this.createMenu(),this.droppable=new t.Droppable(this.dialog.element.querySelector("#"+this.parentID+"droppable")),this.keyboardEvents=new t.KeyboardEvents(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter"},eventName:"keydown"})},e.prototype.createConfirmDialog=function(e,i){var a=t.createElement("div",{id:this.parentID+"_ErrorDialog",className:Me});this.parent.element.appendChild(a),this.confirmPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.replaceFormula.bind(this),buttonModel:{cssClass:we+" e-outline",content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.removeErrorDialog.bind(this),buttonModel:{cssClass:Te,content:this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)}),this.confirmPopUp.isStringTemplate=!0,this.confirmPopUp.appendTo(a)},e.prototype.replaceFormula=function(){var e=this.parent.dataSourceSettings,i=document.querySelector("#"+this.parentID+"droppable");if("olap"===this.parent.dataType){for(var r=this.dialog.element,a=t.getInstance(r.querySelector("#"+this.parentID+"Custom_Format_Element"),o.MaskedTextBox),n=t.getInstance(r.querySelector("#"+this.parentID+"Format_Div"),l.DropDownList),s=t.getInstance(r.querySelector("#"+this.parentID+"Member_Type_Div"),l.DropDownList),d=t.getInstance(r.querySelector("#"+this.parentID+"Hierarchy_List_Div"),l.DropDownList),p=0;p<e.calculatedFieldSettings.length;p++)if(e.calculatedFieldSettings[p].name===this.inputObj.value){"Dimension"===s.value&&(e.calculatedFieldSettings[p].hierarchyUniqueName=d.value),e.calculatedFieldSettings[p].formatString="Custom"===n.value?a.value:n.value,e.calculatedFieldSettings[p].formula=i.value,this.parent.lastCalcFieldInfo=e.calculatedFieldSettings[p];break}}else for(var h=0;h<e.values.length;h++)if(e.values[h].type===$i&&e.values[h].name===this.inputObj.value)for(p=0;p<e.calculatedFieldSettings.length;p++)e.calculatedFieldSettings[p].name===this.inputObj.value&&(e.calculatedFieldSettings[p].formula=i.value,this.parent.lastCalcFieldInfo=e.calculatedFieldSettings[p]);this.addFormula(e,this.inputObj.value),this.removeErrorDialog()},e.prototype.removeErrorDialog=function(){document.getElementById(this.parentID+"_ErrorDialog")&&t.remove(document.getElementById(this.parentID+"_ErrorDialog").parentElement)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(G,this.createCalculatedFieldDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(G,this.createCalculatedFieldDialog)},e.prototype.destroy=function(){this.removeEventListener()},e}();Ji.Inject(er);var tr=function(){function e(e){this.parent=e,this.addEventListener()}return e.prototype.getModuleName=function(){return"fieldlist"},e.prototype.initiateModule=function(){this.element=t.createElement("div",{id:this.parent.element.id+"_PivotFieldList",styles:"position:"+(this.parent.enableRtl?"static":"absolute")+";height:0;width:"+this.parent.element.style.width+";display:none"}),this.parent.element.parentElement.setAttribute("id","ContainerWrapper"),this.parent.element.parentElement.appendChild(this.element),this.parent.element.parentElement.appendChild(this.parent.element),this.parent.pivotFieldListModule=new Ji({dataSourceSettings:{dataProviderType:this.parent.dataSourceSettings.dataProviderType,rows:[],columns:[],values:[],filters:[]},spinnerTemplate:this.parent.spinnerTemplate,allowDeferLayoutUpdate:this.parent.allowDeferLayoutUpdate,renderMode:"Popup",allowCalculatedField:this.parent.allowCalculatedField,showValuesButton:this.parent.showValuesButton,enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:this.parent.element.parentElement,maxNodeLimitInMemberEditor:this.parent.maxNodeLimitInMemberEditor,aggregateCellInfo:this.parent.bindTriggerEvents.bind(this.parent)}),this.parent.pivotFieldListModule.appendTo("#"+this.element.id)},e.prototype.updateControl=function(){this.element&&(this.element.style.display="block",t.prepend([this.element],this.parent.element),this.parent.showGroupingBar&&this.parent.groupingBarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.update.bind(this))):(t.setStyleAttribute(this.element.querySelector("."+ee),{left:"auto"}),this.parent.enableRtl?t.removeClass([this.element.querySelector("."+ee)],"e-fieldlist-left"):t.addClass([this.element.querySelector("."+ee)],"e-fieldlist-left")),t.setStyleAttribute(this.element,{width:t.formatUnit(this.parent.element.offsetWidth)})),this.parent.pivotFieldListModule.update(this.parent)},e.prototype.update=function(){var e;if(e="Table"!==this.parent.currentView?this.parent.chart?this.parent.chartModule.calculatedWidth:e:this.parent.grid?this.parent.grid.element.offsetWidth:e){var i=e<400?400:e;t.setStyleAttribute(this.element.querySelector("."+ee),{left:t.formatUnit(this.parent.enableRtl?-Math.abs(i-this.element.querySelector("."+ee).offsetWidth):i-this.element.querySelector("."+ee).offsetWidth)}),this.parent.enableRtl?t.addClass([this.element.querySelector("."+ee)],"e-fieldlist-left"):t.removeClass([this.element.querySelector("."+ee)],"e-fieldlist-left")}},e.prototype.addEventListener=function(){this.handlers={load:this.initiateModule,update:this.updateControl},this.parent.isDestroyed||(this.parent.on(_,this.handlers.load,this),this.parent.on(k,this.handlers.update,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(_,this.handlers.load),this.parent.off(k,this.handlers.update))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.destroy()},e}(),ir=function(){function e(e){this.parent=e,this.parent.commonModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"common"},e.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=t.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj,this.parent.pivotCommon.dataType=this.parent.dataType;else{var e={pivotEngine:"olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,isAdaptive:t.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj,dataType:this.parent.dataType};this.parent.pivotCommon=new Ui(e)}this.parent.pivotCommon.control=this.parent},e.prototype.addEventListener=function(){this.handlers={load:this.initiateCommonModule},this.parent.isDestroyed||(this.parent.gridSettings.contextMenuItems&&(this.parent.showFieldList&&this.parent.showGroupingBar||this.parent.on(j,this.handlers.load,this)),this.parent.on(k,this.handlers.load,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(k,this.handlers.load)},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotCommon&&this.parent.pivotCommon.destroy()},e}(),rr=function(){function e(e){this.parent=e}return e.prototype.render=function(){this.pivotButton=new Qi(this.parent),this.createPivotButtons();for(var e=[],i=0,r=this.parent.element.querySelectorAll("."+Ie);i<r.length;i++){var a=r[i];a.classList.contains(_t)||(e=e.concat([].slice.call(a.querySelectorAll("."+de))))}for(var n=e.length,o=0;o<n;o++){var l=t.createElement("span",{className:"e-indent-div",styles:"width:"+24*o+"px"});t.prepend([l],e[o])}},e.prototype.createPivotButtons=function(){for(var e=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],t=0,i=this.parent.element.querySelectorAll("."+Ie+",."+Ae+",."+Fe+",."+qe);t<i.length;t++){var r=i[t];this.parent.dataSourceSettings.values.length>0&&r.classList.contains(Bt)||(r.innerHTML="")}for(var a=["rows","columns","values","filters"],n=0,o=e.length;n<o;n++)if(e[n]){var l={field:e[n],axis:a[n].toString()};this.parent.notify(U,l)}},e}();Ri.Inject(ir);var ar=function(){function e(e){this.parent=e,this.parent.groupingBarModule=this,this.resColWidth=this.parent.isAdaptive?180:249,this.addEventListener(),this.parent.axisFieldModule=new rr(this.parent),this.touchObj=new t.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return e.prototype.getModuleName=function(){return"grouping"},e.prototype.renderLayout=function(){this.groupingTable=t.createElement("div",{className:Ne}),this.leftAxisPanel=t.createElement("div",{className:ne}),this.rightAxisPanel=t.createElement("div",{className:oe});var e=t.createElement("div",{className:"e-axis-row e-axiswrapper"}),i=t.createElement("div",{className:"e-axis-column e-axiswrapper"}),r=t.createElement("div",{className:"e-axis-value e-axiswrapper"}),a=t.createElement("div",{className:"e-axis-filter e-axiswrapper"});this.rowPanel=t.createElement("div",{className:Ie+" "+Ee}),this.columnPanel=t.createElement("div",{className:Ae+" "+Le}),this.valuePanel=t.createElement("div",{className:Fe+" "+Oe}),this.filterPanel=t.createElement("div",{className:qe+" "+Pe}),e.appendChild(this.rowPanel),i.appendChild(this.columnPanel),r.appendChild(this.valuePanel),a.appendChild(this.filterPanel),this.rowAxisPanel=e,this.columnAxisPanel=i,this.valueAxisPanel=r,this.filterAxisPanel=a,this.leftAxisPanel.appendChild(r),this.leftAxisPanel.appendChild(e),this.rightAxisPanel.appendChild(a),this.rightAxisPanel.appendChild(i),this.groupingTable.appendChild(this.leftAxisPanel),this.groupingTable.appendChild(this.rightAxisPanel),this.groupingTable.classList.add(Qt);for(var n=0,o=[this.rowPanel,this.columnPanel,this.valuePanel,this.filterPanel];n<o.length;n++){var l=o[n];this.parent.groupingBarSettings.allowDragAndDrop&&new t.Droppable(l,{}),this.unWireEvent(l),this.wireEvent(l)}"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode?(this.groupingChartTable=this.groupingTable.cloneNode(!0),this.groupingChartTable.classList.add("e-chart-grouping-bar"),this.groupingChartTable.classList.remove(Qt),this.groupingChartTable.querySelector("."+Ie).classList.add(_t),this.groupingChartTable.querySelector("."+Ae).classList.add("e-group-chart-columns"),this.parent.chartSettings.enableMultiAxis?this.groupingChartTable.querySelector("."+Fe).classList.add("e-group-chart-multi-values"):(this.groupingChartTable.querySelector("."+Fe).classList.add(Bt),this.groupingChartTable.querySelector("."+Fe).classList.remove(De)),this.groupingChartTable.querySelector("."+qe).classList.add("e-group-chart-filters")):this.groupingChartTable=void 0,"Chart"!==this.parent.displayOption.view&&"Chart"!==this.parent.groupingBarSettings.displayMode||(this.groupingTable=void 0)},e.prototype.appendToElement=function(){if((this.parent.element.querySelector(".e-grid")||this.parent.element.querySelector("."+Vt))&&this.parent.showGroupingBar){if(this.parent.element.querySelector("."+Ne))for(var e=0,i=this.parent.element.querySelectorAll("."+Ne);e<i.length;e++){var r=i[e];t.remove(r)}if(this.groupingChartTable&&(this.parent.element.querySelector("#"+this.parent.element.id+"_chart")?(t.setStyleAttribute(this.groupingChartTable,{width:t.formatUnit(this.parent.chart.width)}),this.parent.element.insertBefore(this.groupingChartTable,this.parent.element.querySelector("#"+this.parent.element.id+"_chart"))):this.groupingChartTable=void 0),"Chart"!==this.parent.displayOption.view&&this.groupingTable){this.parent.isAdaptive&&(this.leftAxisPanel.style.minWidth="180px",this.valuePanel.style.minWidth="180px"),this.parent.firstColWidth&&(this.leftAxisPanel.style.minWidth="auto",this.valuePanel.style.minWidth="auto"),this.filterPanel.removeAttribute("style"),this.columnPanel.removeAttribute("style"),this.rowPanel.removeAttribute("style"),this.filterPanel.removeAttribute("style");if("olap"===this.parent.dataType?Object.keys(this.parent.olapEngineModule.headerContent).length:Object.keys(this.parent.engineModule.headerContent).length){var a=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([a],"e-row"),a.removeAttribute("style"),t.addClass([a.querySelector(".e-headercell")],"e-group-row"),a.querySelector(".e-group-row").appendChild(this.rowAxisPanel),a.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",a.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none"}this.parent.element.insertBefore(this.groupingTable,this.parent.element.querySelector(".e-grid")),t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.grid.width)}),this.groupingTable.style.minWidth="400px",this.parent.axisFieldModule.render(),this.setGridRowWidth();var n=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],o=t.formatUnit(this.groupingTable.offsetWidth-parseInt(n.style.width,10));t.setStyleAttribute(this.valuePanel,{width:n.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:o});var l=this.valuePanel.offsetHeight/2;l>this.columnPanel.offsetHeight&&(t.setStyleAttribute(this.filterPanel,{height:t.formatUnit(l)}),t.setStyleAttribute(this.columnPanel,{height:t.formatUnit(l+1)}));var s=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:s+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=s+"px");for(var d=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),p=s/d.length,h=0,u=d;h<u.length;h++){r=u[h];t.setStyleAttribute(r,{height:p+"px"});for(var c=0,g=[].slice.call(r.querySelectorAll(".e-rhandler"));c<g.length;c++){var m=g[c];t.setStyleAttribute(m,{height:p+"px"})}}}else this.parent.axisFieldModule.render();this.parent.showToolbar&&"Both"===this.parent.displayOption.view&&("Table"===this.parent.currentView?this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none":this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none")}},e.prototype.refreshUI=function(){t.setStyleAttribute(this.groupingTable,{width:t.formatUnit(this.parent.grid.width)}),this.groupingTable.style.minWidth="400px";var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],i=t.formatUnit(this.groupingTable.offsetWidth-parseInt(e.style.width,10));if(t.setStyleAttribute(this.valuePanel,{width:e.style.width}),t.setStyleAttribute(this.rightAxisPanel,{width:i}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this))),!this.parent.grid.element.querySelector(".e-group-row")){var r=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");t.addClass([r],"e-row"),t.addClass([r.querySelector(".e-headercell")],"e-group-row"),t.setStyleAttribute(this.rowPanel,{height:this.parent.element.querySelector(".e-headercontent").offsetHeight+"px"}),r.querySelector(".e-group-row").appendChild(this.rowAxisPanel),t.setStyleAttribute(r.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"}),t.setStyleAttribute(r.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});var a=this.parent.element.querySelector(".e-headercontent").offsetHeight;t.setStyleAttribute(this.rowPanel,{height:a+"px"}),this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=a+"px");for(var n=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(e){return e.childNodes.length>0}),o=a/n.length,l=0,s=n;l<s.length;l++){var d=s[l];t.setStyleAttribute(d,{height:o+"px"});for(var p=0,h=[].slice.call(d.querySelectorAll(".e-rhandler"));p<h.length;p++){var u=h[p];t.setStyleAttribute(u,{height:o+"px"})}}}},e.prototype.alignIcon=function(){var e,i=this.parent.pivotFieldListModule.element;if(e="Table"===this.parent.currentView?this.parent.grid?this.parent.grid.element.offsetWidth:e:this.parent.chart?this.parent.chartModule.calculatedWidth:e){var r=e<400?400:e;t.setStyleAttribute(i.querySelector("."+ee),{left:t.formatUnit(this.parent.enableRtl?-Math.abs(r-i.querySelector("."+ee).offsetWidth):r-i.querySelector("."+ee).offsetWidth)})}},e.prototype.setGridRowWidth=function(){var e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];if(this.rowPanel.querySelector("."+pe))if(this.parent.isAdaptive){if(!this.parent.firstColWidth){(i=this.parent.grid.columns)&&i.length>0&&(i[0].width=this.resColWidth),this.parent.posCount=0,this.parent.grid.headerModule.refreshUI()}}else{var i,r=[].slice.call(this.rowPanel.querySelectorAll("."+de)),a=r[r.length-1],n=a.querySelector("."+pe).offsetWidth+a.querySelector(".e-indent-div").offsetWidth+20,o=t.formatUnit(n<this.resColWidth?this.resColWidth:n),l=this.parent.element.querySelector(".e-frozenheader").querySelector("table"),s=this.parent.element.querySelector(".e-frozencontent").querySelector("table"),d=this.parent.element.querySelector(".e-frozencontent").querySelector("colgroup").children[0],p=parseInt(o,10);(i=this.parent.grid.columns)&&i.length>0&&(i[0].width=(i[0].width,this.resColWidth,p>this.resColWidth?p:this.resColWidth));var h=void 0;h="olap"===this.parent.dataType?this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.olapEngineModule.pivotValues.length>0?this.parent.olapEngineModule.pivotValues[0].length:2):this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.engineModule.pivotValues.length>0?this.parent.engineModule.pivotValues[0].length:2);for(var u=0;u<i.length;u++)if(0!==u)if(i[u].columns)this.setColWidth(i[u].columns,h);else if(i[u].width=h,"auto"!==i[u].width){var c=i[u].customAttributes?i[u].customAttributes.cell.valueSort.levelName:"";i[u].width=this.parent.renderModule.setSavedWidth(c,h)}else i[u].minWidth=h;this.parent.posCount=0,this.parent.setGridColumns(this.parent.grid.columns),this.parent.grid.headerModule.refreshUI(),this.parent.firstColWidth||(e.style.width=o,d.style.width=o,l.style.width=o,s.style.width=o,t.setStyleAttribute(l,{width:o}),t.setStyleAttribute(s,{width:o}))}else this.parent.grid.columns&&this.parent.grid.columns.length>0&&(this.parent.grid.columns[0].width=this.parent.grid.columns[0].width>this.resColWidth?this.parent.grid.columns[0].width:this.resColWidth),this.parent.grid.headerModule.refreshUI();this.groupingTable&&this.refreshUI()},e.prototype.setColWidth=function(e,t){for(var i=0;i<e.length;i++)e[i].columns?this.setColWidth(e[i].columns,t):e[i].width=t},e.prototype.wireEvent=function(e){t.EventHandler.add(e,"mouseover",this.dropIndicatorUpdate,this),t.EventHandler.add(e,"mouseleave",this.dropIndicatorUpdate,this)},e.prototype.unWireEvent=function(e){t.EventHandler.remove(e,"mouseover",this.dropIndicatorUpdate),t.EventHandler.remove(e,"mouseleave",this.dropIndicatorUpdate)},e.prototype.dropIndicatorUpdate=function(e){(this.parent.isDragging&&e.target.classList.contains(De)&&"mouseover"===e.type||"mouseleave"===e.type)&&(t.removeClass([].slice.call(this.parent.element.querySelectorAll("."+fe)),ve),t.removeClass([].slice.call(this.parent.element.querySelectorAll("."+fe+"-last")),ve))},e.prototype.tapHoldHandler=function(e){var i=t.closest(e.originalEvent.target,"."+pe);if(!t.isNullOrUndefined(i)&&this.parent.isAdaptive){var r=i.getBoundingClientRect();return this.parent.contextMenuModule.fieldElement=i,void this.parent.contextMenuModule.menuObj.open(r.top,r.left)}},e.prototype.addEventListener=function(){this.handlers={load:this.renderLayout,end:this.appendToElement},this.parent.isDestroyed||(this.parent.on(_,this.handlers.load,this),this.parent.on(k,this.handlers.end,this))},e.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(_,this.handlers.end),this.parent.off(k,this.handlers.load))},e.prototype.destroy=function(){this.removeEventListener(),this.parent.pivotButtonModule&&(this.parent.pivotButtonModule.destroy(),this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy())},e}(),nr=function(){function e(e){this.parent=e,this.parent.conditionalFormattingModule=this,this.parentID=this.parent.element.id,this.dialog=null,this.fieldsDropDown=[],this.conditionsDropDown=[],this.fontNameDropDown=[],this.fontSizeDropDown=[],this.fontColor=[],this.backgroundColor=[],this.newFormat=[]}return e.prototype.getModuleName=function(){return"conditionalformatting"},e.prototype.createDialog=function(){null!==document.querySelector("#"+this.parentID+"conditionalformatting")&&t.remove(document.querySelector("#"+this.parentID+"conditionalformatting")),this.parent.element.appendChild(t.createElement("div",{id:this.parentID+"conditionalformatting"}));var e=[{click:this.addButtonClick.bind(this),buttonModel:{cssClass:this.parent.isAdaptive?"e-small e-round "+Ct:Ct,iconCss:K+" "+_e,content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:this.applyButtonClick.bind(this),buttonModel:{cssClass:ae+" e-format-apply-button",content:this.parent.localeObj.getConstant("apply")}},{click:this.cancelButtonClick.bind(this),buttonModel:{cssClass:ae+" e-format-cancel-button",content:this.parent.localeObj.getConstant("cancel")}}];this.parent.isAdaptive?this.dialog=new r.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,position:{X:"center",Y:"center"},allowDragging:!0,buttons:e,beforeOpen:this.beforeOpen.bind(this),cssClass:bt,header:this.parent.localeObj.getConstant("conditionalFormating"),target:document.body}):this.dialog=new r.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:e,beforeOpen:this.beforeOpen.bind(this),cssClass:bt,isModal:!1,closeOnEscape:!0,enableRtl:this.parent.enableRtl,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormating"),target:this.parent.element}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parentID+"conditionalformatting")},e.prototype.beforeOpen=function(e){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("conditionalFormating"))},e.prototype.addButtonClick=function(){var e={conditions:"LessThan",value1:0,applyToGrandTotals:!0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}};this.parent.trigger(R,e),this.refreshConditionValues(),this.newFormat.push(e),this.addFormat()},e.prototype.applyButtonClick=function(){this.refreshConditionValues()&&(this.parent.setProperties({dataSourceSettings:{conditionalFormatSettings:this.newFormat}},!0),this.parent.renderPivotGrid(),this.destroy())},e.prototype.cancelButtonClick=function(){this.destroy(),this.newFormat=[]},e.prototype.refreshConditionValues=function(){for(var e=0;e<this.newFormat.length;e++){if(""===document.querySelector("#"+this.parentID+"conditionvalue1"+e).value||""===document.querySelector("#"+this.parentID+"conditionvalue2"+e).value)return""===document.querySelector("#"+this.parentID+"conditionvalue1"+e).value?document.querySelector("#"+this.parentID+"conditionvalue1"+e).focus():document.querySelector("#"+this.parentID+"conditionvalue2"+e).focus(),!1;this.newFormat[e].value1=Number(document.querySelector("#"+this.parentID+"conditionvalue1"+e).value),this.newFormat[e].value2=Number(document.querySelector("#"+this.parentID+"conditionvalue2"+e).value)}return!0},e.prototype.addFormat=function(){for(var e=t.createElement("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),i=0;i<this.newFormat.length;i++)e.appendChild(this.createDialogElements(i));if(0===this.newFormat.length){var r=this.createDialogElements(),a=t.createElement("p",{id:this.parentID+"emptyFormat",innerHTML:this.parent.localeObj.getConstant("emptyFormat"),styles:"margin: 10px"});r.appendChild(a),e.appendChild(r)}this.dialog.setProperties({content:e},!1);for(i=0;i<this.newFormat.length;i++)this.renderDropDowns(i),this.renderColorPicker(i)},e.prototype.createDialogElements=function(e){var i=t.createElement("div",{id:this.parentID+"outerDiv"+e,className:"e-format-outer-div"});if(void 0!==e){var r=this.newFormat[e],a=t.createElement("button",{id:this.parentID+"removeButton"+e,className:"e-format-delete-button",attrs:{title:this.parent.localeObj.getConstant("delete")}});i.appendChild(a);var n=t.createElement("div",{id:this.parentID+"innerDiv",className:"e-format-inner-div"}),o=t.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"}),l=t.createElement("tr"),s=t.createElement("td"),d=t.createElement("span",{id:this.parentID+"valuelabel"+e,className:"e-format-value-label",innerHTML:this.parent.localeObj.getConstant("value")});s.appendChild(d),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var p=t.createElement("div",{id:this.parentID+"measure"+e}),h=t.createElement("input",{id:this.parentID+"measureinput"+e,attrs:{type:"text",tabindex:"1"}});p.appendChild(h),s.appendChild(p),l.appendChild(s),s=t.createElement("td");var u=t.createElement("div",{id:this.parentID+"condition"}),c=t.createElement("input",{id:this.parentID+"conditioninput"+e,attrs:{type:"text",tabindex:"1"}});u.appendChild(c),s.appendChild(u),l.appendChild(s),s=t.createElement("td");var g="Between"!==r.conditions&&"NotBetween"!==r.conditions?"display:none; width:10px":"",m=t.createElement("input",{id:this.parentID+"conditionvalue1"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(r.value1)?"0":r.value1.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive?""===g?"width: 35%":"width: 100%":""===g?"width: 45px":"width: 120px",className:xt+" e-format-value1"});s.appendChild(m);var f=t.createElement("span",{id:this.parentID+"valuespan"+e,className:"e-format-value-span",innerHTML:"&",styles:g});s.appendChild(f);var v=t.createElement("input",{id:this.parentID+"conditionvalue2"+e,attrs:{type:"text",tabindex:"1",value:t.isNullOrUndefined(r.value2)?"0":r.value2.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive&&""===g?"width: 35%":""===g?"width: 45px":g,className:xt+" e-format-value2"});s.appendChild(v),l.appendChild(s),o.appendChild(l),this.parent.isAdaptive&&(n.appendChild(o),o=t.createElement("table",{id:this.parentID+"cftable",className:"e-format-table"})),l=t.createElement("tr"),s=t.createElement("td");var y=t.createElement("span",{id:this.parentID+"formatlabel"+e,className:"e-format-label",innerHTML:this.parent.localeObj.getConstant("formatLabel")});s.appendChild(y),l.appendChild(s),o.appendChild(l),l=t.createElement("tr"),s=t.createElement("td");var S=t.createElement("div",{id:this.parentID+"fontname"}),b=t.createElement("input",{id:this.parentID+"fontnameinput"+e,attrs:{type:"text",tabindex:"1"}});S.appendChild(b),s.appendChild(S),l.appendChild(s),s=t.createElement("td");var C=t.createElement("div",{id:this.parentID+"fontsize"}),x=t.createElement("input",{id:this.parentID+"fontsizeinput"+e,attrs:{type:"text",tabindex:"1"}});C.appendChild(x),s.appendChild(C),l.appendChild(s),this.parent.isAdaptive&&(o.appendChild(l),l=t.createElement("tr"),o.appendChild(l),l=t.createElement("tr")),s=t.createElement("td");var w=t.createElement("input",{id:this.parentID+"fontcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-font-color"});s.appendChild(w);var T=t.createElement("input",{id:this.parentID+"backgroundcolor"+e,attrs:{type:"color",tabindex:"1"},className:"e-format-back-color"});s.appendChild(T),l.appendChild(s),s=t.createElement("td");var M=t.createElement("div",{id:this.parentID+"valuepreview"+e,className:xt+" e-format-value-preview",innerHTML:"123.45"});s.appendChild(M),l.appendChild(s),o.appendChild(l),n.appendChild(o),i.appendChild(n)}return i},e.prototype.renderDropDowns=function(e){var i=this.newFormat[e],r=[];r.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var a=0;a<this.parent.dataSourceSettings.values.length;a++)r.push({index:a+1,name:this.parent.dataSourceSettings.values[a].caption||this.parent.dataSourceSettings.values[a].name,field:this.parent.dataSourceSettings.values[a].name});var n=t.isNullOrUndefined(i.measure)?this.parent.localeObj.getConstant("AllValues"):i.measure;this.fieldsDropDown[e]=new l.DropDownList({dataSource:r,fields:{text:"name",value:"field"},value:n,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.measureChange.bind(this,e)}),this.fieldsDropDown[e].isStringTemplate=!0,this.fieldsDropDown[e].appendTo("#"+this.parentID+"measureinput"+e);var o=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];n=t.isNullOrUndefined(i.conditions)?"LessThan":i.conditions,this.conditionsDropDown[e]=new l.DropDownList({dataSource:o,fields:{value:"value",text:"name"},value:n,width:this.parent.isAdaptive?"100%":"120px",popupHeight:"200px",popupWidth:"auto",change:this.conditionChange.bind(this,e)}),this.conditionsDropDown[e].isStringTemplate=!0,this.conditionsDropDown[e].appendTo("#"+this.parentID+"conditioninput"+e);n=t.isNullOrUndefined(i.style.fontFamily)?"Arial":i.style.fontFamily,this.fontNameDropDown[e]=new l.DropDownList({dataSource:[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}],fields:{text:"name"},value:n,width:this.parent.isAdaptive?"100%":"120px",popupWidth:"150px",popupHeight:"200px",change:this.fontNameChange.bind(this,e)}),this.fontNameDropDown[e].isStringTemplate=!0,this.fontNameDropDown[e].appendTo("#"+this.parentID+"fontnameinput"+e);n=t.isNullOrUndefined(i.style.fontSize)?"12px":i.style.fontSize,this.fontSizeDropDown[e]=new l.DropDownList({dataSource:[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}],fields:{text:"name"},popupHeight:"200px",value:n,width:this.parent.isAdaptive?"100%":"120px",change:this.fontSizeChange.bind(this,e)}),this.fontSizeDropDown[e].isStringTemplate=!0,this.fontSizeDropDown[e].appendTo("#"+this.parentID+"fontsizeinput"+e)},e.prototype.conditionChange=function(e,t){this.newFormat[e].conditions=t.value,"Between"===t.value||"NotBetween"===t.value?(document.querySelector("#"+this.parentID+"valuespan"+e).style.display="inline-block",document.querySelector("#"+this.parentID+"valuespan"+e).style.width=this.parent.isAdaptive?"10%":"10px",document.querySelector("#"+this.parentID+"conditionvalue2"+e).style.display="inline-block",document.querySelector("#"+this.parentID+"conditionvalue2"+e).style.width=this.parent.isAdaptive?"35%":"45px",document.querySelector("#"+this.parentID+"conditionvalue1"+e).style.width=this.parent.isAdaptive?"35%":"45px"):(document.querySelector("#"+this.parentID+"valuespan"+e).style.display="none",document.querySelector("#"+this.parentID+"conditionvalue2"+e).style.display="none",document.querySelector("#"+this.parentID+"conditionvalue1"+e).style.width=this.parent.isAdaptive?"100%":"120px")},e.prototype.fontNameChange=function(e,t){this.newFormat[e].style.fontFamily=t.value.toString(),document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontFamily=t.value},e.prototype.fontSizeChange=function(e,t){this.newFormat[e].style.fontSize=t.value.toString(),document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontSize=t.value},e.prototype.measureChange=function(e,t){this.newFormat[e].measure=t.value.toString()===this.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()},e.prototype.renderColorPicker=function(e){var i=this.newFormat[e],r=t.isNullOrUndefined(i.style.color)?"black":i.style.color,a=this.isHex(r.substr(1))?r:this.colourNameToHex(r);document.querySelector("#"+this.parentID+"valuepreview"+e).style.color=a,this.fontColor[e]=new o.ColorPicker({cssClass:wt,value:a,mode:"Palette",change:this.fontColorChange.bind(this,e)}),this.fontColor[e].isStringTemplate=!0,this.fontColor[e].appendTo("#"+this.parentID+"fontcolor"+e),t.addClass([this.fontColor[e].element.nextElementSibling.querySelector(".e-selected-color")],K),r=t.isNullOrUndefined(i.style.backgroundColor)?"white":i.style.backgroundColor,a=this.isHex(r.substr(1))?r:this.colourNameToHex(r),document.querySelector("#"+this.parentID+"valuepreview"+e).style.backgroundColor=a,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontFamily=i.style.fontFamily,document.querySelector("#"+this.parentID+"valuepreview"+e).style.fontSize=i.style.fontSize,this.backgroundColor[e]=new o.ColorPicker({cssClass:wt,value:a,mode:"Palette",change:this.backColorChange.bind(this,e)}),this.backgroundColor[e].isStringTemplate=!0,this.backgroundColor[e].appendTo("#"+this.parentID+"backgroundcolor"+e),t.addClass([this.backgroundColor[e].element.nextElementSibling.querySelector(".e-selected-color")],K);var n=new c.Button({iconCss:K+" e-format-delete-icon",cssClass:"e-flat"});n.isStringTemplate=!0,n.appendTo("#"+this.parentID+"removeButton"+e),n.element.onclick=this.toggleButtonClick.bind(this,e)},e.prototype.backColorChange=function(e,t){this.newFormat[e].style.backgroundColor=t.currentValue.hex,document.querySelector("#"+this.parentID+"valuepreview"+e).style.backgroundColor=t.currentValue.hex},e.prototype.fontColorChange=function(e,t){this.newFormat[e].style.color=t.currentValue.hex,document.querySelector("#"+this.parentID+"valuepreview"+e).style.color=t.currentValue.hex},e.prototype.toggleButtonClick=function(e){this.newFormat.splice(e,1),this.addFormat()},e.prototype.isHex=function(e){for(var t=parseInt(e,16);"0"===e.charAt(0);)e=e.substr(1);return t.toString(16)===e.toLowerCase()||0===t&&""===e},e.prototype.hexToRgb=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},e.prototype.colourNameToHex=function(e){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return void 0!==t[e.toLowerCase()]?t[e.toLowerCase()]:"#d5d5d5"},e.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var e=0;e<this.parent.dataSourceSettings.conditionalFormatSettings.length;e++)this.newFormat.push(t.extend({},this.parent.dataSourceSettings.conditionalFormatSettings[e].properties,null,!0));this.createDialog(),this.dialog.refresh(),this.addFormat()},e.prototype.destroy=function(){if(this.dialog&&!this.dialog.isDestroyed){this.dialog.hide();for(var e=0;e<this.newFormat.length;e++)this.fontColor[e]&&!this.fontColor[e].isDestroyed&&this.fontColor[e].destroy(),this.backgroundColor[e]&&!this.backgroundColor[e].isDestroyed&&this.backgroundColor[e].destroy();this.dialog.destroy()}},e}();Ri.Inject(ir);var or=function(){function e(e){this.currentReport="",this.parent=e,this.parent.toolbarModule=this,this.addEventListener()}return e.prototype.getModuleName=function(){return"toolbar"},e.prototype.createToolbar=function(){this.parent.isModified=!1,this.renderDialog(),null!==document.querySelector("#"+this.parent.element.id+"pivot-toolbar")&&t.remove(document.querySelector("#"+this.parent.element.id+"pivot-toolbar"));var e=t.createElement("div",{id:this.parent.element.id+"pivot-toolbar",className:"e-pivot-toolbar"});this.parent.showFieldList&&this.parent.element.querySelector("#"+this.parent.element.id+"_PivotFieldList")?this.parent.element.insertBefore(e,this.parent.element.querySelector("#"+this.parent.element.id+"_PivotFieldList")):this.parent.showGroupingBar&&this.parent.element.querySelector("#"+this.parent.element.id+" .e-pivot-grouping-bar")?this.parent.element.insertBefore(e,this.parent.element.querySelector("#"+this.parent.element.id+" .e-pivot-grouping-bar")):this.parent.element.insertBefore(e,this.parent.element.querySelector("#"+this.parent.element.id+"_grid")),this.toolbar=new n.Toolbar({created:this.create.bind(this),enableRtl:this.parent.enableRtl,width:this.parent.width?Number(this.parent.width)-2:Number(this.parent.element.offsetWidth)-2,items:this.getItems()}),this.toolbar.isStringTemplate=!0,this.toolbar.appendTo("#"+this.parent.element.id+"pivot-toolbar")},e.prototype.fetchReports=function(){var e={reportName:[]};return this.parent.trigger("fetchReport",e),e},e.prototype.getItems=function(){for(var e=[],t=0,i=this.parent.toolbar.filter(function(e,t,i){return i.indexOf(e)===t});t<i.length;t++){switch(i[t]){case"New":e.push({prefixIcon:"e-new-report "+K,tooltipText:this.parent.localeObj.getConstant("new"),click:this.actionClick.bind(this),id:this.parent.element.id+"new"});break;case"Save":e.push({prefixIcon:"e-save-report "+K,tooltipText:this.parent.localeObj.getConstant("save"),click:this.actionClick.bind(this),id:this.parent.element.id+"save"});break;case"SaveAs":e.push({prefixIcon:"e-saveas-report "+K,tooltipText:this.parent.localeObj.getConstant("saveAs"),click:this.actionClick.bind(this),id:this.parent.element.id+"saveas"});break;case"Rename":e.push({prefixIcon:"e-rename-report "+K,tooltipText:this.parent.localeObj.getConstant("rename"),click:this.actionClick.bind(this),id:this.parent.element.id+"rename"});break;case"Remove":e.push({prefixIcon:"e-remove-report "+K,tooltipText:this.parent.localeObj.getConstant("deleteReport"),click:this.actionClick.bind(this),id:this.parent.element.id+"remove"});break;case"Load":e.push({template:"<div><input class=e-load-report id="+this.parent.element.id+"_reportlist></input></div>",click:this.actionClick.bind(this),id:this.parent.element.id+"load"});break;case"Grid":var r="Chart"===this.parent.displayOption.view;e.push({prefixIcon:"e-toolbar-grid "+K,tooltipText:this.parent.localeObj.getConstant("grid"),id:this.parent.element.id+"grid",cssClass:r?gt:"",click:this.menuItemClick.bind(this)});break;case"Chart":e.push({template:'<ul id="'+this.parent.element.id+'chart_menu"></ul>',id:this.parent.element.id+"chartmenu"});break;case"MDX":"olap"==this.parent.dataType&&e.push({prefixIcon:"e-mdx "+K,id:this.parent.element.id+"mdxQuery",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("mdxQuery")});break;case"Export":e.push({template:'<ul id="'+this.parent.element.id+'export_menu"></ul>',id:this.parent.element.id+"exportmenu"});break;case"SubTotal":e.push({template:'<ul id="'+this.parent.element.id+'subtotal_menu"></ul>',id:this.parent.element.id+"subtotalmenu"});break;case"GrandTotal":e.push({template:'<ul id="'+this.parent.element.id+'grandtotal_menu"></ul>',id:this.parent.element.id+"grandtotalmenu"});break;case"ConditionalFormatting":e.push({prefixIcon:"e-toolbar-formatting "+K,id:this.parent.element.id+"formatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("toolbarFormatting")});break;case"NumberFormatting":e.push({prefixIcon:"e-pivot-format-toolbar "+K,id:this.parent.element.id+"numberFormatting",click:this.actionClick.bind(this),tooltipText:this.parent.localeObj.getConstant("numberFormat")});break;case"Formatting":e.push({template:'<ul id="'+this.parent.element.id+'formatting_menu"></ul>',id:this.parent.element.id+"formattingmenu"});break;case"FieldList":e.push({prefixIcon:"e-toolbar-fieldlist "+K,tooltipText:this.parent.localeObj.getConstant("fieldList"),click:this.actionClick.bind(this),align:"Right",id:this.parent.element.id+"fieldlist"}),this.parent.element.querySelector(".e-toggle-field-list")&&(this.parent.element.querySelector(".e-toggle-field-list").style.display="none")}}var a={customToolbar:e};return this.parent.trigger("toolbarRender",a),e},e.prototype.reportChange=function(e){this.dropArgs=e,this.parent.isModified&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.reportLoad(e)},e.prototype.reportLoad=function(e){var t=this;if("Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action){var i={reportName:e.itemData.value};this.parent.trigger("loadReport",i,function(e){t.currentReport=e.reportName,t.parent.isModified=!1})}},e.prototype.saveReport=function(e){if(this.currentReport&&""!==this.currentReport&&e.item.id===this.parent.element.id+"save"){var t={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger(O,t),this.parent.isModified=!1}else this.dialogShow(e,"saveAs")},e.prototype.mdxQueryDialog=function(e){this.parent.element.appendChild(t.createElement("div",{id:this.parent.element.id+"mdx-dialog",className:"e-pivotview-mdx-dialog"})),this.dialog.appendTo("#"+this.parent.element.id+"mdx-dialog"),this.dialog.header=this.parent.localeObj.getConstant("mdxQuery");var i=t.createElement("div",{className:"e-mdx-query"}),r=t.createElement("textarea",{className:"e-mdx-query-content",innerHTML:this.parent.olapEngineModule.getMDXQuery(this.parent.dataSourceSettings),attrs:{readonly:"readonly"}});i.appendChild(r),this.dialog.content=i,this.dialog.show()},e.prototype.dialogShow=function(e,i){this.dialog.header=e.item.tooltipText;var r=t.createElement("div",{className:"e-report-outer"}),a=t.createElement("div",{className:"e-pivotview-report-label",innerHTML:this.parent.localeObj.getConstant("reportName")}),n=t.createElement("input",{className:Ht+" "+xt,innerHTML:i&&"rename"===i?this.currentReport:"",attrs:{placeholder:this.parent.localeObj.getConstant("emptyReportName"),value:i&&"rename"===i?this.currentReport:""}});n.setSelectionRange(n.textContent.length,n.textContent.length),r.appendChild(a),r.appendChild(n),this.dialog.content=r,this.dialog.refresh(),this.dialog.show()},e.prototype.renameReport=function(e){this.parent.trigger("toolbarClick",e),this.currentReport&&""!==this.currentReport?this.dialogShow(e,"rename"):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport"))},e.prototype.actionClick=function(e){switch(e.item.id){case this.parent.element.id+"save":case this.parent.element.id+"saveas":this.saveReport(e);break;case this.parent.element.id+"remove":return this.action="Remove",void(this.currentReport&&""!==this.currentReport?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeConfirm")):this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("emptyReport")));case this.parent.element.id+"rename":this.renameReport(e);break;case this.parent.element.id+"new":this.action="New",this.parent.isModified?this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("newReportConfirm")):this.createNewReport();break;case this.parent.element.id+"load":this.action="Load";break;case this.parent.element.id+"fieldlist":this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.show();break;case this.parent.element.id+"formatting":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog();break;case this.parent.element.id+"mdxQuery":this.mdxQueryDialog(e);break;case this.parent.element.id+"numberFormatting":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog()}},e.prototype.renderDialog=function(){null!==document.querySelector("#"+this.parent.element.id+"report-dialog")&&t.remove(document.querySelector("#"+this.parent.element.id+"report-dialog")),this.parent.element.appendChild(t.createElement("div",{id:this.parent.element.id+"report-dialog",className:"e-pivotview-report-dialog"})),this.dialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,position:{X:"center",Y:"center"},buttons:[{click:this.okBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.cancelBtnClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel")}}],isModal:!0,visible:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",zIndex:1000001,closeOnEscape:!0,target:document.body}),this.dialog.isStringTemplate=!0,this.dialog.appendTo("#"+this.parent.element.id+"report-dialog")},e.prototype.okBtnClick=function(){var e=this.dialog.element.querySelector("."+Ht);if(e&&""===e.value)e.focus();else{var t=!1;if(this.dialog.header!==this.parent.localeObj.getConstant("save")&&this.dialog.header!==this.parent.localeObj.getConstant("saveAs")||!e.value||""===e.value){if(this.dialog.header===this.parent.localeObj.getConstant("rename")&&e.value&&""!==e.value){this.action="Rename";var i={reportName:this.currentReport,rename:e.value};this.parent.trigger("renameReport",i),this.currentReport=e.value}}else{"New"===this.action?t=!0:this.action="Save",this.currentReport=e.value;var r={report:this.parent.getPersistData(),reportName:e.value};this.parent.trigger(O,r),this.parent.isModified=!1}this.updateReportList(),this.dialog.hide(),t&&this.createNewReport()}},e.prototype.createNewReport=function(){this.currentReport="",this.reportList.value="",this.reportList.text="",this.reportList.refresh(),this.parent.trigger("newReport"),this.parent.isModified=!1},e.prototype.cancelBtnClick=function(){this.dialog.hide()},e.prototype.createConfirmDialog=function(e,i){document.getElementById(this.parent.element.id+"_ConfirmDialog")&&t.remove(document.getElementById(this.parent.element.id+"_ConfirmDialog").parentElement);var a=t.createElement("div",{id:this.parent.element.id+"_ConfirmDialog",className:Me});this.parent.element.appendChild(a),this.confirmPopUp=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,header:e,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0,cssClass:we},click:this.okButtonClick.bind(this)},{buttonModel:{content:this.parent.localeObj.getConstant("cancel"),cssClass:Te},click:this.cancelButtonClick.bind(this)}]}),this.confirmPopUp.isStringTemplate=!0,this.confirmPopUp.appendTo(a),this.confirmPopUp.element.querySelector(".e-dlg-header").innerHTML=e},e.prototype.okButtonClick=function(){if("Remove"===this.action){var e={reportName:this.currentReport};this.parent.trigger("removeReport",e),this.currentReport="",this.parent.isModified=!1,this.action="",this.updateReportList()}else if("New"===this.action||"Save"!==this.action&&"Rename"!==this.action&&"New"!==this.action)if(this.currentReport&&""!==this.currentReport){var t={report:this.parent.getPersistData(),reportName:this.currentReport};this.parent.trigger(O,t),this.parent.isModified=!1,"New"===this.action?this.createNewReport():this.reportLoad(this.dropArgs)}else this.dialogShow({item:{tooltipText:this.parent.localeObj.getConstant("save")}});this.confirmPopUp.hide()},e.prototype.cancelButtonClick=function(){"New"===this.action?this.createNewReport():this.dropArgs&&this.reportLoad(this.dropArgs),this.confirmPopUp.hide()},e.prototype.create=function(){var e="Table"===this.parent.displayOption.view;if(this.parent.element.querySelector("#"+this.parent.element.id+"chart_menu")){var t=[{iconCss:"e-toolbar-chart "+K,items:e?[]:[{text:this.parent.localeObj.getConstant("column"),id:this.parent.element.id+"_Column"},{text:this.parent.localeObj.getConstant("bar"),id:this.parent.element.id+"_Bar"},{text:this.parent.localeObj.getConstant("line"),id:this.parent.element.id+"_Line"},{text:this.parent.localeObj.getConstant("area"),id:this.parent.element.id+"_Area"},{text:this.parent.localeObj.getConstant("scatter"),id:this.parent.element.id+"_Scatter"},{text:this.parent.localeObj.getConstant("polar"),id:this.parent.element.id+"_Polar"}]}];this.chartMenu=new n.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this)}),this.chartMenu.isStringTemplate=!0,this.chartMenu.appendTo("#"+this.parent.element.id+"chart_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"export_menu")){t=[{iconCss:"e-export "+K,items:[{text:this.parent.localeObj.getConstant("pdf"),iconCss:Rt+" "+K,id:this.parent.element.id+"pdf"},{text:this.parent.localeObj.getConstant("excel"),iconCss:jt+" "+K,id:this.parent.element.id+"excel"},{text:this.parent.localeObj.getConstant("csv"),iconCss:kt+" "+K,id:this.parent.element.id+"csv"},{text:this.parent.localeObj.getConstant("png"),iconCss:"e-pivotview-png-export "+K,id:this.parent.element.id+"png"},{text:this.parent.localeObj.getConstant("jpeg"),iconCss:"e-pivotview-jpeg-export "+K,id:this.parent.element.id+"jpeg"},{text:this.parent.localeObj.getConstant("svg"),iconCss:"e-pivotview-svg-export "+K,id:this.parent.element.id+"svg"}]}];this.exportMenu=new n.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateExportMenu.bind(this)}),this.exportMenu.isStringTemplate=!0,this.exportMenu.appendTo("#"+this.parent.element.id+"export_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"subtotal_menu")){t=[{iconCss:"e-sub-total "+K,items:[{text:this.parent.localeObj.getConstant("showSubTotals"),id:this.parent.element.id+"subtotal",iconCss:Wt+" "+K},{text:this.parent.localeObj.getConstant("doNotShowSubTotals"),id:this.parent.element.id+"notsubtotal",iconCss:Wt+" "+K},{text:this.parent.localeObj.getConstant("showSubTotalsRowsOnly"),id:this.parent.element.id+"subtotalrow",iconCss:Wt+" "+K},{text:this.parent.localeObj.getConstant("showSubTotalsColumnsOnly"),id:this.parent.element.id+"subtotalcolumn",iconCss:Wt+" "+K}]}];this.subTotalMenu=new n.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateSubtotalSelection.bind(this)}),this.subTotalMenu.isStringTemplate=!0,this.subTotalMenu.appendTo("#"+this.parent.element.id+"subtotal_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"grandtotal_menu")){t=[{iconCss:"e-grand-total "+K,items:[{text:this.parent.localeObj.getConstant("showGrandTotals"),id:this.parent.element.id+"grandtotal",iconCss:Wt+" "+K},{text:this.parent.localeObj.getConstant("doNotShowGrandTotals"),id:this.parent.element.id+"notgrandtotal",iconCss:Wt+" "+K},{text:this.parent.localeObj.getConstant("showGrandTotalsRowsOnly"),id:this.parent.element.id+"grandtotalrow",iconCss:Wt+" "+K},{text:this.parent.localeObj.getConstant("showGrandTotalsColumnsOnly"),id:this.parent.element.id+"grandtotalcolumn",iconCss:Wt+" "+K}]}];this.grandTotalMenu=new n.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this),beforeOpen:this.updateGrandtotalSelection.bind(this)}),this.grandTotalMenu.isStringTemplate=!0,this.grandTotalMenu.appendTo("#"+this.parent.element.id+"grandtotal_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"formatting_menu")){t=[{iconCss:"e-pivot-format-menu "+K,items:[{text:this.parent.localeObj.getConstant("numberFormat"),iconCss:"e-pivot-number-format-menu "+K,id:this.parent.element.id+"numberFormattingMenu"},{text:this.parent.localeObj.getConstant("conditionalFormating"),iconCss:"e-pivot-conditional-format-menu "+K,id:this.parent.element.id+"conditionalFormattingMenu"}]}];this.formattingMenu=new n.Menu({items:t,enableRtl:this.parent.enableRtl,select:this.menuItemClick.bind(this)}),this.formattingMenu.isStringTemplate=!0,this.formattingMenu.appendTo("#"+this.parent.element.id+"formatting_menu")}if(this.parent.element.querySelector("#"+this.parent.element.id+"_reportlist")){var i=this.fetchReports();this.reportList=new l.DropDownList({dataSource:i.reportName,width:"150px",popupHeight:"200px",placeholder:""===this.currentReport?this.parent.localeObj.getConstant("reportList"):"",enableRtl:this.parent.enableRtl,cssClass:"e-reportlist-drop",select:this.reportChange.bind(this),value:this.currentReport}),this.reportList.isStringTemplate=!0,this.reportList.appendTo("#"+this.parent.element.id+"_reportlist")}},e.prototype.updateExportMenu=function(e){"Table"==this.parent.currentView?(e.element.querySelector("#"+this.parent.element.id+"png").remove(),e.element.querySelector("#"+this.parent.element.id+"jpeg").remove(),e.element.querySelector("#"+this.parent.element.id+"svg").remove()):(e.element.querySelector("#"+this.parent.element.id+"excel").remove(),e.element.querySelector("#"+this.parent.element.id+"csv").remove())},e.prototype.updateSubtotalSelection=function(e){e.element.querySelector("#"+this.parent.element.id+"subtotal ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"subtotal ."+Wt).classList.add(zt),e.element.querySelector("#"+this.parent.element.id+"notsubtotal ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"notsubtotal ."+Wt).classList.add(zt),e.element.querySelector("#"+this.parent.element.id+"subtotalrow ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"subtotalrow ."+Wt).classList.add(zt),e.element.querySelector("#"+this.parent.element.id+"subtotalcolumn ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"subtotalcolumn ."+Wt).classList.add(zt),this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&!this.parent.dataSourceSettings.showColumnSubTotals?e.element.querySelector("#"+this.parent.element.id+"subtotalrow ."+Wt).classList.remove(zt):this.parent.dataSourceSettings.showSubTotals&&!this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?e.element.querySelector("#"+this.parent.element.id+"subtotalcolumn ."+Wt).classList.remove(zt):this.parent.dataSourceSettings.showSubTotals&&this.parent.dataSourceSettings.showRowSubTotals&&this.parent.dataSourceSettings.showColumnSubTotals?e.element.querySelector("#"+this.parent.element.id+"subtotal ."+Wt).classList.remove(zt):this.parent.dataSourceSettings.showSubTotals&&(this.parent.dataSourceSettings.showRowSubTotals||this.parent.dataSourceSettings.showColumnSubTotals)||e.element.querySelector("#"+this.parent.element.id+"notsubtotal ."+Wt).classList.remove(zt)},e.prototype.updateGrandtotalSelection=function(e){e.element.querySelector("#"+this.parent.element.id+"grandtotal ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"grandtotal ."+Wt).classList.add(zt),e.element.querySelector("#"+this.parent.element.id+"notgrandtotal ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"notgrandtotal ."+Wt).classList.add(zt),e.element.querySelector("#"+this.parent.element.id+"grandtotalrow ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"grandtotalrow ."+Wt).classList.add(zt),e.element.querySelector("#"+this.parent.element.id+"grandtotalcolumn ."+Wt).classList.contains(zt)||e.element.querySelector("#"+this.parent.element.id+"grandtotalcolumn ."+Wt).classList.add(zt),this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&!this.parent.dataSourceSettings.showColumnGrandTotals?e.element.querySelector("#"+this.parent.element.id+"grandtotalrow ."+Wt).classList.remove(zt):this.parent.dataSourceSettings.showGrandTotals&&!this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?e.element.querySelector("#"+this.parent.element.id+"grandtotalcolumn ."+Wt).classList.remove(zt):this.parent.dataSourceSettings.showGrandTotals&&this.parent.dataSourceSettings.showRowGrandTotals&&this.parent.dataSourceSettings.showColumnGrandTotals?e.element.querySelector("#"+this.parent.element.id+"grandtotal ."+Wt).classList.remove(zt):this.parent.dataSourceSettings.showGrandTotals&&(this.parent.dataSourceSettings.showRowGrandTotals||this.parent.dataSourceSettings.showColumnGrandTotals)||e.element.querySelector("#"+this.parent.element.id+"notgrandtotal ."+Wt).classList.remove(zt)},e.prototype.updateReportList=function(){var e=this.fetchReports();this.reportList.dataSource=e.reportName,""===this.currentReport&&this.reportList.dataSource.length>0?(this.reportList.value=this.reportList.dataSource[this.reportList.dataSource.length-1],this.reportList.text=this.reportList.dataSource[this.reportList.dataSource.length-1],this.currentReport=this.reportList.dataSource[this.reportList.dataSource.length-1]):(this.reportList.value=this.currentReport,this.reportList.text=this.currentReport),this.reportList.refresh()},e.prototype.menuItemClick=function(e){switch(e.item.id){case this.parent.element.id+"grid":this.parent.grid&&this.parent.chart&&(this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.currentView="Table",this.parent.showGroupingBar&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"),this.parent.layoutRefresh());break;case this.parent.element.id+"_Column":case this.parent.element.id+"_Bar":case this.parent.element.id+"_Line":case this.parent.element.id+"_Area":case this.parent.element.id+"_Scatter":case this.parent.element.id+"_Polar":e.item&&e.item.text&&(this.parent.chartSettings.chartSeries.type=e.item.id.split("_")[e.item.id.split("_").length-1],this.parent.grid&&this.parent.chart&&(this.parent.grid.element.style.display="none",this.parent.chart.element.style.display="",this.parent.currentView="Chart",this.parent.showGroupingBar&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none",this.parent.element.querySelector(".e-chart-grouping-bar").style.display="")));break;case this.parent.element.id+"pdf":"Table"==this.parent.currentView?this.parent.pdfExportModule?this.parent.pdfExportModule.exportToPDF():this.parent.pdfExport():this.parent.chartExport("PDF","result");break;case this.parent.element.id+"excel":this.parent.excelExportModule?this.parent.excelExportModule.exportToExcel("Excel"):this.parent.excelExport();break;case this.parent.element.id+"csv":this.parent.excelExportModule?this.parent.excelExportModule.exportToExcel("csv"):this.parent.csvExport();break;case this.parent.element.id+"png":this.parent.chartExport("PNG","result");break;case this.parent.element.id+"jpeg":this.parent.chartExport("JPEG","result");break;case this.parent.element.id+"svg":this.parent.chartExport("SVG","result");break;case this.parent.element.id+"notsubtotal":this.parent.dataSourceSettings.showSubTotals=!1,this.parent.dataSourceSettings.showColumnSubTotals=!1,this.parent.dataSourceSettings.showRowSubTotals=!1;break;case this.parent.element.id+"subtotalrow":this.parent.dataSourceSettings.showSubTotals=!0,this.parent.dataSourceSettings.showColumnSubTotals=!1,this.parent.dataSourceSettings.showRowSubTotals=!0;break;case this.parent.element.id+"subtotalcolumn":this.parent.dataSourceSettings.showSubTotals=!0,this.parent.dataSourceSettings.showColumnSubTotals=!0,this.parent.dataSourceSettings.showRowSubTotals=!1;break;case this.parent.element.id+"subtotal":this.parent.dataSourceSettings.showSubTotals=!0,this.parent.dataSourceSettings.showColumnSubTotals=!0,this.parent.dataSourceSettings.showRowSubTotals=!0;break;case this.parent.element.id+"notgrandtotal":this.parent.dataSourceSettings.showGrandTotals=!1,this.parent.dataSourceSettings.showColumnGrandTotals=!1,this.parent.dataSourceSettings.showRowGrandTotals=!1;break;case this.parent.element.id+"grandtotalrow":this.parent.dataSourceSettings.showGrandTotals=!0,this.parent.dataSourceSettings.showColumnGrandTotals=!1,this.parent.dataSourceSettings.showRowGrandTotals=!0;break;case this.parent.element.id+"grandtotalcolumn":this.parent.dataSourceSettings.showGrandTotals=!0,this.parent.dataSourceSettings.showColumnGrandTotals=!0,this.parent.dataSourceSettings.showRowGrandTotals=!1;break;case this.parent.element.id+"grandtotal":this.parent.dataSourceSettings.showGrandTotals=!0,this.parent.dataSourceSettings.showColumnGrandTotals=!0,this.parent.dataSourceSettings.showRowGrandTotals=!0;break;case this.parent.element.id+"numberFormattingMenu":this.parent.numberFormattingModule&&this.parent.numberFormattingModule.showNumberFormattingDialog();break;case this.parent.element.id+"conditionalFormattingMenu":this.parent.conditionalFormattingModule&&this.parent.conditionalFormattingModule.showConditionalFormattingDialog()}},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(z,this.createToolbar,this)},e.prototype.refreshToolbar=function(){this.createToolbar()},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(z,this.createToolbar)},e.prototype.destroy=function(){this.removeEventListener(),this.confirmPopUp&&!this.confirmPopUp.isDestroyed&&this.confirmPopUp.destroy(),this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),this.chartMenu&&!this.chartMenu.isDestroyed&&this.chartMenu.destroy(),this.exportMenu&&!this.exportMenu.isDestroyed&&this.exportMenu.destroy(),this.subTotalMenu&&!this.subTotalMenu.isDestroyed&&this.subTotalMenu.destroy(),this.grandTotalMenu&&!this.grandTotalMenu.isDestroyed&&this.grandTotalMenu.destroy(),this.formattingMenu&&!this.formattingMenu.isDestroyed&&this.formattingMenu.destroy(),this.reportList&&!this.reportList.isDestroyed&&this.reportList.destroy(),this.toolbar&&!this.toolbar.isDestroyed&&this.toolbar.destroy()},e}(),lr=function(){function e(e){this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/,this.parent=e,this.parent.numberFormattingModule=this,this.removeEventListener(),this.addEventListener()}return e.prototype.getModuleName=function(){return"numberformatting"},e.prototype.showNumberFormattingDialog=function(){var e=this,i=t.createElement("div",{id:this.parent.element.id+"_FormatDialog",className:"e-pivot-format-dialog"});this.parent.element.appendChild(i),this.dialog=new r.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("numberFormat"),content:this.getDialogContent(),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateFormatting.bind(this),buttonModel:{cssClass:we,content:this.parent.localeObj.getConstant("apply"),isPrimary:!0}},{click:function(){e.dialog.hide()},buttonModel:{cssClass:Te,content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:!0,target:this.parent.element,overlayClick:function(){e.removeDialog()},close:this.removeDialog.bind(this)}),this.dialog.isStringTemplate=!0,this.dialog.appendTo(i),this.dialog.element.querySelector(".e-dlg-header").innerHTML=this.parent.localeObj.getConstant("numberFormat"),this.renderControls()},e.prototype.getDialogContent=function(){var e=t.createElement("div",{id:this.parent.element.id+"_FormatDialogOuter",className:"e-pivot-format-dialog-outer"}),i=t.createElement("table",{id:this.parent.element.id+"_FormatTable",className:"e-pivot-format-table"}),r=t.createElement("tr"),a=t.createElement("td"),n=t.createElement("div",{id:this.parent.element.id+"_FormatValueLable",className:"e-pivot-format-value-lable",innerHTML:this.parent.localeObj.getConstant("values")}),o=t.createElement("div",{id:this.parent.element.id+"_FormatValueDrop"});a.appendChild(n),a.appendChild(o),r.appendChild(a),a=t.createElement("td");var l=t.createElement("div",{id:this.parent.element.id+"_GroupingLable",className:"e-pivot-format-grouping-lable",innerHTML:this.parent.localeObj.getConstant("grouping")}),s=t.createElement("div",{id:this.parent.element.id+"_GroupingDrop"});a.appendChild(l),a.appendChild(s),r.appendChild(a),i.appendChild(r),r=t.createElement("tr"),a=t.createElement("td");var d=t.createElement("div",{id:this.parent.element.id+"_FormatLable",className:"e-pivot-format-lable",innerHTML:this.parent.localeObj.getConstant("formatType")}),p=t.createElement("div",{id:this.parent.element.id+"_FormatDrop"});a.appendChild(d),a.appendChild(p),r.appendChild(a),a=t.createElement("td");var h=t.createElement("div",{id:this.parent.element.id+"_DecimalLable",className:"e-pivot-format-decimal-lable",innerHTML:this.parent.localeObj.getConstant("decimalPlaces")}),u=t.createElement("div",{id:this.parent.element.id+"_DecimalDrop"});a.appendChild(h),a.appendChild(u),r.appendChild(a),i.appendChild(r),r=t.createElement("tr"),a=t.createElement("td"),this.customLable=t.createElement("div",{id:this.parent.element.id+"_CustomLable",className:"e-pivot-format-custom-lable",innerHTML:this.parent.localeObj.getConstant("customText")}),this.customText=t.createElement("input",{id:this.parent.element.id+"_CustomText",attrs:{type:"text",tabindex:"1"},className:xt+" e-pivot-format-custom-text"}),a.appendChild(this.customLable),a.appendChild(this.customText),r.appendChild(a),a=t.createElement("td"),this.symbolLable=t.createElement("div",{id:this.parent.element.id+"_SymbolLable",className:"e-pivot-format-symbol-lable",innerHTML:this.parent.localeObj.getConstant("symbolPosition")});var c=t.createElement("div",{id:this.parent.element.id+"_SymbolDrop"});return a.appendChild(this.symbolLable),a.appendChild(c),r.appendChild(a),i.appendChild(r),e.appendChild(i),e},e.prototype.renderControls=function(){if(this.dialog.element.querySelector("#"+this.parent.element.id+"_FormatValueDrop")){var e=[];e.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")});for(var t=0;t<this.parent.dataSourceSettings.values.length;t++)e.push({index:t+1,name:this.parent.dataSourceSettings.values[t].caption||this.parent.dataSourceSettings.values[t].name,field:this.parent.dataSourceSettings.values[t].name});this.valuesDropDown=new l.DropDownList({dataSource:e,fields:{text:"name",value:"field"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-value-drop",change:this.valueChange.bind(this)}),this.valuesDropDown.isStringTemplate=!0,this.valuesDropDown.appendTo("#"+this.parent.element.id+"_FormatValueDrop")}if(this.dialog.element.querySelector("#"+this.parent.element.id+"_FormatDrop")){var i=[{index:0,name:this.parent.localeObj.getConstant("number")},{index:1,name:this.parent.localeObj.getConstant("currency")},{index:2,name:this.parent.localeObj.getConstant("percentage")}];this.formatDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},index:0,change:this.dropDownChange.bind(this),enableRtl:this.parent.enableRtl,cssClass:"e-pivot-format-drop"}),this.formatDropDown.isStringTemplate=!0,this.formatDropDown.appendTo("#"+this.parent.element.id+"_FormatDrop")}if(this.formatDropDown.value!==this.parent.localeObj.getConstant("currency")&&(this.customText&&this.customText.classList.add(Z),this.customLable&&this.customLable.classList.add(Z),this.symbolLable&&this.symbolLable.classList.add(Z)),this.dialog.element.querySelector("#"+this.parent.element.id+"_SymbolDrop")){i=[{index:0,name:this.parent.localeObj.getConstant("left")},{index:1,name:this.parent.localeObj.getConstant("right")}];this.symbolDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:Yt+(this.formatDropDown.value===this.parent.localeObj.getConstant("currency")?"":" "+Z)}),this.symbolDropDown.isStringTemplate=!0,this.symbolDropDown.appendTo("#"+this.parent.element.id+"_SymbolDrop")}if(this.dialog.element.querySelector("#"+this.parent.element.id+"_GroupingDrop")){i=[{index:0,name:this.parent.localeObj.getConstant("true")},{index:1,name:this.parent.localeObj.getConstant("false")}];this.groupingDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-grouping-drop"}),this.groupingDropDown.isStringTemplate=!0,this.groupingDropDown.appendTo("#"+this.parent.element.id+"_GroupingDrop")}if(this.dialog.element.querySelector("#"+this.parent.element.id+"_DecimalDrop")){i=[{index:0,name:0},{index:1,name:1},{index:2,name:2},{index:3,name:3},{index:4,name:4},{index:5,name:5},{index:6,name:6},{index:7,name:7},{index:8,name:8},{index:9,name:9},{index:10,name:10}];this.decimalDropDown=new l.DropDownList({dataSource:i,fields:{text:"name",value:"name"},enableRtl:this.parent.enableRtl,index:0,cssClass:"e-pivot-format-decimal-drop",popupHeight:150}),this.decimalDropDown.isStringTemplate=!0,this.decimalDropDown.appendTo("#"+this.parent.element.id+"_DecimalDrop")}},e.prototype.valueChange=function(e){for(var t=this.parent.dataSourceSettings.formatSettings,i=!1,r=0;r<t.length;r++)if(t[r].name===e.value){var a=t[r].format,n=a.split("")[0].toLowerCase();if(2===a.length&&["n","p"].indexOf(n)>-1)this.formatDropDown.value="n"===n?this.parent.localeObj.getConstant("number"):"p"===n?this.parent.localeObj.getConstant("percentage"):this.parent.localeObj.getConstant("number"),this.decimalDropDown.value=Number(a.split("")[1]),this.groupingDropDown.value=t[r].useGrouping?this.parent.localeObj.getConstant("true"):this.parent.localeObj.getConstant("false");else{this.formatDropDown.value=this.parent.localeObj.getConstant("currency");var o=this.parent.globalize.formatNumber(11111,{format:a}).split("1").join("#").match(this.customRegex);o&&o.length>0&&(this.symbolDropDown.value=""===o[10]?this.parent.localeObj.getConstant("left"):this.parent.localeObj.getConstant("right"),this.customText.value=""===o[10]?o[1]:o[10],this.decimalDropDown.value=o[7]&&o[7].lastIndexOf("0"),this.groupingDropDown.value=o[6]&&-1===o[6].indexOf(",")?this.parent.localeObj.getConstant("false"):this.parent.localeObj.getConstant("true"))}i=!0;break}i||(this.formatDropDown.value=this.parent.localeObj.getConstant("number"),this.decimalDropDown.value=0,this.groupingDropDown.value=this.parent.localeObj.getConstant("true"))},e.prototype.dropDownChange=function(e){e.value===this.parent.localeObj.getConstant("currency")?(this.customText.classList.contains(Z)&&this.customText.classList.remove(Z),this.customLable.classList.contains(Z)&&this.customLable.classList.remove(Z),this.symbolLable.classList.contains(Z)&&this.symbolLable.classList.remove(Z),this.dialog.element.querySelector("."+Yt).classList.contains(Z)&&this.dialog.element.querySelector("."+Yt).classList.remove(Z)):(this.customText.classList.contains(Z)||this.customText.classList.add(Z),this.customLable.classList.contains(Z)||this.customLable.classList.add(Z),this.symbolLable.classList.contains(Z)||this.symbolLable.classList.add(Z),this.dialog.element.querySelector("."+Yt).classList.contains(Z)||this.dialog.element.querySelector("."+Yt).classList.add(Z))},e.prototype.removeDialog=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),document.getElementById(this.parent.element.id+"_FormatDialog")&&t.remove(document.getElementById(this.parent.element.id+"_FormatDialog"))},e.prototype.repeatString=function(e,t){for(var i="";t>0;)i+=e,t--;return i},e.prototype.updateFormatting=function(){var e,t=this;if(this.formatDropDown.value===this.parent.localeObj.getConstant("number")||this.formatDropDown.value===this.parent.localeObj.getConstant("percentage")?(e=this.formatDropDown.value===this.parent.localeObj.getConstant("number")?"N":"P",e+=this.decimalDropDown.value):e=this.symbolDropDown.value===this.parent.localeObj.getConstant("left")?this.customText.value+"##,###"+(0===this.decimalDropDown.value?"":".")+this.repeatString("0",this.decimalDropDown.value):"##,###"+(0===this.decimalDropDown.value?"":".")+this.repeatString("0",this.decimalDropDown.value)+this.customText.value,this.valuesDropDown.value===this.parent.localeObj.getConstant("AllValues")){var i=this.parent.engineModule.fieldList;Object.keys(i).forEach(function(r){"number"===i[r].type&&t.insertFormat(r,e)})}else this.insertFormat(this.valuesDropDown.value.toString(),e);this.parent.updateDataSource(!1),this.dialog.close()},e.prototype.insertFormat=function(e,t){for(var i=!1,r={name:e,format:t,useGrouping:this.groupingDropDown.value===this.parent.localeObj.getConstant("true")},a=this.parent.dataSourceSettings.formatSettings,n=0;n<a.length;n++)a[n].name===e&&(a[n]=r,i=!0);i||a.push(r)},e.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(W,this.showNumberFormattingDialog,this)},e.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(W,this.showNumberFormattingDialog)},e.prototype.destroy=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy(),this.removeEventListener()},e}();e.GroupingBarSettings=Ni,e.CellEditSettings=Ii,e.ConditionalSettings=Ai,e.HyperlinkSettings=Fi,e.DisplayOption=qi,e.PivotView=Ri,e.Render=Kt,e.ExcelExport=ui,e.PDFExport=ci,e.KeyboardInteraction=gi,e.VirtualScroll=fi,e.DrillThrough=yi,e.PivotChart=Si,e.PivotFieldList=Ji,e.TreeViewRenderer=zi,e.AxisFieldRenderer=Yi,e.AxisTableRenderer=Wi,e.DialogRenderer=Gi,e.EventBase=ki,e.NodeStateModified=Hi,e.DataSourceUpdate=Vi,e.FieldList=tr,e.CommonKeyboardInteraction=ji,e.GroupingBar=ar,e.CalculatedField=er,e.ConditionalFormatting=nr,e.PivotCommon=Ui,e.load="load",e.enginePopulating=f,e.enginePopulated=v,e.onFieldDropped="onFieldDropped",e.beforePivotTableRender="beforePivotTableRender",e.afterPivotTableRender="afterPivotTableRender",e.beforeExport=y,e.excelHeaderQueryCellInfo=S,e.pdfHeaderQueryCellInfo=b,e.excelQueryCellInfo=C,e.pdfQueryCellInfo=x,e.onPdfCellRender=w,e.dataBound=T,e.queryCellInfo="queryCellInfo",e.headerCellInfo="headerCellInfo",e.hyperlinkCellClick=M,e.resizing="resizing",e.resizeStop="resizeStop",e.cellClick="cellClick",e.drillThrough="drillThrough",e.beforeColumnsRender=D,e.selected="selected",e.cellSelecting=E,e.drill="drill",e.cellSelected="cellSelected",e.cellDeselected="cellDeselected",e.rowSelected="rowSelected",e.rowDeselected="rowDeselected",e.beginDrillThrough=L,e.saveReport=O,e.fetchReport="fetchReport",e.loadReport="loadReport",e.renameReport="renameReport",e.removeReport="removeReport",e.newReport="newReport",e.toolbarRender="toolbarRender",e.toolbarClick="toolbarClick",e.chartTooltipRender=P,e.chartLoaded="chartLoaded",e.chartLoad="chartLoad",e.chartResized="chartResized",e.chartAxisLabelRender=N,e.chartSeriesCreated=I,e.aggregateCellInfo=A,e.contextMenuClick=F,e.contextMenuOpen="contextMenuOpen",e.fieldListRefreshed=q,e.conditionalFormatCreating=R,e.initialLoad=j,e.uiUpdate=k,e.scroll="scroll",e.contentReady=H,e.dataReady=V,e.initSubComponent=_,e.treeViewUpdate=B,e.pivotButtonUpdate=U,e.initCalculatedField=G,e.click="click",e.initToolbar=z,e.initFormatting=W,e.ErrorDialog=_i,e.FilterDialog=Bi,e.PivotContextMenu=mi,e.AggregateMenu=Xt,e.Toolbar=or,e.NumberFormatting=lr,e.PivotEngine=m,e.PivotUtil=g,e.OlapEngine=Li,e.MDXQuery=Ei,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-pivotview.umd.min.js.map
